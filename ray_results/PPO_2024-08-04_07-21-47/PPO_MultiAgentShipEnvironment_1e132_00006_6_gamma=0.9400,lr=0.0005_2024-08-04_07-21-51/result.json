{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.199456796484689, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.544379894932112, "policy_loss": -0.010505229290477777, "vf_loss": 9.552848921219509, "vf_explained_var": 0.02608986683189869, "kl": 0.010882361544160328, "entropy": 1.402973508834839, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -78.5724670647084, "episode_reward_min": -1252.40992828457, "episode_reward_mean": -618.7264317298095, "episode_len_mean": 114.83333333333333, "episode_media": {}, "episodes_timesteps_total": 2756, "policy_reward_min": {"policy_0": -1252.40992828457}, "policy_reward_max": {"policy_0": -78.5724670647084}, "policy_reward_mean": {"policy_0": -618.7264317298095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886], "episode_lengths": [88, 150, 76, 150, 150, 99, 76, 150, 150, 50, 91, 126, 76, 51, 150, 150, 150, 113, 150, 83, 96, 91, 140, 150], "policy_policy_0_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685242734845376, "mean_inference_ms": 1.6695589163163742, "mean_action_processing_ms": 0.2795356684978633, "mean_env_wait_ms": 3.4108652018691656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011406342188517252, "StateBufferConnector_ms": 0.008556246757507324, "ViewRequirementAgentConnector_ms": 0.18554131189982095}, "num_episodes": 24, "episode_return_max": -78.5724670647084, "episode_return_min": -1252.40992828457, "episode_return_mean": -618.7264317298095, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.02672824815085, "num_env_steps_trained_throughput_per_sec": 329.02672824815085, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12157.077, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12157.014, "sample_time_ms": 1117.857, "learn_time_ms": 10981.187, "learn_throughput": 364.259, "synch_weights_time_ms": 57.246}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00006", "date": "2024-08-04_08-27-32", "timestamp": 1722740252, "time_this_iter_s": 12.170363903045654, "time_total_s": 12.170363903045654, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b8ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.170363903045654, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.32777777777778, "ram_util_percent": 28.188888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0014892515726388, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.693188385168712, "policy_loss": -0.007259954741069426, "vf_loss": 9.698747066656749, "vf_explained_var": 0.07715917664269606, "kl": 0.009199021570354187, "entropy": 1.3854655381292105, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -56.58351205322603, "episode_reward_min": -1371.7481238620883, "episode_reward_mean": -743.0700179825111, "episode_len_mean": 125.52941176470588, "episode_media": {}, "episodes_timesteps_total": 6402, "policy_reward_min": {"policy_0": -1371.7481238620883}, "policy_reward_max": {"policy_0": -56.58351205322603}, "policy_reward_mean": {"policy_0": -743.0700179825111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823], "episode_lengths": [88, 150, 76, 150, 150, 99, 76, 150, 150, 50, 91, 126, 76, 51, 150, 150, 150, 113, 150, 83, 96, 91, 140, 150, 150, 150, 150, 150, 70, 150, 61, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 92, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.565644517687752, "mean_inference_ms": 1.6686413488434415, "mean_action_processing_ms": 0.2781036688619079, "mean_env_wait_ms": 3.4199895951784995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013352375404507505, "StateBufferConnector_ms": 0.008610183117436427, "ViewRequirementAgentConnector_ms": 0.18982840519325406}, "num_episodes": 27, "episode_return_max": -56.58351205322603, "episode_return_min": -1371.7481238620883, "episode_return_mean": -743.0700179825111, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.2249393670534, "num_env_steps_trained_throughput_per_sec": 352.2249393670534, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11756.734, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11756.67, "sample_time_ms": 1129.145, "learn_time_ms": 10568.301, "learn_throughput": 378.49, "synch_weights_time_ms": 58.502}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00006", "date": "2024-08-04_08-27-43", "timestamp": 1722740263, "time_this_iter_s": 11.366870164871216, "time_total_s": 23.53723406791687, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.53723406791687, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.356250000000003, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.030345310457051, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.291904039184253, "policy_loss": -0.009455378502510332, "vf_loss": 9.299187351266543, "vf_explained_var": 0.15614090195546548, "kl": 0.011533822370158002, "entropy": 1.3472621394942204, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -14.326015880330345, "episode_reward_min": -1419.2845130576181, "episode_reward_mean": -726.5753679539349, "episode_len_mean": 122.3529411764706, "episode_media": {}, "episodes_timesteps_total": 10400, "policy_reward_min": {"policy_0": -1419.2845130576181}, "policy_reward_max": {"policy_0": -14.326015880330345}, "policy_reward_mean": {"policy_0": -726.5753679539349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531], "episode_lengths": [88, 150, 76, 150, 150, 99, 76, 150, 150, 50, 91, 126, 76, 51, 150, 150, 150, 113, 150, 83, 96, 91, 140, 150, 150, 150, 150, 150, 70, 150, 61, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 92, 150, 150, 150, 150, 150, 150, 64, 65, 150, 51, 50, 150, 150, 150, 150, 144, 150, 150, 64, 150, 62, 150, 80, 150, 150, 65, 150, 150, 110, 150, 150, 43, 109, 150, 42, 150, 150, 49, 150], "policy_policy_0_reward": [-286.66723939723846, -1044.0325319958977, -159.14668771918397, -819.8786932020228, -1122.7467908728881, -392.6203614045291, -303.6467303943401, -1187.1546212120722, -1056.6515313932687, -78.5724670647084, -251.4184784170328, -701.3702768617046, -175.36433182916113, -123.37719019695535, -754.6214675067517, -1054.166964617013, -1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5644004000545231, "mean_inference_ms": 1.670904153097607, "mean_action_processing_ms": 0.27794837687693774, "mean_env_wait_ms": 3.4221823067823265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012997739455279182, "StateBufferConnector_ms": 0.008608593660242417, "ViewRequirementAgentConnector_ms": 0.18948274500229778}, "num_episodes": 34, "episode_return_max": -14.326015880330345, "episode_return_min": -1419.2845130576181, "episode_return_mean": -726.5753679539349, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.2469568040118, "num_env_steps_trained_throughput_per_sec": 313.2469568040118, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12094.319, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12094.255, "sample_time_ms": 1141.002, "learn_time_ms": 10889.367, "learn_throughput": 367.331, "synch_weights_time_ms": 63.132}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00006", "date": "2024-08-04_08-27-56", "timestamp": 1722740276, "time_this_iter_s": 12.782090425491333, "time_total_s": 36.3193244934082, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ae320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.3193244934082, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.394444444444442, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3042519856865207, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.396144157648086, "policy_loss": -0.0077965346834389495, "vf_loss": 9.401729797323545, "vf_explained_var": 0.3139660752688845, "kl": 0.011728579455348156, "entropy": 1.348353944097956, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -5.823124028890218, "episode_reward_min": -1419.2845130576181, "episode_reward_mean": -739.0504192139675, "episode_len_mean": 126.61, "episode_media": {}, "episodes_timesteps_total": 12661, "policy_reward_min": {"policy_0": -1419.2845130576181}, "policy_reward_max": {"policy_0": -5.823124028890218}, "policy_reward_mean": {"policy_0": -739.0504192139675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126], "episode_lengths": [150, 113, 150, 83, 96, 91, 140, 150, 150, 150, 150, 150, 70, 150, 61, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 92, 150, 150, 150, 150, 150, 150, 64, 65, 150, 51, 50, 150, 150, 150, 150, 144, 150, 150, 64, 150, 62, 150, 80, 150, 150, 65, 150, 150, 110, 150, 150, 43, 109, 150, 42, 150, 150, 49, 150, 150, 150, 150, 150, 150, 97, 73, 138, 150, 108, 150, 150, 150, 150, 150, 150, 34, 79, 150, 81, 150, 149, 150, 150, 42, 150, 150, 150, 150, 150, 93], "policy_policy_0_reward": [-1252.40992828457, -439.865702678642, -1162.3885294669794, -172.03774209235274, -460.1769884080895, -199.84274004444168, -558.4742944315949, -1092.8020720239886, -1008.4939235263746, -990.1200091122541, -1100.8898566789576, -821.7911009500181, -128.84765858465852, -939.7924318565388, -64.29665185676996, -972.3166765239909, -1051.7827946947411, -56.58351205322603, -1202.4771586171737, -1241.0377464179064, -1072.7562334172064, -528.7540990732205, -1371.7481238620883, -978.5980547304969, -789.7044445509396, -1349.439908601859, -326.55021638923967, -1085.9662739577393, -935.7196720898455, -395.5462272852312, -951.8136027132044, -1186.0409511062874, -1002.5611345083346, -619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617809807883187, "mean_inference_ms": 1.669943786443082, "mean_action_processing_ms": 0.2783232584874787, "mean_env_wait_ms": 3.421757082057413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01336216926574707, "StateBufferConnector_ms": 0.008727073669433594, "ViewRequirementAgentConnector_ms": 0.1916639804840088}, "num_episodes": 31, "episode_return_max": -5.823124028890218, "episode_return_min": -1419.2845130576181, "episode_return_mean": -739.0504192139675, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.71936192371203, "num_env_steps_trained_throughput_per_sec": 306.71936192371203, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12331.053, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12330.983, "sample_time_ms": 1148.523, "learn_time_ms": 11118.553, "learn_throughput": 359.759, "synch_weights_time_ms": 63.158}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00006", "date": "2024-08-04_08-28-09", "timestamp": 1722740289, "time_this_iter_s": 13.05443787574768, "time_total_s": 49.373762369155884, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344736680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.373762369155884, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.089473684210525, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.919727797309557, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.697368093331654, "policy_loss": -0.015080186226502217, "vf_loss": 8.70905442982912, "vf_explained_var": 0.47141088725378116, "kl": 0.01762802317934984, "entropy": 1.3178414932141702, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -5.823124028890218, "episode_reward_min": -1419.2845130576181, "episode_reward_mean": -700.7925803971359, "episode_len_mean": 125.59, "episode_media": {}, "episodes_timesteps_total": 12559, "policy_reward_min": {"policy_0": -1419.2845130576181}, "policy_reward_max": {"policy_0": -5.823124028890218}, "policy_reward_mean": {"policy_0": -700.7925803971359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238], "episode_lengths": [150, 150, 150, 64, 65, 150, 51, 50, 150, 150, 150, 150, 144, 150, 150, 64, 150, 62, 150, 80, 150, 150, 65, 150, 150, 110, 150, 150, 43, 109, 150, 42, 150, 150, 49, 150, 150, 150, 150, 150, 150, 97, 73, 138, 150, 108, 150, 150, 150, 150, 150, 150, 34, 79, 150, 81, 150, 149, 150, 150, 42, 150, 150, 150, 150, 150, 93, 150, 136, 86, 150, 150, 118, 150, 49, 150, 150, 150, 150, 123, 150, 38, 150, 150, 42, 150, 150, 140, 150, 86, 150, 56, 150, 150, 91, 150, 150, 125, 150, 127], "policy_policy_0_reward": [-619.6578842157577, -873.8502082185823, -1118.202392887785, -95.33144532200899, -64.74255041853422, -778.2167113859282, -70.92590061834146, -92.5058095625816, -1111.313683396129, -1261.796139703666, -864.7680145294712, -954.5075085390984, -941.4059727997928, -945.4236242301372, -1166.8789099869928, -139.0351813552196, -1419.2845130576181, -138.12592749879295, -1218.079166468966, -333.773569889268, -981.0201631524027, -1131.7402212404943, -169.06495380126313, -710.9275926516704, -909.9655437287408, -348.03535342595023, -1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561672785278725, "mean_inference_ms": 1.6744499672290076, "mean_action_processing_ms": 0.27894448546004397, "mean_env_wait_ms": 3.4247480318082313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013113975524902344, "StateBufferConnector_ms": 0.008847951889038086, "ViewRequirementAgentConnector_ms": 0.1939101219177246}, "num_episodes": 33, "episode_return_max": -5.823124028890218, "episode_return_min": -1419.2845130576181, "episode_return_mean": -700.7925803971359, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.3105203517482, "num_env_steps_trained_throughput_per_sec": 302.3105203517482, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12511.131, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12511.058, "sample_time_ms": 1150.338, "learn_time_ms": 11295.385, "learn_throughput": 354.127, "synch_weights_time_ms": 64.569}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00006", "date": "2024-08-04_08-28-22", "timestamp": 1722740302, "time_this_iter_s": 13.243749141693115, "time_total_s": 62.617511510849, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447aedd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.617511510849, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.95263157894737, "ram_util_percent": 28.263157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117916427428524, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.917772614955902, "policy_loss": -0.009854846366215498, "vf_loss": 8.924820059041183, "vf_explained_var": 0.379682161534826, "kl": 0.014719226575471115, "entropy": 1.3642950940877199, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -5.823124028890218, "episode_reward_min": -1354.9143644468306, "episode_reward_mean": -716.9808814382269, "episode_len_mean": 129.13, "episode_media": {}, "episodes_timesteps_total": 12913, "policy_reward_min": {"policy_0": -1354.9143644468306}, "policy_reward_max": {"policy_0": -5.823124028890218}, "policy_reward_mean": {"policy_0": -716.9808814382269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009], "episode_lengths": [150, 150, 43, 109, 150, 42, 150, 150, 49, 150, 150, 150, 150, 150, 150, 97, 73, 138, 150, 108, 150, 150, 150, 150, 150, 150, 34, 79, 150, 81, 150, 149, 150, 150, 42, 150, 150, 150, 150, 150, 93, 150, 136, 86, 150, 150, 118, 150, 49, 150, 150, 150, 150, 123, 150, 38, 150, 150, 42, 150, 150, 140, 150, 86, 150, 56, 150, 150, 91, 150, 150, 125, 150, 127, 150, 103, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 92, 150, 150, 93, 150, 150, 150, 150, 150, 150, 96, 150, 48, 150], "policy_policy_0_reward": [-1104.3310252283934, -969.8254296053419, -14.326015880330345, -421.84598146349066, -1093.897024012783, -34.77583554687849, -1076.2786444753067, -1266.1810700343738, -30.003880162894756, -885.7996029157531, -1006.7950753273627, -1122.210320058326, -1225.0531280922987, -538.3084314373064, -630.7482362869459, -430.5686447645891, -251.36304263844028, -345.23300433610734, -733.8819029183434, -265.3128914541175, -677.6850087519924, -811.2267711975778, -724.9133674095868, -782.3008033026761, -722.6495756280418, -840.7942659024131, -5.823124028890218, -189.0693304354322, -965.6177338019163, -318.92497079034064, -1086.731095151116, -553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615003975349572, "mean_inference_ms": 1.6760604987912309, "mean_action_processing_ms": 0.2795816502978869, "mean_env_wait_ms": 3.4285297656326166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013138771057128906, "StateBufferConnector_ms": 0.008865594863891602, "ViewRequirementAgentConnector_ms": 0.1946415901184082}, "num_episodes": 26, "episode_return_max": -5.823124028890218, "episode_return_min": -1354.9143644468306, "episode_return_mean": -716.9808814382269, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.7705900763389, "num_env_steps_trained_throughput_per_sec": 298.7705900763389, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12657.311, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12657.238, "sample_time_ms": 1152.501, "learn_time_ms": 11440.634, "learn_throughput": 349.631, "synch_weights_time_ms": 63.343}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00006", "date": "2024-08-04_08-28-36", "timestamp": 1722740316, "time_this_iter_s": 13.399450302124023, "time_total_s": 76.01696181297302, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575c160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.01696181297302, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.152631578947364, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.262999390810727, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 7.574512602885564, "policy_loss": -0.014173316713519549, "vf_loss": 7.585355072220167, "vf_explained_var": 0.5003592432787021, "kl": 0.017317019504010506, "entropy": 1.3254205105205377, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.929253945219465, "episode_reward_min": -1354.9143644468306, "episode_reward_mean": -759.7529686369817, "episode_len_mean": 132.87, "episode_media": {}, "episodes_timesteps_total": 13287, "policy_reward_min": {"policy_0": -1354.9143644468306}, "policy_reward_max": {"policy_0": -16.929253945219465}, "policy_reward_mean": {"policy_0": -759.7529686369817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837], "episode_lengths": [149, 150, 150, 42, 150, 150, 150, 150, 150, 93, 150, 136, 86, 150, 150, 118, 150, 49, 150, 150, 150, 150, 123, 150, 38, 150, 150, 42, 150, 150, 140, 150, 86, 150, 56, 150, 150, 91, 150, 150, 125, 150, 127, 150, 103, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 92, 150, 150, 93, 150, 150, 150, 150, 150, 150, 96, 150, 48, 150, 65, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 149, 150, 118, 150, 150, 132, 150, 110, 101, 150, 150, 150, 100, 150, 48, 127], "policy_policy_0_reward": [-553.487187904846, -413.1008095133003, -859.0440829770926, -21.594602535597303, -1037.9588644940598, -1189.7038008698134, -1315.9767412718602, -1178.7822589937848, -1013.3565020040456, -399.35643511883126, -892.559999469845, -577.3006042018494, -148.69593474690512, -787.2380565310364, -1290.4606440688526, -275.3223520707948, -1023.1992774598319, -91.94663069383094, -378.2077930016339, -814.3456764962235, -714.2691009002333, -1354.9143644468306, -604.7183584462348, -1183.4370871126075, -16.929253945219465, -1041.9557068980866, -640.9408999534289, -37.23087493076731, -1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619110821981405, "mean_inference_ms": 1.6788466397115838, "mean_action_processing_ms": 0.2794454511518256, "mean_env_wait_ms": 3.4304979652113796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013019084930419922, "StateBufferConnector_ms": 0.00856924057006836, "ViewRequirementAgentConnector_ms": 0.19369220733642578}, "num_episodes": 31, "episode_return_max": -16.929253945219465, "episode_return_min": -1354.9143644468306, "episode_return_mean": -759.7529686369817, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3054996985731, "num_env_steps_trained_throughput_per_sec": 306.3054996985731, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12714.676, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12714.605, "sample_time_ms": 1148.574, "learn_time_ms": 11502.797, "learn_throughput": 347.742, "synch_weights_time_ms": 62.479}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00006", "date": "2024-08-04_08-28-49", "timestamp": 1722740329, "time_this_iter_s": 13.070737600326538, "time_total_s": 89.08769941329956, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447af010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.08769941329956, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.12222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.958870804309846, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 6.322742228209973, "policy_loss": -0.0051989522161117446, "vf_loss": 6.325773460169633, "vf_explained_var": 0.7648319335033497, "kl": 0.011429081921477291, "entropy": 1.180740021665891, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -48.20356588341489, "episode_reward_min": -1403.2267606822102, "episode_reward_mean": -746.0183273869677, "episode_len_mean": 133.82, "episode_media": {}, "episodes_timesteps_total": 13382, "policy_reward_min": {"policy_0": -1403.2267606822102}, "policy_reward_max": {"policy_0": -48.20356588341489}, "policy_reward_mean": {"policy_0": -746.0183273869677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035], "episode_lengths": [150, 150, 140, 150, 86, 150, 56, 150, 150, 91, 150, 150, 125, 150, 127, 150, 103, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 92, 150, 150, 93, 150, 150, 150, 150, 150, 150, 96, 150, 48, 150, 65, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 149, 150, 118, 150, 150, 132, 150, 110, 101, 150, 150, 150, 100, 150, 48, 127, 101, 150, 150, 95, 101, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 98, 150, 150, 58, 73, 150, 90, 60, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1149.3402514789418, -848.4013671759704, -566.8571784592642, -1114.8023632277548, -170.5828260117454, -772.938131764335, -82.29453752681921, -1149.9694760917855, -1103.4541966671393, -240.22650910388904, -1000.9486786442634, -1031.445615963613, -346.32403942869263, -1015.4973690390328, -599.0874229483238, -1142.0789335728048, -495.9968442964943, -758.0289671999843, -921.0808634542738, -1017.2496273402614, -110.95718424063737, -882.9202728339573, -885.6738606312736, -967.1803807823866, -747.5016006576694, -955.6596910325859, -965.3510661176732, -221.72267551077678, -992.993635358142, -683.3328459038015, -286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615690996290659, "mean_inference_ms": 1.6784247496003848, "mean_action_processing_ms": 0.2791319863467606, "mean_env_wait_ms": 3.4276107721799316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012651920318603516, "StateBufferConnector_ms": 0.008295774459838867, "ViewRequirementAgentConnector_ms": 0.1914968490600586}, "num_episodes": 28, "episode_return_max": -48.20356588341489, "episode_return_min": -1403.2267606822102, "episode_return_mean": -746.0183273869677, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8285854454053, "num_env_steps_trained_throughput_per_sec": 307.8285854454053, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12749.624, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12749.553, "sample_time_ms": 1148.288, "learn_time_ms": 11538.042, "learn_throughput": 346.679, "synch_weights_time_ms": 62.461}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00006", "date": "2024-08-04_08-29-02", "timestamp": 1722740342, "time_this_iter_s": 13.007366180419922, "time_total_s": 102.09506559371948, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447afe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.09506559371948, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.926315789473684, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.33764778027932, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 6.9716506039102875, "policy_loss": -0.006568304681665419, "vf_loss": 6.975846072038014, "vf_explained_var": 0.7330655570452412, "kl": 0.012498366053205246, "entropy": 1.2684665282567342, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -48.20356588341489, "episode_reward_min": -1403.2267606822102, "episode_reward_mean": -728.9154460305402, "episode_len_mean": 134.79, "episode_media": {}, "episodes_timesteps_total": 13479, "policy_reward_min": {"policy_0": -1403.2267606822102}, "policy_reward_max": {"policy_0": -48.20356588341489}, "policy_reward_mean": {"policy_0": -728.9154460305402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343], "episode_lengths": [93, 150, 150, 150, 150, 150, 150, 96, 150, 48, 150, 65, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 149, 150, 118, 150, 150, 132, 150, 110, 101, 150, 150, 150, 100, 150, 48, 127, 101, 150, 150, 95, 101, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 98, 150, 150, 58, 73, 150, 90, 60, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 58, 150, 150, 150, 150, 58], "policy_policy_0_reward": [-286.5115609729741, -746.2040352612141, -949.9927683225725, -894.593000426592, -1151.4678254001365, -1136.3798585087, -1110.6441579698926, -323.7124307912202, -659.9992424313693, -48.20356588341489, -1021.9721512935009, -129.98813458592073, -1127.941220113535, -912.5145740187604, -1202.7675380067367, -1157.706812714496, -1205.092846556873, -1339.6403820771268, -953.2173662817918, -485.2093537042534, -1324.3684377440395, -958.4673930460368, -759.5111137739715, -1104.5100153027404, -1327.3173457481203, -1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560928931320656, "mean_inference_ms": 1.6788242944691822, "mean_action_processing_ms": 0.2784209976771098, "mean_env_wait_ms": 3.43074019606423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012187957763671875, "StateBufferConnector_ms": 0.00800466537475586, "ViewRequirementAgentConnector_ms": 0.18864083290100098}, "num_episodes": 30, "episode_return_max": -48.20356588341489, "episode_return_min": -1403.2267606822102, "episode_return_mean": -728.9154460305402, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.92034782895445, "num_env_steps_trained_throughput_per_sec": 312.92034782895445, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12753.312, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12753.242, "sample_time_ms": 1146.848, "learn_time_ms": 11542.253, "learn_throughput": 346.553, "synch_weights_time_ms": 63.382}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00006", "date": "2024-08-04_08-29-15", "timestamp": 1722740355, "time_this_iter_s": 12.796565771102905, "time_total_s": 114.89163136482239, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bbd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.89163136482239, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.30897515316805, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 6.0517911528547605, "policy_loss": -0.008140811073826627, "vf_loss": 6.057161854704221, "vf_explained_var": 0.8714394784842928, "kl": 0.014400670050326888, "entropy": 1.1002881706381837, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -51.816346096771284, "episode_reward_min": -1403.2267606822102, "episode_reward_mean": -716.2091726619619, "episode_len_mean": 136.94, "episode_media": {}, "episodes_timesteps_total": 13694, "policy_reward_min": {"policy_0": -1403.2267606822102}, "policy_reward_max": {"policy_0": -51.816346096771284}, "policy_reward_mean": {"policy_0": -716.2091726619619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754], "episode_lengths": [150, 149, 150, 118, 150, 150, 132, 150, 110, 101, 150, 150, 150, 100, 150, 48, 127, 101, 150, 150, 95, 101, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 98, 150, 150, 58, 73, 150, 90, 60, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 58, 150, 150, 150, 150, 58, 150, 150, 131, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150], "policy_policy_0_reward": [-1102.3811750126983, -669.8993960859723, -419.9399603676937, -590.357997054606, -868.0361797770623, -1306.0876989718877, -480.64571419446537, -705.7176005756261, -471.95155256763127, -390.0652923154843, -508.0727583988436, -655.3428913944384, -901.6558291176449, -204.05400055411272, -1135.667553689698, -114.30914571883379, -337.24667344375837, -346.8007732881456, -315.44460680198443, -1403.2267606822102, -329.8379115095886, -493.09958868647266, -565.1886025441532, -1274.120127218621, -365.6284354686937, -1081.002433391377, -533.9326269704386, -484.8846846330781, -1373.7585492773524, -926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560037927098305, "mean_inference_ms": 1.675543355133395, "mean_action_processing_ms": 0.2773756202643942, "mean_env_wait_ms": 3.423866871814127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011974096298217773, "StateBufferConnector_ms": 0.00785970687866211, "ViewRequirementAgentConnector_ms": 0.18643760681152344}, "num_episodes": 25, "episode_return_max": -51.816346096771284, "episode_return_min": -1403.2267606822102, "episode_return_mean": -716.2091726619619, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.1987945144785, "num_env_steps_trained_throughput_per_sec": 319.1987945144785, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12731.12, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12731.049, "sample_time_ms": 1141.047, "learn_time_ms": 11524.097, "learn_throughput": 347.099, "synch_weights_time_ms": 65.148}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00006", "date": "2024-08-04_08-29-27", "timestamp": 1722740367, "time_this_iter_s": 12.543146133422852, "time_total_s": 127.43477749824524, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ba440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.43477749824524, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.333333333333332, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.67590695520242, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 5.396709907303253, "policy_loss": -0.01748639154538978, "vf_loss": 5.410209798067808, "vf_explained_var": 0.9248643832902114, "kl": 0.02044424181403883, "entropy": 1.0233742701510589, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -51.816346096771284, "episode_reward_min": -1328.5777831308621, "episode_reward_mean": -701.3724584520709, "episode_len_mean": 139.99, "episode_media": {}, "episodes_timesteps_total": 13999, "policy_reward_min": {"policy_0": -1328.5777831308621}, "policy_reward_max": {"policy_0": -51.816346096771284}, "policy_reward_mean": {"policy_0": -701.3724584520709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408], "episode_lengths": [145, 150, 150, 98, 150, 150, 58, 73, 150, 90, 60, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 58, 150, 150, 150, 150, 58, 150, 150, 131, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-926.1996862424752, -793.6398346072958, -890.0903019905969, -451.70644785611455, -902.864036337025, -668.0183435644366, -80.99011456443485, -221.2958694867976, -699.9187660514397, -364.8834311165627, -51.816346096771284, -956.3150779850928, -792.1645695702243, -507.0220742716349, -772.8505436379903, -835.869232205035, -1144.5345447678149, -1007.8469717014356, -502.8485031264158, -61.152770209844526, -964.6257393063183, -388.9118037906675, -1316.8546450160907, -1065.7240083936927, -424.7967666777764, -939.965308046857, -598.7560654803096, -583.9541830850068, -368.91147371920636, -660.8866100637263, -973.3159476135031, -700.6419330568762, -568.0981182776493, -466.06917405817416, -1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594107467855813, "mean_inference_ms": 1.6737466328382677, "mean_action_processing_ms": 0.27648954172183954, "mean_env_wait_ms": 3.4188459555494517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011718034744262695, "StateBufferConnector_ms": 0.007883787155151367, "ViewRequirementAgentConnector_ms": 0.18791723251342773}, "num_episodes": 29, "episode_return_max": -51.816346096771284, "episode_return_min": -1328.5777831308621, "episode_return_mean": -701.3724584520709, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0225340363466, "num_env_steps_trained_throughput_per_sec": 300.0225340363466, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12848.647, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12848.575, "sample_time_ms": 1142.82, "learn_time_ms": 11639.401, "learn_throughput": 343.66, "synch_weights_time_ms": 65.585}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00006", "date": "2024-08-04_08-29-41", "timestamp": 1722740381, "time_this_iter_s": 13.34526777267456, "time_total_s": 140.7800452709198, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.7800452709198, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.08421052631579, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.26872267723084, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 5.2700222765405975, "policy_loss": -0.013599280250976639, "vf_loss": 5.279601776103179, "vf_explained_var": 0.9498845685273409, "kl": 0.013751674253698335, "entropy": 1.05736014097929, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -64.69614314636092, "episode_reward_min": -1328.5777831308621, "episode_reward_mean": -724.2632272434244, "episode_len_mean": 141.62, "episode_media": {}, "episodes_timesteps_total": 14162, "policy_reward_min": {"policy_0": -1328.5777831308621}, "policy_reward_max": {"policy_0": -64.69614314636092}, "policy_reward_mean": {"policy_0": -724.2632272434244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178], "episode_lengths": [150, 150, 107, 150, 150, 150, 58, 150, 150, 150, 150, 58, 150, 150, 131, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 56, 150, 150, 150, 80, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1163.384263454512, -1036.9569809775053, -465.37955020485145, -686.6436702445008, -888.1793223352781, -1229.4735935349026, -94.00315214680134, -819.7053721867014, -1156.777317663352, -359.50695203600054, -509.01704585683905, -82.68848978894343, -449.10717142293294, -1055.8658738368165, -692.3091037885396, -929.270946754613, -907.5662106207733, -1056.0940807084075, -1021.0089707911159, -938.9899108737505, -1119.685763294456, -172.04413209468183, -867.1547696180355, -969.6996084105585, -1328.5777831308621, -1180.4683628187422, -475.6230360390128, -406.851092383415, -716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581758133855452, "mean_inference_ms": 1.6744385463694373, "mean_action_processing_ms": 0.27614280238296374, "mean_env_wait_ms": 3.4186721324865665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857748031616211, "StateBufferConnector_ms": 0.00801229476928711, "ViewRequirementAgentConnector_ms": 0.19016051292419434}, "num_episodes": 34, "episode_return_max": -64.69614314636092, "episode_return_min": -1328.5777831308621, "episode_return_mean": -724.2632272434244, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6330107369268, "num_env_steps_trained_throughput_per_sec": 307.6330107369268, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13013.26, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13013.186, "sample_time_ms": 1140.209, "learn_time_ms": 11806.655, "learn_throughput": 338.792, "synch_weights_time_ms": 65.552}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00006", "date": "2024-08-04_08-29-54", "timestamp": 1722740394, "time_this_iter_s": 13.01654839515686, "time_total_s": 153.79659366607666, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575d240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.79659366607666, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.915789473684214, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.68087617754935, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.246543501565854, "policy_loss": -0.01549180253544667, "vf_loss": 4.257676719874143, "vf_explained_var": 0.949581917685767, "kl": 0.0148565247759052, "entropy": 0.9837687286237876, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -64.69614314636092, "episode_reward_min": -1337.3615027757724, "episode_reward_mean": -713.3993543268427, "episode_len_mean": 144.51, "episode_media": {}, "episodes_timesteps_total": 14451, "policy_reward_min": {"policy_0": -1337.3615027757724}, "policy_reward_max": {"policy_0": -64.69614314636092}, "policy_reward_mean": {"policy_0": -713.3993543268427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052], "episode_lengths": [150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 56, 150, 150, 150, 80, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-716.4264080999575, -689.8963027468928, -1009.7746808842828, -401.06422657814164, -997.9609688112911, -929.6680737685502, -807.1949725093546, -1187.2969079079705, -737.7064361849754, -605.2916362178572, -504.0789416024831, -798.4000815038985, -370.675910361073, -761.0165668160084, -375.700880221617, -454.43958164374214, -531.2638377869652, -294.5962130156115, -828.3545996091602, -471.0516679617139, -718.7073007512317, -775.4455621327875, -822.9481033160241, -352.34191157384794, -436.29468596927916, -103.74667238529875, -641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575219996552705, "mean_inference_ms": 1.6726929824212358, "mean_action_processing_ms": 0.27557861961402613, "mean_env_wait_ms": 3.412579424875666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011684894561767578, "StateBufferConnector_ms": 0.007979631423950195, "ViewRequirementAgentConnector_ms": 0.19088149070739746}, "num_episodes": 28, "episode_return_max": -64.69614314636092, "episode_return_min": -1337.3615027757724, "episode_return_mean": -713.3993543268427, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.9138268341199, "num_env_steps_trained_throughput_per_sec": 306.9138268341199, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13039.609, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13039.535, "sample_time_ms": 1136.049, "learn_time_ms": 11838.208, "learn_throughput": 337.889, "synch_weights_time_ms": 64.509}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00006", "date": "2024-08-04_08-30-07", "timestamp": 1722740407, "time_this_iter_s": 13.044317245483398, "time_total_s": 166.84091091156006, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.84091091156006, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.08675184249878, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.151665067672729, "policy_loss": -0.014893982667126692, "vf_loss": 4.1621029940744245, "vf_explained_var": 0.9778656103337805, "kl": 0.015187616846158875, "entropy": 1.0022569815938671, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -11.913098792781664, "episode_reward_min": -1337.3615027757724, "episode_reward_mean": -706.4523937304606, "episode_len_mean": 142.44, "episode_media": {}, "episodes_timesteps_total": 14244, "policy_reward_min": {"policy_0": -1337.3615027757724}, "policy_reward_max": {"policy_0": -11.913098792781664}, "policy_reward_mean": {"policy_0": -706.4523937304606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587], "episode_lengths": [150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 56, 150, 150, 150, 80, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 117, 44, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-641.6043918603372, -1263.515728349517, -381.28908960020004, -621.9301004240754, -1125.412286885884, -613.9671341702548, -655.9915110536483, -678.4567295460274, -883.1723014308176, -515.2799749239254, -865.7489672308596, -493.9627303793408, -712.5709568540757, -1048.696137313926, -659.9363455806429, -88.67463577801435, -911.2514694598258, -482.5381513118842, -1019.7473422429641, -64.69614314636092, -772.7779234317786, -770.6868530218128, -1060.4706900324334, -112.74470763725628, -404.52143134888144, -853.2152787804333, -900.0809852468088, -585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570367092317925, "mean_inference_ms": 1.6722876892462295, "mean_action_processing_ms": 0.2755587343074362, "mean_env_wait_ms": 3.4129851562141376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079715728759766, "StateBufferConnector_ms": 0.007913827896118164, "ViewRequirementAgentConnector_ms": 0.19943475723266602}, "num_episodes": 26, "episode_return_max": -11.913098792781664, "episode_return_min": -1337.3615027757724, "episode_return_mean": -706.4523937304606, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.45271445157323, "num_env_steps_trained_throughput_per_sec": 302.45271445157323, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13058.006, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13057.933, "sample_time_ms": 1138.835, "learn_time_ms": 11853.379, "learn_throughput": 337.457, "synch_weights_time_ms": 64.948}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00006", "date": "2024-08-04_08-30-20", "timestamp": 1722740420, "time_this_iter_s": 13.237990140914917, "time_total_s": 180.07890105247498, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aeef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.07890105247498, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.189473684210526, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.49077216784158, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.498902085671822, "policy_loss": -0.012840366121478534, "vf_loss": 4.508047825594743, "vf_explained_var": 0.9687180594851573, "kl": 0.012677680870001507, "entropy": 1.0867037993545334, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -11.913098792781664, "episode_reward_min": -1337.3615027757724, "episode_reward_mean": -695.7914709718789, "episode_len_mean": 142.51, "episode_media": {}, "episodes_timesteps_total": 14251, "policy_reward_min": {"policy_0": -1337.3615027757724}, "policy_reward_max": {"policy_0": -11.913098792781664}, "policy_reward_mean": {"policy_0": -695.7914709718789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945], "episode_lengths": [150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 117, 44, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 150, 150, 150, 150, 150, 150, 150, 67, 146, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-585.1620298100174, -930.622746439584, -515.4414141182137, -881.651969733687, -978.445006659536, -1064.8775603437894, -1174.1744067012098, -637.8467224198379, -254.4964956079138, -583.7779693240823, -316.1585862640601, -1073.2627260620475, -458.60851434986813, -1208.8959405998087, -760.5436763553369, -885.6792570409347, -955.8133579357, -648.4212453269053, -1166.1274448310178, -1141.6010135048214, -749.2617213345263, -407.601091768419, -568.5614639402124, -1171.1121748608937, -578.1129270156506, -1219.5287302330753, -480.6544666239844, -889.5571859054786, -917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574827943532288, "mean_inference_ms": 1.6734131006953232, "mean_action_processing_ms": 0.2754844640977689, "mean_env_wait_ms": 3.4136273356615527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011941671371459961, "StateBufferConnector_ms": 0.00797891616821289, "ViewRequirementAgentConnector_ms": 0.2008063793182373}, "num_episodes": 27, "episode_return_max": -11.913098792781664, "episode_return_min": -1337.3615027757724, "episode_return_mean": -695.7914709718789, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.61736569705465, "num_env_steps_trained_throughput_per_sec": 304.61736569705465, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13047.986, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13047.914, "sample_time_ms": 1132.195, "learn_time_ms": 11850.667, "learn_throughput": 337.534, "synch_weights_time_ms": 64.293}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00006", "date": "2024-08-04_08-30-33", "timestamp": 1722740433, "time_this_iter_s": 13.144080400466919, "time_total_s": 193.2229814529419, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447adea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.2229814529419, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.957894736842103, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.8016396900018, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.054331638415655, "policy_loss": -0.007718093127186876, "vf_loss": 4.058599286278089, "vf_explained_var": 0.9670095017179847, "kl": 0.011876079722818152, "entropy": 1.1237513373916348, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -11.913098792781664, "episode_reward_min": -1337.3615027757724, "episode_reward_mean": -695.75308656087, "episode_len_mean": 141.65, "episode_media": {}, "episodes_timesteps_total": 14165, "policy_reward_min": {"policy_0": -1337.3615027757724}, "policy_reward_max": {"policy_0": -11.913098792781664}, "policy_reward_mean": {"policy_0": -695.75308656087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339], "episode_lengths": [150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 117, 44, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 150, 150, 150, 150, 150, 150, 150, 67, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 96, 150, 150], "policy_policy_0_reward": [-917.6859084758407, -1337.3615027757724, -355.62789255428106, -682.0893799857311, -632.0813324425975, -856.5267659355691, -886.1205673425085, -1081.5276826013796, -322.4766786770004, -798.1750385022829, -702.2137048963501, -651.116672168844, -948.2412993156712, -1125.3473560767764, -327.2304817868919, -564.8962236303875, -615.9586275097871, -560.209386732074, -404.7679587619052, -937.5757949470446, -89.95610191208756, -1138.062320258704, -456.2636964004219, -463.1769218835905, -14.674039482440637, -724.646805553445, -708.5228617574136, -1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579242509016626, "mean_inference_ms": 1.671586481823189, "mean_action_processing_ms": 0.2751730399535047, "mean_env_wait_ms": 3.413618428003147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01222538948059082, "StateBufferConnector_ms": 0.007838964462280273, "ViewRequirementAgentConnector_ms": 0.20002341270446777}, "num_episodes": 28, "episode_return_max": -11.913098792781664, "episode_return_min": -1337.3615027757724, "episode_return_mean": -695.75308656087, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.5361581255747, "num_env_steps_trained_throughput_per_sec": 312.5361581255747, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12989.018, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12988.947, "sample_time_ms": 1126.93, "learn_time_ms": 11796.149, "learn_throughput": 339.094, "synch_weights_time_ms": 65.102}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00006", "date": "2024-08-04_08-30-46", "timestamp": 1722740446, "time_this_iter_s": 12.811650276184082, "time_total_s": 206.03463172912598, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575c280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.03463172912598, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.427777777777777, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.69534409443537, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.0438850631316505, "policy_loss": -0.010388772061560303, "vf_loss": 4.050039332856735, "vf_explained_var": 0.983612624866267, "kl": 0.014488188187472903, "entropy": 1.119509365223348, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -11.913098792781664, "episode_reward_min": -1308.860553051217, "episode_reward_mean": -699.6212917993848, "episode_len_mean": 142.17, "episode_media": {}, "episodes_timesteps_total": 14217, "policy_reward_min": {"policy_0": -1308.860553051217}, "policy_reward_max": {"policy_0": -11.913098792781664}, "policy_reward_mean": {"policy_0": -699.6212917993848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439], "episode_lengths": [150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 150, 150, 150, 150, 150, 150, 150, 67, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 58, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1086.131825170533, -661.9541838169459, -609.2049919520994, -11.913098792781664, -557.1303293374136, -674.7601934245537, -537.2247037417235, -435.94317192002495, -770.5895121869754, -1100.1707826086922, -513.4829863076931, -976.3944700741135, -246.41481927731076, -851.4253325667706, -527.7549912769153, -397.9970433649495, -450.82617154847105, -1044.4499211587, -1082.5278783353458, -112.95852841176634, -1094.6094340145814, -568.3660118464111, -1039.2640522610081, -844.3327174225433, -423.40043174706744, -904.1690747663855, -488.4680512360447, -423.08386051794696, -1077.6563480960745, -50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578800458021341, "mean_inference_ms": 1.672562298176619, "mean_action_processing_ms": 0.2754421219122774, "mean_env_wait_ms": 3.41813482413953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012166976928710938, "StateBufferConnector_ms": 0.007947206497192383, "ViewRequirementAgentConnector_ms": 0.20072197914123535}, "num_episodes": 27, "episode_return_max": -11.913098792781664, "episode_return_min": -1308.860553051217, "episode_return_mean": -699.6212917993848, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.05413616655284, "num_env_steps_trained_throughput_per_sec": 307.05413616655284, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12985.834, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12985.763, "sample_time_ms": 1131.572, "learn_time_ms": 11787.533, "learn_throughput": 339.342, "synch_weights_time_ms": 65.854}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00006", "date": "2024-08-04_08-30-59", "timestamp": 1722740459, "time_this_iter_s": 13.039216041564941, "time_total_s": 219.07384777069092, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aeef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.07384777069092, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.15789473684211, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.4772647202015, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.370305409779151, "policy_loss": -0.009497513422199214, "vf_loss": 4.376410936315854, "vf_explained_var": 0.9825742765019337, "kl": 0.011667532593916513, "entropy": 1.0826704687749347, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -50.78680693070603, "episode_reward_min": -1379.4380708879141, "episode_reward_mean": -722.0859360228699, "episode_len_mean": 141.63, "episode_media": {}, "episodes_timesteps_total": 14163, "policy_reward_min": {"policy_0": -1379.4380708879141}, "policy_reward_max": {"policy_0": -50.78680693070603}, "policy_reward_mean": {"policy_0": -722.0859360228699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096], "episode_lengths": [63, 150, 150, 150, 150, 150, 150, 150, 67, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 58, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 74, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-50.78680693070603, -691.1331538098681, -349.81682652242944, -549.9202227488692, -544.107591935981, -539.6523462106942, -446.9884361033423, -567.7158733495768, -141.7949547827103, -699.3209378280162, -1253.6382451826119, -1284.5347278336017, -604.1762641277251, -750.2524586508406, -606.3301554118109, -397.84233109984945, -362.54890395303664, -807.4522013060279, -678.9533687313682, -499.3012537971547, -801.1982529428951, -1308.860553051217, -391.8792449735063, -526.0529377429355, -781.6176393094271, -388.22967743791776, -932.8584639640098, -1000.5062002636236, -776.1463938078261, -862.0922437656284, -315.5561488723317, -1046.8339881931504, -1303.5295570851924, -1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574652148289178, "mean_inference_ms": 1.672130618362184, "mean_action_processing_ms": 0.275505710504388, "mean_env_wait_ms": 3.416292531276282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.00801396369934082, "ViewRequirementAgentConnector_ms": 0.19214940071105957}, "num_episodes": 29, "episode_return_max": -50.78680693070603, "episode_return_min": -1379.4380708879141, "episode_return_mean": -722.0859360228699, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.50578711281617, "num_env_steps_trained_throughput_per_sec": 312.50578711281617, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12966.386, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12966.315, "sample_time_ms": 1127.8, "learn_time_ms": 11772.541, "learn_throughput": 339.774, "synch_weights_time_ms": 65.18}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00006", "date": "2024-08-04_08-31-12", "timestamp": 1722740472, "time_this_iter_s": 12.812376260757446, "time_total_s": 231.88622403144836, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575e200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.88622403144836, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.100000000000005, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.05353294610978, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.4189992415408295, "policy_loss": -0.013432216849469113, "vf_loss": 4.4288108396033445, "vf_explained_var": 0.9743710191299518, "kl": 0.012427353816292463, "entropy": 1.075968695494036, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -20.26059426240015, "episode_reward_min": -1434.2739053637913, "episode_reward_mean": -723.317778463937, "episode_len_mean": 138.78, "episode_media": {}, "episodes_timesteps_total": 13878, "policy_reward_min": {"policy_0": -1434.2739053637913}, "policy_reward_max": {"policy_0": -20.26059426240015}, "policy_reward_mean": {"policy_0": -723.317778463937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249], "episode_lengths": [150, 150, 150, 150, 150, 98, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 58, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 74, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 66, 69, 138, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 130, 40, 150, 69, 150, 142, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1284.3533564528398, -750.1954450469987, -1043.3268306789535, -948.3546567857111, -949.4487508439391, -328.1166909110386, -980.9867846699141, -1249.3404588810897, -316.42368986923634, -1007.1107266314248, -640.884984041339, -513.3720969711869, -872.7552677006961, -1122.3722914605187, -753.1727404598226, -836.0316003237215, -452.5443468547828, -887.6528088052366, -485.7139781089376, -173.32856185424538, -856.8297029020954, -540.2267239286683, -1055.0348953260614, -85.02948453687416, -972.3783708775974, -570.0093069350525, -874.7228508423208, -1049.5783805805797, -728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573170216668586, "mean_inference_ms": 1.6721823808777128, "mean_action_processing_ms": 0.2754314113080528, "mean_env_wait_ms": 3.4155004923987407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012189626693725586, "StateBufferConnector_ms": 0.008030891418457031, "ViewRequirementAgentConnector_ms": 0.19274210929870605}, "num_episodes": 33, "episode_return_max": -20.26059426240015, "episode_return_min": -1434.2739053637913, "episode_return_mean": -723.317778463937, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1189838715641, "num_env_steps_trained_throughput_per_sec": 307.1189838715641, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12990.532, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12990.46, "sample_time_ms": 1126.912, "learn_time_ms": 11798.152, "learn_throughput": 339.036, "synch_weights_time_ms": 64.601}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00006", "date": "2024-08-04_08-31-25", "timestamp": 1722740485, "time_this_iter_s": 13.037474870681763, "time_total_s": 244.92369890213013, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.92369890213013, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.35, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 247.46004914045335, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.326718938102325, "policy_loss": -0.012149392012603736, "vf_loss": 4.335643320779005, "vf_explained_var": 0.9850159114847581, "kl": 0.011095026599870546, "entropy": 1.0349044842645525, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -20.26059426240015, "episode_reward_min": -1434.2739053637913, "episode_reward_mean": -690.4786841944883, "episode_len_mean": 137.88, "episode_media": {}, "episodes_timesteps_total": 13788, "policy_reward_min": {"policy_0": -1434.2739053637913}, "policy_reward_max": {"policy_0": -20.26059426240015}, "policy_reward_mean": {"policy_0": -690.4786841944883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898], "episode_lengths": [150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 74, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 66, 69, 138, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 130, 40, 150, 69, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 55, 150], "policy_policy_0_reward": [-728.1303705929754, -263.76193521037476, -452.5870161896093, -1023.6204268518038, -1138.900765573131, -672.4911207902406, -821.7525730225932, -636.229660430519, -263.44210101699286, -587.6841480716439, -390.44074547184505, -415.9492603623149, -58.73394495526726, -972.8315690006082, -418.82154359730123, -1099.5721906309577, -180.75710703933714, -1233.4616410225674, -498.7940999066694, -294.64468090655225, -516.4616463635696, -1097.064370563482, -1277.279364381152, -1249.481732414716, -942.5322456992753, -732.64007814229, -726.2649843555587, -841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568440040515356, "mean_inference_ms": 1.6736831356409396, "mean_action_processing_ms": 0.27579367286163003, "mean_env_wait_ms": 3.4195651226870996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012233257293701172, "StateBufferConnector_ms": 0.007858037948608398, "ViewRequirementAgentConnector_ms": 0.19130969047546387}, "num_episodes": 28, "episode_return_max": -20.26059426240015, "episode_return_min": -1434.2739053637913, "episode_return_mean": -690.4786841944883, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.805983363308, "num_env_steps_trained_throughput_per_sec": 308.805983363308, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13032.706, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13032.635, "sample_time_ms": 1131.105, "learn_time_ms": 11836.484, "learn_throughput": 337.938, "synch_weights_time_ms": 64.244}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00006", "date": "2024-08-04_08-31-38", "timestamp": 1722740498, "time_this_iter_s": 12.9644296169281, "time_total_s": 257.8881285190582, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bbd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.8881285190582, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.978947368421053, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 264.4675449391206, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.953209982315699, "policy_loss": -0.011069327449270834, "vf_loss": 3.960439296811819, "vf_explained_var": 0.9840226482599974, "kl": 0.013137865369208157, "entropy": 1.0134134131173294, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -20.26059426240015, "episode_reward_min": -1434.2739053637913, "episode_reward_mean": -651.1955810035008, "episode_len_mean": 135.88, "episode_media": {}, "episodes_timesteps_total": 13588, "policy_reward_min": {"policy_0": -1434.2739053637913}, "policy_reward_max": {"policy_0": -20.26059426240015}, "policy_reward_mean": {"policy_0": -651.1955810035008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495], "episode_lengths": [150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 66, 69, 138, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 130, 40, 150, 69, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 55, 150, 143, 150, 83, 150, 150, 46, 150, 150, 62, 150, 150, 150, 72, 79, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150], "policy_policy_0_reward": [-841.6266553201244, -1199.111433267856, -102.08804821164462, -997.2523993256946, -408.71741880186204, -1172.418342881215, -694.658719138354, -1026.2390947843132, -462.77908950375627, -1379.4380708879141, -996.8853800370332, -372.123482557096, -909.509412310802, -439.60486270042463, -530.5937243589382, -532.1010075024988, -98.61779255513473, -98.0600549988505, -391.9957948402209, -1376.3818160941994, -897.6455745253843, -497.0834247056215, -542.259013671729, -682.0323813561508, -441.58898769883956, -1083.1468815096064, -1146.297962186532, -436.2467965362549, -1434.2739053637913, -379.15303853918493, -634.423393118982, -1091.9691551772985, -373.12726622123876, -449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567513792635748, "mean_inference_ms": 1.6736673520618626, "mean_action_processing_ms": 0.2755175707257171, "mean_env_wait_ms": 3.4180712690060373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012029886245727539, "StateBufferConnector_ms": 0.00790262222290039, "ViewRequirementAgentConnector_ms": 0.1936779022216797}, "num_episodes": 27, "episode_return_max": -20.26059426240015, "episode_return_min": -1434.2739053637913, "episode_return_mean": -651.1955810035008, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0630138026618, "num_env_steps_trained_throughput_per_sec": 311.0630138026618, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12985.386, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12985.316, "sample_time_ms": 1126.183, "learn_time_ms": 11794.549, "learn_throughput": 339.14, "synch_weights_time_ms": 63.791}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00006", "date": "2024-08-04_08-31-51", "timestamp": 1722740511, "time_this_iter_s": 12.870810508728027, "time_total_s": 270.75893902778625, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ba7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.75893902778625, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.05, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.7683465719223, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.187885933866103, "policy_loss": -0.008900601976589921, "vf_loss": 4.193065995474656, "vf_explained_var": 0.9867194823920726, "kl": 0.012730615188835765, "entropy": 0.98642225364844, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -20.26059426240015, "episode_reward_min": -1342.7551802674443, "episode_reward_mean": -614.1368902462942, "episode_len_mean": 134.23, "episode_media": {}, "episodes_timesteps_total": 13423, "policy_reward_min": {"policy_0": -1342.7551802674443}, "policy_reward_max": {"policy_0": -20.26059426240015}, "policy_reward_mean": {"policy_0": -614.1368902462942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301], "episode_lengths": [130, 40, 150, 69, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 55, 150, 143, 150, 83, 150, 150, 46, 150, 150, 62, 150, 150, 150, 72, 79, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 63, 150, 150, 101, 40, 150, 141, 150, 46, 150, 150, 150, 150, 150, 53, 134], "policy_policy_0_reward": [-449.7069302431197, -20.26059426240015, -1229.3948443075767, -156.89856628511646, -1086.9341519638012, -909.8812796640542, -485.16619473171454, -818.1946518159768, -387.716769445424, -903.2969893730315, -1084.8046657795678, -836.4447219891249, -756.4470962810112, -572.052457420155, -599.4583889463551, -1114.7057935088917, -78.0207684042252, -569.7915538395682, -432.51286328619506, -683.3506297607023, -439.47662711693306, -71.4925346431581, -1130.623695144966, -572.6228084360592, -877.1983242632048, -972.647620473998, -1131.1461672432047, -566.0147816896404, -804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565535607105927, "mean_inference_ms": 1.6736975349750918, "mean_action_processing_ms": 0.27544586984050035, "mean_env_wait_ms": 3.418303126710817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011824607849121094, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.19608354568481445}, "num_episodes": 33, "episode_return_max": -20.26059426240015, "episode_return_min": -1342.7551802674443, "episode_return_mean": -614.1368902462942, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7213001827068, "num_env_steps_trained_throughput_per_sec": 311.7213001827068, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12968.333, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12968.264, "sample_time_ms": 1122.931, "learn_time_ms": 11779.775, "learn_throughput": 339.565, "synch_weights_time_ms": 64.759}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00006", "date": "2024-08-04_08-32-04", "timestamp": 1722740524, "time_this_iter_s": 12.84571123123169, "time_total_s": 283.60465025901794, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575e320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.60465025901794, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.344444444444445, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.66568855047225, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.34337716922164, "policy_loss": -0.011162376055532755, "vf_loss": 4.350577997167905, "vf_explained_var": 0.9801733390738566, "kl": 0.013551435985573335, "entropy": 1.0387223329395057, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -21.17107585026122, "episode_reward_min": -1342.7551802674443, "episode_reward_mean": -591.4085855612942, "episode_len_mean": 133.69, "episode_media": {}, "episodes_timesteps_total": 13369, "policy_reward_min": {"policy_0": -1342.7551802674443}, "policy_reward_max": {"policy_0": -21.17107585026122}, "policy_reward_mean": {"policy_0": -591.4085855612942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138], "episode_lengths": [150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 55, 150, 143, 150, 83, 150, 150, 46, 150, 150, 62, 150, 150, 150, 72, 79, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 63, 150, 150, 101, 40, 150, 141, 150, 46, 150, 150, 150, 150, 150, 53, 134, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 96, 52, 150, 91, 150, 107, 150, 150, 59, 150, 150, 150], "policy_policy_0_reward": [-804.9836986561126, -733.3414561781819, -77.83646936051144, -935.343614298154, -1179.474777915435, -420.08865875763854, -454.86904119710084, -745.2906986826355, -369.7241156871792, -702.2092130608887, -45.90205380953482, -1278.7604482743898, -577.2727140034968, -407.6519023504247, -129.4176662345393, -926.3775912734632, -351.19740293693263, -21.17107585026122, -705.476115576091, -966.5411065223649, -72.83938585657455, -806.4558121126761, -692.3802702578289, -761.5901287814686, -223.71169879816796, -157.28563856663462, -876.8990211298963, -602.2354214019998, -746.4766534780284, -1008.6308764311107, -649.289577483951, -395.3171881757485, -505.7961529434075, -390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563610940230261, "mean_inference_ms": 1.6734058274865355, "mean_action_processing_ms": 0.27529616667753853, "mean_env_wait_ms": 3.4168631516333954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011780261993408203, "StateBufferConnector_ms": 0.008014440536499023, "ViewRequirementAgentConnector_ms": 0.19531846046447754}, "num_episodes": 28, "episode_return_max": -21.17107585026122, "episode_return_min": -1342.7551802674443, "episode_return_mean": -591.4085855612942, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.96448088839537, "num_env_steps_trained_throughput_per_sec": 310.96448088839537, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12951.356, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12951.288, "sample_time_ms": 1122.064, "learn_time_ms": 11763.613, "learn_throughput": 340.032, "synch_weights_time_ms": 64.82}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00006", "date": "2024-08-04_08-32-17", "timestamp": 1722740537, "time_this_iter_s": 12.875019550323486, "time_total_s": 296.47966980934143, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.47966980934143, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.894736842105267, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.05942626992862, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.165111666421096, "policy_loss": -0.012182103762946402, "vf_loss": 4.173241106669108, "vf_explained_var": 0.9850956458598376, "kl": 0.013804308565219496, "entropy": 0.8861562112967173, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -24.029458984570553, "episode_reward_min": -1342.7551802674443, "episode_reward_mean": -567.7265149857693, "episode_len_mean": 132.86, "episode_media": {}, "episodes_timesteps_total": 13286, "policy_reward_min": {"policy_0": -1342.7551802674443}, "policy_reward_max": {"policy_0": -24.029458984570553}, "policy_reward_mean": {"policy_0": -567.7265149857693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549], "episode_lengths": [150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 63, 150, 150, 101, 40, 150, 141, 150, 46, 150, 150, 150, 150, 150, 53, 134, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 96, 52, 150, 91, 150, 107, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 86, 150, 37, 150, 150, 66, 150, 150, 117, 119, 94, 65, 150, 150, 150, 150, 150, 69, 150, 150, 150, 75, 150], "policy_policy_0_reward": [-390.1485307403459, -418.17897707994587, -498.49457038733317, -502.81945735495196, -513.6242285830083, -858.7418391539495, -1143.7676877092008, -1061.7108935021809, -974.9373777197932, -748.1435606960443, -396.7837741863998, -916.0524815937806, -492.5652387245704, -452.4064529567032, -596.7225389822618, -832.0504803956503, -164.98330255808295, -382.71894684466116, -1342.7551802674443, -542.7051692272051, -339.31915614223124, -511.86802412033126, -788.525459214257, -69.01618163066257, -868.894151106312, -365.7869410864893, -295.7622812370883, -69.6899553420293, -1177.4737279630194, -754.5418661518204, -425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562354644255741, "mean_inference_ms": 1.672310612268571, "mean_action_processing_ms": 0.2751538330276621, "mean_env_wait_ms": 3.411687672784127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01573348045349121, "StateBufferConnector_ms": 0.008065223693847656, "ViewRequirementAgentConnector_ms": 0.196852445602417}, "num_episodes": 33, "episode_return_max": -24.029458984570553, "episode_return_min": -1342.7551802674443, "episode_return_mean": -567.7265149857693, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.5322063338448, "num_env_steps_trained_throughput_per_sec": 297.5322063338448, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12973.227, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12973.16, "sample_time_ms": 1114.877, "learn_time_ms": 11793.402, "learn_throughput": 339.173, "synch_weights_time_ms": 64.081}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00006", "date": "2024-08-04_08-32-30", "timestamp": 1722740550, "time_this_iter_s": 13.456384658813477, "time_total_s": 309.9360544681549, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ba7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.9360544681549, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.842105263157897, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 231.990942466259, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.00130568134288, "policy_loss": -0.015548981847435547, "vf_loss": 4.01212739944458, "vf_explained_var": 0.9870821892594298, "kl": 0.016033891033998784, "entropy": 0.8290045995265245, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -24.029458984570553, "episode_reward_min": -1324.4991183435586, "episode_reward_mean": -539.1656779520798, "episode_len_mean": 132.48, "episode_media": {}, "episodes_timesteps_total": 13248, "policy_reward_min": {"policy_0": -1324.4991183435586}, "policy_reward_max": {"policy_0": -24.029458984570553}, "policy_reward_mean": {"policy_0": -539.1656779520798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324], "episode_lengths": [150, 46, 150, 150, 150, 150, 150, 53, 134, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 96, 52, 150, 91, 150, 107, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 86, 150, 37, 150, 150, 66, 150, 150, 117, 119, 94, 65, 150, 150, 150, 150, 150, 69, 150, 150, 150, 75, 150, 130, 78, 150, 150, 144, 123, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 72, 150, 150, 150, 150, 53], "policy_policy_0_reward": [-425.19114327251884, -24.029458984570553, -371.5314728767435, -1083.1572714845747, -1094.943701907738, -563.5332161440198, -655.0570631276826, -41.19959590150968, -415.757551910301, -97.67520628441683, -444.26489507724136, -1282.0373438052673, -751.3304855498677, -599.1410044849752, -334.7620149786025, -882.224370241288, -433.5623337500164, -847.2944790960786, -495.41086814457816, -882.0385033029418, -973.9422079583348, -790.5076250426547, -813.1143159924707, -324.2734995324616, -698.3753980567817, -398.8242547625622, -90.42082007171592, -532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562066050372707, "mean_inference_ms": 1.672875795851349, "mean_action_processing_ms": 0.27502778809784245, "mean_env_wait_ms": 3.4106368513367187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564478874206543, "StateBufferConnector_ms": 0.007910728454589844, "ViewRequirementAgentConnector_ms": 0.1934053897857666}, "num_episodes": 30, "episode_return_max": -24.029458984570553, "episode_return_min": -1324.4991183435586, "episode_return_mean": -539.1656779520798, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.35640759497784, "num_env_steps_trained_throughput_per_sec": 304.35640759497784, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12974.353, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12974.286, "sample_time_ms": 1127.133, "learn_time_ms": 11783.18, "learn_throughput": 339.467, "synch_weights_time_ms": 63.173}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00006", "date": "2024-08-04_08-32-44", "timestamp": 1722740564, "time_this_iter_s": 13.156774520874023, "time_total_s": 323.09282898902893, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447afe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 323.09282898902893, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.878947368421056, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.7556614180406, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.256081511328618, "policy_loss": -0.010936781604929518, "vf_loss": 4.263522445907196, "vf_explained_var": 0.9839041583240032, "kl": 0.011942067899265885, "entropy": 0.8677851070960363, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -29.725562646217618, "episode_reward_min": -1411.275674689484, "episode_reward_mean": -530.5768529482314, "episode_len_mean": 132.4, "episode_media": {}, "episodes_timesteps_total": 13240, "policy_reward_min": {"policy_0": -1411.275674689484}, "policy_reward_max": {"policy_0": -29.725562646217618}, "policy_reward_mean": {"policy_0": -530.5768529482314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681], "episode_lengths": [150, 91, 150, 107, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 86, 150, 37, 150, 150, 66, 150, 150, 117, 119, 94, 65, 150, 150, 150, 150, 150, 69, 150, 150, 150, 75, 150, 130, 78, 150, 150, 144, 123, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 72, 150, 150, 150, 150, 53, 147, 89, 150, 98, 150, 121, 150, 150, 150, 148, 150, 50, 150, 150, 150, 150, 150, 53, 150, 70, 150, 150, 150, 150, 150, 92, 150], "policy_policy_0_reward": [-532.9639270925625, -215.43693769413616, -426.8844090490216, -335.03325964983577, -467.815633522348, -924.2268517403853, -148.24110259180426, -984.6347736825898, -450.20324059072163, -1038.7922400735138, -1126.438885095413, -831.7362220700501, -1324.4991183435586, -465.7672629518858, -334.8354268455874, -380.892383758105, -960.1912451056447, -517.9163002525365, -468.8387139374668, -154.89007308566462, -212.3225398497289, -520.738744470369, -60.29918338684525, -688.2395063781099, -536.7006178264111, -167.32095832173016, -536.3825666031229, -525.4826761984144, -416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562182723002672, "mean_inference_ms": 1.6734744141232363, "mean_action_processing_ms": 0.275287347349629, "mean_env_wait_ms": 3.410609806363727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015636444091796875, "StateBufferConnector_ms": 0.007765054702758789, "ViewRequirementAgentConnector_ms": 0.19022631645202637}, "num_episodes": 27, "episode_return_max": -29.725562646217618, "episode_return_min": -1411.275674689484, "episode_return_mean": -530.5768529482314, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9366391208922, "num_env_steps_trained_throughput_per_sec": 308.9366391208922, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12989.265, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12989.197, "sample_time_ms": 1125.43, "learn_time_ms": 11798.888, "learn_throughput": 339.015, "synch_weights_time_ms": 64.07}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00006", "date": "2024-08-04_08-32-57", "timestamp": 1722740577, "time_this_iter_s": 12.960341453552246, "time_total_s": 336.0531704425812, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447aecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 336.0531704425812, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.216666666666665, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 234.73168369531632, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.8003151008238394, "policy_loss": -0.015813615941927612, "vf_loss": 3.8120281234383584, "vf_explained_var": 0.9875575872759025, "kl": 0.014000907070658286, "entropy": 0.9967845037579537, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -29.725562646217618, "episode_reward_min": -1411.275674689484, "episode_reward_mean": -560.5192600121484, "episode_len_mean": 135.69, "episode_media": {}, "episodes_timesteps_total": 13569, "policy_reward_min": {"policy_0": -1411.275674689484}, "policy_reward_max": {"policy_0": -29.725562646217618}, "policy_reward_mean": {"policy_0": -560.5192600121484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531], "episode_lengths": [117, 119, 94, 65, 150, 150, 150, 150, 150, 69, 150, 150, 150, 75, 150, 130, 78, 150, 150, 144, 123, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 72, 150, 150, 150, 150, 53, 147, 89, 150, 98, 150, 121, 150, 150, 150, 148, 150, 50, 150, 150, 150, 150, 150, 53, 150, 70, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 111, 95, 150, 116, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-416.33768483444675, -215.93129179204544, -150.51405330239692, -75.904675550662, -1209.3160307860437, -426.0232780899101, -770.6429668470494, -489.3661367664075, -1030.0338135944812, -100.72939536866095, -529.8837373771547, -877.0153116799203, -452.2243353158232, -114.7364060483387, -291.4790466563549, -231.04959209103393, -93.40724379131308, -721.4674702406857, -364.3188372155435, -372.13347614404296, -196.4005847290162, -571.9951594923011, -1128.9445212458186, -373.62258147420715, -720.362113842226, -279.99264790599887, -416.209387989952, -679.9892152134042, -655.0047763738352, -874.3421479821699, -502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560691750503589, "mean_inference_ms": 1.6758394119308853, "mean_action_processing_ms": 0.27594218737918325, "mean_env_wait_ms": 3.413161535418376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011788368225097656, "StateBufferConnector_ms": 0.007703065872192383, "ViewRequirementAgentConnector_ms": 0.1882038116455078}, "num_episodes": 28, "episode_return_max": -29.725562646217618, "episode_return_min": -1411.275674689484, "episode_return_mean": -560.5192600121484, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.22940370032205, "num_env_steps_trained_throughput_per_sec": 298.22940370032205, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 13027.812, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13027.745, "sample_time_ms": 1121.143, "learn_time_ms": 11841.995, "learn_throughput": 337.781, "synch_weights_time_ms": 63.835}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00006", "date": "2024-08-04_08-33-10", "timestamp": 1722740590, "time_this_iter_s": 13.423462867736816, "time_total_s": 349.476633310318, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575d120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 349.476633310318, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.14736842105263, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.93078659574192, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.777084266146024, "policy_loss": -0.009961932112734455, "vf_loss": 3.783257116377354, "vf_explained_var": 0.9833258281772336, "kl": 0.012926326603246708, "entropy": 0.8881289072334766, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -29.725562646217618, "episode_reward_min": -1411.275674689484, "episode_reward_mean": -576.2475637767693, "episode_len_mean": 138.29, "episode_media": {}, "episodes_timesteps_total": 13829, "policy_reward_min": {"policy_0": -1411.275674689484}, "policy_reward_max": {"policy_0": -29.725562646217618}, "policy_reward_mean": {"policy_0": -576.2475637767693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977], "episode_lengths": [150, 150, 150, 150, 94, 150, 150, 150, 150, 72, 150, 150, 150, 150, 53, 147, 89, 150, 98, 150, 121, 150, 150, 150, 148, 150, 50, 150, 150, 150, 150, 150, 53, 150, 70, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 111, 95, 150, 116, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 141, 150, 107, 108, 150, 150, 150, 145, 150, 150, 150, 125, 150, 92, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-502.1095657159138, -531.3451919380732, -486.7163033010998, -868.5780692833182, -131.46630053227415, -479.39626387252815, -689.7679731371335, -886.9499988412476, -267.41277039309375, -79.52541645622055, -1011.0687815211415, -402.0382757214636, -257.0349350980275, -1294.2457403241697, -48.20938742155324, -346.5404560173036, -122.82384505978021, -762.0673420523431, -184.07898282461343, -536.1496873157166, -346.47276574075454, -440.2054853713111, -282.7162574178098, -1411.275674689484, -486.4325414834956, -1055.8965749917, -29.725562646217618, -779.1173473632915, -346.66665954041406, -750.3062036289605, -322.60814501642216, -1152.4012820914668, -37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565627371213091, "mean_inference_ms": 1.6752110387941845, "mean_action_processing_ms": 0.2757491669852053, "mean_env_wait_ms": 3.411338972067879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011730432510375977, "StateBufferConnector_ms": 0.007802486419677734, "ViewRequirementAgentConnector_ms": 0.18938207626342773}, "num_episodes": 30, "episode_return_max": -29.725562646217618, "episode_return_min": -1411.275674689484, "episode_return_mean": -576.2475637767693, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.45349729282873, "num_env_steps_trained_throughput_per_sec": 305.45349729282873, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13057.364, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13057.297, "sample_time_ms": 1122.5, "learn_time_ms": 11868.46, "learn_throughput": 337.028, "synch_weights_time_ms": 65.564}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00006", "date": "2024-08-04_08-33-23", "timestamp": 1722740603, "time_this_iter_s": 13.108845710754395, "time_total_s": 362.5854790210724, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 362.5854790210724, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.805263157894736, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.84451317191125, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.8425558406859635, "policy_loss": -0.011631477278327414, "vf_loss": 3.8501929737627507, "vf_explained_var": 0.9839946955442429, "kl": 0.013596111547728192, "entropy": 0.8448203191161155, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -27.81128452308286, "episode_reward_min": -1236.9494718188564, "episode_reward_mean": -564.4270222805043, "episode_len_mean": 134.5, "episode_media": {}, "episodes_timesteps_total": 13450, "policy_reward_min": {"policy_0": -1236.9494718188564}, "policy_reward_max": {"policy_0": -27.81128452308286}, "policy_reward_mean": {"policy_0": -564.4270222805043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551], "episode_lengths": [53, 150, 70, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 111, 95, 150, 116, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 141, 150, 107, 108, 150, 150, 150, 145, 150, 150, 150, 125, 150, 92, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 53, 150, 78, 81, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 127, 75, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 51, 48, 99, 150], "policy_policy_0_reward": [-37.02704693838648, -525.2277213280437, -160.66477381274143, -854.3197352229159, -289.7108871472989, -893.5821295557771, -946.2204853026321, -813.8517998283417, -366.3227043700822, -712.3055045997681, -427.5511246138195, -1082.5695800541982, -532.2909641748448, -559.2152073480697, -967.4232245449653, -898.0503994782637, -537.3245104761222, -435.7097285897158, -1007.5153273707318, -252.69851436088874, -1079.3273641030073, -781.544753254365, -738.4288428428306, -1236.9494718188564, -310.36942819251124, -134.9802089176022, -489.10562098223556, -439.57033192478156, -381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562720902166761, "mean_inference_ms": 1.674750296965656, "mean_action_processing_ms": 0.27551688498005483, "mean_env_wait_ms": 3.410420883059386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012101888656616211, "StateBufferConnector_ms": 0.007936716079711914, "ViewRequirementAgentConnector_ms": 0.19278669357299805}, "num_episodes": 32, "episode_return_max": -27.81128452308286, "episode_return_min": -1236.9494718188564, "episode_return_mean": -564.4270222805043, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.91895133184505, "num_env_steps_trained_throughput_per_sec": 294.91895133184505, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 13111.242, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13111.176, "sample_time_ms": 1130.86, "learn_time_ms": 11914.835, "learn_throughput": 335.716, "synch_weights_time_ms": 64.709}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00006", "date": "2024-08-04_08-33-37", "timestamp": 1722740617, "time_this_iter_s": 13.574769020080566, "time_total_s": 376.16024804115295, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575dfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 376.16024804115295, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.88421052631579, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 241.78647671540577, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.9403196523586907, "policy_loss": -0.015572010085452347, "vf_loss": 3.9521874589224657, "vf_explained_var": 0.9897401380663117, "kl": 0.01264549250384639, "entropy": 0.8943763393908739, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -27.81128452308286, "episode_reward_min": -1198.5971549679875, "episode_reward_mean": -575.9987736323291, "episode_len_mean": 134.86, "episode_media": {}, "episodes_timesteps_total": 13486, "policy_reward_min": {"policy_0": -1198.5971549679875}, "policy_reward_max": {"policy_0": -27.81128452308286}, "policy_reward_mean": {"policy_0": -575.9987736323291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912], "episode_lengths": [150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 141, 150, 107, 108, 150, 150, 150, 145, 150, 150, 150, 125, 150, 92, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 53, 150, 78, 81, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 127, 75, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 51, 48, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 93, 61, 150, 150, 150, 150, 150, 150, 48, 150, 51], "policy_policy_0_reward": [-381.99628821783324, -1081.3503696148136, -537.1877070753361, -347.4538584850273, -443.3397500521496, -722.779804622337, -675.1808773782926, -392.0982106239956, -929.3226629991377, -910.631374442531, -899.7539162297685, -520.5591222889745, -1081.673818095714, -481.1523372263401, -48.399890373047356, -623.2775679093231, -297.67600164540386, -798.6445869768216, -182.2187530327634, -206.44907111563134, -754.4088252689703, -292.3014896502266, -678.6577587372806, -194.77653400722068, -379.03329109056455, -595.6297462695941, -701.4821053392886, -679.2891929183558, -588.7202660111036, -229.3933833705883, -463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560032264280766, "mean_inference_ms": 1.6744795787140703, "mean_action_processing_ms": 0.27511120636078595, "mean_env_wait_ms": 3.407079661036939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160301208496094, "StateBufferConnector_ms": 0.008019685745239258, "ViewRequirementAgentConnector_ms": 0.1968975067138672}, "num_episodes": 28, "episode_return_max": -27.81128452308286, "episode_return_min": -1198.5971549679875, "episode_return_mean": -575.9987736323291, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4510290078082, "num_env_steps_trained_throughput_per_sec": 311.4510290078082, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 13100.242, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13100.173, "sample_time_ms": 1128.383, "learn_time_ms": 11907.927, "learn_throughput": 335.911, "synch_weights_time_ms": 63.09}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00006", "date": "2024-08-04_08-33-50", "timestamp": 1722740630, "time_this_iter_s": 12.854649066925049, "time_total_s": 389.014897108078, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575feb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 389.014897108078, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.989473684210527, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.31236253380774, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.78497531786561, "policy_loss": -0.011721564803641135, "vf_loss": 3.792969233045975, "vf_explained_var": 0.9743510603904724, "kl": 0.012710076305484127, "entropy": 0.8536488618701696, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -27.81128452308286, "episode_reward_min": -1198.5971549679875, "episode_reward_mean": -574.3686165110537, "episode_len_mean": 133.87, "episode_media": {}, "episodes_timesteps_total": 13387, "policy_reward_min": {"policy_0": -1198.5971549679875}, "policy_reward_max": {"policy_0": -27.81128452308286}, "policy_reward_mean": {"policy_0": -574.3686165110537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931], "episode_lengths": [133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 53, 150, 78, 81, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 127, 75, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 51, 48, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 93, 61, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 130, 150, 150, 150, 150, 97, 150, 120, 150, 150, 52, 150, 141, 150, 150, 150, 150, 150, 150, 138, 150, 104, 150, 150, 46, 150, 150, 150, 150], "policy_policy_0_reward": [-463.20194330781686, -948.4759578911592, -487.2072402087, -455.5965331692328, -352.5434476737057, -852.4217474939044, -452.02718217869653, -1038.203588720782, -670.3078769026612, -448.7251210996977, -106.19246139242219, -27.81128452308286, -411.9143792343371, -69.19013617486596, -298.1862005787767, -380.5740007550177, -1198.5971549679875, -602.3405702131442, -446.78880914755365, -1071.7642247346682, -481.0940428630903, -37.538930742367064, -1184.8818924173434, -585.5094261737353, -890.2243726760803, -846.6278904406031, -332.2687711675345, -173.11226886427568, -628.1850492970187, -839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574181293450099, "mean_inference_ms": 1.6928017723383142, "mean_action_processing_ms": 0.27518764159958714, "mean_env_wait_ms": 3.407942140594717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012435674667358398, "StateBufferConnector_ms": 0.008078336715698242, "ViewRequirementAgentConnector_ms": 0.19817900657653809}, "num_episodes": 30, "episode_return_max": -27.81128452308286, "episode_return_min": -1198.5971549679875, "episode_return_mean": -574.3686165110537, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.7970133724586, "num_env_steps_trained_throughput_per_sec": 313.7970133724586, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 13089.039, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13088.968, "sample_time_ms": 1166.865, "learn_time_ms": 11857.269, "learn_throughput": 337.346, "synch_weights_time_ms": 64.063}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00006", "date": "2024-08-04_08-34-03", "timestamp": 1722740643, "time_this_iter_s": 12.759641408920288, "time_total_s": 401.7745385169983, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.7745385169983, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.666666666666664, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.1856560766697, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.4657659030208987, "policy_loss": -0.010353850659642679, "vf_loss": 3.472543179616332, "vf_explained_var": 0.9892157025635242, "kl": 0.012227143401090265, "entropy": 0.9156521241491039, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -32.64462216491013, "episode_reward_min": -1267.9363821690656, "episode_reward_mean": -581.537705238916, "episode_len_mean": 136.05, "episode_media": {}, "episodes_timesteps_total": 13605, "policy_reward_min": {"policy_0": -1267.9363821690656}, "policy_reward_max": {"policy_0": -32.64462216491013}, "policy_reward_mean": {"policy_0": -581.537705238916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277], "episode_lengths": [150, 150, 150, 55, 150, 150, 150, 150, 150, 51, 48, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 93, 61, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 130, 150, 150, 150, 150, 97, 150, 120, 150, 150, 52, 150, 141, 150, 150, 150, 150, 150, 150, 138, 150, 104, 150, 150, 46, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 66, 139, 150, 150, 150, 150], "policy_policy_0_reward": [-839.2659368696042, -658.9115706417554, -773.841263737627, -39.56820121072654, -660.2274977078538, -412.80363211456665, -665.6171488841019, -562.411414576361, -784.3616696558282, -37.89471687467265, -65.76415278323415, -225.7886423527436, -610.0379234088551, -786.6157195732924, -480.9372867913582, -777.2403526061469, -582.383878315801, -996.5189301185565, -636.1187793039786, -1117.2570639160506, -860.6739418604559, -1018.2187260128525, -919.5807930848897, -789.217049740414, -767.3871307177652, -198.4008598761912, -876.6578235937033, -370.5935519886886, -1078.7766245252444, -1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593115469231421, "mean_inference_ms": 1.7107856409574587, "mean_action_processing_ms": 0.27523512905241465, "mean_env_wait_ms": 3.4061446209066895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01292562484741211, "StateBufferConnector_ms": 0.008060216903686523, "ViewRequirementAgentConnector_ms": 0.1988511085510254}, "num_episodes": 29, "episode_return_max": -32.64462216491013, "episode_return_min": -1267.9363821690656, "episode_return_mean": -581.537705238916, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.3381349343297, "num_env_steps_trained_throughput_per_sec": 311.3381349343297, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13090.619, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13090.543, "sample_time_ms": 1181.95, "learn_time_ms": 11845.061, "learn_throughput": 337.694, "synch_weights_time_ms": 62.766}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00006", "date": "2024-08-04_08-34-16", "timestamp": 1722740656, "time_this_iter_s": 12.859681844711304, "time_total_s": 414.6342203617096, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575cca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.6342203617096, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.33888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.46575597127278, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.5558111749589445, "policy_loss": -0.013039894406877769, "vf_loss": 3.5650446290771165, "vf_explained_var": 0.9871895221993328, "kl": 0.012953793193423756, "entropy": 0.7969719462717573, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -32.64462216491013, "episode_reward_min": -1267.9363821690656, "episode_reward_mean": -566.1488392699326, "episode_len_mean": 138.3, "episode_media": {}, "episodes_timesteps_total": 13830, "policy_reward_min": {"policy_0": -1267.9363821690656}, "policy_reward_max": {"policy_0": -32.64462216491013}, "policy_reward_mean": {"policy_0": -566.1488392699326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684], "episode_lengths": [150, 93, 61, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 130, 150, 150, 150, 150, 97, 150, 120, 150, 150, 52, 150, 141, 150, 150, 150, 150, 150, 150, 138, 150, 104, 150, 150, 46, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 66, 139, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 118, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150], "policy_policy_0_reward": [-1055.7213513494237, -147.42459591108693, -41.676713363177505, -428.5731308985083, -573.1598996268085, -701.5531152261163, -596.5335752399714, -554.9417577352393, -1108.6035509712244, -32.64462216491013, -1127.1862739068642, -42.43542791756912, -443.1579801898087, -360.0881828981426, -1022.7237114432054, -328.65535285289513, -975.5822038524077, -676.2892935630015, -426.4405912374796, -789.1265286627934, -531.2129353272168, -422.3733280062243, -567.6572737736966, -35.817481274466964, -168.8461497578529, -380.27617603093137, -479.5615988296063, -508.31629368347257, -416.32959519552145, -331.69447777997016, -826.014986100471, -520.0155269860504, -690.2656730042956, -476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616085018702238, "mean_inference_ms": 1.7269028154118131, "mean_action_processing_ms": 0.2750867643609733, "mean_env_wait_ms": 3.402107009231279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012521982192993164, "StateBufferConnector_ms": 0.00798177719116211, "ViewRequirementAgentConnector_ms": 0.19532418251037598}, "num_episodes": 29, "episode_return_max": -32.64462216491013, "episode_return_min": -1267.9363821690656, "episode_return_mean": -566.1488392699326, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.94841192896905, "num_env_steps_trained_throughput_per_sec": 312.94841192896905, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 13082.464, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13082.389, "sample_time_ms": 1185.29, "learn_time_ms": 11834.057, "learn_throughput": 338.008, "synch_weights_time_ms": 62.273}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00006", "date": "2024-08-04_08-34-28", "timestamp": 1722740668, "time_this_iter_s": 12.79372239112854, "time_total_s": 427.42794275283813, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575fc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.42794275283813, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.194444444444443, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.7067309141159, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.8805214151740075, "policy_loss": -0.0185750606819056, "vf_loss": 3.8942188267906506, "vf_explained_var": 0.982335308752954, "kl": 0.016542621028444674, "entropy": 0.8513343513011933, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -31.613758098006333, "episode_reward_min": -1267.9363821690656, "episode_reward_mean": -537.4685065248804, "episode_len_mean": 135.61, "episode_media": {}, "episodes_timesteps_total": 13561, "policy_reward_min": {"policy_0": -1267.9363821690656}, "policy_reward_max": {"policy_0": -31.613758098006333}, "policy_reward_mean": {"policy_0": -537.4685065248804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278], "episode_lengths": [150, 104, 150, 150, 46, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 66, 139, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 118, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 121, 150, 62, 150, 150, 150, 50, 105, 150, 150, 150, 113, 150, 150, 150, 150, 99, 141, 97, 150, 150, 150, 49, 126, 55, 150, 150, 95, 101, 71, 127], "policy_policy_0_reward": [-476.13108495751516, -270.6439158039939, -568.3145675599344, -1120.510444493968, -37.90339942003662, -962.873509837082, -495.6942193122501, -699.5019844051066, -959.8043827014931, -747.6465058312479, -989.3413831339949, -363.74212970334855, -630.5551314119018, -369.3176457918619, -663.5319113707066, -498.9985558471629, -1267.9363821690656, -1119.80040868558, -444.59396283090814, -691.6627573060086, -99.9301143491339, -966.149168282899, -561.8218978325546, -683.0873386247014, -212.9191993745626, -361.750563572805, -624.5665453780475, -368.2076684506423, -346.44690130999487, -158.02838541014268, -626.8183975055612, -503.22248963321084, -68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621349918019244, "mean_inference_ms": 1.73262753136165, "mean_action_processing_ms": 0.27489154152315026, "mean_env_wait_ms": 3.399547062380608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012366771697998047, "StateBufferConnector_ms": 0.008006572723388672, "ViewRequirementAgentConnector_ms": 0.20340704917907715}, "num_episodes": 33, "episode_return_max": -31.613758098006333, "episode_return_min": -1267.9363821690656, "episode_return_mean": -537.4685065248804, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.76516568545253, "num_env_steps_trained_throughput_per_sec": 329.76516568545253, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12951.056, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12950.981, "sample_time_ms": 1183.073, "learn_time_ms": 11705.391, "learn_throughput": 341.723, "synch_weights_time_ms": 61.759}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00006", "date": "2024-08-04_08-34-41", "timestamp": 1722740681, "time_this_iter_s": 12.143422365188599, "time_total_s": 439.57136511802673, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.57136511802673, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.35555555555555, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.9384471754233, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.6485736928880215, "policy_loss": -0.012824175988013546, "vf_loss": 3.6570381837586563, "vf_explained_var": 0.9809944040452441, "kl": 0.01481630106306208, "entropy": 0.8520885521546007, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -31.613758098006333, "episode_reward_min": -1139.221095268277, "episode_reward_mean": -486.6463682738119, "episode_len_mean": 130.95, "episode_media": {}, "episodes_timesteps_total": 13095, "policy_reward_min": {"policy_0": -1139.221095268277}, "policy_reward_max": {"policy_0": -31.613758098006333}, "policy_reward_mean": {"policy_0": -486.6463682738119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419], "episode_lengths": [66, 139, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 118, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 121, 150, 62, 150, 150, 150, 50, 105, 150, 150, 150, 113, 150, 150, 150, 150, 99, 141, 97, 150, 150, 150, 49, 126, 55, 150, 150, 95, 101, 71, 127, 110, 81, 43, 150, 150, 150, 64, 150, 150, 150, 143, 59, 72, 150, 150, 150, 150, 97, 98, 150, 100, 150, 60, 150, 150, 150, 86, 150, 150, 107, 150, 150], "policy_policy_0_reward": [-68.18079270785229, -263.8700966195854, -591.9420652454274, -400.81771658992795, -894.314167559384, -1139.221095268277, -743.3486623685613, -520.2822758746528, -439.25810895364583, -804.0391672677366, -318.82867011655566, -540.2150077016291, -536.006672850403, -577.7652524907736, -734.9011814549851, -1092.3792428465083, -364.2731877610336, -867.8995788565305, -257.8575598153941, -262.64236208351304, -259.2679689885696, -451.12745885623593, -615.3355906565685, -463.2490125103377, -1089.9330721379597, -1074.63768226724, -646.7048294285189, -627.8342115020881, -749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622702295167078, "mean_inference_ms": 1.729669011834808, "mean_action_processing_ms": 0.27476027770659955, "mean_env_wait_ms": 3.3974148998991183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012519121170043945, "StateBufferConnector_ms": 0.007949113845825195, "ViewRequirementAgentConnector_ms": 0.2029860019683838}, "num_episodes": 32, "episode_return_max": -31.613758098006333, "episode_return_min": -1139.221095268277, "episode_return_mean": -486.6463682738119, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.42425643583914, "num_env_steps_trained_throughput_per_sec": 312.42425643583914, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12917.118, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12917.043, "sample_time_ms": 1171.074, "learn_time_ms": 11683.175, "learn_throughput": 342.373, "synch_weights_time_ms": 62.038}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00006", "date": "2024-08-04_08-34-53", "timestamp": 1722740693, "time_this_iter_s": 12.815325498580933, "time_total_s": 452.38669061660767, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575cca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.38669061660767, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.077777777777776, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.7966703693072, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.5200289017210404, "policy_loss": -0.01695511930399031, "vf_loss": 3.5324060258766017, "vf_explained_var": 0.9879890094821652, "kl": 0.01556885423512239, "entropy": 0.9265591631333033, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -23.64068764903738, "episode_reward_min": -1196.4806452581374, "episode_reward_mean": -470.65217002850613, "episode_len_mean": 127.34, "episode_media": {}, "episodes_timesteps_total": 12734, "policy_reward_min": {"policy_0": -1196.4806452581374}, "policy_reward_max": {"policy_0": -23.64068764903738}, "policy_reward_mean": {"policy_0": -470.65217002850613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967], "episode_lengths": [150, 150, 150, 150, 150, 110, 150, 150, 150, 121, 150, 62, 150, 150, 150, 50, 105, 150, 150, 150, 113, 150, 150, 150, 150, 99, 141, 97, 150, 150, 150, 49, 126, 55, 150, 150, 95, 101, 71, 127, 110, 81, 43, 150, 150, 150, 64, 150, 150, 150, 143, 59, 72, 150, 150, 150, 150, 97, 98, 150, 100, 150, 60, 150, 150, 150, 86, 150, 150, 107, 150, 150, 47, 42, 150, 150, 96, 89, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 105, 150, 150, 150, 150, 68, 150], "policy_policy_0_reward": [-749.9705236055792, -795.597863035085, -641.0872109024609, -336.7942570561297, -385.8047019436718, -160.5214629171354, -696.6229096954684, -878.594464846824, -446.1842069388855, -244.31074671863553, -678.1469097793935, -43.303534367850496, -541.80500360926, -1085.8568646893314, -256.66278705500866, -40.35501021255348, -138.57198770538167, -640.6416042638901, -475.39499108673135, -455.9308842561406, -442.37927353467137, -624.2038090085994, -756.7173806927111, -467.6111805692473, -829.2417840032854, -235.24119839620624, -576.7981443346649, -133.60912422337228, -822.1592420875743, -370.9525377727166, -407.80840700973823, -31.613758098006333, -353.34096385633615, -46.89174491811104, -329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613644031689582, "mean_inference_ms": 1.7283462519088986, "mean_action_processing_ms": 0.2748448603933476, "mean_env_wait_ms": 3.397401508333005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012599468231201172, "StateBufferConnector_ms": 0.007907629013061523, "ViewRequirementAgentConnector_ms": 0.2020246982574463}, "num_episodes": 28, "episode_return_max": -23.64068764903738, "episode_return_min": -1196.4806452581374, "episode_return_mean": -470.65217002850613, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6436780740942, "num_env_steps_trained_throughput_per_sec": 304.6436780740942, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12935.364, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12935.287, "sample_time_ms": 1175.231, "learn_time_ms": 11698.782, "learn_throughput": 341.916, "synch_weights_time_ms": 60.531}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00006", "date": "2024-08-04_08-35-07", "timestamp": 1722740707, "time_this_iter_s": 13.143924236297607, "time_total_s": 465.5306148529053, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 465.5306148529053, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.96842105263158, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.47529131770133, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 4.12718313857913, "policy_loss": -0.010147665376522733, "vf_loss": 4.133889819433292, "vf_explained_var": 0.9690409207095703, "kl": 0.011761895860763616, "entropy": 0.8758006012067199, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -23.64068764903738, "episode_reward_min": -1196.4806452581374, "episode_reward_mean": -458.13503038878173, "episode_len_mean": 123.21, "episode_media": {}, "episodes_timesteps_total": 12321, "policy_reward_min": {"policy_0": -1196.4806452581374}, "policy_reward_max": {"policy_0": -23.64068764903738}, "policy_reward_mean": {"policy_0": -458.13503038878173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267], "episode_lengths": [150, 150, 95, 101, 71, 127, 110, 81, 43, 150, 150, 150, 64, 150, 150, 150, 143, 59, 72, 150, 150, 150, 150, 97, 98, 150, 100, 150, 60, 150, 150, 150, 86, 150, 150, 107, 150, 150, 47, 42, 150, 150, 96, 89, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 105, 150, 150, 150, 150, 68, 150, 150, 38, 63, 150, 111, 73, 100, 150, 150, 150, 108, 150, 95, 120, 54, 57, 89, 150, 150, 150, 150, 64, 150, 150, 73, 150, 56, 150, 140, 150, 106, 150, 150, 118], "policy_policy_0_reward": [-329.54371061992435, -1060.2929687714666, -230.47529185897565, -232.20295885969512, -132.1394033507834, -433.8842027592278, -182.3096629630769, -104.51252856500636, -43.39896575750187, -729.5743885460943, -520.2029724684077, -696.0261610364977, -68.8503854299657, -569.5406762127853, -344.7554702281142, -467.7236768056518, -336.4775383480331, -62.87501802998526, -93.83890790451582, -757.3839390902274, -340.1533315510957, -629.6729210693509, -556.7585915377878, -201.265131065534, -188.41044303891996, -480.43462757419996, -289.154221352816, -927.550030173486, -51.36938579927937, -512.7214425459108, -730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606126669002958, "mean_inference_ms": 1.72612228883535, "mean_action_processing_ms": 0.27509091006080844, "mean_env_wait_ms": 3.3994357296394524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012506246566772461, "StateBufferConnector_ms": 0.007832765579223633, "ViewRequirementAgentConnector_ms": 0.19191813468933105}, "num_episodes": 34, "episode_return_max": -23.64068764903738, "episode_return_min": -1196.4806452581374, "episode_return_mean": -458.13503038878173, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.77453187072757, "num_env_steps_trained_throughput_per_sec": 307.77453187072757, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12893.767, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12893.691, "sample_time_ms": 1170.32, "learn_time_ms": 11661.904, "learn_throughput": 342.997, "synch_weights_time_ms": 60.725}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00006", "date": "2024-08-04_08-35-20", "timestamp": 1722740720, "time_this_iter_s": 13.009822845458984, "time_total_s": 478.54043769836426, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 478.54043769836426, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.333333333333336, "ram_util_percent": 28.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.2165823360284, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.6254068727294606, "policy_loss": -0.012772536295233294, "vf_loss": 3.633788021405538, "vf_explained_var": 0.9851236936325828, "kl": 0.01497200528635102, "entropy": 1.002062603396674, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -3.0316914290486086, "episode_reward_min": -1342.1093350943404, "episode_reward_mean": -508.9445387802679, "episode_len_mean": 128.6, "episode_media": {}, "episodes_timesteps_total": 12860, "policy_reward_min": {"policy_0": -1342.1093350943404}, "policy_reward_max": {"policy_0": -3.0316914290486086}, "policy_reward_mean": {"policy_0": -508.9445387802679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657], "episode_lengths": [150, 150, 86, 150, 150, 107, 150, 150, 47, 42, 150, 150, 96, 89, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 105, 150, 150, 150, 150, 68, 150, 150, 38, 63, 150, 111, 73, 100, 150, 150, 150, 108, 150, 95, 120, 54, 57, 89, 150, 150, 150, 150, 64, 150, 150, 73, 150, 56, 150, 140, 150, 106, 150, 150, 118, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 68, 150, 150, 150, 129, 150, 150, 150, 124, 150, 37, 150, 150, 94, 150, 150, 150, 144], "policy_policy_0_reward": [-730.0887232370832, -654.2198114402546, -174.047260337713, -859.6083579829798, -372.4058903288788, -445.19615261267376, -617.3201093476956, -801.3924048090419, -42.428506118562375, -23.64068764903738, -867.708059677857, -893.187692348992, -205.32977468168505, -175.25855600628262, -413.5899593834949, -763.9043863662798, -1196.4806452581374, -55.382142543762555, -1056.0728714976215, -743.4696093036356, -725.6856386428507, -375.6171045240041, -823.2973675244098, -455.4736189305697, -893.1552818789903, -529.9690200011895, -382.0535966935389, -515.1641295139455, -373.1861643668424, -383.36464035966617, -582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560098668007647, "mean_inference_ms": 1.725813838264819, "mean_action_processing_ms": 0.2749692758156024, "mean_env_wait_ms": 3.3977644140440955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01196908950805664, "StateBufferConnector_ms": 0.007920265197753906, "ViewRequirementAgentConnector_ms": 0.19278907775878906}, "num_episodes": 30, "episode_return_max": -3.0316914290486086, "episode_return_min": -1342.1093350943404, "episode_return_mean": -508.9445387802679, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7349614867433, "num_env_steps_trained_throughput_per_sec": 308.7349614867433, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12879.848, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12879.773, "sample_time_ms": 1171.809, "learn_time_ms": 11648.056, "learn_throughput": 343.405, "synch_weights_time_ms": 59.165}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00006", "date": "2024-08-04_08-35-33", "timestamp": 1722740733, "time_this_iter_s": 12.96760630607605, "time_total_s": 491.5080440044403, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 491.5080440044403, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 28.326315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.32560037175816, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.593956191837788, "policy_loss": -0.016576308296256077, "vf_loss": 3.6059892646968366, "vf_explained_var": 0.9872629185517628, "kl": 0.01550414663433914, "entropy": 1.0800589475780726, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -3.0316914290486086, "episode_reward_min": -1342.1093350943404, "episode_reward_mean": -492.237582846819, "episode_len_mean": 127.52, "episode_media": {}, "episodes_timesteps_total": 12752, "policy_reward_min": {"policy_0": -1342.1093350943404}, "policy_reward_max": {"policy_0": -3.0316914290486086}, "policy_reward_mean": {"policy_0": -492.237582846819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657, -80.35116218337679, -43.97902503494858, -889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589], "episode_lengths": [150, 150, 150, 150, 68, 150, 150, 38, 63, 150, 111, 73, 100, 150, 150, 150, 108, 150, 95, 120, 54, 57, 89, 150, 150, 150, 150, 64, 150, 150, 73, 150, 56, 150, 140, 150, 106, 150, 150, 118, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 68, 150, 150, 150, 129, 150, 150, 150, 124, 150, 37, 150, 150, 94, 150, 150, 150, 144, 62, 52, 150, 150, 150, 150, 35, 150, 150, 150, 150, 77, 150, 50, 150, 95, 150, 150, 150, 88, 150, 150, 150, 150, 150, 71, 150, 150, 129, 150], "policy_policy_0_reward": [-582.3687038967731, -347.68187801977973, -675.6318327939761, -382.1185767042176, -106.75701328852216, -1058.7354082746967, -644.4062245556457, -45.26707302684805, -63.00456854980092, -441.61802784019056, -238.7522904962206, -220.86765578296374, -419.5002918052637, -705.5938135280106, -346.76905561881466, -586.6658046174483, -203.63434326964256, -796.1274880281616, -191.83333650796564, -227.6773370266125, -26.712467279278574, -81.75291663168105, -277.02199602606487, -451.9892825370906, -862.9445160740107, -867.6546449489687, -776.7533436482298, -164.29639983457858, -642.2753555443539, -628.8680931790154, -105.81466018045238, -724.2873908223235, -35.795159152358764, -423.9048082962169, -634.4190001885528, -415.72965113241713, -169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657, -80.35116218337679, -43.97902503494858, -889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602377003334326, "mean_inference_ms": 1.7249989506607042, "mean_action_processing_ms": 0.2752037417428727, "mean_env_wait_ms": 3.4000654712755334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199197769165039, "StateBufferConnector_ms": 0.007936954498291016, "ViewRequirementAgentConnector_ms": 0.19283056259155273}, "num_episodes": 30, "episode_return_max": -3.0316914290486086, "episode_return_min": -1342.1093350943404, "episode_return_mean": -492.237582846819, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8617565135877, "num_env_steps_trained_throughput_per_sec": 311.8617565135877, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12806.163, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12806.085, "sample_time_ms": 1161.06, "learn_time_ms": 11582.735, "learn_throughput": 345.342, "synch_weights_time_ms": 61.525}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00006", "date": "2024-08-04_08-35-46", "timestamp": 1722740746, "time_this_iter_s": 12.83933162689209, "time_total_s": 504.3473756313324, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 504.3473756313324, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.105555555555558, "ram_util_percent": 28.39444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.4774657746156, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.607373243570328, "policy_loss": -0.015003065045069283, "vf_loss": 3.6181810319423677, "vf_explained_var": 0.9901422226180633, "kl": 0.014288973389041853, "entropy": 0.9141802036513885, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -3.0316914290486086, "episode_reward_min": -1342.1093350943404, "episode_reward_mean": -492.4689901000005, "episode_len_mean": 125.33, "episode_media": {}, "episodes_timesteps_total": 12533, "policy_reward_min": {"policy_0": -1342.1093350943404}, "policy_reward_max": {"policy_0": -3.0316914290486086}, "policy_reward_mean": {"policy_0": -492.4689901000005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657, -80.35116218337679, -43.97902503494858, -889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589, -628.7244655394898, -563.2110414623011, -39.80183711805518, -750.2677156090824, -71.45617770081867, -445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058], "episode_lengths": [106, 150, 150, 118, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 68, 150, 150, 150, 129, 150, 150, 150, 124, 150, 37, 150, 150, 94, 150, 150, 150, 144, 62, 52, 150, 150, 150, 150, 35, 150, 150, 150, 150, 77, 150, 50, 150, 95, 150, 150, 150, 88, 150, 150, 150, 150, 150, 71, 150, 150, 129, 150, 150, 150, 55, 150, 71, 150, 96, 83, 150, 88, 150, 150, 111, 73, 80, 45, 75, 67, 101, 96, 150, 150, 150, 43, 74, 150, 150, 150, 69, 149, 143, 128, 150, 150, 43, 150], "policy_policy_0_reward": [-169.841961769953, -628.9660014262453, -986.5672049870825, -501.70034490574267, -621.5338547964528, -407.05801471090587, -546.0877906118321, -393.3213808186444, -1001.8597130236769, -658.4568679988257, -742.1755412770262, -687.028969135099, -500.8398012820225, -466.556520793886, -420.7757860742206, -122.83275509496629, -158.81236498805663, -1342.1093350943404, -441.5170175372765, -705.7158366966769, -350.23480371374575, -750.6550184851061, -731.437285428566, -467.09856760561, -303.8934527559739, -492.25041309918356, -3.0316914290486086, -734.6420634685054, -844.696234523744, -345.05517761072207, -382.97672655443176, -1182.3226354814724, -475.1211186980614, -374.3530536748657, -80.35116218337679, -43.97902503494858, -889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589, -628.7244655394898, -563.2110414623011, -39.80183711805518, -750.2677156090824, -71.45617770081867, -445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605986904994605, "mean_inference_ms": 1.7236033434703437, "mean_action_processing_ms": 0.27499692716547464, "mean_env_wait_ms": 3.398835099610053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012048959732055664, "StateBufferConnector_ms": 0.008048057556152344, "ViewRequirementAgentConnector_ms": 0.1950218677520752}, "num_episodes": 36, "episode_return_max": -3.0316914290486086, "episode_return_min": -1342.1093350943404, "episode_return_mean": -492.4689901000005, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.51997949653537, "num_env_steps_trained_throughput_per_sec": 305.51997949653537, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12831.095, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12831.019, "sample_time_ms": 1162.906, "learn_time_ms": 11606.004, "learn_throughput": 344.649, "synch_weights_time_ms": 61.348}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00006", "date": "2024-08-04_08-35-59", "timestamp": 1722740759, "time_this_iter_s": 13.105631589889526, "time_total_s": 517.4530072212219, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a43a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.4530072212219, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.81578947368421, "ram_util_percent": 28.394736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.03761956095695, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.584445631504059, "policy_loss": -0.01460075504486061, "vf_loss": 3.594461708764235, "vf_explained_var": 0.991009240411222, "kl": 0.015622747352305573, "entropy": 1.0215088281780482, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -16.30565843798379, "episode_reward_min": -1182.9061313794489, "episode_reward_mean": -471.08779066189237, "episode_len_mean": 118.7, "episode_media": {}, "episodes_timesteps_total": 11870, "policy_reward_min": {"policy_0": -1182.9061313794489}, "policy_reward_max": {"policy_0": -16.30565843798379}, "policy_reward_mean": {"policy_0": -471.08779066189237}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589, -628.7244655394898, -563.2110414623011, -39.80183711805518, -750.2677156090824, -71.45617770081867, -445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058, -410.12670655716613, -1128.1224918133048, -961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612], "episode_lengths": [150, 150, 150, 150, 35, 150, 150, 150, 150, 77, 150, 50, 150, 95, 150, 150, 150, 88, 150, 150, 150, 150, 150, 71, 150, 150, 129, 150, 150, 150, 55, 150, 71, 150, 96, 83, 150, 88, 150, 150, 111, 73, 80, 45, 75, 67, 101, 96, 150, 150, 150, 43, 74, 150, 150, 150, 69, 149, 143, 128, 150, 150, 43, 150, 150, 150, 150, 76, 150, 69, 88, 76, 150, 132, 150, 150, 150, 150, 65, 150, 89, 75, 150, 150, 150, 150, 150, 88, 150, 150, 67, 150, 64, 70, 131, 51, 53, 52, 40, 99], "policy_policy_0_reward": [-889.5643451392903, -789.0862911921262, -602.4071107438572, -422.60146920658883, -36.89881430931936, -812.2717000653096, -629.8100494175294, -897.2146737826483, -850.8752739219226, -137.14319961986564, -304.1978974847138, -52.04685011763021, -841.2718316484463, -223.06595453545066, -547.9962752086847, -827.3771035224795, -423.4943067123448, -360.1361473040289, -393.9574947468249, -850.7174879845326, -719.8840848954766, -736.4097539445162, -335.45737366012673, -124.08984431211319, -511.1340074181872, -360.11581988723805, -377.0568031382469, -696.3904188849589, -628.7244655394898, -563.2110414623011, -39.80183711805518, -750.2677156090824, -71.45617770081867, -445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058, -410.12670655716613, -1128.1224918133048, -961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613472489707277, "mean_inference_ms": 1.7230679077176467, "mean_action_processing_ms": 0.2748405169741719, "mean_env_wait_ms": 3.3962346065349585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011736631393432617, "StateBufferConnector_ms": 0.008048534393310547, "ViewRequirementAgentConnector_ms": 0.19614624977111816}, "num_episodes": 36, "episode_return_max": -16.30565843798379, "episode_return_min": -1182.9061313794489, "episode_return_mean": -471.08779066189237, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.19761308041257, "num_env_steps_trained_throughput_per_sec": 354.19761308041257, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12685.699, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12685.623, "sample_time_ms": 1138.626, "learn_time_ms": 11484.043, "learn_throughput": 348.309, "synch_weights_time_ms": 62.167}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00006", "date": "2024-08-04_08-36-10", "timestamp": 1722740770, "time_this_iter_s": 11.306195974349976, "time_total_s": 528.7592031955719, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a45e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 528.7592031955719, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.225, "ram_util_percent": 28.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.36056347489358, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.6029408593972523, "policy_loss": -0.012103984953622178, "vf_loss": 3.610399662454923, "vf_explained_var": 0.9881442376722892, "kl": 0.015827179597787747, "entropy": 1.0297430530190468, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -16.30565843798379, "episode_reward_min": -1240.9356491853541, "episode_reward_mean": -479.8666788696467, "episode_len_mean": 116.49, "episode_media": {}, "episodes_timesteps_total": 11649, "policy_reward_min": {"policy_0": -1240.9356491853541}, "policy_reward_max": {"policy_0": -16.30565843798379}, "policy_reward_mean": {"policy_0": -479.8666788696467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058, -410.12670655716613, -1128.1224918133048, -961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288], "episode_lengths": [150, 96, 83, 150, 88, 150, 150, 111, 73, 80, 45, 75, 67, 101, 96, 150, 150, 150, 43, 74, 150, 150, 150, 69, 149, 143, 128, 150, 150, 43, 150, 150, 150, 150, 76, 150, 69, 88, 76, 150, 132, 150, 150, 150, 150, 65, 150, 89, 75, 150, 150, 150, 150, 150, 88, 150, 150, 67, 150, 64, 70, 131, 51, 53, 52, 40, 99, 150, 89, 150, 100, 98, 150, 108, 150, 150, 150, 150, 150, 56, 150, 150, 46, 150, 150, 150, 85, 150, 53, 89, 66, 150, 63, 150, 47, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-445.9394495470646, -177.28387595992638, -115.73821428680097, -498.39532341885393, -336.90001295197675, -919.102825810397, -424.65759274305213, -263.908190948631, -67.01928896384199, -128.87087033242602, -30.1300921782515, -55.82784990641592, -56.63257721480925, -453.89049661704644, -275.06508247464603, -1153.5066509086278, -881.6320910490435, -929.4129268199442, -16.30565843798379, -151.62203040447028, -1010.719022795689, -613.2085600299106, -849.3501189083801, -133.46537913771624, -217.61970695054083, -391.71010057537444, -343.16121470969136, -692.021675026456, -892.8965465426139, -60.607175011259336, -788.3092963337058, -410.12670655716613, -1128.1224918133048, -961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619550357627393, "mean_inference_ms": 1.722910191419659, "mean_action_processing_ms": 0.27486293592898264, "mean_env_wait_ms": 3.3956552507092783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011645793914794922, "StateBufferConnector_ms": 0.008110284805297852, "ViewRequirementAgentConnector_ms": 0.20345568656921387}, "num_episodes": 33, "episode_return_max": -16.30565843798379, "episode_return_min": -1240.9356491853541, "episode_return_mean": -479.8666788696467, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.2079258023395, "num_env_steps_trained_throughput_per_sec": 300.2079258023395, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12733.332, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12733.259, "sample_time_ms": 1137.15, "learn_time_ms": 11532.736, "learn_throughput": 346.839, "synch_weights_time_ms": 62.589}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00006", "date": "2024-08-04_08-36-23", "timestamp": 1722740783, "time_this_iter_s": 13.335795402526855, "time_total_s": 542.0949985980988, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 542.0949985980988, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.968421052631577, "ram_util_percent": 28.394736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.0693111558755, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.66530610298117, "policy_loss": -0.010844523263707136, "vf_loss": 3.6713629931211473, "vf_explained_var": 0.9842910573507349, "kl": 0.016278277858297465, "entropy": 0.9586090916146834, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -12.104941407939515, "episode_reward_min": -1240.9356491853541, "episode_reward_mean": -493.22163520735836, "episode_len_mean": 119.37, "episode_media": {}, "episodes_timesteps_total": 11937, "policy_reward_min": {"policy_0": -1240.9356491853541}, "policy_reward_max": {"policy_0": -12.104941407939515}, "policy_reward_mean": {"policy_0": -493.22163520735836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666], "episode_lengths": [150, 76, 150, 69, 88, 76, 150, 132, 150, 150, 150, 150, 65, 150, 89, 75, 150, 150, 150, 150, 150, 88, 150, 150, 67, 150, 64, 70, 131, 51, 53, 52, 40, 99, 150, 89, 150, 100, 98, 150, 108, 150, 150, 150, 150, 150, 56, 150, 150, 46, 150, 150, 150, 85, 150, 53, 89, 66, 150, 63, 150, 47, 150, 150, 150, 150, 150, 150, 115, 150, 150, 101, 150, 150, 150, 88, 150, 104, 150, 150, 150, 150, 62, 150, 150, 150, 110, 94, 48, 66, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-961.0626251829194, -204.8908679321588, -1166.6270769253072, -50.351933472472105, -336.63502014434806, -106.028201785555, -566.1798144063624, -545.6064152060753, -1182.9061313794489, -1048.6514566203398, -1080.202713091344, -1121.2959540171798, -66.82669468160056, -1022.1050681517622, -146.96894099543857, -267.94720838387946, -124.85362604220205, -700.2582968773312, -865.5242031008231, -840.6502189170883, -458.6235856552207, -100.46391926134952, -405.02895829049424, -502.66293493789385, -80.66548247861904, -704.8803998575379, -55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561351856969358, "mean_inference_ms": 1.7234873053944912, "mean_action_processing_ms": 0.27493566030570254, "mean_env_wait_ms": 3.3976025612319143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011548519134521484, "StateBufferConnector_ms": 0.008697509765625, "ViewRequirementAgentConnector_ms": 0.2021937370300293}, "num_episodes": 33, "episode_return_max": -12.104941407939515, "episode_return_min": -1240.9356491853541, "episode_return_mean": -493.22163520735836, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.99475677908856, "num_env_steps_trained_throughput_per_sec": 302.99475677908856, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12775.321, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12775.248, "sample_time_ms": 1133.704, "learn_time_ms": 11578.372, "learn_throughput": 345.472, "synch_weights_time_ms": 62.38}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00006", "date": "2024-08-04_08-36-37", "timestamp": 1722740797, "time_this_iter_s": 13.216692924499512, "time_total_s": 555.3116915225983, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 555.3116915225983, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.188888888888886, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.14046774109204, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.53402771850427, "policy_loss": -0.01183054501452716, "vf_loss": 3.5415814362466334, "vf_explained_var": 0.9849159063150486, "kl": 0.01455419194311013, "entropy": 0.8943839285522699, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -12.104941407939515, "episode_reward_min": -1377.0337251189035, "episode_reward_mean": -476.3346748043361, "episode_len_mean": 121.18, "episode_media": {}, "episodes_timesteps_total": 12118, "policy_reward_min": {"policy_0": -1377.0337251189035}, "policy_reward_max": {"policy_0": -12.104941407939515}, "policy_reward_mean": {"policy_0": -476.3346748043361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751], "episode_lengths": [64, 70, 131, 51, 53, 52, 40, 99, 150, 89, 150, 100, 98, 150, 108, 150, 150, 150, 150, 150, 56, 150, 150, 46, 150, 150, 150, 85, 150, 53, 89, 66, 150, 63, 150, 47, 150, 150, 150, 150, 150, 150, 115, 150, 150, 101, 150, 150, 150, 88, 150, 104, 150, 150, 150, 150, 62, 150, 150, 150, 110, 94, 48, 66, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 127, 150, 66, 113, 90, 150, 150, 86, 128, 150, 150, 150, 138, 150, 60, 125, 150, 150, 140, 150, 150], "policy_policy_0_reward": [-55.96530432538898, -63.14311091409162, -374.10925357111375, -44.647486832172355, -46.50040929364643, -20.42450339270064, -25.40799499689177, -101.39053946825612, -523.0983113201752, -372.41661755822594, -923.2292842368615, -128.84047701431876, -114.14574571297675, -761.828599793396, -349.9737924434031, -859.1231121772252, -851.1053660341553, -461.4445166874686, -573.9885600489765, -662.909693253525, -48.175574182585706, -1017.5366206100343, -379.27130780633587, -34.13600440314961, -662.6962243561007, -390.5448208879927, -629.0524624412619, -243.64630389602564, -1010.293608657925, -109.35085824648777, -298.81077129567683, -111.18596401184104, -757.6951854789395, -144.06909255050948, -681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5603752500468014, "mean_inference_ms": 1.722181855823672, "mean_action_processing_ms": 0.27495303589989006, "mean_env_wait_ms": 3.396598736721056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011646509170532227, "StateBufferConnector_ms": 0.008622884750366211, "ViewRequirementAgentConnector_ms": 0.2000110149383545}, "num_episodes": 26, "episode_return_max": -12.104941407939515, "episode_return_min": -1377.0337251189035, "episode_return_mean": -476.3346748043361, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.294487251346, "num_env_steps_trained_throughput_per_sec": 304.294487251346, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12876.853, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12876.778, "sample_time_ms": 1135.784, "learn_time_ms": 11677.924, "learn_throughput": 342.527, "synch_weights_time_ms": 62.277}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00006", "date": "2024-08-04_08-36-50", "timestamp": 1722740810, "time_this_iter_s": 13.156915664672852, "time_total_s": 568.4686071872711, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447aed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 568.4686071872711, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.00526315789474, "ram_util_percent": 28.389473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.10829986532528, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.6844775607188542, "policy_loss": -0.01521129676354273, "vf_loss": 3.694761687517166, "vf_explained_var": 0.9885215323418379, "kl": 0.016750723285561767, "entropy": 0.9805025326708953, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -12.104941407939515, "episode_reward_min": -1377.0337251189035, "episode_reward_mean": -514.7463933989759, "episode_len_mean": 129.61, "episode_media": {}, "episodes_timesteps_total": 12961, "policy_reward_min": {"policy_0": -1377.0337251189035}, "policy_reward_max": {"policy_0": -12.104941407939515}, "policy_reward_mean": {"policy_0": -514.7463933989759}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751, -762.17972105104, -357.9559315837907, -427.15286994693327, -35.6588570631117, -602.1897579419899, -314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228], "episode_lengths": [150, 47, 150, 150, 150, 150, 150, 150, 115, 150, 150, 101, 150, 150, 150, 88, 150, 104, 150, 150, 150, 150, 62, 150, 150, 150, 110, 94, 48, 66, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 127, 150, 66, 113, 90, 150, 150, 86, 128, 150, 150, 150, 138, 150, 60, 125, 150, 150, 140, 150, 150, 150, 115, 114, 52, 150, 129, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 88, 139, 150, 150, 150, 62, 150, 150, 150, 80, 56, 150, 150, 150, 150], "policy_policy_0_reward": [-681.7512922963735, -97.48802124326279, -604.6649378969169, -472.54973800708615, -1240.9356491853541, -1154.344119787244, -1013.7198074878288, -357.1973198977445, -223.82980610725525, -745.6098772462483, -508.3113515932751, -172.51845292904449, -1154.5032905244982, -789.2666353673206, -736.8211948134245, -178.02208677811564, -963.6449172721861, -412.38293298162506, -1072.4765277715362, -400.5788026472392, -1131.9910190836306, -1050.3654938299007, -41.59910341420332, -405.92423583234415, -611.6229503437582, -402.90921939964284, -368.28372043966345, -170.02572883544528, -14.586783338816886, -114.58683972985028, -12.104941407939515, -396.56194994418314, -317.20188118443394, -53.20521147233091, -157.6828859043324, -724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751, -762.17972105104, -357.9559315837907, -427.15286994693327, -35.6588570631117, -602.1897579419899, -314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610604497244136, "mean_inference_ms": 1.7200635650892435, "mean_action_processing_ms": 0.2748067273813017, "mean_env_wait_ms": 3.396089688561973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148080825805664, "StateBufferConnector_ms": 0.008579492568969727, "ViewRequirementAgentConnector_ms": 0.19227266311645508}, "num_episodes": 34, "episode_return_max": -12.104941407939515, "episode_return_min": -1377.0337251189035, "episode_return_mean": -514.7463933989759, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.09335538348734, "num_env_steps_trained_throughput_per_sec": 336.09335538348734, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12786.688, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12786.611, "sample_time_ms": 1142.113, "learn_time_ms": 11581.466, "learn_throughput": 345.379, "synch_weights_time_ms": 62.234}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00006", "date": "2024-08-04_08-37-02", "timestamp": 1722740822, "time_this_iter_s": 11.91273546218872, "time_total_s": 580.3813426494598, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ad6c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.3813426494598, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.711764705882352, "ram_util_percent": 28.39411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.39192165931067, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.7957708992064, "policy_loss": -0.007462875627485725, "vf_loss": 3.798643635213375, "vf_explained_var": 0.9733055737490456, "kl": 0.015594969701669506, "entropy": 0.8834941677128275, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -35.6588570631117, "episode_reward_min": -1377.0337251189035, "episode_reward_mean": -468.5399697653299, "episode_len_mean": 126.41, "episode_media": {}, "episodes_timesteps_total": 12641, "policy_reward_min": {"policy_0": -1377.0337251189035}, "policy_reward_max": {"policy_0": -35.6588570631117}, "policy_reward_mean": {"policy_0": -468.5399697653299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751, -762.17972105104, -357.9559315837907, -427.15286994693327, -35.6588570631117, -602.1897579419899, -314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228, -440.01111911572235, -341.0484897478777, -596.9878214216089, -307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 127, 150, 66, 113, 90, 150, 150, 86, 128, 150, 150, 150, 138, 150, 60, 125, 150, 150, 140, 150, 150, 150, 115, 114, 52, 150, 129, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 88, 139, 150, 150, 150, 62, 150, 150, 150, 80, 56, 150, 150, 150, 150, 150, 113, 150, 116, 58, 51, 150, 60, 150, 62, 64, 150, 150, 150, 111, 54, 150, 68, 150, 107, 150, 150, 59, 46, 58, 88, 150, 150, 150, 150, 150, 111, 139, 150, 64], "policy_policy_0_reward": [-724.7922636934992, -524.7088740909857, -864.1168362171392, -684.4337689263118, -486.7878261192666, -1377.0337251189035, -880.1962345430809, -600.1461414810475, -730.7819359274664, -226.72052366482242, -304.29531307901186, -637.167887180622, -73.81389251754773, -342.251580382682, -161.41291570698593, -696.4307868523019, -424.8870042206635, -220.3201456857776, -496.0436387135845, -401.2021356807883, -825.0636266544811, -642.4455696433665, -475.82211858474903, -569.9155772304806, -139.85520261469483, -434.6107196864453, -523.0106951467255, -517.7974027157658, -555.9580030853248, -272.60688031052365, -439.4120510646751, -762.17972105104, -357.9559315837907, -427.15286994693327, -35.6588570631117, -602.1897579419899, -314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228, -440.01111911572235, -341.0484897478777, -596.9878214216089, -307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611924909764916, "mean_inference_ms": 1.7193396229035702, "mean_action_processing_ms": 0.2749214833463349, "mean_env_wait_ms": 3.3978235196713213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011860370635986328, "StateBufferConnector_ms": 0.008009910583496094, "ViewRequirementAgentConnector_ms": 0.19663310050964355}, "num_episodes": 35, "episode_return_max": -35.6588570631117, "episode_return_min": -1377.0337251189035, "episode_return_mean": -468.5399697653299, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.8661692754893, "num_env_steps_trained_throughput_per_sec": 319.8661692754893, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12724.202, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12724.125, "sample_time_ms": 1137.298, "learn_time_ms": 11523.653, "learn_throughput": 347.112, "synch_weights_time_ms": 62.325}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00006", "date": "2024-08-04_08-37-14", "timestamp": 1722740834, "time_this_iter_s": 12.51803731918335, "time_total_s": 592.8993799686432, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 592.8993799686432, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.200000000000003, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.0830918053786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.3417263684173424, "policy_loss": -0.012147034733303978, "vf_loss": 3.3485218192140263, "vf_explained_var": 0.9802641308556, "kl": 0.018119928355584642, "entropy": 0.8438533822695414, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": 0.3125980103089713, "episode_reward_min": -1351.1420455314408, "episode_reward_mean": -432.8266194627228, "episode_len_mean": 123.05, "episode_media": {}, "episodes_timesteps_total": 12305, "policy_reward_min": {"policy_0": -1351.1420455314408}, "policy_reward_max": {"policy_0": 0.3125980103089713}, "policy_reward_mean": {"policy_0": -432.8266194627228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228, -440.01111911572235, -341.0484897478777, -596.9878214216089, -307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036, -381.2973943522345, -279.9484925237133, -537.3524287589728, -694.5700042478001, -637.4917101535507, -699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221], "episode_lengths": [129, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 88, 139, 150, 150, 150, 62, 150, 150, 150, 80, 56, 150, 150, 150, 150, 150, 113, 150, 116, 58, 51, 150, 60, 150, 62, 64, 150, 150, 150, 111, 54, 150, 68, 150, 107, 150, 150, 59, 46, 58, 88, 150, 150, 150, 150, 150, 111, 139, 150, 64, 150, 115, 150, 150, 132, 150, 119, 143, 37, 50, 150, 150, 83, 150, 150, 86, 132, 69, 67, 56, 150, 125, 62, 150, 150, 150, 150, 150, 121, 138, 94, 150, 150, 150, 72, 150], "policy_policy_0_reward": [-314.0856332020107, -721.5478236426012, -394.22906635679743, -196.12507228914387, -657.3769639882688, -85.11020452093808, -219.73539613641958, -991.6104906842942, -547.4040196068532, -536.0230628465016, -252.05981842044983, -488.60877581720763, -597.7455866630448, -665.7912520187296, -175.13327763978634, -405.03046113486766, -1048.7173527242585, -958.8030545124708, -486.78452053516503, -57.05814137433242, -416.8014763046098, -830.2379894078459, -1043.572527744175, -157.0621301480044, -38.82170393100367, -595.0829788024721, -359.5215970492291, -858.8128780219458, -707.2989442535228, -440.01111911572235, -341.0484897478777, -596.9878214216089, -307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036, -381.2973943522345, -279.9484925237133, -537.3524287589728, -694.5700042478001, -637.4917101535507, -699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633257758260437, "mean_inference_ms": 1.7169614841987626, "mean_action_processing_ms": 0.2750299188905216, "mean_env_wait_ms": 3.3989020037634763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012054920196533203, "StateBufferConnector_ms": 0.008110284805297852, "ViewRequirementAgentConnector_ms": 0.19988441467285156}, "num_episodes": 36, "episode_return_max": 0.3125980103089713, "episode_return_min": -1351.1420455314408, "episode_return_mean": -432.8266194627228, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5150438305784, "num_env_steps_trained_throughput_per_sec": 302.5150438305784, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12746.798, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12746.719, "sample_time_ms": 1143.138, "learn_time_ms": 11538.889, "learn_throughput": 346.654, "synch_weights_time_ms": 63.825}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00006", "date": "2024-08-04_08-37-28", "timestamp": 1722740848, "time_this_iter_s": 13.236629724502563, "time_total_s": 606.1360096931458, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447aed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 606.1360096931458, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.715789473684215, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.00943769216536, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.5241578460981446, "policy_loss": -0.01318382811587071, "vf_loss": 3.532291938116153, "vf_explained_var": 0.9869784558812777, "kl": 0.017120831533793533, "entropy": 0.8651951278870305, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.3125980103089713, "episode_reward_min": -1351.1420455314408, "episode_reward_mean": -397.19157830440713, "episode_len_mean": 114.41, "episode_media": {}, "episodes_timesteps_total": 11441, "policy_reward_min": {"policy_0": -1351.1420455314408}, "policy_reward_max": {"policy_0": 0.3125980103089713}, "policy_reward_mean": {"policy_0": -397.19157830440713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036, -381.2973943522345, -279.9484925237133, -537.3524287589728, -694.5700042478001, -637.4917101535507, -699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221, -106.14913020113819, -790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845], "episode_lengths": [116, 58, 51, 150, 60, 150, 62, 64, 150, 150, 150, 111, 54, 150, 68, 150, 107, 150, 150, 59, 46, 58, 88, 150, 150, 150, 150, 150, 111, 139, 150, 64, 150, 115, 150, 150, 132, 150, 119, 143, 37, 50, 150, 150, 83, 150, 150, 86, 132, 69, 67, 56, 150, 125, 62, 150, 150, 150, 150, 150, 121, 138, 94, 150, 150, 150, 72, 150, 63, 150, 92, 123, 150, 116, 113, 71, 150, 150, 150, 79, 94, 59, 150, 106, 150, 56, 150, 150, 150, 150, 122, 33, 150, 87, 150, 52, 75, 61, 68, 54], "policy_policy_0_reward": [-307.942557553837, -42.79955450406794, -69.54389928913832, -975.545490746235, -88.48361686246315, -374.63279509763606, -42.36877833490836, -104.7049979948811, -320.3821370823939, -695.7293926310784, -580.2984966948, -218.48036184961657, -59.414791934054996, -280.46700433187004, -67.26819286582867, -705.5933550021703, -237.4990309798958, -760.4072357462187, -617.1990632568294, -182.9424536045011, -38.5252228078939, -73.83330333595455, -360.7213620774083, -436.13047489304813, -460.1766953251031, -335.49070403563326, -1044.616027266009, -1351.1420455314408, -153.4095825753708, -559.4931316220311, -596.2531320502209, -89.0840444617036, -381.2973943522345, -279.9484925237133, -537.3524287589728, -694.5700042478001, -637.4917101535507, -699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221, -106.14913020113819, -790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562616626409641, "mean_inference_ms": 1.7164970897472258, "mean_action_processing_ms": 0.2749342320033176, "mean_env_wait_ms": 3.400112538470895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012263774871826172, "StateBufferConnector_ms": 0.008055686950683594, "ViewRequirementAgentConnector_ms": 0.1979963779449463}, "num_episodes": 32, "episode_return_max": 0.3125980103089713, "episode_return_min": -1351.1420455314408, "episode_return_mean": -397.19157830440713, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7971811986902, "num_env_steps_trained_throughput_per_sec": 315.7971811986902, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12717.824, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12717.744, "sample_time_ms": 1138.711, "learn_time_ms": 11514.146, "learn_throughput": 347.399, "synch_weights_time_ms": 64.021}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00006", "date": "2024-08-04_08-37-40", "timestamp": 1722740860, "time_this_iter_s": 12.679628610610962, "time_total_s": 618.8156383037567, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.8156383037567, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.238888888888887, "ram_util_percent": 28.39444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.19346234401067, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.4339364267885686, "policy_loss": -0.013917870450920114, "vf_loss": 3.443180584162474, "vf_explained_var": 0.9753411690394084, "kl": 0.015815854378373236, "entropy": 0.7105096937778096, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": 0.3125980103089713, "episode_reward_min": -1189.0872173062423, "episode_reward_mean": -388.91167104318885, "episode_len_mean": 113.09, "episode_media": {}, "episodes_timesteps_total": 11309, "policy_reward_min": {"policy_0": -1189.0872173062423}, "policy_reward_max": {"policy_0": 0.3125980103089713}, "policy_reward_mean": {"policy_0": -388.91167104318885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221, -106.14913020113819, -790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845, -864.9129346008085, -251.14867809007242, -403.43384428518897, -46.78941153322426, -76.55416917882933, -1172.0826702411437, -430.00470910700454, -708.370486194299, -214.66372229528912, -896.5905292352205, -7.3507385317168445, -77.67710070866781, -75.35125696428017, -87.1135657298133, -69.01911574782943, -244.17196200374497, -332.2643952628801, -69.3948029635735, -523.2732334509877, -103.56767265683116, -199.937973046699, -906.2768543187851, -101.5289036838823, -478.4420982331348, -545.194570305664, -597.4392720503193, -317.4497312986004, -329.2582579909751, -781.4291174178826, -537.8451065011867, -207.26389696932839, -836.8583991692185, -90.46780045968448, -45.809035016352695, -286.8071160811872, -121.44823040226353, -896.056874532112], "episode_lengths": [150, 119, 143, 37, 50, 150, 150, 83, 150, 150, 86, 132, 69, 67, 56, 150, 125, 62, 150, 150, 150, 150, 150, 121, 138, 94, 150, 150, 150, 72, 150, 63, 150, 92, 123, 150, 116, 113, 71, 150, 150, 150, 79, 94, 59, 150, 106, 150, 56, 150, 150, 150, 150, 122, 33, 150, 87, 150, 52, 75, 61, 68, 54, 150, 122, 150, 49, 71, 150, 150, 150, 150, 150, 30, 68, 66, 64, 57, 98, 109, 67, 150, 71, 94, 150, 63, 150, 150, 150, 150, 84, 150, 150, 134, 150, 70, 57, 116, 91, 150], "policy_policy_0_reward": [-699.4320186141903, -258.1235334876854, -295.9428613492304, 0.3125980103089713, -59.12623138080652, -447.4611656011369, -740.8799185265459, -180.39986167209273, -872.930877730937, -1189.0872173062423, -225.3893277890491, -241.04293765072995, -81.37611251475577, -89.3182994086357, -33.58710880617346, -522.9764205756717, -260.2382321572801, -93.24543416983127, -195.1537917745383, -730.5310861959186, -557.9988234160487, -551.7144913648239, -351.67590719333543, -307.26655205048996, -620.140003042282, -256.87122546306034, -535.7552218102713, -670.3171529772591, -795.3558324848938, -84.84788586928201, -389.3104194567221, -106.14913020113819, -790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845, -864.9129346008085, -251.14867809007242, -403.43384428518897, -46.78941153322426, -76.55416917882933, -1172.0826702411437, -430.00470910700454, -708.370486194299, -214.66372229528912, -896.5905292352205, -7.3507385317168445, -77.67710070866781, -75.35125696428017, -87.1135657298133, -69.01911574782943, -244.17196200374497, -332.2643952628801, -69.3948029635735, -523.2732334509877, -103.56767265683116, -199.937973046699, -906.2768543187851, -101.5289036838823, -478.4420982331348, -545.194570305664, -597.4392720503193, -317.4497312986004, -329.2582579909751, -781.4291174178826, -537.8451065011867, -207.26389696932839, -836.8583991692185, -90.46780045968448, -45.809035016352695, -286.8071160811872, -121.44823040226353, -896.056874532112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625482857666383, "mean_inference_ms": 1.7143197093296905, "mean_action_processing_ms": 0.2745713223895938, "mean_env_wait_ms": 3.392850573695185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012272119522094727, "StateBufferConnector_ms": 0.008070707321166992, "ViewRequirementAgentConnector_ms": 0.1969313621520996}, "num_episodes": 37, "episode_return_max": 0.3125980103089713, "episode_return_min": -1189.0872173062423, "episode_return_mean": -388.91167104318885, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.9413940156614, "num_env_steps_trained_throughput_per_sec": 338.9413940156614, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12615.349, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12615.27, "sample_time_ms": 1137.775, "learn_time_ms": 11414.442, "learn_throughput": 350.433, "synch_weights_time_ms": 62.204}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00006", "date": "2024-08-04_08-37-52", "timestamp": 1722740872, "time_this_iter_s": 11.81331729888916, "time_total_s": 630.6289556026459, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 630.6289556026459, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.71764705882353, "ram_util_percent": 28.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.33807087143262, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 3.4510947981228433, "policy_loss": -0.012742332768781731, "vf_loss": 3.45870601311326, "vf_explained_var": 0.9856394965201616, "kl": 0.01739386851962384, "entropy": 0.8705033389851451, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -4.3814013064222035, "episode_reward_min": -1172.0826702411437, "episode_reward_mean": -395.5292864698518, "episode_len_mean": 113.97, "episode_media": {}, "episodes_timesteps_total": 11397, "policy_reward_min": {"policy_0": -1172.0826702411437}, "policy_reward_max": {"policy_0": -4.3814013064222035}, "policy_reward_mean": {"policy_0": -395.5292864698518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845, -864.9129346008085, -251.14867809007242, -403.43384428518897, -46.78941153322426, -76.55416917882933, -1172.0826702411437, -430.00470910700454, -708.370486194299, -214.66372229528912, -896.5905292352205, -7.3507385317168445, -77.67710070866781, -75.35125696428017, -87.1135657298133, -69.01911574782943, -244.17196200374497, -332.2643952628801, -69.3948029635735, -523.2732334509877, -103.56767265683116, -199.937973046699, -906.2768543187851, -101.5289036838823, -478.4420982331348, -545.194570305664, -597.4392720503193, -317.4497312986004, -329.2582579909751, -781.4291174178826, -537.8451065011867, -207.26389696932839, -836.8583991692185, -90.46780045968448, -45.809035016352695, -286.8071160811872, -121.44823040226353, -896.056874532112, -594.4642982078435, -246.11611040989854, -256.50470891065277, -405.91306192432836, -53.40325702898472, -287.87206960935845, -632.978982924809, -186.37343334551971, -742.6759339047551, -496.4894153058281, -69.5136408274926, -394.82779958793793, -927.9665877033276, -566.7185917586534, -629.8241784897867, -644.2652559987802, -347.4958285981898, -78.84888453033467, -56.947389138663986, -465.90649761998844, -5.266815825965775, -535.6884212445224, -336.0023311449381, -24.76620623403228, -403.9865156110251, -244.53501147808873, -276.0984250423022, -1020.7389326332896, -751.414037524701, -16.333723954844977, -929.7387489019528, -475.4189312762501], "episode_lengths": [150, 92, 123, 150, 116, 113, 71, 150, 150, 150, 79, 94, 59, 150, 106, 150, 56, 150, 150, 150, 150, 122, 33, 150, 87, 150, 52, 75, 61, 68, 54, 150, 122, 150, 49, 71, 150, 150, 150, 150, 150, 30, 68, 66, 64, 57, 98, 109, 67, 150, 71, 94, 150, 63, 150, 150, 150, 150, 84, 150, 150, 134, 150, 70, 57, 116, 91, 150, 118, 107, 125, 141, 56, 150, 150, 91, 150, 150, 67, 150, 150, 150, 150, 150, 150, 61, 51, 150, 31, 150, 150, 48, 150, 88, 127, 150, 150, 44, 150, 150], "policy_policy_0_reward": [-790.2220091539893, -238.00054587208683, -378.8643395723139, -863.9969116934549, -263.65409134210563, -535.8373278842903, -89.71331524027121, -854.3603942314412, -459.7691565894278, -360.85590695259555, -168.29999366445335, -170.77124954224487, -45.527140736841936, -955.1890761880775, -457.78938820516316, -570.1006959891839, -102.13377714654015, -965.0300859222567, -1124.3513649328875, -792.6815610578487, -338.19446223698293, -272.1336983304995, -4.3814013064222035, -458.0726822587264, -150.7998781221202, -690.1827205511038, -25.07255209086188, -114.9897210012466, -155.74685377093905, -82.99408257977883, -34.869999863295845, -864.9129346008085, -251.14867809007242, -403.43384428518897, -46.78941153322426, -76.55416917882933, -1172.0826702411437, -430.00470910700454, -708.370486194299, -214.66372229528912, -896.5905292352205, -7.3507385317168445, -77.67710070866781, -75.35125696428017, -87.1135657298133, -69.01911574782943, -244.17196200374497, -332.2643952628801, -69.3948029635735, -523.2732334509877, -103.56767265683116, -199.937973046699, -906.2768543187851, -101.5289036838823, -478.4420982331348, -545.194570305664, -597.4392720503193, -317.4497312986004, -329.2582579909751, -781.4291174178826, -537.8451065011867, -207.26389696932839, -836.8583991692185, -90.46780045968448, -45.809035016352695, -286.8071160811872, -121.44823040226353, -896.056874532112, -594.4642982078435, -246.11611040989854, -256.50470891065277, -405.91306192432836, -53.40325702898472, -287.87206960935845, -632.978982924809, -186.37343334551971, -742.6759339047551, -496.4894153058281, -69.5136408274926, -394.82779958793793, -927.9665877033276, -566.7185917586534, -629.8241784897867, -644.2652559987802, -347.4958285981898, -78.84888453033467, -56.947389138663986, -465.90649761998844, -5.266815825965775, -535.6884212445224, -336.0023311449381, -24.76620623403228, -403.9865156110251, -244.53501147808873, -276.0984250423022, -1020.7389326332896, -751.414037524701, -16.333723954844977, -929.7387489019528, -475.4189312762501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615582085129088, "mean_inference_ms": 1.7138668791758258, "mean_action_processing_ms": 0.274656796582203, "mean_env_wait_ms": 3.3897031336913117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013180732727050781, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.1943202018737793}, "num_episodes": 32, "episode_return_max": -4.3814013064222035, "episode_return_min": -1172.0826702411437, "episode_return_mean": -395.5292864698518, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.72099491451183, "num_env_steps_trained_throughput_per_sec": 353.72099491451183, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12436.941, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12436.862, "sample_time_ms": 1137.578, "learn_time_ms": 11236.5, "learn_throughput": 355.983, "synch_weights_time_ms": 61.938}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00006", "date": "2024-08-04_08-38-04", "timestamp": 1722740884, "time_this_iter_s": 11.321474313735962, "time_total_s": 641.9504299163818, "pid": 612259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.9504299163818, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.98125, "ram_util_percent": 28.4}}
