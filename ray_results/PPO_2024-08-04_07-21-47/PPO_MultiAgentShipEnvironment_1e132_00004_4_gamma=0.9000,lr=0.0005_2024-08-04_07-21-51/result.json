{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.320248890078316, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.18312905728817, "policy_loss": -0.010335085201465215, "vf_loss": 9.191174028317134, "vf_explained_var": 0.011077077003816764, "kl": 0.012167396134312487, "entropy": 1.4337558170159659, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -59.984568000057195, "episode_reward_min": -1334.1261767019157, "episode_reward_mean": -709.8036909832445, "episode_len_mean": 118.85185185185185, "episode_media": {}, "episodes_timesteps_total": 3209, "policy_reward_min": {"policy_0": -1334.1261767019157}, "policy_reward_max": {"policy_0": -59.984568000057195}, "policy_reward_mean": {"policy_0": -709.8036909832445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906], "episode_lengths": [52, 58, 150, 46, 73, 150, 150, 150, 150, 150, 150, 69, 81, 150, 150, 150, 150, 150, 150, 101, 72, 64, 123, 150, 70, 150, 150], "policy_policy_0_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.569090752432557, "mean_inference_ms": 1.668127932006524, "mean_action_processing_ms": 0.2790957153158844, "mean_env_wait_ms": 3.411344034802426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011430846320258247, "StateBufferConnector_ms": 0.008207780343514902, "ViewRequirementAgentConnector_ms": 0.17920070224338108}, "num_episodes": 27, "episode_return_max": -59.984568000057195, "episode_return_min": -1334.1261767019157, "episode_return_mean": -709.8036909832445, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.89449568794726, "num_env_steps_trained_throughput_per_sec": 311.89449568794726, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12824.859, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12824.796, "sample_time_ms": 1124.291, "learn_time_ms": 11641.3, "learn_throughput": 343.604, "synch_weights_time_ms": 58.455}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00004", "date": "2024-08-04_08-05-38", "timestamp": 1722738938, "time_this_iter_s": 12.836660623550415, "time_total_s": 12.836660623550415, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.836660623550415, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.13684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8818564001470803, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.82478840102752, "policy_loss": -0.013250538688347054, "vf_loss": 8.835276072223982, "vf_explained_var": 0.05213086331884066, "kl": 0.014522352134448134, "entropy": 1.4159708332270384, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -4.0431718141416795, "episode_reward_min": -1334.1261767019157, "episode_reward_mean": -614.5910374711958, "episode_len_mean": 110.03333333333333, "episode_media": {}, "episodes_timesteps_total": 6602, "policy_reward_min": {"policy_0": -1334.1261767019157}, "policy_reward_max": {"policy_0": -4.0431718141416795}, "policy_reward_mean": {"policy_0": -614.5910374711958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738], "episode_lengths": [52, 58, 150, 46, 73, 150, 150, 150, 150, 150, 150, 69, 81, 150, 150, 150, 150, 150, 150, 101, 72, 64, 123, 150, 70, 150, 150, 150, 141, 150, 135, 50, 55, 150, 48, 150, 150, 99, 150, 43, 150, 99, 76, 56, 92, 59, 87, 58, 111, 40, 150, 43, 150, 39, 79, 78, 118, 150, 150, 137], "policy_policy_0_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5688040601566844, "mean_inference_ms": 1.671880515719425, "mean_action_processing_ms": 0.2798905579438943, "mean_env_wait_ms": 3.418564410546066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0131376584370931, "StateBufferConnector_ms": 0.008416970570882162, "ViewRequirementAgentConnector_ms": 0.19295334815979004}, "num_episodes": 33, "episode_return_max": -4.0431718141416795, "episode_return_min": -1334.1261767019157, "episode_return_mean": -614.5910374711958, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.015319823697, "num_env_steps_trained_throughput_per_sec": 355.015319823697, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12045.995, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12045.933, "sample_time_ms": 1135.854, "learn_time_ms": 10848.588, "learn_throughput": 368.712, "synch_weights_time_ms": 60.748}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00004", "date": "2024-08-04_08-05-49", "timestamp": 1722738949, "time_this_iter_s": 11.279172658920288, "time_total_s": 24.115833282470703, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.115833282470703, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.98125, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.222651663422585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 6.740548760195574, "policy_loss": -0.010379992157686502, "vf_loss": 6.748444137970607, "vf_explained_var": 0.5622249030818541, "kl": 0.013131630176576436, "entropy": 1.4170845561971268, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -4.0431718141416795, "episode_reward_min": -1458.8619416728868, "episode_reward_mean": -643.6207603060639, "episode_len_mean": 113.3913043478261, "episode_media": {}, "episodes_timesteps_total": 10432, "policy_reward_min": {"policy_0": -1458.8619416728868}, "policy_reward_max": {"policy_0": -4.0431718141416795}, "policy_reward_mean": {"policy_0": -643.6207603060639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947], "episode_lengths": [52, 58, 150, 46, 73, 150, 150, 150, 150, 150, 150, 69, 81, 150, 150, 150, 150, 150, 150, 101, 72, 64, 123, 150, 70, 150, 150, 150, 141, 150, 135, 50, 55, 150, 48, 150, 150, 99, 150, 43, 150, 99, 76, 56, 92, 59, 87, 58, 111, 40, 150, 43, 150, 39, 79, 78, 118, 150, 150, 137, 150, 150, 150, 67, 150, 150, 107, 150, 105, 150, 85, 53, 150, 150, 150, 150, 92, 65, 150, 150, 150, 43, 150, 150, 150, 150, 55, 62, 55, 150, 41, 150], "policy_policy_0_reward": [-59.984568000057195, -101.2913783855758, -1054.1210509096184, -64.55817315299856, -191.55647892691078, -815.0596459197147, -1041.109144711865, -1146.1552186538318, -932.6146864909766, -1334.1261767019157, -1263.6667184728062, -155.82040864485168, -169.40115294682957, -1309.9978913906368, -1155.2819925351464, -1269.6339094610173, -1041.685718196666, -923.791005124558, -1260.200052708063, -495.6700577874753, -134.11546305590497, -114.39609835591531, -399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5668188778373525, "mean_inference_ms": 1.670125149292958, "mean_action_processing_ms": 0.27953794546276217, "mean_env_wait_ms": 3.4150688051963236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013344961663951044, "StateBufferConnector_ms": 0.008577626684437628, "ViewRequirementAgentConnector_ms": 0.1937264981477157}, "num_episodes": 32, "episode_return_max": -4.0431718141416795, "episode_return_min": -1458.8619416728868, "episode_return_mean": -643.6207603060639, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.68164473907, "num_env_steps_trained_throughput_per_sec": 312.68164473907, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12294.856, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12294.792, "sample_time_ms": 1120.104, "learn_time_ms": 11111.519, "learn_throughput": 359.987, "synch_weights_time_ms": 62.424}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00004", "date": "2024-08-04_08-06-02", "timestamp": 1722738962, "time_this_iter_s": 12.803903579711914, "time_total_s": 36.91973686218262, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.91973686218262, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.116666666666664, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.4976393610239, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 4.773484153300524, "policy_loss": -0.008603791064039494, "vf_loss": 4.779948214938243, "vf_explained_var": 0.8258349835251768, "kl": 0.011411401590779257, "entropy": 1.4255252869178852, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -4.0431718141416795, "episode_reward_min": -1458.8619416728868, "episode_reward_mean": -648.3688390299645, "episode_len_mean": 116.3, "episode_media": {}, "episodes_timesteps_total": 11630, "policy_reward_min": {"policy_0": -1458.8619416728868}, "policy_reward_max": {"policy_0": -4.0431718141416795}, "policy_reward_mean": {"policy_0": -648.3688390299645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804], "episode_lengths": [123, 150, 70, 150, 150, 150, 141, 150, 135, 50, 55, 150, 48, 150, 150, 99, 150, 43, 150, 99, 76, 56, 92, 59, 87, 58, 111, 40, 150, 43, 150, 39, 79, 78, 118, 150, 150, 137, 150, 150, 150, 67, 150, 150, 107, 150, 105, 150, 85, 53, 150, 150, 150, 150, 92, 65, 150, 150, 150, 43, 150, 150, 150, 150, 55, 62, 55, 150, 41, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 86, 100, 150, 86, 96, 150, 81, 119, 150, 150, 110, 150, 96, 150, 150, 150, 115, 44], "policy_policy_0_reward": [-399.91453753657646, -641.0386191225703, -231.1028135187397, -678.4254396507879, -1179.9812561855906, -1164.7650502265956, -843.0960200536123, -1231.0702459826923, -628.5700430687403, -69.1307220089259, -99.88888783923768, -1161.479887038684, -76.59055800270394, -1058.8030634033016, -1157.21973361256, -332.3561417069506, -1036.5146773898164, -93.19196161589974, -1052.7111654506568, -478.58335079563676, -148.63447030053726, -156.22070577474386, -270.9852687775406, -119.15489937670567, -358.5264294053164, -175.1408247215476, -321.3952811058133, -4.0431718141416795, -871.2651174705186, -51.0381216297656, -789.948413873885, -21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631995409971381, "mean_inference_ms": 1.673280325722318, "mean_action_processing_ms": 0.2806665252699733, "mean_env_wait_ms": 3.4192797815267233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700592041015625, "StateBufferConnector_ms": 0.00867152214050293, "ViewRequirementAgentConnector_ms": 0.19596314430236816}, "num_episodes": 30, "episode_return_max": -4.0431718141416795, "episode_return_min": -1458.8619416728868, "episode_return_mean": -648.3688390299645, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.15483095587496, "num_env_steps_trained_throughput_per_sec": 346.15483095587496, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12110.026, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12109.962, "sample_time_ms": 1140.611, "learn_time_ms": 10903.746, "learn_throughput": 366.846, "synch_weights_time_ms": 64.814}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00004", "date": "2024-08-04_08-06-14", "timestamp": 1722738974, "time_this_iter_s": 11.568022966384888, "time_total_s": 48.487759828567505, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e97e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.487759828567505, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.34992823104064, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 3.658551174029708, "policy_loss": -0.01183119332708884, "vf_loss": 3.6679629854857922, "vf_explained_var": 0.9355433308829864, "kl": 0.012808405164317567, "entropy": 1.4228542065868774, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -16.384548874643993, "episode_reward_min": -1458.8619416728868, "episode_reward_mean": -741.6803406553561, "episode_len_mean": 125.94, "episode_media": {}, "episodes_timesteps_total": 12594, "policy_reward_min": {"policy_0": -1458.8619416728868}, "policy_reward_max": {"policy_0": -16.384548874643993}, "policy_reward_mean": {"policy_0": -741.6803406553561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696], "episode_lengths": [39, 79, 78, 118, 150, 150, 137, 150, 150, 150, 67, 150, 150, 107, 150, 105, 150, 85, 53, 150, 150, 150, 150, 92, 65, 150, 150, 150, 43, 150, 150, 150, 150, 55, 62, 55, 150, 41, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 86, 100, 150, 86, 96, 150, 81, 119, 150, 150, 110, 150, 96, 150, 150, 150, 115, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 71, 150, 150, 84, 150, 78, 150, 121, 81, 150, 142, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-21.29945919967229, -120.25962739103251, -194.3036555650126, -514.6098997411052, -1155.8836518460791, -1242.8330565998426, -711.2490289348738, -1305.2780706370143, -1059.7177474930852, -1024.8488821418093, -204.92061275261116, -852.9039249919003, -810.4896933266677, -332.7933238355015, -1187.7977628221474, -501.3436865560197, -1141.1845447307232, -368.9721855973424, -123.91092726463864, -944.0361440940053, -1262.7828170361947, -1081.0572909592943, -1246.5537302098066, -237.0380876154765, -135.75300274639062, -483.12327301843015, -1127.552180301184, -1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560601037882503, "mean_inference_ms": 1.6777586766134522, "mean_action_processing_ms": 0.28153817156354727, "mean_env_wait_ms": 3.4248642943514547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016833782196044922, "StateBufferConnector_ms": 0.008858680725097656, "ViewRequirementAgentConnector_ms": 0.1923997402191162}, "num_episodes": 31, "episode_return_max": -16.384548874643993, "episode_return_min": -1458.8619416728868, "episode_return_mean": -741.6803406553561, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2091365463797, "num_env_steps_trained_throughput_per_sec": 310.2091365463797, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12266.928, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12266.865, "sample_time_ms": 1136.714, "learn_time_ms": 11064.044, "learn_throughput": 361.531, "synch_weights_time_ms": 65.323}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00004", "date": "2024-08-04_08-06-27", "timestamp": 1722738987, "time_this_iter_s": 12.906563520431519, "time_total_s": 61.39432334899902, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.39432334899902, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.049999999999997, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.0097120533387, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.7997533993174633, "policy_loss": -0.012013142668486883, "vf_loss": 1.8090876590460538, "vf_explained_var": 0.9878634027515848, "kl": 0.014080623824823613, "entropy": 1.3723612663646538, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -16.384548874643993, "episode_reward_min": -1458.8619416728868, "episode_reward_mean": -738.8131968410858, "episode_len_mean": 129.38, "episode_media": {}, "episodes_timesteps_total": 12938, "policy_reward_min": {"policy_0": -1458.8619416728868}, "policy_reward_max": {"policy_0": -16.384548874643993}, "policy_reward_mean": {"policy_0": -738.8131968410858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697], "episode_lengths": [150, 43, 150, 150, 150, 150, 55, 62, 55, 150, 41, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 86, 100, 150, 86, 96, 150, 81, 119, 150, 150, 110, 150, 96, 150, 150, 150, 115, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 71, 150, 150, 84, 150, 78, 150, 121, 81, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 49, 150, 139, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 42, 63, 150, 150, 150], "policy_policy_0_reward": [-1458.8619416728868, -91.49016427134495, -985.3553349279587, -1270.1648495561135, -1172.8736563749455, -741.7273827666377, -54.20109466154921, -89.58171367453824, -72.4837889937102, -536.3772063144166, -16.384548874643993, -416.08812966713947, -1172.162154315284, -1007.4420729944898, -207.62054952125936, -674.4651028251874, -733.0840922795621, -1156.235111391956, -1140.1973745416115, -1370.8512383104462, -1189.010755081785, -161.96769110452897, -1094.1551905295032, -1057.398941251754, -115.87287593636823, -335.36954020307377, -1133.4211813029192, -343.91201862261573, -381.5277695307901, -854.3171435581496, -158.05255378383487, -643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593695351951407, "mean_inference_ms": 1.6802038429148627, "mean_action_processing_ms": 0.2820635752840864, "mean_env_wait_ms": 3.428055443264296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016168832778930664, "StateBufferConnector_ms": 0.008713960647583008, "ViewRequirementAgentConnector_ms": 0.1892838478088379}, "num_episodes": 27, "episode_return_max": -16.384548874643993, "episode_return_min": -1458.8619416728868, "episode_return_mean": -738.8131968410858, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.31445921022646, "num_env_steps_trained_throughput_per_sec": 303.31445921022646, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12420.381, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12420.317, "sample_time_ms": 1132.413, "learn_time_ms": 11220.301, "learn_throughput": 356.497, "synch_weights_time_ms": 66.803}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00004", "date": "2024-08-04_08-06-40", "timestamp": 1722739000, "time_this_iter_s": 13.199606657028198, "time_total_s": 74.59393000602722, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.59393000602722, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.689473684210526, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.11067181328931, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.8910723773452143, "policy_loss": -0.009255967157272001, "vf_loss": 1.8978526622056962, "vf_explained_var": 0.990723845611016, "kl": 0.013064899944295879, "entropy": 1.3729749566564957, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -14.431307687315233, "episode_reward_min": -1338.436780016472, "episode_reward_mean": -769.5624902022818, "episode_len_mean": 133.95, "episode_media": {}, "episodes_timesteps_total": 13395, "policy_reward_min": {"policy_0": -1338.436780016472}, "policy_reward_max": {"policy_0": -14.431307687315233}, "policy_reward_mean": {"policy_0": -769.5624902022818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697, -540.9021327050004, -574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364], "episode_lengths": [119, 150, 150, 110, 150, 96, 150, 150, 150, 115, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 71, 150, 150, 84, 150, 78, 150, 121, 81, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 49, 150, 139, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 42, 63, 150, 150, 150, 150, 130, 150, 150, 37, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 65, 150, 52], "policy_policy_0_reward": [-643.5373253008188, -1127.1230331638008, -835.2662979740447, -570.1764977376591, -928.3389021312839, -422.69602396150316, -705.9392186938481, -859.3161349835145, -751.3334688076452, -472.52939503195387, -54.69129050071804, -992.3828241374956, -1186.6981167349306, -1050.365663795452, -718.9274886560255, -1185.4016643754658, -1179.0807088665297, -964.9754982981482, -1052.75737524788, -845.4292230966796, -1245.1893780075866, -123.9074254762127, -1128.157247944447, -1169.4438979470092, -221.18702267861903, -977.2387299665011, -964.093866481039, -296.4370522087207, -1338.436780016472, -308.5526479468974, -576.5702608718314, -676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697, -540.9021327050004, -574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558302974467177, "mean_inference_ms": 1.6811014952534702, "mean_action_processing_ms": 0.2819409535569774, "mean_env_wait_ms": 3.4324217768046874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012870550155639648, "StateBufferConnector_ms": 0.008599042892456055, "ViewRequirementAgentConnector_ms": 0.19183063507080078}, "num_episodes": 31, "episode_return_max": -14.431307687315233, "episode_return_min": -1338.436780016472, "episode_return_mean": -769.5624902022818, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.64336792368573, "num_env_steps_trained_throughput_per_sec": 311.64336792368573, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12479.641, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12479.574, "sample_time_ms": 1134.575, "learn_time_ms": 11280.515, "learn_throughput": 354.594, "synch_weights_time_ms": 63.698}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00004", "date": "2024-08-04_08-06-53", "timestamp": 1722739013, "time_this_iter_s": 12.847035646438599, "time_total_s": 87.44096565246582, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354071870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.44096565246582, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.177777777777777, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.77892795403798, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.6239266583696008, "policy_loss": -0.005683570292118626, "vf_loss": 1.627942732659479, "vf_explained_var": 0.9845674085120361, "kl": 0.009009738023117582, "entropy": 1.3445404190570116, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -14.431307687315233, "episode_reward_min": -1422.889684701291, "episode_reward_mean": -754.1023564667719, "episode_len_mean": 133.42, "episode_media": {}, "episodes_timesteps_total": 13342, "policy_reward_min": {"policy_0": -1422.889684701291}, "policy_reward_max": {"policy_0": -14.431307687315233}, "policy_reward_mean": {"policy_0": -754.1023564667719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697, -540.9021327050004, -574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364, -444.09409126934884, -1034.6573892978354, -575.3203314025014, -1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633], "episode_lengths": [121, 81, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 49, 150, 139, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 42, 63, 150, 150, 150, 150, 130, 150, 150, 37, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 65, 150, 52, 107, 150, 126, 150, 150, 150, 150, 150, 150, 98, 150, 66, 150, 150, 150, 150, 150, 54, 150, 33, 74, 140, 130, 150, 150, 150, 150, 150, 150, 150, 58], "policy_policy_0_reward": [-676.756593724019, -71.92539083855495, -992.9101503030433, -784.1470073386067, -486.6997026141483, -1094.939261742653, -717.9133815654176, -812.6017546516441, -896.2265051785865, -1173.8634549368714, -978.7209653524696, -991.2174012173764, -442.86483929871144, -464.0549104652395, -312.2536371262218, -39.02522637033665, -806.7735986698068, -518.6503168749397, -998.7174990590054, -1045.87909720826, -940.2936050500596, -1055.484780029489, -842.5045154369029, -1006.7874037812585, -18.57612763228738, -718.512272660388, -1021.629091113279, -546.0497888907331, -784.3179672096933, -546.1988849571037, -1149.6206017250486, -515.8940853852599, -1102.7839588126926, -48.039661087438056, -176.50367666680097, -1128.4113743652522, -801.7474196386545, -1082.9901452485697, -540.9021327050004, -574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364, -444.09409126934884, -1034.6573892978354, -575.3203314025014, -1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573030550990612, "mean_inference_ms": 1.679702883840415, "mean_action_processing_ms": 0.2805442108460589, "mean_env_wait_ms": 3.429230268230376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012314081192016602, "StateBufferConnector_ms": 0.008368492126464844, "ViewRequirementAgentConnector_ms": 0.19216513633728027}, "num_episodes": 31, "episode_return_max": -14.431307687315233, "episode_return_min": -1422.889684701291, "episode_return_mean": -754.1023564667719, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8256872687121, "num_env_steps_trained_throughput_per_sec": 306.8256872687121, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12549.277, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12549.211, "sample_time_ms": 1131.452, "learn_time_ms": 11353.512, "learn_throughput": 352.314, "synch_weights_time_ms": 63.466}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00004", "date": "2024-08-04_08-07-06", "timestamp": 1722739026, "time_this_iter_s": 13.049431085586548, "time_total_s": 100.49039673805237, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.49039673805237, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.7421052631579, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.1756790727377, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.8043546261886756, "policy_loss": -0.0037843680605874398, "vf_loss": 1.8061910366018614, "vf_explained_var": 0.9680936359489958, "kl": 0.010363028763883151, "entropy": 1.246452990670999, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -14.431307687315233, "episode_reward_min": -1430.3333780280536, "episode_reward_mean": -677.924957233745, "episode_len_mean": 122.98, "episode_media": {}, "episodes_timesteps_total": 12298, "policy_reward_min": {"policy_0": -1430.3333780280536}, "policy_reward_max": {"policy_0": -14.431307687315233}, "policy_reward_mean": {"policy_0": -677.924957233745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364, -444.09409126934884, -1034.6573892978354, -575.3203314025014, -1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633, -1213.2708227783028, -138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936], "episode_lengths": [130, 150, 150, 37, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 65, 150, 52, 107, 150, 126, 150, 150, 150, 150, 150, 150, 98, 150, 66, 150, 150, 150, 150, 150, 54, 150, 33, 74, 140, 130, 150, 150, 150, 150, 150, 150, 150, 58, 150, 68, 75, 150, 82, 60, 62, 124, 46, 150, 44, 141, 150, 150, 90, 150, 150, 150, 62, 52, 150, 55, 150, 150, 113, 71, 150, 67, 119, 141, 150, 150, 55, 150, 128, 150, 64, 79, 71], "policy_policy_0_reward": [-574.7918200901593, -1277.0699737699342, -681.6970431848144, -14.431307687315233, -125.53636027434914, -1084.155115985993, -701.5587111322252, -871.3925003729156, -1229.1222915134388, -1269.4546452397456, -742.0515446234259, -770.6512612987602, -1206.748063467353, -559.3650944386766, -916.0427580548707, -1148.9014524130914, -1191.6143626817175, -856.2647521869958, -884.6363286362033, -1001.3037405673297, -762.8270565311417, -951.7547327471191, -1066.3649743618637, -728.9025075706134, -1069.7560874038597, -40.27460313002518, -923.2606661180183, -123.36737666703793, -815.1345011262681, -138.2487389803364, -444.09409126934884, -1034.6573892978354, -575.3203314025014, -1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633, -1213.2708227783028, -138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569026817526076, "mean_inference_ms": 1.6783148586445356, "mean_action_processing_ms": 0.2795221281819482, "mean_env_wait_ms": 3.430958712718808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012060403823852539, "StateBufferConnector_ms": 0.00817108154296875, "ViewRequirementAgentConnector_ms": 0.19647836685180664}, "num_episodes": 39, "episode_return_max": -14.431307687315233, "episode_return_min": -1430.3333780280536, "episode_return_mean": -677.924957233745, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6933147161629, "num_env_steps_trained_throughput_per_sec": 309.6933147161629, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12590.026, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12589.959, "sample_time_ms": 1127.514, "learn_time_ms": 11397.482, "learn_throughput": 350.955, "synch_weights_time_ms": 64.182}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00004", "date": "2024-08-04_08-07-19", "timestamp": 1722739039, "time_this_iter_s": 12.928444862365723, "time_total_s": 113.41884160041809, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ac9d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.41884160041809, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.944444444444443, "ram_util_percent": 28.22222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.77274207870167, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.185338364634663, "policy_loss": -0.0035393098994973117, "vf_loss": 1.1871569461810092, "vf_explained_var": 0.9906608569125335, "kl": 0.009251375952362658, "entropy": 1.2954892965654532, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -20.097011895865357, "episode_reward_min": -1430.3333780280536, "episode_reward_mean": -655.436699252906, "episode_len_mean": 122.34, "episode_media": {}, "episodes_timesteps_total": 12234, "policy_reward_min": {"policy_0": -1430.3333780280536}, "policy_reward_max": {"policy_0": -20.097011895865357}, "policy_reward_mean": {"policy_0": -655.436699252906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633, -1213.2708227783028, -138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844], "episode_lengths": [150, 150, 150, 150, 150, 150, 98, 150, 66, 150, 150, 150, 150, 150, 54, 150, 33, 74, 140, 130, 150, 150, 150, 150, 150, 150, 150, 58, 150, 68, 75, 150, 82, 60, 62, 124, 46, 150, 44, 141, 150, 150, 90, 150, 150, 150, 62, 52, 150, 55, 150, 150, 113, 71, 150, 67, 119, 141, 150, 150, 55, 150, 128, 150, 64, 79, 71, 150, 72, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 139, 150, 65, 150, 150, 80, 79, 150, 80, 72, 150, 49, 150, 114, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1422.889684701291, -1298.7387492535854, -1252.7257907382443, -1283.9019434524575, -728.0897486621404, -981.1401248597219, -287.5174097732496, -1410.4008446674036, -93.26064440244306, -1170.9623277004914, -1078.0168948186476, -941.7614183174326, -666.9709195363864, -463.0432562772504, -56.086855548096494, -622.2662605103906, -20.097011895865357, -120.10830896382872, -671.820103656528, -691.5534929408934, -459.8972968270929, -1023.128077164698, -848.1027987609411, -1280.3898318745137, -763.8238044622403, -1083.9337550417354, -504.9869222739783, -70.48099843853633, -1213.2708227783028, -138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569265589268436, "mean_inference_ms": 1.6803867415273697, "mean_action_processing_ms": 0.2792302981865902, "mean_env_wait_ms": 3.4364698351995018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011771678924560547, "StateBufferConnector_ms": 0.007967710494995117, "ViewRequirementAgentConnector_ms": 0.1905820369720459}, "num_episodes": 33, "episode_return_max": -20.097011895865357, "episode_return_min": -1430.3333780280536, "episode_return_mean": -655.436699252906, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.6955676821654, "num_env_steps_trained_throughput_per_sec": 301.6955676821654, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12656.864, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12656.798, "sample_time_ms": 1133.498, "learn_time_ms": 11458.865, "learn_throughput": 349.075, "synch_weights_time_ms": 63.654}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00004", "date": "2024-08-04_08-07-32", "timestamp": 1722739052, "time_this_iter_s": 13.271753549575806, "time_total_s": 126.6905951499939, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.6905951499939, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.91578947368421, "ram_util_percent": 28.236842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.04618891278903, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2743022007246811, "policy_loss": -0.0066259274492040275, "vf_loss": 1.2782587078089516, "vf_explained_var": 0.9912409711629152, "kl": 0.013956193415492636, "entropy": 1.2182484804963072, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -32.779544905542956, "episode_reward_min": -1430.3333780280536, "episode_reward_mean": -597.4313210477343, "episode_len_mean": 118.04, "episode_media": {}, "episodes_timesteps_total": 11804, "policy_reward_min": {"policy_0": -1430.3333780280536}, "policy_reward_max": {"policy_0": -32.779544905542956}, "policy_reward_mean": {"policy_0": -597.4313210477343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432], "episode_lengths": [68, 75, 150, 82, 60, 62, 124, 46, 150, 44, 141, 150, 150, 90, 150, 150, 150, 62, 52, 150, 55, 150, 150, 113, 71, 150, 67, 119, 141, 150, 150, 55, 150, 128, 150, 64, 79, 71, 150, 72, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 139, 150, 65, 150, 150, 80, 79, 150, 80, 72, 150, 49, 150, 114, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 97, 77, 82, 84, 150, 150, 63, 73, 51, 150, 150, 150, 150, 112, 150, 150, 64, 62, 150, 150, 150, 150, 80, 69, 150, 150], "policy_policy_0_reward": [-138.4770982588941, -230.66338526108697, -904.4140529900685, -346.10740605002775, -180.25159197346872, -93.52266083278806, -588.8696946126346, -105.74551096904158, -922.5778135431359, -77.65701643868829, -792.2167212622273, -664.7587070267895, -519.2721600589821, -196.46729683051973, -1255.2206521695832, -854.8005224363565, -962.4759582601441, -106.8283324617848, -32.779544905542956, -370.6101556651294, -170.61481525338624, -1110.5645581664592, -1171.2296371369255, -574.5339243311056, -186.51006207492085, -405.28300191895914, -109.18619121598401, -279.55830418494884, -536.0068939329954, -790.1943658141065, -1430.3333780280536, -78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560501191846915, "mean_inference_ms": 1.6799674081317166, "mean_action_processing_ms": 0.2790320299994849, "mean_env_wait_ms": 3.4370246084681084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099027633666992, "StateBufferConnector_ms": 0.008199930191040039, "ViewRequirementAgentConnector_ms": 0.1908407211303711}, "num_episodes": 29, "episode_return_max": -32.779544905542956, "episode_return_min": -1430.3333780280536, "episode_return_mean": -597.4313210477343, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.79247316579733, "num_env_steps_trained_throughput_per_sec": 308.79247316579733, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12669.748, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12669.679, "sample_time_ms": 1131.464, "learn_time_ms": 11473.378, "learn_throughput": 348.633, "synch_weights_time_ms": 64.058}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00004", "date": "2024-08-04_08-07-45", "timestamp": 1722739065, "time_this_iter_s": 12.965589761734009, "time_total_s": 139.6561849117279, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.6561849117279, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.022222222222222, "ram_util_percent": 28.283333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.978086600701, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0307589165090272, "policy_loss": -0.009105246138642543, "vf_loss": 1.0379566905709605, "vf_explained_var": 0.9926452958335479, "kl": 0.010193772730432708, "entropy": 1.3128240155677, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -42.68460005149244, "episode_reward_min": -1368.2199260522195, "episode_reward_mean": -677.5208027748945, "episode_len_mean": 126.99, "episode_media": {}, "episodes_timesteps_total": 12699, "policy_reward_min": {"policy_0": -1368.2199260522195}, "policy_reward_max": {"policy_0": -42.68460005149244}, "policy_reward_mean": {"policy_0": -677.5208027748945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453], "episode_lengths": [55, 150, 128, 150, 64, 79, 71, 150, 72, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 139, 150, 65, 150, 150, 80, 79, 150, 80, 72, 150, 49, 150, 114, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 97, 77, 82, 84, 150, 150, 63, 73, 51, 150, 150, 150, 150, 112, 150, 150, 64, 62, 150, 150, 150, 150, 80, 69, 150, 150, 150, 150, 150, 150, 150, 148, 150, 71, 56, 68, 150, 150, 150, 135, 146, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-78.69953384781266, -1062.7177517141724, -483.6526576946044, -1008.3634868207511, -218.96933875001517, -282.8847596314504, -259.3584983272936, -863.0588285910001, -143.12922645418848, -789.1580617639448, -820.710432454372, -435.8175921694167, -870.6189497901721, -330.5551581557311, -714.3916263570126, -834.0188905794006, -272.4537985331228, -872.2983481440641, -859.5586559755276, -614.2577608831871, -836.9065702655035, -77.94273174592269, -996.138876139054, -956.0504834617923, -257.64225274412433, -295.6693558670604, -1023.4363988153721, -318.90680375922625, -124.7594247399864, -959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552931226146535, "mean_inference_ms": 1.6795918504055407, "mean_action_processing_ms": 0.27889655722368933, "mean_env_wait_ms": 3.436946782617115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012135982513427734, "StateBufferConnector_ms": 0.008109331130981445, "ViewRequirementAgentConnector_ms": 0.18872785568237305}, "num_episodes": 31, "episode_return_max": -42.68460005149244, "episode_return_min": -1368.2199260522195, "episode_return_mean": -677.5208027748945, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.6761410066476, "num_env_steps_trained_throughput_per_sec": 321.6761410066476, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12786.523, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12786.453, "sample_time_ms": 1128.946, "learn_time_ms": 11592.979, "learn_throughput": 345.036, "synch_weights_time_ms": 63.747}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00004", "date": "2024-08-04_08-07-58", "timestamp": 1722739078, "time_this_iter_s": 12.446744441986084, "time_total_s": 152.102929353714, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e85e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.102929353714, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.05, "ram_util_percent": 28.294444444444448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.9004771997531, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.132282835400353, "policy_loss": -0.007388422994699795, "vf_loss": 1.1374104676457744, "vf_explained_var": 0.9899095610405008, "kl": 0.01199374893900919, "entropy": 1.3796329704423747, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -24.392763867412505, "episode_reward_min": -1368.2199260522195, "episode_reward_mean": -684.5426016311925, "episode_len_mean": 127.87, "episode_media": {}, "episodes_timesteps_total": 12787, "policy_reward_min": {"policy_0": -1368.2199260522195}, "policy_reward_max": {"policy_0": -24.392763867412505}, "policy_reward_mean": {"policy_0": -684.5426016311925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046], "episode_lengths": [150, 49, 150, 114, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 97, 77, 82, 84, 150, 150, 63, 73, 51, 150, 150, 150, 150, 112, 150, 150, 64, 62, 150, 150, 150, 150, 80, 69, 150, 150, 150, 150, 150, 150, 150, 148, 150, 71, 56, 68, 150, 150, 150, 135, 146, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 50, 88, 150, 150, 150, 51, 93, 72, 47, 150, 150, 146, 67, 150, 150, 121, 80, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-959.9717184684379, -125.51011357498163, -1111.1219737655051, -567.8302625399505, -1051.9673151186098, -1068.5956627462576, -499.1261982044106, -1209.0963476343359, -1221.6111751878377, -1090.7874266456843, -1318.8279648661844, -187.02431862356784, -1027.8676072248932, -648.3639019183464, -433.5756125144081, -79.93109908210056, -259.64328067687507, -278.8952366664416, -1030.6624719563265, -1368.2199260522195, -92.94940564707422, -232.68241059332428, -42.68460005149244, -448.2698052745146, -423.21072233595794, -1110.3110948806157, -505.6998967178179, -321.62808869079305, -1346.1608662568988, -836.2830392942664, -78.51274391790975, -165.97380660328406, -1052.5903799122077, -1115.2042259707523, -1165.0602090639247, -562.9341978394078, -283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551061938991715, "mean_inference_ms": 1.6799150214925676, "mean_action_processing_ms": 0.2792223127480039, "mean_env_wait_ms": 3.441737551235684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012506723403930664, "StateBufferConnector_ms": 0.008187532424926758, "ViewRequirementAgentConnector_ms": 0.19072461128234863}, "num_episodes": 29, "episode_return_max": -24.392763867412505, "episode_return_min": -1368.2199260522195, "episode_return_mean": -684.5426016311925, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3829784430318, "num_env_steps_trained_throughput_per_sec": 300.3829784430318, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12838.9, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12838.83, "sample_time_ms": 1152.214, "learn_time_ms": 11624.307, "learn_throughput": 344.107, "synch_weights_time_ms": 61.534}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00004", "date": "2024-08-04_08-08-11", "timestamp": 1722739091, "time_this_iter_s": 13.328748941421509, "time_total_s": 165.4316782951355, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540eb490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.4316782951355, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.768421052631577, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.4358211417993, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1771125967924794, "policy_loss": -0.005852124034815157, "vf_loss": 1.1814227897363405, "vf_explained_var": 0.9853876205161214, "kl": 0.008380438837601416, "entropy": 1.34157519650956, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -19.795034240630443, "episode_reward_min": -1373.930564398109, "episode_reward_mean": -644.7010356486079, "episode_len_mean": 125.17, "episode_media": {}, "episodes_timesteps_total": 12517, "policy_reward_min": {"policy_0": -1373.930564398109}, "policy_reward_max": {"policy_0": -19.795034240630443}, "policy_reward_mean": {"policy_0": -644.7010356486079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046, -1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507], "episode_lengths": [80, 69, 150, 150, 150, 150, 150, 150, 150, 148, 150, 71, 56, 68, 150, 150, 150, 135, 146, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 50, 88, 150, 150, 150, 51, 93, 72, 47, 150, 150, 146, 67, 150, 150, 121, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 83, 51, 150, 91, 150, 150, 143, 61, 65, 150, 55, 66, 103, 150, 150, 150, 150, 150, 150, 51, 39, 150, 150, 150, 87, 104, 150, 87, 150, 94, 132, 55], "policy_policy_0_reward": [-283.37942529579254, -124.68664019175463, -334.40583187209575, -1152.0174326561432, -1041.918554101914, -904.4442884689711, -559.8948658327852, -1134.8698952409225, -1089.0779399026985, -712.8640438809941, -1030.013941754595, -135.16261555064185, -148.66154307599783, -245.51384131643164, -1007.3410162333284, -968.9249115757933, -934.4811044010036, -560.8899908207553, -240.92712661738338, -1031.6487857429977, -996.9570471959167, -966.2683238319673, -754.7288006655251, -538.667547515818, -607.8859011656027, -483.29149603175335, -1090.5003870405226, -219.04854977558708, -1051.3285753976272, -725.2349020216883, -808.3867231407316, -1014.2711847343982, -1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046, -1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546602870856683, "mean_inference_ms": 1.6799113952581939, "mean_action_processing_ms": 0.27926027070310555, "mean_env_wait_ms": 3.4429154437647504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012189626693725586, "StateBufferConnector_ms": 0.008179187774658203, "ViewRequirementAgentConnector_ms": 0.19292187690734863}, "num_episodes": 36, "episode_return_max": -19.795034240630443, "episode_return_min": -1373.930564398109, "episode_return_mean": -644.7010356486079, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3167474104478, "num_env_steps_trained_throughput_per_sec": 304.3167474104478, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12997.768, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12997.698, "sample_time_ms": 1146.2, "learn_time_ms": 11789.458, "learn_throughput": 339.286, "synch_weights_time_ms": 61.281}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00004", "date": "2024-08-04_08-08-24", "timestamp": 1722739104, "time_this_iter_s": 13.156474828720093, "time_total_s": 178.5881531238556, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.5881531238556, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.573684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.09452126026153, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0586300974090894, "policy_loss": -0.007421971866763973, "vf_loss": 1.0637408189475537, "vf_explained_var": 0.992201101159056, "kl": 0.012286960305148871, "entropy": 1.4614001146207254, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -10.28441122622319, "episode_reward_min": -1373.930564398109, "episode_reward_mean": -632.4051233980806, "episode_len_mean": 121.42, "episode_media": {}, "episodes_timesteps_total": 12142, "policy_reward_min": {"policy_0": -1373.930564398109}, "policy_reward_max": {"policy_0": -10.28441122622319}, "policy_reward_mean": {"policy_0": -632.4051233980806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046, -1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507, -954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149], "episode_lengths": [150, 150, 150, 69, 150, 150, 150, 50, 88, 150, 150, 150, 51, 93, 72, 47, 150, 150, 146, 67, 150, 150, 121, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 83, 51, 150, 91, 150, 150, 143, 61, 65, 150, 55, 66, 103, 150, 150, 150, 150, 150, 150, 51, 39, 150, 150, 150, 87, 104, 150, 87, 150, 94, 132, 55, 150, 150, 77, 108, 42, 33, 69, 47, 150, 76, 150, 150, 77, 150, 131, 150, 150, 66, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1007.3190371707341, -1110.708481490043, -995.4481650856453, -253.2808394197624, -963.300252299604, -838.0377483301427, -562.6230627671431, -24.392763867412505, -349.6304555222275, -1013.0970152841809, -1199.0967015798944, -999.6660005223574, -30.62700574997805, -350.5045337466163, -245.8305026615715, -67.04396638682381, -647.2887460036352, -606.374577216257, -439.3208102799969, -55.82537027899716, -726.6779313491529, -1074.8222128069583, -396.7483784169989, -101.56822935311594, -825.1879703304444, -573.4158703548587, -565.3670208047074, -505.5273583960731, -1078.5580523122715, -507.64989221542857, -1322.0565982103553, -1080.7862733381046, -1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507, -954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543378465130664, "mean_inference_ms": 1.6794697971562869, "mean_action_processing_ms": 0.2793189171768594, "mean_env_wait_ms": 3.443972381975289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012064933776855469, "StateBufferConnector_ms": 0.007979393005371094, "ViewRequirementAgentConnector_ms": 0.1917576789855957}, "num_episodes": 32, "episode_return_max": -10.28441122622319, "episode_return_min": -1373.930564398109, "episode_return_mean": -632.4051233980806, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4004613494382, "num_env_steps_trained_throughput_per_sec": 307.4004613494382, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13009.549, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13009.479, "sample_time_ms": 1147.342, "learn_time_ms": 11798.995, "learn_throughput": 339.012, "synch_weights_time_ms": 62.383}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00004", "date": "2024-08-04_08-08-37", "timestamp": 1722739117, "time_this_iter_s": 13.02466869354248, "time_total_s": 191.61282181739807, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540eb400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.61282181739807, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.08888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.84514804879825, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9895679284197588, "policy_loss": -0.0038946852708856266, "vf_loss": 0.9905098233682413, "vf_explained_var": 0.9917661998420954, "kl": 0.01550673389392614, "entropy": 1.4855794560164213, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -10.28441122622319, "episode_reward_min": -1401.8292317500209, "episode_reward_mean": -659.3622565926493, "episode_len_mean": 122.36, "episode_media": {}, "episodes_timesteps_total": 12236, "policy_reward_min": {"policy_0": -1401.8292317500209}, "policy_reward_max": {"policy_0": -10.28441122622319}, "policy_reward_mean": {"policy_0": -659.3622565926493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507, -954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448], "episode_lengths": [150, 150, 100, 150, 83, 51, 150, 91, 150, 150, 143, 61, 65, 150, 55, 66, 103, 150, 150, 150, 150, 150, 150, 51, 39, 150, 150, 150, 87, 104, 150, 87, 150, 94, 132, 55, 150, 150, 77, 108, 42, 33, 69, 47, 150, 76, 150, 150, 77, 150, 131, 150, 150, 66, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150, 74, 86, 150, 93, 150, 73, 150, 51, 150, 150, 150, 150, 150, 67, 130, 150, 150, 150, 150, 58, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-1373.930564398109, -1188.7991577967766, -260.26762003519144, -844.580874092723, -123.60962484942657, -69.12029117017183, -764.1708379168855, -386.346690937618, -760.1962826739531, -1214.6899599159897, -874.3891162004226, -122.85670252493554, -90.70702299566207, -469.2767817640183, -127.1243741288166, -192.04106027246698, -444.23594741960613, -677.3206264783015, -1034.4308051308512, -714.0008271911928, -1201.1590650686733, -1030.4774717127864, -903.8772274046937, -41.8908864135651, -19.795034240630443, -893.1528243209, -869.8541151906747, -939.7453965217945, -164.29321715767645, -252.70911434016574, -1049.334430128043, -330.27280229287834, -1038.9783357010192, -224.93785546806555, -288.98877782730017, -73.06678657718507, -954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539459227413428, "mean_inference_ms": 1.6789209929237412, "mean_action_processing_ms": 0.2786837876730203, "mean_env_wait_ms": 3.444960231807303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011838436126708984, "StateBufferConnector_ms": 0.008008003234863281, "ViewRequirementAgentConnector_ms": 0.19358158111572266}, "num_episodes": 32, "episode_return_max": -10.28441122622319, "episode_return_min": -1401.8292317500209, "episode_return_mean": -659.3622565926493, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0994789991263, "num_env_steps_trained_throughput_per_sec": 304.0994789991263, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13006.145, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13006.074, "sample_time_ms": 1148.376, "learn_time_ms": 11794.626, "learn_throughput": 339.137, "synch_weights_time_ms": 62.32}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00004", "date": "2024-08-04_08-08-50", "timestamp": 1722739130, "time_this_iter_s": 13.167475461959839, "time_total_s": 204.7802972793579, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540715a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.7802972793579, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.88947368421053, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.3676142990589, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1122949793624382, "policy_loss": -0.008430010051718758, "vf_loss": 1.1188356960502763, "vf_explained_var": 0.988063515474399, "kl": 0.010147031575403769, "entropy": 1.4011251418540875, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -10.28441122622319, "episode_reward_min": -1401.8292317500209, "episode_reward_mean": -683.477875480226, "episode_len_mean": 124.82, "episode_media": {}, "episodes_timesteps_total": 12482, "policy_reward_min": {"policy_0": -1401.8292317500209}, "policy_reward_max": {"policy_0": -10.28441122622319}, "policy_reward_mean": {"policy_0": -683.477875480226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262], "episode_lengths": [150, 150, 77, 108, 42, 33, 69, 47, 150, 76, 150, 150, 77, 150, 131, 150, 150, 66, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150, 74, 86, 150, 93, 150, 73, 150, 51, 150, 150, 150, 150, 150, 67, 130, 150, 150, 150, 150, 58, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 66, 150, 37, 40, 150, 114, 60, 150, 150, 150, 54, 138, 72, 150, 100, 150, 128, 81, 119, 150, 150, 150, 150, 150, 101, 150, 145, 150, 54, 150, 150, 104, 150, 150], "policy_policy_0_reward": [-954.1316664450283, -788.039387919243, -275.6465013889874, -232.8336894264733, -22.46153593281384, -10.28441122622319, -113.85415979996378, -24.173795613481122, -737.772626001353, -79.55010711062025, -542.9011856409453, -1309.3348944274485, -243.67543146205148, -1155.971419065511, -699.0935831674655, -804.2777579549401, -241.76676419459054, -112.72016952538192, -1044.352408188987, -924.9540730891608, -897.5537052713084, -810.6368438383469, -233.68720457916066, -928.0835401163644, -656.3651764543386, -1255.6532883623863, -1372.2721276551608, -1020.0888984280662, -1092.1314472731724, -1092.4273831609553, -698.2702843943217, -1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537340804823657, "mean_inference_ms": 1.6782836514334907, "mean_action_processing_ms": 0.27828174691936974, "mean_env_wait_ms": 3.445295018556004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011600017547607422, "StateBufferConnector_ms": 0.008075714111328125, "ViewRequirementAgentConnector_ms": 0.19475102424621582}, "num_episodes": 36, "episode_return_max": -10.28441122622319, "episode_return_min": -1401.8292317500209, "episode_return_mean": -683.477875480226, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1895895707553, "num_env_steps_trained_throughput_per_sec": 311.1895895707553, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13008.016, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13007.947, "sample_time_ms": 1143.049, "learn_time_ms": 11800.772, "learn_throughput": 338.961, "synch_weights_time_ms": 63.369}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00004", "date": "2024-08-04_08-09-03", "timestamp": 1722739143, "time_this_iter_s": 12.865630626678467, "time_total_s": 217.64592790603638, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aeef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.64592790603638, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.65263157894737, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.41286259094875, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1074726379786928, "policy_loss": -0.004497552537213778, "vf_loss": 1.1101126899942755, "vf_explained_var": 0.9939880815645059, "kl": 0.009982029593265914, "entropy": 1.3890206913153331, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -14.333399850680504, "episode_reward_min": -1401.8292317500209, "episode_reward_mean": -650.3378275654295, "episode_len_mean": 124.69, "episode_media": {}, "episodes_timesteps_total": 12469, "policy_reward_min": {"policy_0": -1401.8292317500209}, "policy_reward_max": {"policy_0": -14.333399850680504}, "policy_reward_mean": {"policy_0": -650.3378275654295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618], "episode_lengths": [150, 74, 86, 150, 93, 150, 73, 150, 51, 150, 150, 150, 150, 150, 67, 130, 150, 150, 150, 150, 58, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 66, 150, 37, 40, 150, 114, 60, 150, 150, 150, 54, 138, 72, 150, 100, 150, 128, 81, 119, 150, 150, 150, 150, 150, 101, 150, 145, 150, 54, 150, 150, 104, 150, 150, 100, 95, 65, 114, 150, 53, 150, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 117, 79, 51, 150, 150, 61, 63, 150, 150, 94, 150, 150, 150, 150], "policy_policy_0_reward": [-1293.136540883149, -281.5015383320335, -313.0591638868495, -1071.3246322659443, -225.50447661894972, -1083.2970057574971, -96.91961322337116, -528.401567673571, -97.5631300009854, -840.5010839780156, -651.914371065764, -961.2700318411618, -1401.8292317500209, -538.3945477459259, -86.5638604368427, -459.88729569749137, -641.5000556340351, -948.9424637241797, -1239.7311499573168, -856.0888421201264, -65.10501908463822, -1148.105795676342, -1129.5031681598184, -861.9573625299176, -380.156212301381, -1046.216979044078, -997.2485848445606, -1050.4284844302936, -1018.7663677686077, -1303.6796932782745, -886.7082094114921, -294.3367043638103, -707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542273848428482, "mean_inference_ms": 1.6792344982942162, "mean_action_processing_ms": 0.2783064387688244, "mean_env_wait_ms": 3.4487214538298856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011900186538696289, "StateBufferConnector_ms": 0.008121967315673828, "ViewRequirementAgentConnector_ms": 0.19455361366271973}, "num_episodes": 31, "episode_return_max": -14.333399850680504, "episode_return_min": -1401.8292317500209, "episode_return_mean": -650.3378275654295, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.204013440228, "num_env_steps_trained_throughput_per_sec": 305.204013440228, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13014.943, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13014.873, "sample_time_ms": 1152.632, "learn_time_ms": 11796.812, "learn_throughput": 339.075, "synch_weights_time_ms": 64.671}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00004", "date": "2024-08-04_08-09-17", "timestamp": 1722739157, "time_this_iter_s": 13.11728048324585, "time_total_s": 230.76320838928223, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354134f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.76320838928223, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.20555555555556, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.73983188271524, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0001515986397862, "policy_loss": -0.010234999687236268, "vf_loss": 1.0080151021170118, "vf_explained_var": 0.9972298234701157, "kl": 0.012568249194009696, "entropy": 1.4215802745272716, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -14.333399850680504, "episode_reward_min": -1374.7486348353343, "episode_reward_mean": -634.8158087251782, "episode_len_mean": 126.23, "episode_media": {}, "episodes_timesteps_total": 12623, "policy_reward_min": {"policy_0": -1374.7486348353343}, "policy_reward_max": {"policy_0": -14.333399850680504}, "policy_reward_mean": {"policy_0": -634.8158087251782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026], "episode_lengths": [150, 150, 150, 66, 150, 37, 40, 150, 114, 60, 150, 150, 150, 54, 138, 72, 150, 100, 150, 128, 81, 119, 150, 150, 150, 150, 150, 101, 150, 145, 150, 54, 150, 150, 104, 150, 150, 100, 95, 65, 114, 150, 53, 150, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 117, 79, 51, 150, 150, 61, 63, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 70, 143, 150, 45, 150, 150, 150, 150, 70, 150, 150, 150, 75, 124, 121], "policy_policy_0_reward": [-707.0885004050448, -398.94134213481084, -1059.803258477666, -151.0713394716957, -633.6387465883507, -32.418936681123775, -14.333399850680504, -781.8449555802985, -619.8610275010398, -63.1708489326016, -972.9256658322414, -612.2747004098986, -1080.5461996130882, -145.0018221925979, -436.25618963700225, -73.657203233398, -827.6041200521879, -220.1132962091804, -1008.2606004834844, -308.56449283606725, -119.89096092826469, -538.0482058799523, -862.8778135063815, -1088.3629841679117, -1226.2371680214808, -1218.2009017010555, -898.5502516703914, -499.46180734231723, -1134.5670860134494, -690.8895748361372, -1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543382951000004, "mean_inference_ms": 1.678707841603598, "mean_action_processing_ms": 0.2781843273681535, "mean_env_wait_ms": 3.4470552865100275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011748075485229492, "StateBufferConnector_ms": 0.008019208908081055, "ViewRequirementAgentConnector_ms": 0.1911604404449463}, "num_episodes": 32, "episode_return_max": -14.333399850680504, "episode_return_min": -1374.7486348353343, "episode_return_mean": -634.8158087251782, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.60816240838244, "num_env_steps_trained_throughput_per_sec": 306.60816240838244, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13027.94, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13027.87, "sample_time_ms": 1154.969, "learn_time_ms": 11808.16, "learn_throughput": 338.749, "synch_weights_time_ms": 63.986}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00004", "date": "2024-08-04_08-09-30", "timestamp": 1722739170, "time_this_iter_s": 13.058188438415527, "time_total_s": 243.82139682769775, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ae830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.82139682769775, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.668421052631583, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 183.05028895338376, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2801291233549514, "policy_loss": -0.009773266345534163, "vf_loss": 1.2876308421914777, "vf_explained_var": 0.9926245701809724, "kl": 0.012008558216954656, "entropy": 1.3016375212619702, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -20.01365127158004, "episode_reward_min": -1374.7486348353343, "episode_reward_mean": -623.6460233390459, "episode_len_mean": 125.14, "episode_media": {}, "episodes_timesteps_total": 12514, "policy_reward_min": {"policy_0": -1374.7486348353343}, "policy_reward_max": {"policy_0": -20.01365127158004}, "policy_reward_mean": {"policy_0": -623.6460233390459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017], "episode_lengths": [150, 54, 150, 150, 104, 150, 150, 100, 95, 65, 114, 150, 53, 150, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 117, 79, 51, 150, 150, 61, 63, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 70, 143, 150, 45, 150, 150, 150, 150, 70, 150, 150, 150, 75, 124, 121, 150, 150, 150, 105, 150, 150, 89, 58, 49, 88, 73, 60, 112, 150, 69, 150, 150, 150, 115, 150, 127, 150, 150, 150, 78, 150, 76, 150, 47, 150], "policy_policy_0_reward": [-1296.3463778388696, -69.99478244926998, -899.0055354868808, -1124.515934686359, -426.9634820424941, -866.4848846749595, -1065.504500053262, -477.1569765341268, -434.672229026942, -128.8760820386965, -483.428317894385, -592.0167288107253, -57.58574766828293, -1022.7544298869241, -180.9702880163339, -858.5156611036828, -1237.8317159845094, -424.74695227171065, -1002.1800832255545, -574.737587804258, -1069.9619510346483, -1000.3029283908246, -75.95044813221307, -439.2468915427584, -437.06247734122724, -169.72775046218283, -20.01365127158004, -366.10160071108373, -418.7744524724454, -88.28866892168543, -162.87947888176777, -1024.02583679789, -590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542922220530376, "mean_inference_ms": 1.6781213819902012, "mean_action_processing_ms": 0.27789733198639743, "mean_env_wait_ms": 3.446431580539705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012005090713500977, "StateBufferConnector_ms": 0.007833242416381836, "ViewRequirementAgentConnector_ms": 0.20114707946777344}, "num_episodes": 30, "episode_return_max": -20.01365127158004, "episode_return_min": -1374.7486348353343, "episode_return_mean": -623.6460233390459, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65705004197173, "num_env_steps_trained_throughput_per_sec": 300.65705004197173, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13032.519, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13032.45, "sample_time_ms": 1148.378, "learn_time_ms": 11818.011, "learn_throughput": 338.466, "synch_weights_time_ms": 65.306}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00004", "date": "2024-08-04_08-09-43", "timestamp": 1722739183, "time_this_iter_s": 13.31695818901062, "time_total_s": 257.1383550167084, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.1383550167084, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.768421052631577, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.04138451814651, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0568191634180646, "policy_loss": -0.005038238956088511, "vf_loss": 1.0600733732183774, "vf_explained_var": 0.9875047390038768, "kl": 0.009654925459896428, "entropy": 1.4695985287427902, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -21.910968130913567, "episode_reward_min": -1374.7486348353343, "episode_reward_mean": -629.4031174831013, "episode_len_mean": 125.8, "episode_media": {}, "episodes_timesteps_total": 12580, "policy_reward_min": {"policy_0": -1374.7486348353343}, "policy_reward_max": {"policy_0": -21.910968130913567}, "policy_reward_mean": {"policy_0": -629.4031174831013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579], "episode_lengths": [150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 70, 143, 150, 45, 150, 150, 150, 150, 70, 150, 150, 150, 75, 124, 121, 150, 150, 150, 105, 150, 150, 89, 58, 49, 88, 73, 60, 112, 150, 69, 150, 150, 150, 115, 150, 127, 150, 150, 150, 78, 150, 76, 150, 47, 150, 150, 150, 115, 48, 150, 150, 83, 108, 142, 150, 150, 150, 76, 150, 80, 67, 90, 150, 150, 76, 150, 85, 105, 67, 87, 150, 150, 150, 129, 150, 150, 150], "policy_policy_0_reward": [-590.4937401479287, -235.50475797865207, -427.7976149605337, -1023.1778853347819, -1047.5338751491176, -988.6438658371618, -489.3346745315092, -675.1276307801312, -1204.9451895032348, -1004.2154544628416, -1098.7795748588378, -55.22584513421227, -1191.0784420971095, -1374.7486348353343, -444.116520388721, -883.5767309261407, -590.2021977768504, -691.6418060778756, -416.3791201308622, -1046.0130946111858, -1120.8212461945466, -527.8018045950367, -876.9327316782608, -121.69731127113, -359.2136120618931, -691.8858767924369, -21.910968130913567, -703.2799241203081, -1076.1862054366322, -882.1049812795758, -830.1462464121961, -138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541238284731588, "mean_inference_ms": 1.6751414184961362, "mean_action_processing_ms": 0.27775273069474393, "mean_env_wait_ms": 3.444029044891858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011980056762695312, "StateBufferConnector_ms": 0.007909059524536133, "ViewRequirementAgentConnector_ms": 0.20298552513122559}, "num_episodes": 32, "episode_return_max": -21.910968130913567, "episode_return_min": -1374.7486348353343, "episode_return_mean": -629.4031174831013, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.32482210981, "num_env_steps_trained_throughput_per_sec": 315.32482210981, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13005.684, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13005.617, "sample_time_ms": 1148.747, "learn_time_ms": 11789.969, "learn_throughput": 339.271, "synch_weights_time_ms": 66.146}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00004", "date": "2024-08-04_08-09-56", "timestamp": 1722739196, "time_this_iter_s": 12.69737720489502, "time_total_s": 269.8357322216034, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.8357322216034, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.866666666666667, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 187.34625470836957, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0203458757760624, "policy_loss": -0.007121280372181597, "vf_loss": 1.0250991584112248, "vf_explained_var": 0.9930620794494947, "kl": 0.012498967845734428, "entropy": 1.3179102748632432, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -34.102990238072735, "episode_reward_min": -1358.9142153543446, "episode_reward_mean": -619.8119426411774, "episode_len_mean": 123.63, "episode_media": {}, "episodes_timesteps_total": 12363, "policy_reward_min": {"policy_0": -1358.9142153543446}, "policy_reward_max": {"policy_0": -34.102990238072735}, "policy_reward_mean": {"policy_0": -619.8119426411774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772], "episode_lengths": [70, 150, 150, 150, 75, 124, 121, 150, 150, 150, 105, 150, 150, 89, 58, 49, 88, 73, 60, 112, 150, 69, 150, 150, 150, 115, 150, 127, 150, 150, 150, 78, 150, 76, 150, 47, 150, 150, 150, 115, 48, 150, 150, 83, 108, 142, 150, 150, 150, 76, 150, 80, 67, 90, 150, 150, 76, 150, 85, 105, 67, 87, 150, 150, 150, 129, 150, 150, 150, 150, 42, 150, 90, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 76, 73, 150, 150, 64, 150, 150, 150, 99, 117, 150], "policy_policy_0_reward": [-138.4823005426946, -1299.6079879893773, -348.3809495577527, -1223.220284924444, -149.87071521909462, -288.24969982569763, -422.16353731446026, -691.9346671281893, -1286.4814213847903, -782.8881548893678, -429.3642252293137, -555.9873043619679, -1126.9991230088, -221.42705607199196, -119.88192803999567, -37.36342335848012, -137.71348974690588, -96.8223795684085, -167.2905972230582, -494.60275166163433, -1080.7477676893282, -109.29016381566662, -923.0120594533144, -1358.9142153543446, -370.49893188085446, -410.3552931209685, -704.0861429027203, -606.966652261706, -348.92918969755243, -1284.2672185393674, -1091.940051070952, -166.24364696136197, -476.20666735543483, -239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540407960276061, "mean_inference_ms": 1.6741772987466061, "mean_action_processing_ms": 0.2776223209046717, "mean_env_wait_ms": 3.4455688311266575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01221156120300293, "StateBufferConnector_ms": 0.00794076919555664, "ViewRequirementAgentConnector_ms": 0.21349477767944336}, "num_episodes": 31, "episode_return_max": -34.102990238072735, "episode_return_min": -1358.9142153543446, "episode_return_mean": -619.8119426411774, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.6551629554984, "num_env_steps_trained_throughput_per_sec": 314.6551629554984, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13033.43, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13033.364, "sample_time_ms": 1146.959, "learn_time_ms": 11819.168, "learn_throughput": 338.433, "synch_weights_time_ms": 66.477}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00004", "date": "2024-08-04_08-10-08", "timestamp": 1722739208, "time_this_iter_s": 12.725847721099854, "time_total_s": 282.56157994270325, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.56157994270325, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.283333333333335, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.45671525200208, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1584032158056894, "policy_loss": -0.003352782505680807, "vf_loss": 1.1601404972374438, "vf_explained_var": 0.9907517664755384, "kl": 0.008699989752615996, "entropy": 1.2449792306870222, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -34.102990238072735, "episode_reward_min": -1318.1305944875478, "episode_reward_mean": -638.0662250268109, "episode_len_mean": 126.73, "episode_media": {}, "episodes_timesteps_total": 12673, "policy_reward_min": {"policy_0": -1318.1305944875478}, "policy_reward_max": {"policy_0": -34.102990238072735}, "policy_reward_mean": {"policy_0": -638.0662250268109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772, -620.1146222935546, -294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978], "episode_lengths": [76, 150, 47, 150, 150, 150, 115, 48, 150, 150, 83, 108, 142, 150, 150, 150, 76, 150, 80, 67, 90, 150, 150, 76, 150, 85, 105, 67, 87, 150, 150, 150, 129, 150, 150, 150, 150, 42, 150, 90, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 76, 73, 150, 150, 64, 150, 150, 150, 99, 117, 150, 150, 139, 150, 88, 71, 150, 150, 79, 150, 150, 77, 130, 141, 150, 150, 69, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 73, 103, 150, 79, 150, 150], "policy_policy_0_reward": [-239.62233393598228, -829.5129089262418, -34.102990238072735, -1124.0321066998017, -1265.477614825666, -593.4139190470864, -521.4761981229952, -97.09598112195907, -755.295598374805, -854.4712853048375, -135.09982685033538, -535.0702188349283, -392.4805135205472, -458.32905520895895, -486.9492237321236, -552.962461921882, -286.29814501546906, -702.8320878589584, -242.0265652349222, -140.3530014005325, -149.95366840652053, -1154.4207614818492, -876.0223852491282, -276.7871007755521, -938.9940411958764, -351.376208944019, -234.47258807304658, -233.36880634272245, -386.76224954866393, -1189.7722228705154, -1318.1305944875478, -898.1272638136176, -306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772, -620.1146222935546, -294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537931748015305, "mean_inference_ms": 1.6743283810498113, "mean_action_processing_ms": 0.2776881164769684, "mean_env_wait_ms": 3.4488922318654414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012269735336303711, "StateBufferConnector_ms": 0.007986068725585938, "ViewRequirementAgentConnector_ms": 0.2033536434173584}, "num_episodes": 33, "episode_return_max": -34.102990238072735, "episode_return_min": -1318.1305944875478, "episode_return_mean": -638.0662250268109, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4717177167298, "num_env_steps_trained_throughput_per_sec": 309.4717177167298, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12994.322, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12994.255, "sample_time_ms": 1126.663, "learn_time_ms": 11799.572, "learn_throughput": 338.995, "synch_weights_time_ms": 67.258}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00004", "date": "2024-08-04_08-10-21", "timestamp": 1722739221, "time_this_iter_s": 12.936315536499023, "time_total_s": 295.49789547920227, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.49789547920227, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.222222222222225, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.53844415545464, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2205289352374773, "policy_loss": -0.008260991482044726, "vf_loss": 1.2269699453686675, "vf_explained_var": 0.9842280669137835, "kl": 0.009737239258189827, "entropy": 1.2746671261886755, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -49.57425060609751, "episode_reward_min": -1312.8522179374695, "episode_reward_mean": -643.1571077777965, "episode_len_mean": 129.08, "episode_media": {}, "episodes_timesteps_total": 12908, "policy_reward_min": {"policy_0": -1312.8522179374695}, "policy_reward_max": {"policy_0": -49.57425060609751}, "policy_reward_mean": {"policy_0": -643.1571077777965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772, -620.1146222935546, -294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978, -627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311], "episode_lengths": [129, 150, 150, 150, 150, 42, 150, 90, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 76, 73, 150, 150, 64, 150, 150, 150, 99, 117, 150, 150, 139, 150, 88, 71, 150, 150, 79, 150, 150, 77, 130, 141, 150, 150, 69, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 73, 103, 150, 79, 150, 150, 141, 90, 150, 150, 150, 150, 150, 150, 110, 150, 66, 85, 81, 73, 90, 150, 150, 150, 62, 144, 76, 87, 150, 136, 150, 150, 134, 150, 117, 95, 150, 150], "policy_policy_0_reward": [-306.50918656184996, -553.3882114438387, -1312.8522179374695, -871.7646443558579, -1181.6465582254307, -79.12661746885635, -850.4106731628018, -328.4907832094011, -269.7262949675266, -476.41195637259375, -355.8808004756492, -375.95916913575843, -1305.2777378728374, -811.2708323329363, -1031.7825799134584, -1057.2318864877082, -948.8232993128639, -721.5270210394966, -797.7112460693048, -414.7569892450996, -1271.538694406709, -729.0501836132795, -624.6897718675948, -980.7068146643991, -114.96179114793439, -109.46051832916174, -616.5155447725936, -924.4320666279443, -86.73857464985599, -1051.4159759332701, -1165.3263882301096, -1189.0617412270617, -437.726496372486, -454.46066786837497, -969.2804043010772, -620.1146222935546, -294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978, -627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535345008338982, "mean_inference_ms": 1.674348705621737, "mean_action_processing_ms": 0.2773355612782359, "mean_env_wait_ms": 3.446907808103678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012263774871826172, "StateBufferConnector_ms": 0.007987022399902344, "ViewRequirementAgentConnector_ms": 0.20334935188293457}, "num_episodes": 32, "episode_return_max": -49.57425060609751, "episode_return_min": -1312.8522179374695, "episode_return_mean": -643.1571077777965, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8391044751661, "num_env_steps_trained_throughput_per_sec": 306.8391044751661, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12983.517, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12983.447, "sample_time_ms": 1121.743, "learn_time_ms": 11793.774, "learn_throughput": 339.162, "synch_weights_time_ms": 67.159}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00004", "date": "2024-08-04_08-10-35", "timestamp": 1722739235, "time_this_iter_s": 13.048692464828491, "time_total_s": 308.54658794403076, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354135c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.54658794403076, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.71052631578947, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.81525200903417, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2101127170647183, "policy_loss": -0.009492974550812504, "vf_loss": 1.2175856214016676, "vf_explained_var": 0.9855518961325288, "kl": 0.010743809251145346, "entropy": 1.2869394397983949, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -13.85035661290144, "episode_reward_min": -1329.1834018571396, "episode_reward_mean": -564.8253336424474, "episode_len_mean": 120.28, "episode_media": {}, "episodes_timesteps_total": 12028, "policy_reward_min": {"policy_0": -1329.1834018571396}, "policy_reward_max": {"policy_0": -13.85035661290144}, "policy_reward_mean": {"policy_0": -564.8253336424474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978, -627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311, -1329.1834018571396, -757.4885631305477, -253.98058184029026, -109.24242698331048, -305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132], "episode_lengths": [139, 150, 88, 71, 150, 150, 79, 150, 150, 77, 130, 141, 150, 150, 69, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 73, 103, 150, 79, 150, 150, 141, 90, 150, 150, 150, 150, 150, 150, 110, 150, 66, 85, 81, 73, 90, 150, 150, 150, 62, 144, 76, 87, 150, 136, 150, 150, 134, 150, 117, 95, 150, 150, 150, 143, 102, 77, 84, 150, 111, 150, 150, 106, 150, 67, 82, 150, 46, 41, 79, 150, 150, 59, 120, 39, 49, 64, 132, 150, 123, 150, 150, 150, 119, 134, 50, 61, 150, 80], "policy_policy_0_reward": [-294.18564040119554, -960.3987952976122, -363.4245745111379, -126.92162693445071, -790.1763892074812, -508.0976383426138, -128.77338453875313, -488.17574429073613, -1243.628369798485, -120.8145462634549, -358.5210096055942, -723.9879068705009, -1111.9101491170252, -1168.6939085186846, -165.94390672571984, -437.5001495840534, -1285.2878821610884, -895.0161039108378, -1232.3804997190148, -1052.2390386346985, -312.40582618960417, -148.1030474087061, -628.429182330916, -728.618610653387, -526.9742306671633, -1024.5296110863003, -249.3786776818068, -204.846172418129, -718.6127668716991, -274.3749895647768, -1040.7440394643695, -842.40919464978, -627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311, -1329.1834018571396, -757.4885631305477, -253.98058184029026, -109.24242698331048, -305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538498525113867, "mean_inference_ms": 1.6763615576000868, "mean_action_processing_ms": 0.27754061921982226, "mean_env_wait_ms": 3.449581476626952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011812210083007812, "StateBufferConnector_ms": 0.008025407791137695, "ViewRequirementAgentConnector_ms": 0.19429540634155273}, "num_episodes": 36, "episode_return_max": -13.85035661290144, "episode_return_min": -1329.1834018571396, "episode_return_mean": -564.8253336424474, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.8009099206691, "num_env_steps_trained_throughput_per_sec": 312.8009099206691, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12961.052, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12960.98, "sample_time_ms": 1118.878, "learn_time_ms": 11774.819, "learn_throughput": 339.708, "synch_weights_time_ms": 66.503}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00004", "date": "2024-08-04_08-10-47", "timestamp": 1722739247, "time_this_iter_s": 12.8021821975708, "time_total_s": 321.34877014160156, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.34877014160156, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.016666666666666, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.3601627200842, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.211730861508598, "policy_loss": -0.01330211198849914, "vf_loss": 1.2219713291774192, "vf_explained_var": 0.9959657498324911, "kl": 0.015865290579677095, "entropy": 1.1141408382604518, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -12.445647972127023, "episode_reward_min": -1330.3790847277792, "episode_reward_mean": -533.3188052457597, "episode_len_mean": 116.9, "episode_media": {}, "episodes_timesteps_total": 11690, "policy_reward_min": {"policy_0": -1330.3790847277792}, "policy_reward_max": {"policy_0": -12.445647972127023}, "policy_reward_mean": {"policy_0": -533.3188052457597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311, -1329.1834018571396, -757.4885631305477, -253.98058184029026, -109.24242698331048, -305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132, -692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857], "episode_lengths": [141, 90, 150, 150, 150, 150, 150, 150, 110, 150, 66, 85, 81, 73, 90, 150, 150, 150, 62, 144, 76, 87, 150, 136, 150, 150, 134, 150, 117, 95, 150, 150, 150, 143, 102, 77, 84, 150, 111, 150, 150, 106, 150, 67, 82, 150, 46, 41, 79, 150, 150, 59, 120, 39, 49, 64, 132, 150, 123, 150, 150, 150, 119, 134, 50, 61, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 69, 73, 150, 150, 68, 92, 150, 150, 92, 56, 150, 41, 150, 94, 150, 77, 150, 60, 91, 150, 150, 150], "policy_policy_0_reward": [-627.7233118284103, -228.41113433319114, -1157.8905310313673, -602.1006211177754, -636.2589865477797, -1084.239967233324, -822.4935718388325, -1154.3505603671626, -459.3780330262835, -618.5528420334642, -49.57425060609751, -196.8679134527234, -109.17976226350895, -269.1672684019583, -143.530441446357, -1205.5430107114416, -781.9078919172633, -1095.9385258001068, -78.55055042933385, -321.12091497162413, -128.37968415515522, -106.40379050887017, -342.7600222292538, -356.312434440039, -921.3800402949897, -945.2965764135987, -646.659353560348, -663.5607862147402, -538.3191695050801, -386.4933842073435, -1266.5181519156704, -819.3147196606311, -1329.1834018571396, -757.4885631305477, -253.98058184029026, -109.24242698331048, -305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132, -692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543904410534483, "mean_inference_ms": 1.6773730828686095, "mean_action_processing_ms": 0.2773218444091304, "mean_env_wait_ms": 3.4493478221387277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011772632598876953, "StateBufferConnector_ms": 0.008049488067626953, "ViewRequirementAgentConnector_ms": 0.1947188377380371}, "num_episodes": 32, "episode_return_max": -12.445647972127023, "episode_return_min": -1330.3790847277792, "episode_return_mean": -533.3188052457597, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.66220500169015, "num_env_steps_trained_throughput_per_sec": 307.66220500169015, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12945.82, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12945.749, "sample_time_ms": 1121.768, "learn_time_ms": 11756.804, "learn_throughput": 340.229, "synch_weights_time_ms": 66.397}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00004", "date": "2024-08-04_08-11-00", "timestamp": 1722739260, "time_this_iter_s": 13.013659954071045, "time_total_s": 334.3624300956726, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bfe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.3624300956726, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.73157894736842, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.8005601088206, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1787856968740622, "policy_loss": -0.00641365240541442, "vf_loss": 1.183045506849885, "vf_explained_var": 0.9896959060182174, "kl": 0.011336945517359708, "entropy": 1.1354530015339455, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -12.445647972127023, "episode_reward_min": -1330.3790847277792, "episode_reward_mean": -505.5165135268489, "episode_len_mean": 114.95, "episode_media": {}, "episodes_timesteps_total": 11495, "policy_reward_min": {"policy_0": -1330.3790847277792}, "policy_reward_max": {"policy_0": -12.445647972127023}, "policy_reward_mean": {"policy_0": -505.5165135268489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132, -692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857, -744.482048176515, -208.99220054294588, -1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384], "episode_lengths": [84, 150, 111, 150, 150, 106, 150, 67, 82, 150, 46, 41, 79, 150, 150, 59, 120, 39, 49, 64, 132, 150, 123, 150, 150, 150, 119, 134, 50, 61, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 69, 73, 150, 150, 68, 92, 150, 150, 92, 56, 150, 41, 150, 94, 150, 77, 150, 60, 91, 150, 150, 150, 150, 75, 150, 150, 150, 59, 116, 150, 150, 150, 150, 56, 107, 150, 119, 150, 150, 111, 47, 150, 75, 150, 150, 82, 76, 76, 150, 150, 145, 150, 78, 150, 46, 150, 63, 83], "policy_policy_0_reward": [-305.15410423375846, -985.5375965514687, -269.73381780602966, -968.1909471768063, -633.6812018534816, -258.9390425862444, -904.2471846332509, -84.2159703730898, -134.68101225292705, -632.4327827357761, -85.85188820800883, -37.46146009532982, -222.73102960677397, -1322.5529400232851, -579.2266507606882, -150.26017178135754, -535.2318272867292, -13.85035661290144, -59.47965515706778, -109.56829241116476, -222.90748074490915, -1324.0605888571715, -661.8513577558743, -617.3145103784719, -698.4934477545185, -936.0991409737435, -379.3545843857938, -746.648197435159, -61.917124819832864, -72.12619578197315, -887.2151470513531, -211.9408664650132, -692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857, -744.482048176515, -208.99220054294588, -1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548737041067713, "mean_inference_ms": 1.676702582003777, "mean_action_processing_ms": 0.27707127521563246, "mean_env_wait_ms": 3.44643353848589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011696815490722656, "StateBufferConnector_ms": 0.008020639419555664, "ViewRequirementAgentConnector_ms": 0.1928424835205078}, "num_episodes": 36, "episode_return_max": -12.445647972127023, "episode_return_min": -1330.3790847277792, "episode_return_mean": -505.5165135268489, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6418778753828, "num_env_steps_trained_throughput_per_sec": 308.6418778753828, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12956.43, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12956.359, "sample_time_ms": 1119.541, "learn_time_ms": 11768.73, "learn_throughput": 339.884, "synch_weights_time_ms": 67.307}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00004", "date": "2024-08-04_08-11-14", "timestamp": 1722739274, "time_this_iter_s": 12.973678350448608, "time_total_s": 347.3361084461212, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.3361084461212, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.822222222222223, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.58399893144767, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1174092665935556, "policy_loss": -0.010125754189114862, "vf_loss": 1.124509161307166, "vf_explained_var": 0.9939218681926528, "kl": 0.015713972492934165, "entropy": 1.1693108056982358, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -12.445647972127023, "episode_reward_min": -1330.3790847277792, "episode_reward_mean": -512.4312507726037, "episode_len_mean": 117.84, "episode_media": {}, "episodes_timesteps_total": 11784, "policy_reward_min": {"policy_0": -1330.3790847277792}, "policy_reward_max": {"policy_0": -12.445647972127023}, "policy_reward_mean": {"policy_0": -512.4312507726037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857, -744.482048176515, -208.99220054294588, -1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384, -1228.051529521375, -1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 69, 73, 150, 150, 68, 92, 150, 150, 92, 56, 150, 41, 150, 94, 150, 77, 150, 60, 91, 150, 150, 150, 150, 75, 150, 150, 150, 59, 116, 150, 150, 150, 150, 56, 107, 150, 119, 150, 150, 111, 47, 150, 75, 150, 150, 82, 76, 76, 150, 150, 145, 150, 78, 150, 46, 150, 63, 83, 150, 150, 147, 127, 150, 150, 109, 64, 70, 150, 51, 139, 150, 93, 67, 74, 150, 78, 68, 150, 96, 150, 150, 131, 56, 150, 47, 68, 150, 150, 150, 150], "policy_policy_0_reward": [-692.8799917395694, -1224.469121335174, -466.5744679014333, -853.1822657401516, -990.1654905696313, -538.0147981045017, -569.0133734310615, -692.5005285070627, -67.08021822527529, -130.05788340702767, -112.67825658031246, -116.8495614834779, -649.672342855077, -1330.3790847277792, -82.96594393938571, -210.0262829517087, -910.8063974009406, -775.272097480856, -197.95434047773946, -42.45513817029846, -744.8465806183184, -12.445647972127023, -494.33486833924644, -426.15494429616825, -358.52922988593264, -92.89840442740086, -825.9773304987871, -63.89839390682565, -392.9808572286683, -1058.0729674014833, -852.7304079901883, -1028.9835561573857, -744.482048176515, -208.99220054294588, -1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384, -1228.051529521375, -1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549457970488231, "mean_inference_ms": 1.6752938025954607, "mean_action_processing_ms": 0.2768328382496662, "mean_env_wait_ms": 3.440997064076082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011658430099487305, "StateBufferConnector_ms": 0.008039236068725586, "ViewRequirementAgentConnector_ms": 0.19331812858581543}, "num_episodes": 32, "episode_return_max": -12.445647972127023, "episode_return_min": -1330.3790847277792, "episode_return_mean": -512.4312507726037, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2818483238976, "num_env_steps_trained_throughput_per_sec": 310.2818483238976, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12934.982, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12934.91, "sample_time_ms": 1126.601, "learn_time_ms": 11741.626, "learn_throughput": 340.668, "synch_weights_time_ms": 65.903}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00004", "date": "2024-08-04_08-11-26", "timestamp": 1722739286, "time_this_iter_s": 12.904099702835083, "time_total_s": 360.2402081489563, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354135480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.2402081489563, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.610526315789475, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.21644505163033, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9838436241572102, "policy_loss": -0.009184692380464791, "vf_loss": 0.9901941748025517, "vf_explained_var": 0.9972022612889607, "kl": 0.014778068086161526, "entropy": 1.2147729416688284, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -14.728163608677384, "episode_reward_min": -1269.1434948697586, "episode_reward_mean": -519.0017594482517, "episode_len_mean": 118.09, "episode_media": {}, "episodes_timesteps_total": 11809, "policy_reward_min": {"policy_0": -1269.1434948697586}, "policy_reward_max": {"policy_0": -14.728163608677384}, "policy_reward_mean": {"policy_0": -519.0017594482517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384, -1228.051529521375, -1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145, -57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801], "episode_lengths": [150, 150, 150, 59, 116, 150, 150, 150, 150, 56, 107, 150, 119, 150, 150, 111, 47, 150, 75, 150, 150, 82, 76, 76, 150, 150, 145, 150, 78, 150, 46, 150, 63, 83, 150, 150, 147, 127, 150, 150, 109, 64, 70, 150, 51, 139, 150, 93, 67, 74, 150, 78, 68, 150, 96, 150, 150, 131, 56, 150, 47, 68, 150, 150, 150, 150, 58, 129, 150, 150, 150, 150, 54, 77, 150, 58, 150, 150, 150, 81, 150, 150, 150, 150, 150, 132, 46, 150, 150, 150, 43, 150, 40, 150, 150, 79, 150, 41, 150, 47], "policy_policy_0_reward": [-1161.556088994448, -602.9658483672904, -643.4953171026467, -57.58638527893925, -448.78642171691615, -812.2835504504947, -970.3587305098685, -522.6379068153922, -1149.6122703905542, -57.72397418793325, -292.7402042644145, -996.0750765969914, -397.7693572328954, -420.86830103067314, -847.4355611731265, -502.6303898269448, -84.24423450700299, -593.3721582333635, -93.58914368310418, -1123.8558726121007, -827.2460513433007, -128.09152095914976, -164.42436398109368, -207.99668304269562, -653.78024332737, -419.23475505614954, -385.1002012622351, -702.0012933333616, -218.96763365973638, -714.8801799516627, -63.216030940007144, -713.494594014677, -168.29611240254295, -334.05329941539384, -1228.051529521375, -1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145, -57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548720139745374, "mean_inference_ms": 1.6742270229075051, "mean_action_processing_ms": 0.2767256221965498, "mean_env_wait_ms": 3.437119080870928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011634349822998047, "StateBufferConnector_ms": 0.00840449333190918, "ViewRequirementAgentConnector_ms": 0.1921396255493164}, "num_episodes": 34, "episode_return_max": -14.728163608677384, "episode_return_min": -1269.1434948697586, "episode_return_mean": -519.0017594482517, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6610587240458, "num_env_steps_trained_throughput_per_sec": 300.6610587240458, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12960.787, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12960.716, "sample_time_ms": 1140.515, "learn_time_ms": 11753.877, "learn_throughput": 340.313, "synch_weights_time_ms": 65.505}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00004", "date": "2024-08-04_08-11-40", "timestamp": 1722739300, "time_this_iter_s": 13.315192222595215, "time_total_s": 373.5554003715515, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.5554003715515, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.138888888888893, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.94716957012812, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9485581402666867, "policy_loss": -0.009300310384909001, "vf_loss": 0.9552800620285173, "vf_explained_var": 0.998011281217138, "kl": 0.013494062904404339, "entropy": 1.2042443747321765, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -14.728163608677384, "episode_reward_min": -1320.2949200180135, "episode_reward_mean": -514.4460367991652, "episode_len_mean": 118.01, "episode_media": {}, "episodes_timesteps_total": 11801, "policy_reward_min": {"policy_0": -1320.2949200180135}, "policy_reward_max": {"policy_0": -14.728163608677384}, "policy_reward_mean": {"policy_0": -514.4460367991652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145, -57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801, -961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053], "episode_lengths": [150, 147, 127, 150, 150, 109, 64, 70, 150, 51, 139, 150, 93, 67, 74, 150, 78, 68, 150, 96, 150, 150, 131, 56, 150, 47, 68, 150, 150, 150, 150, 58, 129, 150, 150, 150, 150, 54, 77, 150, 58, 150, 150, 150, 81, 150, 150, 150, 150, 150, 132, 46, 150, 150, 150, 43, 150, 40, 150, 150, 79, 150, 41, 150, 47, 150, 150, 150, 88, 60, 57, 103, 72, 117, 85, 150, 150, 150, 150, 114, 67, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 69, 51, 121, 44, 150, 137], "policy_policy_0_reward": [-1138.6161106945347, -379.42327108512046, -368.54522325018655, -550.5455591267852, -593.1731041400097, -546.3441591860609, -73.68341629010754, -105.7317919464516, -654.5604899062159, -46.771200460587956, -330.78447563173603, -613.099285193684, -146.30696659364278, -77.89602824831466, -264.7285511225528, -991.3082946498166, -144.75533526034388, -135.46764161991464, -823.3427379169611, -205.12964340201273, -386.0236069521269, -992.468623289942, -577.9850437139991, -171.06838194572367, -1168.0495321900378, -26.14186582330416, -155.76784349202853, -385.08430071020024, -1175.773094088343, -675.9062581929046, -671.8969334804145, -57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801, -961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545230891257917, "mean_inference_ms": 1.6755074219627233, "mean_action_processing_ms": 0.27683708116367645, "mean_env_wait_ms": 3.439204922028363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011581182479858398, "StateBufferConnector_ms": 0.00836801528930664, "ViewRequirementAgentConnector_ms": 0.1926279067993164}, "num_episodes": 35, "episode_return_max": -14.728163608677384, "episode_return_min": -1320.2949200180135, "episode_return_mean": -514.4460367991652, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.52323874202204, "num_env_steps_trained_throughput_per_sec": 449.52323874202204, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12520.199, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12520.128, "sample_time_ms": 1140.722, "learn_time_ms": 11314.994, "learn_throughput": 353.513, "synch_weights_time_ms": 63.599}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00004", "date": "2024-08-04_08-11-49", "timestamp": 1722739309, "time_this_iter_s": 8.909064531326294, "time_total_s": 382.4644649028778, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.4644649028778, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.946153846153848, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.28777902126313, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.039568890972684, "policy_loss": -0.00486191530508222, "vf_loss": 1.0419030712296566, "vf_explained_var": 0.9907485300675034, "kl": 0.013276469092185546, "entropy": 1.2756195141623417, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -14.728163608677384, "episode_reward_min": -1393.3432242372758, "episode_reward_mean": -550.7516512721976, "episode_len_mean": 121.08, "episode_media": {}, "episodes_timesteps_total": 12108, "policy_reward_min": {"policy_0": -1393.3432242372758}, "policy_reward_max": {"policy_0": -14.728163608677384}, "policy_reward_mean": {"policy_0": -550.7516512721976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801, -961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002], "episode_lengths": [58, 129, 150, 150, 150, 150, 54, 77, 150, 58, 150, 150, 150, 81, 150, 150, 150, 150, 150, 132, 46, 150, 150, 150, 43, 150, 40, 150, 150, 79, 150, 41, 150, 47, 150, 150, 150, 88, 60, 57, 103, 72, 117, 85, 150, 150, 150, 150, 114, 67, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 69, 51, 121, 44, 150, 137, 150, 150, 150, 150, 150, 76, 52, 139, 150, 150, 95, 150, 150, 48, 142, 150, 60, 150, 150, 139, 150, 51, 133, 150, 124, 150, 143, 71, 69, 150, 150], "policy_policy_0_reward": [-57.46612096305869, -638.2105115364835, -736.3406843965843, -717.2173228941847, -393.3935862599314, -790.7384979406413, -136.50803090037817, -148.46655772016007, -397.671946301157, -59.74282556534675, -618.2769841419091, -518.8970909382542, -1198.0580902314186, -333.48293456431855, -722.7790050361896, -779.9895378871573, -747.6308100206613, -992.7138391200341, -859.290827641145, -308.2567274568071, -14.728163608677384, -777.6778874477724, -607.08916306393, -1063.2831214599305, -87.56567842088258, -1114.1158376727242, -22.221874529710018, -784.2484494108237, -870.2688945563402, -161.18348178627522, -1269.1434948697586, -15.451588477765586, -639.9280839080402, -33.33823930680801, -961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545044103205135, "mean_inference_ms": 1.7001053462478786, "mean_action_processing_ms": 0.27658843117943305, "mean_env_wait_ms": 3.438110688945396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011977910995483398, "StateBufferConnector_ms": 0.008326292037963867, "ViewRequirementAgentConnector_ms": 0.19708538055419922}, "num_episodes": 31, "episode_return_max": -14.728163608677384, "episode_return_min": -1393.3432242372758, "episode_return_mean": -550.7516512721976, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.87932228462176, "num_env_steps_trained_throughput_per_sec": 315.87932228462176, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12517.972, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12517.902, "sample_time_ms": 1190.852, "learn_time_ms": 11264.367, "learn_throughput": 355.102, "synch_weights_time_ms": 61.866}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00004", "date": "2024-08-04_08-12-01", "timestamp": 1722739321, "time_this_iter_s": 12.6761953830719, "time_total_s": 395.1406602859497, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.1406602859497, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.883333333333333, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.70285869638124, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.162796232290566, "policy_loss": -0.008884473494254053, "vf_loss": 1.1691636965920529, "vf_explained_var": 0.9972893521810572, "kl": 0.01331248671109887, "entropy": 1.4548558864742518, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -15.283681902252427, "episode_reward_min": -1393.3432242372758, "episode_reward_mean": -561.0006758653091, "episode_len_mean": 122.68, "episode_media": {}, "episodes_timesteps_total": 12268, "policy_reward_min": {"policy_0": -1393.3432242372758}, "policy_reward_max": {"policy_0": -15.283681902252427}, "policy_reward_mean": {"policy_0": -561.0006758653091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002, -889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212], "episode_lengths": [150, 150, 150, 88, 60, 57, 103, 72, 117, 85, 150, 150, 150, 150, 114, 67, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 69, 51, 121, 44, 150, 137, 150, 150, 150, 150, 150, 76, 52, 139, 150, 150, 95, 150, 150, 48, 142, 150, 60, 150, 150, 139, 150, 51, 133, 150, 124, 150, 143, 71, 69, 150, 150, 150, 139, 150, 59, 69, 42, 139, 110, 150, 150, 56, 150, 54, 150, 111, 150, 56, 140, 150, 150, 144, 60, 150, 150, 150, 150, 122, 113, 150, 150, 150, 150, 150, 81], "policy_policy_0_reward": [-961.0608655667594, -459.4684107643184, -877.1109109523532, -228.81689409950863, -58.27183406976402, -21.04175511805348, -170.009309273038, -86.93697223130175, -185.36699826184724, -177.3433614385823, -699.7801224964126, -772.8404903682685, -735.5747175423386, -784.7554678141023, -278.225540801416, -57.307299197810956, -615.3848616688576, -307.85921453668203, -347.3294951158713, -926.919488158937, -515.0473624536627, -535.5960722226256, -956.4893009552311, -1031.954897389894, -894.7548051072721, -925.54773121851, -122.53695628581575, -1320.2949200180135, -1203.7160702499598, -87.76572779042172, -109.91711280394438, -251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002, -889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543493027371841, "mean_inference_ms": 1.7259986068494857, "mean_action_processing_ms": 0.2767337247915108, "mean_env_wait_ms": 3.440038398531556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012025833129882812, "StateBufferConnector_ms": 0.007891654968261719, "ViewRequirementAgentConnector_ms": 0.19704198837280273}, "num_episodes": 34, "episode_return_max": -15.283681902252427, "episode_return_min": -1393.3432242372758, "episode_return_mean": -561.0006758653091, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.5625827581235, "num_env_steps_trained_throughput_per_sec": 359.5625827581235, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12359.202, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12359.131, "sample_time_ms": 1190.613, "learn_time_ms": 11106.82, "learn_throughput": 360.139, "synch_weights_time_ms": 60.888}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00004", "date": "2024-08-04_08-12-13", "timestamp": 1722739333, "time_this_iter_s": 11.136553764343262, "time_total_s": 406.27721405029297, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.27721405029297, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.0625, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.55067443648974, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0675331657131513, "policy_loss": -0.0037441379972733557, "vf_loss": 1.0695556125603616, "vf_explained_var": 0.9887157451982299, "kl": 0.009193587322207975, "entropy": 1.1702682013312975, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -11.19216894075647, "episode_reward_min": -1472.679661003686, "episode_reward_mean": -584.6070285190931, "episode_len_mean": 123.61, "episode_media": {}, "episodes_timesteps_total": 12361, "policy_reward_min": {"policy_0": -1472.679661003686}, "policy_reward_max": {"policy_0": -11.19216894075647}, "policy_reward_mean": {"policy_0": -584.6070285190931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002, -889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137], "episode_lengths": [121, 44, 150, 137, 150, 150, 150, 150, 150, 76, 52, 139, 150, 150, 95, 150, 150, 48, 142, 150, 60, 150, 150, 139, 150, 51, 133, 150, 124, 150, 143, 71, 69, 150, 150, 150, 139, 150, 59, 69, 42, 139, 110, 150, 150, 56, 150, 54, 150, 111, 150, 56, 140, 150, 150, 144, 60, 150, 150, 150, 150, 122, 113, 150, 150, 150, 150, 150, 81, 150, 150, 134, 150, 150, 150, 119, 64, 110, 110, 150, 67, 143, 150, 70, 43, 150, 123, 150, 150, 150, 150, 67, 150, 150, 150, 95, 135, 150, 100, 42], "policy_policy_0_reward": [-251.1520772422565, -53.78672584310787, -904.2775608741989, -588.607690346053, -927.6790797303738, -1181.0124004265138, -1337.9626648566073, -1177.5778951093353, -1258.2292357704794, -118.72995539804407, -33.44495454663761, -274.6724561503405, -515.1918085518435, -815.4353184943203, -352.3638593156844, -646.3148967701968, -638.6142962131114, -16.92047641770691, -360.27882728463715, -656.1510404287443, -76.24391438068008, -641.2088506050636, -988.7349065164339, -497.85346190739205, -593.6471377019013, -82.77972243800318, -492.157060520872, -1393.3432242372758, -262.0523278068154, -265.72378964982596, -818.1317136993978, -59.60466930081622, -69.39929844008842, -1066.395709878171, -589.085264360002, -889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539146991293766, "mean_inference_ms": 1.7469211747591324, "mean_action_processing_ms": 0.2763723169267388, "mean_env_wait_ms": 3.436154456856672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183629035949707, "StateBufferConnector_ms": 0.00790858268737793, "ViewRequirementAgentConnector_ms": 0.1952054500579834}, "num_episodes": 31, "episode_return_max": -11.19216894075647, "episode_return_min": -1472.679661003686, "episode_return_mean": -584.6070285190931, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.8681199638558, "num_env_steps_trained_throughput_per_sec": 396.8681199638558, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12074.568, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12074.497, "sample_time_ms": 1188.134, "learn_time_ms": 10824.019, "learn_throughput": 369.548, "synch_weights_time_ms": 61.528}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00004", "date": "2024-08-04_08-12-23", "timestamp": 1722739343, "time_this_iter_s": 10.09185791015625, "time_total_s": 416.3690719604492, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354135b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.3690719604492, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.666666666666668, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.8173119366169, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0591979071187476, "policy_loss": -0.012528159959765616, "vf_loss": 1.0690377940113345, "vf_explained_var": 0.9939578581601382, "kl": 0.01401694862221728, "entropy": 1.1511704176664352, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -11.19216894075647, "episode_reward_min": -1472.679661003686, "episode_reward_mean": -573.2890528880573, "episode_len_mean": 123.02, "episode_media": {}, "episodes_timesteps_total": 12302, "policy_reward_min": {"policy_0": -1472.679661003686}, "policy_reward_max": {"policy_0": -11.19216894075647}, "policy_reward_mean": {"policy_0": -573.2890528880573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805], "episode_lengths": [150, 139, 150, 59, 69, 42, 139, 110, 150, 150, 56, 150, 54, 150, 111, 150, 56, 140, 150, 150, 144, 60, 150, 150, 150, 150, 122, 113, 150, 150, 150, 150, 150, 81, 150, 150, 134, 150, 150, 150, 119, 64, 110, 110, 150, 67, 143, 150, 70, 43, 150, 123, 150, 150, 150, 150, 67, 150, 150, 150, 95, 135, 150, 100, 42, 122, 150, 138, 55, 150, 150, 139, 61, 56, 86, 150, 150, 150, 40, 143, 150, 150, 41, 150, 150, 98, 37, 150, 145, 150, 150, 65, 113, 150, 150, 150, 145, 101, 150, 150], "policy_policy_0_reward": [-889.124044606985, -375.07951004978753, -669.8331550982466, -51.401643163731094, -88.51541462548383, -15.283681902252427, -396.00735245113975, -460.7233390890939, -909.4041581773673, -1045.4440956382473, -34.99073320290723, -1070.2850852583565, -40.37583431292334, -753.4495330529624, -380.463170584783, -1281.2370911530702, -146.17274675099068, -603.1595936398148, -1259.406159642643, -576.5230529146852, -425.2960819264495, -114.89881011491991, -748.7049968422855, -352.67606093791017, -1352.5788254550685, -929.6704119247211, -348.10902271923874, -255.09891683584158, -836.5822159376487, -942.0518173140547, -735.2210388201157, -598.9736055259298, -833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541258476701608, "mean_inference_ms": 1.7477947344476346, "mean_action_processing_ms": 0.27631123082231257, "mean_env_wait_ms": 3.4389221511569605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012139558792114258, "StateBufferConnector_ms": 0.008049726486206055, "ViewRequirementAgentConnector_ms": 0.19274401664733887}, "num_episodes": 35, "episode_return_max": -11.19216894075647, "episode_return_min": -1472.679661003686, "episode_return_mean": -573.2890528880573, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.7752863240494, "num_env_steps_trained_throughput_per_sec": 318.7752863240494, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12025.756, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12025.686, "sample_time_ms": 1187.453, "learn_time_ms": 10776.301, "learn_throughput": 371.185, "synch_weights_time_ms": 61.129}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00004", "date": "2024-08-04_08-12-35", "timestamp": 1722739355, "time_this_iter_s": 12.561166763305664, "time_total_s": 428.9302387237549, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 428.9302387237549, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.488235294117647, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.91449964841206, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9534512422823658, "policy_loss": -0.009342747076880186, "vf_loss": 0.9598362983514865, "vf_explained_var": 0.9953423739100496, "kl": 0.015459916580099767, "entropy": 1.3429196075846752, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -10.995363559888286, "episode_reward_min": -1472.679661003686, "episode_reward_mean": -554.2422604431873, "episode_len_mean": 123.03, "episode_media": {}, "episodes_timesteps_total": 12303, "policy_reward_min": {"policy_0": -1472.679661003686}, "policy_reward_max": {"policy_0": -10.995363559888286}, "policy_reward_mean": {"policy_0": -554.2422604431873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286], "episode_lengths": [150, 81, 150, 150, 134, 150, 150, 150, 119, 64, 110, 110, 150, 67, 143, 150, 70, 43, 150, 123, 150, 150, 150, 150, 67, 150, 150, 150, 95, 135, 150, 100, 42, 122, 150, 138, 55, 150, 150, 139, 61, 56, 86, 150, 150, 150, 40, 143, 150, 150, 41, 150, 150, 98, 37, 150, 145, 150, 150, 65, 113, 150, 150, 150, 145, 101, 150, 150, 142, 138, 150, 150, 150, 150, 74, 150, 78, 150, 88, 150, 150, 61, 96, 150, 121, 150, 149, 150, 150, 150, 150, 137, 105, 61, 85, 138, 150, 118, 87, 37], "policy_policy_0_reward": [-833.2386699416265, -120.29847973513212, -783.078990130421, -989.3989525197366, -332.4047843694367, -1223.2738594752268, -1029.883651377838, -614.7935512022935, -373.8960158841493, -208.86104119103754, -349.62766028492643, -532.7753916015621, -718.5360053311201, -114.35774271627434, -872.7319607600539, -1031.9393146985005, -209.15377134933766, -11.19216894075647, -1359.811330932834, -279.9087576513978, -468.1248300676247, -425.73662634933896, -1472.679661003686, -638.6947542858895, -79.77528021979442, -1072.3960720989144, -637.2372220043217, -485.90504001842396, -239.10078417764592, -800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542809704426904, "mean_inference_ms": 1.7450279012990269, "mean_action_processing_ms": 0.27640138932603936, "mean_env_wait_ms": 3.437254403337882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012218952178955078, "StateBufferConnector_ms": 0.008058547973632812, "ViewRequirementAgentConnector_ms": 0.1926586627960205}, "num_episodes": 32, "episode_return_max": -10.995363559888286, "episode_return_min": -1472.679661003686, "episode_return_mean": -554.2422604431873, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.94483251873453, "num_env_steps_trained_throughput_per_sec": 302.94483251873453, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12067.359, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12067.291, "sample_time_ms": 1187.984, "learn_time_ms": 10818.335, "learn_throughput": 369.743, "synch_weights_time_ms": 60.172}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00004", "date": "2024-08-04_08-12-49", "timestamp": 1722739369, "time_this_iter_s": 13.21631669998169, "time_total_s": 442.1465554237366, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541370a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 442.1465554237366, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.710526315789476, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.90202958782513, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.110168978990987, "policy_loss": -0.005471653386484832, "vf_loss": 1.113042266666889, "vf_explained_var": 0.991241266640524, "kl": 0.013659584190342402, "entropy": 1.3355367961029212, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -10.995363559888286, "episode_reward_min": -1258.2460315981316, "episode_reward_mean": -550.0243870176542, "episode_len_mean": 122.79, "episode_media": {}, "episodes_timesteps_total": 12279, "policy_reward_min": {"policy_0": -1258.2460315981316}, "policy_reward_max": {"policy_0": -10.995363559888286}, "policy_reward_mean": {"policy_0": -550.0243870176542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301], "episode_lengths": [135, 150, 100, 42, 122, 150, 138, 55, 150, 150, 139, 61, 56, 86, 150, 150, 150, 40, 143, 150, 150, 41, 150, 150, 98, 37, 150, 145, 150, 150, 65, 113, 150, 150, 150, 145, 101, 150, 150, 142, 138, 150, 150, 150, 150, 74, 150, 78, 150, 88, 150, 150, 61, 96, 150, 121, 150, 149, 150, 150, 150, 150, 137, 105, 61, 85, 138, 150, 118, 87, 37, 140, 150, 150, 67, 71, 51, 150, 55, 96, 103, 150, 68, 55, 128, 150, 129, 150, 122, 150, 125, 150, 150, 150, 150, 150, 150, 150, 142, 150], "policy_policy_0_reward": [-800.2768229582953, -1066.7190787956395, -355.93872583154916, -37.45038312194137, -294.1503804320188, -1258.2460315981316, -377.01031652002615, -36.75898319976571, -781.8905794832618, -988.2614811704213, -470.7512259276429, -61.41168022333881, -33.86993007214803, -104.67871923405501, -915.0860962783499, -586.90312159394, -1135.1042795517824, -20.561487977547667, -726.5119707782843, -389.3665151841253, -1152.6428109227327, -17.67489382470028, -497.0035478382165, -769.5546258061472, -168.50754793493726, -20.4516216843269, -406.5913606313105, -584.4144963065594, -804.0558452532472, -1008.7468585121388, -84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541490491610699, "mean_inference_ms": 1.7421024040624036, "mean_action_processing_ms": 0.27599823029492104, "mean_env_wait_ms": 3.4360793026538503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012309789657592773, "StateBufferConnector_ms": 0.008037328720092773, "ViewRequirementAgentConnector_ms": 0.19375109672546387}, "num_episodes": 29, "episode_return_max": -10.995363559888286, "episode_return_min": -1258.2460315981316, "episode_return_mean": -550.0243870176542, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.0283558665126, "num_env_steps_trained_throughput_per_sec": 347.0283558665126, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11919.876, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11919.808, "sample_time_ms": 1185.5, "learn_time_ms": 10674.682, "learn_throughput": 374.718, "synch_weights_time_ms": 58.819}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00004", "date": "2024-08-04_08-13-00", "timestamp": 1722739380, "time_this_iter_s": 11.538141965866089, "time_total_s": 453.68469738960266, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354137880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.68469738960266, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.56470588235294, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.74637831151486, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0574300003858903, "policy_loss": -0.008051034763047938, "vf_loss": 1.0630361921774845, "vf_explained_var": 0.990626926223437, "kl": 0.01289977034621188, "entropy": 1.351094014197588, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -10.995363559888286, "episode_reward_min": -1246.7885177240394, "episode_reward_mean": -545.0147171396528, "episode_len_mean": 124.22, "episode_media": {}, "episodes_timesteps_total": 12422, "policy_reward_min": {"policy_0": -1246.7885177240394}, "policy_reward_max": {"policy_0": -10.995363559888286}, "policy_reward_mean": {"policy_0": -545.0147171396528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301, -201.2914635866644, -106.85574666185549, -466.834724384123, -29.88246189061999, -66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954], "episode_lengths": [65, 113, 150, 150, 150, 145, 101, 150, 150, 142, 138, 150, 150, 150, 150, 74, 150, 78, 150, 88, 150, 150, 61, 96, 150, 121, 150, 149, 150, 150, 150, 150, 137, 105, 61, 85, 138, 150, 118, 87, 37, 140, 150, 150, 67, 71, 51, 150, 55, 96, 103, 150, 68, 55, 128, 150, 129, 150, 122, 150, 125, 150, 150, 150, 150, 150, 150, 150, 142, 150, 83, 72, 147, 41, 61, 150, 123, 150, 150, 71, 130, 90, 61, 150, 150, 132, 135, 150, 150, 150, 150, 92, 150, 145, 150, 150, 150, 150, 48, 150], "policy_policy_0_reward": [-84.21981032867357, -90.09292832115136, -1005.0767168368966, -617.4893042085445, -1171.025519728246, -269.5091984940222, -178.25425064124207, -1191.2109801776205, -655.881591433805, -272.78116656505944, -532.7926851511272, -674.6886759377381, -751.0820017416572, -628.4621328610174, -1034.7073025309587, -167.5701465317805, -761.0069791950301, -98.85749097106692, -654.136728051462, -311.2480687173609, -950.0820515037572, -1074.780230411634, -63.03669893487445, -248.84416110894946, -623.6991767995164, -423.5736845920913, -856.6251575707751, -415.3933793005588, -1187.573113874223, -1024.8067813403622, -589.5805680967949, -637.0586922212227, -361.6189220779942, -239.17281066015988, -134.68414996910937, -189.19307155683236, -395.9816424096295, -693.1511642435859, -609.214277579396, -165.66347911703454, -10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301, -201.2914635866644, -106.85574666185549, -466.834724384123, -29.88246189061999, -66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540751424858277, "mean_inference_ms": 1.74001006541928, "mean_action_processing_ms": 0.27605347365982685, "mean_env_wait_ms": 3.435685746159167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162446975708008, "StateBufferConnector_ms": 0.008083343505859375, "ViewRequirementAgentConnector_ms": 0.20211029052734375}, "num_episodes": 30, "episode_return_max": -10.995363559888286, "episode_return_min": -1246.7885177240394, "episode_return_mean": -545.0147171396528, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.55336749014185, "num_env_steps_trained_throughput_per_sec": 323.55336749014185, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11860.147, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11860.079, "sample_time_ms": 1196.408, "learn_time_ms": 10604.687, "learn_throughput": 377.192, "synch_weights_time_ms": 58.181}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00004", "date": "2024-08-04_08-13-13", "timestamp": 1722739393, "time_this_iter_s": 12.374912738800049, "time_total_s": 466.0596101284027, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 466.0596101284027, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.564705882352943, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.76684504449368, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.8447951602749526, "policy_loss": -0.009896461692308851, "vf_loss": 0.8519583360292018, "vf_explained_var": 0.9970983626320958, "kl": 0.014311451074475675, "entropy": 1.290012337639928, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -10.995363559888286, "episode_reward_min": -1303.9947876650108, "episode_reward_mean": -508.4331782453477, "episode_len_mean": 120.38, "episode_media": {}, "episodes_timesteps_total": 12038, "policy_reward_min": {"policy_0": -1303.9947876650108}, "policy_reward_max": {"policy_0": -10.995363559888286}, "policy_reward_mean": {"policy_0": -508.4331782453477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301, -201.2914635866644, -106.85574666185549, -466.834724384123, -29.88246189061999, -66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954, -880.2320798930174, -529.7571955895486, -90.8724249392929, -882.3639984314502, -220.62276953471996, -997.5072529622719, -661.1891964206958, -25.194530500342584, -147.08941033612496, -20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488], "episode_lengths": [37, 140, 150, 150, 67, 71, 51, 150, 55, 96, 103, 150, 68, 55, 128, 150, 129, 150, 122, 150, 125, 150, 150, 150, 150, 150, 150, 150, 142, 150, 83, 72, 147, 41, 61, 150, 123, 150, 150, 71, 130, 90, 61, 150, 150, 132, 135, 150, 150, 150, 150, 92, 150, 145, 150, 150, 150, 150, 48, 150, 150, 150, 66, 150, 111, 150, 150, 50, 82, 39, 106, 130, 150, 150, 142, 56, 150, 150, 107, 52, 150, 112, 111, 109, 150, 72, 150, 77, 150, 79, 150, 102, 150, 150, 150, 118, 79, 68, 150, 150], "policy_policy_0_reward": [-10.995363559888286, -628.0300216272634, -404.9217211253363, -522.5967672959986, -67.87150438896587, -88.74860588437414, -58.249524414809784, -1082.7355753633458, -50.33860893152468, -431.67809730239554, -305.6707363302556, -1246.7885177240394, -131.11524887393435, -49.532185826821184, -299.73364737634176, -1126.4388409901144, -207.42077588145983, -1053.8679811640886, -660.9032830481987, -1061.6750141627429, -269.7747842687309, -918.9610480428067, -512.1154253903118, -956.6245498973669, -1016.6553316978244, -1156.8743144400278, -994.1294463542347, -799.9614828601456, -414.62542222324174, -568.986564879301, -201.2914635866644, -106.85574666185549, -466.834724384123, -29.88246189061999, -66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954, -880.2320798930174, -529.7571955895486, -90.8724249392929, -882.3639984314502, -220.62276953471996, -997.5072529622719, -661.1891964206958, -25.194530500342584, -147.08941033612496, -20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546059525787189, "mean_inference_ms": 1.7390464740878386, "mean_action_processing_ms": 0.27600468594038186, "mean_env_wait_ms": 3.439115923752931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012120246887207031, "StateBufferConnector_ms": 0.00809025764465332, "ViewRequirementAgentConnector_ms": 0.20211291313171387}, "num_episodes": 40, "episode_return_max": -10.995363559888286, "episode_return_min": -1303.9947876650108, "episode_return_mean": -508.4331782453477, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.05648189894504, "num_env_steps_trained_throughput_per_sec": 306.05648189894504, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11877.945, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11877.877, "sample_time_ms": 1184.798, "learn_time_ms": 10634.249, "learn_throughput": 376.143, "synch_weights_time_ms": 58.026}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00004", "date": "2024-08-04_08-13-26", "timestamp": 1722739406, "time_this_iter_s": 13.081210136413574, "time_total_s": 479.1408202648163, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541370a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.1408202648163, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.873684210526317, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.41541937788327, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0047455243455867, "policy_loss": -0.011117954603590382, "vf_loss": 1.0129216268037757, "vf_explained_var": 0.9976991909866532, "kl": 0.015391745249962696, "entropy": 1.3649616956710815, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -2.526903311099873, "episode_reward_min": -1398.05086626642, "episode_reward_mean": -507.5021934350794, "episode_len_mean": 119.29, "episode_media": {}, "episodes_timesteps_total": 11929, "policy_reward_min": {"policy_0": -1398.05086626642}, "policy_reward_max": {"policy_0": -2.526903311099873}, "policy_reward_mean": {"policy_0": -507.5021934350794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954, -880.2320798930174, -529.7571955895486, -90.8724249392929, -882.3639984314502, -220.62276953471996, -997.5072529622719, -661.1891964206958, -25.194530500342584, -147.08941033612496, -20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488, -1257.5385803659406, -298.4743174651574, -368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097], "episode_lengths": [61, 150, 123, 150, 150, 71, 130, 90, 61, 150, 150, 132, 135, 150, 150, 150, 150, 92, 150, 145, 150, 150, 150, 150, 48, 150, 150, 150, 66, 150, 111, 150, 150, 50, 82, 39, 106, 130, 150, 150, 142, 56, 150, 150, 107, 52, 150, 112, 111, 109, 150, 72, 150, 77, 150, 79, 150, 102, 150, 150, 150, 118, 79, 68, 150, 150, 150, 122, 94, 99, 60, 150, 121, 150, 63, 150, 71, 150, 150, 150, 150, 150, 150, 60, 53, 150, 116, 150, 150, 79, 116, 55, 124, 56, 118, 73, 150, 33, 150, 110], "policy_policy_0_reward": [-66.5665920157693, -751.9205227009314, -591.0361932249654, -1043.1515230581272, -351.12261831590007, -119.17574587611914, -331.1159175196682, -358.95221969362694, -159.1738740258699, -513.0490316375731, -1116.7440148941357, -687.234617024218, -310.0066846535428, -416.27310983883604, -935.1640265998269, -607.5040908177629, -603.5397390950054, -165.22663046953707, -915.520960240758, -506.5694963496928, -1190.5116127419878, -709.7767755076795, -521.1984985627219, -1111.7802936213177, -26.20445537049199, -456.24079046709954, -880.2320798930174, -529.7571955895486, -90.8724249392929, -882.3639984314502, -220.62276953471996, -997.5072529622719, -661.1891964206958, -25.194530500342584, -147.08941033612496, -20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488, -1257.5385803659406, -298.4743174651574, -368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543696815947761, "mean_inference_ms": 1.7377439310138476, "mean_action_processing_ms": 0.2760818590438895, "mean_env_wait_ms": 3.4409814412158686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012207984924316406, "StateBufferConnector_ms": 0.008176088333129883, "ViewRequirementAgentConnector_ms": 0.20215606689453125}, "num_episodes": 34, "episode_return_max": -2.526903311099873, "episode_return_min": -1398.05086626642, "episode_return_mean": -507.5021934350794, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5228282198989, "num_env_steps_trained_throughput_per_sec": 314.5228282198989, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11819.311, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11819.243, "sample_time_ms": 1169.434, "learn_time_ms": 10590.759, "learn_throughput": 377.688, "synch_weights_time_ms": 58.286}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00004", "date": "2024-08-04_08-13-39", "timestamp": 1722739419, "time_this_iter_s": 12.731478452682495, "time_total_s": 491.8722987174988, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354136d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 491.8722987174988, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.22222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.73711415131888, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.8707002009420345, "policy_loss": -0.014165030508108127, "vf_loss": 0.8816770372912288, "vf_explained_var": 0.9977815691381693, "kl": 0.01660973223791494, "entropy": 1.3375351523359618, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -2.526903311099873, "episode_reward_min": -1410.539002928496, "episode_reward_mean": -504.8337372919819, "episode_len_mean": 115.9, "episode_media": {}, "episodes_timesteps_total": 11590, "policy_reward_min": {"policy_0": -1410.539002928496}, "policy_reward_max": {"policy_0": -2.526903311099873}, "policy_reward_mean": {"policy_0": -504.8337372919819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488, -1257.5385803659406, -298.4743174651574, -368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097, -760.4800296332514, -327.8050085485449, -1035.2880763219882, -179.31273079232744, -1043.5205758644329, -178.16075561945996, -968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496], "episode_lengths": [39, 106, 130, 150, 150, 142, 56, 150, 150, 107, 52, 150, 112, 111, 109, 150, 72, 150, 77, 150, 79, 150, 102, 150, 150, 150, 118, 79, 68, 150, 150, 150, 122, 94, 99, 60, 150, 121, 150, 63, 150, 71, 150, 150, 150, 150, 150, 150, 60, 53, 150, 116, 150, 150, 79, 116, 55, 124, 56, 118, 73, 150, 33, 150, 110, 150, 134, 150, 78, 150, 107, 150, 97, 42, 150, 150, 106, 150, 98, 41, 128, 101, 150, 122, 35, 150, 150, 122, 150, 70, 150, 134, 66, 150, 150, 42, 76, 59, 150, 150], "policy_policy_0_reward": [-20.54156557816561, -179.88758130534148, -261.6706572930425, -1303.9947876650108, -1033.7720358428737, -323.8577763254327, -66.73225880389408, -805.470640583941, -755.1980434321899, -533.8083725349592, -90.88460127683138, -541.1167602159644, -226.7287092371182, -340.0084025034025, -235.95652385706765, -301.2257756585568, -77.30481951858214, -739.3249060857627, -115.38857744321302, -455.2718446548593, -103.36473027328101, -862.2735154732118, -314.0799821916905, -957.2870805200303, -317.9658191580199, -949.6619797034215, -278.1750784163181, -270.02764187254144, -117.22815515981982, -804.7241489766996, -557.9113721937488, -1257.5385803659406, -298.4743174651574, -368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097, -760.4800296332514, -327.8050085485449, -1035.2880763219882, -179.31273079232744, -1043.5205758644329, -178.16075561945996, -968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546080975430138, "mean_inference_ms": 1.7359148857042936, "mean_action_processing_ms": 0.276056137099725, "mean_env_wait_ms": 3.441861494035918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012179851531982422, "StateBufferConnector_ms": 0.008129119873046875, "ViewRequirementAgentConnector_ms": 0.19426536560058594}, "num_episodes": 35, "episode_return_max": -2.526903311099873, "episode_return_min": -1410.539002928496, "episode_return_mean": -504.8337372919819, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9416951651776, "num_env_steps_trained_throughput_per_sec": 307.9416951651776, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12228.427, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12228.358, "sample_time_ms": 1173.947, "learn_time_ms": 10994.126, "learn_throughput": 363.831, "synch_weights_time_ms": 59.515}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00004", "date": "2024-08-04_08-13-52", "timestamp": 1722739432, "time_this_iter_s": 13.003936290740967, "time_total_s": 504.87623500823975, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541344c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 504.87623500823975, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.80526315789474, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.06749197045963, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9808157700734834, "policy_loss": -0.010242678268211118, "vf_loss": 0.9882179780242344, "vf_explained_var": 0.9887789246936639, "kl": 0.014857075232733543, "entropy": 1.3094352750728528, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -2.526903311099873, "episode_reward_min": -1410.539002928496, "episode_reward_mean": -503.94743901260625, "episode_len_mean": 113.9, "episode_media": {}, "episodes_timesteps_total": 11390, "policy_reward_min": {"policy_0": -1410.539002928496}, "policy_reward_max": {"policy_0": -2.526903311099873}, "policy_reward_mean": {"policy_0": -503.94743901260625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097, -760.4800296332514, -327.8050085485449, -1035.2880763219882, -179.31273079232744, -1043.5205758644329, -178.16075561945996, -968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496, -1065.2274472456131, -588.5054349382987, -641.0771424034405, -926.358078080419, -169.31336181200587, -513.5715543122436, -978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003], "episode_lengths": [94, 99, 60, 150, 121, 150, 63, 150, 71, 150, 150, 150, 150, 150, 150, 60, 53, 150, 116, 150, 150, 79, 116, 55, 124, 56, 118, 73, 150, 33, 150, 110, 150, 134, 150, 78, 150, 107, 150, 97, 42, 150, 150, 106, 150, 98, 41, 128, 101, 150, 122, 35, 150, 150, 122, 150, 70, 150, 134, 66, 150, 150, 42, 76, 59, 150, 150, 150, 150, 121, 150, 81, 150, 150, 150, 60, 90, 111, 150, 46, 150, 148, 141, 33, 150, 118, 47, 61, 127, 104, 89, 150, 72, 107, 150, 75, 94, 110, 123, 123], "policy_policy_0_reward": [-368.2953997364292, -347.30093594061367, -84.74658212200991, -1239.528036035249, -287.92466409578276, -919.1867116491762, -54.13877986919717, -524.1095748613121, -100.22179203387594, -1398.05086626642, -584.3629012155022, -1277.1151114072486, -1063.833397343014, -381.23516107617917, -896.9345970787303, -67.56746717091832, -36.754341205949125, -1068.3733441609024, -422.16021077082326, -567.4738509434425, -627.0342227157203, -148.67681041406377, -262.79626985773456, -145.16981173951342, -266.4423758690655, -80.90772616485178, -253.96375735729825, -89.31136745946449, -1256.6277542463536, -2.526903311099873, -1192.512418368009, -238.49026650527097, -760.4800296332514, -327.8050085485449, -1035.2880763219882, -179.31273079232744, -1043.5205758644329, -178.16075561945996, -968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496, -1065.2274472456131, -588.5054349382987, -641.0771424034405, -926.358078080419, -169.31336181200587, -513.5715543122436, -978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547238630895186, "mean_inference_ms": 1.7355582871104915, "mean_action_processing_ms": 0.27624491693294045, "mean_env_wait_ms": 3.4452698357004947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01222372055053711, "StateBufferConnector_ms": 0.008120059967041016, "ViewRequirementAgentConnector_ms": 0.19527769088745117}, "num_episodes": 33, "episode_return_max": -2.526903311099873, "episode_return_min": -1410.539002928496, "episode_return_mean": -503.94743901260625, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3713239110162, "num_env_steps_trained_throughput_per_sec": 306.3713239110162, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12267.726, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12267.657, "sample_time_ms": 1123.688, "learn_time_ms": 11081.262, "learn_throughput": 360.97, "synch_weights_time_ms": 61.925}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00004", "date": "2024-08-04_08-14-05", "timestamp": 1722739445, "time_this_iter_s": 13.069826364517212, "time_total_s": 517.946061372757, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354135f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.946061372757, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.188888888888883, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.4778283079465, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0265155591381092, "policy_loss": -0.0020524528464496445, "vf_loss": 1.0268664308047544, "vf_explained_var": 0.9825616306314866, "kl": 0.00919662561232144, "entropy": 1.3774834082772334, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -6.387878273421528, "episode_reward_min": -1410.539002928496, "episode_reward_mean": -470.15276649458536, "episode_len_mean": 111.45, "episode_media": {}, "episodes_timesteps_total": 11145, "policy_reward_min": {"policy_0": -1410.539002928496}, "policy_reward_max": {"policy_0": -6.387878273421528}, "policy_reward_mean": {"policy_0": -470.15276649458536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496, -1065.2274472456131, -588.5054349382987, -641.0771424034405, -926.358078080419, -169.31336181200587, -513.5715543122436, -978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003, -300.4967902473749, -503.61235048017306, -16.5187971914145, -215.26439205074686, -1069.035922445679, -1002.0931180170553, -362.7500450557762, -18.678997884994146, -371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939], "episode_lengths": [150, 97, 42, 150, 150, 106, 150, 98, 41, 128, 101, 150, 122, 35, 150, 150, 122, 150, 70, 150, 134, 66, 150, 150, 42, 76, 59, 150, 150, 150, 150, 121, 150, 81, 150, 150, 150, 60, 90, 111, 150, 46, 150, 148, 141, 33, 150, 118, 47, 61, 127, 104, 89, 150, 72, 107, 150, 75, 94, 110, 123, 123, 119, 150, 42, 64, 150, 150, 133, 44, 150, 150, 150, 140, 36, 70, 100, 66, 150, 150, 53, 56, 150, 66, 150, 150, 125, 150, 72, 150, 88, 106, 46, 128, 77, 150, 61, 84, 99, 150], "policy_policy_0_reward": [-968.1370490171679, -171.9448571061345, -6.929738610182479, -445.1053659117275, -1102.4048359616786, -192.97800172137752, -1061.2868906161598, -242.69777271350497, -31.666519128336645, -367.63969399656884, -367.8639918723913, -1204.0381898810806, -308.04335223742044, -11.628749574524662, -1057.4040503900735, -485.6524748004776, -272.4759718356191, -1134.176184283405, -85.6279158008242, -1227.2161294603052, -362.4082903554413, -67.3519802076393, -339.7945402868115, -1055.6164290951444, -17.86029180658434, -120.34152867100332, -143.80314613650435, -945.5431574342881, -1410.539002928496, -1065.2274472456131, -588.5054349382987, -641.0771424034405, -926.358078080419, -169.31336181200587, -513.5715543122436, -978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003, -300.4967902473749, -503.61235048017306, -16.5187971914145, -215.26439205074686, -1069.035922445679, -1002.0931180170553, -362.7500450557762, -18.678997884994146, -371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545377965469, "mean_inference_ms": 1.7323140497428127, "mean_action_processing_ms": 0.27611875720440354, "mean_env_wait_ms": 3.4441507561111404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012048006057739258, "StateBufferConnector_ms": 0.007990121841430664, "ViewRequirementAgentConnector_ms": 0.1962566375732422}, "num_episodes": 38, "episode_return_max": -6.387878273421528, "episode_return_min": -1410.539002928496, "episode_return_mean": -470.15276649458536, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.14086599572505, "num_env_steps_trained_throughput_per_sec": 354.14086599572505, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12284.757, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12284.687, "sample_time_ms": 1123.997, "learn_time_ms": 11097.482, "learn_throughput": 360.442, "synch_weights_time_ms": 62.428}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00004", "date": "2024-08-04_08-14-16", "timestamp": 1722739456, "time_this_iter_s": 11.306295156478882, "time_total_s": 529.2523565292358, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354137d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.2523565292358, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.51764705882353, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.42189912299315, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.9087142038779954, "policy_loss": -0.004567143772146664, "vf_loss": 0.9113491343955199, "vf_explained_var": 0.98842858299613, "kl": 0.010436169293704271, "entropy": 1.5502015847712756, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -4.597573481400759, "episode_reward_min": -1342.0488720514127, "episode_reward_mean": -476.0412678400535, "episode_len_mean": 113.12, "episode_media": {}, "episodes_timesteps_total": 11312, "policy_reward_min": {"policy_0": -1342.0488720514127}, "policy_reward_max": {"policy_0": -4.597573481400759}, "policy_reward_mean": {"policy_0": -476.0412678400535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003, -300.4967902473749, -503.61235048017306, -16.5187971914145, -215.26439205074686, -1069.035922445679, -1002.0931180170553, -362.7500450557762, -18.678997884994146, -371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939, -490.3246593741843, -292.28363641784, -214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642], "episode_lengths": [150, 150, 60, 90, 111, 150, 46, 150, 148, 141, 33, 150, 118, 47, 61, 127, 104, 89, 150, 72, 107, 150, 75, 94, 110, 123, 123, 119, 150, 42, 64, 150, 150, 133, 44, 150, 150, 150, 140, 36, 70, 100, 66, 150, 150, 53, 56, 150, 66, 150, 150, 125, 150, 72, 150, 88, 106, 46, 128, 77, 150, 61, 84, 99, 150, 150, 128, 103, 150, 59, 66, 64, 50, 150, 150, 71, 150, 150, 41, 150, 150, 34, 89, 150, 150, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 53], "policy_policy_0_reward": [-978.1889737289245, -1231.2831671841868, -59.379925282355735, -176.82670075394594, -485.6130548474044, -1342.0488720514127, -24.56743156356906, -464.930621942582, -792.8394349114319, -214.91322565592293, -6.387878273421528, -711.6784762664411, -178.80354695626704, -22.595353106528076, -64.09987981176656, -347.4433156451956, -241.11929003061093, -166.55371077854832, -1048.8652941261914, -78.5781685466216, -202.44199905525696, -1114.5475708989325, -96.40185275799881, -283.82584748733217, -291.0963769464409, -640.7798431921206, -238.36438305510003, -300.4967902473749, -503.61235048017306, -16.5187971914145, -215.26439205074686, -1069.035922445679, -1002.0931180170553, -362.7500450557762, -18.678997884994146, -371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939, -490.3246593741843, -292.28363641784, -214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545355181442794, "mean_inference_ms": 1.730491058382917, "mean_action_processing_ms": 0.2759841078456844, "mean_env_wait_ms": 3.44522225400034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011574745178222656, "StateBufferConnector_ms": 0.007905721664428711, "ViewRequirementAgentConnector_ms": 0.1940615177154541}, "num_episodes": 35, "episode_return_max": -4.597573481400759, "episode_return_min": -1342.0488720514127, "episode_return_mean": -476.0412678400535, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.01182613905075, "num_env_steps_trained_throughput_per_sec": 302.01182613905075, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12601.317, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12601.248, "sample_time_ms": 1127.027, "learn_time_ms": 11409.329, "learn_throughput": 350.59, "synch_weights_time_ms": 64.1}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00004", "date": "2024-08-04_08-14-29", "timestamp": 1722739469, "time_this_iter_s": 13.257165908813477, "time_total_s": 542.5095224380493, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354136950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 542.5095224380493, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.977777777777774, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.07784026861191, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.1641029117939372, "policy_loss": -0.0074357852625932235, "vf_loss": 1.1687850384662548, "vf_explained_var": 0.9874777372926473, "kl": 0.014410440956028954, "entropy": 1.2843161313484113, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -4.597573481400759, "episode_reward_min": -1218.9411446981728, "episode_reward_mean": -493.4370984672594, "episode_len_mean": 115.01, "episode_media": {}, "episodes_timesteps_total": 11501, "policy_reward_min": {"policy_0": -1218.9411446981728}, "policy_reward_max": {"policy_0": -4.597573481400759}, "policy_reward_mean": {"policy_0": -493.4370984672594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939, -490.3246593741843, -292.28363641784, -214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642, -556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972], "episode_lengths": [150, 150, 150, 140, 36, 70, 100, 66, 150, 150, 53, 56, 150, 66, 150, 150, 125, 150, 72, 150, 88, 106, 46, 128, 77, 150, 61, 84, 99, 150, 150, 128, 103, 150, 59, 66, 64, 50, 150, 150, 71, 150, 150, 41, 150, 150, 34, 89, 150, 150, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 53, 150, 124, 137, 150, 150, 117, 107, 150, 47, 150, 76, 102, 84, 58, 150, 70, 150, 148, 125, 149, 72, 109, 54, 137, 107, 109, 150, 55, 150, 150, 150, 42, 150, 92, 49], "policy_policy_0_reward": [-371.6182238690066, -1083.8257679756955, -552.714728115929, -783.014983538107, -9.9983144232863, -227.08420119818692, -409.3369103846022, -81.66233685171564, -1045.5241201770432, -1078.7430345021364, -73.44655958909838, -57.089694689579915, -788.1131236748021, -75.33485725993793, -480.9730027322612, -626.0879142938359, -265.1648811502292, -276.6697363825813, -221.7009030723453, -1218.9411446981728, -179.38245711604446, -448.50142444095604, -36.36054141590214, -735.1387588360077, -112.84758163679237, -458.84802846954886, -59.41662142204557, -177.2104613326807, -215.89030320668837, -759.7823041406939, -490.3246593741843, -292.28363641784, -214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642, -556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547766717423854, "mean_inference_ms": 1.729162850024949, "mean_action_processing_ms": 0.27587627553317445, "mean_env_wait_ms": 3.4460233665122386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011669158935546875, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.19245052337646484}, "num_episodes": 35, "episode_return_max": -4.597573481400759, "episode_return_min": -1218.9411446981728, "episode_return_mean": -493.4370984672594, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8198396586253, "num_env_steps_trained_throughput_per_sec": 302.8198396586253, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12667.432, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12667.363, "sample_time_ms": 1133.976, "learn_time_ms": 11467.908, "learn_throughput": 348.799, "synch_weights_time_ms": 64.677}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00004", "date": "2024-08-04_08-14-43", "timestamp": 1722739483, "time_this_iter_s": 13.222049236297607, "time_total_s": 555.7315716743469, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 555.7315716743469, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.83684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.38773180246353, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.0389326465005675, "policy_loss": -0.007135620737002076, "vf_loss": 1.044031895045191, "vf_explained_var": 0.9855628628904621, "kl": 0.010973175968562546, "entropy": 1.5826092318942149, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -4.597573481400759, "episode_reward_min": -1491.1514280945041, "episode_reward_mean": -522.5916977428308, "episode_len_mean": 117.39, "episode_media": {}, "episodes_timesteps_total": 11739, "policy_reward_min": {"policy_0": -1491.1514280945041}, "policy_reward_max": {"policy_0": -4.597573481400759}, "policy_reward_mean": {"policy_0": -522.5916977428308}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642, -556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573], "episode_lengths": [103, 150, 59, 66, 64, 50, 150, 150, 71, 150, 150, 41, 150, 150, 34, 89, 150, 150, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 53, 150, 124, 137, 150, 150, 117, 107, 150, 47, 150, 76, 102, 84, 58, 150, 70, 150, 148, 125, 149, 72, 109, 54, 137, 107, 109, 150, 55, 150, 150, 150, 42, 150, 92, 49, 42, 150, 76, 53, 150, 150, 150, 150, 150, 113, 144, 135, 125, 112, 82, 150, 67, 150, 141, 74, 63, 150, 68, 150, 134, 63, 150, 109, 92, 147, 150, 149], "policy_policy_0_reward": [-214.08768892265056, -1067.5256191275864, -47.92199878291499, -80.88718380724578, -67.54095763052973, -36.25851874208603, -884.4309291585862, -1023.014087583496, -92.60120014112647, -493.7759145341734, -736.5282376917951, -15.716800744665484, -765.9867000096227, -939.8981066450862, -4.597573481400759, -234.59780940775326, -694.1176043084869, -674.2878038749922, -863.4722485451746, -802.4377269294167, -263.7044609650738, -907.7913759563899, -1126.7161000558347, -487.4056747477924, -689.0294506779209, -787.9900806197528, -1054.049133935096, -769.7427593196564, -551.407548134512, -1089.551792113744, -913.4726180687204, -501.67248314469776, -36.25277157969642, -556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550397736535191, "mean_inference_ms": 1.7285234822990134, "mean_action_processing_ms": 0.27597113160381487, "mean_env_wait_ms": 3.4480728701964862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011697053909301758, "StateBufferConnector_ms": 0.007875204086303711, "ViewRequirementAgentConnector_ms": 0.19215011596679688}, "num_episodes": 32, "episode_return_max": -4.597573481400759, "episode_return_min": -1491.1514280945041, "episode_return_mean": -522.5916977428308, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.52421923977164, "num_env_steps_trained_throughput_per_sec": 306.52421923977164, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12652.014, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12651.943, "sample_time_ms": 1135.543, "learn_time_ms": 11450.565, "learn_throughput": 349.328, "synch_weights_time_ms": 65.04}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00004", "date": "2024-08-04_08-14-56", "timestamp": 1722739496, "time_this_iter_s": 13.061853647232056, "time_total_s": 568.793425321579, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354137130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 568.793425321579, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.810526315789474, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.18863022526105, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 0.8725468054413795, "policy_loss": -0.02046144847602894, "vf_loss": 0.8891603148231904, "vf_explained_var": 0.9974605672061443, "kl": 0.020061744121054926, "entropy": 1.6441091027110815, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -13.931155735290735, "episode_reward_min": -1549.0096462462257, "episode_reward_mean": -504.98289428612276, "episode_len_mean": 115.6, "episode_media": {}, "episodes_timesteps_total": 11560, "policy_reward_min": {"policy_0": -1549.0096462462257}, "policy_reward_max": {"policy_0": -13.931155735290735}, "policy_reward_mean": {"policy_0": -504.98289428612276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573, -130.14675441949848, -699.9951955418185, -137.70800305296365, -149.4242925258338, -69.40088615382163, -1549.0096462462257, -372.1482256837454, -313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535], "episode_lengths": [150, 124, 137, 150, 150, 117, 107, 150, 47, 150, 76, 102, 84, 58, 150, 70, 150, 148, 125, 149, 72, 109, 54, 137, 107, 109, 150, 55, 150, 150, 150, 42, 150, 92, 49, 42, 150, 76, 53, 150, 150, 150, 150, 150, 113, 144, 135, 125, 112, 82, 150, 67, 150, 141, 74, 63, 150, 68, 150, 134, 63, 150, 109, 92, 147, 150, 149, 79, 150, 77, 96, 69, 150, 150, 106, 150, 103, 150, 63, 75, 150, 150, 150, 94, 50, 108, 121, 150, 150, 150, 141, 132, 67, 150, 150, 43, 47, 150, 80, 150], "policy_policy_0_reward": [-556.9763811906964, -318.97934763691273, -556.3114972759289, -770.9657245255988, -908.4044411470037, -286.85314839620867, -559.3948599240655, -1166.4604476626998, -30.137930370928036, -1056.2707949363612, -201.55425873025013, -311.6930212529561, -194.62215623597598, -39.99480521495468, -771.5209928318343, -118.11991436692804, -494.182113464368, -348.94984276709687, -635.4789647045045, -883.6034480818234, -120.58153097153307, -204.69212655749814, -43.35259696330394, -351.9292021824524, -192.45196822115076, -207.05167558339724, -637.7016354963986, -38.00036610504931, -1197.9136677223794, -1179.3866776700602, -1131.089597600864, -88.67283975039749, -977.2340556385905, -131.13891274690874, -20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573, -130.14675441949848, -699.9951955418185, -137.70800305296365, -149.4242925258338, -69.40088615382163, -1549.0096462462257, -372.1482256837454, -313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549338210476576, "mean_inference_ms": 1.7265645228434388, "mean_action_processing_ms": 0.2758356440989088, "mean_env_wait_ms": 3.4483190788534483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011859416961669922, "StateBufferConnector_ms": 0.007907629013061523, "ViewRequirementAgentConnector_ms": 0.19159269332885742}, "num_episodes": 33, "episode_return_max": -13.931155735290735, "episode_return_min": -1549.0096462462257, "episode_return_mean": -504.98289428612276, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.0272798459256, "num_env_steps_trained_throughput_per_sec": 355.0272798459256, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12626.044, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12625.974, "sample_time_ms": 1154.298, "learn_time_ms": 11403.81, "learn_throughput": 350.76, "synch_weights_time_ms": 67.079}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00004", "date": "2024-08-04_08-15-07", "timestamp": 1722739507, "time_this_iter_s": 11.278425931930542, "time_total_s": 580.0718512535095, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.0718512535095, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.1375, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.0031572173039, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 0.9130138309051593, "policy_loss": -0.012933733303604337, "vf_loss": 0.921638570073992, "vf_explained_var": 0.998827809902529, "kl": 0.014870877935512302, "entropy": 1.5227072746803363, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -10.408900245213491, "episode_reward_min": -1549.0096462462257, "episode_reward_mean": -535.9612200065221, "episode_len_mean": 114.87, "episode_media": {}, "episodes_timesteps_total": 11487, "policy_reward_min": {"policy_0": -1549.0096462462257}, "policy_reward_max": {"policy_0": -10.408900245213491}, "policy_reward_mean": {"policy_0": -535.9612200065221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573, -130.14675441949848, -699.9951955418185, -137.70800305296365, -149.4242925258338, -69.40088615382163, -1549.0096462462257, -372.1482256837454, -313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535, -1401.8353883818254, -10.408900245213491, -55.864590695719784, -28.067420478075967, -316.07369050467645, -776.3260304124597, -189.71567275188826, -207.36846672530726, -329.02791300276544, -476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865], "episode_lengths": [49, 42, 150, 76, 53, 150, 150, 150, 150, 150, 113, 144, 135, 125, 112, 82, 150, 67, 150, 141, 74, 63, 150, 68, 150, 134, 63, 150, 109, 92, 147, 150, 149, 79, 150, 77, 96, 69, 150, 150, 106, 150, 103, 150, 63, 75, 150, 150, 150, 94, 50, 108, 121, 150, 150, 150, 141, 132, 67, 150, 150, 43, 47, 150, 80, 150, 150, 41, 56, 44, 111, 150, 93, 70, 97, 114, 42, 72, 150, 150, 118, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 135, 70, 150, 68, 44], "policy_policy_0_reward": [-20.536727023237972, -17.826734374048932, -651.2839005778509, -311.6998972882602, -46.35183822413542, -546.9206877462648, -869.8831894989902, -369.2272865469876, -1491.1514280945041, -880.0776324866431, -281.42374519644494, -877.6904274695951, -204.6854282518502, -368.99903202714165, -426.75124522862666, -312.0378426685679, -1054.3520295360984, -73.716891759457, -834.0785802592634, -752.3945279228436, -114.04033905780724, -183.81664993809963, -1010.0292772710662, -69.39528275284233, -818.185538189051, -663.8054564881189, -93.47234879173494, -952.5153607813664, -281.9239409140041, -361.6696261381649, -476.66135742713175, -680.1705420594622, -532.2530789786573, -130.14675441949848, -699.9951955418185, -137.70800305296365, -149.4242925258338, -69.40088615382163, -1549.0096462462257, -372.1482256837454, -313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535, -1401.8353883818254, -10.408900245213491, -55.864590695719784, -28.067420478075967, -316.07369050467645, -776.3260304124597, -189.71567275188826, -207.36846672530726, -329.02791300276544, -476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554991438654965, "mean_inference_ms": 1.725240710306428, "mean_action_processing_ms": 0.2757936820819906, "mean_env_wait_ms": 3.4509627758076493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934757232666016, "StateBufferConnector_ms": 0.007992982864379883, "ViewRequirementAgentConnector_ms": 0.19263601303100586}, "num_episodes": 34, "episode_return_max": -10.408900245213491, "episode_return_min": -1549.0096462462257, "episode_return_mean": -535.9612200065221, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0203517349647, "num_env_steps_trained_throughput_per_sec": 303.0203517349647, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12709.815, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12709.746, "sample_time_ms": 1163.064, "learn_time_ms": 11478.402, "learn_throughput": 348.481, "synch_weights_time_ms": 67.481}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00004", "date": "2024-08-04_08-15-20", "timestamp": 1722739520, "time_this_iter_s": 13.213147640228271, "time_total_s": 593.2849988937378, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.2849988937378, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.894736842105264, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.3259074449539, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 0.9726379759551491, "policy_loss": -0.01656118231427778, "vf_loss": 0.9843021959376832, "vf_explained_var": 0.9979054767017563, "kl": 0.016705683316589205, "entropy": 1.1474271489307284, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -10.408900245213491, "episode_reward_min": -1473.3519743398329, "episode_reward_mean": -525.7145050913042, "episode_len_mean": 113.46, "episode_media": {}, "episodes_timesteps_total": 11346, "policy_reward_min": {"policy_0": -1473.3519743398329}, "policy_reward_max": {"policy_0": -10.408900245213491}, "policy_reward_mean": {"policy_0": -525.7145050913042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535, -1401.8353883818254, -10.408900245213491, -55.864590695719784, -28.067420478075967, -316.07369050467645, -776.3260304124597, -189.71567275188826, -207.36846672530726, -329.02791300276544, -476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865, -1024.384304970731, -131.9138073671727, -426.2405163026577, -214.99603667878182, -217.30697879407504, -249.72276030885112, -225.37494779700614, -365.9286647851414, -1186.9326636464148, -1027.6766519440882, -172.55952116580514, -238.64256865097687, -81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245], "episode_lengths": [106, 150, 103, 150, 63, 75, 150, 150, 150, 94, 50, 108, 121, 150, 150, 150, 141, 132, 67, 150, 150, 43, 47, 150, 80, 150, 150, 41, 56, 44, 111, 150, 93, 70, 97, 114, 42, 72, 150, 150, 118, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 135, 70, 150, 68, 44, 150, 97, 98, 107, 92, 108, 112, 133, 150, 150, 96, 94, 73, 150, 86, 57, 45, 81, 82, 150, 150, 94, 53, 120, 150, 150, 57, 150, 150, 75, 150, 150, 65, 62, 150, 51, 130, 150, 150, 150], "policy_policy_0_reward": [-313.28061104930083, -861.5469230545028, -474.9623624810188, -1045.9435349024454, -63.03300756697878, -112.884044309539, -826.214831517942, -1285.7708697205624, -640.294243199991, -245.55471034677805, -34.25518586677034, -430.82879534153705, -323.834790439221, -1127.4025541838473, -1129.761702900533, -576.8575289590286, -376.0458043066961, -518.4130515466949, -82.1441633150154, -820.4657465672685, -1169.2501172978787, -13.931155735290735, -23.94120544773824, -478.3287517859326, -231.87626905592603, -842.935649194535, -1401.8353883818254, -10.408900245213491, -55.864590695719784, -28.067420478075967, -316.07369050467645, -776.3260304124597, -189.71567275188826, -207.36846672530726, -329.02791300276544, -476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865, -1024.384304970731, -131.9138073671727, -426.2405163026577, -214.99603667878182, -217.30697879407504, -249.72276030885112, -225.37494779700614, -365.9286647851414, -1186.9326636464148, -1027.6766519440882, -172.55952116580514, -238.64256865097687, -81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548370069388916, "mean_inference_ms": 1.7244431728009548, "mean_action_processing_ms": 0.2757200905008781, "mean_env_wait_ms": 3.452811483311616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012163400650024414, "StateBufferConnector_ms": 0.008034706115722656, "ViewRequirementAgentConnector_ms": 0.19278168678283691}, "num_episodes": 40, "episode_return_max": -10.408900245213491, "episode_return_min": -1473.3519743398329, "episode_return_mean": -525.7145050913042, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.6197964559308, "num_env_steps_trained_throughput_per_sec": 316.6197964559308, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12666.212, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12666.142, "sample_time_ms": 1157.187, "learn_time_ms": 11440.49, "learn_throughput": 349.635, "synch_weights_time_ms": 67.659}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00004", "date": "2024-08-04_08-15-33", "timestamp": 1722739533, "time_this_iter_s": 12.644794940948486, "time_total_s": 605.9297938346863, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354137130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 605.9297938346863, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.072222222222223, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.63371675113837, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.0868345234232644, "policy_loss": -0.009296191633620766, "vf_loss": 1.0926443083211779, "vf_explained_var": 0.9907821198304494, "kl": 0.012058811331583793, "entropy": 1.3123675310363372, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -10.897650889183865, "episode_reward_min": -1473.3519743398329, "episode_reward_mean": -481.5343698758137, "episode_len_mean": 111.98, "episode_media": {}, "episodes_timesteps_total": 11198, "policy_reward_min": {"policy_0": -1473.3519743398329}, "policy_reward_max": {"policy_0": -10.897650889183865}, "policy_reward_mean": {"policy_0": -481.5343698758137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865, -1024.384304970731, -131.9138073671727, -426.2405163026577, -214.99603667878182, -217.30697879407504, -249.72276030885112, -225.37494779700614, -365.9286647851414, -1186.9326636464148, -1027.6766519440882, -172.55952116580514, -238.64256865097687, -81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245, -151.15052357825957, -355.1899040656703, -124.31639683394174, -569.0272882922218, -27.023098616578405, -724.5871275248302, -150.35926901142298, -530.9412072562787, -578.5580953198967, -285.25902355621076, -43.725891828707496, -1030.2594480950577, -92.37659497622141, -116.54735691390005, -19.24875475899806, -595.0685706212813, -407.327624554287, -76.95763527323423, -375.60571181012915, -177.85643751940893, -716.180657658015, -73.09360220720525, -974.0860039281205, -1267.521259765843, -260.72219766535585, -1013.423412941307, -116.88137858671483, -68.08786387530583, -514.1803186149698, -115.65700555838342, -325.7923282689758, -725.4008157273396, -152.32432258910126, -148.62414308083038, -43.07089086784954], "episode_lengths": [114, 42, 72, 150, 150, 118, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 135, 70, 150, 68, 44, 150, 97, 98, 107, 92, 108, 112, 133, 150, 150, 96, 94, 73, 150, 86, 57, 45, 81, 82, 150, 150, 94, 53, 120, 150, 150, 57, 150, 150, 75, 150, 150, 65, 62, 150, 51, 130, 150, 150, 150, 95, 137, 69, 150, 44, 140, 87, 150, 109, 115, 53, 150, 69, 82, 42, 150, 149, 66, 150, 101, 150, 50, 150, 150, 111, 150, 72, 62, 141, 54, 123, 150, 83, 81, 59], "policy_policy_0_reward": [-476.13422301139144, -15.435193382913228, -97.32112526768562, -806.1362630102161, -1322.3250342487916, -277.0039563273725, -996.7749991488333, -197.18738963634027, -1292.817296652466, -711.0208462617182, -896.5440131622381, -1473.3519743398329, -1386.6633229683316, -853.0387651138811, -611.4316984686325, -358.1736105988771, -1342.7319178918615, -35.84010528852275, -1180.8232763278174, -583.9007477794364, -201.52782972504497, -120.46064932100225, -1146.0526371529552, -101.22091679374002, -10.897650889183865, -1024.384304970731, -131.9138073671727, -426.2405163026577, -214.99603667878182, -217.30697879407504, -249.72276030885112, -225.37494779700614, -365.9286647851414, -1186.9326636464148, -1027.6766519440882, -172.55952116580514, -238.64256865097687, -81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245, -151.15052357825957, -355.1899040656703, -124.31639683394174, -569.0272882922218, -27.023098616578405, -724.5871275248302, -150.35926901142298, -530.9412072562787, -578.5580953198967, -285.25902355621076, -43.725891828707496, -1030.2594480950577, -92.37659497622141, -116.54735691390005, -19.24875475899806, -595.0685706212813, -407.327624554287, -76.95763527323423, -375.60571181012915, -177.85643751940893, -716.180657658015, -73.09360220720525, -974.0860039281205, -1267.521259765843, -260.72219766535585, -1013.423412941307, -116.88137858671483, -68.08786387530583, -514.1803186149698, -115.65700555838342, -325.7923282689758, -725.4008157273396, -152.32432258910126, -148.62414308083038, -43.07089086784954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547746375803413, "mean_inference_ms": 1.7228854801014812, "mean_action_processing_ms": 0.27566942842165276, "mean_env_wait_ms": 3.45484739820865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012125253677368164, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.19084763526916504}, "num_episodes": 35, "episode_return_max": -10.897650889183865, "episode_return_min": -1473.3519743398329, "episode_return_mean": -481.5343698758137, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.18936318186365, "num_env_steps_trained_throughput_per_sec": 298.18936318186365, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12735.873, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12735.804, "sample_time_ms": 1161.587, "learn_time_ms": 11505.44, "learn_throughput": 347.662, "synch_weights_time_ms": 67.971}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00004", "date": "2024-08-04_08-15-47", "timestamp": 1722739547, "time_this_iter_s": 13.426936626434326, "time_total_s": 619.3567304611206, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 619.3567304611206, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.78947368421053, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.83294252753257, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 0.6935771419278657, "policy_loss": -0.011679513487615622, "vf_loss": 0.7010202211327851, "vf_explained_var": 0.9987725594391426, "kl": 0.014566261963621704, "entropy": 1.3344527746240298, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -13.030169579672375, "episode_reward_min": -1305.9613443749454, "episode_reward_mean": -417.05406169154924, "episode_len_mean": 106.82, "episode_media": {}, "episodes_timesteps_total": 10682, "policy_reward_min": {"policy_0": -1305.9613443749454}, "policy_reward_max": {"policy_0": -13.030169579672375}, "policy_reward_mean": {"policy_0": -417.05406169154924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245, -151.15052357825957, -355.1899040656703, -124.31639683394174, -569.0272882922218, -27.023098616578405, -724.5871275248302, -150.35926901142298, -530.9412072562787, -578.5580953198967, -285.25902355621076, -43.725891828707496, -1030.2594480950577, -92.37659497622141, -116.54735691390005, -19.24875475899806, -595.0685706212813, -407.327624554287, -76.95763527323423, -375.60571181012915, -177.85643751940893, -716.180657658015, -73.09360220720525, -974.0860039281205, -1267.521259765843, -260.72219766535585, -1013.423412941307, -116.88137858671483, -68.08786387530583, -514.1803186149698, -115.65700555838342, -325.7923282689758, -725.4008157273396, -152.32432258910126, -148.62414308083038, -43.07089086784954, -892.9718932565686, -146.21303551386157, -1088.5688682177513, -106.63512939647003, -75.90682080600386, -1062.5143967618542, -497.12825751457825, -61.17314707797276, -48.17124429665722, -377.6981768139117, -136.85038818625935, -30.160288503463168, -91.83534529019207, -1040.5115260476189, -329.907385546733, -46.81676272525414, -228.98432268285185, -916.8642627907534, -451.6779082558061, -392.80719316757245, -649.5605051290211, -909.5564234798538, -262.4685689970636, -557.3459084785875, -49.56266938994799, -114.26660888835332, -861.736530127254, -59.74852670070978, -319.232504797773, -41.119098716001034, -263.5067976209735, -13.030169579672375, -1305.9613443749454, -88.4397841620023, -933.4142309514551, -70.6634759741214, -1005.4545465344711], "episode_lengths": [73, 150, 86, 57, 45, 81, 82, 150, 150, 94, 53, 120, 150, 150, 57, 150, 150, 75, 150, 150, 65, 62, 150, 51, 130, 150, 150, 150, 95, 137, 69, 150, 44, 140, 87, 150, 109, 115, 53, 150, 69, 82, 42, 150, 149, 66, 150, 101, 150, 50, 150, 150, 111, 150, 72, 62, 141, 54, 123, 150, 83, 81, 59, 150, 62, 150, 76, 70, 150, 150, 57, 55, 92, 148, 38, 82, 150, 130, 54, 98, 150, 103, 150, 150, 150, 98, 150, 60, 73, 150, 64, 122, 57, 99, 45, 150, 57, 150, 67, 150], "policy_policy_0_reward": [-81.8770083806675, -1005.9141706449242, -177.28595394655784, -38.1520612334755, -17.32819358061156, -304.69225215755176, -153.085965398492, -535.9692026742689, -539.0596616570633, -206.43826115127598, -45.67344676850176, -416.71761327252295, -953.3469329071778, -1268.8595214836641, -48.699141672731635, -554.6086584941634, -455.2852936044487, -121.58118327656659, -1240.226143555817, -897.2549708037337, -73.09819495717477, -114.86357081931304, -522.2337616636743, -23.909299540947924, -224.35959362937155, -1256.5308170199662, -1194.683452021041, -758.7756343430245, -151.15052357825957, -355.1899040656703, -124.31639683394174, -569.0272882922218, -27.023098616578405, -724.5871275248302, -150.35926901142298, -530.9412072562787, -578.5580953198967, -285.25902355621076, -43.725891828707496, -1030.2594480950577, -92.37659497622141, -116.54735691390005, -19.24875475899806, -595.0685706212813, -407.327624554287, -76.95763527323423, -375.60571181012915, -177.85643751940893, -716.180657658015, -73.09360220720525, -974.0860039281205, -1267.521259765843, -260.72219766535585, -1013.423412941307, -116.88137858671483, -68.08786387530583, -514.1803186149698, -115.65700555838342, -325.7923282689758, -725.4008157273396, -152.32432258910126, -148.62414308083038, -43.07089086784954, -892.9718932565686, -146.21303551386157, -1088.5688682177513, -106.63512939647003, -75.90682080600386, -1062.5143967618542, -497.12825751457825, -61.17314707797276, -48.17124429665722, -377.6981768139117, -136.85038818625935, -30.160288503463168, -91.83534529019207, -1040.5115260476189, -329.907385546733, -46.81676272525414, -228.98432268285185, -916.8642627907534, -451.6779082558061, -392.80719316757245, -649.5605051290211, -909.5564234798538, -262.4685689970636, -557.3459084785875, -49.56266938994799, -114.26660888835332, -861.736530127254, -59.74852670070978, -319.232504797773, -41.119098716001034, -263.5067976209735, -13.030169579672375, -1305.9613443749454, -88.4397841620023, -933.4142309514551, -70.6634759741214, -1005.4545465344711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547152303300941, "mean_inference_ms": 1.7210361919827795, "mean_action_processing_ms": 0.27556443876546105, "mean_env_wait_ms": 3.454513056526947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012303590774536133, "StateBufferConnector_ms": 0.00793600082397461, "ViewRequirementAgentConnector_ms": 0.19076871871948242}, "num_episodes": 37, "episode_return_max": -13.030169579672375, "episode_return_min": -1305.9613443749454, "episode_return_mean": -417.05406169154924, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.797556609, "num_env_steps_trained_throughput_per_sec": 299.797556609, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12771.16, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12771.09, "sample_time_ms": 1156.986, "learn_time_ms": 11545.91, "learn_throughput": 346.443, "synch_weights_time_ms": 67.387}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00004", "date": "2024-08-04_08-16-00", "timestamp": 1722739560, "time_this_iter_s": 13.35508418083191, "time_total_s": 632.7118146419525, "pid": 608905, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354070a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 632.7118146419525, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.89473684210526, "ram_util_percent": 28.3}}
