{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.804848721250892, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.52029798378547, "policy_loss": -0.006968396045946671, "vf_loss": 8.525386664271355, "vf_explained_var": 0.13843694888055325, "kl": 0.010115778877934644, "entropy": 1.434669778496027, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -19.890135704447193, "episode_reward_min": -1331.6743174288406, "episode_reward_mean": -679.4615452228105, "episode_len_mean": 115.4, "episode_media": {}, "episodes_timesteps_total": 2885, "policy_reward_min": {"policy_0": -1331.6743174288406}, "policy_reward_max": {"policy_0": -19.890135704447193}, "policy_reward_mean": {"policy_0": -679.4615452228105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471], "episode_lengths": [150, 49, 150, 39, 146, 150, 114, 60, 64, 150, 150, 55, 150, 150, 93, 70, 86, 150, 150, 100, 59, 150, 150, 150, 150], "policy_policy_0_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566172320110653, "mean_inference_ms": 1.6606309073311942, "mean_action_processing_ms": 0.27513264184710623, "mean_env_wait_ms": 3.3801267677144273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011450767517089844, "StateBufferConnector_ms": 0.008070945739746094, "ViewRequirementAgentConnector_ms": 0.18039226531982422}, "num_episodes": 25, "episode_return_max": -19.890135704447193, "episode_return_min": -1331.6743174288406, "episode_return_mean": -679.4615452228105, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.655728256663, "num_env_steps_trained_throughput_per_sec": 317.655728256663, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12592.259, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12592.196, "sample_time_ms": 1098.302, "learn_time_ms": 11429.737, "learn_throughput": 349.964, "synch_weights_time_ms": 63.392}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00000", "date": "2024-08-04_07-22-20", "timestamp": 1722736340, "time_this_iter_s": 12.603649854660034, "time_total_s": 12.603649854660034, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9969ac670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.603649854660034, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.15, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.76527036502957, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.422738156716028, "policy_loss": -0.009754707269894424, "vf_loss": 5.430279002835353, "vf_explained_var": 0.7317594185471534, "kl": 0.011791818366661272, "entropy": 1.4450309169789155, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -19.890135704447193, "episode_reward_min": -1337.852851658314, "episode_reward_mean": -767.5814688830641, "episode_len_mean": 124.66666666666667, "episode_media": {}, "episodes_timesteps_total": 6358, "policy_reward_min": {"policy_0": -1337.852851658314}, "policy_reward_max": {"policy_0": -19.890135704447193}, "policy_reward_mean": {"policy_0": -767.5814688830641}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255], "episode_lengths": [150, 49, 150, 39, 146, 150, 114, 60, 64, 150, 150, 55, 150, 150, 93, 70, 86, 150, 150, 100, 59, 150, 150, 150, 150, 150, 150, 110, 150, 96, 36, 150, 150, 150, 150, 115, 150, 150, 109, 150, 150, 150, 150, 74, 83, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5645382689659721, "mean_inference_ms": 1.659140470176862, "mean_action_processing_ms": 0.2757122605332239, "mean_env_wait_ms": 3.383336084313371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013801630805520451, "StateBufferConnector_ms": 0.00869292838900697, "ViewRequirementAgentConnector_ms": 0.18723151263068705}, "num_episodes": 26, "episode_return_max": -19.890135704447193, "episode_return_min": -1337.852851658314, "episode_return_mean": -767.5814688830641, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.2665129512621, "num_env_steps_trained_throughput_per_sec": 308.2665129512621, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12784.028, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12783.962, "sample_time_ms": 1094.639, "learn_time_ms": 11623.453, "learn_throughput": 344.132, "synch_weights_time_ms": 65.088}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00000", "date": "2024-08-04_07-22-33", "timestamp": 1722736353, "time_this_iter_s": 12.988163709640503, "time_total_s": 25.591813564300537, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680c160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.591813564300537, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.41578947368421, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94.80191253026327, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.3391146125271916, "policy_loss": -0.003724632868155216, "vf_loss": 3.3406688834230107, "vf_explained_var": 0.901674418648084, "kl": 0.011567390373117329, "entropy": 1.4312819013992946, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -19.890135704447193, "episode_reward_min": -1344.3526386665774, "episode_reward_mean": -756.5659116029849, "episode_len_mean": 126.22619047619048, "episode_media": {}, "episodes_timesteps_total": 10603, "policy_reward_min": {"policy_0": -1344.3526386665774}, "policy_reward_max": {"policy_0": -19.890135704447193}, "policy_reward_mean": {"policy_0": -756.5659116029849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164], "episode_lengths": [150, 49, 150, 39, 146, 150, 114, 60, 64, 150, 150, 55, 150, 150, 93, 70, 86, 150, 150, 100, 59, 150, 150, 150, 150, 150, 150, 110, 150, 96, 36, 150, 150, 150, 150, 115, 150, 150, 109, 150, 150, 150, 150, 74, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 52, 132, 150, 50, 57, 150, 150, 150, 114, 150, 150, 67, 135, 150, 77, 150, 96, 150, 150, 56, 150, 150], "policy_policy_0_reward": [-1314.4677090016612, -109.11013043663951, -842.007950438344, -19.890135704447193, -769.1898123169503, -939.570198538338, -598.9343183546131, -107.19131908953082, -118.9238069814546, -1136.2479986507183, -1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638705743084367, "mean_inference_ms": 1.6634559715693962, "mean_action_processing_ms": 0.27620912070950415, "mean_env_wait_ms": 3.4007997821703406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013605753580729166, "StateBufferConnector_ms": 0.008722146352132162, "ViewRequirementAgentConnector_ms": 0.18995461009797596}, "num_episodes": 33, "episode_return_max": -19.890135704447193, "episode_return_min": -1344.3526386665774, "episode_return_mean": -756.5659116029849, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0955447732622, "num_env_steps_trained_throughput_per_sec": 313.0955447732622, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12781.241, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12781.172, "sample_time_ms": 1109.715, "learn_time_ms": 11606.949, "learn_throughput": 344.621, "synch_weights_time_ms": 63.732}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00000", "date": "2024-08-04_07-22-45", "timestamp": 1722736365, "time_this_iter_s": 12.790367841720581, "time_total_s": 38.38218140602112, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.38218140602112, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.18333333333333, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.35771224697432, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.139754716431101, "policy_loss": -0.007538183632035119, "vf_loss": 3.1453216006358464, "vf_explained_var": 0.9590842790280779, "kl": 0.01055876971574132, "entropy": 1.4045915520439545, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -31.89462726335749, "episode_reward_min": -1388.0152565803076, "episode_reward_mean": -792.6521491045776, "episode_len_mean": 130.39, "episode_media": {}, "episodes_timesteps_total": 13039, "policy_reward_min": {"policy_0": -1388.0152565803076}, "policy_reward_max": {"policy_0": -31.89462726335749}, "policy_reward_mean": {"policy_0": -792.6521491045776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577], "episode_lengths": [150, 55, 150, 150, 93, 70, 86, 150, 150, 100, 59, 150, 150, 150, 150, 150, 150, 110, 150, 96, 36, 150, 150, 150, 150, 115, 150, 150, 109, 150, 150, 150, 150, 74, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 52, 132, 150, 50, 57, 150, 150, 150, 114, 150, 150, 67, 135, 150, 77, 150, 96, 150, 150, 56, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 90, 150, 128, 150, 150, 77, 95, 150, 150, 150, 145, 150, 150, 150, 75], "policy_policy_0_reward": [-1197.422674462101, -43.12018186053664, -1088.3789689835423, -739.0713495029819, -260.43715543401987, -236.14330009788762, -179.48905873635942, -1331.6743174288406, -1079.7407573010123, -442.92086454470365, -174.81559336016008, -1271.0470630529107, -1308.0815000377975, -972.1395104457639, -706.5229558089471, -1179.053868487302, -861.5605397858842, -283.20795413060534, -977.4121233058872, -474.7806437477874, -31.89462726335749, -1041.0418478385996, -1183.6723371157357, -1189.0680036836807, -492.5083542331639, -567.425991264483, -1337.852851658314, -945.7545703755188, -293.5419278149828, -559.4446222211494, -973.4531876030155, -1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641651463550644, "mean_inference_ms": 1.6684286633302958, "mean_action_processing_ms": 0.277013926342311, "mean_env_wait_ms": 3.4104257809015808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013869285583496094, "StateBufferConnector_ms": 0.008774042129516602, "ViewRequirementAgentConnector_ms": 0.19877886772155762}, "num_episodes": 26, "episode_return_max": -31.89462726335749, "episode_return_min": -1388.0152565803076, "episode_return_mean": -792.6521491045776, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.39479683736846, "num_env_steps_trained_throughput_per_sec": 304.39479683736846, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12871.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12871.073, "sample_time_ms": 1117.735, "learn_time_ms": 11689.71, "learn_throughput": 342.181, "synch_weights_time_ms": 62.851}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00000", "date": "2024-08-04_07-22-59", "timestamp": 1722736379, "time_this_iter_s": 13.15503716468811, "time_total_s": 51.53721857070923, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9969ac670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.53721857070923, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.710526315789473, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.57804094751677, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.6599941275392969, "policy_loss": -0.011567810547421686, "vf_loss": 1.6692775322124362, "vf_explained_var": 0.9803779929876327, "kl": 0.012106437421637872, "entropy": 1.368788410226504, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -42.83153804042189, "episode_reward_min": -1388.0152565803076, "episode_reward_mean": -790.106634695914, "episode_len_mean": 131.97, "episode_media": {}, "episodes_timesteps_total": 13197, "policy_reward_min": {"policy_0": -1388.0152565803076}, "policy_reward_max": {"policy_0": -42.83153804042189}, "policy_reward_mean": {"policy_0": -790.106634695914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238], "episode_lengths": [150, 150, 74, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 52, 132, 150, 50, 57, 150, 150, 150, 114, 150, 150, 67, 135, 150, 77, 150, 96, 150, 150, 56, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 90, 150, 128, 150, 150, 77, 95, 150, 150, 150, 145, 150, 150, 150, 75, 105, 56, 69, 150, 150, 131, 150, 93, 148, 150, 150, 150, 98, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 61, 150, 150, 150], "policy_policy_0_reward": [-1149.8798715495554, -1024.3864573625542, -183.85542403136597, -194.8626412448605, -1170.7236434492054, -1202.0234420319025, -1250.6518441474147, -1273.3297041952542, -1171.286547221103, -1147.4432567033255, -835.6207551953751, -1203.6069109001567, -833.2892032706671, -793.5249138794182, -1344.3526386665774, -789.2362316465969, -1080.520490678465, -339.1966853294514, -1015.38757540443, -880.7754008390019, -1294.2900813737301, -72.78312545646993, -726.6422779056631, -480.9472231393418, -42.83153804042189, -90.882034092273, -1173.2868030901368, -1078.7820686559576, -1073.3848733424795, -585.3247550011206, -1254.8754662181252, -939.6601093853099, -102.16944408104628, -689.6209739272787, -763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627972410857521, "mean_inference_ms": 1.674043213292824, "mean_action_processing_ms": 0.2784846708975024, "mean_env_wait_ms": 3.427293095433056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013432741165161133, "StateBufferConnector_ms": 0.008712053298950195, "ViewRequirementAgentConnector_ms": 0.199005126953125}, "num_episodes": 31, "episode_return_max": -42.83153804042189, "episode_return_min": -1388.0152565803076, "episode_return_mean": -790.106634695914, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.25063780962677, "num_env_steps_trained_throughput_per_sec": 352.25063780962677, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12568.025, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12567.956, "sample_time_ms": 1112.127, "learn_time_ms": 11389.577, "learn_throughput": 351.198, "synch_weights_time_ms": 65.465}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00000", "date": "2024-08-04_07-23-10", "timestamp": 1722736390, "time_this_iter_s": 11.369805574417114, "time_total_s": 62.90702414512634, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9968e1360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.90702414512634, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.84375, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.32946975429851, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.3536946538214882, "policy_loss": -0.004555489048652816, "vf_loss": 1.3560241522888343, "vf_explained_var": 0.9852182139952977, "kl": 0.011827849337684413, "entropy": 1.3958210137983162, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -11.766042154383012, "episode_reward_min": -1388.0152565803076, "episode_reward_mean": -760.63389378972, "episode_len_mean": 130.85, "episode_media": {}, "episodes_timesteps_total": 13085, "policy_reward_min": {"policy_0": -1388.0152565803076}, "policy_reward_max": {"policy_0": -11.766042154383012}, "policy_reward_mean": {"policy_0": -760.63389378972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743], "episode_lengths": [150, 77, 150, 96, 150, 150, 56, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 90, 150, 128, 150, 150, 77, 95, 150, 150, 150, 145, 150, 150, 150, 75, 105, 56, 69, 150, 150, 131, 150, 93, 148, 150, 150, 150, 98, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 61, 150, 150, 150, 133, 150, 64, 150, 150, 150, 46, 150, 76, 150, 150, 150, 150, 150, 150, 71, 32, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 86, 150, 150, 44, 150], "policy_policy_0_reward": [-763.1201378950544, -160.69198197669513, -1014.1411817651577, -382.871645388587, -770.1065040337936, -1130.3924209255078, -141.09291312831013, -718.4377256583458, -603.0355713235164, -1200.917292677532, -1388.0152565803076, -821.6782559395144, -692.3441343363319, -111.22098550564355, -1007.840868721158, -996.6687813334672, -1345.7781071915877, -1270.045797938136, -955.9292255764414, -672.4974402837214, -231.11928887316347, -863.988785806117, -487.0075599788192, -1158.00088755938, -986.3183640342531, -276.96529598286213, -390.42473127960676, -934.8964031050218, -692.7414442093828, -1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630075116541867, "mean_inference_ms": 1.6777629594510275, "mean_action_processing_ms": 0.2794237403490301, "mean_env_wait_ms": 3.435578365822918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013164520263671875, "StateBufferConnector_ms": 0.008718252182006836, "ViewRequirementAgentConnector_ms": 0.19893717765808105}, "num_episodes": 34, "episode_return_max": -11.766042154383012, "episode_return_min": -1388.0152565803076, "episode_return_mean": -760.63389378972, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.9800263754081, "num_env_steps_trained_throughput_per_sec": 310.9800263754081, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12617.117, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12617.049, "sample_time_ms": 1110.646, "learn_time_ms": 11437.872, "learn_throughput": 349.715, "synch_weights_time_ms": 67.749}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00000", "date": "2024-08-04_07-23-23", "timestamp": 1722736403, "time_this_iter_s": 12.87520956993103, "time_total_s": 75.78223371505737, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680d5a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.78223371505737, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 28.010526315789477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.28838375508786, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0879649301680425, "policy_loss": -0.00762640916412541, "vf_loss": 1.09360627848655, "vf_explained_var": 0.9838530189047258, "kl": 0.010612722585475846, "entropy": 1.3748275899638733, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -11.766042154383012, "episode_reward_min": -1434.959824235422, "episode_reward_mean": -754.8323175110021, "episode_len_mean": 131.41, "episode_media": {}, "episodes_timesteps_total": 13141, "policy_reward_min": {"policy_0": -1434.959824235422}, "policy_reward_max": {"policy_0": -11.766042154383012}, "policy_reward_mean": {"policy_0": -754.8323175110021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917], "episode_lengths": [150, 145, 150, 150, 150, 75, 105, 56, 69, 150, 150, 131, 150, 93, 148, 150, 150, 150, 98, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 61, 150, 150, 150, 133, 150, 64, 150, 150, 150, 46, 150, 76, 150, 150, 150, 150, 150, 150, 71, 32, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 86, 150, 150, 44, 150, 139, 150, 150, 150, 97, 150, 95, 150, 150, 150, 150, 66, 150, 150, 131, 150, 150, 68, 150, 150, 150, 136, 150, 150, 89, 52, 150, 150, 150], "policy_policy_0_reward": [-1365.5836935897228, -513.4113268805013, -1256.6098990690793, -773.3629205372498, -991.6669071482555, -284.1780611824577, -350.7935815893933, -48.418924673431626, -134.40064562849128, -875.2183874872857, -1250.3007263627555, -590.530569638371, -1030.2660599248293, -392.00776412939035, -485.020405687568, -567.3199549298818, -1107.9979041111653, -889.9991403714606, -373.321657345215, -871.5676329688918, -127.9811727085131, -930.1465529038632, -1133.075314796642, -1160.0621143984565, -995.8958465650337, -1050.4439878181709, -1111.2925825578202, -1324.9235597883137, -901.4298023631279, -775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625496549671855, "mean_inference_ms": 1.6812884901793856, "mean_action_processing_ms": 0.2796516898288287, "mean_env_wait_ms": 3.438050848023139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012937545776367188, "StateBufferConnector_ms": 0.008450746536254883, "ViewRequirementAgentConnector_ms": 0.18996834754943848}, "num_episodes": 29, "episode_return_max": -11.766042154383012, "episode_return_min": -1434.959824235422, "episode_return_mean": -754.8323175110021, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.917891323552, "num_env_steps_trained_throughput_per_sec": 304.917891323552, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12688.714, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12688.647, "sample_time_ms": 1122.253, "learn_time_ms": 11497.488, "learn_throughput": 347.902, "synch_weights_time_ms": 68.127}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00000", "date": "2024-08-04_07-23-36", "timestamp": 1722736416, "time_this_iter_s": 13.13132357597351, "time_total_s": 88.91355729103088, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.91355729103088, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.572222222222226, "ram_util_percent": 28.044444444444448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.01206406454244, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9826157323705653, "policy_loss": -0.005243655797191119, "vf_loss": 0.9860464616678655, "vf_explained_var": 0.9837544299662113, "kl": 0.009763556060715934, "entropy": 1.3978952986498674, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -11.766042154383012, "episode_reward_min": -1434.959824235422, "episode_reward_mean": -728.6274582362471, "episode_len_mean": 131.64, "episode_media": {}, "episodes_timesteps_total": 13164, "policy_reward_min": {"policy_0": -1434.959824235422}, "policy_reward_max": {"policy_0": -11.766042154383012}, "policy_reward_mean": {"policy_0": -728.6274582362471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748], "episode_lengths": [150, 116, 150, 150, 61, 150, 150, 150, 133, 150, 64, 150, 150, 150, 46, 150, 76, 150, 150, 150, 150, 150, 150, 71, 32, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 86, 150, 150, 44, 150, 139, 150, 150, 150, 97, 150, 95, 150, 150, 150, 150, 66, 150, 150, 131, 150, 150, 68, 150, 150, 150, 136, 150, 150, 89, 52, 150, 150, 150, 124, 70, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 48, 56, 150, 150, 145, 150, 108, 150, 150, 106, 150], "policy_policy_0_reward": [-775.8057782547521, -369.63512215200706, -760.9515580153209, -995.4809834049096, -176.56992769921143, -1008.8922123394915, -822.4794391696771, -555.897950937238, -729.9519409324757, -510.6615831153266, -204.0546742564566, -1091.1812569276076, -966.1817493381493, -968.0962130314313, -17.727022415248, -1031.4365001512376, -195.02433764151868, -1058.1845138906824, -1133.040439195422, -1276.956253974279, -1047.1977134347208, -796.8579370671081, -769.0932962657848, -160.10775599695134, -11.766042154383012, -918.3860851342268, -569.9143536516216, -821.4191680207481, -983.6909944972048, -1054.6904856762017, -903.9608895786475, -690.2839267868571, -1033.0746327725587, -717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618812832713819, "mean_inference_ms": 1.680556006333951, "mean_action_processing_ms": 0.2789694601324885, "mean_env_wait_ms": 3.4333913360441297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531042098999023, "StateBufferConnector_ms": 0.00822591781616211, "ViewRequirementAgentConnector_ms": 0.188063383102417}, "num_episodes": 29, "episode_return_max": -11.766042154383012, "episode_return_min": -1434.959824235422, "episode_return_mean": -728.6274582362471, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.7594609593215, "num_env_steps_trained_throughput_per_sec": 313.7594609593215, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12696.204, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12696.135, "sample_time_ms": 1117.48, "learn_time_ms": 11508.864, "learn_throughput": 347.558, "synch_weights_time_ms": 69.014}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00000", "date": "2024-08-04_07-23-49", "timestamp": 1722736429, "time_this_iter_s": 12.760828971862793, "time_total_s": 101.67438626289368, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9968e1360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.67438626289368, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.822222222222223, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.7870595216751, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2068072754889727, "policy_loss": -0.005961681114179858, "vf_loss": 1.211003570817411, "vf_explained_var": 0.9865197195361058, "kl": 0.009515333255649239, "entropy": 1.3767835746208827, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -36.4821184774294, "episode_reward_min": -1434.959824235422, "episode_reward_mean": -737.8245202018355, "episode_len_mean": 131.35, "episode_media": {}, "episodes_timesteps_total": 13135, "policy_reward_min": {"policy_0": -1434.959824235422}, "policy_reward_max": {"policy_0": -36.4821184774294}, "policy_reward_mean": {"policy_0": -737.8245202018355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923], "episode_lengths": [150, 150, 90, 150, 86, 150, 150, 44, 150, 139, 150, 150, 150, 97, 150, 95, 150, 150, 150, 150, 66, 150, 150, 131, 150, 150, 68, 150, 150, 150, 136, 150, 150, 89, 52, 150, 150, 150, 124, 70, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 48, 56, 150, 150, 145, 150, 108, 150, 150, 106, 150, 150, 150, 150, 99, 85, 93, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 48, 150, 150, 150, 150, 150, 41, 122, 150, 150, 59, 56, 150], "policy_policy_0_reward": [-717.4507570738847, -1355.351287351589, -346.72138674605657, -726.0908549153675, -259.0394633800016, -990.8402571674185, -1040.6536332109984, -43.58351367040184, -1119.4894014140743, -601.0300570738009, -590.0800160012873, -873.6223985239683, -1434.959824235422, -435.2988015759592, -765.1329794098615, -274.3048656919625, -736.1130250955152, -1147.0467994246599, -891.828622137299, -643.8311210381199, -217.78778189072008, -964.2765510025877, -741.6489211692136, -627.2960632503625, -1161.8521212112653, -1140.727911566553, -136.7811974950415, -489.9036439393744, -861.8191886303764, -915.1365049736137, -414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5601411094332328, "mean_inference_ms": 1.679288417115263, "mean_action_processing_ms": 0.2777375932632229, "mean_env_wait_ms": 3.428399380939719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012386083602905273, "StateBufferConnector_ms": 0.007975578308105469, "ViewRequirementAgentConnector_ms": 0.18684101104736328}, "num_episodes": 33, "episode_return_max": -36.4821184774294, "episode_return_min": -1434.959824235422, "episode_return_mean": -737.8245202018355, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.5922362761939, "num_env_steps_trained_throughput_per_sec": 313.5922362761939, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12702.784, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12702.717, "sample_time_ms": 1116.44, "learn_time_ms": 11517.059, "learn_throughput": 347.311, "synch_weights_time_ms": 68.441}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00000", "date": "2024-08-04_07-24-02", "timestamp": 1722736442, "time_this_iter_s": 12.767741203308105, "time_total_s": 114.44212746620178, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.44212746620178, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.40526315789474, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.0117393354575, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9566073952553172, "policy_loss": -0.005207253785435266, "vf_loss": 0.9598323609369497, "vf_explained_var": 0.9912272420401375, "kl": 0.010585873655721426, "entropy": 1.3488504720230898, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -27.037500867897084, "episode_reward_min": -1416.482336779546, "episode_reward_mean": -749.908146261357, "episode_len_mean": 131.07, "episode_media": {}, "episodes_timesteps_total": 13107, "policy_reward_min": {"policy_0": -1416.482336779546}, "policy_reward_max": {"policy_0": -27.037500867897084}, "policy_reward_mean": {"policy_0": -749.908146261357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329], "episode_lengths": [136, 150, 150, 89, 52, 150, 150, 150, 124, 70, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 48, 56, 150, 150, 145, 150, 108, 150, 150, 106, 150, 150, 150, 150, 99, 85, 93, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 48, 150, 150, 150, 150, 150, 41, 122, 150, 150, 59, 56, 150, 150, 120, 150, 150, 90, 100, 68, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 50, 150, 150, 124, 49, 150, 150, 150, 150, 62, 150, 134], "policy_policy_0_reward": [-414.23734573664876, -779.5026465800778, -1222.3188274242384, -225.08923132067272, -114.37481955619079, -925.3516071941451, -904.024016660696, -1352.7544713259917, -577.5216860194752, -142.12825981234798, -1130.6053462176674, -625.6099799468374, -617.4121990825635, -776.7441605631714, -977.5703737593518, -912.3777719492374, -894.3774986978816, -778.5910985935129, -813.7100097952209, -1030.779814397306, -717.4160972783669, -704.928000295362, -831.3251150863147, -187.45224048532856, -856.6188682720995, -780.0814245363939, -36.4821184774294, -91.11610350777083, -1131.1666199436377, -504.2000797303189, -790.8726371408238, -1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593332322637123, "mean_inference_ms": 1.6751638617656028, "mean_action_processing_ms": 0.2771099926354865, "mean_env_wait_ms": 3.421895203153592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012480735778808594, "StateBufferConnector_ms": 0.007981538772583008, "ViewRequirementAgentConnector_ms": 0.18854069709777832}, "num_episodes": 30, "episode_return_max": -27.037500867897084, "episode_return_min": -1416.482336779546, "episode_return_mean": -749.908146261357, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.98007825394006, "num_env_steps_trained_throughput_per_sec": 310.98007825394006, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12718.763, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12718.695, "sample_time_ms": 1112.61, "learn_time_ms": 11535.815, "learn_throughput": 346.746, "synch_weights_time_ms": 69.452}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00000", "date": "2024-08-04_07-24-15", "timestamp": 1722736455, "time_this_iter_s": 12.874612808227539, "time_total_s": 127.31674027442932, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.31674027442932, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.505555555555553, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.78376348912715, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0093097225762904, "policy_loss": -0.006166270389803686, "vf_loss": 1.0134667315830788, "vf_explained_var": 0.987981011532247, "kl": 0.010681356327768305, "entropy": 1.270099319393436, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -12.29341085997893, "episode_reward_min": -1416.482336779546, "episode_reward_mean": -754.4876665034247, "episode_len_mean": 130.29, "episode_media": {}, "episodes_timesteps_total": 13029, "policy_reward_min": {"policy_0": -1416.482336779546}, "policy_reward_max": {"policy_0": -12.29341085997893}, "policy_reward_mean": {"policy_0": -754.4876665034247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952], "episode_lengths": [150, 108, 150, 150, 106, 150, 150, 150, 150, 99, 85, 93, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 48, 150, 150, 150, 150, 150, 41, 122, 150, 150, 59, 56, 150, 150, 120, 150, 150, 90, 100, 68, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 50, 150, 150, 124, 49, 150, 150, 150, 150, 62, 150, 134, 150, 150, 128, 150, 150, 150, 60, 112, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 62, 126, 62, 135, 96, 45, 150, 150, 140, 150, 150, 39, 150], "policy_policy_0_reward": [-1008.6744062565559, -280.2833577231798, -852.4162014160571, -631.8679423372599, -509.5458149867743, -1074.8659433715748, -1051.3541740137634, -836.1506838412423, -1383.5923179012702, -451.89396630122894, -160.934038414344, -187.33120913101286, -534.32920889661, -893.9008391827283, -821.3190855407229, -1002.1314855951218, -813.5427352884376, -1146.8972293047182, -1195.7903455527392, -1271.9162844344228, -870.8430830520213, -953.5251512516454, -1146.6902514820842, -369.8176154704924, -1180.8445915738148, -488.16413729964046, -40.709321596127985, -1280.7046681203049, -1111.303729420132, -1132.1532840254638, -1177.4094846673188, -908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583076077712927, "mean_inference_ms": 1.674168307757269, "mean_action_processing_ms": 0.2766399662818563, "mean_env_wait_ms": 3.421179675648823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012347221374511719, "StateBufferConnector_ms": 0.00803518295288086, "ViewRequirementAgentConnector_ms": 0.19035553932189941}, "num_episodes": 31, "episode_return_max": -12.29341085997893, "episode_return_min": -1416.482336779546, "episode_return_mean": -754.4876665034247, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.7487707090475, "num_env_steps_trained_throughput_per_sec": 309.7487707090475, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12750.908, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12750.839, "sample_time_ms": 1111.767, "learn_time_ms": 11568.526, "learn_throughput": 345.766, "synch_weights_time_ms": 69.73}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00000", "date": "2024-08-04_07-24-28", "timestamp": 1722736468, "time_this_iter_s": 12.924936771392822, "time_total_s": 140.24167704582214, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9968e1360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.24167704582214, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.78888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.5231483946244, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1354982536596556, "policy_loss": -0.0077371568627616705, "vf_loss": 1.1410609618450205, "vf_explained_var": 0.9850618535652756, "kl": 0.011559741938860202, "entropy": 1.3750099362184605, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -2.9868040408168484, "episode_reward_min": -1416.482336779546, "episode_reward_mean": -684.337953563761, "episode_len_mean": 126.48, "episode_media": {}, "episodes_timesteps_total": 12648, "policy_reward_min": {"policy_0": -1416.482336779546}, "policy_reward_max": {"policy_0": -2.9868040408168484}, "policy_reward_mean": {"policy_0": -684.337953563761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484], "episode_lengths": [150, 41, 122, 150, 150, 59, 56, 150, 150, 120, 150, 150, 90, 100, 68, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 50, 150, 150, 124, 49, 150, 150, 150, 150, 62, 150, 134, 150, 150, 128, 150, 150, 150, 60, 112, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 62, 126, 62, 135, 96, 45, 150, 150, 140, 150, 150, 39, 150, 150, 72, 150, 150, 150, 98, 150, 150, 150, 150, 150, 93, 36, 150, 38, 141, 150, 150, 87, 150, 150, 117, 117, 150, 150, 150, 67, 150, 150, 90, 38], "policy_policy_0_reward": [-908.2734824312178, -72.41478676106561, -316.57881567196705, -947.6649703660421, -1040.7696721712175, -61.35181840046661, -143.11332987535673, -334.9431374035923, -1098.8197289152833, -319.0492524586233, -1179.5129621257154, -1014.0901652780976, -283.04450993369215, -157.364267216292, -215.48960826606094, -776.3730426952466, -1330.620492791014, -656.8482234332785, -1036.9241452721703, -1163.5560516357475, -644.3675646728435, -988.2550872343663, -1322.7615061957856, -735.6208583154405, -851.986232657817, -836.8491323531962, -103.7265559416141, -878.1747874295564, -1416.482336779546, -472.43970629436393, -27.037500867897084, -715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575426155823441, "mean_inference_ms": 1.6720607670769823, "mean_action_processing_ms": 0.27616905334004366, "mean_env_wait_ms": 3.420851739398623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012308597564697266, "StateBufferConnector_ms": 0.008079290390014648, "ViewRequirementAgentConnector_ms": 0.19118452072143555}, "num_episodes": 31, "episode_return_max": -2.9868040408168484, "episode_return_min": -1416.482336779546, "episode_return_mean": -684.337953563761, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.60092850653695, "num_env_steps_trained_throughput_per_sec": 310.60092850653695, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12741.155, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12741.088, "sample_time_ms": 1113.869, "learn_time_ms": 11557.555, "learn_throughput": 346.094, "synch_weights_time_ms": 68.85}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00000", "date": "2024-08-04_07-24-41", "timestamp": 1722736481, "time_this_iter_s": 12.88968539237976, "time_total_s": 153.1313624382019, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.1313624382019, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.94463291366895, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7261022751530012, "policy_loss": -0.0067165091042018805, "vf_loss": 0.7310128741121541, "vf_explained_var": 0.9901981070637703, "kl": 0.009767270545520053, "entropy": 1.4754356825103363, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -2.9868040408168484, "episode_reward_min": -1386.067401525583, "episode_reward_mean": -710.4396614907032, "episode_len_mean": 130.45, "episode_media": {}, "episodes_timesteps_total": 13045, "policy_reward_min": {"policy_0": -1386.067401525583}, "policy_reward_max": {"policy_0": -2.9868040408168484}, "policy_reward_mean": {"policy_0": -710.4396614907032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154], "episode_lengths": [150, 150, 150, 150, 62, 150, 134, 150, 150, 128, 150, 150, 150, 60, 112, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 62, 126, 62, 135, 96, 45, 150, 150, 140, 150, 150, 39, 150, 150, 72, 150, 150, 150, 98, 150, 150, 150, 150, 150, 93, 36, 150, 38, 141, 150, 150, 87, 150, 150, 117, 117, 150, 150, 150, 67, 150, 150, 90, 38, 150, 150, 133, 91, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 114, 46, 150, 150, 150, 150, 150, 150, 129, 100, 150, 150, 150, 81, 150, 150, 150], "policy_policy_0_reward": [-715.2291350352112, -1243.30235233531, -1064.6531777019088, -935.9721195637231, -64.27273423302768, -1164.2910599337167, -760.947258652329, -1109.6612432593192, -813.2930082594122, -564.5374325684113, -1180.4634966999788, -1386.067401525583, -1079.2660974004596, -155.6079161138183, -309.59017564814525, -1154.962139093935, -688.962375158318, -241.20512582981723, -1190.24290869549, -1236.8632021227413, -859.1836708872682, -902.1459681164852, -1102.1766364203859, -978.163335136544, -549.6564732648953, -75.7843558413439, -468.1660503575145, -195.69890150325386, -315.87397667227367, -183.11239805935577, -66.58556152549878, -880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565973557623679, "mean_inference_ms": 1.6698847604358773, "mean_action_processing_ms": 0.2756246232102979, "mean_env_wait_ms": 3.4185676293439995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012139320373535156, "StateBufferConnector_ms": 0.007927894592285156, "ViewRequirementAgentConnector_ms": 0.19008946418762207}, "num_episodes": 31, "episode_return_max": -2.9868040408168484, "episode_return_min": -1386.067401525583, "episode_return_mean": -710.4396614907032, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.6941782456419, "num_env_steps_trained_throughput_per_sec": 340.6941782456419, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12637.664, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12637.595, "sample_time_ms": 1110.588, "learn_time_ms": 11457.727, "learn_throughput": 349.109, "synch_weights_time_ms": 68.458}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00000", "date": "2024-08-04_07-24-52", "timestamp": 1722736492, "time_this_iter_s": 11.752872228622437, "time_total_s": 164.88423466682434, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bd000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.88423466682434, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.31176470588235, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.29356446564196, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9900080047547817, "policy_loss": -0.002817575403605588, "vf_loss": 0.9906681086557607, "vf_explained_var": 0.9811656794200341, "kl": 0.011485531704480915, "entropy": 1.3963292978703976, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -2.9868040408168484, "episode_reward_min": -1345.2041256801137, "episode_reward_mean": -675.3597498693313, "episode_len_mean": 128.06, "episode_media": {}, "episodes_timesteps_total": 12806, "policy_reward_min": {"policy_0": -1345.2041256801137}, "policy_reward_max": {"policy_0": -2.9868040408168484}, "policy_reward_mean": {"policy_0": -675.3597498693313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646], "episode_lengths": [150, 150, 140, 150, 150, 39, 150, 150, 72, 150, 150, 150, 98, 150, 150, 150, 150, 150, 93, 36, 150, 38, 141, 150, 150, 87, 150, 150, 117, 117, 150, 150, 150, 67, 150, 150, 90, 38, 150, 150, 133, 91, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 114, 46, 150, 150, 150, 150, 150, 150, 129, 100, 150, 150, 150, 81, 150, 150, 150, 150, 43, 149, 150, 150, 150, 150, 150, 91, 150, 49, 71, 83, 150, 150, 150, 107, 150, 150, 150, 96, 115, 150, 117, 150, 51, 150, 89, 52, 103, 150], "policy_policy_0_reward": [-880.8506667207473, -810.1614257862686, -681.2374908890351, -1030.5594762824658, -1031.426184711531, -12.29341085997893, -1050.8939881835952, -863.3593721611868, -237.66218857021315, -1202.6691000149563, -775.7259561797761, -838.3143946685519, -337.3484856154031, -809.0645563654905, -772.5343531736972, -896.6153792302306, -955.3168657196446, -645.0145991756557, -218.52019115795622, -9.490181927804564, -826.9571209954295, -17.239811728297965, -705.2295914573662, -833.254360329045, -1276.3863176902482, -141.16657934320352, -607.9129265255132, -1106.9940097860856, -258.687768825867, -597.5424739271352, -907.4169645968622, -561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564630331365685, "mean_inference_ms": 1.6691401613847487, "mean_action_processing_ms": 0.27511216747371936, "mean_env_wait_ms": 3.4145936169934803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012147188186645508, "StateBufferConnector_ms": 0.008011579513549805, "ViewRequirementAgentConnector_ms": 0.19157791137695312}, "num_episodes": 31, "episode_return_max": -2.9868040408168484, "episode_return_min": -1345.2041256801137, "episode_return_mean": -675.3597498693313, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1355958943716, "num_env_steps_trained_throughput_per_sec": 314.1355958943716, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12596.916, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12596.846, "sample_time_ms": 1104.909, "learn_time_ms": 11422.893, "learn_throughput": 350.174, "synch_weights_time_ms": 68.184}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00000", "date": "2024-08-04_07-25-05", "timestamp": 1722736505, "time_this_iter_s": 12.74507212638855, "time_total_s": 177.6293067932129, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bdc60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.6293067932129, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.644444444444442, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.7123097807169, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8887321274727583, "policy_loss": -0.004999274077999871, "vf_loss": 0.8915780649210016, "vf_explained_var": 0.9908089793597659, "kl": 0.011493719390227853, "entropy": 1.454071222494046, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -2.9868040408168484, "episode_reward_min": -1406.2265165717656, "episode_reward_mean": -671.1529761832544, "episode_len_mean": 129.08, "episode_media": {}, "episodes_timesteps_total": 12908, "policy_reward_min": {"policy_0": -1406.2265165717656}, "policy_reward_max": {"policy_0": -2.9868040408168484}, "policy_reward_mean": {"policy_0": -671.1529761832544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656], "episode_lengths": [150, 150, 67, 150, 150, 90, 38, 150, 150, 133, 91, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 114, 46, 150, 150, 150, 150, 150, 150, 129, 100, 150, 150, 150, 81, 150, 150, 150, 150, 43, 149, 150, 150, 150, 150, 150, 91, 150, 49, 71, 83, 150, 150, 150, 107, 150, 150, 150, 96, 115, 150, 117, 150, 51, 150, 89, 52, 103, 150, 150, 132, 150, 150, 150, 150, 150, 150, 74, 150, 77, 150, 150, 88, 150, 150, 149, 150, 44, 150, 150, 72, 150, 150, 61, 150, 150, 141, 92, 150, 150], "policy_policy_0_reward": [-561.6545493381354, -508.4524604275814, -131.50377354845, -675.8856126778055, -739.290792557053, -385.7337517269643, -2.9868040408168484, -924.1461869892681, -506.40816329844466, -488.51666671893395, -252.6064905624493, -906.7346793561172, -1065.5054226555933, -954.2135598856983, -1269.6291143672981, -990.6667070751829, -572.6725547330194, -944.6645236979398, -893.3468598679863, -607.9219376688424, -1038.0144737184667, -313.9228577457785, -28.70233158072222, -880.2208911056796, -1244.574178127735, -1089.6169682214536, -793.1981058933991, -462.9247540369031, -1345.2041256801137, -638.848563879726, -243.22142752117276, -902.318444696569, -1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556144940505776, "mean_inference_ms": 1.6669729567511258, "mean_action_processing_ms": 0.2746905595388818, "mean_env_wait_ms": 3.4112250362261225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012127876281738281, "StateBufferConnector_ms": 0.007958173751831055, "ViewRequirementAgentConnector_ms": 0.19261670112609863}, "num_episodes": 31, "episode_return_max": -2.9868040408168484, "episode_return_min": -1406.2265165717656, "episode_return_mean": -671.1529761832544, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.85417202549036, "num_env_steps_trained_throughput_per_sec": 313.85417202549036, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12735.839, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12735.77, "sample_time_ms": 1104.076, "learn_time_ms": 11562.744, "learn_throughput": 345.939, "synch_weights_time_ms": 68.096}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00000", "date": "2024-08-04_07-25-18", "timestamp": 1722736518, "time_this_iter_s": 12.757300853729248, "time_total_s": 190.38660764694214, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.38660764694214, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.55, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.1993577281634, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9071542084372292, "policy_loss": -0.009810182525931547, "vf_loss": 0.9146419924683868, "vf_explained_var": 0.9934335956970851, "kl": 0.012363608862627492, "entropy": 1.5032515673587719, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -28.81825532945016, "episode_reward_min": -1406.2265165717656, "episode_reward_mean": -689.9973156175948, "episode_len_mean": 128.74, "episode_media": {}, "episodes_timesteps_total": 12874, "policy_reward_min": {"policy_0": -1406.2265165717656}, "policy_reward_max": {"policy_0": -28.81825532945016}, "policy_reward_mean": {"policy_0": -689.9973156175948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373], "episode_lengths": [150, 150, 81, 150, 150, 150, 150, 43, 149, 150, 150, 150, 150, 150, 91, 150, 49, 71, 83, 150, 150, 150, 107, 150, 150, 150, 96, 115, 150, 117, 150, 51, 150, 89, 52, 103, 150, 150, 132, 150, 150, 150, 150, 150, 150, 74, 150, 77, 150, 150, 88, 150, 150, 149, 150, 44, 150, 150, 72, 150, 150, 61, 150, 150, 141, 92, 150, 150, 150, 71, 150, 54, 150, 87, 150, 103, 150, 150, 150, 150, 150, 128, 82, 150, 150, 150, 150, 142, 150, 102, 150, 150, 150, 106, 150, 150, 110, 62, 150, 150], "policy_policy_0_reward": [-1116.6538546272345, -892.7897759434094, -131.1076839210978, -984.7357277149634, -901.804692981589, -559.7828002660154, -941.6451661023741, -28.81825532945016, -877.2396146253399, -788.6504408730046, -870.362008877713, -674.1728218968434, -961.9233322129044, -999.4557366636647, -306.1753883993565, -745.9737194909047, -31.77296775631329, -256.3487233448305, -338.68141065174393, -888.6517363247283, -762.2485774144492, -905.4123151149615, -507.20140956778795, -872.3830154434611, -797.8263092602449, -973.5989223916221, -192.54149777926503, -392.1203573617611, -875.4950369490227, -302.08316457944056, -1044.2372329745033, -136.16250824513645, -1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559626894665374, "mean_inference_ms": 1.6676599460524084, "mean_action_processing_ms": 0.2747422818653, "mean_env_wait_ms": 3.4134879162894185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011919498443603516, "StateBufferConnector_ms": 0.00798177719116211, "ViewRequirementAgentConnector_ms": 0.1956462860107422}, "num_episodes": 32, "episode_return_max": -28.81825532945016, "episode_return_min": -1406.2265165717656, "episode_return_mean": -689.9973156175948, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.64591292726504, "num_env_steps_trained_throughput_per_sec": 304.64591292726504, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12762.582, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12762.51, "sample_time_ms": 1115.572, "learn_time_ms": 11579.623, "learn_throughput": 345.434, "synch_weights_time_ms": 66.459}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00000", "date": "2024-08-04_07-25-31", "timestamp": 1722736531, "time_this_iter_s": 13.14347219467163, "time_total_s": 203.53007984161377, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bdea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.53007984161377, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.526315789473685, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.66317966183027, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7887842503376306, "policy_loss": -0.008583019264915493, "vf_loss": 0.7948070195503533, "vf_explained_var": 0.990412134801348, "kl": 0.01358144649730093, "entropy": 1.5603751963625352, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -23.25720080103236, "episode_reward_min": -1406.2265165717656, "episode_reward_mean": -712.3528993376921, "episode_len_mean": 129.38, "episode_media": {}, "episodes_timesteps_total": 12938, "policy_reward_min": {"policy_0": -1406.2265165717656}, "policy_reward_max": {"policy_0": -23.25720080103236}, "policy_reward_mean": {"policy_0": -712.3528993376921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873], "episode_lengths": [150, 89, 52, 103, 150, 150, 132, 150, 150, 150, 150, 150, 150, 74, 150, 77, 150, 150, 88, 150, 150, 149, 150, 44, 150, 150, 72, 150, 150, 61, 150, 150, 141, 92, 150, 150, 150, 71, 150, 54, 150, 87, 150, 103, 150, 150, 150, 150, 150, 128, 82, 150, 150, 150, 150, 142, 150, 102, 150, 150, 150, 106, 150, 150, 110, 62, 150, 150, 150, 76, 150, 150, 137, 87, 41, 150, 150, 150, 150, 150, 150, 144, 126, 150, 150, 87, 87, 43, 150, 105, 150, 150, 150, 89, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-1034.1138694185686, -318.9011748543641, -93.49436636877702, -268.3128222840838, -1061.942622921646, -406.8603600446768, -700.9830466476051, -965.3945859614699, -601.2647895065038, -528.687995355927, -1153.7454367230941, -1005.2364183894341, -583.1932691991409, -133.419612859047, -670.3462781362483, -293.2875636228424, -914.1369260465267, -792.4760838731421, -204.0450648875522, -1028.258637285855, -669.1178837980968, -574.7638581424204, -835.7078143266291, -33.18842325182028, -970.1855918866831, -965.351605496926, -250.72972790120437, -562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556602298019075, "mean_inference_ms": 1.6664414761966482, "mean_action_processing_ms": 0.27465684789328737, "mean_env_wait_ms": 3.4168289442035853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011723995208740234, "StateBufferConnector_ms": 0.008130311965942383, "ViewRequirementAgentConnector_ms": 0.19575858116149902}, "num_episodes": 32, "episode_return_max": -23.25720080103236, "episode_return_min": -1406.2265165717656, "episode_return_mean": -712.3528993376921, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.1952763285797, "num_env_steps_trained_throughput_per_sec": 326.1952763285797, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12677.013, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12676.94, "sample_time_ms": 1105.729, "learn_time_ms": 11503.948, "learn_throughput": 347.707, "synch_weights_time_ms": 66.403}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00000", "date": "2024-08-04_07-25-43", "timestamp": 1722736543, "time_this_iter_s": 12.274905920028687, "time_total_s": 215.80498576164246, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680e560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 215.80498576164246, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.27647058823529, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.31456300715605, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7149111615649114, "policy_loss": -0.011057298902596813, "vf_loss": 0.7229552844694506, "vf_explained_var": 0.9967281555756926, "kl": 0.015819722303103845, "entropy": 1.5076618363459906, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.25720080103236, "episode_reward_min": -1406.2265165717656, "episode_reward_mean": -739.8846687488211, "episode_len_mean": 131.37, "episode_media": {}, "episodes_timesteps_total": 13137, "policy_reward_min": {"policy_0": -1406.2265165717656}, "policy_reward_max": {"policy_0": -23.25720080103236}, "policy_reward_mean": {"policy_0": -739.8846687488211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214], "episode_lengths": [150, 150, 61, 150, 150, 141, 92, 150, 150, 150, 71, 150, 54, 150, 87, 150, 103, 150, 150, 150, 150, 150, 128, 82, 150, 150, 150, 150, 142, 150, 102, 150, 150, 150, 106, 150, 150, 110, 62, 150, 150, 150, 76, 150, 150, 137, 87, 41, 150, 150, 150, 150, 150, 150, 144, 126, 150, 150, 87, 87, 43, 150, 105, 150, 150, 150, 89, 150, 150, 150, 150, 95, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 146, 150, 150, 93, 150, 150, 68, 96, 150, 150, 150, 150, 68, 91, 150, 70, 150, 150], "policy_policy_0_reward": [-562.5651327456958, -813.6162125239889, -90.65536107987646, -1083.4448521715883, -899.3057710207099, -811.2530668519347, -108.91670134461049, -860.8042363385273, -1406.2265165717656, -824.6576884713087, -63.641452904889306, -1079.1732305125954, -144.55563101714253, -1193.7821023206466, -127.99118677148616, -1291.166096533871, -319.6414831986962, -927.4621772458569, -1138.2020796533143, -1290.908262048382, -798.2636386606822, -846.2473093547574, -334.5686301458979, -345.4002350478467, -823.083999440017, -880.8382416670362, -1080.4523729200791, -784.7572251194763, -875.9605012942221, -1175.6125870655576, -257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556564508259442, "mean_inference_ms": 1.66490887607557, "mean_action_processing_ms": 0.2744574341949361, "mean_env_wait_ms": 3.417107027075105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01164555549621582, "StateBufferConnector_ms": 0.008072853088378906, "ViewRequirementAgentConnector_ms": 0.19457221031188965}, "num_episodes": 27, "episode_return_max": -23.25720080103236, "episode_return_min": -1406.2265165717656, "episode_return_mean": -739.8846687488211, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.27395900337683, "num_env_steps_trained_throughput_per_sec": 309.27395900337683, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12695.503, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12695.43, "sample_time_ms": 1107.47, "learn_time_ms": 11520.097, "learn_throughput": 347.219, "synch_weights_time_ms": 66.994}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00000", "date": "2024-08-04_07-25-56", "timestamp": 1722736556, "time_this_iter_s": 12.946563243865967, "time_total_s": 228.75154900550842, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 228.75154900550842, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.41578947368421, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.89022443294525, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.6712722163181752, "policy_loss": -0.009616803240108614, "vf_loss": 0.6780831735270719, "vf_explained_var": 0.9957165771474441, "kl": 0.014756401840622857, "entropy": 1.4543708379069964, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -23.25720080103236, "episode_reward_min": -1389.7754705326195, "episode_reward_mean": -709.160910918857, "episode_len_mean": 129.57, "episode_media": {}, "episodes_timesteps_total": 12957, "policy_reward_min": {"policy_0": -1389.7754705326195}, "policy_reward_max": {"policy_0": -23.25720080103236}, "policy_reward_mean": {"policy_0": -709.160910918857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452], "episode_lengths": [102, 150, 150, 150, 106, 150, 150, 110, 62, 150, 150, 150, 76, 150, 150, 137, 87, 41, 150, 150, 150, 150, 150, 150, 144, 126, 150, 150, 87, 87, 43, 150, 105, 150, 150, 150, 89, 150, 150, 150, 150, 95, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 146, 150, 150, 93, 150, 150, 68, 96, 150, 150, 150, 150, 68, 91, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 115, 51, 110, 150, 36, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 39, 95, 150, 150, 150, 43, 150, 59, 150], "policy_policy_0_reward": [-257.45800070222276, -1033.7409709656793, -815.5927517879127, -1389.7754705326195, -365.226421738473, -1093.6977824547062, -894.0341448506423, -465.7410164283784, -110.49153767021598, -730.3391290676436, -745.2783192431373, -1366.4106603890098, -97.03364269151, -1384.0922510184605, -925.104149523734, -385.57584067213503, -368.74402515397423, -23.25720080103236, -563.0424783882266, -1131.2141519750412, -738.5258382730674, -778.8241194285029, -496.3557701853315, -1089.064247250392, -523.3752951550116, -574.9203780943765, -1000.8999335713997, -1132.1287367497969, -173.96974405123748, -214.06011761579737, -94.78578574426317, -1125.1363899008109, -251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554927158450819, "mean_inference_ms": 1.6680394668486878, "mean_action_processing_ms": 0.2745445795369755, "mean_env_wait_ms": 3.424490220328416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011997699737548828, "StateBufferConnector_ms": 0.008082866668701172, "ViewRequirementAgentConnector_ms": 0.1968824863433838}, "num_episodes": 30, "episode_return_max": -23.25720080103236, "episode_return_min": -1389.7754705326195, "episode_return_mean": -709.160910918857, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.84693319576957, "num_env_steps_trained_throughput_per_sec": 300.84693319576957, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12749.541, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12749.468, "sample_time_ms": 1118.303, "learn_time_ms": 11563.416, "learn_throughput": 345.919, "synch_weights_time_ms": 66.88}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00000", "date": "2024-08-04_07-26-10", "timestamp": 1722736570, "time_this_iter_s": 13.30848217010498, "time_total_s": 242.0600311756134, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.0600311756134, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.844444444444445, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.89055002431076, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7913334481573353, "policy_loss": -0.016503230939269996, "vf_loss": 0.8051818076521158, "vf_explained_var": 0.998223212485512, "kl": 0.014042865531034003, "entropy": 1.537004966288805, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -10.727635057901898, "episode_reward_min": -1436.4719233176543, "episode_reward_mean": -756.3299699736766, "episode_len_mean": 130.9, "episode_media": {}, "episodes_timesteps_total": 13090, "policy_reward_min": {"policy_0": -1436.4719233176543}, "policy_reward_max": {"policy_0": -10.727635057901898}, "policy_reward_mean": {"policy_0": -756.3299699736766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373], "episode_lengths": [105, 150, 150, 150, 89, 150, 150, 150, 150, 95, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 146, 150, 150, 93, 150, 150, 68, 96, 150, 150, 150, 150, 68, 91, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 115, 51, 110, 150, 36, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 39, 95, 150, 150, 150, 43, 150, 59, 150, 150, 150, 83, 150, 150, 150, 61, 74, 79, 150, 150, 150, 109, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 135, 150, 73, 150, 150, 150], "policy_policy_0_reward": [-251.13343166747205, -1068.515572275835, -1155.8434380945068, -955.8278098282216, -295.3519912013703, -852.7134605773637, -774.7034309146566, -1039.3328030862076, -1109.0531604130117, -390.9687561654012, -1213.6499662376873, -1195.5408246409834, -817.5401738294556, -977.3425976047075, -594.7286896349883, -984.0873088687811, -747.4505560018657, -700.3308235879165, -855.470236599672, -1265.3705351649398, -385.16560182328965, -871.3287354712111, -1329.7726317596482, -407.60873028525316, -665.3193693753556, -1064.6330466134261, -200.53021061182852, -268.3007306443949, -593.6616074927915, -1004.5370700603067, -960.8630556660644, -480.7555283470586, -161.79168235077552, -269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555492806683686, "mean_inference_ms": 1.6680841787555847, "mean_action_processing_ms": 0.2747183772538762, "mean_env_wait_ms": 3.427484919986341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012102603912353516, "StateBufferConnector_ms": 0.008059024810791016, "ViewRequirementAgentConnector_ms": 0.19983768463134766}, "num_episodes": 32, "episode_return_max": -10.727635057901898, "episode_return_min": -1436.4719233176543, "episode_return_mean": -756.3299699736766, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4876193781267, "num_env_steps_trained_throughput_per_sec": 300.4876193781267, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12794.454, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12794.383, "sample_time_ms": 1121.886, "learn_time_ms": 11607.169, "learn_throughput": 344.615, "synch_weights_time_ms": 64.5}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00000", "date": "2024-08-04_07-26-23", "timestamp": 1722736583, "time_this_iter_s": 13.32340383529663, "time_total_s": 255.38343501091003, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bcf70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.38343501091003, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.315789473684212, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.38571485678355, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8174904506032665, "policy_loss": -0.012428348819472983, "vf_loss": 0.8272900116319458, "vf_explained_var": 0.9979336991285285, "kl": 0.013906880712359772, "entropy": 1.525893027211229, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -10.727635057901898, "episode_reward_min": -1436.4719233176543, "episode_reward_mean": -697.3791579636927, "episode_len_mean": 126.65, "episode_media": {}, "episodes_timesteps_total": 12665, "policy_reward_min": {"policy_0": -1436.4719233176543}, "policy_reward_max": {"policy_0": -10.727635057901898}, "policy_reward_mean": {"policy_0": -697.3791579636927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373, -1088.818583139514, -331.10117294164894, -146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114], "episode_lengths": [91, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 115, 51, 110, 150, 36, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 39, 95, 150, 150, 150, 43, 150, 59, 150, 150, 150, 83, 150, 150, 150, 61, 74, 79, 150, 150, 150, 109, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 135, 150, 73, 150, 150, 150, 150, 138, 82, 150, 150, 150, 150, 150, 150, 150, 150, 61, 133, 150, 150, 52, 150, 150, 150, 99, 52, 72, 81, 67, 150, 64, 150, 71, 150, 114, 150, 150, 146], "policy_policy_0_reward": [-269.6853073103055, -1006.06865503885, -129.38564860339508, -932.2548694579993, -940.7985434579214, -530.6985590588883, -1050.2740594506313, -617.9200422815952, -1083.9919973044032, -560.0489006554546, -747.6291288501432, -240.56399012559868, -138.5833367901796, -386.9720428427035, -970.2562567196361, -34.705324123578194, -735.2981055597535, -539.534280154404, -939.7502731983749, -195.06953306960725, -666.5330806582971, -1100.5266563089763, -967.6828960075259, -1299.0241519928577, -956.8692208705222, -1248.5799028289487, -56.52413773450025, -392.9304246658739, -1168.8631537982437, -1071.5160828519358, -955.4387603269244, -39.289593633533556, -643.4537064919177, -58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373, -1088.818583139514, -331.10117294164894, -146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555542664276774, "mean_inference_ms": 1.670372495661789, "mean_action_processing_ms": 0.27524370294810463, "mean_env_wait_ms": 3.432808028138732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214146614074707, "StateBufferConnector_ms": 0.008198022842407227, "ViewRequirementAgentConnector_ms": 0.201171875}, "num_episodes": 33, "episode_return_max": -10.727635057901898, "episode_return_min": -1436.4719233176543, "episode_return_mean": -697.3791579636927, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4146174552831, "num_env_steps_trained_throughput_per_sec": 303.4146174552831, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12821.413, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12821.342, "sample_time_ms": 1126.382, "learn_time_ms": 11629.222, "learn_throughput": 343.961, "synch_weights_time_ms": 64.91}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00000", "date": "2024-08-04_07-26-36", "timestamp": 1722736596, "time_this_iter_s": 13.196928024291992, "time_total_s": 268.580363035202, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.580363035202, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.410526315789472, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.6584456274907, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9542368967706959, "policy_loss": -0.007725810805762497, "vf_loss": 0.9591124099058409, "vf_explained_var": 0.996083919207255, "kl": 0.014988515378960699, "entropy": 1.474069515367349, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -10.727635057901898, "episode_reward_min": -1436.4719233176543, "episode_reward_mean": -664.6069547303197, "episode_len_mean": 124.1, "episode_media": {}, "episodes_timesteps_total": 12410, "policy_reward_min": {"policy_0": -1436.4719233176543}, "policy_reward_max": {"policy_0": -10.727635057901898}, "policy_reward_mean": {"policy_0": -664.6069547303197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373, -1088.818583139514, -331.10117294164894, -146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657], "episode_lengths": [59, 150, 150, 150, 83, 150, 150, 150, 61, 74, 79, 150, 150, 150, 109, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 135, 150, 73, 150, 150, 150, 150, 138, 82, 150, 150, 150, 150, 150, 150, 150, 150, 61, 133, 150, 150, 52, 150, 150, 150, 99, 52, 72, 81, 67, 150, 64, 150, 71, 150, 114, 150, 150, 146, 150, 96, 150, 150, 82, 51, 91, 150, 150, 150, 82, 73, 150, 150, 92, 150, 49, 76, 150, 150, 150, 150, 117, 121, 113, 150, 101, 150, 150, 46, 136, 52, 150], "policy_policy_0_reward": [-58.530503414576984, -513.720097276452, -1436.4719233176543, -1143.494870332038, -217.62580205597783, -1337.4169765422473, -619.9338474899654, -1407.7097679806268, -86.00038035875521, -252.85017337046955, -264.0544793356808, -1200.5700719020083, -1287.3743414858955, -1171.4006444193774, -298.2460988647452, -1032.7994029270028, -851.0571857405713, -188.2851606738769, -1099.0419392731505, -1390.9869107633547, -1236.758587370569, -1394.7409058542519, -1055.2792686483144, -853.8886956306054, -1328.1853216805664, -10.727635057901898, -1375.0407402406067, -643.8679930752056, -433.5589455211418, -697.7618381607193, -68.78829403266322, -942.1867063077221, -1074.0041491657373, -404.69314997730373, -1088.818583139514, -331.10117294164894, -146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555512977105638, "mean_inference_ms": 1.6694827466872928, "mean_action_processing_ms": 0.2753300900771914, "mean_env_wait_ms": 3.431129374558793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012178897857666016, "StateBufferConnector_ms": 0.008228778839111328, "ViewRequirementAgentConnector_ms": 0.1978466510772705}, "num_episodes": 33, "episode_return_max": -10.727635057901898, "episode_return_min": -1436.4719233176543, "episode_return_mean": -664.6069547303197, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.75226123557184, "num_env_steps_trained_throughput_per_sec": 304.75226123557184, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12846.129, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12846.056, "sample_time_ms": 1127.03, "learn_time_ms": 11652.168, "learn_throughput": 343.284, "synch_weights_time_ms": 66.029}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00000", "date": "2024-08-04_07-26-50", "timestamp": 1722736610, "time_this_iter_s": 13.137137174606323, "time_total_s": 281.71750020980835, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.71750020980835, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.273684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.99816860655943, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8951908728418251, "policy_loss": -0.012086774969066027, "vf_loss": 0.9041499407961965, "vf_explained_var": 0.9978324631229043, "kl": 0.016345430069789776, "entropy": 1.4137581458936135, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -36.77511261375602, "episode_reward_min": -1299.3124068100667, "episode_reward_mean": -581.3846915998927, "episode_len_mean": 119.18, "episode_media": {}, "episodes_timesteps_total": 11918, "policy_reward_min": {"policy_0": -1299.3124068100667}, "policy_reward_max": {"policy_0": -36.77511261375602}, "policy_reward_mean": {"policy_0": -581.3846915998927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054], "episode_lengths": [82, 150, 150, 150, 150, 150, 150, 150, 150, 61, 133, 150, 150, 52, 150, 150, 150, 99, 52, 72, 81, 67, 150, 64, 150, 71, 150, 114, 150, 150, 146, 150, 96, 150, 150, 82, 51, 91, 150, 150, 150, 82, 73, 150, 150, 92, 150, 49, 76, 150, 150, 150, 150, 117, 121, 113, 150, 101, 150, 150, 46, 136, 52, 150, 75, 150, 150, 64, 150, 88, 81, 98, 150, 83, 76, 133, 68, 82, 150, 104, 150, 150, 150, 150, 97, 150, 150, 150, 150, 46, 59, 150, 68, 79, 117, 150, 150, 78, 150, 150], "policy_policy_0_reward": [-146.02762186356668, -621.553127503174, -772.1985295963943, -679.8633806690427, -1299.3124068100667, -718.2625974242667, -1268.6962442890356, -1116.3852065225137, -799.997520219473, -60.9560808143542, -333.61391480430416, -936.4289651379132, -343.64063283569476, -98.0525401739046, -808.9917283942651, -1110.3283491382138, -1126.1297569443202, -450.8512010029014, -58.426316946303785, -140.5557042534127, -166.42477600553505, -101.19651515962718, -472.56417589752425, -118.0405948133842, -819.2436290493159, -256.69636711430695, -1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548466314708791, "mean_inference_ms": 1.6684376664006149, "mean_action_processing_ms": 0.2746987110099075, "mean_env_wait_ms": 3.431347366951517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012030363082885742, "StateBufferConnector_ms": 0.008053064346313477, "ViewRequirementAgentConnector_ms": 0.1942579746246338}, "num_episodes": 36, "episode_return_max": -36.77511261375602, "episode_return_min": -1299.3124068100667, "episode_return_mean": -581.3846915998927, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.991049608012, "num_env_steps_trained_throughput_per_sec": 305.991049608012, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12979.283, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12979.211, "sample_time_ms": 1126.055, "learn_time_ms": 11786.159, "learn_throughput": 339.381, "synch_weights_time_ms": 66.173}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00000", "date": "2024-08-04_07-27-03", "timestamp": 1722736623, "time_this_iter_s": 13.084585905075073, "time_total_s": 294.8020861148834, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bf760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.8020861148834, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.305263157894736, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.70450340211391, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8274219208241751, "policy_loss": -0.0078193770221939, "vf_loss": 0.8319664877528946, "vf_explained_var": 0.9949772313858072, "kl": 0.017108582137802843, "entropy": 1.4690588988363742, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -36.77511261375602, "episode_reward_min": -1499.102395605888, "episode_reward_mean": -624.4040566600316, "episode_len_mean": 123.07, "episode_media": {}, "episodes_timesteps_total": 12307, "policy_reward_min": {"policy_0": -1499.102395605888}, "policy_reward_max": {"policy_0": -36.77511261375602}, "policy_reward_mean": {"policy_0": -624.4040566600316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371], "episode_lengths": [150, 114, 150, 150, 146, 150, 96, 150, 150, 82, 51, 91, 150, 150, 150, 82, 73, 150, 150, 92, 150, 49, 76, 150, 150, 150, 150, 117, 121, 113, 150, 101, 150, 150, 46, 136, 52, 150, 75, 150, 150, 64, 150, 88, 81, 98, 150, 83, 76, 133, 68, 82, 150, 104, 150, 150, 150, 150, 97, 150, 150, 150, 150, 46, 59, 150, 68, 79, 117, 150, 150, 78, 150, 150, 76, 150, 111, 150, 150, 150, 150, 118, 150, 150, 92, 104, 150, 149, 150, 150, 150, 150, 150, 103, 150, 150, 74, 150, 96, 150], "policy_policy_0_reward": [-1130.3915031142806, -303.5721328617655, -1219.3801746820861, -466.53683277546054, -379.90408300049114, -1223.9701398653474, -182.34604743141165, -501.6982086996797, -1197.872166297534, -132.61109572076913, -137.88077946996074, -243.91395851731275, -620.904347271451, -1151.641875481303, -1130.7562847295135, -197.74130768024347, -89.5010233886756, -1211.0943497910728, -622.9715927907775, -161.63162584724535, -761.3910478249085, -36.77511261375602, -169.00394043668382, -505.93627170177496, -1068.1531346941279, -854.935322313291, -718.285288372357, -500.57148762189223, -377.1726414874589, -291.92404994801706, -1004.2472901789208, -438.8582674087974, -915.4271447404521, -1085.6093205069628, -77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549629385915941, "mean_inference_ms": 1.6684341063129347, "mean_action_processing_ms": 0.27471678720878373, "mean_env_wait_ms": 3.4314987763107827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011957645416259766, "StateBufferConnector_ms": 0.007979154586791992, "ViewRequirementAgentConnector_ms": 0.19519567489624023}, "num_episodes": 26, "episode_return_max": -36.77511261375602, "episode_return_min": -1499.102395605888, "episode_return_mean": -624.4040566600316, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9841489977179, "num_env_steps_trained_throughput_per_sec": 307.9841489977179, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13004.715, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13004.643, "sample_time_ms": 1130.744, "learn_time_ms": 11805.863, "learn_throughput": 338.815, "synch_weights_time_ms": 67.241}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00000", "date": "2024-08-04_07-27-16", "timestamp": 1722736636, "time_this_iter_s": 13.000808954238892, "time_total_s": 307.8028950691223, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bd090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.8028950691223, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.744444444444444, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.1620496312777, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7818358683337768, "policy_loss": -0.006515242975243988, "vf_loss": 0.7853076893836259, "vf_explained_var": 0.9953044567878048, "kl": 0.015965691356238192, "entropy": 1.4971411310136318, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -25.816393801653675, "episode_reward_min": -1499.102395605888, "episode_reward_mean": -623.2517778710884, "episode_len_mean": 124.02, "episode_media": {}, "episodes_timesteps_total": 12402, "policy_reward_min": {"policy_0": -1499.102395605888}, "policy_reward_max": {"policy_0": -25.816393801653675}, "policy_reward_mean": {"policy_0": -623.2517778710884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612], "episode_lengths": [46, 136, 52, 150, 75, 150, 150, 64, 150, 88, 81, 98, 150, 83, 76, 133, 68, 82, 150, 104, 150, 150, 150, 150, 97, 150, 150, 150, 150, 46, 59, 150, 68, 79, 117, 150, 150, 78, 150, 150, 76, 150, 111, 150, 150, 150, 150, 118, 150, 150, 92, 104, 150, 149, 150, 150, 150, 150, 150, 103, 150, 150, 74, 150, 96, 150, 150, 86, 54, 150, 150, 150, 150, 150, 82, 96, 93, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 103, 150, 90, 150, 150, 150, 47, 148, 150, 118, 150], "policy_policy_0_reward": [-77.98098785658182, -460.24797961648875, -68.57510833574331, -1197.871100245657, -150.42961348550838, -1090.8102893391333, -1115.1403618601162, -137.00118268239297, -535.3284320012891, -235.3797484074486, -190.51300589563778, -366.09952494692203, -479.98449245781325, -260.39117530745807, -147.310213256314, -420.60045949634116, -151.04909304601256, -259.6008021919931, -753.7696562360592, -457.4949161443765, -1215.098933430194, -744.301222630718, -1099.1701179904755, -430.1988593856148, -222.43547549302028, -1100.4491072953108, -431.5820745254872, -832.0103842732476, -1238.0518914204786, -99.6208792380803, -65.9472403919843, -1155.6533126718532, -102.56001930802253, -292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549258294134467, "mean_inference_ms": 1.667681098309694, "mean_action_processing_ms": 0.27458585813043274, "mean_env_wait_ms": 3.432944334006769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011542320251464844, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.19334125518798828}, "num_episodes": 34, "episode_return_max": -25.816393801653675, "episode_return_min": -1499.102395605888, "episode_return_mean": -623.2517778710884, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.55545606785904, "num_env_steps_trained_throughput_per_sec": 316.55545606785904, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12993.84, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12993.766, "sample_time_ms": 1132.074, "learn_time_ms": 11794.19, "learn_throughput": 339.15, "synch_weights_time_ms": 66.699}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00000", "date": "2024-08-04_07-27-28", "timestamp": 1722736648, "time_this_iter_s": 12.648744344711304, "time_total_s": 320.4516394138336, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964be7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.4516394138336, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.91111111111111, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.48562237024308, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.881098470526437, "policy_loss": -0.00970597288881739, "vf_loss": 0.8878605213016272, "vf_explained_var": 0.9975864769890904, "kl": 0.015447233543727634, "entropy": 1.4552429307252168, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -25.816393801653675, "episode_reward_min": -1499.102395605888, "episode_reward_mean": -657.7566810292676, "episode_len_mean": 127.12, "episode_media": {}, "episodes_timesteps_total": 12712, "policy_reward_min": {"policy_0": -1499.102395605888}, "policy_reward_max": {"policy_0": -25.816393801653675}, "policy_reward_mean": {"policy_0": -657.7566810292676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817], "episode_lengths": [79, 117, 150, 150, 78, 150, 150, 76, 150, 111, 150, 150, 150, 150, 118, 150, 150, 92, 104, 150, 149, 150, 150, 150, 150, 150, 103, 150, 150, 74, 150, 96, 150, 150, 86, 54, 150, 150, 150, 150, 150, 82, 96, 93, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 103, 150, 90, 150, 150, 150, 47, 148, 150, 118, 150, 147, 150, 150, 150, 150, 150, 98, 150, 150, 57, 44, 89, 69, 150, 95, 67, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 69, 59, 49, 103, 150, 150, 150], "policy_policy_0_reward": [-292.61098189235355, -360.7009394274155, -1122.0163863337748, -1003.8398946476897, -109.13854883151413, -1058.2986331027469, -1040.1583822414054, -133.55073896204794, -903.6328954688139, -370.60164614768894, -1490.4873306286022, -814.6372550011615, -812.3877318591047, -459.12540046899295, -606.6272544979144, -1260.384810175923, -984.7930696126018, -141.94625645512485, -342.5590269365807, -872.7451867754991, -574.4717252745293, -587.8088609717623, -1499.102395605888, -965.6367206928106, -879.0845289920475, -839.294169085863, -271.940150216718, -928.0780784642134, -784.3256092798574, -165.36169560914453, -1181.037208206683, -192.99707926669257, -1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545589574664984, "mean_inference_ms": 1.667229287221235, "mean_action_processing_ms": 0.27459441434843646, "mean_env_wait_ms": 3.4342672123703295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011635541915893555, "StateBufferConnector_ms": 0.008148908615112305, "ViewRequirementAgentConnector_ms": 0.19470429420471191}, "num_episodes": 33, "episode_return_max": -25.816393801653675, "episode_return_min": -1499.102395605888, "episode_return_mean": -657.7566810292676, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.7114147779381, "num_env_steps_trained_throughput_per_sec": 309.7114147779381, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12972.365, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12972.292, "sample_time_ms": 1120.581, "learn_time_ms": 11783.723, "learn_throughput": 339.451, "synch_weights_time_ms": 67.172}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00000", "date": "2024-08-04_07-27-41", "timestamp": 1722736661, "time_this_iter_s": 12.926737546920776, "time_total_s": 333.3783769607544, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964be830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.3783769607544, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.457894736842103, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.59290395875772, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9837167016851406, "policy_loss": -0.0069255290295889916, "vf_loss": 0.987346447010835, "vf_explained_var": 0.9867537902047236, "kl": 0.01717712224205269, "entropy": 1.3963856323311725, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -25.816393801653675, "episode_reward_min": -1406.5947843766085, "episode_reward_mean": -635.9517041216826, "episode_len_mean": 127.32, "episode_media": {}, "episodes_timesteps_total": 12732, "policy_reward_min": {"policy_0": -1406.5947843766085}, "policy_reward_max": {"policy_0": -25.816393801653675}, "policy_reward_mean": {"policy_0": -635.9517041216826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952], "episode_lengths": [150, 150, 86, 54, 150, 150, 150, 150, 150, 82, 96, 93, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 103, 150, 90, 150, 150, 150, 47, 148, 150, 118, 150, 147, 150, 150, 150, 150, 150, 98, 150, 150, 57, 44, 89, 69, 150, 95, 67, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 69, 59, 49, 103, 150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 45, 65, 150, 103, 150, 150, 150, 74, 150, 150, 150, 96, 150, 150, 105, 76, 150, 150, 126, 150, 107, 150, 150, 150, 150], "policy_policy_0_reward": [-1063.7575647404371, -322.95796090719114, -166.26729116393332, -63.06533385314175, -499.56305240963405, -675.5831768264518, -426.77494157219, -728.4641475520266, -1197.9834302370532, -354.8136626618274, -370.90906635660815, -221.75006915924152, -946.0136374094282, -134.24012896373054, -943.5080949677075, -920.0975571254764, -646.8739156183922, -1144.5312044545378, -46.018038329859564, -974.0970628846737, -916.0051512240675, -718.626483940461, -851.139109298388, -1176.906205223427, -480.9437086622395, -353.02182026267707, -371.72654342733813, -574.2020905415997, -1406.5947843766085, -928.050308284084, -25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541210879708613, "mean_inference_ms": 1.6679021500058573, "mean_action_processing_ms": 0.274635189197421, "mean_env_wait_ms": 3.4359728291573948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011511802673339844, "StateBufferConnector_ms": 0.00818490982055664, "ViewRequirementAgentConnector_ms": 0.19525551795959473}, "num_episodes": 32, "episode_return_max": -25.816393801653675, "episode_return_min": -1406.5947843766085, "episode_return_mean": -635.9517041216826, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8930208153726, "num_env_steps_trained_throughput_per_sec": 306.8930208153726, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 13049.492, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13049.417, "sample_time_ms": 1120.133, "learn_time_ms": 11862.147, "learn_throughput": 337.207, "synch_weights_time_ms": 66.269}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00000", "date": "2024-08-04_07-27-55", "timestamp": 1722736675, "time_this_iter_s": 13.046414375305176, "time_total_s": 346.42479133605957, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 346.42479133605957, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.633333333333333, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.87898376087347, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.929337656404823, "policy_loss": -0.008685734717679831, "vf_loss": 0.9357570649745564, "vf_explained_var": 0.9968353892366092, "kl": 0.012087435599490466, "entropy": 1.5116222477207581, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -25.816393801653675, "episode_reward_min": -1439.2241552416483, "episode_reward_mean": -637.1097804370601, "episode_len_mean": 125.81, "episode_media": {}, "episodes_timesteps_total": 12581, "policy_reward_min": {"policy_0": -1439.2241552416483}, "policy_reward_max": {"policy_0": -25.816393801653675}, "policy_reward_mean": {"policy_0": -637.1097804370601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952, -510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895], "episode_lengths": [47, 148, 150, 118, 150, 147, 150, 150, 150, 150, 150, 98, 150, 150, 57, 44, 89, 69, 150, 95, 67, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 69, 59, 49, 103, 150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 45, 65, 150, 103, 150, 150, 150, 74, 150, 150, 150, 96, 150, 150, 105, 76, 150, 150, 126, 150, 107, 150, 150, 150, 150, 150, 124, 150, 85, 150, 150, 149, 109, 64, 150, 104, 150, 75, 150, 150, 140, 150, 150, 146, 45, 150, 43, 150, 150, 150, 68, 150, 150, 33, 150], "policy_policy_0_reward": [-25.816393801653675, -559.365476039006, -979.4442245549768, -268.90129287215433, -525.1266054096612, -713.0605749067277, -450.8366256944851, -862.1868144620702, -1225.6745188980544, -1281.452934748189, -730.2501511499088, -213.5411304796205, -941.869042236829, -1053.128356717214, -88.11268667500285, -104.26599211809321, -197.15482373078063, -113.19200255688168, -1129.3058338964393, -154.14573274503, -248.84809236989832, -730.2278152852155, -574.5149377981502, -679.4530742366838, -709.8841653980968, -1294.6459322424146, -1061.617523993456, -991.9750895415538, -858.23848568971, -143.82928737872916, -1324.6791824857635, -239.99504225019695, -54.60249942241045, -55.533937680281205, -282.63821955810823, -812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952, -510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537939692520935, "mean_inference_ms": 1.667691225842747, "mean_action_processing_ms": 0.2744335930640267, "mean_env_wait_ms": 3.437020097197022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011983394622802734, "StateBufferConnector_ms": 0.008234024047851562, "ViewRequirementAgentConnector_ms": 0.19788503646850586}, "num_episodes": 30, "episode_return_max": -25.816393801653675, "episode_return_min": -1439.2241552416483, "episode_return_mean": -637.1097804370601, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.60012237160765, "num_env_steps_trained_throughput_per_sec": 308.60012237160765, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13052.316, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13052.241, "sample_time_ms": 1142.088, "learn_time_ms": 11844.911, "learn_throughput": 337.698, "synch_weights_time_ms": 64.377}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00000", "date": "2024-08-04_07-28-08", "timestamp": 1722736688, "time_this_iter_s": 12.974966764450073, "time_total_s": 359.39975810050964, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.39975810050964, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.39473684210526, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.39093058506647, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7994403400924057, "policy_loss": -0.0076687718731894465, "vf_loss": 0.8044070104757944, "vf_explained_var": 0.997679112230738, "kl": 0.014252425336386924, "entropy": 1.4838292704274256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -17.909440004871087, "episode_reward_min": -1439.2241552416483, "episode_reward_mean": -619.683045294045, "episode_len_mean": 125.21, "episode_media": {}, "episodes_timesteps_total": 12521, "policy_reward_min": {"policy_0": -1439.2241552416483}, "policy_reward_max": {"policy_0": -17.909440004871087}, "policy_reward_mean": {"policy_0": -619.683045294045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952, -510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895, -810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165], "episode_lengths": [150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 45, 65, 150, 103, 150, 150, 150, 74, 150, 150, 150, 96, 150, 150, 105, 76, 150, 150, 126, 150, 107, 150, 150, 150, 150, 150, 124, 150, 85, 150, 150, 149, 109, 64, 150, 104, 150, 75, 150, 150, 140, 150, 150, 146, 45, 150, 43, 150, 150, 150, 68, 150, 150, 33, 150, 150, 150, 150, 150, 42, 84, 115, 150, 71, 93, 150, 150, 116, 150, 43, 150, 150, 150, 67, 150, 150, 88, 43, 150, 150, 62, 150, 150, 135, 106, 65, 150, 150, 58, 81], "policy_policy_0_reward": [-812.9274318083433, -708.7340934158971, -712.6259451114817, -634.2036423440603, -745.8158587406479, -354.7797122522521, -706.7301214425954, -727.5271390517623, -863.9411695102699, -685.5222143560761, -42.47736275861265, -60.84718094748216, -685.4344337089999, -253.26910272596223, -1097.1722779863694, -899.5103625531056, -950.575232687772, -118.7649134549953, -1012.2156366381017, -781.9505816683986, -792.7451757176162, -236.527703947681, -938.0114361112882, -843.3484332188217, -292.9878029278955, -137.11839299194932, -566.1934494485163, -1223.2104456466018, -721.0015763749683, -1027.1288003304473, -241.91656108754697, -1253.5601834630213, -1064.9406941962854, -372.0787952358573, -537.3765068486952, -510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895, -810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537416417063915, "mean_inference_ms": 1.6687162474103692, "mean_action_processing_ms": 0.27462462622152845, "mean_env_wait_ms": 3.4365220445415705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011948823928833008, "StateBufferConnector_ms": 0.008172273635864258, "ViewRequirementAgentConnector_ms": 0.19731473922729492}, "num_episodes": 35, "episode_return_max": -17.909440004871087, "episode_return_min": -1439.2241552416483, "episode_return_mean": -619.683045294045, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.1984227439885, "num_env_steps_trained_throughput_per_sec": 334.1984227439885, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12919.63, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12919.554, "sample_time_ms": 1142.422, "learn_time_ms": 11711.627, "learn_throughput": 341.541, "synch_weights_time_ms": 64.633}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00000", "date": "2024-08-04_07-28-20", "timestamp": 1722736700, "time_this_iter_s": 11.98116135597229, "time_total_s": 371.38091945648193, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bd510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 371.38091945648193, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.023529411764706, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.60142447849114, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0576749450837573, "policy_loss": -0.00859741324384231, "vf_loss": 1.0628489396224419, "vf_explained_var": 0.9959082780405879, "kl": 0.017821416683803683, "entropy": 1.4086669214069842, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -12.997334508003542, "episode_reward_min": -1439.2241552416483, "episode_reward_mean": -605.2078369273462, "episode_len_mean": 121.01, "episode_media": {}, "episodes_timesteps_total": 12101, "policy_reward_min": {"policy_0": -1439.2241552416483}, "policy_reward_max": {"policy_0": -12.997334508003542}, "policy_reward_mean": {"policy_0": -605.2078369273462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895, -810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262], "episode_lengths": [150, 124, 150, 85, 150, 150, 149, 109, 64, 150, 104, 150, 75, 150, 150, 140, 150, 150, 146, 45, 150, 43, 150, 150, 150, 68, 150, 150, 33, 150, 150, 150, 150, 150, 42, 84, 115, 150, 71, 93, 150, 150, 116, 150, 43, 150, 150, 150, 67, 150, 150, 88, 43, 150, 150, 62, 150, 150, 135, 106, 65, 150, 150, 58, 81, 150, 150, 92, 150, 150, 150, 150, 135, 120, 150, 150, 150, 150, 95, 150, 150, 150, 83, 65, 54, 60, 45, 150, 66, 80, 52, 150, 150, 150, 150, 79, 150, 150, 71, 150], "policy_policy_0_reward": [-510.56353099356494, -610.145433162394, -675.0056825690484, -295.6184787686185, -1073.6407373475638, -1199.4287957115098, -395.7037287451548, -449.9261449490358, -91.87398421385474, -1156.8287216451934, -432.14359922843755, -430.42110398232967, -155.20736735984315, -974.6659414587346, -974.2989833649998, -448.18211158066845, -1419.2443042886366, -465.72187673916125, -435.0412989076226, -31.023017688905668, -814.9532662894751, -77.51830750199409, -1032.1576565921835, -1295.120796610847, -666.2591547884138, -109.33010219403022, -1439.2241552416483, -1133.8044825791403, -27.945830875488888, -919.2945785936895, -810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554033425281736, "mean_inference_ms": 1.6692678301567776, "mean_action_processing_ms": 0.2746781485583364, "mean_env_wait_ms": 3.4359379212293497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012212514877319336, "StateBufferConnector_ms": 0.008142471313476562, "ViewRequirementAgentConnector_ms": 0.19814753532409668}, "num_episodes": 35, "episode_return_max": -12.997334508003542, "episode_return_min": -1439.2241552416483, "episode_return_mean": -605.2078369273462, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0570423023134, "num_env_steps_trained_throughput_per_sec": 304.0570423023134, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12904.003, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12903.926, "sample_time_ms": 1154.458, "learn_time_ms": 11683.176, "learn_throughput": 342.373, "synch_weights_time_ms": 65.419}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00000", "date": "2024-08-04_07-28-33", "timestamp": 1722736713, "time_this_iter_s": 13.169384002685547, "time_total_s": 384.5503034591675, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.5503034591675, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.473684210526315, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.893544887503, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9874476662836968, "policy_loss": -0.011321762769269602, "vf_loss": 0.9954264437158903, "vf_explained_var": 0.9940564922988415, "kl": 0.017361332463625936, "entropy": 1.2928564733515182, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -12.997334508003542, "episode_reward_min": -1482.1652196360142, "episode_reward_mean": -591.1134845080163, "episode_len_mean": 120.02, "episode_media": {}, "episodes_timesteps_total": 12002, "policy_reward_min": {"policy_0": -1482.1652196360142}, "policy_reward_max": {"policy_0": -12.997334508003542}, "policy_reward_mean": {"policy_0": -591.1134845080163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009], "episode_lengths": [150, 150, 150, 150, 42, 84, 115, 150, 71, 93, 150, 150, 116, 150, 43, 150, 150, 150, 67, 150, 150, 88, 43, 150, 150, 62, 150, 150, 135, 106, 65, 150, 150, 58, 81, 150, 150, 92, 150, 150, 150, 150, 135, 120, 150, 150, 150, 150, 95, 150, 150, 150, 83, 65, 54, 60, 45, 150, 66, 80, 52, 150, 150, 150, 150, 79, 150, 150, 71, 150, 150, 150, 150, 150, 47, 150, 150, 75, 150, 67, 150, 60, 108, 150, 150, 150, 75, 150, 92, 150, 150, 150, 75, 150, 150, 150, 38, 150, 97, 52], "policy_policy_0_reward": [-810.6385413670995, -1339.469178696489, -993.4836206162264, -951.9258592451306, -93.77109396200699, -196.2439653358986, -294.69883734378203, -921.5043977198237, -87.48448906008609, -188.88529000125942, -572.3312262672956, -868.6682513224596, -241.9420451772166, -649.5292157172054, -17.909440004871087, -557.6751171800107, -1087.4412967898086, -1272.6150404079058, -123.46893377729839, -575.9324288084649, -560.3298201393, -370.8516341829992, -89.94350602939139, -660.7606102971436, -810.4095245573066, -59.26928106634857, -1021.7518105132496, -922.8489381474277, -435.7114956649294, -231.92977336877973, -213.16843608682464, -1072.5082544600352, -503.05982161698427, -152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540902031999936, "mean_inference_ms": 1.6880671310971629, "mean_action_processing_ms": 0.27490010304583196, "mean_env_wait_ms": 3.437124556409411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011828899383544922, "StateBufferConnector_ms": 0.007955789566040039, "ViewRequirementAgentConnector_ms": 0.1929464340209961}, "num_episodes": 30, "episode_return_max": -12.997334508003542, "episode_return_min": -1482.1652196360142, "episode_return_mean": -591.1134845080163, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.1238515959733, "num_env_steps_trained_throughput_per_sec": 328.1238515959733, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12804.727, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12804.649, "sample_time_ms": 1186.729, "learn_time_ms": 11552.975, "learn_throughput": 346.231, "synch_weights_time_ms": 64.07}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00000", "date": "2024-08-04_07-28-45", "timestamp": 1722736725, "time_this_iter_s": 12.203413248062134, "time_total_s": 396.7537167072296, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 396.7537167072296, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.052941176470586, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.04406452775, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8133839829203983, "policy_loss": -0.009544938062996758, "vf_loss": 0.8189806553535164, "vf_explained_var": 0.9965827589233717, "kl": 0.020361852367045703, "entropy": 1.241034946218133, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -12.997334508003542, "episode_reward_min": -1482.1652196360142, "episode_reward_mean": -599.9298793754533, "episode_len_mean": 120.62, "episode_media": {}, "episodes_timesteps_total": 12062, "policy_reward_min": {"policy_0": -1482.1652196360142}, "policy_reward_max": {"policy_0": -12.997334508003542}, "policy_reward_mean": {"policy_0": -599.9298793754533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009, -751.1876497419241, -403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275], "episode_lengths": [58, 81, 150, 150, 92, 150, 150, 150, 150, 135, 120, 150, 150, 150, 150, 95, 150, 150, 150, 83, 65, 54, 60, 45, 150, 66, 80, 52, 150, 150, 150, 150, 79, 150, 150, 71, 150, 150, 150, 150, 150, 47, 150, 150, 75, 150, 67, 150, 60, 108, 150, 150, 150, 75, 150, 92, 150, 150, 150, 75, 150, 150, 150, 38, 150, 97, 52, 150, 92, 150, 44, 64, 112, 150, 150, 150, 150, 150, 90, 150, 112, 150, 62, 150, 87, 92, 150, 150, 50, 62, 150, 64, 150, 150, 150, 150, 150, 150, 109, 150], "policy_policy_0_reward": [-152.101272533462, -174.5785372574165, -795.0987652717604, -722.5488601803451, -381.13235094327564, -1391.987403877325, -977.8933248750438, -732.8233556620053, -728.3424030175404, -396.6578252584249, -312.3128962975199, -1184.7969661190634, -750.5270120487423, -684.8363171049493, -1237.3973241419887, -217.10120605626182, -1243.5831369579364, -1207.786872306085, -1010.348308150713, -199.25273959748358, -208.66056441457656, -30.200453173202007, -71.94934857674012, -12.997334508003542, -699.2042886413743, -220.41726391116813, -233.26145772552175, -49.04487284433308, -987.4146389005209, -717.6730773366926, -597.9704377453237, -1147.922944271015, -167.7876615259154, -550.1225995714417, -805.0994126248296, -103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009, -751.1876497419241, -403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539481516605266, "mean_inference_ms": 1.7062146887312317, "mean_action_processing_ms": 0.27511972737322216, "mean_env_wait_ms": 3.434928255899812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183319091796875, "StateBufferConnector_ms": 0.008005857467651367, "ViewRequirementAgentConnector_ms": 0.19367361068725586}, "num_episodes": 33, "episode_return_max": -12.997334508003542, "episode_return_min": -1482.1652196360142, "episode_return_mean": -599.9298793754533, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.2864967113288, "num_env_steps_trained_throughput_per_sec": 301.2864967113288, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12819.825, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12819.748, "sample_time_ms": 1204.265, "learn_time_ms": 11551.318, "learn_throughput": 346.281, "synch_weights_time_ms": 63.287}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00000", "date": "2024-08-04_07-28-58", "timestamp": 1722736738, "time_this_iter_s": 13.290335655212402, "time_total_s": 410.044052362442, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 410.044052362442, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.400000000000006, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.16567811071872, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.8595197614748031, "policy_loss": -0.020219750236719847, "vf_loss": 0.8735711246728897, "vf_explained_var": 0.9981942210967342, "kl": 0.02098217465948743, "entropy": 1.2626616371174653, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -2.548973059094886, "episode_reward_min": -1482.1652196360142, "episode_reward_mean": -573.7754955105693, "episode_len_mean": 118.35, "episode_media": {}, "episodes_timesteps_total": 11835, "policy_reward_min": {"policy_0": -1482.1652196360142}, "policy_reward_max": {"policy_0": -2.548973059094886}, "policy_reward_mean": {"policy_0": -573.7754955105693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009, -751.1876497419241, -403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275, -156.41739777688244, -505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751], "episode_lengths": [71, 150, 150, 150, 150, 150, 47, 150, 150, 75, 150, 67, 150, 60, 108, 150, 150, 150, 75, 150, 92, 150, 150, 150, 75, 150, 150, 150, 38, 150, 97, 52, 150, 92, 150, 44, 64, 112, 150, 150, 150, 150, 150, 90, 150, 112, 150, 62, 150, 87, 92, 150, 150, 50, 62, 150, 64, 150, 150, 150, 150, 150, 150, 109, 150, 106, 107, 136, 73, 150, 44, 150, 150, 86, 150, 75, 60, 32, 78, 150, 150, 133, 80, 60, 150, 77, 150, 150, 88, 150, 150, 100, 150, 48, 150, 51, 150, 104, 150, 150], "policy_policy_0_reward": [-103.46375447534463, -878.0323559280262, -858.708600907848, -804.0282658404542, -1359.3220917191784, -1104.4930554030275, -72.58730629001693, -617.4219347667727, -850.8086831034773, -278.2568201246222, -792.0199630270309, -71.37198315802725, -673.5181365620045, -65.89242829926349, -265.1558238378982, -983.9607035332075, -1057.2808631083549, -498.7374247417889, -100.41109458802173, -1045.791180408153, -333.4464567381628, -678.4006345652533, -391.3965711759903, -612.5143225409465, -104.47088736712139, -672.977559105098, -1023.1947119829362, -1482.1652196360142, -24.881337651446046, -983.5702657792992, -451.9145093989773, -72.15909667881009, -751.1876497419241, -403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275, -156.41739777688244, -505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553627974562099, "mean_inference_ms": 1.7262152289268775, "mean_action_processing_ms": 0.27470451209566066, "mean_env_wait_ms": 3.434436392772349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011565923690795898, "StateBufferConnector_ms": 0.007968902587890625, "ViewRequirementAgentConnector_ms": 0.19193649291992188}, "num_episodes": 35, "episode_return_max": -2.548973059094886, "episode_return_min": -1482.1652196360142, "episode_return_mean": -573.7754955105693, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.0457732013323, "num_env_steps_trained_throughput_per_sec": 531.0457732013323, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12265.828, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12265.752, "sample_time_ms": 1215.767, "learn_time_ms": 10986.569, "learn_throughput": 364.081, "synch_weights_time_ms": 62.547}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00000", "date": "2024-08-04_07-29-06", "timestamp": 1722736746, "time_this_iter_s": 7.545926570892334, "time_total_s": 417.58997893333435, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9965104c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.58997893333435, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.845454545454544, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.9104213277499, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8414060308287541, "policy_loss": -0.016404044625232928, "vf_loss": 0.8503328843042255, "vf_explained_var": 0.9987410746514798, "kl": 0.01690259991482892, "entropy": 1.2897841412574054, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -2.548973059094886, "episode_reward_min": -1474.1035272939032, "episode_reward_mean": -588.8349593183415, "episode_len_mean": 120.59, "episode_media": {}, "episodes_timesteps_total": 12059, "policy_reward_min": {"policy_0": -1474.1035272939032}, "policy_reward_max": {"policy_0": -2.548973059094886}, "policy_reward_mean": {"policy_0": -588.8349593183415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275, -156.41739777688244, -505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751, -1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171], "episode_lengths": [92, 150, 44, 64, 112, 150, 150, 150, 150, 150, 90, 150, 112, 150, 62, 150, 87, 92, 150, 150, 50, 62, 150, 64, 150, 150, 150, 150, 150, 150, 109, 150, 106, 107, 136, 73, 150, 44, 150, 150, 86, 150, 75, 60, 32, 78, 150, 150, 133, 80, 60, 150, 77, 150, 150, 88, 150, 150, 100, 150, 48, 150, 51, 150, 104, 150, 150, 150, 150, 150, 150, 143, 51, 150, 150, 109, 150, 150, 150, 57, 39, 74, 150, 150, 150, 150, 150, 150, 117, 150, 88, 117, 150, 150, 150, 150, 62, 76, 150, 148], "policy_policy_0_reward": [-403.5633646319185, -1302.0885406149646, -86.212033732038, -219.06734841241806, -330.8460062615411, -1178.2031313225202, -990.0769549729703, -739.7613827373126, -621.1435601801891, -559.7107149647841, -218.39376260331548, -609.1556884680388, -203.2577546879236, -835.9024346527414, -102.7186449312007, -875.7767877933302, -200.60450942666512, -295.27780888716256, -1113.8317984906905, -648.2695834637116, -108.047314455291, -174.20673807252697, -575.9814394121911, -122.9999038106429, -1284.7471239520396, -824.4620162648339, -892.9465595621925, -897.5707223179487, -577.3213693815445, -805.0546688433595, -281.9795339332054, -849.4338106916275, -156.41739777688244, -505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751, -1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532944115779218, "mean_inference_ms": 1.7270229084116344, "mean_action_processing_ms": 0.27449542715320013, "mean_env_wait_ms": 3.435764681621066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011399030685424805, "StateBufferConnector_ms": 0.008041858673095703, "ViewRequirementAgentConnector_ms": 0.1941819190979004}, "num_episodes": 33, "episode_return_max": -2.548973059094886, "episode_return_min": -1474.1035272939032, "episode_return_mean": -588.8349593183415, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.19638498744905, "num_env_steps_trained_throughput_per_sec": 305.19638498744905, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12277.691, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12277.616, "sample_time_ms": 1210.048, "learn_time_ms": 11003.116, "learn_throughput": 363.533, "synch_weights_time_ms": 63.593}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00000", "date": "2024-08-04_07-29-19", "timestamp": 1722736759, "time_this_iter_s": 13.121370315551758, "time_total_s": 430.7113492488861, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 430.7113492488861, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.71666666666667, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.9005840887626, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9380577737775941, "policy_loss": -0.013012427414651029, "vf_loss": 0.945158133469522, "vf_explained_var": 0.9965810563415289, "kl": 0.01344383628961623, "entropy": 1.3765971494217715, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -2.548973059094886, "episode_reward_min": -1474.1035272939032, "episode_reward_mean": -591.2110334616449, "episode_len_mean": 120.37, "episode_media": {}, "episodes_timesteps_total": 12037, "policy_reward_min": {"policy_0": -1474.1035272939032}, "policy_reward_max": {"policy_0": -2.548973059094886}, "policy_reward_mean": {"policy_0": -591.2110334616449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751, -1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171, -477.46137001486636, -990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644], "episode_lengths": [107, 136, 73, 150, 44, 150, 150, 86, 150, 75, 60, 32, 78, 150, 150, 133, 80, 60, 150, 77, 150, 150, 88, 150, 150, 100, 150, 48, 150, 51, 150, 104, 150, 150, 150, 150, 150, 150, 143, 51, 150, 150, 109, 150, 150, 150, 57, 39, 74, 150, 150, 150, 150, 150, 150, 117, 150, 88, 117, 150, 150, 150, 150, 62, 76, 150, 148, 125, 150, 150, 150, 57, 95, 76, 53, 150, 75, 133, 150, 150, 113, 150, 46, 130, 119, 150, 150, 150, 106, 144, 150, 69, 150, 131, 109, 150, 150, 75, 150, 68], "policy_policy_0_reward": [-505.3126714889594, -312.4486312880013, -90.61118759857271, -724.1359907604032, -15.595004544099478, -821.3448607821476, -618.0533224814269, -316.4014088431055, -1019.4444585638291, -95.40732796007498, -57.98034055582685, -2.548973059094886, -228.63485073827349, -904.7853745843111, -1174.576530471086, -485.9060835985118, -118.18647440823914, -56.11650023309742, -1081.1509958477054, -111.59679771178226, -918.4606113722468, -970.6015477353213, -119.78829644236487, -1313.1650287779019, -1246.8297634530954, -369.2116573160079, -1431.1388835316698, -15.012937529149, -730.4434866500288, -143.50801100678424, -744.8495529680141, -193.70067493529828, -567.7706491131884, -724.2585628130751, -1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171, -477.46137001486636, -990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534336756645952, "mean_inference_ms": 1.726901663049653, "mean_action_processing_ms": 0.2741449392285238, "mean_env_wait_ms": 3.433798331540246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011462688446044922, "StateBufferConnector_ms": 0.00789785385131836, "ViewRequirementAgentConnector_ms": 0.1927661895751953}, "num_episodes": 33, "episode_return_max": -2.548973059094886, "episode_return_min": -1474.1035272939032, "episode_return_mean": -591.2110334616449, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9545822698635, "num_env_steps_trained_throughput_per_sec": 312.9545822698635, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12292.23, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12292.157, "sample_time_ms": 1211.761, "learn_time_ms": 11016.595, "learn_throughput": 363.089, "synch_weights_time_ms": 62.938}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00000", "date": "2024-08-04_07-29-32", "timestamp": 1722736772, "time_this_iter_s": 12.793010234832764, "time_total_s": 443.5043594837189, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bf5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.5043594837189, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.621052631578948, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.5436671535174, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.018658194101105, "policy_loss": -0.007892702542206583, "vf_loss": 1.0220374949276447, "vf_explained_var": 0.9922630796208978, "kl": 0.010353935156733012, "entropy": 1.4587076153606175, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -13.943999054106264, "episode_reward_min": -1474.1035272939032, "episode_reward_mean": -596.3277110128455, "episode_len_mean": 122.41, "episode_media": {}, "episodes_timesteps_total": 12241, "policy_reward_min": {"policy_0": -1474.1035272939032}, "policy_reward_max": {"policy_0": -13.943999054106264}, "policy_reward_mean": {"policy_0": -596.3277110128455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171, -477.46137001486636, -990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644, -1148.9502216261167, -644.7448727686406, -918.1807089558207, -317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825], "episode_lengths": [150, 150, 150, 150, 143, 51, 150, 150, 109, 150, 150, 150, 57, 39, 74, 150, 150, 150, 150, 150, 150, 117, 150, 88, 117, 150, 150, 150, 150, 62, 76, 150, 148, 125, 150, 150, 150, 57, 95, 76, 53, 150, 75, 133, 150, 150, 113, 150, 46, 130, 119, 150, 150, 150, 106, 144, 150, 69, 150, 131, 109, 150, 150, 75, 150, 68, 150, 150, 150, 105, 91, 150, 150, 105, 150, 60, 150, 150, 93, 79, 144, 135, 150, 150, 133, 43, 98, 150, 150, 113, 79, 150, 117, 42, 138, 75, 82, 126, 78, 150], "policy_policy_0_reward": [-1118.746789595102, -944.2718467887473, -445.3287675535512, -860.5758704603796, -498.4639028178531, -105.35779030942228, -850.452201495084, -307.421998866053, -372.1359288974729, -956.9188951832189, -1279.8973051506807, -1402.4740579584084, -43.07732369259912, -13.943999054106264, -104.37437797059378, -1151.53652788723, -602.9874089013159, -1310.9816513998217, -649.1017508411808, -1474.1035272939032, -385.33348341632933, -346.28944682971724, -615.000545748483, -243.91606785284776, -368.9517864488426, -813.3533071033517, -995.5812015841495, -417.66387832837745, -782.0387769640541, -117.62182844874987, -296.7695894153496, -1090.771622582732, -604.0446161220171, -477.46137001486636, -990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644, -1148.9502216261167, -644.7448727686406, -918.1807089558207, -317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533745045886231, "mean_inference_ms": 1.7245537669959026, "mean_action_processing_ms": 0.2738229631499134, "mean_env_wait_ms": 3.432316445959379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011338472366333008, "StateBufferConnector_ms": 0.007869720458984375, "ViewRequirementAgentConnector_ms": 0.19163107872009277}, "num_episodes": 34, "episode_return_max": -13.943999054106264, "episode_return_min": -1474.1035272939032, "episode_return_mean": -596.3277110128455, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.04770113818864, "num_env_steps_trained_throughput_per_sec": 302.04770113818864, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12324.999, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12324.926, "sample_time_ms": 1211.884, "learn_time_ms": 11048.935, "learn_throughput": 362.026, "synch_weights_time_ms": 63.262}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00000", "date": "2024-08-04_07-29-45", "timestamp": 1722736785, "time_this_iter_s": 13.255013465881348, "time_total_s": 456.7593729496002, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964be830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 456.7593729496002, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.688888888888886, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.14286619722844, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7810538110400861, "policy_loss": -0.015004394343607903, "vf_loss": 0.7902954829546313, "vf_explained_var": 0.9978114031876127, "kl": 0.013123806347069451, "entropy": 1.4299096162120501, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": 5.151942339089304, "episode_reward_min": -1389.5187665048295, "episode_reward_mean": -592.3292239313364, "episode_len_mean": 120.27, "episode_media": {}, "episodes_timesteps_total": 12027, "policy_reward_min": {"policy_0": -1389.5187665048295}, "policy_reward_max": {"policy_0": 5.151942339089304}, "policy_reward_mean": {"policy_0": -592.3292239313364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644, -1148.9502216261167, -644.7448727686406, -918.1807089558207, -317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825, -927.8778001109359, -674.8945879826223, -805.730198473142, -1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074], "episode_lengths": [150, 150, 150, 57, 95, 76, 53, 150, 75, 133, 150, 150, 113, 150, 46, 130, 119, 150, 150, 150, 106, 144, 150, 69, 150, 131, 109, 150, 150, 75, 150, 68, 150, 150, 150, 105, 91, 150, 150, 105, 150, 60, 150, 150, 93, 79, 144, 135, 150, 150, 133, 43, 98, 150, 150, 113, 79, 150, 117, 42, 138, 75, 82, 126, 78, 150, 150, 150, 150, 150, 78, 124, 150, 150, 150, 150, 118, 39, 150, 67, 150, 150, 150, 50, 97, 61, 31, 150, 150, 139, 90, 150, 101, 150, 52, 150, 95, 150, 150, 150], "policy_policy_0_reward": [-990.7112086710559, -1167.7980320959089, -890.1715911551519, -66.04252409247385, -141.61419265771997, -129.7212670157937, -70.16840551589247, -538.6260704493249, -113.60251710843647, -675.6292440857957, -1178.5528118632474, -943.5339630870571, -315.9686577074835, -645.3541641763001, -24.398906385075282, -352.60788506342686, -384.0420714529269, -742.1453949457754, -1077.7149092395591, -734.2685411035368, -280.11658864211375, -579.3280056669872, -730.6693384195912, -197.46215919917773, -1221.6916454876168, -307.759092223955, -300.26823748850416, -1203.708443808629, -1278.0294625777622, -240.03521381415905, -1214.6318710723026, -108.8040377524644, -1148.9502216261167, -644.7448727686406, -918.1807089558207, -317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825, -927.8778001109359, -674.8945879826223, -805.730198473142, -1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534488068405392, "mean_inference_ms": 1.723394683380552, "mean_action_processing_ms": 0.273758046692285, "mean_env_wait_ms": 3.4323910368194244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011570930480957031, "StateBufferConnector_ms": 0.007887601852416992, "ViewRequirementAgentConnector_ms": 0.1935868263244629}, "num_episodes": 34, "episode_return_max": 5.151942339089304, "episode_return_min": -1389.5187665048295, "episode_return_mean": -592.3292239313364, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5396068851059, "num_env_steps_trained_throughput_per_sec": 308.5396068851059, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12318.043, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12317.972, "sample_time_ms": 1213.276, "learn_time_ms": 11039.891, "learn_throughput": 362.322, "synch_weights_time_ms": 63.977}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00000", "date": "2024-08-04_07-29-58", "timestamp": 1722736798, "time_this_iter_s": 12.97671914100647, "time_total_s": 469.7360920906067, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bdcf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 469.7360920906067, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.36842105263158, "ram_util_percent": 28.105263157894743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.93771656354268, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7854224143239359, "policy_loss": -0.010250707735152294, "vf_loss": 0.7894578065723181, "vf_explained_var": 0.997698332555592, "kl": 0.014124273351202069, "entropy": 1.4061042481412491, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 5.151942339089304, "episode_reward_min": -1389.5187665048295, "episode_reward_mean": -566.7681006405865, "episode_len_mean": 117.73, "episode_media": {}, "episodes_timesteps_total": 11773, "policy_reward_min": {"policy_0": -1389.5187665048295}, "policy_reward_max": {"policy_0": 5.151942339089304}, "policy_reward_mean": {"policy_0": -566.7681006405865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825, -927.8778001109359, -674.8945879826223, -805.730198473142, -1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074, -571.992133047312, -591.0045939909019, -252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506], "episode_lengths": [105, 91, 150, 150, 105, 150, 60, 150, 150, 93, 79, 144, 135, 150, 150, 133, 43, 98, 150, 150, 113, 79, 150, 117, 42, 138, 75, 82, 126, 78, 150, 150, 150, 150, 150, 78, 124, 150, 150, 150, 150, 118, 39, 150, 67, 150, 150, 150, 50, 97, 61, 31, 150, 150, 139, 90, 150, 101, 150, 52, 150, 95, 150, 150, 150, 150, 150, 72, 42, 150, 150, 41, 150, 150, 150, 32, 72, 119, 150, 150, 46, 36, 106, 150, 147, 45, 56, 39, 150, 123, 150, 107, 112, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-317.90247893700956, -326.6159538499155, -1177.2864883512416, -1052.6986648249992, -297.52795673068493, -700.0946506951134, -31.84737886240683, -1062.4977974258268, -883.144668541308, -235.76410911179053, -192.70017256854112, -598.8079190127444, -447.34161187970346, -817.2180408165035, -936.1450354836467, -621.8583677085894, -25.890955395007627, -224.67010173134807, -640.5742787923502, -964.548424741617, -271.95040272502933, -152.6847148909412, -873.8450744962724, -470.26414930310654, -60.59395228622702, -866.9058243895358, -106.07465075577709, -173.98544658930686, -278.25048846642085, -178.60180018452462, -1040.4778413846825, -927.8778001109359, -674.8945879826223, -805.730198473142, -1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074, -571.992133047312, -591.0045939909019, -252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534372336445404, "mean_inference_ms": 1.721523924236442, "mean_action_processing_ms": 0.2736353597994636, "mean_env_wait_ms": 3.4367520953645396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011568307876586914, "StateBufferConnector_ms": 0.007870197296142578, "ViewRequirementAgentConnector_ms": 0.1964399814605713}, "num_episodes": 35, "episode_return_max": 5.151942339089304, "episode_return_min": -1389.5187665048295, "episode_return_mean": -566.7681006405865, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.1506637208923, "num_env_steps_trained_throughput_per_sec": 345.1506637208923, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12180.782, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12180.709, "sample_time_ms": 1215.787, "learn_time_ms": 10899.868, "learn_throughput": 366.977, "synch_weights_time_ms": 64.224}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00000", "date": "2024-08-04_07-30-10", "timestamp": 1722736810, "time_this_iter_s": 11.601850748062134, "time_total_s": 481.3379428386688, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9969ac670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 481.3379428386688, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.96875, "ram_util_percent": 28.174999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.47653429210186, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0348103021892407, "policy_loss": -0.008278102125041186, "vf_loss": 1.038155275924752, "vf_explained_var": 0.9966152298574646, "kl": 0.011259710028328603, "entropy": 1.3374041153738896, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 5.151942339089304, "episode_reward_min": -1389.5187665048295, "episode_reward_mean": -553.6811292026775, "episode_len_mean": 117.33, "episode_media": {}, "episodes_timesteps_total": 11733, "policy_reward_min": {"policy_0": -1389.5187665048295}, "policy_reward_max": {"policy_0": 5.151942339089304}, "policy_reward_mean": {"policy_0": -553.6811292026775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074, -571.992133047312, -591.0045939909019, -252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506, -445.34029813241744, -367.3509194105997, -172.68292515393594, -907.8420158111408, -190.62587401416155, -884.4407738863786, -293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477], "episode_lengths": [150, 78, 124, 150, 150, 150, 150, 118, 39, 150, 67, 150, 150, 150, 50, 97, 61, 31, 150, 150, 139, 90, 150, 101, 150, 52, 150, 95, 150, 150, 150, 150, 150, 72, 42, 150, 150, 41, 150, 150, 150, 32, 72, 119, 150, 150, 46, 36, 106, 150, 147, 45, 56, 39, 150, 123, 150, 107, 112, 150, 150, 150, 150, 150, 150, 150, 150, 111, 102, 150, 92, 150, 106, 150, 150, 150, 85, 98, 150, 78, 141, 150, 45, 150, 48, 150, 150, 150, 128, 150, 103, 94, 140, 70, 98, 57, 134, 104, 150, 62], "policy_policy_0_reward": [-1179.3054149003262, -164.43498395566527, -398.19739384715734, -805.6066768845632, -903.9478561262022, -497.1332585766452, -1243.9674232243563, -348.52299645114886, -46.701501790946544, -863.0689037384034, -183.86164432677782, -891.5853302606478, -889.5694820015266, -950.7743865342376, -45.6656632420911, -444.88873979309113, -65.95596542624997, 5.151942339089304, -1352.1204652346828, -1389.5187665048295, -409.4421498335341, -123.94294316149936, -1078.1840842714212, -354.37799947160846, -606.7675015805885, -68.92451294795184, -854.8726958045817, -126.50948253059371, -1130.0083786973573, -927.8352864649862, -898.0582030144074, -571.992133047312, -591.0045939909019, -252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506, -445.34029813241744, -367.3509194105997, -172.68292515393594, -907.8420158111408, -190.62587401416155, -884.4407738863786, -293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537998409832151, "mean_inference_ms": 1.7208202585514314, "mean_action_processing_ms": 0.2740807077330896, "mean_env_wait_ms": 3.4385102599183437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011551380157470703, "StateBufferConnector_ms": 0.007755279541015625, "ViewRequirementAgentConnector_ms": 0.19365954399108887}, "num_episodes": 34, "episode_return_max": 5.151942339089304, "episode_return_min": -1389.5187665048295, "episode_return_mean": -553.6811292026775, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.6105887654123, "num_env_steps_trained_throughput_per_sec": 315.6105887654123, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12251.273, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12251.2, "sample_time_ms": 1203.772, "learn_time_ms": 10981.056, "learn_throughput": 364.264, "synch_weights_time_ms": 65.53}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00000", "date": "2024-08-04_07-30-23", "timestamp": 1722736823, "time_this_iter_s": 12.68636155128479, "time_total_s": 494.0243043899536, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9965100d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 494.0243043899536, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.478947368421053, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.11963089704514, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.1491629565289865, "policy_loss": -0.007220897979762716, "vf_loss": 1.151537252124399, "vf_explained_var": 0.9925371445094545, "kl": 0.011068018975205025, "entropy": 1.3400921244174242, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 2.5336363690479162, "episode_reward_min": -1426.919439040698, "episode_reward_mean": -495.26087766424644, "episode_len_mean": 114.85, "episode_media": {}, "episodes_timesteps_total": 11485, "policy_reward_min": {"policy_0": -1426.919439040698}, "policy_reward_max": {"policy_0": 2.5336363690479162}, "policy_reward_mean": {"policy_0": -495.26087766424644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506, -445.34029813241744, -367.3509194105997, -172.68292515393594, -907.8420158111408, -190.62587401416155, -884.4407738863786, -293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477, -454.83206819751103, -1355.6042116839865, -1396.2732642822698, -17.55154796666185, -221.41107429806306, -28.40253245757161, -384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463], "episode_lengths": [72, 42, 150, 150, 41, 150, 150, 150, 32, 72, 119, 150, 150, 46, 36, 106, 150, 147, 45, 56, 39, 150, 123, 150, 107, 112, 150, 150, 150, 150, 150, 150, 150, 150, 111, 102, 150, 92, 150, 106, 150, 150, 150, 85, 98, 150, 78, 141, 150, 45, 150, 48, 150, 150, 150, 128, 150, 103, 94, 140, 70, 98, 57, 134, 104, 150, 62, 100, 150, 150, 43, 124, 51, 136, 150, 54, 30, 149, 150, 150, 150, 86, 58, 42, 102, 80, 150, 132, 71, 150, 123, 150, 150, 150, 150, 150, 66, 150, 94, 103], "policy_policy_0_reward": [-252.47666752296794, -81.02350167965352, -392.9084490195901, -926.2818839029292, -37.852252628647854, -727.4564723033939, -1018.0289970482264, -648.8733731764682, 2.5336363690479162, -83.08915815413123, -453.8605904974987, -542.0181517872927, -1155.2743619811909, -34.511661949885216, -9.754301151405608, -352.3267190930017, -1025.596226876101, -499.9425108035516, -32.05932163263346, -51.99410066782227, -73.87155278229858, -1034.9543438615544, -375.83563698155524, -1007.238693958592, -232.48497518951493, -466.0372064682762, -690.9105287320998, -948.0257933455773, -1267.7078664176693, -727.2545078521528, -864.693017735005, -655.6864864755782, -1170.4475259553506, -445.34029813241744, -367.3509194105997, -172.68292515393594, -907.8420158111408, -190.62587401416155, -884.4407738863786, -293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477, -454.83206819751103, -1355.6042116839865, -1396.2732642822698, -17.55154796666185, -221.41107429806306, -28.40253245757161, -384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544375154242517, "mean_inference_ms": 1.7194944642427528, "mean_action_processing_ms": 0.27428172513351035, "mean_env_wait_ms": 3.438719762778462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011594057083129883, "StateBufferConnector_ms": 0.007760524749755859, "ViewRequirementAgentConnector_ms": 0.1921393871307373}, "num_episodes": 33, "episode_return_max": 2.5336363690479162, "episode_return_min": -1426.919439040698, "episode_return_mean": -495.26087766424644, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3139638458538, "num_env_steps_trained_throughput_per_sec": 309.3139638458538, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12228.915, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12228.842, "sample_time_ms": 1189.873, "learn_time_ms": 10971.937, "learn_throughput": 364.566, "synch_weights_time_ms": 66.184}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00000", "date": "2024-08-04_07-30-36", "timestamp": 1722736836, "time_this_iter_s": 12.944764852523804, "time_total_s": 506.9690692424774, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996511d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.9690692424774, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.59444444444445, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.126144160827, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9247018535000583, "policy_loss": -0.013736980501562357, "vf_loss": 0.9316476061319311, "vf_explained_var": 0.9980273001516858, "kl": 0.015396377480889593, "entropy": 1.3714128609746694, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": 0.9097249011848847, "episode_reward_min": -1426.919439040698, "episode_reward_mean": -449.38448234238416, "episode_len_mean": 112.45, "episode_media": {}, "episodes_timesteps_total": 11245, "policy_reward_min": {"policy_0": -1426.919439040698}, "policy_reward_max": {"policy_0": 0.9097249011848847}, "policy_reward_mean": {"policy_0": -449.38448234238416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477, -454.83206819751103, -1355.6042116839865, -1396.2732642822698, -17.55154796666185, -221.41107429806306, -28.40253245757161, -384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463, -699.0293281242065, -743.3992691553383, -532.7783622879981, -429.0967570979113, -98.4268010901675, -288.7186166877386, -208.56763735042634, -267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736], "episode_lengths": [106, 150, 150, 150, 85, 98, 150, 78, 141, 150, 45, 150, 48, 150, 150, 150, 128, 150, 103, 94, 140, 70, 98, 57, 134, 104, 150, 62, 100, 150, 150, 43, 124, 51, 136, 150, 54, 30, 149, 150, 150, 150, 86, 58, 42, 102, 80, 150, 132, 71, 150, 123, 150, 150, 150, 150, 150, 66, 150, 94, 103, 150, 150, 150, 150, 58, 123, 68, 99, 150, 140, 150, 36, 141, 80, 133, 36, 82, 150, 150, 150, 150, 150, 128, 74, 150, 80, 150, 58, 74, 84, 98, 117, 60, 150, 39, 72, 83, 47, 150], "policy_policy_0_reward": [-293.94597531367833, -1077.0341791060896, -942.6538467474471, -1101.501173955688, -203.66775684691925, -200.0579299796762, -846.8415507656082, -163.37555502438252, -512.3609253170199, -950.2936945552593, -22.76738649344231, -927.8007486890386, -37.52072245885483, -932.811198088359, -756.534041577817, -958.2166720185331, -397.328473660393, -1378.4725559730614, -309.1194525077349, -254.33222432425848, -444.91336562667, -134.43269720487834, -164.35271512647645, -42.044099504337275, -481.18535985517894, -182.3017201199714, -369.22007347715373, -75.20594298142477, -454.83206819751103, -1355.6042116839865, -1396.2732642822698, -17.55154796666185, -221.41107429806306, -28.40253245757161, -384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463, -699.0293281242065, -743.3992691553383, -532.7783622879981, -429.0967570979113, -98.4268010901675, -288.7186166877386, -208.56763735042634, -267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544811202867878, "mean_inference_ms": 1.7169607344505915, "mean_action_processing_ms": 0.27420326164711833, "mean_env_wait_ms": 3.4350232651521084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011477231979370117, "StateBufferConnector_ms": 0.007833480834960938, "ViewRequirementAgentConnector_ms": 0.19034790992736816}, "num_episodes": 39, "episode_return_max": 0.9097249011848847, "episode_return_min": -1426.919439040698, "episode_return_mean": -449.38448234238416, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.96691416260524, "num_env_steps_trained_throughput_per_sec": 314.96691416260524, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12279.838, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12279.766, "sample_time_ms": 1154.088, "learn_time_ms": 11057.603, "learn_throughput": 361.742, "synch_weights_time_ms": 67.229}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00000", "date": "2024-08-04_07-30-48", "timestamp": 1722736848, "time_this_iter_s": 12.712707996368408, "time_total_s": 519.6817772388458, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9969ac670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.6817772388458, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.722222222222225, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82.6258197704951, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8729588295022647, "policy_loss": -0.018975763946946243, "vf_loss": 0.8855294460120301, "vf_explained_var": 0.9978576208775242, "kl": 0.014545156242305287, "entropy": 1.40174998169144, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.9097249011848847, "episode_reward_min": -1426.919439040698, "episode_reward_mean": -401.85663485981235, "episode_len_mean": 110.84, "episode_media": {}, "episodes_timesteps_total": 11084, "policy_reward_min": {"policy_0": -1426.919439040698}, "policy_reward_max": {"policy_0": 0.9097249011848847}, "policy_reward_mean": {"policy_0": -401.85663485981235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463, -699.0293281242065, -743.3992691553383, -532.7783622879981, -429.0967570979113, -98.4268010901675, -288.7186166877386, -208.56763735042634, -267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736, -319.1227662259627, -12.272579203350352, -53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049], "episode_lengths": [136, 150, 54, 30, 149, 150, 150, 150, 86, 58, 42, 102, 80, 150, 132, 71, 150, 123, 150, 150, 150, 150, 150, 66, 150, 94, 103, 150, 150, 150, 150, 58, 123, 68, 99, 150, 140, 150, 36, 141, 80, 133, 36, 82, 150, 150, 150, 150, 150, 128, 74, 150, 80, 150, 58, 74, 84, 98, 117, 60, 150, 39, 72, 83, 47, 150, 129, 40, 58, 70, 52, 72, 150, 34, 150, 57, 127, 150, 150, 53, 130, 61, 150, 150, 150, 58, 150, 108, 150, 124, 115, 93, 150, 147, 83, 146, 150, 150, 100, 41], "policy_policy_0_reward": [-384.63785145640213, -1426.919439040698, -87.29443835093207, 0.9097249011848847, -365.1194624716884, -271.3749476959645, -1102.9346483755692, -389.3197162490474, -208.5625578434743, -56.617976793591765, -20.114881946105292, -489.97391749871554, -208.49651810263884, -496.8238878859758, -368.0737683294208, -153.4559884482165, -382.5999004827922, -419.2388857001295, -799.9444785313341, -746.2736714643297, -439.5089856542786, -741.8301384139606, -400.22234604813843, -119.04400386845721, -583.0242232057215, -194.22292283928581, -230.7751907723463, -699.0293281242065, -743.3992691553383, -532.7783622879981, -429.0967570979113, -98.4268010901675, -288.7186166877386, -208.56763735042634, -267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736, -319.1227662259627, -12.272579203350352, -53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543650830258301, "mean_inference_ms": 1.7155116205570686, "mean_action_processing_ms": 0.2742436341702474, "mean_env_wait_ms": 3.434739706556255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011647701263427734, "StateBufferConnector_ms": 0.00787043571472168, "ViewRequirementAgentConnector_ms": 0.19112539291381836}, "num_episodes": 34, "episode_return_max": 0.9097249011848847, "episode_return_min": -1426.919439040698, "episode_return_mean": -401.85663485981235, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3921680361023, "num_env_steps_trained_throughput_per_sec": 304.3921680361023, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12266.293, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12266.217, "sample_time_ms": 1133.902, "learn_time_ms": 11064.287, "learn_throughput": 361.524, "synch_weights_time_ms": 67.18}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00000", "date": "2024-08-04_07-31-02", "timestamp": 1722736862, "time_this_iter_s": 13.153541088104248, "time_total_s": 532.8353183269501, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 532.8353183269501, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.378947368421052, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.46054539879164, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9782223254442215, "policy_loss": -0.013739390172607576, "vf_loss": 0.9851925040284792, "vf_explained_var": 0.9967457203815381, "kl": 0.015360067507147837, "entropy": 1.4281719978898764, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -2.3231446072539486, "episode_reward_min": -1298.4579216743448, "episode_reward_mean": -432.07811832115294, "episode_len_mean": 110.66, "episode_media": {}, "episodes_timesteps_total": 11066, "policy_reward_min": {"policy_0": -1298.4579216743448}, "policy_reward_max": {"policy_0": -2.3231446072539486}, "policy_reward_mean": {"policy_0": -432.07811832115294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736, -319.1227662259627, -12.272579203350352, -53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049, -930.7940100696952, -860.4235899410729, -1134.8859137564737, -392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303], "episode_lengths": [99, 150, 140, 150, 36, 141, 80, 133, 36, 82, 150, 150, 150, 150, 150, 128, 74, 150, 80, 150, 58, 74, 84, 98, 117, 60, 150, 39, 72, 83, 47, 150, 129, 40, 58, 70, 52, 72, 150, 34, 150, 57, 127, 150, 150, 53, 130, 61, 150, 150, 150, 58, 150, 108, 150, 124, 115, 93, 150, 147, 83, 146, 150, 150, 100, 41, 150, 150, 150, 110, 90, 150, 56, 150, 84, 112, 150, 150, 150, 68, 65, 131, 80, 48, 99, 103, 82, 119, 150, 150, 110, 69, 150, 119, 115, 150, 150, 150, 47, 150], "policy_policy_0_reward": [-267.10283139973166, -753.8544872482393, -492.0844748600132, -341.0595547550381, -5.5240709684982, -439.2934260868652, -185.45478894573003, -393.20851558873755, -2.3231446072539486, -144.00886687648725, -1163.369188520925, -597.1011735054263, -984.845451163425, -1217.4448192763557, -1005.6840253573517, -269.5634814469302, -149.5691927570144, -684.0446670597668, -178.74646778556067, -953.4013963724499, -50.58650747334681, -100.28214529691166, -189.13057189142452, -198.83013202732468, -261.1934026426191, -73.0447647569417, -1096.0069634746992, -4.495238277050039, -97.01192653129588, -198.29591728202968, -16.27284239506855, -705.7352670606736, -319.1227662259627, -12.272579203350352, -53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049, -930.7940100696952, -860.4235899410729, -1134.8859137564737, -392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541510681848313, "mean_inference_ms": 1.7141430740259147, "mean_action_processing_ms": 0.2740418789243998, "mean_env_wait_ms": 3.434032410598259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148223876953125, "StateBufferConnector_ms": 0.007909059524536133, "ViewRequirementAgentConnector_ms": 0.19435977935791016}, "num_episodes": 34, "episode_return_max": -2.3231446072539486, "episode_return_min": -1298.4579216743448, "episode_return_mean": -432.07811832115294, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.646627611506, "num_env_steps_trained_throughput_per_sec": 316.646627611506, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12776.299, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12776.225, "sample_time_ms": 1121.277, "learn_time_ms": 11586.462, "learn_throughput": 345.23, "synch_weights_time_ms": 67.628}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00000", "date": "2024-08-04_07-31-14", "timestamp": 1722736874, "time_this_iter_s": 12.645542621612549, "time_total_s": 545.4808609485626, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964beb90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 545.4808609485626, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.544444444444444, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.2617035160462, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7291357361556341, "policy_loss": -0.01579802471145134, "vf_loss": 0.737588601714621, "vf_explained_var": 0.9991444664696852, "kl": 0.01663694790604498, "entropy": 1.4146838961790005, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -3.7089131047798647, "episode_reward_min": -1298.4579216743448, "episode_reward_mean": -495.7166565355011, "episode_len_mean": 115.66, "episode_media": {}, "episodes_timesteps_total": 11566, "policy_reward_min": {"policy_0": -1298.4579216743448}, "policy_reward_max": {"policy_0": -3.7089131047798647}, "policy_reward_mean": {"policy_0": -495.7166565355011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049, -930.7940100696952, -860.4235899410729, -1134.8859137564737, -392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303, -1202.172559572254, -1073.0266111298185, -691.1199421116486, -1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152], "episode_lengths": [58, 70, 52, 72, 150, 34, 150, 57, 127, 150, 150, 53, 130, 61, 150, 150, 150, 58, 150, 108, 150, 124, 115, 93, 150, 147, 83, 146, 150, 150, 100, 41, 150, 150, 150, 110, 90, 150, 56, 150, 84, 112, 150, 150, 150, 68, 65, 131, 80, 48, 99, 103, 82, 119, 150, 150, 110, 69, 150, 119, 115, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 61, 150, 79, 146, 38, 150, 150, 99, 34, 73, 150, 111, 127, 79, 99, 150, 150, 134, 128, 60, 150, 36, 150, 150, 76, 150, 150, 150, 150], "policy_policy_0_reward": [-53.56835835895154, -61.64374461027065, -118.44979904482153, -144.72333490097716, -603.8233962953626, -3.7089131047798647, -283.26391845551296, -46.092215619074906, -503.3651671898658, -847.4747923683233, -857.3030060692122, -48.32770473463387, -354.0135850704228, -43.77344535749883, -786.863446546259, -945.0246948568279, -405.3841571709391, -46.37631592757396, -1005.4720653760769, -329.02334431462435, -1298.4579216743448, -334.9334905873743, -206.07367032849658, -174.8637071502948, -320.468921345193, -296.81823420792125, -236.31531448722677, -477.740688096289, -589.8454146407003, -806.2110492890959, -306.05349518483877, -14.729330135132049, -930.7940100696952, -860.4235899410729, -1134.8859137564737, -392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303, -1202.172559572254, -1073.0266111298185, -691.1199421116486, -1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554344721241854, "mean_inference_ms": 1.7136252705130242, "mean_action_processing_ms": 0.27408132126135315, "mean_env_wait_ms": 3.4350260804381265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011560201644897461, "StateBufferConnector_ms": 0.007949590682983398, "ViewRequirementAgentConnector_ms": 0.19472718238830566}, "num_episodes": 34, "episode_return_max": -3.7089131047798647, "episode_return_min": -1298.4579216743448, "episode_return_mean": -495.7166565355011, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.26995294241726, "num_env_steps_trained_throughput_per_sec": 325.26995294241726, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12695.416, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12695.341, "sample_time_ms": 1124.285, "learn_time_ms": 11503.873, "learn_throughput": 347.709, "synch_weights_time_ms": 66.321}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00000", "date": "2024-08-04_07-31-27", "timestamp": 1722736887, "time_this_iter_s": 12.309851884841919, "time_total_s": 557.7907128334045, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996511480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.7907128334045, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.011764705882353, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.58338343699774, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9851560458540917, "policy_loss": -0.01623574317539654, "vf_loss": 0.9948824119754136, "vf_explained_var": 0.9986030844971537, "kl": 0.014781636550227024, "entropy": 1.4236030034720897, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -6.310078605063439, "episode_reward_min": -1413.1768899071, "episode_reward_mean": -503.0295668806708, "episode_len_mean": 115.17, "episode_media": {}, "episodes_timesteps_total": 11517, "policy_reward_min": {"policy_0": -1413.1768899071}, "policy_reward_max": {"policy_0": -6.310078605063439}, "policy_reward_mean": {"policy_0": -503.0295668806708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303, -1202.172559572254, -1073.0266111298185, -691.1199421116486, -1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152, -309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203], "episode_lengths": [110, 90, 150, 56, 150, 84, 112, 150, 150, 150, 68, 65, 131, 80, 48, 99, 103, 82, 119, 150, 150, 110, 69, 150, 119, 115, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 61, 150, 79, 146, 38, 150, 150, 99, 34, 73, 150, 111, 127, 79, 99, 150, 150, 134, 128, 60, 150, 36, 150, 150, 76, 150, 150, 150, 150, 124, 77, 150, 80, 114, 128, 108, 71, 150, 42, 84, 91, 150, 52, 150, 150, 82, 66, 94, 89, 52, 150, 50, 50, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-392.36911585507244, -250.55674749687626, -1110.9715843081356, -45.88517912335568, -948.8143936298378, -189.57659981215443, -339.3904436764829, -981.1932138921304, -340.90814172846217, -723.1289192716876, -105.7969395220963, -70.03219682297757, -344.9157126374649, -171.32109207416528, -46.45347946522291, -295.5186668419529, -146.4154742196096, -168.62063916308816, -408.1597067851746, -837.910315243592, -505.20174070319564, -350.4138477998025, -82.44938184244435, -842.5053313181817, -263.17907451434843, -358.82465572534215, -1287.4729475193199, -1071.7840983142735, -847.0931740854796, -18.676728897389225, -636.0170844393303, -1202.172559572254, -1073.0266111298185, -691.1199421116486, -1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152, -309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544881704670047, "mean_inference_ms": 1.7138104228836395, "mean_action_processing_ms": 0.2739505773782041, "mean_env_wait_ms": 3.43430291856108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011209249496459961, "StateBufferConnector_ms": 0.00793766975402832, "ViewRequirementAgentConnector_ms": 0.19404387474060059}, "num_episodes": 35, "episode_return_max": -6.310078605063439, "episode_return_min": -1413.1768899071, "episode_return_mean": -503.0295668806708, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.16193463967556, "num_env_steps_trained_throughput_per_sec": 306.16193463967556, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12723.773, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12723.699, "sample_time_ms": 1127.478, "learn_time_ms": 11528.142, "learn_throughput": 346.977, "synch_weights_time_ms": 67.213}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00000", "date": "2024-08-04_07-31-40", "timestamp": 1722736900, "time_this_iter_s": 13.078630208969116, "time_total_s": 570.8693430423737, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9965125f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 570.8693430423737, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.394736842105267, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.08831546703975, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9062064400718858, "policy_loss": -0.01938679254380986, "vf_loss": 0.9190232035393516, "vf_explained_var": 0.997251883149147, "kl": 0.014932255192403925, "entropy": 1.4948306577901045, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -5.419184723457045, "episode_reward_min": -1413.1768899071, "episode_reward_mean": -517.8980460229109, "episode_len_mean": 114.89, "episode_media": {}, "episodes_timesteps_total": 11489, "policy_reward_min": {"policy_0": -1413.1768899071}, "policy_reward_max": {"policy_0": -5.419184723457045}, "policy_reward_mean": {"policy_0": -517.8980460229109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152, -309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203, -45.58252433403834, -846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305], "episode_lengths": [150, 150, 61, 150, 79, 146, 38, 150, 150, 99, 34, 73, 150, 111, 127, 79, 99, 150, 150, 134, 128, 60, 150, 36, 150, 150, 76, 150, 150, 150, 150, 124, 77, 150, 80, 114, 128, 108, 71, 150, 42, 84, 91, 150, 52, 150, 150, 82, 66, 94, 89, 52, 150, 50, 50, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 129, 92, 37, 80, 133, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 70, 45, 116, 75, 139, 110, 150, 69, 76, 150, 150, 40, 150], "policy_policy_0_reward": [-1154.5123988939486, -394.4176741499978, -73.56180825860164, -1102.70729312133, -103.62199649002942, -278.04534186048653, -9.459088293927566, -1207.8352571899936, -743.0558264903385, -211.32774654027875, -7.6555511090060016, -134.52979009637534, -727.0480209541383, -308.50772788829215, -320.47572043591583, -203.1818197739325, -184.29675719005374, -1055.1679093727819, -1275.8770767391293, -384.916924464478, -472.0577899513531, -62.20252025841934, -1043.0084436848483, -6.310078605063439, -801.0240909525088, -609.3349913691029, -134.07082541604686, -563.327381374, -1072.9961167701003, -1215.1253408209527, -1087.840449226152, -309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203, -45.58252433403834, -846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542378091231727, "mean_inference_ms": 1.712175286075653, "mean_action_processing_ms": 0.27369592284176153, "mean_env_wait_ms": 3.4355287258510243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011894941329956055, "StateBufferConnector_ms": 0.008135318756103516, "ViewRequirementAgentConnector_ms": 0.19228196144104004}, "num_episodes": 34, "episode_return_max": -5.419184723457045, "episode_return_min": -1413.1768899071, "episode_return_mean": -517.8980460229109, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.8817871491845, "num_env_steps_trained_throughput_per_sec": 335.8817871491845, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12590.374, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12590.3, "sample_time_ms": 1130.366, "learn_time_ms": 11393.243, "learn_throughput": 351.085, "synch_weights_time_ms": 65.819}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00000", "date": "2024-08-04_07-31-52", "timestamp": 1722736912, "time_this_iter_s": 11.919962644577026, "time_total_s": 582.7893056869507, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964beb90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.7893056869507, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.176470588235293, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.20615101953348, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8453866680540766, "policy_loss": -0.014044592931168155, "vf_loss": 0.852417338701586, "vf_explained_var": 0.9985974326108893, "kl": 0.015895959311304372, "entropy": 1.3926277598987022, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -5.419184723457045, "episode_reward_min": -1413.1768899071, "episode_reward_mean": -520.1580391695943, "episode_len_mean": 117.04, "episode_media": {}, "episodes_timesteps_total": 11704, "policy_reward_min": {"policy_0": -1413.1768899071}, "policy_reward_max": {"policy_0": -5.419184723457045}, "policy_reward_mean": {"policy_0": -520.1580391695943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203, -45.58252433403834, -846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305, -990.4092007733549, -356.6321284527791, -209.51360379649483, -795.5985399641517, -216.11530032006834, -49.50724612850051, -222.43384865853548, -59.9154501582723, -1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118], "episode_lengths": [124, 77, 150, 80, 114, 128, 108, 71, 150, 42, 84, 91, 150, 52, 150, 150, 82, 66, 94, 89, 52, 150, 50, 50, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 129, 92, 37, 80, 133, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 70, 45, 116, 75, 139, 110, 150, 69, 76, 150, 150, 40, 150, 150, 150, 93, 150, 87, 54, 107, 60, 150, 150, 131, 108, 126, 150, 150, 150, 150, 70, 150, 74, 150, 150, 150, 75, 150, 150, 150, 150, 54, 150, 106], "policy_policy_0_reward": [-309.9776125156179, -205.51607617560913, -513.2733006387784, -161.54728829182568, -380.9169620569838, -258.20913115522194, -326.69155018599866, -147.78956398821128, -349.4617243891945, -18.250586989927413, -130.5313228289971, -281.4619157055874, -852.9698347614604, -21.040364470399826, -1326.0347989610682, -870.3475608111189, -142.10737420564044, -210.52559194907772, -196.39107194286385, -210.26283588500434, -80.1673385144961, -573.0927561874441, -23.432440235824853, -33.753549090208665, -1124.9668170321006, -269.18925476290815, -615.585095308595, -881.1334011870867, -730.0517764390314, -633.6024561572395, -748.609432983856, -1192.7648814368517, -388.07109319427366, -1413.1768899071, -586.6775404375203, -45.58252433403834, -846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305, -990.4092007733549, -356.6321284527791, -209.51360379649483, -795.5985399641517, -216.11530032006834, -49.50724612850051, -222.43384865853548, -59.9154501582723, -1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540885806949143, "mean_inference_ms": 1.7112113869927819, "mean_action_processing_ms": 0.27397416511318506, "mean_env_wait_ms": 3.4349729919529906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012131690979003906, "StateBufferConnector_ms": 0.008137941360473633, "ViewRequirementAgentConnector_ms": 0.19625329971313477}, "num_episodes": 31, "episode_return_max": -5.419184723457045, "episode_return_min": -1413.1768899071, "episode_return_mean": -520.1580391695943, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1276732338358, "num_env_steps_trained_throughput_per_sec": 314.1276732338358, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12567.312, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12567.239, "sample_time_ms": 1128.442, "learn_time_ms": 11373.267, "learn_throughput": 351.702, "synch_weights_time_ms": 64.696}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00000", "date": "2024-08-04_07-32-05", "timestamp": 1722736925, "time_this_iter_s": 12.745957851409912, "time_total_s": 595.5352635383606, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 595.5352635383606, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.58888888888889, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.66258357167244, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9850978232299288, "policy_loss": -0.01442544577002991, "vf_loss": 0.9921937223523856, "vf_explained_var": 0.9978737654164433, "kl": 0.01658019941114617, "entropy": 1.315383024699986, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 6.600558713895022, "episode_reward_min": -1270.2279371234308, "episode_reward_mean": -530.1838860728683, "episode_len_mean": 119.2, "episode_media": {}, "episodes_timesteps_total": 11920, "policy_reward_min": {"policy_0": -1270.2279371234308}, "policy_reward_max": {"policy_0": 6.600558713895022}, "policy_reward_mean": {"policy_0": -530.1838860728683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305, -990.4092007733549, -356.6321284527791, -209.51360379649483, -795.5985399641517, -216.11530032006834, -49.50724612850051, -222.43384865853548, -59.9154501582723, -1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118, -971.7648341225799, -718.8211427087934, -8.17686501508773, -52.960624808266914, -172.88006575370727, -716.5105900009474, -10.001201181328133, -14.17715823875906, -792.6469527860464, -20.550075555792855, 6.600558713895022, -85.64747204982604, -920.1822008651341, -386.61784805173505, -399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174], "episode_lengths": [150, 150, 129, 92, 37, 80, 133, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 70, 45, 116, 75, 139, 110, 150, 69, 76, 150, 150, 40, 150, 150, 150, 93, 150, 87, 54, 107, 60, 150, 150, 131, 108, 126, 150, 150, 150, 150, 70, 150, 74, 150, 150, 150, 75, 150, 150, 150, 150, 54, 150, 106, 150, 150, 34, 57, 100, 150, 35, 46, 150, 49, 36, 58, 150, 132, 150, 150, 150, 122, 150, 58, 150, 89, 127, 150, 150, 83, 81, 150, 150, 150, 150, 150, 124, 150, 150, 112], "policy_policy_0_reward": [-846.2455966071241, -1221.5910515284484, -404.7122740241115, -194.337485440007, -13.980507873987182, -154.99160594946287, -585.111197047202, -1202.7701215152583, -901.8973118762905, -192.6643142383193, -665.5488965126619, -856.211542278853, -829.1250694702986, -760.4304115490432, -339.4980349835426, -979.7587673153809, -1010.2286322107169, -5.419184723457045, -994.3160671148895, -1101.8941003879613, -106.75980257226459, -13.72071334022728, -280.2360873263836, -156.25369829849205, -290.9540498466863, -286.6702734440996, -1210.9346331873624, -261.5639963729595, -91.15067567953722, -1062.4085390931102, -752.8879370144929, -10.491240057700562, -804.3773105520305, -990.4092007733549, -356.6321284527791, -209.51360379649483, -795.5985399641517, -216.11530032006834, -49.50724612850051, -222.43384865853548, -59.9154501582723, -1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118, -971.7648341225799, -718.8211427087934, -8.17686501508773, -52.960624808266914, -172.88006575370727, -716.5105900009474, -10.001201181328133, -14.17715823875906, -792.6469527860464, -20.550075555792855, 6.600558713895022, -85.64747204982604, -920.1822008651341, -386.61784805173505, -399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545391988979133, "mean_inference_ms": 1.709974682111402, "mean_action_processing_ms": 0.27424241385476494, "mean_env_wait_ms": 3.43621855409992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012523174285888672, "StateBufferConnector_ms": 0.008224010467529297, "ViewRequirementAgentConnector_ms": 0.19925951957702637}, "num_episodes": 36, "episode_return_max": 6.600558713895022, "episode_return_min": -1270.2279371234308, "episode_return_mean": -530.1838860728683, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.0161043488574, "num_env_steps_trained_throughput_per_sec": 522.0161043488574, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12174.657, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12174.587, "sample_time_ms": 1120.521, "learn_time_ms": 10987.958, "learn_throughput": 364.035, "synch_weights_time_ms": 65.273}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00000", "date": "2024-08-04_07-32-12", "timestamp": 1722736932, "time_this_iter_s": 7.674795150756836, "time_total_s": 603.2100586891174, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.2100586891174, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 22.61818181818182, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.89967668553193, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0063811127096414, "policy_loss": -0.011212099379918072, "vf_loss": 1.0126858522494635, "vf_explained_var": 0.9924332179129124, "kl": 0.01123038207770154, "entropy": 1.4630796590199073, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": 7.714276800428071, "episode_reward_min": -1381.8106644059176, "episode_reward_mean": -498.2066671249376, "episode_len_mean": 115.13, "episode_media": {}, "episodes_timesteps_total": 11513, "policy_reward_min": {"policy_0": -1381.8106644059176}, "policy_reward_max": {"policy_0": 7.714276800428071}, "policy_reward_mean": {"policy_0": -498.2066671249376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118, -971.7648341225799, -718.8211427087934, -8.17686501508773, -52.960624808266914, -172.88006575370727, -716.5105900009474, -10.001201181328133, -14.17715823875906, -792.6469527860464, -20.550075555792855, 6.600558713895022, -85.64747204982604, -920.1822008651341, -386.61784805173505, -399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174, -61.60076757091324, -92.50677109216316, -217.09176354341778, -33.34458667277945, -151.21255496325256, -237.68427238118355, -224.77454330635774, -91.15910800638586, -931.0760781381065, -1194.1056805982216, -1240.7573236912724, -1381.8106644059176, -928.888781207834, -747.7957284245948, -718.0351558462489, -355.56816881510235, -90.22788234176299, -344.59235516139495, -859.1342255561552, -1070.145798817909, -128.1015603028433, -534.6464108492245, -53.10312834042537, -278.23070806161013, -132.58512694295442, -209.30999531797787, -384.4922836116596, -675.818183676739, -514.7657450155154, -876.3780367374412, -174.68736574370533, -147.26108089635662, 7.714276800428071, -28.713458792531103, -791.8558454387579, -67.76400277410487, -71.87738823812596, -118.63409038456963, -1089.9608732912661, -268.03930138656705, -781.5220333485252], "episode_lengths": [150, 150, 131, 108, 126, 150, 150, 150, 150, 70, 150, 74, 150, 150, 150, 75, 150, 150, 150, 150, 54, 150, 106, 150, 150, 34, 57, 100, 150, 35, 46, 150, 49, 36, 58, 150, 132, 150, 150, 150, 122, 150, 58, 150, 89, 127, 150, 150, 83, 81, 150, 150, 150, 150, 150, 124, 150, 150, 112, 70, 81, 117, 50, 58, 71, 104, 66, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 78, 150, 53, 116, 64, 84, 102, 140, 113, 150, 82, 54, 29, 42, 150, 67, 56, 73, 150, 91, 150], "policy_policy_0_reward": [-1210.0424712525169, -892.3334860827048, -425.06209183092244, -254.84444347742271, -319.5367022653338, -868.208977321649, -887.3261015322225, -970.7605731029831, -964.049793639878, -153.16000653161305, -875.5648489361029, -106.69432821307115, -572.4766622074204, -330.7363995184753, -1262.522773494585, -126.54808250617982, -606.2929511320928, -458.93910594651027, -1270.2279371234308, -636.2875461132979, -95.5873284136839, -761.4392321021367, -224.7319114135118, -971.7648341225799, -718.8211427087934, -8.17686501508773, -52.960624808266914, -172.88006575370727, -716.5105900009474, -10.001201181328133, -14.17715823875906, -792.6469527860464, -20.550075555792855, 6.600558713895022, -85.64747204982604, -920.1822008651341, -386.61784805173505, -399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174, -61.60076757091324, -92.50677109216316, -217.09176354341778, -33.34458667277945, -151.21255496325256, -237.68427238118355, -224.77454330635774, -91.15910800638586, -931.0760781381065, -1194.1056805982216, -1240.7573236912724, -1381.8106644059176, -928.888781207834, -747.7957284245948, -718.0351558462489, -355.56816881510235, -90.22788234176299, -344.59235516139495, -859.1342255561552, -1070.145798817909, -128.1015603028433, -534.6464108492245, -53.10312834042537, -278.23070806161013, -132.58512694295442, -209.30999531797787, -384.4922836116596, -675.818183676739, -514.7657450155154, -876.3780367374412, -174.68736574370533, -147.26108089635662, 7.714276800428071, -28.713458792531103, -791.8558454387579, -67.76400277410487, -71.87738823812596, -118.63409038456963, -1089.9608732912661, -268.03930138656705, -781.5220333485252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544431773924896, "mean_inference_ms": 1.7090585356227515, "mean_action_processing_ms": 0.2741570987051066, "mean_env_wait_ms": 3.4356874311988634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012097835540771484, "StateBufferConnector_ms": 0.008078336715698242, "ViewRequirementAgentConnector_ms": 0.19868755340576172}, "num_episodes": 41, "episode_return_max": 7.714276800428071, "episode_return_min": -1381.8106644059176, "episode_return_mean": -498.2066671249376, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3887309165213, "num_env_steps_trained_throughput_per_sec": 303.3887309165213, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12225.713, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12225.643, "sample_time_ms": 1122.017, "learn_time_ms": 11039.72, "learn_throughput": 362.328, "synch_weights_time_ms": 63.089}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00000", "date": "2024-08-04_07-32-26", "timestamp": 1722736946, "time_this_iter_s": 13.197079181671143, "time_total_s": 616.4071378707886, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bcb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.4071378707886, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.294736842105262, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.69711723128954, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0570384058790903, "policy_loss": -0.009563302322931122, "vf_loss": 1.061352474335581, "vf_explained_var": 0.9920070128515363, "kl": 0.011964253379286067, "entropy": 1.3467880733311177, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 7.714276800428071, "episode_reward_min": -1394.6669689502633, "episode_reward_mean": -476.5544890365937, "episode_len_mean": 113.04, "episode_media": {}, "episodes_timesteps_total": 11304, "policy_reward_min": {"policy_0": -1394.6669689502633}, "policy_reward_max": {"policy_0": 7.714276800428071}, "policy_reward_mean": {"policy_0": -476.5544890365937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174, -61.60076757091324, -92.50677109216316, -217.09176354341778, -33.34458667277945, -151.21255496325256, -237.68427238118355, -224.77454330635774, -91.15910800638586, -931.0760781381065, -1194.1056805982216, -1240.7573236912724, -1381.8106644059176, -928.888781207834, -747.7957284245948, -718.0351558462489, -355.56816881510235, -90.22788234176299, -344.59235516139495, -859.1342255561552, -1070.145798817909, -128.1015603028433, -534.6464108492245, -53.10312834042537, -278.23070806161013, -132.58512694295442, -209.30999531797787, -384.4922836116596, -675.818183676739, -514.7657450155154, -876.3780367374412, -174.68736574370533, -147.26108089635662, 7.714276800428071, -28.713458792531103, -791.8558454387579, -67.76400277410487, -71.87738823812596, -118.63409038456963, -1089.9608732912661, -268.03930138656705, -781.5220333485252, -1167.8949325149965, -167.78475549695537, -869.7764201642334, -32.134357922587405, -89.20047052367262, -690.8397849968144, -835.1514547858673, -77.89701338631785, -244.148760653632, -140.0800888555265, -134.81759478926975, -158.9082153254716, -1070.9469381876343, -127.74739593179592, -527.4615190724732, -1159.2560690413081, -126.00959359209901, -508.6786400971593, -719.273214199778, -481.95058373283547, -60.39455756558148, -252.20596622765814, -1289.6203277745751, -4.140831559851252, -739.5204349372516, 4.141867071779134, -147.97485908248572, -413.8374663452911, -627.1077426741261, -351.2776864438912, -987.7847886627272, -249.11750080506272, -1394.6669689502633, -286.2153714230314, -170.53282752437448, -230.56516093970913, -441.71399063294155], "episode_lengths": [150, 150, 150, 122, 150, 58, 150, 89, 127, 150, 150, 83, 81, 150, 150, 150, 150, 150, 124, 150, 150, 112, 70, 81, 117, 50, 58, 71, 104, 66, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 78, 150, 53, 116, 64, 84, 102, 140, 113, 150, 82, 54, 29, 42, 150, 67, 56, 73, 150, 91, 150, 150, 100, 150, 56, 70, 150, 150, 63, 92, 72, 54, 83, 150, 90, 150, 150, 78, 150, 150, 138, 54, 92, 150, 40, 132, 32, 76, 150, 146, 150, 150, 76, 150, 100, 89, 99, 150], "policy_policy_0_reward": [-399.1361288581269, -606.244274265507, -505.8137089542077, -290.1338381251712, -368.7912197674524, -133.98138963686498, -1199.438867138065, -260.49125272707295, -384.2616670437283, -942.1794998332831, -486.4845102627418, -145.4996111572654, -169.18807284916195, -821.8822733486269, -658.1314057133237, -751.1681867681951, -632.0058198144327, -880.566290019931, -366.18006974432194, -881.517513098281, -1162.9944555738762, -345.3218783208174, -61.60076757091324, -92.50677109216316, -217.09176354341778, -33.34458667277945, -151.21255496325256, -237.68427238118355, -224.77454330635774, -91.15910800638586, -931.0760781381065, -1194.1056805982216, -1240.7573236912724, -1381.8106644059176, -928.888781207834, -747.7957284245948, -718.0351558462489, -355.56816881510235, -90.22788234176299, -344.59235516139495, -859.1342255561552, -1070.145798817909, -128.1015603028433, -534.6464108492245, -53.10312834042537, -278.23070806161013, -132.58512694295442, -209.30999531797787, -384.4922836116596, -675.818183676739, -514.7657450155154, -876.3780367374412, -174.68736574370533, -147.26108089635662, 7.714276800428071, -28.713458792531103, -791.8558454387579, -67.76400277410487, -71.87738823812596, -118.63409038456963, -1089.9608732912661, -268.03930138656705, -781.5220333485252, -1167.8949325149965, -167.78475549695537, -869.7764201642334, -32.134357922587405, -89.20047052367262, -690.8397849968144, -835.1514547858673, -77.89701338631785, -244.148760653632, -140.0800888555265, -134.81759478926975, -158.9082153254716, -1070.9469381876343, -127.74739593179592, -527.4615190724732, -1159.2560690413081, -126.00959359209901, -508.6786400971593, -719.273214199778, -481.95058373283547, -60.39455756558148, -252.20596622765814, -1289.6203277745751, -4.140831559851252, -739.5204349372516, 4.141867071779134, -147.97485908248572, -413.8374663452911, -627.1077426741261, -351.2776864438912, -987.7847886627272, -249.11750080506272, -1394.6669689502633, -286.2153714230314, -170.53282752437448, -230.56516093970913, -441.71399063294155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541761137531016, "mean_inference_ms": 1.7078841116925896, "mean_action_processing_ms": 0.2739791850488648, "mean_env_wait_ms": 3.437439909923776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012003898620605469, "StateBufferConnector_ms": 0.008049249649047852, "ViewRequirementAgentConnector_ms": 0.19428563117980957}, "num_episodes": 37, "episode_return_max": 7.714276800428071, "episode_return_min": -1394.6669689502633, "episode_return_mean": -476.5544890365937, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.2418342391579, "num_env_steps_trained_throughput_per_sec": 326.2418342391579, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12158.613, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12158.54, "sample_time_ms": 1121.912, "learn_time_ms": 10973.528, "learn_throughput": 364.514, "synch_weights_time_ms": 62.287}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00000", "date": "2024-08-04_07-32-38", "timestamp": 1722736958, "time_this_iter_s": 12.274917840957642, "time_total_s": 628.6820557117462, "pid": 601971, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996512050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.6820557117462, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.00588235294118, "ram_util_percent": 28.2}}
