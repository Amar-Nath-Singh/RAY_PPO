{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.37971850419417, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.587459174791972, "policy_loss": -0.007937816656097614, "vf_loss": 8.593497137228647, "vf_explained_var": 0.05061956153561672, "kl": 0.010213888644064658, "entropy": 1.4293667333821456, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -5.03874614332924, "episode_reward_min": -1148.819116614481, "episode_reward_mean": -674.0614962081709, "episode_len_mean": 120.88461538461539, "episode_media": {}, "episodes_timesteps_total": 3143, "policy_reward_min": {"policy_0": -1148.819116614481}, "policy_reward_max": {"policy_0": -5.03874614332924}, "policy_reward_mean": {"policy_0": -674.0614962081709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206], "episode_lengths": [117, 150, 150, 37, 51, 57, 150, 134, 150, 150, 150, 150, 150, 150, 150, 93, 30, 150, 150, 109, 136, 150, 147, 150, 38, 94], "policy_policy_0_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5629592844071797, "mean_inference_ms": 1.6197209188368065, "mean_action_processing_ms": 0.2710251897306203, "mean_env_wait_ms": 3.261661259411591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0119475217965933, "StateBufferConnector_ms": 0.00823369392981896, "ViewRequirementAgentConnector_ms": 0.19614513103778547}, "num_episodes": 26, "episode_return_max": -5.03874614332924, "episode_return_min": -1148.819116614481, "episode_return_mean": -674.0614962081709, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.5736590454056, "num_env_steps_trained_throughput_per_sec": 396.5736590454056, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10086.409, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10086.343, "sample_time_ms": 1072.491, "learn_time_ms": 8931.68, "learn_throughput": 447.844, "synch_weights_time_ms": 81.379}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "89531_00000", "date": "2024-08-05_11-13-10", "timestamp": 1722836590, "time_this_iter_s": 10.095685482025146, "time_total_s": 10.095685482025146, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d7a7f684c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.095685482025146, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.15333333333333, "ram_util_percent": 28.78000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.31511069784562, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.164918027818203, "policy_loss": -0.007642049452018304, "vf_loss": 5.169768424580495, "vf_explained_var": 0.6780379068727295, "kl": 0.014689278625845266, "entropy": 1.4621940047790607, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -5.03874614332924, "episode_reward_min": -1367.3843805582817, "episode_reward_mean": -734.0965009209675, "episode_len_mean": 126.82352941176471, "episode_media": {}, "episodes_timesteps_total": 6468, "policy_reward_min": {"policy_0": -1367.3843805582817}, "policy_reward_max": {"policy_0": -5.03874614332924}, "policy_reward_mean": {"policy_0": -734.0965009209675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498], "episode_lengths": [117, 150, 150, 37, 51, 57, 150, 134, 150, 150, 150, 150, 150, 150, 150, 93, 30, 150, 150, 109, 136, 150, 147, 150, 38, 94, 92, 117, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 97, 150, 77, 150, 49, 150], "policy_policy_0_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592883991372491, "mean_inference_ms": 1.6232917991823914, "mean_action_processing_ms": 0.27159018590707656, "mean_env_wait_ms": 3.269520775241235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014097082848642386, "StateBufferConnector_ms": 0.00827639710669424, "ViewRequirementAgentConnector_ms": 0.19293626149495444}, "num_episodes": 25, "episode_return_max": -5.03874614332924, "episode_return_min": -1367.3843805582817, "episode_return_mean": -734.0965009209675, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.5793523563179, "num_env_steps_trained_throughput_per_sec": 432.5793523563179, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9666.639, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9666.574, "sample_time_ms": 1064.368, "learn_time_ms": 8531.275, "learn_throughput": 468.863, "synch_weights_time_ms": 70.182}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "89531_00000", "date": "2024-08-05_11-13-19", "timestamp": 1722836599, "time_this_iter_s": 9.255957126617432, "time_total_s": 19.351642608642578, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d7a7f6bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19.351642608642578, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.753846153846155, "ram_util_percent": 28.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.79002458850543, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.049393683547775, "policy_loss": -0.014132602279035685, "vf_loss": 3.0600044639160235, "vf_explained_var": 0.9347078883399565, "kl": 0.018314641787067862, "entropy": 1.411003494511048, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -5.03874614332924, "episode_reward_min": -1367.3843805582817, "episode_reward_mean": -736.4434952396365, "episode_len_mean": 128.82716049382717, "episode_media": {}, "episodes_timesteps_total": 10435, "policy_reward_min": {"policy_0": -1367.3843805582817}, "policy_reward_max": {"policy_0": -5.03874614332924}, "policy_reward_mean": {"policy_0": -736.4434952396365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518], "episode_lengths": [117, 150, 150, 37, 51, 57, 150, 134, 150, 150, 150, 150, 150, 150, 150, 93, 30, 150, 150, 109, 136, 150, 147, 150, 38, 94, 92, 117, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 97, 150, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 81, 116, 150, 63, 150, 84, 99, 150, 150, 150, 74, 121, 150, 150, 150, 150, 126, 81, 150, 150, 150], "policy_policy_0_reward": [-517.51942520363, -1071.8941531339956, -773.5572559080607, -32.22802950196207, -51.637097187057826, -110.13953238964183, -970.2439656327045, -764.2793115027856, -1038.5960224085, -945.7754440599125, -1137.3971691571692, -1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557252217223783, "mean_inference_ms": 1.6273942713870775, "mean_action_processing_ms": 0.2721824394545534, "mean_env_wait_ms": 3.276536233781006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013781771247769579, "StateBufferConnector_ms": 0.008656066141010802, "ViewRequirementAgentConnector_ms": 0.19603746908682365}, "num_episodes": 30, "episode_return_max": -5.03874614332924, "episode_return_min": -1367.3843805582817, "episode_return_mean": -736.4434952396365, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.8768467109875, "num_env_steps_trained_throughput_per_sec": 415.8768467109875, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 9650.508, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9650.443, "sample_time_ms": 1074.304, "learn_time_ms": 8506.829, "learn_throughput": 470.21, "synch_weights_time_ms": 68.559}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "89531_00000", "date": "2024-08-05_11-13-29", "timestamp": 1722836609, "time_this_iter_s": 9.628890991210938, "time_total_s": 28.980533599853516, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d7a7f688b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.980533599853516, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.8, "ram_util_percent": 28.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.22314899365108, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.702561572814981, "policy_loss": -0.0101137285217798, "vf_loss": 2.7094866396238406, "vf_explained_var": 0.933787694821755, "kl": 0.01662340156564521, "entropy": 1.360195579752326, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -5.03874614332924, "episode_reward_min": -1367.3843805582817, "episode_reward_mean": -768.0723159236004, "episode_len_mean": 132.88, "episode_media": {}, "episodes_timesteps_total": 13288, "policy_reward_min": {"policy_0": -1367.3843805582817}, "policy_reward_max": {"policy_0": -5.03874614332924}, "policy_reward_mean": {"policy_0": -768.0723159236004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781], "episode_lengths": [150, 150, 150, 150, 93, 30, 150, 150, 109, 136, 150, 147, 150, 38, 94, 92, 117, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 97, 150, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 81, 116, 150, 63, 150, 84, 99, 150, 150, 150, 74, 121, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 131, 150, 67, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 133, 125, 128, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 113], "policy_policy_0_reward": [-1045.9826914611247, -887.6423407717142, -1018.151223069535, -1148.819116614481, -418.2911002833989, -5.03874614332924, -962.5542581630389, -887.3015381177354, -325.52862560717296, -711.2396365332485, -855.5485797330163, -566.3126061333056, -1038.0271126665043, -24.654255448498265, -217.2396645809206, -327.3759895007109, -518.7178356021078, -1049.6070026927077, -1253.9409448470235, -808.5627830513994, -1037.8686639080208, -161.38023488072724, -877.8622875650178, -1043.9523474318637, -999.5252836347339, -903.7325480938434, -928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553173890525196, "mean_inference_ms": 1.6299220984370117, "mean_action_processing_ms": 0.273003763546249, "mean_env_wait_ms": 3.277465628004971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875484466552734, "StateBufferConnector_ms": 0.008681058883666992, "ViewRequirementAgentConnector_ms": 0.1954355239868164}, "num_episodes": 30, "episode_return_max": -5.03874614332924, "episode_return_min": -1367.3843805582817, "episode_return_mean": -768.0723159236004, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.49524607592895, "num_env_steps_trained_throughput_per_sec": 440.49524607592895, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9508.057, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9507.991, "sample_time_ms": 1078.144, "learn_time_ms": 8361.149, "learn_throughput": 478.403, "synch_weights_time_ms": 67.942}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "89531_00000", "date": "2024-08-05_11-13-38", "timestamp": 1722836618, "time_this_iter_s": 9.090830087661743, "time_total_s": 38.07136368751526, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643352d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.07136368751526, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.315384615384616, "ram_util_percent": 28.823076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.26042141318322, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.4075190243311226, "policy_loss": -0.008218944882780002, "vf_loss": 1.4129674245292942, "vf_explained_var": 0.9839257777978977, "kl": 0.014491079797138208, "entropy": 1.2767164596666893, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -50.49436834557623, "episode_reward_min": -1367.3843805582817, "episode_reward_mean": -751.540039476677, "episode_len_mean": 134.24, "episode_media": {}, "episodes_timesteps_total": 13424, "policy_reward_min": {"policy_0": -1367.3843805582817}, "policy_reward_max": {"policy_0": -50.49436834557623}, "policy_reward_mean": {"policy_0": -751.540039476677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 112, 97, 150, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 81, 116, 150, 63, 150, 84, 99, 150, 150, 150, 74, 121, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 131, 150, 67, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 133, 125, 128, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 113, 150, 150, 150, 150, 150, 88, 150, 113, 150, 80, 150, 133, 150, 48, 108, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93], "policy_policy_0_reward": [-928.1480907380821, -835.8458561661298, -852.5136368621314, -1184.7214352456785, -693.1222368186101, -810.8772578554115, -914.6579456301047, -561.2152925679065, -422.34792401504757, -1367.3843805582817, -287.3935199834385, -932.683086915634, -72.65381570893955, -1067.2322452833498, -735.0343841023048, -1022.3342456026361, -792.4447050116465, -1136.5454680031316, -975.1447962464457, -609.2185916028927, -752.7564753759098, -989.4425382508794, -417.2217739991975, -244.74281952918543, -426.79584847197276, -923.5055851754388, -78.4234891908424, -916.6022951435715, -186.6021656236258, -362.84217310302427, -1245.1650938476375, -719.5247955602412, -1149.3801530522885, -129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527252793035499, "mean_inference_ms": 1.63281746683998, "mean_action_processing_ms": 0.27358443708695185, "mean_env_wait_ms": 3.2824067480194294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013706207275390625, "StateBufferConnector_ms": 0.008761167526245117, "ViewRequirementAgentConnector_ms": 0.19261646270751953}, "num_episodes": 26, "episode_return_max": -50.49436834557623, "episode_return_min": -1367.3843805582817, "episode_return_mean": -751.540039476677, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.66520468194625, "num_env_steps_trained_throughput_per_sec": 391.66520468194625, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 9649.009, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9648.941, "sample_time_ms": 1076.976, "learn_time_ms": 8505.721, "learn_throughput": 470.272, "synch_weights_time_ms": 65.486}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "89531_00000", "date": "2024-08-05_11-13-48", "timestamp": 1722836628, "time_this_iter_s": 10.225521564483643, "time_total_s": 48.2968852519989, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.2968852519989, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.96428571428572, "ram_util_percent": 28.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 232.5100023329258, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.3430963019529978, "policy_loss": -0.008996612462215125, "vf_loss": 1.3494534375456473, "vf_explained_var": 0.9895392177626491, "kl": 0.013821283105899822, "entropy": 1.247817615667979, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -47.2535277671206, "episode_reward_min": -1310.4692567371674, "episode_reward_mean": -751.4470160422259, "episode_len_mean": 134.71, "episode_media": {}, "episodes_timesteps_total": 13471, "policy_reward_min": {"policy_0": -1310.4692567371674}, "policy_reward_max": {"policy_0": -47.2535277671206}, "policy_reward_mean": {"policy_0": -751.4470160422259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005], "episode_lengths": [74, 121, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 131, 150, 67, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 133, 125, 128, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 113, 150, 150, 150, 150, 150, 88, 150, 113, 150, 80, 150, 133, 150, 48, 108, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 67, 150, 150, 101, 43, 150, 102, 150, 150, 71, 86, 150, 150, 150, 150, 142, 132, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150], "policy_policy_0_reward": [-129.2497860326143, -657.6232483658214, -1129.0344542132211, -1140.7436488026694, -828.0499655297856, -903.5622262343163, -725.3165430327329, -101.91778344075699, -600.9110172292923, -1186.518670626609, -1126.346827040518, -1041.6597139055586, -357.5316923214712, -1032.6277773122354, -210.70689269006178, -416.5640167945863, -723.7724424890206, -937.060511718702, -1036.5025599111127, -1236.1141775241558, -1069.3275962558778, -826.4656552280945, -847.716996999159, -1104.779943268221, -1087.2959994545129, -316.06054416791557, -1310.4692567371674, -599.74350029756, -652.5314793722557, -574.0928393811403, -661.0334507613236, -855.9484430009036, -752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509356779742394, "mean_inference_ms": 1.6346833188657042, "mean_action_processing_ms": 0.2742274581477092, "mean_env_wait_ms": 3.2831926163697354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013614177703857422, "StateBufferConnector_ms": 0.008976936340332031, "ViewRequirementAgentConnector_ms": 0.19029760360717773}, "num_episodes": 33, "episode_return_max": -47.2535277671206, "episode_return_min": -1310.4692567371674, "episode_return_mean": -751.4470160422259, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.4922857987706, "num_env_steps_trained_throughput_per_sec": 340.4922857987706, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9998.793, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9998.724, "sample_time_ms": 1090.17, "learn_time_ms": 8841.936, "learn_throughput": 452.39, "synch_weights_time_ms": 65.848}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "89531_00000", "date": "2024-08-05_11-14-00", "timestamp": 1722836640, "time_this_iter_s": 11.760822057723999, "time_total_s": 60.0577073097229, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643364d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.0577073097229, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.764705882352942, "ram_util_percent": 28.81176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.58860964973766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.46936938179036, "policy_loss": -0.0073667270529161515, "vf_loss": 1.4747447782506546, "vf_explained_var": 0.9763085461532076, "kl": 0.010571701983265788, "entropy": 1.2301901293297608, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -23.31211792932681, "episode_reward_min": -1351.239625636813, "episode_reward_mean": -734.0017999154982, "episode_len_mean": 133.59, "episode_media": {}, "episodes_timesteps_total": 13359, "policy_reward_min": {"policy_0": -1351.239625636813}, "policy_reward_max": {"policy_0": -23.31211792932681}, "policy_reward_mean": {"policy_0": -734.0017999154982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894], "episode_lengths": [150, 150, 150, 150, 150, 122, 150, 150, 113, 150, 150, 150, 150, 150, 88, 150, 113, 150, 80, 150, 133, 150, 48, 108, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 67, 150, 150, 101, 43, 150, 102, 150, 150, 71, 86, 150, 150, 150, 150, 142, 132, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 145, 48, 80, 150, 150, 150, 150, 150, 150, 100, 123, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 74, 117, 60, 150, 150, 150, 95, 150, 150, 150, 87], "policy_policy_0_reward": [-752.9110533566272, -748.1717153012246, -751.2712638372466, -1154.685316317112, -829.106458928162, -581.9436915770136, -1055.824709968574, -1227.4764283229474, -569.1797568349781, -1021.3931896952989, -576.9487652664665, -813.8712999025544, -559.4690527489928, -747.6961434738287, -203.9741727276126, -1144.4507818886611, -303.7501792054862, -1000.0008468673914, -196.77178009752564, -1035.1514302565863, -316.9296187010023, -668.4342969360183, -50.49436834557623, -419.0433742810921, -386.6410241255697, -966.9615160984957, -1131.56841938397, -721.3362631863389, -816.7638476805682, -842.7000573585949, -701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496157474179689, "mean_inference_ms": 1.6389319702496095, "mean_action_processing_ms": 0.27441564146617414, "mean_env_wait_ms": 3.289315609598152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013362884521484375, "StateBufferConnector_ms": 0.008615970611572266, "ViewRequirementAgentConnector_ms": 0.18892335891723633}, "num_episodes": 32, "episode_return_max": -23.31211792932681, "episode_return_min": -1351.239625636813, "episode_return_mean": -734.0017999154982, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.7273699773466, "num_env_steps_trained_throughput_per_sec": 427.7273699773466, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 9906.36, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9906.291, "sample_time_ms": 1089.675, "learn_time_ms": 8750.799, "learn_throughput": 457.101, "synch_weights_time_ms": 65.041}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "89531_00000", "date": "2024-08-05_11-14-10", "timestamp": 1722836650, "time_this_iter_s": 9.362402439117432, "time_total_s": 69.42010974884033, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643370a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 69.42010974884033, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.753846153846155, "ram_util_percent": 28.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.12902880708376, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.238790357268105, "policy_loss": -0.004880957428637581, "vf_loss": 1.2416709317515293, "vf_explained_var": 0.9932457152133186, "kl": 0.010596969180854406, "entropy": 1.1900868135193983, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -17.33117156986509, "episode_reward_min": -1357.0833710891363, "episode_reward_mean": -726.9829482554212, "episode_len_mean": 131.78, "episode_media": {}, "episodes_timesteps_total": 13178, "policy_reward_min": {"policy_0": -1357.0833710891363}, "policy_reward_max": {"policy_0": -17.33117156986509}, "policy_reward_mean": {"policy_0": -726.9829482554212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106], "episode_lengths": [150, 150, 150, 150, 93, 150, 150, 150, 150, 67, 150, 150, 101, 43, 150, 102, 150, 150, 71, 86, 150, 150, 150, 150, 142, 132, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 145, 48, 80, 150, 150, 150, 150, 150, 150, 100, 123, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 74, 117, 60, 150, 150, 150, 95, 150, 150, 150, 87, 150, 150, 150, 144, 150, 82, 150, 150, 112, 43, 150, 150, 150, 150, 150, 150, 150, 150, 40, 66, 150, 150, 150, 51, 150, 150, 150, 150, 46, 150], "policy_policy_0_reward": [-701.4933974776906, -1272.8710671269866, -904.6578143712885, -499.06022059633966, -139.19684404289634, -985.7776139368179, -958.3982680967118, -757.3540181844065, -1009.1854662949066, -227.16436230106328, -1046.3721356488913, -729.2481803033511, -215.05396484735516, -74.29426860581073, -846.7250133511102, -348.2299757904945, -1062.093785475851, -1007.7455842864285, -251.8848512355398, -246.7662863515949, -829.411199586371, -1013.8301559331576, -950.6618129121316, -971.5453419465318, -586.0938640835998, -258.2657430314578, -810.5884712797176, -790.1585965272402, -652.4405339447509, -919.1554290146223, -1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5497095709287939, "mean_inference_ms": 1.6432130602148556, "mean_action_processing_ms": 0.2743019465597659, "mean_env_wait_ms": 3.295643122715467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02521228790283203, "StateBufferConnector_ms": 0.008436441421508789, "ViewRequirementAgentConnector_ms": 0.19019317626953125}, "num_episodes": 30, "episode_return_max": -17.33117156986509, "episode_return_min": -1357.0833710891363, "episode_return_mean": -726.9829482554212, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.9143481331861, "num_env_steps_trained_throughput_per_sec": 491.9143481331861, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9684.504, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9684.435, "sample_time_ms": 1105.432, "learn_time_ms": 8513.757, "learn_throughput": 469.828, "synch_weights_time_ms": 64.471}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "89531_00000", "date": "2024-08-05_11-14-18", "timestamp": 1722836658, "time_this_iter_s": 8.142646789550781, "time_total_s": 77.56275653839111, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664337eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.56275653839111, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.79166666666666, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.11973027586936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9868820815347135, "policy_loss": -0.005635444695750873, "vf_loss": 0.9897353710917135, "vf_explained_var": 0.990829594557484, "kl": 0.014507354151980205, "entropy": 1.1931673189004262, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -17.33117156986509, "episode_reward_min": -1357.0833710891363, "episode_reward_mean": -707.3290024656972, "episode_len_mean": 131.03, "episode_media": {}, "episodes_timesteps_total": 13103, "policy_reward_min": {"policy_0": -1357.0833710891363}, "policy_reward_max": {"policy_0": -17.33117156986509}, "policy_reward_mean": {"policy_0": -707.3290024656972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407], "episode_lengths": [150, 150, 150, 150, 53, 150, 150, 150, 145, 48, 80, 150, 150, 150, 150, 150, 150, 100, 123, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 74, 117, 60, 150, 150, 150, 95, 150, 150, 150, 87, 150, 150, 150, 144, 150, 82, 150, 150, 112, 43, 150, 150, 150, 150, 150, 150, 150, 150, 40, 66, 150, 150, 150, 51, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 93, 113, 150, 150, 150, 150, 150, 150, 87, 34, 150, 150, 150, 150, 150, 118, 150, 111, 54, 55, 150, 97, 150, 150], "policy_policy_0_reward": [-1011.408340606364, -1161.8340731444318, -891.4985431360598, -997.9159762773834, -47.2535277671206, -1196.4572335808223, -983.2814596443956, -767.127700670005, -890.4725453702937, -23.31211792932681, -176.43782215963472, -862.9369596248283, -862.8533495677731, -1037.651128406962, -777.2091808188626, -529.088007937105, -1139.2131553058034, -323.65097923423366, -661.3360569977566, -945.0523066515944, -980.1307446201788, -515.6337686988439, -463.2579544384103, -1045.730777376615, -1100.2885583443613, -792.5737883790821, -435.741912785501, -940.9308708207762, -938.9047874924333, -237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5487811043805668, "mean_inference_ms": 1.6423585270672796, "mean_action_processing_ms": 0.27359160771790775, "mean_env_wait_ms": 3.2990501709161957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02486109733581543, "StateBufferConnector_ms": 0.008112192153930664, "ViewRequirementAgentConnector_ms": 0.19111013412475586}, "num_episodes": 30, "episode_return_max": -17.33117156986509, "episode_return_min": -1357.0833710891363, "episode_return_mean": -707.3290024656972, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.9241811756815, "num_env_steps_trained_throughput_per_sec": 398.9241811756815, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9722.557, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9722.487, "sample_time_ms": 1101.363, "learn_time_ms": 8555.504, "learn_throughput": 467.535, "synch_weights_time_ms": 64.827}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "89531_00000", "date": "2024-08-05_11-14-28", "timestamp": 1722836668, "time_this_iter_s": 10.039682388305664, "time_total_s": 87.60243892669678, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b8d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.60243892669678, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.092857142857145, "ram_util_percent": 28.807142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.41062327524025, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9134024697045485, "policy_loss": -0.01284350032316676, "vf_loss": 0.9235930043893555, "vf_explained_var": 0.992575371824205, "kl": 0.013848331280557128, "entropy": 1.1669914505134027, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -17.33117156986509, "episode_reward_min": -1357.0833710891363, "episode_reward_mean": -674.7110110983681, "episode_len_mean": 128.63, "episode_media": {}, "episodes_timesteps_total": 12863, "policy_reward_min": {"policy_0": -1357.0833710891363}, "policy_reward_max": {"policy_0": -17.33117156986509}, "policy_reward_mean": {"policy_0": -674.7110110983681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186], "episode_lengths": [74, 117, 60, 150, 150, 150, 95, 150, 150, 150, 87, 150, 150, 150, 144, 150, 82, 150, 150, 112, 43, 150, 150, 150, 150, 150, 150, 150, 150, 40, 66, 150, 150, 150, 51, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 93, 113, 150, 150, 150, 150, 150, 150, 87, 34, 150, 150, 150, 150, 150, 118, 150, 111, 54, 55, 150, 97, 150, 150, 132, 41, 150, 150, 63, 150, 150, 150, 150, 150, 150, 63, 104, 150, 150, 150, 87, 150, 71, 150, 150, 150, 150, 57, 150, 150, 116, 150, 150], "policy_policy_0_reward": [-237.69534130781543, -566.991421644302, -141.6368319788852, -742.1134474454146, -1349.1997543367495, -873.2627666997518, -364.52688621793106, -1351.239625636813, -1030.8570015731718, -1221.7180147156685, -361.11018294972894, -745.5482998482644, -800.7793351119902, -1097.0729690593812, -479.8294778418828, -871.4959814126587, -312.4738119688157, -638.6088759723266, -566.8118096433496, -498.05011951767483, -61.24581248393442, -1054.9831110898833, -612.216055609171, -827.7558502896853, -762.5944907419648, -789.9658691184763, -615.6764045471106, -890.6953265938114, -1060.0845963651427, -17.33117156986509, -106.04372053519585, -1202.90462326256, -835.8424977470078, -386.4011762050905, -98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5486357507602857, "mean_inference_ms": 1.6417656921062551, "mean_action_processing_ms": 0.27308095378604974, "mean_env_wait_ms": 3.301231320802351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024616718292236328, "StateBufferConnector_ms": 0.007916927337646484, "ViewRequirementAgentConnector_ms": 0.18867707252502441}, "num_episodes": 29, "episode_return_max": -17.33117156986509, "episode_return_min": -1357.0833710891363, "episode_return_mean": -674.7110110983681, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.8588338943558, "num_env_steps_trained_throughput_per_sec": 379.8588338943558, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 9803.326, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9803.254, "sample_time_ms": 1101.067, "learn_time_ms": 8635.633, "learn_throughput": 463.197, "synch_weights_time_ms": 65.743}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "89531_00000", "date": "2024-08-05_11-14-38", "timestamp": 1722836678, "time_this_iter_s": 10.542680025100708, "time_total_s": 98.14511895179749, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.14511895179749, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.126666666666665, "ram_util_percent": 28.806666666666672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.71593422691026, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0570389189136524, "policy_loss": -0.01204805736730729, "vf_loss": 1.0657083492105206, "vf_explained_var": 0.9919577823330958, "kl": 0.017436311949616843, "entropy": 1.0863568613926569, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -15.323361610449188, "episode_reward_min": -1380.0838896440298, "episode_reward_mean": -673.9427081521069, "episode_len_mean": 130.68, "episode_media": {}, "episodes_timesteps_total": 13068, "policy_reward_min": {"policy_0": -1380.0838896440298}, "policy_reward_max": {"policy_0": -15.323361610449188}, "policy_reward_mean": {"policy_0": -673.9427081521069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897], "episode_lengths": [51, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 93, 113, 150, 150, 150, 150, 150, 150, 87, 34, 150, 150, 150, 150, 150, 118, 150, 111, 54, 55, 150, 97, 150, 150, 132, 41, 150, 150, 63, 150, 150, 150, 150, 150, 150, 63, 104, 150, 150, 150, 87, 150, 71, 150, 150, 150, 150, 57, 150, 150, 116, 150, 150, 150, 150, 150, 150, 84, 150, 150, 132, 150, 150, 150, 150, 150, 95, 150, 133, 30, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 68, 82, 150, 106], "policy_policy_0_reward": [-98.16272222098956, -870.6326857244458, -1357.0833710891363, -1027.6193391425945, -1182.625880928295, -45.85743425042066, -1076.6428367727106, -315.2979286916665, -949.1760136207096, -549.1264365946676, -881.5465794613506, -1010.0240817841293, -835.4336901055801, -212.95633018241645, -562.346430604804, -942.8299634300404, -343.065625630709, -684.1553800816423, -899.286137436157, -1044.8056628666732, -687.3097221720211, -310.22498685489063, -33.26928843900999, -828.0391684225774, -531.5498096408303, -577.3968141187453, -908.4773992041162, -988.0718428294045, -538.3247295262422, -1026.3329957165813, -287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481679069514631, "mean_inference_ms": 1.6410389558172165, "mean_action_processing_ms": 0.27272828482532097, "mean_env_wait_ms": 3.305160920757129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012405157089233398, "StateBufferConnector_ms": 0.007826566696166992, "ViewRequirementAgentConnector_ms": 0.1859149932861328}, "num_episodes": 34, "episode_return_max": -15.323361610449188, "episode_return_min": -1380.0838896440298, "episode_return_mean": -673.9427081521069, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.6203593474654, "num_env_steps_trained_throughput_per_sec": 326.6203593474654, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10019.35, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10019.278, "sample_time_ms": 1105.512, "learn_time_ms": 8849.176, "learn_throughput": 452.019, "synch_weights_time_ms": 63.771}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "89531_00000", "date": "2024-08-05_11-14-51", "timestamp": 1722836691, "time_this_iter_s": 12.259785175323486, "time_total_s": 110.40490412712097, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.40490412712097, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.177777777777777, "ram_util_percent": 28.805555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.271815948685, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9222037434888383, "policy_loss": -0.009722185396337105, "vf_loss": 0.9292514365166425, "vf_explained_var": 0.9966742420569062, "kl": 0.013928089871963796, "entropy": 1.1112691120555003, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -10.97465373429061, "episode_reward_min": -1380.0838896440298, "episode_reward_mean": -664.226989606739, "episode_len_mean": 130.47, "episode_media": {}, "episodes_timesteps_total": 13047, "policy_reward_min": {"policy_0": -1380.0838896440298}, "policy_reward_max": {"policy_0": -10.97465373429061}, "policy_reward_mean": {"policy_0": -664.226989606739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292], "episode_lengths": [111, 54, 55, 150, 97, 150, 150, 132, 41, 150, 150, 63, 150, 150, 150, 150, 150, 150, 63, 104, 150, 150, 150, 87, 150, 71, 150, 150, 150, 150, 57, 150, 150, 116, 150, 150, 150, 150, 150, 150, 84, 150, 150, 132, 150, 150, 150, 150, 150, 95, 150, 133, 30, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 68, 82, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 47, 94, 150, 150, 101, 101, 150, 150, 150, 41, 150, 62, 150], "policy_policy_0_reward": [-287.31526541008026, -57.37442089058633, -69.78799851945826, -814.7731367245002, -260.8052734551347, -1017.8728325774185, -933.3537426205407, -683.625532741479, -37.873766530002506, -1271.9935688413818, -793.4065441247108, -122.3426659729571, -624.3806042446972, -686.0900165328592, -1030.7116837705405, -1246.8499290536759, -597.6949853219091, -1125.9563729594172, -183.04682051879212, -389.8819940158541, -757.1345707308169, -1191.5438518435672, -793.9493058520371, -233.938665370815, -963.3673174379217, -74.67254298610301, -490.46873581969334, -1039.4630230071252, -905.148465493032, -618.4847626458601, -168.82890075408375, -576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5477460479574802, "mean_inference_ms": 1.6402209460494033, "mean_action_processing_ms": 0.272555201097552, "mean_env_wait_ms": 3.3065331603811305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012429952621459961, "StateBufferConnector_ms": 0.007821798324584961, "ViewRequirementAgentConnector_ms": 0.1864473819732666}, "num_episodes": 30, "episode_return_max": -10.97465373429061, "episode_return_min": -1380.0838896440298, "episode_return_mean": -664.226989606739, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.74125941313963, "num_env_steps_trained_throughput_per_sec": 386.74125941313963, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10128.947, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10128.875, "sample_time_ms": 1108.052, "learn_time_ms": 8954.639, "learn_throughput": 446.696, "synch_weights_time_ms": 65.359}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "89531_00000", "date": "2024-08-05_11-15-01", "timestamp": 1722836701, "time_this_iter_s": 10.353893518447876, "time_total_s": 120.75879764556885, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.75879764556885, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.473333333333336, "ram_util_percent": 28.820000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.53122533559798, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1712452866137029, "policy_loss": -0.008226953486155254, "vf_loss": 1.1768368740876516, "vf_explained_var": 0.9910008356596033, "kl": 0.013739551795242732, "entropy": 1.1254202987998725, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -10.97465373429061, "episode_reward_min": -1380.0838896440298, "episode_reward_mean": -648.5653620019513, "episode_len_mean": 130.62, "episode_media": {}, "episodes_timesteps_total": 13062, "policy_reward_min": {"policy_0": -1380.0838896440298}, "policy_reward_max": {"policy_0": -10.97465373429061}, "policy_reward_mean": {"policy_0": -648.5653620019513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283], "episode_lengths": [150, 150, 116, 150, 150, 150, 150, 150, 150, 84, 150, 150, 132, 150, 150, 150, 150, 150, 95, 150, 133, 30, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 68, 82, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 47, 94, 150, 150, 101, 101, 150, 150, 150, 41, 150, 62, 150, 150, 150, 150, 45, 128, 150, 150, 150, 85, 150, 150, 150, 99, 150, 150, 150, 70, 150, 150, 102, 150, 95, 150, 95, 57, 48, 61, 65, 150, 150, 150], "policy_policy_0_reward": [-576.7336074470769, -674.5234778755066, -594.8800580049791, -426.5999349869312, -933.7927861702186, -1380.0838896440298, -459.8127690396145, -602.881990430493, -1144.585878329659, -299.59765831109075, -755.1529660975949, -818.0951396860016, -491.4592974304547, -844.4744949748969, -411.31160832480225, -1087.2485207610036, -754.4876065493784, -1316.2008788734845, -416.3097847874638, -434.596381036722, -426.5515712639081, -15.323361610449188, -595.5752529977157, -1082.9482005733537, -692.6860168110201, -1110.4459204793484, -443.1502434339573, -1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5472969890029045, "mean_inference_ms": 1.6391025009398064, "mean_action_processing_ms": 0.2723535918943537, "mean_env_wait_ms": 3.3052645792276003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012393474578857422, "StateBufferConnector_ms": 0.00773310661315918, "ViewRequirementAgentConnector_ms": 0.18625473976135254}, "num_episodes": 31, "episode_return_max": -10.97465373429061, "episode_return_min": -1380.0838896440298, "episode_return_mean": -648.5653620019513, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.572866485608, "num_env_steps_trained_throughput_per_sec": 336.572866485608, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10355.574, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10355.5, "sample_time_ms": 1104.289, "learn_time_ms": 9185.912, "learn_throughput": 435.449, "synch_weights_time_ms": 64.457}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "89531_00000", "date": "2024-08-05_11-15-13", "timestamp": 1722836713, "time_this_iter_s": 11.896950721740723, "time_total_s": 132.65574836730957, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664334f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.65574836730957, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.358823529411765, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 164.9233709712823, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.064949501461039, "policy_loss": -0.010607064701616764, "vf_loss": 1.072318149699519, "vf_explained_var": 0.9964732442672054, "kl": 0.016735161560124348, "entropy": 1.0861583284412821, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -10.97465373429061, "episode_reward_min": -1452.3869317782494, "episode_reward_mean": -643.3291897129421, "episode_len_mean": 129.62, "episode_media": {}, "episodes_timesteps_total": 12962, "policy_reward_min": {"policy_0": -1452.3869317782494}, "policy_reward_max": {"policy_0": -10.97465373429061}, "policy_reward_mean": {"policy_0": -643.3291897129421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881], "episode_lengths": [150, 95, 150, 150, 150, 150, 150, 150, 68, 82, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 47, 94, 150, 150, 101, 101, 150, 150, 150, 41, 150, 62, 150, 150, 150, 150, 45, 128, 150, 150, 150, 85, 150, 150, 150, 99, 150, 150, 150, 70, 150, 150, 102, 150, 95, 150, 95, 57, 48, 61, 65, 150, 150, 150, 150, 83, 91, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 87, 150, 150, 75, 116, 147], "policy_policy_0_reward": [-1012.2412654429219, -355.68316229833056, -998.7440467983381, -1004.2768394960198, -764.5928701948208, -543.9132939133397, -747.1340869909993, -1112.1623954595407, -139.57359682368565, -292.8991740538224, -508.75884326721456, -334.973360229897, -867.72461079478, -1033.9808477149695, -848.897598044868, -699.3382493830348, -1059.089893260625, -1046.734471546602, -983.30685018422, -1062.991906274473, -989.8322025184909, -179.45586757305796, -879.7326949161219, -962.7960636404601, -569.208834550715, -670.7018384531868, -403.73965695410647, -904.2588023530037, -1004.5339848610336, -22.01547182545889, -225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5471722213637704, "mean_inference_ms": 1.637459851735384, "mean_action_processing_ms": 0.2722619284614936, "mean_env_wait_ms": 3.304961923905367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012288570404052734, "StateBufferConnector_ms": 0.00771784782409668, "ViewRequirementAgentConnector_ms": 0.19054126739501953}, "num_episodes": 27, "episode_return_max": -10.97465373429061, "episode_return_min": -1452.3869317782494, "episode_return_mean": -643.3291897129421, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.2996464126473, "num_env_steps_trained_throughput_per_sec": 375.2996464126473, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10513.32, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10513.247, "sample_time_ms": 1106.857, "learn_time_ms": 9341.863, "learn_throughput": 428.18, "synch_weights_time_ms": 63.682}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "89531_00000", "date": "2024-08-05_11-15-24", "timestamp": 1722836724, "time_this_iter_s": 10.670259475708008, "time_total_s": 143.32600784301758, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b8dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.32600784301758, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.46666666666666, "ram_util_percent": 28.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.3241978844007, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2035086781717836, "policy_loss": -0.010746790287278903, "vf_loss": 1.2111830698947113, "vf_explained_var": 0.9915946171308557, "kl": 0.01585370818587157, "entropy": 0.9834252614527941, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -2.9353850156731784, "episode_reward_min": -1452.3869317782494, "episode_reward_mean": -618.4936321326888, "episode_len_mean": 128.98, "episode_media": {}, "episodes_timesteps_total": 12898, "policy_reward_min": {"policy_0": -1452.3869317782494}, "policy_reward_max": {"policy_0": -2.9353850156731784}, "policy_reward_mean": {"policy_0": -618.4936321326888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152], "episode_lengths": [94, 150, 150, 101, 101, 150, 150, 150, 41, 150, 62, 150, 150, 150, 150, 45, 128, 150, 150, 150, 85, 150, 150, 150, 99, 150, 150, 150, 70, 150, 150, 102, 150, 95, 150, 95, 57, 48, 61, 65, 150, 150, 150, 150, 83, 91, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 87, 150, 150, 75, 116, 147, 150, 80, 150, 150, 150, 128, 150, 139, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 71, 150, 57, 150, 150, 150, 49], "policy_policy_0_reward": [-225.07343611415627, -575.3812171778377, -807.5933168206002, -418.9675540399581, -372.9387359900959, -430.68367576962635, -687.4029676591858, -966.1166814937633, -10.97465373429061, -578.1407754181071, -83.0348051902207, -1001.4517687497292, -1169.1521225734903, -468.1405899975815, -1245.0574020733397, -12.502224053810005, -550.8511084928768, -857.5484218619089, -642.7159489225629, -486.3003811752958, -290.3204028158852, -997.3984709800159, -296.35509709165194, -921.8243217398893, -353.8038805691015, -1080.4345091031516, -666.4244815376711, -521.7353748575938, -135.86225702537666, -1037.9508574131532, -847.0954048976332, -210.29610194254815, -444.65688639999655, -317.4520676777318, -1081.7358324724648, -166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5473353056382442, "mean_inference_ms": 1.6374782863299737, "mean_action_processing_ms": 0.27212890458076466, "mean_env_wait_ms": 3.3060314980273433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011992216110229492, "StateBufferConnector_ms": 0.007816553115844727, "ViewRequirementAgentConnector_ms": 0.19281935691833496}, "num_episodes": 30, "episode_return_max": -2.9353850156731784, "episode_return_min": -1452.3869317782494, "episode_return_mean": -618.4936321326888, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.11703515778186, "num_env_steps_trained_throughput_per_sec": 467.11703515778186, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10348.356, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10348.282, "sample_time_ms": 1111.353, "learn_time_ms": 9171.361, "learn_throughput": 436.14, "synch_weights_time_ms": 64.685}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "89531_00000", "date": "2024-08-05_11-15-32", "timestamp": 1722836732, "time_this_iter_s": 8.574271440505981, "time_total_s": 151.90027928352356, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 151.90027928352356, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.725000000000005, "ram_util_percent": 28.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.728173755606, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1163098671784004, "policy_loss": -0.008143948063176747, "vf_loss": 1.1215204194188118, "vf_explained_var": 0.9888992422570785, "kl": 0.01518717519150717, "entropy": 1.040415544869999, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -2.9353850156731784, "episode_reward_min": -1452.3869317782494, "episode_reward_mean": -610.6330615662779, "episode_len_mean": 130.84, "episode_media": {}, "episodes_timesteps_total": 13084, "policy_reward_min": {"policy_0": -1452.3869317782494}, "policy_reward_max": {"policy_0": -2.9353850156731784}, "policy_reward_mean": {"policy_0": -610.6330615662779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744], "episode_lengths": [95, 57, 48, 61, 65, 150, 150, 150, 150, 83, 91, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 87, 150, 150, 75, 116, 147, 150, 80, 150, 150, 150, 128, 150, 139, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 71, 150, 57, 150, 150, 150, 49, 150, 68, 150, 150, 150, 150, 134, 150, 150, 150, 150, 61, 150, 84, 106, 90, 150, 150, 150, 150, 150, 150, 46, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150], "policy_policy_0_reward": [-166.679251338677, -104.16581158661296, -78.72224055703806, -57.146056590644335, -136.5561575829182, -537.5148435368094, -1094.2072082305497, -1095.368821190283, -1076.6485015007886, -288.82864609449655, -267.30074380976555, -872.0020643400283, -638.2998094558368, -600.0806522114366, -1032.630855643309, -573.4235275962399, -1133.499821485602, -576.8219904301507, -688.2195383894051, -582.3432497127371, -409.76078238152, -1053.7583823018745, -1452.3869317782494, -970.5774078485989, -476.53400330029797, -149.40967617653592, -596.0312352701358, -1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5478433013742238, "mean_inference_ms": 1.6409051857766883, "mean_action_processing_ms": 0.27259330616328187, "mean_env_wait_ms": 3.3131545596089995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01187443733215332, "StateBufferConnector_ms": 0.007937908172607422, "ViewRequirementAgentConnector_ms": 0.20386433601379395}, "num_episodes": 35, "episode_return_max": -2.9353850156731784, "episode_return_min": -1452.3869317782494, "episode_return_mean": -610.6330615662779, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.6268329291831, "num_env_steps_trained_throughput_per_sec": 413.6268329291831, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10140.641, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10140.568, "sample_time_ms": 1123.261, "learn_time_ms": 8951.909, "learn_throughput": 446.832, "synch_weights_time_ms": 64.518}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "89531_00000", "date": "2024-08-05_11-15-42", "timestamp": 1722836742, "time_this_iter_s": 9.682621717453003, "time_total_s": 161.58290100097656, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643ba5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 161.58290100097656, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.16428571428571, "ram_util_percent": 28.892857142857135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.35571341216564, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9864589354644219, "policy_loss": -0.011004175612470135, "vf_loss": 0.9944567191414535, "vf_explained_var": 0.9934775720660886, "kl": 0.015530819103241824, "entropy": 0.9977414732178053, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -2.9353850156731784, "episode_reward_min": -1450.2387953813025, "episode_reward_mean": -608.7904173154125, "episode_len_mean": 133.13, "episode_media": {}, "episodes_timesteps_total": 13313, "policy_reward_min": {"policy_0": -1450.2387953813025}, "policy_reward_max": {"policy_0": -2.9353850156731784}, "policy_reward_mean": {"policy_0": -608.7904173154125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105], "episode_lengths": [150, 150, 87, 150, 150, 75, 116, 147, 150, 80, 150, 150, 150, 128, 150, 139, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 71, 150, 57, 150, 150, 150, 49, 150, 68, 150, 150, 150, 150, 134, 150, 150, 150, 150, 61, 150, 84, 106, 90, 150, 150, 150, 150, 150, 150, 46, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 90, 129, 150, 104, 86, 150, 150, 119, 150, 150, 150, 70, 79, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1137.2844776668173, -1380.996300253591, -239.00874180072682, -521.2613920750298, -399.8104907715458, -233.0625047822449, -426.6764657980792, -489.2338741551881, -523.3344977952629, -298.54649408680615, -997.9890188331069, -1450.2387953813025, -390.86515743220656, -555.7370203570019, -688.1462187948118, -467.2960532175377, -1181.4523771061874, -512.1425940297432, -373.0878138152151, -928.2981655710117, -681.6748447588225, -584.2883657506216, -979.0618671430581, -2.9353850156731784, -797.7000672539679, -1187.2999055198889, -616.4425344613823, -563.7360160165234, -837.7871492147505, -477.5232370476811, -1066.5604344603494, -138.48820098498248, -279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5483958462861878, "mean_inference_ms": 1.6436120039918651, "mean_action_processing_ms": 0.27283218565633555, "mean_env_wait_ms": 3.3180217165036283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011572122573852539, "StateBufferConnector_ms": 0.007948875427246094, "ViewRequirementAgentConnector_ms": 0.2004687786102295}, "num_episodes": 27, "episode_return_max": -2.9353850156731784, "episode_return_min": -1450.2387953813025, "episode_return_mean": -608.7904173154125, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.12781864114635, "num_env_steps_trained_throughput_per_sec": 430.12781864114635, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10135.422, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10135.35, "sample_time_ms": 1122.477, "learn_time_ms": 8947.379, "learn_throughput": 447.058, "synch_weights_time_ms": 64.616}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "89531_00000", "date": "2024-08-05_11-15-51", "timestamp": 1722836751, "time_this_iter_s": 9.31229019165039, "time_total_s": 170.89519119262695, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.89519119262695, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.01538461538462, "ram_util_percent": 28.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.5238304545482, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0080644764006137, "policy_loss": -0.00878164199287615, "vf_loss": 1.013505367996792, "vf_explained_var": 0.996527043171227, "kl": 0.017203042768718053, "entropy": 0.9985931466023127, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.49081984962152, "episode_reward_min": -1330.6282365368227, "episode_reward_mean": -564.8295436154971, "episode_len_mean": 129.75, "episode_media": {}, "episodes_timesteps_total": 12975, "policy_reward_min": {"policy_0": -1330.6282365368227}, "policy_reward_max": {"policy_0": -23.49081984962152}, "policy_reward_mean": {"policy_0": -564.8295436154971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587], "episode_lengths": [150, 57, 150, 150, 150, 49, 150, 68, 150, 150, 150, 150, 134, 150, 150, 150, 150, 61, 150, 84, 106, 90, 150, 150, 150, 150, 150, 150, 46, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 90, 129, 150, 104, 86, 150, 150, 119, 150, 150, 150, 70, 79, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 71, 73, 66, 150, 127, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 51, 58, 150, 150, 132, 150, 150, 62, 150, 150, 150, 60, 150], "policy_policy_0_reward": [-279.49412032198614, -78.28194312201406, -752.4443146955805, -999.4622845968469, -1085.9313251588783, -23.49081984962152, -924.7769269675251, -110.56635619588053, -1142.754596242987, -411.4311690906988, -647.2778935559802, -290.9621543797425, -696.0604891035357, -555.7682949307812, -581.5304325933536, -646.3326870066979, -587.850743985949, -71.18111709724396, -926.8793361422202, -204.42659357407234, -429.09510126607506, -328.3004666509426, -1158.4252320588637, -794.3051007578232, -370.33812491552874, -433.0064918418177, -639.4741493834706, -494.25393887129485, -38.22195164488398, -511.8330749899656, -467.6379822845397, -336.2660053691614, -615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493100229442148, "mean_inference_ms": 1.6453146166211368, "mean_action_processing_ms": 0.27309652818726404, "mean_env_wait_ms": 3.3235216375928527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011911153793334961, "StateBufferConnector_ms": 0.007858991622924805, "ViewRequirementAgentConnector_ms": 0.19989228248596191}, "num_episodes": 32, "episode_return_max": -23.49081984962152, "episode_return_min": -1330.6282365368227, "episode_return_mean": -564.8295436154971, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.24477832998133, "num_env_steps_trained_throughput_per_sec": 409.24477832998133, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10299.683, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10299.61, "sample_time_ms": 1110.484, "learn_time_ms": 9125.048, "learn_throughput": 438.354, "synch_weights_time_ms": 63.206}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "89531_00000", "date": "2024-08-05_11-16-01", "timestamp": 1722836761, "time_this_iter_s": 9.784766674041748, "time_total_s": 180.6799578666687, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.6799578666687, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.099999999999998, "ram_util_percent": 28.899999999999988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.3118789811929, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.059972982046505, "policy_loss": -0.010019655689635936, "vf_loss": 1.0669805633525054, "vf_explained_var": 0.9881680886571605, "kl": 0.01553422305638986, "entropy": 0.9476928928866982, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -14.691923149403362, "episode_reward_min": -1390.9016278620675, "episode_reward_mean": -595.2097699551812, "episode_len_mean": 130.06, "episode_media": {}, "episodes_timesteps_total": 13006, "policy_reward_min": {"policy_0": -1390.9016278620675}, "policy_reward_max": {"policy_0": -14.691923149403362}, "policy_reward_mean": {"policy_0": -595.2097699551812}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 54, 150, 90, 129, 150, 104, 86, 150, 150, 119, 150, 150, 150, 70, 79, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 71, 73, 66, 150, 127, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 51, 58, 150, 150, 132, 150, 150, 62, 150, 150, 150, 60, 150, 150, 49, 119, 37, 91, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 143, 150, 131, 100, 150, 92, 131, 47, 150, 150], "policy_policy_0_reward": [-615.91121199075, -1182.9300381499713, -364.8281960957618, -683.0056719320787, -1138.0524877757657, -541.0300788345768, -1234.0106092141898, -43.64489016540835, -404.9470821316744, -238.3615577165233, -383.7704304868192, -410.00998501035133, -300.7846972978044, -182.73903563783887, -701.0892309163318, -1057.4820863107363, -460.6916071431222, -722.6147734494796, -981.3247142695152, -587.7344420130479, -115.63259949281716, -253.54410045286048, -478.735437015361, -237.77491540017525, -277.1588290673172, -804.0784233434613, -788.0823771040658, -1246.1750753146619, -507.2427034897028, -392.5605968478834, -821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5491704662147275, "mean_inference_ms": 1.6431221364460107, "mean_action_processing_ms": 0.2726585208653787, "mean_env_wait_ms": 3.318083861929955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199483871459961, "StateBufferConnector_ms": 0.007811784744262695, "ViewRequirementAgentConnector_ms": 0.18850970268249512}, "num_episodes": 32, "episode_return_max": -14.691923149403362, "episode_return_min": -1390.9016278620675, "episode_return_mean": -595.2097699551812, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.1147981327326, "num_env_steps_trained_throughput_per_sec": 485.1147981327326, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10121.533, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10121.46, "sample_time_ms": 1109.53, "learn_time_ms": 8948.266, "learn_throughput": 447.014, "synch_weights_time_ms": 62.812}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "89531_00000", "date": "2024-08-05_11-16-10", "timestamp": 1722836770, "time_this_iter_s": 8.254626512527466, "time_total_s": 188.93458437919617, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.93458437919617, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.958333333333336, "ram_util_percent": 28.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.31318177878856, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9545278502938648, "policy_loss": -0.0148230770311784, "vf_loss": 0.9652327678476771, "vf_explained_var": 0.9979980998362105, "kl": 0.02107446232039365, "entropy": 0.9673692358036836, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -14.691923149403362, "episode_reward_min": -1390.9016278620675, "episode_reward_mean": -571.1861889926937, "episode_len_mean": 127.95, "episode_media": {}, "episodes_timesteps_total": 12795, "policy_reward_min": {"policy_0": -1390.9016278620675}, "policy_reward_max": {"policy_0": -14.691923149403362}, "policy_reward_mean": {"policy_0": -571.1861889926937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 71, 73, 66, 150, 127, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 51, 58, 150, 150, 132, 150, 150, 62, 150, 150, 150, 60, 150, 150, 49, 119, 37, 91, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 143, 150, 131, 100, 150, 92, 131, 47, 150, 150, 56, 69, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 55, 150, 150, 150, 150, 150, 75, 150, 150, 150, 80, 42, 150, 58, 150, 88, 150], "policy_policy_0_reward": [-821.2354342270198, -1207.4948551087623, -919.7870842523088, -1053.847140160394, -930.5241385363425, -464.17751518928105, -451.71053654330984, -240.29983750845074, -426.3783857298789, -150.98363290308816, -103.40023121603892, -283.9529558253882, -64.71394368858151, -412.3303296104494, -356.00888424072, -459.8789526367099, -807.4170870518425, -509.4003925995543, -1169.231677515766, -1330.6282365368227, -598.8719242524571, -813.2749393754052, -139.25161029708335, -1210.1491108670639, -872.9832647756755, -43.09292961763167, -138.52117961341628, -541.4562478500934, -1254.821239699142, -410.5491334931223, -885.1609837493875, -347.81089493480675, -187.1096312484107, -394.62209795170486, -973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.549521524988115, "mean_inference_ms": 1.6435050824530189, "mean_action_processing_ms": 0.2727584732854189, "mean_env_wait_ms": 3.318366008465925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012130975723266602, "StateBufferConnector_ms": 0.007930517196655273, "ViewRequirementAgentConnector_ms": 0.19176840782165527}, "num_episodes": 30, "episode_return_max": -14.691923149403362, "episode_return_min": -1390.9016278620675, "episode_return_mean": -571.1861889926937, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.79525961194923, "num_env_steps_trained_throughput_per_sec": 383.79525961194923, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10110.732, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10110.661, "sample_time_ms": 1107.095, "learn_time_ms": 8940.244, "learn_throughput": 447.415, "synch_weights_time_ms": 62.481}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "89531_00000", "date": "2024-08-05_11-16-20", "timestamp": 1722836780, "time_this_iter_s": 10.433847665786743, "time_total_s": 199.3684320449829, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b93f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.3684320449829, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.313333333333333, "ram_util_percent": 28.893333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.19716523687046, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.236364517888675, "policy_loss": -0.013609244441128491, "vf_loss": 1.2451324442711968, "vf_explained_var": 0.9940489691371719, "kl": 0.01645551502527572, "entropy": 0.9533669136464595, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -14.691923149403362, "episode_reward_min": -1390.9016278620675, "episode_reward_mean": -560.4148824616157, "episode_len_mean": 127.77, "episode_media": {}, "episodes_timesteps_total": 12777, "policy_reward_min": {"policy_0": -1390.9016278620675}, "policy_reward_max": {"policy_0": -14.691923149403362}, "policy_reward_mean": {"policy_0": -560.4148824616157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634], "episode_lengths": [150, 150, 60, 150, 150, 49, 119, 37, 91, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 143, 150, 131, 100, 150, 92, 131, 47, 150, 150, 56, 69, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 55, 150, 150, 150, 150, 150, 75, 150, 150, 150, 80, 42, 150, 58, 150, 88, 150, 150, 60, 54, 150, 150, 136, 74, 150, 150, 80, 150, 150, 150, 139, 150, 129, 131, 150, 150, 106, 150, 150, 87, 150, 150, 67, 72, 150, 150, 150, 150, 150, 77, 150], "policy_policy_0_reward": [-973.1425242748587, -533.6404329510572, -147.18667053230618, -473.8991922693587, -1304.2670858701777, -49.22621971592961, -426.4028410923426, -14.691923149403362, -308.80335992656177, -592.7284593676138, -385.5643775054024, -463.55591772158897, -960.2310961329654, -578.5733544414906, -150.9192310081608, -350.2952670222172, -1042.130934875692, -664.3793474334633, -749.8203724645474, -859.2513248529643, -999.1199538131349, -426.4889004645921, -1101.8166406240605, -790.9645631526939, -583.2602069162491, -614.1898381188304, -675.1773558951847, -1390.9016278620675, -413.0461295642365, -460.1778436546243, -502.49071193068716, -381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5495829175452855, "mean_inference_ms": 1.6429569037801353, "mean_action_processing_ms": 0.2725032814185098, "mean_env_wait_ms": 3.3143037041469587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011829376220703125, "StateBufferConnector_ms": 0.008035421371459961, "ViewRequirementAgentConnector_ms": 0.19070744514465332}, "num_episodes": 34, "episode_return_max": -14.691923149403362, "episode_return_min": -1390.9016278620675, "episode_return_mean": -560.4148824616157, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.1040332117372, "num_env_steps_trained_throughput_per_sec": 419.1040332117372, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9840.486, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9840.413, "sample_time_ms": 1101.163, "learn_time_ms": 8674.844, "learn_throughput": 461.103, "synch_weights_time_ms": 63.574}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "89531_00000", "date": "2024-08-05_11-16-30", "timestamp": 1722836790, "time_this_iter_s": 9.557326316833496, "time_total_s": 208.9257583618164, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.9257583618164, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.46923076923077, "ram_util_percent": 28.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.65184747676054, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0070396986790002, "policy_loss": -0.007477433039942601, "vf_loss": 1.0107085723740359, "vf_explained_var": 0.9887614471216997, "kl": 0.013034239470789544, "entropy": 1.0171683810651302, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -22.812472019081696, "episode_reward_min": -1361.3591311978287, "episode_reward_mean": -540.1027944096979, "episode_len_mean": 125.86, "episode_media": {}, "episodes_timesteps_total": 12586, "policy_reward_min": {"policy_0": -1361.3591311978287}, "policy_reward_max": {"policy_0": -22.812472019081696}, "policy_reward_mean": {"policy_0": -540.1027944096979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281], "episode_lengths": [92, 131, 47, 150, 150, 56, 69, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 55, 150, 150, 150, 150, 150, 75, 150, 150, 150, 80, 42, 150, 58, 150, 88, 150, 150, 60, 54, 150, 150, 136, 74, 150, 150, 80, 150, 150, 150, 139, 150, 129, 131, 150, 150, 106, 150, 150, 87, 150, 150, 67, 72, 150, 150, 150, 150, 150, 77, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 147, 69, 150, 150, 85, 115, 91, 66, 95, 147, 150, 57, 150, 150, 150, 68, 150, 150, 150, 36, 150, 150], "policy_policy_0_reward": [-381.01312251937657, -735.9945453204365, -45.44974089185026, -1070.2008192422727, -964.9507400635634, -55.29927167266022, -142.67751627213661, -622.0680087624039, -984.0558075103634, -452.50807457452083, -363.80398491710514, -817.1642035881287, -1146.4991516697532, -551.315794388016, -234.69278183267366, -522.636172769266, -1349.4060174347928, -513.5242459204985, -98.88916699114917, -928.5327655086571, -531.8945524146915, -436.96185119027183, -453.1876798393713, -808.6880173741952, -129.5281678193212, -807.5278448351306, -480.452980840869, -455.58100831592435, -131.71137712787015, -83.19402918054219, -402.4079270250984, -95.51479825106021, -571.4505350150544, -191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5497796347744452, "mean_inference_ms": 1.6427669614961704, "mean_action_processing_ms": 0.27219349785718777, "mean_env_wait_ms": 3.3115733510595224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011986255645751953, "StateBufferConnector_ms": 0.007936477661132812, "ViewRequirementAgentConnector_ms": 0.19498467445373535}, "num_episodes": 31, "episode_return_max": -22.812472019081696, "episode_return_min": -1361.3591311978287, "episode_return_mean": -540.1027944096979, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.58761753035753, "num_env_steps_trained_throughput_per_sec": 361.58761753035753, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9912.435, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9912.363, "sample_time_ms": 1101.318, "learn_time_ms": 8749.068, "learn_throughput": 457.192, "synch_weights_time_ms": 61.148}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "89531_00000", "date": "2024-08-05_11-16-41", "timestamp": 1722836801, "time_this_iter_s": 11.074678897857666, "time_total_s": 220.00043725967407, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.00043725967407, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.4875, "ram_util_percent": 28.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.71799809634686, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9574169940625628, "policy_loss": -0.015009371551180569, "vf_loss": 0.967098350605617, "vf_explained_var": 0.9970416654522221, "kl": 0.018078588932667117, "entropy": 0.9556485539923112, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -22.812472019081696, "episode_reward_min": -1369.0069558027697, "episode_reward_mean": -528.9731442911079, "episode_len_mean": 127.54, "episode_media": {}, "episodes_timesteps_total": 12754, "policy_reward_min": {"policy_0": -1369.0069558027697}, "policy_reward_max": {"policy_0": -22.812472019081696}, "policy_reward_mean": {"policy_0": -528.9731442911079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556], "episode_lengths": [88, 150, 150, 60, 54, 150, 150, 136, 74, 150, 150, 80, 150, 150, 150, 139, 150, 129, 131, 150, 150, 106, 150, 150, 87, 150, 150, 67, 72, 150, 150, 150, 150, 150, 77, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 147, 69, 150, 150, 85, 115, 91, 66, 95, 147, 150, 57, 150, 150, 150, 68, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 94, 93, 150, 150, 150, 145, 150, 150, 150, 150, 121, 98, 48, 43, 150, 150, 150, 69, 150, 132, 138, 150, 150, 55, 150, 150, 77], "policy_policy_0_reward": [-191.93648553076457, -570.4795692489988, -537.8125162245836, -69.36063011108932, -35.576105874602185, -405.5603842481708, -1361.3591311978287, -456.4801324996762, -123.66294009216067, -735.8973708985487, -867.2115840729765, -303.46748294149387, -872.6794430798466, -565.3770678920208, -978.4024541318881, -427.11712950144994, -1185.0745625362508, -275.70473870140734, -410.18036292947886, -631.4385865761408, -462.71604932123876, -539.1085935546446, -1315.1397555865315, -1153.575817400033, -197.71870980044022, -658.6169662143224, -319.08397930862884, -89.83098084666315, -114.26174152533575, -578.9159911221132, -694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5497114678261267, "mean_inference_ms": 1.6425491204388505, "mean_action_processing_ms": 0.2720244076074536, "mean_env_wait_ms": 3.3068329184773044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012132883071899414, "StateBufferConnector_ms": 0.007937431335449219, "ViewRequirementAgentConnector_ms": 0.19281387329101562}, "num_episodes": 33, "episode_return_max": -22.812472019081696, "episode_return_min": -1369.0069558027697, "episode_return_mean": -528.9731442911079, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.5377435650427, "num_env_steps_trained_throughput_per_sec": 378.5377435650427, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9780.683, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9780.612, "sample_time_ms": 1101.501, "learn_time_ms": 8617.299, "learn_throughput": 464.183, "synch_weights_time_ms": 60.992}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "89531_00000", "date": "2024-08-05_11-16-51", "timestamp": 1722836811, "time_this_iter_s": 10.576333045959473, "time_total_s": 230.57677030563354, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bb7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.57677030563354, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.599999999999998, "ram_util_percent": 28.893333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.163700679938, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9791325726080686, "policy_loss": -0.013277406943961978, "vf_loss": 0.988282194826752, "vf_explained_var": 0.9968212681512038, "kl": 0.014108200230930379, "entropy": 1.0467573658873637, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -22.812472019081696, "episode_reward_min": -1369.0069558027697, "episode_reward_mean": -509.1656809941201, "episode_len_mean": 126.71, "episode_media": {}, "episodes_timesteps_total": 12671, "policy_reward_min": {"policy_0": -1369.0069558027697}, "policy_reward_max": {"policy_0": -22.812472019081696}, "policy_reward_mean": {"policy_0": -509.1656809941201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333], "episode_lengths": [150, 150, 150, 150, 77, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 147, 69, 150, 150, 85, 115, 91, 66, 95, 147, 150, 57, 150, 150, 150, 68, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 94, 93, 150, 150, 150, 145, 150, 150, 150, 150, 121, 98, 48, 43, 150, 150, 150, 69, 150, 132, 138, 150, 150, 55, 150, 150, 77, 150, 58, 144, 140, 81, 150, 150, 115, 150, 54, 117, 58, 121, 150, 150, 150, 150, 150, 60, 74, 76, 150, 150, 150, 150, 53, 150, 139, 150, 150], "policy_policy_0_reward": [-694.0575425582674, -586.9554367060655, -305.11522526130204, -1074.030580724427, -118.20953073226381, -474.24626152642634, -1103.5256289788954, -99.64275967634829, -669.6257300734828, -615.4401514249157, -697.9998535066018, -513.0809473503593, -1172.6549322404967, -518.9519662023246, -595.3322752934326, -882.2564600136512, -116.58370606065135, -624.5921339995004, -643.7008906549933, -319.99249810382486, -451.2872742518498, -151.79727494565944, -102.46084127876736, -298.310830390696, -417.65931309789875, -497.9893827158401, -54.58143042435381, -825.8500960092065, -1174.1249572114132, -538.8739567312465, -170.72499883476013, -787.4661905682492, -951.6394790893949, -599.5942835809975, -22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493144111032086, "mean_inference_ms": 1.6417436592239931, "mean_action_processing_ms": 0.271822531369107, "mean_env_wait_ms": 3.30513660949597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012335062026977539, "StateBufferConnector_ms": 0.007909059524536133, "ViewRequirementAgentConnector_ms": 0.19463372230529785}, "num_episodes": 30, "episode_return_max": -22.812472019081696, "episode_return_min": -1369.0069558027697, "episode_return_mean": -509.1656809941201, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.1853305581302, "num_env_steps_trained_throughput_per_sec": 397.1853305581302, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9721.955, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9721.884, "sample_time_ms": 1099.555, "learn_time_ms": 8559.708, "learn_throughput": 467.306, "synch_weights_time_ms": 61.776}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "89531_00000", "date": "2024-08-05_11-17-01", "timestamp": 1722836821, "time_this_iter_s": 10.082370519638062, "time_total_s": 240.6591408252716, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.6591408252716, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.53333333333334, "ram_util_percent": 28.899999999999988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.55741293132306, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0068045161354044, "policy_loss": -0.00962314434000291, "vf_loss": 1.012124527276804, "vf_explained_var": 0.994965726758043, "kl": 0.01467460599384746, "entropy": 0.9924974933266639, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -22.812472019081696, "episode_reward_min": -1369.0069558027697, "episode_reward_mean": -484.04874610209333, "episode_len_mean": 122.43, "episode_media": {}, "episodes_timesteps_total": 12243, "policy_reward_min": {"policy_0": -1369.0069558027697}, "policy_reward_max": {"policy_0": -22.812472019081696}, "policy_reward_mean": {"policy_0": -484.04874610209333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902], "episode_lengths": [36, 150, 150, 150, 150, 150, 150, 150, 150, 94, 93, 150, 150, 150, 145, 150, 150, 150, 150, 121, 98, 48, 43, 150, 150, 150, 69, 150, 132, 138, 150, 150, 55, 150, 150, 77, 150, 58, 144, 140, 81, 150, 150, 115, 150, 54, 117, 58, 121, 150, 150, 150, 150, 150, 60, 74, 76, 150, 150, 150, 150, 53, 150, 139, 150, 150, 121, 150, 65, 150, 150, 44, 150, 129, 150, 150, 150, 66, 150, 71, 73, 125, 150, 72, 150, 150, 53, 150, 105, 110, 150, 150, 104, 69, 150, 73, 119, 83, 72, 150], "policy_policy_0_reward": [-22.812472019081696, -818.8349615410626, -517.7472231427281, -321.46901098399616, -368.97026410309894, -466.2252481039053, -1045.5733199782976, -1137.2298001902186, -768.4495898729733, -148.72980315623352, -351.0267944890416, -389.4779318793465, -1369.0069558027697, -714.5987781826143, -495.4398508404559, -411.1677029102404, -451.40582313367474, -612.2671491372889, -537.2047349489626, -362.00074918695265, -161.53272986338678, -93.63381832605462, -41.23670655710766, -600.3067474673599, -680.1290605485497, -486.5045950477178, -96.29625477816037, -917.8575229132039, -305.29882890670905, -449.035873580628, -335.9076274314998, -480.67760750904984, -137.9630067158512, -720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493776780712676, "mean_inference_ms": 1.642519599281028, "mean_action_processing_ms": 0.27198751677839506, "mean_env_wait_ms": 3.305269940024254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012366056442260742, "StateBufferConnector_ms": 0.007858514785766602, "ViewRequirementAgentConnector_ms": 0.1931779384613037}, "num_episodes": 34, "episode_return_max": -22.812472019081696, "episode_return_min": -1369.0069558027697, "episode_return_mean": -484.04874610209333, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.58990457775803, "num_env_steps_trained_throughput_per_sec": 346.58990457775803, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10019.74, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10019.669, "sample_time_ms": 1104.212, "learn_time_ms": 8852.61, "learn_throughput": 451.844, "synch_weights_time_ms": 62.04}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "89531_00000", "date": "2024-08-05_11-17-13", "timestamp": 1722836833, "time_this_iter_s": 11.553607940673828, "time_total_s": 252.21274876594543, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.21274876594543, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.143749999999997, "ram_util_percent": 29.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.04172574182351, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9836368439098199, "policy_loss": -0.014094263373408467, "vf_loss": 0.9925097574790319, "vf_explained_var": 0.9976694722970326, "kl": 0.01771014547484812, "entropy": 0.9169489081328114, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -17.9426416541914, "episode_reward_min": -1217.2933008046673, "episode_reward_mean": -468.6302744075186, "episode_len_mean": 120.14, "episode_media": {}, "episodes_timesteps_total": 12014, "policy_reward_min": {"policy_0": -1217.2933008046673}, "policy_reward_max": {"policy_0": -17.9426416541914}, "policy_reward_mean": {"policy_0": -468.6302744075186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303], "episode_lengths": [150, 150, 77, 150, 58, 144, 140, 81, 150, 150, 115, 150, 54, 117, 58, 121, 150, 150, 150, 150, 150, 60, 74, 76, 150, 150, 150, 150, 53, 150, 139, 150, 150, 121, 150, 65, 150, 150, 44, 150, 129, 150, 150, 150, 66, 150, 71, 73, 125, 150, 72, 150, 150, 53, 150, 105, 110, 150, 150, 104, 69, 150, 73, 119, 83, 72, 150, 132, 84, 101, 99, 150, 150, 150, 150, 150, 150, 150, 44, 111, 61, 150, 150, 62, 80, 150, 150, 150, 150, 150, 92, 69, 86, 52, 144, 146, 150, 150, 150, 80], "policy_policy_0_reward": [-720.3603187866677, -649.7373817818624, -149.0961021061556, -579.5126614269745, -121.62966786067113, -490.2448825901575, -310.67069463881046, -158.35529849626806, -383.3016967162979, -627.7417406849546, -337.8847930230136, -904.9319330051248, -62.55150336337953, -328.5387117534164, -79.02111424884762, -272.445348144449, -346.4950143466101, -1139.9022474688516, -1017.6795234765741, -593.1448852296652, -781.6534034211304, -55.11096031747713, -106.93058436375874, -271.1891242711889, -947.3115180454943, -475.6101817263543, -555.9343882278691, -762.4820758230389, -79.8050430524001, -1137.6553183544154, -377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.549291342169481, "mean_inference_ms": 1.6421799631257077, "mean_action_processing_ms": 0.2718626195172902, "mean_env_wait_ms": 3.3046321742348517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012283086776733398, "StateBufferConnector_ms": 0.007750749588012695, "ViewRequirementAgentConnector_ms": 0.18979096412658691}, "num_episodes": 33, "episode_return_max": -17.9426416541914, "episode_return_min": -1217.2933008046673, "episode_return_mean": -468.6302744075186, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.79517052743546, "num_env_steps_trained_throughput_per_sec": 336.79517052743546, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10240.351, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10240.28, "sample_time_ms": 1082.362, "learn_time_ms": 9095.554, "learn_throughput": 439.775, "synch_weights_time_ms": 61.558}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "89531_00000", "date": "2024-08-05_11-17-25", "timestamp": 1722836845, "time_this_iter_s": 11.888906717300415, "time_total_s": 264.10165548324585, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664335120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.10165548324585, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.32941176470588, "ram_util_percent": 29.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.30798983077207, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.989243364908422, "policy_loss": -0.0087392446109637, "vf_loss": 0.9932417239062488, "vf_explained_var": 0.9964003055666883, "kl": 0.01612840797467167, "entropy": 0.9763766934474309, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -17.9426416541914, "episode_reward_min": -1391.1776331390984, "episode_reward_mean": -486.0388999609202, "episode_len_mean": 120.35, "episode_media": {}, "episodes_timesteps_total": 12035, "policy_reward_min": {"policy_0": -1391.1776331390984}, "policy_reward_max": {"policy_0": -17.9426416541914}, "policy_reward_mean": {"policy_0": -486.0388999609202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214], "episode_lengths": [139, 150, 150, 121, 150, 65, 150, 150, 44, 150, 129, 150, 150, 150, 66, 150, 71, 73, 125, 150, 72, 150, 150, 53, 150, 105, 110, 150, 150, 104, 69, 150, 73, 119, 83, 72, 150, 132, 84, 101, 99, 150, 150, 150, 150, 150, 150, 150, 44, 111, 61, 150, 150, 62, 80, 150, 150, 150, 150, 150, 92, 69, 86, 52, 144, 146, 150, 150, 150, 80, 150, 57, 90, 149, 74, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 71, 102, 39, 150, 150, 55, 150, 128, 137, 120, 150, 39, 77, 150], "policy_policy_0_reward": [-377.529853937737, -428.240214206573, -719.4965510490333, -368.56750073597703, -285.60902486513527, -68.33455319660135, -571.0736374222995, -1011.6219999128056, -73.49871219172937, -758.1311753495243, -390.26956982891255, -476.768930742818, -428.22966759505863, -424.48270812830964, -90.23417387868857, -1183.541652176023, -122.72456741776239, -129.63383796268576, -304.38309453162714, -1067.8219014744038, -129.98617802902749, -707.6686050637315, -450.68085255036914, -75.61690040004895, -1112.8602505569825, -369.9129983512254, -265.2784013303008, -856.6649782772424, -942.4034752321842, -533.1675280615522, -123.13997108221048, -1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489557268174611, "mean_inference_ms": 1.6413707688484913, "mean_action_processing_ms": 0.27185664029929546, "mean_env_wait_ms": 3.302666929816594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011824369430541992, "StateBufferConnector_ms": 0.007593870162963867, "ViewRequirementAgentConnector_ms": 0.19097638130187988}, "num_episodes": 30, "episode_return_max": -17.9426416541914, "episode_return_min": -1391.1776331390984, "episode_return_mean": -486.0388999609202, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.66653001011025, "num_env_steps_trained_throughput_per_sec": 407.66653001011025, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10291.589, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10291.516, "sample_time_ms": 1082.835, "learn_time_ms": 9146.579, "learn_throughput": 437.322, "synch_weights_time_ms": 61.292}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "89531_00000", "date": "2024-08-05_11-17-35", "timestamp": 1722836855, "time_this_iter_s": 9.821366310119629, "time_total_s": 273.9230217933655, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bb760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 273.9230217933655, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.892857142857146, "ram_util_percent": 29.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.72947854598364, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.1420687604074677, "policy_loss": -0.009920395008036091, "vf_loss": 1.1479724945190053, "vf_explained_var": 0.9918385310719411, "kl": 0.01374608180734261, "entropy": 1.0716026046002904, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -17.9426416541914, "episode_reward_min": -1391.1776331390984, "episode_reward_mean": -505.0512992078369, "episode_len_mean": 123.93, "episode_media": {}, "episodes_timesteps_total": 12393, "policy_reward_min": {"policy_0": -1391.1776331390984}, "policy_reward_max": {"policy_0": -17.9426416541914}, "policy_reward_mean": {"policy_0": -505.0512992078369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214, -545.0406591238913, -519.0686487945912, -101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643], "episode_lengths": [150, 73, 119, 83, 72, 150, 132, 84, 101, 99, 150, 150, 150, 150, 150, 150, 150, 44, 111, 61, 150, 150, 62, 80, 150, 150, 150, 150, 150, 92, 69, 86, 52, 144, 146, 150, 150, 150, 80, 150, 57, 90, 149, 74, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 71, 102, 39, 150, 150, 55, 150, 128, 137, 120, 150, 39, 77, 150, 149, 150, 63, 150, 71, 147, 150, 150, 141, 150, 124, 68, 109, 150, 150, 150, 145, 150, 141, 150, 150, 150, 126, 150, 150, 66, 111, 150, 112, 150, 131], "policy_policy_0_reward": [-1096.5098560038437, -236.60587627090706, -275.4195894300123, -195.76359636487217, -100.14369943011754, -1109.911867170902, -362.2484692171528, -152.27758400490288, -282.3783128262458, -308.8981905796703, -642.0100424885525, -441.78939488412414, -913.7795388923328, -442.5648684639681, -1100.6852972178272, -517.1031678905556, -461.44211069459345, -17.9426416541914, -263.58880145561517, -83.03894148502006, -1181.7329088378128, -516.3488548943997, -63.35465273336222, -138.5017133276448, -450.2405763785043, -419.2470164642426, -1217.2933008046673, -935.2412314253155, -370.58488894197853, -169.63843449713409, -113.54528676802938, -167.36965439494563, -45.11432498065525, -322.45653021116726, -457.8267542050184, -572.5183483543809, -630.0392835937541, -625.7725440056641, -167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214, -545.0406591238913, -519.0686487945912, -101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.548683502599416, "mean_inference_ms": 1.6408453308210593, "mean_action_processing_ms": 0.2716536209057728, "mean_env_wait_ms": 3.3027723505003417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011913776397705078, "StateBufferConnector_ms": 0.007647037506103516, "ViewRequirementAgentConnector_ms": 0.1921985149383545}, "num_episodes": 31, "episode_return_max": -17.9426416541914, "episode_return_min": -1391.1776331390984, "episode_return_mean": -505.0512992078369, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.4487866365019, "num_env_steps_trained_throughput_per_sec": 356.4487866365019, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 10436.359, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10436.287, "sample_time_ms": 1099.281, "learn_time_ms": 9274.01, "learn_throughput": 431.313, "synch_weights_time_ms": 62.179}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "89531_00000", "date": "2024-08-05_11-17-46", "timestamp": 1722836866, "time_this_iter_s": 11.233400821685791, "time_total_s": 285.15642261505127, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.15642261505127, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.71875, "ram_util_percent": 29.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.60236001710096, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.1818824305199087, "policy_loss": -0.017562715896444085, "vf_loss": 1.1932754080121717, "vf_explained_var": 0.9975443077584107, "kl": 0.02087623894006662, "entropy": 0.9313421627506614, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -26.265539666318286, "episode_reward_min": -1391.1776331390984, "episode_reward_mean": -489.60931536206243, "episode_len_mean": 121.39, "episode_media": {}, "episodes_timesteps_total": 12139, "policy_reward_min": {"policy_0": -1391.1776331390984}, "policy_reward_max": {"policy_0": -26.265539666318286}, "policy_reward_mean": {"policy_0": -489.60931536206243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214, -545.0406591238913, -519.0686487945912, -101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643, -353.98909858621823, -170.99373099303315, -256.1400253426079, -662.7063334181273, -467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873], "episode_lengths": [80, 150, 57, 90, 149, 74, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 71, 102, 39, 150, 150, 55, 150, 128, 137, 120, 150, 39, 77, 150, 149, 150, 63, 150, 71, 147, 150, 150, 141, 150, 124, 68, 109, 150, 150, 150, 145, 150, 141, 150, 150, 150, 126, 150, 150, 66, 111, 150, 112, 150, 131, 150, 77, 150, 150, 150, 150, 48, 94, 150, 70, 150, 59, 66, 150, 133, 150, 150, 150, 150, 80, 68, 85, 150, 150, 150, 139, 65, 75, 150, 150, 52, 72, 61, 90, 60, 150, 150, 62], "policy_policy_0_reward": [-167.59770721731303, -606.6707862504863, -73.25963622117006, -138.4344566267942, -328.2010605796503, -114.07511642110667, -244.7086799772399, -806.1655949444248, -1021.4217730382956, -969.3160012492873, -422.27217432607046, -1172.8699768208194, -1058.2267213703446, -1391.1776331390984, -1349.1879446203639, -351.2985421122186, -659.0777218828653, -122.28626638465838, -168.2716512212891, -32.58989286018726, -1069.085198873088, -447.8597916490764, -26.265539666318286, -698.7748573156533, -243.98674370549128, -576.0168593180513, -242.12948855837337, -888.4430108337759, -32.87644221270007, -147.27999236223, -785.5611175509214, -545.0406591238913, -519.0686487945912, -101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643, -353.98909858621823, -170.99373099303315, -256.1400253426079, -662.7063334181273, -467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489556150665051, "mean_inference_ms": 1.6433662346967004, "mean_action_processing_ms": 0.27166512710488333, "mean_env_wait_ms": 3.3012616063173463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01190805435180664, "StateBufferConnector_ms": 0.007770061492919922, "ViewRequirementAgentConnector_ms": 0.19527935981750488}, "num_episodes": 38, "episode_return_max": -26.265539666318286, "episode_return_min": -1391.1776331390984, "episode_return_mean": -489.60931536206243, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.60421118815765, "num_env_steps_trained_throughput_per_sec": 378.60421118815765, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 10668.325, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10668.253, "sample_time_ms": 1108.814, "learn_time_ms": 9496.003, "learn_throughput": 421.23, "synch_weights_time_ms": 62.593}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "89531_00000", "date": "2024-08-05_11-17-57", "timestamp": 1722836877, "time_this_iter_s": 10.578076839447021, "time_total_s": 295.7344994544983, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.7344994544983, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 21.42, "ram_util_percent": 29.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.08761470814545, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0660920827028653, "policy_loss": -0.010410447678683947, "vf_loss": 1.0706020728374521, "vf_explained_var": 0.9935620106756687, "kl": 0.013313759925100992, "entropy": 0.9073391851037741, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -12.628729960967995, "episode_reward_min": -1316.3563676477834, "episode_reward_mean": -472.8018253058997, "episode_len_mean": 121.51, "episode_media": {}, "episodes_timesteps_total": 12151, "policy_reward_min": {"policy_0": -1316.3563676477834}, "policy_reward_max": {"policy_0": -12.628729960967995}, "policy_reward_mean": {"policy_0": -472.8018253058997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643, -353.98909858621823, -170.99373099303315, -256.1400253426079, -662.7063334181273, -467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816], "episode_lengths": [63, 150, 71, 147, 150, 150, 141, 150, 124, 68, 109, 150, 150, 150, 145, 150, 141, 150, 150, 150, 126, 150, 150, 66, 111, 150, 112, 150, 131, 150, 77, 150, 150, 150, 150, 48, 94, 150, 70, 150, 59, 66, 150, 133, 150, 150, 150, 150, 80, 68, 85, 150, 150, 150, 139, 65, 75, 150, 150, 52, 72, 61, 90, 60, 150, 150, 62, 137, 150, 150, 150, 61, 71, 150, 150, 116, 80, 150, 124, 150, 108, 141, 150, 42, 150, 79, 150, 150, 150, 41, 150, 150, 150, 83, 145, 109, 150, 104, 49, 150], "policy_policy_0_reward": [-101.69961057796586, -562.081346086918, -132.0059249120204, -471.782802492571, -558.4172097988347, -1000.7514157383908, -605.9919966885586, -182.24269615290996, -201.6775614487736, -201.25996756341124, -363.4843016646599, -881.9810920584263, -1246.8654585482384, -830.2753534873484, -378.3871660633483, -575.112531779641, -395.6643978747114, -1111.6652327909324, -480.33558341488464, -506.6567600798722, -375.26868893382505, -1040.9432846166476, -359.40864803375285, -207.09292816548526, -298.15847148837236, -1234.3225842006236, -328.0620223390134, -495.31025690465805, -557.7987884069643, -353.98909858621823, -170.99373099303315, -256.1400253426079, -662.7063334181273, -467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5488101173257783, "mean_inference_ms": 1.6435800141582313, "mean_action_processing_ms": 0.2715262948680905, "mean_env_wait_ms": 3.2983829431203175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012083292007446289, "StateBufferConnector_ms": 0.007908821105957031, "ViewRequirementAgentConnector_ms": 0.19314265251159668}, "num_episodes": 33, "episode_return_max": -12.628729960967995, "episode_return_min": -1316.3563676477834, "episode_return_mean": -472.8018253058997, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.7138508490792, "num_env_steps_trained_throughput_per_sec": 369.7138508490792, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 10708.02, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10707.946, "sample_time_ms": 1109.245, "learn_time_ms": 9535.787, "learn_throughput": 419.472, "synch_weights_time_ms": 62.063}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "89531_00000", "date": "2024-08-05_11-18-08", "timestamp": 1722836888, "time_this_iter_s": 10.832347631454468, "time_total_s": 306.56684708595276, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643ba440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.56684708595276, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 19.98, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.88255168199538, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0357126221371193, "policy_loss": -0.011309732100441276, "vf_loss": 1.0403231967240572, "vf_explained_var": 0.994986651527385, "kl": 0.015110955861443169, "entropy": 1.0077384308601418, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -12.628729960967995, "episode_reward_min": -1316.3563676477834, "episode_reward_mean": -460.5986316299376, "episode_len_mean": 117.81, "episode_media": {}, "episodes_timesteps_total": 11781, "policy_reward_min": {"policy_0": -1316.3563676477834}, "policy_reward_max": {"policy_0": -12.628729960967995}, "policy_reward_mean": {"policy_0": -460.5986316299376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816, -811.4164033435261, -96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663], "episode_lengths": [150, 150, 48, 94, 150, 70, 150, 59, 66, 150, 133, 150, 150, 150, 150, 80, 68, 85, 150, 150, 150, 139, 65, 75, 150, 150, 52, 72, 61, 90, 60, 150, 150, 62, 137, 150, 150, 150, 61, 71, 150, 150, 116, 80, 150, 124, 150, 108, 141, 150, 42, 150, 79, 150, 150, 150, 41, 150, 150, 150, 83, 145, 109, 150, 104, 49, 150, 150, 65, 57, 66, 150, 150, 150, 150, 68, 103, 87, 150, 66, 150, 150, 150, 150, 150, 59, 43, 150, 150, 150, 150, 150, 66, 150, 67, 129, 150, 150, 150, 86], "policy_policy_0_reward": [-467.20898261933934, -1283.551055746826, -29.769167806036663, -219.20522567086883, -445.22718165167794, -95.80265260990352, -564.1224262539065, -75.23619818782646, -92.81558828897236, -1033.1944766677086, -325.5088253568793, -1172.335286456943, -1215.4719839698253, -509.84232653136615, -545.2678110639932, -103.29782976244037, -80.96315687758427, -177.55679067640796, -1082.0948825682913, -638.7917858417871, -417.9493500872855, -543.2167516532551, -96.20499247292062, -174.57791735372803, -497.01413313335485, -692.580693073976, -55.16260777221192, -82.97684832274527, -69.23570420050581, -261.3822769266713, -98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816, -811.4164033435261, -96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5488740567819104, "mean_inference_ms": 1.6694830424414535, "mean_action_processing_ms": 0.27144304564748173, "mean_env_wait_ms": 3.297958363016722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012264490127563477, "StateBufferConnector_ms": 0.007865190505981445, "ViewRequirementAgentConnector_ms": 0.19199895858764648}, "num_episodes": 33, "episode_return_max": -12.628729960967995, "episode_return_min": -1316.3563676477834, "episode_return_mean": -460.5986316299376, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.4021251965625, "num_env_steps_trained_throughput_per_sec": 353.4021251965625, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 10885.458, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10885.386, "sample_time_ms": 1153.281, "learn_time_ms": 9670.858, "learn_throughput": 413.614, "synch_weights_time_ms": 60.395}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "89531_00000", "date": "2024-08-05_11-18-19", "timestamp": 1722836899, "time_this_iter_s": 11.32975459098816, "time_total_s": 317.8966016769409, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bacb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.8966016769409, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.3625, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.44975285430749, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0621960157218078, "policy_loss": -0.011461768242588733, "vf_loss": 1.0671515594546994, "vf_explained_var": 0.990600755251944, "kl": 0.01468016560132434, "entropy": 0.998506147104005, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -12.628729960967995, "episode_reward_min": -1316.3563676477834, "episode_reward_mean": -477.7918469092616, "episode_len_mean": 122.17, "episode_media": {}, "episodes_timesteps_total": 12217, "policy_reward_min": {"policy_0": -1316.3563676477834}, "policy_reward_max": {"policy_0": -12.628729960967995}, "policy_reward_mean": {"policy_0": -477.7918469092616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816, -811.4164033435261, -96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846], "episode_lengths": [60, 150, 150, 62, 137, 150, 150, 150, 61, 71, 150, 150, 116, 80, 150, 124, 150, 108, 141, 150, 42, 150, 79, 150, 150, 150, 41, 150, 150, 150, 83, 145, 109, 150, 104, 49, 150, 150, 65, 57, 66, 150, 150, 150, 150, 68, 103, 87, 150, 66, 150, 150, 150, 150, 150, 59, 43, 150, 150, 150, 150, 150, 66, 150, 67, 129, 150, 150, 150, 86, 150, 147, 67, 140, 150, 150, 54, 150, 150, 150, 150, 123, 150, 150, 87, 132, 117, 150, 150, 86, 130, 104, 150, 150, 150, 67, 70, 150, 150, 69], "policy_policy_0_reward": [-98.3460461600622, -815.4064035173685, -378.02113408071847, -73.56208496325873, -547.0133141785947, -386.6942988657267, -1316.3563676477834, -543.6715059222125, -77.19267497765993, -145.2149680090389, -633.8733526465619, -419.3490573712831, -257.8817535316941, -141.48629883432113, -400.10580122220296, -282.3493005885163, -434.12878772484487, -298.1349014889583, -512.8761104234009, -545.6660849488387, -28.122106369091515, -634.4504838865048, -235.61145634504928, -1069.2808102506053, -1163.8600587120047, -485.1340353469897, -23.99546961621696, -1217.2824254220068, -269.0980010937859, -682.1961788079117, -136.63040168275023, -448.4364296475195, -258.6271073603922, -882.9700580986498, -228.76632875367488, -12.628729960967995, -1019.664021875816, -811.4164033435261, -96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496183942100558, "mean_inference_ms": 1.6914270695385283, "mean_action_processing_ms": 0.27136499607227976, "mean_env_wait_ms": 3.298191932378078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012084245681762695, "StateBufferConnector_ms": 0.007858991622924805, "ViewRequirementAgentConnector_ms": 0.19345664978027344}, "num_episodes": 30, "episode_return_max": -12.628729960967995, "episode_return_min": -1316.3563676477834, "episode_return_mean": -477.7918469092616, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.1377876885982, "num_env_steps_trained_throughput_per_sec": 430.1377876885982, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 10709.16, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10709.088, "sample_time_ms": 1154.675, "learn_time_ms": 9492.051, "learn_throughput": 421.405, "synch_weights_time_ms": 61.496}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "89531_00000", "date": "2024-08-05_11-18-28", "timestamp": 1722836908, "time_this_iter_s": 9.311805725097656, "time_total_s": 327.2084074020386, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.2084074020386, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.864285714285717, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.44045285085836, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0506657041298846, "policy_loss": -0.010279014251136687, "vf_loss": 1.0556260314459602, "vf_explained_var": 0.9956160181512436, "kl": 0.012034157497449426, "entropy": 0.9668541424597303, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -1.0756009472001333, "episode_reward_min": -1257.058766582497, "episode_reward_mean": -449.65316449535675, "episode_len_mean": 118.96, "episode_media": {}, "episodes_timesteps_total": 11896, "policy_reward_min": {"policy_0": -1257.058766582497}, "policy_reward_max": {"policy_0": -1.0756009472001333}, "policy_reward_mean": {"policy_0": -449.65316449535675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374], "episode_lengths": [65, 57, 66, 150, 150, 150, 150, 68, 103, 87, 150, 66, 150, 150, 150, 150, 150, 59, 43, 150, 150, 150, 150, 150, 66, 150, 67, 129, 150, 150, 150, 86, 150, 147, 67, 140, 150, 150, 54, 150, 150, 150, 150, 123, 150, 150, 87, 132, 117, 150, 150, 86, 130, 104, 150, 150, 150, 67, 70, 150, 150, 69, 111, 50, 150, 150, 33, 150, 150, 126, 85, 150, 150, 50, 150, 133, 97, 139, 40, 150, 98, 150, 85, 84, 63, 97, 72, 150, 51, 150, 150, 150, 145, 148, 138, 150, 150, 75, 90, 31], "policy_policy_0_reward": [-96.48534651232877, -36.580616108133846, -133.05093470875755, -1053.8029932274421, -415.3604852274452, -1173.8725972989896, -460.5440719137869, -77.51462712307037, -271.8191626481795, -164.31320771658724, -633.3018558900942, -113.13269410525496, -909.0916347995723, -523.957740590518, -586.7051532480981, -569.4191817322609, -653.8747973742356, -46.58346131202356, -29.21356615095691, -672.0960327867165, -505.28146957464133, -566.6266483300042, -645.8504338945822, -1092.2188880896106, -92.69008104707234, -1037.9694932760892, -123.84472746860442, -367.5346862117354, -970.1773747515898, -483.7922375066358, -411.57239049504005, -178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496664118355747, "mean_inference_ms": 1.7203198291923658, "mean_action_processing_ms": 0.27170606908407974, "mean_env_wait_ms": 3.3000202150445905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012070894241333008, "StateBufferConnector_ms": 0.0078084468841552734, "ViewRequirementAgentConnector_ms": 0.195906400680542}, "num_episodes": 38, "episode_return_max": -1.0756009472001333, "episode_return_min": -1257.058766582497, "episode_return_mean": -449.65316449535675, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.2187261222117, "num_env_steps_trained_throughput_per_sec": 456.2187261222117, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10529.235, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10529.163, "sample_time_ms": 1165.693, "learn_time_ms": 9301.894, "learn_throughput": 430.02, "synch_weights_time_ms": 60.724}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "89531_00000", "date": "2024-08-05_11-18-37", "timestamp": 1722836917, "time_this_iter_s": 8.778238534927368, "time_total_s": 335.98664593696594, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643353f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.98664593696594, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 21.55, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.18821677664916, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9168813855542491, "policy_loss": -0.0163355913842679, "vf_loss": 0.9258280470967293, "vf_explained_var": 0.9951231135676305, "kl": 0.016635106643055526, "entropy": 0.9687067919721206, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -1.0756009472001333, "episode_reward_min": -1257.058766582497, "episode_reward_mean": -436.8815180301077, "episode_len_mean": 119.99, "episode_media": {}, "episodes_timesteps_total": 11999, "policy_reward_min": {"policy_0": -1257.058766582497}, "policy_reward_max": {"policy_0": -1.0756009472001333}, "policy_reward_mean": {"policy_0": -436.8815180301077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374, -507.2238128965557, -425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971], "episode_lengths": [86, 150, 147, 67, 140, 150, 150, 54, 150, 150, 150, 150, 123, 150, 150, 87, 132, 117, 150, 150, 86, 130, 104, 150, 150, 150, 67, 70, 150, 150, 69, 111, 50, 150, 150, 33, 150, 150, 126, 85, 150, 150, 50, 150, 133, 97, 139, 40, 150, 98, 150, 85, 84, 63, 97, 72, 150, 51, 150, 150, 150, 145, 148, 138, 150, 150, 75, 90, 31, 150, 123, 46, 147, 78, 141, 150, 150, 150, 150, 107, 143, 150, 150, 150, 71, 144, 72, 150, 79, 121, 150, 150, 68, 150, 43, 131, 150, 113, 150, 102], "policy_policy_0_reward": [-178.51890859194663, -1021.149621335461, -696.4224613762032, -124.46641951543386, -414.97467934594107, -457.7591805387911, -717.7967908127414, -152.01837705780497, -446.70047421095586, -409.70130156320795, -1257.058766582497, -473.49770375905246, -366.0294957810078, -562.9361666926346, -736.0585735418083, -157.27807100559727, -362.34037940613126, -390.49351653696783, -320.9619735794582, -968.3194168345531, -172.6876185590589, -268.1653302782635, -262.3112869272994, -568.6340229431066, -804.6340245446027, -393.61552832834207, -114.13757952450266, -126.73455337095061, -1095.5700230840346, -836.3918319609286, -88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374, -507.2238128965557, -425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5500708912892542, "mean_inference_ms": 1.7167349994061811, "mean_action_processing_ms": 0.27184907206887243, "mean_env_wait_ms": 3.298092865947586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011926651000976562, "StateBufferConnector_ms": 0.00859832763671875, "ViewRequirementAgentConnector_ms": 0.19421029090881348}, "num_episodes": 31, "episode_return_max": -1.0756009472001333, "episode_return_min": -1257.058766582497, "episode_return_mean": -436.8815180301077, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.8374033368983, "num_env_steps_trained_throughput_per_sec": 352.8374033368983, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 10655.815, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10655.742, "sample_time_ms": 1162.838, "learn_time_ms": 9431.92, "learn_throughput": 424.092, "synch_weights_time_ms": 60.145}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "89531_00000", "date": "2024-08-05_11-18-49", "timestamp": 1722836929, "time_this_iter_s": 11.3458833694458, "time_total_s": 347.33252930641174, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.33252930641174, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.3125, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.58248015443483, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0014961692815025, "policy_loss": -0.01734282967809122, "vf_loss": 1.0116065966275831, "vf_explained_var": 0.9978948193291823, "kl": 0.016295740294359984, "entropy": 1.0067860521997014, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -1.0756009472001333, "episode_reward_min": -1203.5518936706012, "episode_reward_mean": -428.46208895118383, "episode_len_mean": 118.39, "episode_media": {}, "episodes_timesteps_total": 11839, "policy_reward_min": {"policy_0": -1203.5518936706012}, "policy_reward_max": {"policy_0": -1.0756009472001333}, "policy_reward_mean": {"policy_0": -428.46208895118383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374, -507.2238128965557, -425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971, -679.0857704404907, -103.21474586497679, -385.57022386420283, -436.96666892999116, -1012.7065415135943, -689.7238097148029, -1203.5518936706012, -525.3117214252044, -230.1827974170863, -189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199], "episode_lengths": [69, 111, 50, 150, 150, 33, 150, 150, 126, 85, 150, 150, 50, 150, 133, 97, 139, 40, 150, 98, 150, 85, 84, 63, 97, 72, 150, 51, 150, 150, 150, 145, 148, 138, 150, 150, 75, 90, 31, 150, 123, 46, 147, 78, 141, 150, 150, 150, 150, 107, 143, 150, 150, 150, 71, 144, 72, 150, 79, 121, 150, 150, 68, 150, 43, 131, 150, 113, 150, 102, 150, 119, 150, 150, 150, 150, 150, 150, 119, 93, 91, 150, 98, 68, 150, 61, 150, 150, 108, 82, 150, 81, 64, 150, 77, 108, 81, 150, 150, 150], "policy_policy_0_reward": [-88.04126854029846, -371.7804845204021, -55.138772385938495, -536.2220470775706, -508.92332816998965, -1.0756009472001333, -495.00895073189656, -430.6771458923449, -485.25613023393936, -165.8675718928285, -392.653866754112, -590.5918058162085, -31.380522079121235, -1097.4854542356632, -292.80988692546777, -268.5057994464755, -330.35284293193496, -17.173005632725225, -457.4327887586433, -205.801035917073, -1154.6767642046386, -152.5216452545092, -193.265836831855, -65.47867493434539, -249.6352384553328, -145.61545043897175, -1122.701173409231, -55.03037145410809, -712.0722217532, -611.0925590575238, -850.3529818459194, -776.9121325948861, -401.61765459688394, -313.4032310715957, -630.505537037445, -546.6307741802086, -138.37161377908728, -233.76540229842502, -13.846208738333374, -507.2238128965557, -425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971, -679.0857704404907, -103.21474586497679, -385.57022386420283, -436.96666892999116, -1012.7065415135943, -689.7238097148029, -1203.5518936706012, -525.3117214252044, -230.1827974170863, -189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5497500498244992, "mean_inference_ms": 1.7160688172028093, "mean_action_processing_ms": 0.27201895560206213, "mean_env_wait_ms": 3.299193698218151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011976957321166992, "StateBufferConnector_ms": 0.00860595703125, "ViewRequirementAgentConnector_ms": 0.19323396682739258}, "num_episodes": 30, "episode_return_max": -1.0756009472001333, "episode_return_min": -1203.5518936706012, "episode_return_mean": -428.46208895118383, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.3296415031706, "num_env_steps_trained_throughput_per_sec": 346.3296415031706, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 10656.682, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10656.61, "sample_time_ms": 1155.762, "learn_time_ms": 9440.207, "learn_throughput": 423.72, "synch_weights_time_ms": 59.799}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "89531_00000", "date": "2024-08-05_11-19-00", "timestamp": 1722836940, "time_this_iter_s": 11.561458110809326, "time_total_s": 358.89398741722107, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447152d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 358.89398741722107, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.247058823529407, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.07425459424654, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.1403541116664806, "policy_loss": -0.016728037396872727, "vf_loss": 1.1503564612319073, "vf_explained_var": 0.995856603855888, "kl": 0.01514533430161767, "entropy": 0.8971236004804571, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -2.9990384006165707, "episode_reward_min": -1240.8758694179596, "episode_reward_mean": -410.8024877879706, "episode_len_mean": 117.81, "episode_media": {}, "episodes_timesteps_total": 11781, "policy_reward_min": {"policy_0": -1240.8758694179596}, "policy_reward_max": {"policy_0": -2.9990384006165707}, "policy_reward_mean": {"policy_0": -410.8024877879706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971, -679.0857704404907, -103.21474586497679, -385.57022386420283, -436.96666892999116, -1012.7065415135943, -689.7238097148029, -1203.5518936706012, -525.3117214252044, -230.1827974170863, -189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199, -1240.8758694179596, -376.50237577572653, -655.2946421558426, -109.61876483855178, -419.4773893435275, -62.42673164869068, -103.92404983716354, -76.64728917637443, -140.78223666812409, -129.26395236744298, -285.2048681842337, -258.3702095795944, -357.28768691535737, -113.75737524682849, -469.85116138577706, -231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417], "episode_lengths": [123, 46, 147, 78, 141, 150, 150, 150, 150, 107, 143, 150, 150, 150, 71, 144, 72, 150, 79, 121, 150, 150, 68, 150, 43, 131, 150, 113, 150, 102, 150, 119, 150, 150, 150, 150, 150, 150, 119, 93, 91, 150, 98, 68, 150, 61, 150, 150, 108, 82, 150, 81, 64, 150, 77, 108, 81, 150, 150, 150, 150, 150, 150, 71, 144, 67, 74, 60, 74, 80, 96, 93, 132, 73, 150, 91, 45, 82, 127, 131, 150, 114, 67, 49, 150, 150, 37, 150, 119, 150, 150, 101, 150, 150, 150, 150, 92, 150, 33, 150], "policy_policy_0_reward": [-425.0287991055686, -22.53676388807581, -729.2452364394383, -275.4923699540138, -359.1316411509348, -552.1988152740583, -540.8937935136282, -1149.6224612275228, -1022.8404470497627, -349.8932444595799, -256.06176691444875, -360.9181120226957, -318.4564627074745, -663.407727722623, -141.54184927628333, -460.140349029844, -115.11709697871318, -428.3044598459015, -146.68602367436316, -404.94048884938474, -634.9656675165404, -416.97542811144365, -103.263063916204, -575.1672521919006, -8.570651972381915, -484.03684907528555, -590.1119789818516, -337.23476298403205, -993.6880662666468, -267.4185015979971, -679.0857704404907, -103.21474586497679, -385.57022386420283, -436.96666892999116, -1012.7065415135943, -689.7238097148029, -1203.5518936706012, -525.3117214252044, -230.1827974170863, -189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199, -1240.8758694179596, -376.50237577572653, -655.2946421558426, -109.61876483855178, -419.4773893435275, -62.42673164869068, -103.92404983716354, -76.64728917637443, -140.78223666812409, -129.26395236744298, -285.2048681842337, -258.3702095795944, -357.28768691535737, -113.75737524682849, -469.85116138577706, -231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5494256263002272, "mean_inference_ms": 1.7142093506008116, "mean_action_processing_ms": 0.27185325548037986, "mean_env_wait_ms": 3.299042080754864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012092113494873047, "StateBufferConnector_ms": 0.008540868759155273, "ViewRequirementAgentConnector_ms": 0.19273710250854492}, "num_episodes": 40, "episode_return_max": -2.9990384006165707, "episode_return_min": -1240.8758694179596, "episode_return_mean": -410.8024877879706, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.50461479218063, "num_env_steps_trained_throughput_per_sec": 377.50461479218063, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10528.607, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10528.534, "sample_time_ms": 1160.703, "learn_time_ms": 9306.205, "learn_throughput": 429.821, "synch_weights_time_ms": 60.777}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "89531_00000", "date": "2024-08-05_11-19-11", "timestamp": 1722836951, "time_this_iter_s": 10.60530710220337, "time_total_s": 369.49929451942444, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644715bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 369.49929451942444, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.45333333333333, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.80910329719384, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8989794623727599, "policy_loss": -0.015966585558877946, "vf_loss": 0.9081102058912317, "vf_explained_var": 0.9984840973590811, "kl": 0.015411111403621666, "entropy": 0.9915867891783515, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -2.9990384006165707, "episode_reward_min": -1240.8758694179596, "episode_reward_mean": -377.1245013614736, "episode_len_mean": 110.57, "episode_media": {}, "episodes_timesteps_total": 11057, "policy_reward_min": {"policy_0": -1240.8758694179596}, "policy_reward_max": {"policy_0": -2.9990384006165707}, "policy_reward_mean": {"policy_0": -377.1245013614736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199, -1240.8758694179596, -376.50237577572653, -655.2946421558426, -109.61876483855178, -419.4773893435275, -62.42673164869068, -103.92404983716354, -76.64728917637443, -140.78223666812409, -129.26395236744298, -285.2048681842337, -258.3702095795944, -357.28768691535737, -113.75737524682849, -469.85116138577706, -231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417, -965.2651098941982, -162.21030992694278, -467.6594376146626, -138.62418072672392, -525.1728582991558, -140.6517673978958, -131.65215282874158, -132.986136932833, -253.86356148002218, -1093.0659573811504, -376.41483963273987, -503.69391691772915, -65.75668049878556, -329.5555754046029, -77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347], "episode_lengths": [93, 91, 150, 98, 68, 150, 61, 150, 150, 108, 82, 150, 81, 64, 150, 77, 108, 81, 150, 150, 150, 150, 150, 150, 71, 144, 67, 74, 60, 74, 80, 96, 93, 132, 73, 150, 91, 45, 82, 127, 131, 150, 114, 67, 49, 150, 150, 37, 150, 119, 150, 150, 101, 150, 150, 150, 150, 92, 150, 33, 150, 150, 82, 150, 76, 150, 80, 71, 91, 90, 150, 114, 150, 64, 129, 45, 150, 61, 79, 55, 150, 55, 150, 59, 150, 150, 150, 150, 150, 121, 58, 61, 125, 78, 57, 125, 98, 119, 150, 150], "policy_policy_0_reward": [-189.36834342151036, -192.45718944808627, -1011.6498773666797, -108.54986414516735, -88.87513970054036, -624.4196005727947, -83.97782069319416, -1110.9378885425306, -398.720899267144, -278.8717474645182, -350.264905142684, -543.4498444614702, -152.47524909575972, -74.11938515856201, -524.4998859975858, -126.69042949109485, -457.93724448578723, -85.52806789291371, -813.8968784377367, -435.7662921874725, -1096.6504438827199, -1240.8758694179596, -376.50237577572653, -655.2946421558426, -109.61876483855178, -419.4773893435275, -62.42673164869068, -103.92404983716354, -76.64728917637443, -140.78223666812409, -129.26395236744298, -285.2048681842337, -258.3702095795944, -357.28768691535737, -113.75737524682849, -469.85116138577706, -231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417, -965.2651098941982, -162.21030992694278, -467.6594376146626, -138.62418072672392, -525.1728582991558, -140.6517673978958, -131.65215282874158, -132.986136932833, -253.86356148002218, -1093.0659573811504, -376.41483963273987, -503.69391691772915, -65.75668049878556, -329.5555754046029, -77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.549235484896489, "mean_inference_ms": 1.7126993740073653, "mean_action_processing_ms": 0.2719886015585847, "mean_env_wait_ms": 3.299281584631401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012131214141845703, "StateBufferConnector_ms": 0.007874488830566406, "ViewRequirementAgentConnector_ms": 0.19483089447021484}, "num_episodes": 39, "episode_return_max": -2.9990384006165707, "episode_return_min": -1240.8758694179596, "episode_return_mean": -377.1245013614736, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.04395453297565, "num_env_steps_trained_throughput_per_sec": 370.04395453297565, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10628.365, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10628.294, "sample_time_ms": 1160.37, "learn_time_ms": 9405.962, "learn_throughput": 425.262, "synch_weights_time_ms": 61.109}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "89531_00000", "date": "2024-08-05_11-19-22", "timestamp": 1722836962, "time_this_iter_s": 10.820985794067383, "time_total_s": 380.3202803134918, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643ba440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 380.3202803134918, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.19333333333333, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.69938466250896, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9102682600418727, "policy_loss": -0.014317012450192124, "vf_loss": 0.9174843141498665, "vf_explained_var": 0.9981221610680222, "kl": 0.015956554001604704, "entropy": 0.7949045284961661, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -2.9990384006165707, "episode_reward_min": -1288.592018012997, "episode_reward_mean": -357.2308670061245, "episode_len_mean": 108.51, "episode_media": {}, "episodes_timesteps_total": 10851, "policy_reward_min": {"policy_0": -1288.592018012997}, "policy_reward_max": {"policy_0": -2.9990384006165707}, "policy_reward_mean": {"policy_0": -357.2308670061245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417, -965.2651098941982, -162.21030992694278, -467.6594376146626, -138.62418072672392, -525.1728582991558, -140.6517673978958, -131.65215282874158, -132.986136932833, -253.86356148002218, -1093.0659573811504, -376.41483963273987, -503.69391691772915, -65.75668049878556, -329.5555754046029, -77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347, -263.16161888370294, -364.7601642361995, -485.65870403599166, -87.2336478229265, -148.976341358211, -822.198597964772, -203.74333660469915, -733.7983005554042, -97.63635923660046, -310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254], "episode_lengths": [91, 45, 82, 127, 131, 150, 114, 67, 49, 150, 150, 37, 150, 119, 150, 150, 101, 150, 150, 150, 150, 92, 150, 33, 150, 150, 82, 150, 76, 150, 80, 71, 91, 90, 150, 114, 150, 64, 129, 45, 150, 61, 79, 55, 150, 55, 150, 59, 150, 150, 150, 150, 150, 121, 58, 61, 125, 78, 57, 125, 98, 119, 150, 150, 106, 150, 129, 52, 73, 150, 84, 150, 60, 140, 150, 101, 49, 150, 55, 116, 92, 150, 134, 50, 58, 96, 150, 122, 75, 150, 70, 73, 114, 52, 51, 150, 70, 120, 90, 138], "policy_policy_0_reward": [-231.56556581870188, -48.57026059910242, -129.89228582391672, -426.82322327328893, -273.96168289796964, -379.21390002819874, -247.58196243465358, -85.32717459984158, -15.163809482679632, -293.8799400216159, -483.9906563065457, -33.91976987239985, -430.2454161113462, -400.52483346338397, -902.9442684546879, -992.2748088139177, -303.9991828440184, -322.90841796513763, -305.05557496142825, -530.1914413570688, -769.1774607973874, -161.76012138642986, -393.9241980832818, -2.9990384006165707, -965.7578810627417, -965.2651098941982, -162.21030992694278, -467.6594376146626, -138.62418072672392, -525.1728582991558, -140.6517673978958, -131.65215282874158, -132.986136932833, -253.86356148002218, -1093.0659573811504, -376.41483963273987, -503.69391691772915, -65.75668049878556, -329.5555754046029, -77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347, -263.16161888370294, -364.7601642361995, -485.65870403599166, -87.2336478229265, -148.976341358211, -822.198597964772, -203.74333660469915, -733.7983005554042, -97.63635923660046, -310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.549517180957145, "mean_inference_ms": 1.7099932117665273, "mean_action_processing_ms": 0.2718006562016264, "mean_env_wait_ms": 3.29778649756251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012592077255249023, "StateBufferConnector_ms": 0.007886648178100586, "ViewRequirementAgentConnector_ms": 0.1940164566040039}, "num_episodes": 36, "episode_return_max": -2.9990384006165707, "episode_return_min": -1288.592018012997, "episode_return_mean": -357.2308670061245, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.36363514617454, "num_env_steps_trained_throughput_per_sec": 449.36363514617454, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 10396.332, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10396.259, "sample_time_ms": 1141.054, "learn_time_ms": 9193.377, "learn_throughput": 435.096, "synch_weights_time_ms": 60.977}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "89531_00000", "date": "2024-08-05_11-19-31", "timestamp": 1722836971, "time_this_iter_s": 8.912997007369995, "time_total_s": 389.2332773208618, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bbbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 389.2332773208618, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.484615384615385, "ram_util_percent": 29.184615384615388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.90076431532701, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0384563871038457, "policy_loss": -0.022999557264847682, "vf_loss": 1.054265523919215, "vf_explained_var": 0.9957741584007939, "kl": 0.016171874717959656, "entropy": 0.8692186523228884, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -19.867556146042254, "episode_reward_min": -1288.592018012997, "episode_reward_mean": -354.6375633194946, "episode_len_mean": 105.64, "episode_media": {}, "episodes_timesteps_total": 10564, "policy_reward_min": {"policy_0": -1288.592018012997}, "policy_reward_max": {"policy_0": -19.867556146042254}, "policy_reward_mean": {"policy_0": -354.6375633194946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347, -263.16161888370294, -364.7601642361995, -485.65870403599166, -87.2336478229265, -148.976341358211, -822.198597964772, -203.74333660469915, -733.7983005554042, -97.63635923660046, -310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254, -877.1111011042692, -19.867556146042254, -190.10656572585535, -68.52947736087435, -566.1211363290458, -1224.0043619361456, -570.1017273863498, -1003.107876943457, -85.89090199857371, -209.4967075012706, -266.7216566518642, -343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661], "episode_lengths": [45, 150, 61, 79, 55, 150, 55, 150, 59, 150, 150, 150, 150, 150, 121, 58, 61, 125, 78, 57, 125, 98, 119, 150, 150, 106, 150, 129, 52, 73, 150, 84, 150, 60, 140, 150, 101, 49, 150, 55, 116, 92, 150, 134, 50, 58, 96, 150, 122, 75, 150, 70, 73, 114, 52, 51, 150, 70, 120, 90, 138, 150, 40, 80, 62, 149, 150, 150, 150, 68, 111, 91, 105, 150, 150, 112, 82, 150, 115, 76, 150, 80, 150, 139, 96, 91, 150, 131, 96, 150, 62, 81, 79, 54, 48, 142, 82, 74, 65, 87], "policy_policy_0_reward": [-77.27447739357326, -569.7609348886906, -77.95982510067029, -185.679876349284, -34.166831489175856, -637.895813134483, -51.13965233929136, -322.1479621388289, -53.22664404390664, -955.0572724043956, -1135.2446866500102, -624.9962452229033, -543.1570758453313, -345.715905680081, -222.91069498319644, -76.21183955107166, -167.84040984172483, -314.1604872555784, -138.79293619891317, -60.324594911098764, -436.0910398495928, -272.39807791860636, -349.25550100498486, -1107.9773352825366, -986.4470574757347, -263.16161888370294, -364.7601642361995, -485.65870403599166, -87.2336478229265, -148.976341358211, -822.198597964772, -203.74333660469915, -733.7983005554042, -97.63635923660046, -310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254, -877.1111011042692, -19.867556146042254, -190.10656572585535, -68.52947736087435, -566.1211363290458, -1224.0043619361456, -570.1017273863498, -1003.107876943457, -85.89090199857371, -209.4967075012706, -266.7216566518642, -343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5498425260952269, "mean_inference_ms": 1.707031283446243, "mean_action_processing_ms": 0.27167943225442237, "mean_env_wait_ms": 3.2972790854666636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012454032897949219, "StateBufferConnector_ms": 0.008038520812988281, "ViewRequirementAgentConnector_ms": 0.19028687477111816}, "num_episodes": 39, "episode_return_max": -19.867556146042254, "episode_return_min": -1288.592018012997, "episode_return_mean": -354.6375633194946, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.0563763666494, "num_env_steps_trained_throughput_per_sec": 450.0563763666494, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10228.597, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10228.525, "sample_time_ms": 1134.773, "learn_time_ms": 9031.737, "learn_throughput": 442.883, "synch_weights_time_ms": 61.185}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "89531_00000", "date": "2024-08-05_11-19-40", "timestamp": 1722836980, "time_this_iter_s": 8.900904655456543, "time_total_s": 398.13418197631836, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 398.13418197631836, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.49230769230769, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.52912866175174, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0786408201015243, "policy_loss": -0.01360113520010297, "vf_loss": 1.0855298414515953, "vf_explained_var": 0.9952624096845587, "kl": 0.015102445153282436, "entropy": 0.8398284317304691, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -19.867556146042254, "episode_reward_min": -1288.592018012997, "episode_reward_mean": -337.3475237096978, "episode_len_mean": 105.93, "episode_media": {}, "episodes_timesteps_total": 10593, "policy_reward_min": {"policy_0": -1288.592018012997}, "policy_reward_max": {"policy_0": -19.867556146042254}, "policy_reward_mean": {"policy_0": -337.3475237096978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254, -877.1111011042692, -19.867556146042254, -190.10656572585535, -68.52947736087435, -566.1211363290458, -1224.0043619361456, -570.1017273863498, -1003.107876943457, -85.89090199857371, -209.4967075012706, -266.7216566518642, -343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661, -385.08459845143375, -560.5042032339212, -359.32644262145936, -626.5748895015407, -722.8032666459245, -30.61917147538003, -147.69588596892243, -291.1815043678411, -343.2580416193354, -495.6625574592505, -95.16532242115346, -205.31425916804582, -255.98426192978587, -53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367], "episode_lengths": [140, 150, 101, 49, 150, 55, 116, 92, 150, 134, 50, 58, 96, 150, 122, 75, 150, 70, 73, 114, 52, 51, 150, 70, 120, 90, 138, 150, 40, 80, 62, 149, 150, 150, 150, 68, 111, 91, 105, 150, 150, 112, 82, 150, 115, 76, 150, 80, 150, 139, 96, 91, 150, 131, 96, 150, 62, 81, 79, 54, 48, 142, 82, 74, 65, 87, 150, 150, 117, 150, 150, 50, 91, 127, 150, 150, 75, 103, 150, 58, 70, 150, 150, 75, 55, 62, 123, 66, 78, 150, 101, 54, 90, 118, 79, 148, 150, 117, 93, 79], "policy_policy_0_reward": [-310.8322279387258, -1288.592018012997, -290.7180622462262, -37.74040967647598, -655.12762606687, -58.61673120137957, -342.88732527277233, -144.6692207693387, -448.3183308955365, -346.77836450647936, -66.44070719499238, -78.3202731831911, -271.43330468690846, -663.4014900686386, -214.85150759103522, -126.81274809914032, -291.67375451356776, -109.13769710388947, -110.16614519987633, -225.04045983661302, -97.14976210944062, -61.04266067344956, -1042.1406692970959, -84.44291898681556, -272.1994331042275, -193.84142806479719, -519.485816863254, -877.1111011042692, -19.867556146042254, -190.10656572585535, -68.52947736087435, -566.1211363290458, -1224.0043619361456, -570.1017273863498, -1003.107876943457, -85.89090199857371, -209.4967075012706, -266.7216566518642, -343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661, -385.08459845143375, -560.5042032339212, -359.32644262145936, -626.5748895015407, -722.8032666459245, -30.61917147538003, -147.69588596892243, -291.1815043678411, -343.2580416193354, -495.6625574592505, -95.16532242115346, -205.31425916804582, -255.98426192978587, -53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5497006295232354, "mean_inference_ms": 1.706496127467989, "mean_action_processing_ms": 0.27182266949177597, "mean_env_wait_ms": 3.2988029047993424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011846780776977539, "StateBufferConnector_ms": 0.007943391799926758, "ViewRequirementAgentConnector_ms": 0.1922743320465088}, "num_episodes": 34, "episode_return_max": -19.867556146042254, "episode_return_min": -1288.592018012997, "episode_return_mean": -337.3475237096978, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.4903641142612, "num_env_steps_trained_throughput_per_sec": 338.4903641142612, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10328.397, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10328.327, "sample_time_ms": 1142.239, "learn_time_ms": 9125.207, "learn_throughput": 438.346, "synch_weights_time_ms": 60.068}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "89531_00000", "date": "2024-08-05_11-19-51", "timestamp": 1722836991, "time_this_iter_s": 11.827325105667114, "time_total_s": 409.9615070819855, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644715120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 409.9615070819855, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.06470588235294, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.06409373879433, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.1608624023695786, "policy_loss": -0.011918630880245473, "vf_loss": 1.1674419300320247, "vf_explained_var": 0.9842112751056751, "kl": 0.012027695540897792, "entropy": 0.7335926083226999, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -7.8494832805522705, "episode_reward_min": -1190.8819984392774, "episode_reward_mean": -351.2460122433602, "episode_len_mean": 108.47, "episode_media": {}, "episodes_timesteps_total": 10847, "policy_reward_min": {"policy_0": -1190.8819984392774}, "policy_reward_max": {"policy_0": -7.8494832805522705}, "policy_reward_mean": {"policy_0": -351.2460122433602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661, -385.08459845143375, -560.5042032339212, -359.32644262145936, -626.5748895015407, -722.8032666459245, -30.61917147538003, -147.69588596892243, -291.1815043678411, -343.2580416193354, -495.6625574592505, -95.16532242115346, -205.31425916804582, -255.98426192978587, -53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367, -966.9567961104165, -11.704824800280338, -26.696747182485527, -511.94699539625816, -133.46466328377747, -333.5461859564334, -130.372054679441, -1042.6408895800578, -160.5990738069985, -491.4897285881166, -394.8263776636581, -413.63146861135766, -453.72190106630165, -768.1717185645933, -419.2854205685387, -253.46549979034472, -542.1418215060635, -453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508], "episode_lengths": [105, 150, 150, 112, 82, 150, 115, 76, 150, 80, 150, 139, 96, 91, 150, 131, 96, 150, 62, 81, 79, 54, 48, 142, 82, 74, 65, 87, 150, 150, 117, 150, 150, 50, 91, 127, 150, 150, 75, 103, 150, 58, 70, 150, 150, 75, 55, 62, 123, 66, 78, 150, 101, 54, 90, 118, 79, 148, 150, 117, 93, 79, 150, 35, 46, 150, 73, 129, 73, 150, 81, 150, 102, 150, 150, 140, 150, 71, 150, 150, 133, 105, 150, 146, 49, 102, 150, 89, 101, 83, 150, 89, 67, 88, 96, 88, 34, 150, 101, 150], "policy_policy_0_reward": [-343.33911324750653, -522.3002792606742, -502.0235955835011, -277.14125952167984, -130.34569699970714, -414.11333497918383, -183.45977966531225, -155.20912310010908, -1183.9715284904435, -145.11462430975854, -1190.8819984392774, -690.9457113469442, -242.1741688200888, -240.33110291751058, -486.32860120855884, -292.9412250018542, -240.3857540205068, -454.43771097674176, -72.0591562350958, -115.99571925510317, -123.45141484096116, -41.90396571425861, -25.72441167100001, -448.8763703224711, -116.11394530923162, -138.37546149821284, -84.87047835384621, -215.0203909602661, -385.08459845143375, -560.5042032339212, -359.32644262145936, -626.5748895015407, -722.8032666459245, -30.61917147538003, -147.69588596892243, -291.1815043678411, -343.2580416193354, -495.6625574592505, -95.16532242115346, -205.31425916804582, -255.98426192978587, -53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367, -966.9567961104165, -11.704824800280338, -26.696747182485527, -511.94699539625816, -133.46466328377747, -333.5461859564334, -130.372054679441, -1042.6408895800578, -160.5990738069985, -491.4897285881166, -394.8263776636581, -413.63146861135766, -453.72190106630165, -768.1717185645933, -419.2854205685387, -253.46549979034472, -542.1418215060635, -453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5498990207083418, "mean_inference_ms": 1.7037856377406453, "mean_action_processing_ms": 0.2717944288881343, "mean_env_wait_ms": 3.2982434762412356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011792898178100586, "StateBufferConnector_ms": 0.007946491241455078, "ViewRequirementAgentConnector_ms": 0.19349288940429688}, "num_episodes": 38, "episode_return_max": -7.8494832805522705, "episode_return_min": -1190.8819984392774, "episode_return_mean": -351.2460122433602, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.5429864565415, "num_env_steps_trained_throughput_per_sec": 330.5429864565415, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 10406.672, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10406.602, "sample_time_ms": 1099.068, "learn_time_ms": 9245.751, "learn_throughput": 432.631, "synch_weights_time_ms": 60.962}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "89531_00000", "date": "2024-08-05_11-20-04", "timestamp": 1722837004, "time_this_iter_s": 12.112342834472656, "time_total_s": 422.07384991645813, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644715090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.07384991645813, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.258823529411764, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.84236857295036, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.035506825335324, "policy_loss": -0.008962075900247632, "vf_loss": 1.0366511264195044, "vf_explained_var": 0.9956884718810518, "kl": 0.017533650659083834, "entropy": 0.7236802735365927, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -7.8494832805522705, "episode_reward_min": -1161.1460951386962, "episode_reward_mean": -356.25708494357764, "episode_len_mean": 105.88, "episode_media": {}, "episodes_timesteps_total": 10588, "policy_reward_min": {"policy_0": -1161.1460951386962}, "policy_reward_max": {"policy_0": -7.8494832805522705}, "policy_reward_mean": {"policy_0": -356.25708494357764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367, -966.9567961104165, -11.704824800280338, -26.696747182485527, -511.94699539625816, -133.46466328377747, -333.5461859564334, -130.372054679441, -1042.6408895800578, -160.5990738069985, -491.4897285881166, -394.8263776636581, -413.63146861135766, -453.72190106630165, -768.1717185645933, -419.2854205685387, -253.46549979034472, -542.1418215060635, -453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508, -372.4856865562215, -45.31767150688215, -520.6821986903888, -113.84838731610948, -250.18841385575104, -283.6815342670121, -200.88080988183395, -53.475706222446014, -394.38969300203854, -44.924160746514076, -220.16321044693134, -557.563651541477, -451.21624410736695, -287.5706460976336, -143.56603348101632, -111.75009885155966, -170.90269914433557, -125.0583358616797, -342.3297460909683, -85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162], "episode_lengths": [58, 70, 150, 150, 75, 55, 62, 123, 66, 78, 150, 101, 54, 90, 118, 79, 148, 150, 117, 93, 79, 150, 35, 46, 150, 73, 129, 73, 150, 81, 150, 102, 150, 150, 140, 150, 71, 150, 150, 133, 105, 150, 146, 49, 102, 150, 89, 101, 83, 150, 89, 67, 88, 96, 88, 34, 150, 101, 150, 147, 49, 150, 69, 105, 131, 84, 42, 121, 45, 108, 150, 150, 150, 65, 65, 85, 75, 128, 67, 150, 87, 150, 76, 124, 150, 59, 150, 74, 150, 150, 95, 72, 60, 150, 104, 150, 150, 71, 81, 62], "policy_policy_0_reward": [-53.06112979506347, -104.0194563588846, -1043.166827640654, -1101.931288343422, -157.3454063593225, -40.82091705051434, -57.80315327325862, -305.91237944967355, -91.8915142851392, -147.03931844216982, -407.20961539275834, -296.72006109355874, -50.23561897467241, -214.75427742986568, -435.81499838439356, -204.01891855351786, -408.89765621052805, -789.9951011161453, -461.7328308296639, -222.55004323332835, -109.90136959196367, -966.9567961104165, -11.704824800280338, -26.696747182485527, -511.94699539625816, -133.46466328377747, -333.5461859564334, -130.372054679441, -1042.6408895800578, -160.5990738069985, -491.4897285881166, -394.8263776636581, -413.63146861135766, -453.72190106630165, -768.1717185645933, -419.2854205685387, -253.46549979034472, -542.1418215060635, -453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508, -372.4856865562215, -45.31767150688215, -520.6821986903888, -113.84838731610948, -250.18841385575104, -283.6815342670121, -200.88080988183395, -53.475706222446014, -394.38969300203854, -44.924160746514076, -220.16321044693134, -557.563651541477, -451.21624410736695, -287.5706460976336, -143.56603348101632, -111.75009885155966, -170.90269914433557, -125.0583358616797, -342.3297460909683, -85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5500083783623821, "mean_inference_ms": 1.703990790118361, "mean_action_processing_ms": 0.27182441399793017, "mean_env_wait_ms": 3.299455728636989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012553215026855469, "StateBufferConnector_ms": 0.007894754409790039, "ViewRequirementAgentConnector_ms": 0.1955699920654297}, "num_episodes": 41, "episode_return_max": -7.8494832805522705, "episode_return_min": -1161.1460951386962, "episode_return_mean": -356.25708494357764, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9848946110579, "num_env_steps_trained_throughput_per_sec": 312.9848946110579, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 10754.755, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10754.682, "sample_time_ms": 1097.951, "learn_time_ms": 9595.358, "learn_throughput": 416.868, "synch_weights_time_ms": 60.552}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "89531_00000", "date": "2024-08-05_11-20-16", "timestamp": 1722837016, "time_this_iter_s": 12.79374074935913, "time_total_s": 434.86759066581726, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 434.86759066581726, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.788888888888888, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.8135612308979, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.3293234823892515, "policy_loss": -0.009753622042141311, "vf_loss": 1.3330831982505817, "vf_explained_var": 0.9861297108232975, "kl": 0.013457828066263307, "entropy": 0.6211318594714006, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -7.8494832805522705, "episode_reward_min": -1200.4771911489809, "episode_reward_mean": -336.16902349207805, "episode_len_mean": 102.25, "episode_media": {}, "episodes_timesteps_total": 10225, "policy_reward_min": {"policy_0": -1200.4771911489809}, "policy_reward_max": {"policy_0": -7.8494832805522705}, "policy_reward_mean": {"policy_0": -336.16902349207805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508, -372.4856865562215, -45.31767150688215, -520.6821986903888, -113.84838731610948, -250.18841385575104, -283.6815342670121, -200.88080988183395, -53.475706222446014, -394.38969300203854, -44.924160746514076, -220.16321044693134, -557.563651541477, -451.21624410736695, -287.5706460976336, -143.56603348101632, -111.75009885155966, -170.90269914433557, -125.0583358616797, -342.3297460909683, -85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162, -1200.4771911489809, -94.224155472883, -162.88234820448838, -62.299860094582385, -237.94461668731492, -109.265037224862, -277.83597490177044, -1115.6043441278691, -40.554426333995714, -109.09731613256038, -372.5432407935836, -121.97921314895243, -82.16418308972546, -658.5370558285518, -447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117], "episode_lengths": [150, 133, 105, 150, 146, 49, 102, 150, 89, 101, 83, 150, 89, 67, 88, 96, 88, 34, 150, 101, 150, 147, 49, 150, 69, 105, 131, 84, 42, 121, 45, 108, 150, 150, 150, 65, 65, 85, 75, 128, 67, 150, 87, 150, 76, 124, 150, 59, 150, 74, 150, 150, 95, 72, 60, 150, 104, 150, 150, 71, 81, 62, 150, 69, 79, 47, 112, 73, 130, 150, 44, 72, 113, 73, 60, 150, 131, 41, 35, 56, 85, 60, 120, 99, 113, 150, 57, 150, 64, 91, 45, 150, 47, 125, 51, 142, 69, 150, 150, 150], "policy_policy_0_reward": [-453.1593438146843, -309.03740912820217, -193.2449429909661, -677.5232606997558, -367.3011039406228, -34.7375965613648, -211.69154954903155, -1161.1460951386962, -248.95798504911127, -311.2448967212533, -179.0446700080801, -676.3490193396725, -216.88636464411098, -85.43916037854977, -89.65652602653516, -344.9285086545228, -138.674229552793, -7.8494832805522705, -1015.6344193589139, -387.3941444674242, -658.2061391537508, -372.4856865562215, -45.31767150688215, -520.6821986903888, -113.84838731610948, -250.18841385575104, -283.6815342670121, -200.88080988183395, -53.475706222446014, -394.38969300203854, -44.924160746514076, -220.16321044693134, -557.563651541477, -451.21624410736695, -287.5706460976336, -143.56603348101632, -111.75009885155966, -170.90269914433557, -125.0583358616797, -342.3297460909683, -85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162, -1200.4771911489809, -94.224155472883, -162.88234820448838, -62.299860094582385, -237.94461668731492, -109.265037224862, -277.83597490177044, -1115.6043441278691, -40.554426333995714, -109.09731613256038, -372.5432407935836, -121.97921314895243, -82.16418308972546, -658.5370558285518, -447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5501234261574354, "mean_inference_ms": 1.702675068262799, "mean_action_processing_ms": 0.27149723778541474, "mean_env_wait_ms": 3.2966249510599073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012381315231323242, "StateBufferConnector_ms": 0.007899284362792969, "ViewRequirementAgentConnector_ms": 0.19272708892822266}, "num_episodes": 38, "episode_return_max": -7.8494832805522705, "episode_return_min": -1200.4771911489809, "episode_return_mean": -336.16902349207805, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.4273763228281, "num_env_steps_trained_throughput_per_sec": 452.4273763228281, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 10762.102, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10762.028, "sample_time_ms": 1091.992, "learn_time_ms": 9606.559, "learn_throughput": 416.382, "synch_weights_time_ms": 62.648}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "89531_00000", "date": "2024-08-05_11-20-25", "timestamp": 1722837025, "time_this_iter_s": 8.853838443756104, "time_total_s": 443.72142910957336, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644716560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.72142910957336, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.923076923076923, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.63125251034896, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.035501916675518, "policy_loss": -0.009382735683660333, "vf_loss": 1.0386198507621884, "vf_explained_var": 0.9839991415540378, "kl": 0.014065130861246219, "entropy": 0.6450800856264929, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -13.480134734755566, "episode_reward_min": -1200.4771911489809, "episode_reward_mean": -333.96333807643765, "episode_len_mean": 100.31, "episode_media": {}, "episodes_timesteps_total": 10031, "policy_reward_min": {"policy_0": -1200.4771911489809}, "policy_reward_max": {"policy_0": -13.480134734755566}, "policy_reward_mean": {"policy_0": -333.96333807643765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162, -1200.4771911489809, -94.224155472883, -162.88234820448838, -62.299860094582385, -237.94461668731492, -109.265037224862, -277.83597490177044, -1115.6043441278691, -40.554426333995714, -109.09731613256038, -372.5432407935836, -121.97921314895243, -82.16418308972546, -658.5370558285518, -447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117, -165.7393646248803, -139.88524802769095, -106.26174272616983, -53.57525232708922, -171.93384074822333, -107.62917606312752, -335.6492444114859, -194.8719299085266, -435.87221725494067, -447.0166196749737, -103.25147842519576, -956.1150984116554, -422.51815044962456, -534.3087364357166, -104.71944368342773, -295.9594749957473, -67.20952299519246, -503.39295425709435, -68.5423426787263, -132.35820632588027, -474.2806545270965, -57.73040191914893, -181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598], "episode_lengths": [67, 150, 87, 150, 76, 124, 150, 59, 150, 74, 150, 150, 95, 72, 60, 150, 104, 150, 150, 71, 81, 62, 150, 69, 79, 47, 112, 73, 130, 150, 44, 72, 113, 73, 60, 150, 131, 41, 35, 56, 85, 60, 120, 99, 113, 150, 57, 150, 64, 91, 45, 150, 47, 125, 51, 142, 69, 150, 150, 150, 100, 79, 65, 58, 78, 78, 128, 104, 126, 141, 67, 150, 100, 141, 76, 102, 59, 150, 70, 74, 124, 51, 99, 95, 150, 150, 86, 80, 150, 150, 73, 69, 117, 122, 87, 71, 149, 74, 61, 92], "policy_policy_0_reward": [-85.14609484857245, -810.5083991396525, -175.923997030841, -1014.6488351213294, -135.87783659272938, -326.6426996410024, -397.9783046061682, -52.72573587807749, -835.2239407471005, -135.74992051823753, -1108.7215811420297, -1088.0546068971512, -270.78099244748284, -124.45282159581829, -89.23199203156743, -636.4900854713443, -275.98506844102326, -1102.8735709845391, -360.035735069599, -143.37270893532454, -143.752392811576, -93.9453493162162, -1200.4771911489809, -94.224155472883, -162.88234820448838, -62.299860094582385, -237.94461668731492, -109.265037224862, -277.83597490177044, -1115.6043441278691, -40.554426333995714, -109.09731613256038, -372.5432407935836, -121.97921314895243, -82.16418308972546, -658.5370558285518, -447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117, -165.7393646248803, -139.88524802769095, -106.26174272616983, -53.57525232708922, -171.93384074822333, -107.62917606312752, -335.6492444114859, -194.8719299085266, -435.87221725494067, -447.0166196749737, -103.25147842519576, -956.1150984116554, -422.51815044962456, -534.3087364357166, -104.71944368342773, -295.9594749957473, -67.20952299519246, -503.39295425709435, -68.5423426787263, -132.35820632588027, -474.2806545270965, -57.73040191914893, -181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5501987637771021, "mean_inference_ms": 1.7014816223471343, "mean_action_processing_ms": 0.2715547746249766, "mean_env_wait_ms": 3.2979260858396877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227259635925293, "StateBufferConnector_ms": 0.00784754753112793, "ViewRequirementAgentConnector_ms": 0.1902613639831543}, "num_episodes": 40, "episode_return_max": -13.480134734755566, "episode_return_min": -1200.4771911489809, "episode_return_mean": -333.96333807643765, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.94444937713337, "num_env_steps_trained_throughput_per_sec": 442.94444937713337, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 10531.483, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10531.41, "sample_time_ms": 1094.523, "learn_time_ms": 9373.218, "learn_throughput": 426.748, "synch_weights_time_ms": 62.839}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "89531_00000", "date": "2024-08-05_11-20-34", "timestamp": 1722837034, "time_this_iter_s": 9.044472217559814, "time_total_s": 452.7659013271332, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.7659013271332, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 20.292307692307695, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.87595958511035, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0215528714160125, "policy_loss": -0.014799752199905924, "vf_loss": 1.0264973910525441, "vf_explained_var": 0.9978797490398089, "kl": 0.02201876987898386, "entropy": 0.5321463669184595, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -13.480134734755566, "episode_reward_min": -1137.9407417193183, "episode_reward_mean": -306.8365974175884, "episode_len_mean": 100.33, "episode_media": {}, "episodes_timesteps_total": 10033, "policy_reward_min": {"policy_0": -1137.9407417193183}, "policy_reward_max": {"policy_0": -13.480134734755566}, "policy_reward_mean": {"policy_0": -306.8365974175884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117, -165.7393646248803, -139.88524802769095, -106.26174272616983, -53.57525232708922, -171.93384074822333, -107.62917606312752, -335.6492444114859, -194.8719299085266, -435.87221725494067, -447.0166196749737, -103.25147842519576, -956.1150984116554, -422.51815044962456, -534.3087364357166, -104.71944368342773, -295.9594749957473, -67.20952299519246, -503.39295425709435, -68.5423426787263, -132.35820632588027, -474.2806545270965, -57.73040191914893, -181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598, -160.7319222381348, -456.7782899777825, -108.61909389453874, -1026.859780317218, -665.4541901393588, -77.53997021263966, -68.74706726888695, -84.34547127637586, -1005.6712968330178, -147.6498408841171, -75.91153308783937, -297.61783750718337, -1013.2400011299279, -469.7624354313646, -72.94692472333385, -119.00322258315725, -61.088432570041576, -154.0975962328434, -120.47919185510636, -272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155], "episode_lengths": [131, 41, 35, 56, 85, 60, 120, 99, 113, 150, 57, 150, 64, 91, 45, 150, 47, 125, 51, 142, 69, 150, 150, 150, 100, 79, 65, 58, 78, 78, 128, 104, 126, 141, 67, 150, 100, 141, 76, 102, 59, 150, 70, 74, 124, 51, 99, 95, 150, 150, 86, 80, 150, 150, 73, 69, 117, 122, 87, 71, 149, 74, 61, 92, 80, 150, 76, 150, 150, 68, 56, 59, 150, 77, 64, 124, 150, 150, 70, 68, 67, 83, 72, 124, 94, 150, 150, 110, 98, 150, 150, 52, 83, 150, 87, 71, 133, 69, 60, 111], "policy_policy_0_reward": [-447.2627525370277, -31.4179557484559, -13.480134734755566, -49.27509008584691, -185.60888194004804, -53.38992955445264, -215.09849356389577, -277.10405855836495, -372.1722717033224, -1137.9407417193183, -64.53548473898555, -659.0451477017791, -114.75980864517997, -213.51289673817098, -25.3161886203918, -267.8474063506573, -37.5577735002733, -738.267360955304, -51.395907922156326, -436.0795987433495, -110.68017973039626, -436.70587909519946, -554.4109900469979, -612.4040076892117, -165.7393646248803, -139.88524802769095, -106.26174272616983, -53.57525232708922, -171.93384074822333, -107.62917606312752, -335.6492444114859, -194.8719299085266, -435.87221725494067, -447.0166196749737, -103.25147842519576, -956.1150984116554, -422.51815044962456, -534.3087364357166, -104.71944368342773, -295.9594749957473, -67.20952299519246, -503.39295425709435, -68.5423426787263, -132.35820632588027, -474.2806545270965, -57.73040191914893, -181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598, -160.7319222381348, -456.7782899777825, -108.61909389453874, -1026.859780317218, -665.4541901393588, -77.53997021263966, -68.74706726888695, -84.34547127637586, -1005.6712968330178, -147.6498408841171, -75.91153308783937, -297.61783750718337, -1013.2400011299279, -469.7624354313646, -72.94692472333385, -119.00322258315725, -61.088432570041576, -154.0975962328434, -120.47919185510636, -272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505652397187991, "mean_inference_ms": 1.7003273890424193, "mean_action_processing_ms": 0.2718479262747184, "mean_env_wait_ms": 3.2969262926794323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011870145797729492, "StateBufferConnector_ms": 0.007756233215332031, "ViewRequirementAgentConnector_ms": 0.19652509689331055}, "num_episodes": 36, "episode_return_max": -13.480134734755566, "episode_return_min": -1137.9407417193183, "episode_return_mean": -306.8365974175884, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.5823649517423, "num_env_steps_trained_throughput_per_sec": 366.5823649517423, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 10467.674, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10467.6, "sample_time_ms": 1107.293, "learn_time_ms": 9296.386, "learn_throughput": 430.275, "synch_weights_time_ms": 63.081}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "89531_00000", "date": "2024-08-05_11-20-45", "timestamp": 1722837045, "time_this_iter_s": 10.923679113388062, "time_total_s": 463.68958044052124, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bb0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.68958044052124, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.899999999999995, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94.41399161418279, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.081751801772043, "policy_loss": -0.014358783408048718, "vf_loss": 1.0885070669775208, "vf_explained_var": 0.9955920587604244, "kl": 0.011368186306602529, "entropy": 0.7000633271721503, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -15.381078525648396, "episode_reward_min": -1260.8722835818155, "episode_reward_mean": -327.1241093154815, "episode_len_mean": 103.73, "episode_media": {}, "episodes_timesteps_total": 10373, "policy_reward_min": {"policy_0": -1260.8722835818155}, "policy_reward_max": {"policy_0": -15.381078525648396}, "policy_reward_mean": {"policy_0": -327.1241093154815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598, -160.7319222381348, -456.7782899777825, -108.61909389453874, -1026.859780317218, -665.4541901393588, -77.53997021263966, -68.74706726888695, -84.34547127637586, -1005.6712968330178, -147.6498408841171, -75.91153308783937, -297.61783750718337, -1013.2400011299279, -469.7624354313646, -72.94692472333385, -119.00322258315725, -61.088432570041576, -154.0975962328434, -120.47919185510636, -272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155, -472.18213312067667, -111.17624447185369, -144.302578950807, -290.94574387450905, -218.9240712423703, -332.5091468072182, -46.81416463597269, -246.48787060549046, -1042.2938408414416, -371.35055799504386, -137.42168694971548, -290.2216959610342, -1031.4236732865124, -172.44851336289005, -395.7800342255103, -36.05196538375435, -315.1385702933174, -297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218], "episode_lengths": [99, 95, 150, 150, 86, 80, 150, 150, 73, 69, 117, 122, 87, 71, 149, 74, 61, 92, 80, 150, 76, 150, 150, 68, 56, 59, 150, 77, 64, 124, 150, 150, 70, 68, 67, 83, 72, 124, 94, 150, 150, 110, 98, 150, 150, 52, 83, 150, 87, 71, 133, 69, 60, 111, 150, 84, 80, 122, 118, 150, 53, 114, 150, 150, 70, 100, 150, 80, 150, 53, 118, 101, 64, 81, 150, 150, 150, 150, 113, 150, 93, 41, 66, 150, 73, 81, 150, 120, 150, 60, 73, 48, 83, 62, 150, 55, 56, 150, 57, 73], "policy_policy_0_reward": [-181.84605984196318, -208.80531455256437, -1066.9403795030294, -858.0218853915667, -131.20599419485035, -144.963832691581, -390.05151242656586, -864.7070750358722, -87.44828259676999, -180.74460795313274, -344.1947162041493, -446.97273787542747, -177.947409948141, -93.11985395805867, -704.1611667414605, -171.78947231439764, -74.80833015721352, -230.9835023043598, -160.7319222381348, -456.7782899777825, -108.61909389453874, -1026.859780317218, -665.4541901393588, -77.53997021263966, -68.74706726888695, -84.34547127637586, -1005.6712968330178, -147.6498408841171, -75.91153308783937, -297.61783750718337, -1013.2400011299279, -469.7624354313646, -72.94692472333385, -119.00322258315725, -61.088432570041576, -154.0975962328434, -120.47919185510636, -272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155, -472.18213312067667, -111.17624447185369, -144.302578950807, -290.94574387450905, -218.9240712423703, -332.5091468072182, -46.81416463597269, -246.48787060549046, -1042.2938408414416, -371.35055799504386, -137.42168694971548, -290.2216959610342, -1031.4236732865124, -172.44851336289005, -395.7800342255103, -36.05196538375435, -315.1385702933174, -297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509603960410119, "mean_inference_ms": 1.6980622307691848, "mean_action_processing_ms": 0.2719365609719073, "mean_env_wait_ms": 3.2963278967964857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011956930160522461, "StateBufferConnector_ms": 0.007722377777099609, "ViewRequirementAgentConnector_ms": 0.1959085464477539}, "num_episodes": 46, "episode_return_max": -15.381078525648396, "episode_return_min": -1260.8722835818155, "episode_return_mean": -327.1241093154815, "episodes_this_iter": 46}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.85550217485456, "num_env_steps_trained_throughput_per_sec": 349.85550217485456, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 10551.413, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10551.34, "sample_time_ms": 1129.362, "learn_time_ms": 9358.591, "learn_throughput": 427.415, "synch_weights_time_ms": 62.539}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "89531_00000", "date": "2024-08-05_11-20-57", "timestamp": 1722837057, "time_this_iter_s": 11.44498085975647, "time_total_s": 475.1345613002777, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643bac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 475.1345613002777, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.18823529411765, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.84376695056757, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9984917956714828, "policy_loss": -0.008961057134486812, "vf_loss": 0.9993730507791042, "vf_explained_var": 0.9923005789518357, "kl": 0.012065478532561732, "entropy": 0.6439733655502399, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -15.381078525648396, "episode_reward_min": -1392.5695626588342, "episode_reward_mean": -322.5426882392207, "episode_len_mean": 104.07, "episode_media": {}, "episodes_timesteps_total": 10407, "policy_reward_min": {"policy_0": -1392.5695626588342}, "policy_reward_max": {"policy_0": -15.381078525648396}, "policy_reward_mean": {"policy_0": -322.5426882392207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155, -472.18213312067667, -111.17624447185369, -144.302578950807, -290.94574387450905, -218.9240712423703, -332.5091468072182, -46.81416463597269, -246.48787060549046, -1042.2938408414416, -371.35055799504386, -137.42168694971548, -290.2216959610342, -1031.4236732865124, -172.44851336289005, -395.7800342255103, -36.05196538375435, -315.1385702933174, -297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218, -583.8053816750133, -84.75261395933151, -103.42762070341907, -103.31750524037388, -112.58142425099882, -425.8963429872624, -401.15748015032864, -754.6481910238498, -527.3582198265918, -415.21256483872634, -30.19763586580865, -455.68780007620654, -339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849], "episode_lengths": [124, 94, 150, 150, 110, 98, 150, 150, 52, 83, 150, 87, 71, 133, 69, 60, 111, 150, 84, 80, 122, 118, 150, 53, 114, 150, 150, 70, 100, 150, 80, 150, 53, 118, 101, 64, 81, 150, 150, 150, 150, 113, 150, 93, 41, 66, 150, 73, 81, 150, 120, 150, 60, 73, 48, 83, 62, 150, 55, 56, 150, 57, 73, 150, 57, 69, 73, 69, 150, 117, 150, 150, 109, 46, 150, 105, 69, 103, 90, 49, 106, 47, 60, 150, 56, 63, 150, 150, 78, 150, 150, 150, 55, 43, 105, 74, 54, 150, 150, 126], "policy_policy_0_reward": [-272.20815061513133, -252.27192708985365, -422.13965156021925, -481.2762726264296, -243.2709748326185, -262.61498327911954, -596.0451228447472, -893.8508925460944, -27.14592246826567, -198.32040634893357, -469.7016233327078, -179.6369974621961, -122.77003721938071, -321.2406647507064, -119.10454064357924, -81.60797686796535, -211.10732392176155, -472.18213312067667, -111.17624447185369, -144.302578950807, -290.94574387450905, -218.9240712423703, -332.5091468072182, -46.81416463597269, -246.48787060549046, -1042.2938408414416, -371.35055799504386, -137.42168694971548, -290.2216959610342, -1031.4236732865124, -172.44851336289005, -395.7800342255103, -36.05196538375435, -315.1385702933174, -297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218, -583.8053816750133, -84.75261395933151, -103.42762070341907, -103.31750524037388, -112.58142425099882, -425.8963429872624, -401.15748015032864, -754.6481910238498, -527.3582198265918, -415.21256483872634, -30.19763586580865, -455.68780007620654, -339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551433316397581, "mean_inference_ms": 1.6974305448331817, "mean_action_processing_ms": 0.27197592526356273, "mean_env_wait_ms": 3.2999371082081983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011900186538696289, "StateBufferConnector_ms": 0.007760524749755859, "ViewRequirementAgentConnector_ms": 0.1921396255493164}, "num_episodes": 37, "episode_return_max": -15.381078525648396, "episode_return_min": -1392.5695626588342, "episode_return_mean": -322.5426882392207, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.00987934480895, "num_env_steps_trained_throughput_per_sec": 324.00987934480895, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 10704.991, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10704.917, "sample_time_ms": 1138.462, "learn_time_ms": 9502.212, "learn_throughput": 420.955, "synch_weights_time_ms": 63.4}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "89531_00000", "date": "2024-08-05_11-21-09", "timestamp": 1722837069, "time_this_iter_s": 12.357111692428589, "time_total_s": 487.4916729927063, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644714f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 487.4916729927063, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.194117647058825, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.53406435747941, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0490128111404677, "policy_loss": -0.016468216733483133, "vf_loss": 1.0571329962462186, "vf_explained_var": 0.994723133991162, "kl": 0.012455883010382725, "entropy": 0.5968949136324226, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 3.4881276282285842, "episode_reward_min": -1392.5695626588342, "episode_reward_mean": -310.0365049474805, "episode_len_mean": 101.55, "episode_media": {}, "episodes_timesteps_total": 10155, "policy_reward_min": {"policy_0": -1392.5695626588342}, "policy_reward_max": {"policy_0": 3.4881276282285842}, "policy_reward_mean": {"policy_0": -310.0365049474805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218, -583.8053816750133, -84.75261395933151, -103.42762070341907, -103.31750524037388, -112.58142425099882, -425.8963429872624, -401.15748015032864, -754.6481910238498, -527.3582198265918, -415.21256483872634, -30.19763586580865, -455.68780007620654, -339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849, -88.75634241560707, -169.36804609912232, 3.4881276282285842, -141.65169349327138, -6.3769558996444395, -186.9812690267597, -158.00380986629628, -144.00308146237828, -118.94428610150779, -413.744444495126, -29.54429725579329, -158.79455697140827, -49.181568288282605, -519.4283493863527, -330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648], "episode_lengths": [101, 64, 81, 150, 150, 150, 150, 113, 150, 93, 41, 66, 150, 73, 81, 150, 120, 150, 60, 73, 48, 83, 62, 150, 55, 56, 150, 57, 73, 150, 57, 69, 73, 69, 150, 117, 150, 150, 109, 46, 150, 105, 69, 103, 90, 49, 106, 47, 60, 150, 56, 63, 150, 150, 78, 150, 150, 150, 55, 43, 105, 74, 54, 150, 150, 126, 70, 81, 33, 82, 36, 102, 83, 73, 85, 150, 46, 85, 63, 150, 134, 150, 79, 150, 84, 85, 139, 89, 150, 150, 70, 98, 147, 150, 127, 76, 125, 106, 132, 102], "policy_policy_0_reward": [-297.26188489937897, -74.76352084799444, -123.5814097834438, -688.6598224777042, -591.5491804358195, -1260.8722835818155, -598.834179173285, -266.70634762574946, -412.28702960080204, -243.26793782327275, -15.381078525648396, -94.80352187552364, -328.6723367682534, -149.16957262032946, -129.64561389539955, -1101.3236290378802, -285.15314707179436, -1099.8952841117214, -94.75484978108855, -138.77460597558695, -20.14858159928843, -167.73618758889717, -75.57373852367951, -379.40730885609963, -57.26648154975809, -115.9895901663715, -248.99505893209326, -67.27380083748082, -229.62075531019218, -583.8053816750133, -84.75261395933151, -103.42762070341907, -103.31750524037388, -112.58142425099882, -425.8963429872624, -401.15748015032864, -754.6481910238498, -527.3582198265918, -415.21256483872634, -30.19763586580865, -455.68780007620654, -339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849, -88.75634241560707, -169.36804609912232, 3.4881276282285842, -141.65169349327138, -6.3769558996444395, -186.9812690267597, -158.00380986629628, -144.00308146237828, -118.94428610150779, -413.744444495126, -29.54429725579329, -158.79455697140827, -49.181568288282605, -519.4283493863527, -330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516764467194721, "mean_inference_ms": 1.6982142715192357, "mean_action_processing_ms": 0.2721446190371443, "mean_env_wait_ms": 3.3020520633711743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155294418334961, "StateBufferConnector_ms": 0.007750272750854492, "ViewRequirementAgentConnector_ms": 0.19263100624084473}, "num_episodes": 34, "episode_return_max": 3.4881276282285842, "episode_return_min": -1392.5695626588342, "episode_return_mean": -310.0365049474805, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.21691380662844, "num_env_steps_trained_throughput_per_sec": 325.21691380662844, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 11044.792, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11044.719, "sample_time_ms": 1138.409, "learn_time_ms": 9840.967, "learn_throughput": 406.464, "synch_weights_time_ms": 64.495}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "89531_00000", "date": "2024-08-05_11-21-22", "timestamp": 1722837082, "time_this_iter_s": 12.310561656951904, "time_total_s": 499.8022346496582, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.8022346496582, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.63888888888889, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.56398002902667, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0676210027808943, "policy_loss": -0.008999633363176447, "vf_loss": 1.0675628904563685, "vf_explained_var": 0.99680920590957, "kl": 0.013515037177421647, "entropy": 0.6490347583467762, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": 3.4881276282285842, "episode_reward_min": -1392.5695626588342, "episode_reward_mean": -313.23550216789204, "episode_len_mean": 103.73, "episode_media": {}, "episodes_timesteps_total": 10373, "policy_reward_min": {"policy_0": -1392.5695626588342}, "policy_reward_max": {"policy_0": 3.4881276282285842}, "policy_reward_mean": {"policy_0": -313.23550216789204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849, -88.75634241560707, -169.36804609912232, 3.4881276282285842, -141.65169349327138, -6.3769558996444395, -186.9812690267597, -158.00380986629628, -144.00308146237828, -118.94428610150779, -413.744444495126, -29.54429725579329, -158.79455697140827, -49.181568288282605, -519.4283493863527, -330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648, -479.50253180814883, -120.65632833787491, -978.4440660837752, -221.38293055529462, -323.5918538964293, -121.99399608980899, -130.6338425887015, -638.2767489403503, -141.42187900789864, -408.8064146802613, -325.71425964022944, -24.629067439335497, -97.47141777133128, -1200.2507772147449, -473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869], "episode_lengths": [105, 69, 103, 90, 49, 106, 47, 60, 150, 56, 63, 150, 150, 78, 150, 150, 150, 55, 43, 105, 74, 54, 150, 150, 126, 70, 81, 33, 82, 36, 102, 83, 73, 85, 150, 46, 85, 63, 150, 134, 150, 79, 150, 84, 85, 139, 89, 150, 150, 70, 98, 147, 150, 127, 76, 125, 106, 132, 102, 150, 72, 150, 109, 110, 73, 76, 150, 76, 150, 140, 46, 57, 150, 132, 150, 150, 145, 86, 59, 150, 130, 118, 150, 150, 89, 82, 150, 46, 71, 82, 144, 65, 120, 109, 66, 92, 57, 40, 116, 150], "policy_policy_0_reward": [-339.15717662979887, -117.75276426629235, -221.90146657559978, -249.971635356329, -48.56336414665924, -264.26479051504975, -41.95038220114292, -151.92371851945015, -499.05854311227233, -48.19575409608929, -82.90853327380741, -1191.3684250178035, -1392.5695626588342, -130.307400877565, -207.80215818899475, -317.19269155774384, -1093.7134596246801, -57.88997350564582, -19.773805092800018, -282.3940067776253, -108.50002676569872, -77.73098108910634, -416.29018549228397, -443.06019585862003, -284.8303424300849, -88.75634241560707, -169.36804609912232, 3.4881276282285842, -141.65169349327138, -6.3769558996444395, -186.9812690267597, -158.00380986629628, -144.00308146237828, -118.94428610150779, -413.744444495126, -29.54429725579329, -158.79455697140827, -49.181568288282605, -519.4283493863527, -330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648, -479.50253180814883, -120.65632833787491, -978.4440660837752, -221.38293055529462, -323.5918538964293, -121.99399608980899, -130.6338425887015, -638.2767489403503, -141.42187900789864, -408.8064146802613, -325.71425964022944, -24.629067439335497, -97.47141777133128, -1200.2507772147449, -473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517754787552838, "mean_inference_ms": 1.6972237019838254, "mean_action_processing_ms": 0.27199586813362786, "mean_env_wait_ms": 3.3009434795649133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01205897331237793, "StateBufferConnector_ms": 0.007954120635986328, "ViewRequirementAgentConnector_ms": 0.1945629119873047}, "num_episodes": 41, "episode_return_max": 3.4881276282285842, "episode_return_min": -1392.5695626588342, "episode_return_mean": -313.23550216789204, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.3352652889136, "num_env_steps_trained_throughput_per_sec": 335.3352652889136, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 11348.851, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11348.776, "sample_time_ms": 1136.635, "learn_time_ms": 10148.232, "learn_throughput": 394.157, "synch_weights_time_ms": 63.062}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "89531_00000", "date": "2024-08-05_11-21-34", "timestamp": 1722837094, "time_this_iter_s": 11.94007396697998, "time_total_s": 511.7423086166382, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447170a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.7423086166382, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.799999999999997, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88.68867365121841, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1353681855020112, "policy_loss": -0.008286788904418549, "vf_loss": 1.1362047263731558, "vf_explained_var": 0.9898192096501589, "kl": 0.011168791532206077, "entropy": 0.8869091612597306, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -20.47856790594984, "episode_reward_min": -1301.5774638450255, "episode_reward_mean": -341.0219927336703, "episode_len_mean": 107.97, "episode_media": {}, "episodes_timesteps_total": 10797, "policy_reward_min": {"policy_0": -1301.5774638450255}, "policy_reward_max": {"policy_0": -20.47856790594984}, "policy_reward_mean": {"policy_0": -341.0219927336703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648, -479.50253180814883, -120.65632833787491, -978.4440660837752, -221.38293055529462, -323.5918538964293, -121.99399608980899, -130.6338425887015, -638.2767489403503, -141.42187900789864, -408.8064146802613, -325.71425964022944, -24.629067439335497, -97.47141777133128, -1200.2507772147449, -473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869, -510.80576852016407, -1301.5774638450255, -264.22169348254164, -189.45412186391604, -177.64684030486094, -20.47856790594984, -62.39058250271157, -383.82191167842427, -105.46254684219086, -393.1156335830351, -240.78039902641277, -52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342], "episode_lengths": [134, 150, 79, 150, 84, 85, 139, 89, 150, 150, 70, 98, 147, 150, 127, 76, 125, 106, 132, 102, 150, 72, 150, 109, 110, 73, 76, 150, 76, 150, 140, 46, 57, 150, 132, 150, 150, 145, 86, 59, 150, 130, 118, 150, 150, 89, 82, 150, 46, 71, 82, 144, 65, 120, 109, 66, 92, 57, 40, 116, 150, 150, 150, 99, 82, 81, 43, 57, 150, 85, 150, 91, 57, 73, 150, 150, 150, 79, 115, 80, 83, 51, 79, 150, 53, 150, 127, 96, 68, 82, 144, 136, 80, 59, 94, 150, 136, 89, 77, 150], "policy_policy_0_reward": [-330.2722383466474, -493.2685144508961, -170.61269716007442, -827.5244947206111, -138.5863237069795, -152.04486791067475, -332.6294906615256, -152.26313306029132, -1051.1005817142657, -967.6159938801492, -99.43593158220817, -221.38000760126351, -437.98652841255984, -310.21903672700176, -327.60293830427673, -127.32765548747176, -323.25093410357965, -321.5753534602305, -366.118125561819, -227.06221125796648, -479.50253180814883, -120.65632833787491, -978.4440660837752, -221.38293055529462, -323.5918538964293, -121.99399608980899, -130.6338425887015, -638.2767489403503, -141.42187900789864, -408.8064146802613, -325.71425964022944, -24.629067439335497, -97.47141777133128, -1200.2507772147449, -473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869, -510.80576852016407, -1301.5774638450255, -264.22169348254164, -189.45412186391604, -177.64684030486094, -20.47856790594984, -62.39058250271157, -383.82191167842427, -105.46254684219086, -393.1156335830351, -240.78039902641277, -52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518527869097491, "mean_inference_ms": 1.6962356732793415, "mean_action_processing_ms": 0.2721176981674888, "mean_env_wait_ms": 3.299344654337154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293338775634766, "StateBufferConnector_ms": 0.007892608642578125, "ViewRequirementAgentConnector_ms": 0.18981289863586426}, "num_episodes": 39, "episode_return_max": -20.47856790594984, "episode_return_min": -1301.5774638450255, "episode_return_mean": -341.0219927336703, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.46572113751995, "num_env_steps_trained_throughput_per_sec": 390.46572113751995, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 11191.551, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11191.475, "sample_time_ms": 1129.13, "learn_time_ms": 9998.478, "learn_throughput": 400.061, "synch_weights_time_ms": 63.022}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "89531_00000", "date": "2024-08-05_11-21-44", "timestamp": 1722837104, "time_this_iter_s": 10.256788492202759, "time_total_s": 521.9990971088409, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.9990971088409, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.907142857142855, "ram_util_percent": 29.15000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94.4374293555816, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.026713283918798, "policy_loss": -0.007403134359628893, "vf_loss": 1.0251074458782872, "vf_explained_var": 0.9948546650509039, "kl": 0.013470375851420613, "entropy": 0.8353252977753679, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -8.999354063706601, "episode_reward_min": -1301.5774638450255, "episode_reward_mean": -325.185663833086, "episode_len_mean": 105.56, "episode_media": {}, "episodes_timesteps_total": 10556, "policy_reward_min": {"policy_0": -1301.5774638450255}, "policy_reward_max": {"policy_0": -8.999354063706601}, "policy_reward_mean": {"policy_0": -325.185663833086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869, -510.80576852016407, -1301.5774638450255, -264.22169348254164, -189.45412186391604, -177.64684030486094, -20.47856790594984, -62.39058250271157, -383.82191167842427, -105.46254684219086, -393.1156335830351, -240.78039902641277, -52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342, -369.6290391839915, -194.9102624030225, -252.36693479952206, -8.999354063706601, -255.68426117621715, -234.65569770263951, -32.212835302591216, -344.6164539047051, -57.61984325773026, -17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023], "episode_lengths": [132, 150, 150, 145, 86, 59, 150, 130, 118, 150, 150, 89, 82, 150, 46, 71, 82, 144, 65, 120, 109, 66, 92, 57, 40, 116, 150, 150, 150, 99, 82, 81, 43, 57, 150, 85, 150, 91, 57, 73, 150, 150, 150, 79, 115, 80, 83, 51, 79, 150, 53, 150, 127, 96, 68, 82, 144, 136, 80, 59, 94, 150, 136, 89, 77, 150, 141, 83, 98, 34, 102, 97, 46, 128, 66, 45, 74, 150, 118, 110, 72, 150, 150, 150, 102, 143, 74, 68, 150, 150, 134, 100, 112, 39, 81, 140, 150, 100, 104, 150], "policy_policy_0_reward": [-473.3575436229126, -741.2366886213917, -913.6342127973242, -379.4579318487741, -199.63148359438276, -50.33199093114694, -443.4599697746853, -281.9564311893224, -217.79523532393287, -514.4936799455253, -452.2016018937593, -179.68757831257912, -138.18518497143629, -721.5944681860202, -31.86094147695629, -102.79621242845994, -118.69970364396016, -364.68445674631323, -64.16128091580936, -277.4281240327085, -325.59349809759885, -111.60685594731834, -211.49195527319938, -59.516047568113784, -28.755111185180663, -401.34032992523026, -657.5766096071869, -510.80576852016407, -1301.5774638450255, -264.22169348254164, -189.45412186391604, -177.64684030486094, -20.47856790594984, -62.39058250271157, -383.82191167842427, -105.46254684219086, -393.1156335830351, -240.78039902641277, -52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342, -369.6290391839915, -194.9102624030225, -252.36693479952206, -8.999354063706601, -255.68426117621715, -234.65569770263951, -32.212835302591216, -344.6164539047051, -57.61984325773026, -17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520093653855593, "mean_inference_ms": 1.6952567485189471, "mean_action_processing_ms": 0.27211270510844243, "mean_env_wait_ms": 3.2990715812975875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012068748474121094, "StateBufferConnector_ms": 0.00792694091796875, "ViewRequirementAgentConnector_ms": 0.1918330192565918}, "num_episodes": 34, "episode_return_max": -8.999354063706601, "episode_return_min": -1301.5774638450255, "episode_return_mean": -325.185663833086, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.49066688787144, "num_env_steps_trained_throughput_per_sec": 347.49066688787144, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 11132.531, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11132.454, "sample_time_ms": 1133.755, "learn_time_ms": 9933.015, "learn_throughput": 402.697, "synch_weights_time_ms": 64.839}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "89531_00000", "date": "2024-08-05_11-21-55", "timestamp": 1722837115, "time_this_iter_s": 11.522717237472534, "time_total_s": 533.5218143463135, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643b9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.5218143463135, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.458823529411767, "ram_util_percent": 29.164705882352937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.90781813661258, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8139155650511384, "policy_loss": -0.013023277785396203, "vf_loss": 0.8161870796854297, "vf_explained_var": 0.997698519192636, "kl": 0.0160185447284069, "entropy": 0.6075468464444082, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -8.999354063706601, "episode_reward_min": -1271.0962434680098, "episode_reward_mean": -345.880583349233, "episode_len_mean": 105.43, "episode_media": {}, "episodes_timesteps_total": 10543, "policy_reward_min": {"policy_0": -1271.0962434680098}, "policy_reward_max": {"policy_0": -8.999354063706601}, "policy_reward_mean": {"policy_0": -345.880583349233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342, -369.6290391839915, -194.9102624030225, -252.36693479952206, -8.999354063706601, -255.68426117621715, -234.65569770263951, -32.212835302591216, -344.6164539047051, -57.61984325773026, -17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023, -712.3125410660585, -116.88768076153826, -367.3402091164223, -144.22858683172063, -136.70915529192695, -130.59790514130623, -1155.3130332098638, -790.6742381614763, -57.59383238080026, -715.0410857233347, -67.97939768203125, -596.8042284777578, -68.85325738106803, -381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242], "episode_lengths": [57, 73, 150, 150, 150, 79, 115, 80, 83, 51, 79, 150, 53, 150, 127, 96, 68, 82, 144, 136, 80, 59, 94, 150, 136, 89, 77, 150, 141, 83, 98, 34, 102, 97, 46, 128, 66, 45, 74, 150, 118, 110, 72, 150, 150, 150, 102, 143, 74, 68, 150, 150, 134, 100, 112, 39, 81, 140, 150, 100, 104, 150, 143, 72, 150, 80, 78, 77, 150, 150, 57, 150, 66, 150, 59, 150, 57, 150, 150, 133, 43, 43, 85, 150, 150, 150, 150, 65, 150, 72, 150, 94, 69, 41, 65, 150, 150, 65, 78, 82], "policy_policy_0_reward": [-52.92954765187107, -121.44330155827468, -680.306592657057, -801.8670173825994, -424.4355017535417, -176.67971301805295, -315.224691134565, -132.6192804499313, -176.5563974459685, -34.799423119650015, -184.97534341816925, -951.453740648963, -44.33170033751165, -1220.9739091877693, -301.7019474828107, -200.53586309200023, -75.46508804284056, -188.54161128894813, -425.37698002626894, -817.7214004346064, -136.61779257832947, -32.48262564874848, -255.21385621174292, -324.11982525287976, -241.90174528524224, -130.89673529075165, -131.17829862356723, -818.9055147632342, -369.6290391839915, -194.9102624030225, -252.36693479952206, -8.999354063706601, -255.68426117621715, -234.65569770263951, -32.212835302591216, -344.6164539047051, -57.61984325773026, -17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023, -712.3125410660585, -116.88768076153826, -367.3402091164223, -144.22858683172063, -136.70915529192695, -130.59790514130623, -1155.3130332098638, -790.6742381614763, -57.59383238080026, -715.0410857233347, -67.97939768203125, -596.8042284777578, -68.85325738106803, -381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517597535254255, "mean_inference_ms": 1.694851965458621, "mean_action_processing_ms": 0.2720470362569818, "mean_env_wait_ms": 3.300249330999163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012290000915527344, "StateBufferConnector_ms": 0.008049249649047852, "ViewRequirementAgentConnector_ms": 0.19068360328674316}, "num_episodes": 38, "episode_return_max": -8.999354063706601, "episode_return_min": -1271.0962434680098, "episode_return_mean": -345.880583349233, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.5525334223798, "num_env_steps_trained_throughput_per_sec": 315.5525334223798, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 11122.131, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11122.058, "sample_time_ms": 1143.81, "learn_time_ms": 9912.188, "learn_throughput": 403.544, "synch_weights_time_ms": 65.222}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "89531_00000", "date": "2024-08-05_11-22-08", "timestamp": 1722837128, "time_this_iter_s": 12.689039945602417, "time_total_s": 546.2108542919159, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644716290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.2108542919159, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.29444444444444, "ram_util_percent": 29.194444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.89546933074793, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8370435387827456, "policy_loss": -0.016187576309312134, "vf_loss": 0.8436549438163639, "vf_explained_var": 0.9983852760866284, "kl": 0.014306021196686482, "entropy": 0.8039404336363077, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -10.872375295006899, "episode_reward_min": -1324.5055539451562, "episode_reward_mean": -371.2314069217201, "episode_len_mean": 107.89, "episode_media": {}, "episodes_timesteps_total": 10789, "policy_reward_min": {"policy_0": -1324.5055539451562}, "policy_reward_max": {"policy_0": -10.872375295006899}, "policy_reward_mean": {"policy_0": -371.2314069217201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023, -712.3125410660585, -116.88768076153826, -367.3402091164223, -144.22858683172063, -136.70915529192695, -130.59790514130623, -1155.3130332098638, -790.6742381614763, -57.59383238080026, -715.0410857233347, -67.97939768203125, -596.8042284777578, -68.85325738106803, -381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242, -178.722201203635, -108.20784430458386, -1010.4605971781498, -127.59408481278686, -1324.5055539451562, -374.0087669092766, -27.520080543548556, -503.58376303810473, -421.89996914258535, -148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722], "episode_lengths": [45, 74, 150, 118, 110, 72, 150, 150, 150, 102, 143, 74, 68, 150, 150, 134, 100, 112, 39, 81, 140, 150, 100, 104, 150, 143, 72, 150, 80, 78, 77, 150, 150, 57, 150, 66, 150, 59, 150, 57, 150, 150, 133, 43, 43, 85, 150, 150, 150, 150, 65, 150, 72, 150, 94, 69, 41, 65, 150, 150, 65, 78, 82, 107, 64, 150, 70, 150, 116, 43, 150, 150, 75, 104, 52, 75, 114, 108, 92, 150, 103, 63, 119, 150, 78, 127, 150, 89, 80, 35, 40, 128, 150, 64, 130, 144, 150, 80, 149, 150], "policy_policy_0_reward": [-17.14430537731503, -84.34867922130243, -679.070308692031, -204.27954473906362, -197.01714719934634, -117.96097716329693, -710.1560448130576, -527.7843183930021, -1271.0962434680098, -169.08575098603913, -334.73402872950606, -145.5792493113729, -119.02190104275252, -558.760287720513, -774.8834503542537, -314.1931985195323, -211.89527211143715, -341.1746455818202, -10.872375295006899, -107.31893755026466, -315.11882163600825, -1170.9088612060932, -269.9702739222103, -177.50763810784534, -426.44333917103023, -712.3125410660585, -116.88768076153826, -367.3402091164223, -144.22858683172063, -136.70915529192695, -130.59790514130623, -1155.3130332098638, -790.6742381614763, -57.59383238080026, -715.0410857233347, -67.97939768203125, -596.8042284777578, -68.85325738106803, -381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242, -178.722201203635, -108.20784430458386, -1010.4605971781498, -127.59408481278686, -1324.5055539451562, -374.0087669092766, -27.520080543548556, -503.58376303810473, -421.89996914258535, -148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519045309830806, "mean_inference_ms": 1.6947135598346745, "mean_action_processing_ms": 0.27208621708295283, "mean_env_wait_ms": 3.3029425950204963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013890504837036133, "StateBufferConnector_ms": 0.008317232131958008, "ViewRequirementAgentConnector_ms": 0.1945807933807373}, "num_episodes": 37, "episode_return_max": -10.872375295006899, "episode_return_min": -1324.5055539451562, "episode_return_mean": -371.2314069217201, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3209641598747, "num_env_steps_trained_throughput_per_sec": 317.3209641598747, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 11498.565, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11498.491, "sample_time_ms": 1156.527, "learn_time_ms": 10276.327, "learn_throughput": 389.244, "synch_weights_time_ms": 64.8}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "89531_00000", "date": "2024-08-05_11-22-21", "timestamp": 1722837141, "time_this_iter_s": 12.61708950996399, "time_total_s": 558.8279438018799, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644716680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 558.8279438018799, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.47222222222222, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.88437202771505, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9202644981599103, "policy_loss": -0.010638710268540307, "vf_loss": 0.9220059133755664, "vf_explained_var": 0.997301826501886, "kl": 0.013287839171486421, "entropy": 0.7199907945469022, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -11.058284769756346, "episode_reward_min": -1324.5055539451562, "episode_reward_mean": -435.0095188498732, "episode_len_mean": 109.71, "episode_media": {}, "episodes_timesteps_total": 10971, "policy_reward_min": {"policy_0": -1324.5055539451562}, "policy_reward_max": {"policy_0": -11.058284769756346}, "policy_reward_mean": {"policy_0": -435.0095188498732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242, -178.722201203635, -108.20784430458386, -1010.4605971781498, -127.59408481278686, -1324.5055539451562, -374.0087669092766, -27.520080543548556, -503.58376303810473, -421.89996914258535, -148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722, -45.26297998721572, -322.40749951042005, -143.38542789077695, -200.29492947439752, -1066.4863708823061, -60.32402582719516, -1103.87104874341, -94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651], "episode_lengths": [150, 57, 150, 150, 133, 43, 43, 85, 150, 150, 150, 150, 65, 150, 72, 150, 94, 69, 41, 65, 150, 150, 65, 78, 82, 107, 64, 150, 70, 150, 116, 43, 150, 150, 75, 104, 52, 75, 114, 108, 92, 150, 103, 63, 119, 150, 78, 127, 150, 89, 80, 35, 40, 128, 150, 64, 130, 144, 150, 80, 149, 150, 52, 91, 69, 89, 150, 60, 150, 67, 150, 150, 150, 150, 150, 150, 129, 111, 72, 145, 150, 150, 89, 150, 76, 63, 150, 150, 150, 88, 150, 150, 71, 44, 101, 66, 150, 47, 150, 150], "policy_policy_0_reward": [-381.9663360345889, -61.21176818977427, -529.8506240296629, -726.0680590704252, -305.2054171880649, -14.899274916592875, -24.033751714753365, -143.75298845810036, -1258.2834588006217, -897.905477063618, -365.9615764072865, -579.377858020209, -95.27882199372888, -802.418046597798, -126.1732592233834, -680.3681627983156, -255.3915671627111, -131.20226797510196, -21.14318402099733, -99.89165821731035, -563.8844521238169, -559.0385582656975, -99.01286255655405, -223.74740707615675, -175.38061990058242, -178.722201203635, -108.20784430458386, -1010.4605971781498, -127.59408481278686, -1324.5055539451562, -374.0087669092766, -27.520080543548556, -503.58376303810473, -421.89996914258535, -148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722, -45.26297998721572, -322.40749951042005, -143.38542789077695, -200.29492947439752, -1066.4863708823061, -60.32402582719516, -1103.87104874341, -94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526079329793991, "mean_inference_ms": 1.6946353640941854, "mean_action_processing_ms": 0.27236835356614253, "mean_env_wait_ms": 3.3038215666973283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013980388641357422, "StateBufferConnector_ms": 0.008292675018310547, "ViewRequirementAgentConnector_ms": 0.1946699619293213}, "num_episodes": 38, "episode_return_max": -11.058284769756346, "episode_return_min": -1324.5055539451562, "episode_return_mean": -435.0095188498732, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.9498429546976, "num_env_steps_trained_throughput_per_sec": 325.9498429546976, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 11822.7, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11822.627, "sample_time_ms": 1155.207, "learn_time_ms": 10600.026, "learn_throughput": 377.358, "synch_weights_time_ms": 66.561}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "89531_00000", "date": "2024-08-05_11-22-33", "timestamp": 1722837153, "time_this_iter_s": 12.283812761306763, "time_total_s": 571.1117565631866, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 571.1117565631866, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.058823529411764, "ram_util_percent": 29.24705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.721892619133, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9830914866179228, "policy_loss": -0.013502046384868056, "vf_loss": 0.9892544385045767, "vf_explained_var": 0.9909422634790341, "kl": 0.010989503293361243, "entropy": 0.788211370476832, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -11.058284769756346, "episode_reward_min": -1169.7883698966448, "episode_reward_mean": -431.953909253805, "episode_len_mean": 112.45, "episode_media": {}, "episodes_timesteps_total": 11245, "policy_reward_min": {"policy_0": -1169.7883698966448}, "policy_reward_max": {"policy_0": -11.058284769756346}, "policy_reward_mean": {"policy_0": -431.953909253805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722, -45.26297998721572, -322.40749951042005, -143.38542789077695, -200.29492947439752, -1066.4863708823061, -60.32402582719516, -1103.87104874341, -94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651, -173.27415353627543, -362.52384164362314, -92.04570589316785, -280.9978988368874, -1065.4485203458328, -315.7796486568564, -217.09839333421448, -441.1083065573685, -55.0326603341295, -334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446], "episode_lengths": [75, 104, 52, 75, 114, 108, 92, 150, 103, 63, 119, 150, 78, 127, 150, 89, 80, 35, 40, 128, 150, 64, 130, 144, 150, 80, 149, 150, 52, 91, 69, 89, 150, 60, 150, 67, 150, 150, 150, 150, 150, 150, 129, 111, 72, 145, 150, 150, 89, 150, 76, 63, 150, 150, 150, 88, 150, 150, 71, 44, 101, 66, 150, 47, 150, 150, 142, 115, 57, 150, 150, 131, 87, 120, 67, 129, 135, 120, 150, 150, 87, 150, 84, 143, 150, 150, 86, 150, 150, 150, 63, 58, 92, 61, 108, 150, 118, 102, 54, 107], "policy_policy_0_reward": [-148.25031329856452, -320.4495714001316, -52.695365806626434, -144.99863458757227, -256.9819337562814, -379.25172965061245, -182.48196595316296, -1060.5411108864994, -188.56607770632976, -96.25490382767971, -255.31718224005027, -1010.7047147563476, -147.30082638085145, -314.506966411478, -982.9620271938347, -163.1480581889138, -135.02144873691313, -11.058284769756346, -20.530790253171272, -312.2964003301758, -325.3999133555693, -54.14276863582124, -293.2796267826396, -370.16613615661515, -925.8057894243958, -190.3570578024487, -473.98026290474866, -792.079760553722, -45.26297998721572, -322.40749951042005, -143.38542789077695, -200.29492947439752, -1066.4863708823061, -60.32402582719516, -1103.87104874341, -94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651, -173.27415353627543, -362.52384164362314, -92.04570589316785, -280.9978988368874, -1065.4485203458328, -315.7796486568564, -217.09839333421448, -441.1083065573685, -55.0326603341295, -334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527287509735339, "mean_inference_ms": 1.6952788962555951, "mean_action_processing_ms": 0.27254747174004756, "mean_env_wait_ms": 3.3045855743418144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013974189758300781, "StateBufferConnector_ms": 0.008123397827148438, "ViewRequirementAgentConnector_ms": 0.19520115852355957}, "num_episodes": 34, "episode_return_max": -11.058284769756346, "episode_return_min": -1169.7883698966448, "episode_return_mean": -431.953909253805, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.64209933174, "num_env_steps_trained_throughput_per_sec": 321.64209933174, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 11975.158, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11975.084, "sample_time_ms": 1140.516, "learn_time_ms": 10766.139, "learn_throughput": 371.535, "synch_weights_time_ms": 67.593}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "89531_00000", "date": "2024-08-05_11-22-46", "timestamp": 1722837166, "time_this_iter_s": 12.447520732879639, "time_total_s": 583.5592772960663, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 583.5592772960663, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.06111111111111, "ram_util_percent": 29.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.44734139740467, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0078773605947693, "policy_loss": -0.004724234273210944, "vf_loss": 1.0052399003878236, "vf_explained_var": 0.9931657814731201, "kl": 0.011007567185424704, "entropy": 0.6841392875183374, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -9.765713215443204, "episode_reward_min": -1169.7883698966448, "episode_reward_mean": -417.6573981045427, "episode_len_mean": 114.64, "episode_media": {}, "episodes_timesteps_total": 11464, "policy_reward_min": {"policy_0": -1169.7883698966448}, "policy_reward_max": {"policy_0": -9.765713215443204}, "policy_reward_mean": {"policy_0": -417.6573981045427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651, -173.27415353627543, -362.52384164362314, -92.04570589316785, -280.9978988368874, -1065.4485203458328, -315.7796486568564, -217.09839333421448, -441.1083065573685, -55.0326603341295, -334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446, -481.4229005372719, -239.88438229392406, -1003.2865655518552, -202.86486930495326, -80.5011785726056, -280.9600873637253, -62.03443771770174, -143.05823083754066, -95.88582454159247, -394.68405106834456, -295.82286612133356, -180.8654569344341, -353.8399114413184, -406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222], "episode_lengths": [67, 150, 150, 150, 150, 150, 150, 129, 111, 72, 145, 150, 150, 89, 150, 76, 63, 150, 150, 150, 88, 150, 150, 71, 44, 101, 66, 150, 47, 150, 150, 142, 115, 57, 150, 150, 131, 87, 120, 67, 129, 135, 120, 150, 150, 87, 150, 84, 143, 150, 150, 86, 150, 150, 150, 63, 58, 92, 61, 108, 150, 118, 102, 54, 107, 124, 90, 150, 109, 63, 121, 54, 74, 63, 150, 117, 100, 150, 150, 67, 50, 106, 140, 150, 63, 140, 102, 41, 89, 150, 135, 76, 110, 137, 150, 144, 144, 113, 108, 99], "policy_policy_0_reward": [-94.85447896976969, -401.2112954029106, -736.3895887728438, -489.51194438776895, -1057.705477241642, -1135.0863282540606, -347.11050003992096, -309.0261518257286, -362.34489612964626, -125.26648364601556, -380.8354630253992, -1019.917457945215, -849.5294354280014, -184.92498272462214, -974.7242935845009, -158.85854065693263, -94.23479696151406, -842.0302717358737, -1123.2451052925085, -973.2080229453268, -231.27387223111165, -1139.2243730320201, -817.3651145518222, -120.76661593145649, -14.122685458470272, -288.6910239238239, -116.46623704909847, -1143.4299396474419, -95.27363615722592, -1110.0035780552685, -1015.8070710290651, -173.27415353627543, -362.52384164362314, -92.04570589316785, -280.9978988368874, -1065.4485203458328, -315.7796486568564, -217.09839333421448, -441.1083065573685, -55.0326603341295, -334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446, -481.4229005372719, -239.88438229392406, -1003.2865655518552, -202.86486930495326, -80.5011785726056, -280.9600873637253, -62.03443771770174, -143.05823083754066, -95.88582454159247, -394.68405106834456, -295.82286612133356, -180.8654569344341, -353.8399114413184, -406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526998637841516, "mean_inference_ms": 1.6949956644182378, "mean_action_processing_ms": 0.27259503683323716, "mean_env_wait_ms": 3.304414932599236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012379646301269531, "StateBufferConnector_ms": 0.007850170135498047, "ViewRequirementAgentConnector_ms": 0.19556212425231934}, "num_episodes": 35, "episode_return_max": -9.765713215443204, "episode_return_min": -1169.7883698966448, "episode_return_mean": -417.6573981045427, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.4144922339004, "num_env_steps_trained_throughput_per_sec": 355.4144922339004, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 11957.276, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11957.201, "sample_time_ms": 1121.455, "learn_time_ms": 10767.581, "learn_throughput": 371.485, "synch_weights_time_ms": 67.345}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "89531_00000", "date": "2024-08-05_11-22-57", "timestamp": 1722837177, "time_this_iter_s": 11.264400005340576, "time_total_s": 594.8236773014069, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.8236773014069, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 20.125, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.19585749606291, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0148048242398848, "policy_loss": -0.013566081462583195, "vf_loss": 1.0176839327439666, "vf_explained_var": 0.9974292447790504, "kl": 0.015925999804403547, "entropy": 0.6307688535191118, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -9.765713215443204, "episode_reward_min": -1437.108906733882, "episode_reward_mean": -342.41811883589935, "episode_len_mean": 109.3, "episode_media": {}, "episodes_timesteps_total": 10930, "policy_reward_min": {"policy_0": -1437.108906733882}, "policy_reward_max": {"policy_0": -9.765713215443204}, "policy_reward_mean": {"policy_0": -342.41811883589935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446, -481.4229005372719, -239.88438229392406, -1003.2865655518552, -202.86486930495326, -80.5011785726056, -280.9600873637253, -62.03443771770174, -143.05823083754066, -95.88582454159247, -394.68405106834456, -295.82286612133356, -180.8654569344341, -353.8399114413184, -406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222, -194.1136973934157, -324.90485651578825, -663.6980631021285, -424.59625485896214, -31.770293316516216, -161.64686334576623, -162.47376273625898, -37.082438822500215, -203.17013330255259, -203.90977206195325, -384.4896397922332, -23.447553346050338, -1082.5285396155627, -141.55276027017285, -95.73567820841897, -49.45105721431808, -376.91652107786877, -272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265], "episode_lengths": [129, 135, 120, 150, 150, 87, 150, 84, 143, 150, 150, 86, 150, 150, 150, 63, 58, 92, 61, 108, 150, 118, 102, 54, 107, 124, 90, 150, 109, 63, 121, 54, 74, 63, 150, 117, 100, 150, 150, 67, 50, 106, 140, 150, 63, 140, 102, 41, 89, 150, 135, 76, 110, 137, 150, 144, 144, 113, 108, 99, 106, 150, 150, 150, 47, 84, 106, 47, 103, 112, 143, 47, 150, 73, 74, 56, 121, 114, 150, 74, 150, 150, 126, 85, 69, 80, 150, 78, 67, 53, 119, 85, 92, 121, 102, 122, 126, 150, 72, 150], "policy_policy_0_reward": [-334.7636503416481, -313.038556831627, -280.27765794734154, -446.49805016064363, -383.25509689468464, -164.09420564017503, -1169.7883698966448, -190.15417775883944, -567.9780502137423, -345.37817528170007, -1030.1559581625445, -156.16643623581012, -473.5776310781437, -408.681837458199, -1143.2613684021499, -112.8494627195448, -170.31347741116022, -194.5844337331858, -52.40418949161625, -267.9578649741093, -544.6455703920658, -419.2472066473915, -444.4440410830398, -73.42342841858544, -202.14133296390446, -481.4229005372719, -239.88438229392406, -1003.2865655518552, -202.86486930495326, -80.5011785726056, -280.9600873637253, -62.03443771770174, -143.05823083754066, -95.88582454159247, -394.68405106834456, -295.82286612133356, -180.8654569344341, -353.8399114413184, -406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222, -194.1136973934157, -324.90485651578825, -663.6980631021285, -424.59625485896214, -31.770293316516216, -161.64686334576623, -162.47376273625898, -37.082438822500215, -203.17013330255259, -203.90977206195325, -384.4896397922332, -23.447553346050338, -1082.5285396155627, -141.55276027017285, -95.73567820841897, -49.45105721431808, -376.91652107786877, -272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525215127153319, "mean_inference_ms": 1.6942068621654736, "mean_action_processing_ms": 0.2725950420538643, "mean_env_wait_ms": 3.30720389365334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017446041107177734, "StateBufferConnector_ms": 0.00804591178894043, "ViewRequirementAgentConnector_ms": 0.19730353355407715}, "num_episodes": 40, "episode_return_max": -9.765713215443204, "episode_return_min": -1437.108906733882, "episode_return_mean": -342.41811883589935, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.965250862806, "num_env_steps_trained_throughput_per_sec": 335.965250862806, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 11913.345, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11913.271, "sample_time_ms": 1124.926, "learn_time_ms": 10721.845, "learn_throughput": 373.07, "synch_weights_time_ms": 65.681}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "89531_00000", "date": "2024-08-05_11-23-09", "timestamp": 1722837189, "time_this_iter_s": 11.916496753692627, "time_total_s": 606.7401740550995, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447176d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 606.7401740550995, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.78235294117647, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.38329148789246, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0196502411893258, "policy_loss": -0.009417790754620606, "vf_loss": 1.0216554893180727, "vf_explained_var": 0.9878248342002431, "kl": 0.011064955908610348, "entropy": 0.5630282496102155, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -8.778385980071914, "episode_reward_min": -1437.108906733882, "episode_reward_mean": -323.5527618770903, "episode_len_mean": 105.71, "episode_media": {}, "episodes_timesteps_total": 10571, "policy_reward_min": {"policy_0": -1437.108906733882}, "policy_reward_max": {"policy_0": -8.778385980071914}, "policy_reward_mean": {"policy_0": -323.5527618770903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222, -194.1136973934157, -324.90485651578825, -663.6980631021285, -424.59625485896214, -31.770293316516216, -161.64686334576623, -162.47376273625898, -37.082438822500215, -203.17013330255259, -203.90977206195325, -384.4896397922332, -23.447553346050338, -1082.5285396155627, -141.55276027017285, -95.73567820841897, -49.45105721431808, -376.91652107786877, -272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265, -349.4646826062467, -377.2095574227193, -926.1504058393974, -141.9981020273499, -84.41047025811761, -276.05987558709893, -66.8538264426485, -332.6902542072544, -245.69845127591492, -219.29498342708501, -165.52240239823553, -625.3772771547235, -330.8813084809072, -228.95181342195752, -308.9654596670491, -161.66450942520504, -178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956], "episode_lengths": [150, 67, 50, 106, 140, 150, 63, 140, 102, 41, 89, 150, 135, 76, 110, 137, 150, 144, 144, 113, 108, 99, 106, 150, 150, 150, 47, 84, 106, 47, 103, 112, 143, 47, 150, 73, 74, 56, 121, 114, 150, 74, 150, 150, 126, 85, 69, 80, 150, 78, 67, 53, 119, 85, 92, 121, 102, 122, 126, 150, 72, 150, 135, 120, 150, 79, 64, 114, 68, 102, 120, 107, 102, 128, 83, 85, 140, 81, 96, 150, 52, 49, 61, 52, 72, 150, 96, 107, 150, 150, 104, 150, 150, 75, 146, 38, 110, 88, 87, 92], "policy_policy_0_reward": [-406.72234767638247, -76.19843781470406, -23.422837482027386, -259.1613479115154, -346.18988134558685, -390.2340307057954, -45.19992842747817, -396.7141540286678, -169.33670742196978, -9.765713215443204, -191.43383849014302, -613.351350251032, -357.53713933965537, -130.22838725458053, -253.9180220093779, -738.6689723668879, -1131.5184277009464, -346.16268096007354, -367.6991729292149, -230.411577977194, -357.52609492631785, -464.3989766188222, -194.1136973934157, -324.90485651578825, -663.6980631021285, -424.59625485896214, -31.770293316516216, -161.64686334576623, -162.47376273625898, -37.082438822500215, -203.17013330255259, -203.90977206195325, -384.4896397922332, -23.447553346050338, -1082.5285396155627, -141.55276027017285, -95.73567820841897, -49.45105721431808, -376.91652107786877, -272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265, -349.4646826062467, -377.2095574227193, -926.1504058393974, -141.9981020273499, -84.41047025811761, -276.05987558709893, -66.8538264426485, -332.6902542072544, -245.69845127591492, -219.29498342708501, -165.52240239823553, -625.3772771547235, -330.8813084809072, -228.95181342195752, -308.9654596670491, -161.66450942520504, -178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530211662936035, "mean_inference_ms": 1.6943537461719405, "mean_action_processing_ms": 0.2727248459723203, "mean_env_wait_ms": 3.3078483108771826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017209291458129883, "StateBufferConnector_ms": 0.00800943374633789, "ViewRequirementAgentConnector_ms": 0.19694852828979492}, "num_episodes": 38, "episode_return_max": -8.778385980071914, "episode_return_min": -1437.108906733882, "episode_return_mean": -323.5527618770903, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.33955776067097, "num_env_steps_trained_throughput_per_sec": 368.33955776067097, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 11769.351, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11769.276, "sample_time_ms": 1129.75, "learn_time_ms": 10572.068, "learn_throughput": 378.355, "synch_weights_time_ms": 66.616}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "89531_00000", "date": "2024-08-05_11-23-20", "timestamp": 1722837200, "time_this_iter_s": 10.872203826904297, "time_total_s": 617.6123778820038, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 617.6123778820038, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.7125, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.80334020058314, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9162139619700611, "policy_loss": -0.015100783164477131, "vf_loss": 0.9216657166990141, "vf_explained_var": 0.9967837792510787, "kl": 0.014396844451797126, "entropy": 0.6884424832339088, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": 3.7957516105716733, "episode_reward_min": -1437.108906733882, "episode_reward_mean": -312.94995916122264, "episode_len_mean": 102.68, "episode_media": {}, "episodes_timesteps_total": 10268, "policy_reward_min": {"policy_0": -1437.108906733882}, "policy_reward_max": {"policy_0": 3.7957516105716733}, "policy_reward_mean": {"policy_0": -312.94995916122264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265, -349.4646826062467, -377.2095574227193, -926.1504058393974, -141.9981020273499, -84.41047025811761, -276.05987558709893, -66.8538264426485, -332.6902542072544, -245.69845127591492, -219.29498342708501, -165.52240239823553, -625.3772771547235, -330.8813084809072, -228.95181342195752, -308.9654596670491, -161.66450942520504, -178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956, -407.1359025862912, -456.26505405732706, -15.03226096144854, -60.242423688053904, -299.18678899635705, -165.45960920123218, -266.8283096879676, -831.7078924072274, -110.48192775733823, -113.44296323440743, -178.96027490071157, 3.7957516105716733, -386.7275655325631, -20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551], "episode_lengths": [114, 150, 74, 150, 150, 126, 85, 69, 80, 150, 78, 67, 53, 119, 85, 92, 121, 102, 122, 126, 150, 72, 150, 135, 120, 150, 79, 64, 114, 68, 102, 120, 107, 102, 128, 83, 85, 140, 81, 96, 150, 52, 49, 61, 52, 72, 150, 96, 107, 150, 150, 104, 150, 150, 75, 146, 38, 110, 88, 87, 92, 150, 150, 42, 66, 118, 90, 117, 150, 73, 76, 87, 31, 150, 44, 75, 150, 90, 55, 118, 52, 150, 98, 76, 150, 101, 99, 142, 59, 91, 79, 66, 146, 150, 82, 92, 150, 150, 56, 59], "policy_policy_0_reward": [-272.3777120348652, -715.3855739168193, -111.96167259632576, -1308.0166841554974, -1437.108906733882, -329.2938705572437, -202.52687658250395, -121.77857619268116, -118.566435743622, -1137.4421017007835, -159.58500565930967, -92.58441255425964, -38.34557151300923, -464.29991047945083, -122.22504045313366, -134.86098173616233, -230.88648256577085, -218.1041829235486, -269.12504139435487, -281.2218446034717, -493.99654432903634, -105.14680135277617, -305.49274955204265, -349.4646826062467, -377.2095574227193, -926.1504058393974, -141.9981020273499, -84.41047025811761, -276.05987558709893, -66.8538264426485, -332.6902542072544, -245.69845127591492, -219.29498342708501, -165.52240239823553, -625.3772771547235, -330.8813084809072, -228.95181342195752, -308.9654596670491, -161.66450942520504, -178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956, -407.1359025862912, -456.26505405732706, -15.03226096144854, -60.242423688053904, -299.18678899635705, -165.45960920123218, -266.8283096879676, -831.7078924072274, -110.48192775733823, -113.44296323440743, -178.96027490071157, 3.7957516105716733, -386.7275655325631, -20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541287495687863, "mean_inference_ms": 1.694653500316696, "mean_action_processing_ms": 0.27268098688175785, "mean_env_wait_ms": 3.3073729758938866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011980533599853516, "StateBufferConnector_ms": 0.007935285568237305, "ViewRequirementAgentConnector_ms": 0.1972672939300537}, "num_episodes": 39, "episode_return_max": 3.7957516105716733, "episode_return_min": -1437.108906733882, "episode_return_mean": -312.94995916122264, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.93187788888287, "num_env_steps_trained_throughput_per_sec": 335.93187788888287, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 11767.232, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11767.158, "sample_time_ms": 1144.706, "learn_time_ms": 10554.89, "learn_throughput": 378.971, "synch_weights_time_ms": 66.717}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "89531_00000", "date": "2024-08-05_11-23-32", "timestamp": 1722837212, "time_this_iter_s": 11.918707847595215, "time_total_s": 629.531085729599, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6643ba830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.531085729599, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.211764705882356, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.88425916830698, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9399285402304183, "policy_loss": -0.015684728814327777, "vf_loss": 0.9462728258998444, "vf_explained_var": 0.9967707744489114, "kl": 0.013945801181277338, "entropy": 0.729730358098944, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 3.7957516105716733, "episode_reward_min": -1281.8254716308472, "episode_reward_mean": -363.9623654761546, "episode_len_mean": 105.7, "episode_media": {}, "episodes_timesteps_total": 10570, "policy_reward_min": {"policy_0": -1281.8254716308472}, "policy_reward_max": {"policy_0": 3.7957516105716733}, "policy_reward_mean": {"policy_0": -363.9623654761546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956, -407.1359025862912, -456.26505405732706, -15.03226096144854, -60.242423688053904, -299.18678899635705, -165.45960920123218, -266.8283096879676, -831.7078924072274, -110.48192775733823, -113.44296323440743, -178.96027490071157, 3.7957516105716733, -386.7275655325631, -20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551, -668.7765422856604, -883.3141636845124, -795.5308038378641, -1184.6139363729496, -252.7778429592641, -61.82824993690675, -219.8962031600308, -235.67102835253283, -487.52174990163024, -99.39653495241015, -244.19269349210398, -153.3239522512195, -91.4638053487798, -63.392627444630364, -1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992], "episode_lengths": [96, 150, 52, 49, 61, 52, 72, 150, 96, 107, 150, 150, 104, 150, 150, 75, 146, 38, 110, 88, 87, 92, 150, 150, 42, 66, 118, 90, 117, 150, 73, 76, 87, 31, 150, 44, 75, 150, 90, 55, 118, 52, 150, 98, 76, 150, 101, 99, 142, 59, 91, 79, 66, 146, 150, 82, 92, 150, 150, 56, 59, 150, 150, 150, 150, 122, 63, 111, 91, 150, 49, 99, 94, 71, 60, 150, 95, 150, 150, 67, 150, 49, 135, 150, 150, 49, 150, 140, 150, 101, 150, 150, 55, 150, 42, 150, 150, 93, 104, 75], "policy_policy_0_reward": [-178.68479681042265, -971.6397767457182, -56.54368840490283, -57.609444392501196, -110.69276521119293, -39.27187321839905, -128.08884622587922, -963.8075152402673, -252.31919205914005, -233.77280736968697, -634.5830437002315, -961.2704727886093, -172.05932347862662, -288.47270385437827, -249.8277973333352, -303.4455664710578, -434.793020496415, -8.778385980071914, -253.19034225348753, -226.68470784693562, -215.3088217577117, -235.61702526330956, -407.1359025862912, -456.26505405732706, -15.03226096144854, -60.242423688053904, -299.18678899635705, -165.45960920123218, -266.8283096879676, -831.7078924072274, -110.48192775733823, -113.44296323440743, -178.96027490071157, 3.7957516105716733, -386.7275655325631, -20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551, -668.7765422856604, -883.3141636845124, -795.5308038378641, -1184.6139363729496, -252.7778429592641, -61.82824993690675, -219.8962031600308, -235.67102835253283, -487.52174990163024, -99.39653495241015, -244.19269349210398, -153.3239522512195, -91.4638053487798, -63.392627444630364, -1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542294298538192, "mean_inference_ms": 1.694719258468808, "mean_action_processing_ms": 0.2727259620580174, "mean_env_wait_ms": 3.3064764313218844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012076377868652344, "StateBufferConnector_ms": 0.008029937744140625, "ViewRequirementAgentConnector_ms": 0.20026898384094238}, "num_episodes": 39, "episode_return_max": 3.7957516105716733, "episode_return_min": -1281.8254716308472, "episode_return_mean": -363.9623654761546, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.38987388979393, "num_env_steps_trained_throughput_per_sec": 351.38987388979393, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 11881.152, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11881.078, "sample_time_ms": 1144.378, "learn_time_ms": 10668.577, "learn_throughput": 374.933, "synch_weights_time_ms": 67.276}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "89531_00000", "date": "2024-08-05_11-23-43", "timestamp": 1722837223, "time_this_iter_s": 11.396589279174805, "time_total_s": 640.9276750087738, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644788e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.9276750087738, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.59375, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.57299338579178, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9828912676312029, "policy_loss": -0.012627386923607748, "vf_loss": 0.9875563732658823, "vf_explained_var": 0.9967748040954272, "kl": 0.011898483869464372, "entropy": 0.6919566199493905, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -12.640533310449255, "episode_reward_min": -1333.6186692273634, "episode_reward_mean": -397.86874021707035, "episode_len_mean": 105.78, "episode_media": {}, "episodes_timesteps_total": 10578, "policy_reward_min": {"policy_0": -1333.6186692273634}, "policy_reward_max": {"policy_0": -12.640533310449255}, "policy_reward_mean": {"policy_0": -397.86874021707035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551, -668.7765422856604, -883.3141636845124, -795.5308038378641, -1184.6139363729496, -252.7778429592641, -61.82824993690675, -219.8962031600308, -235.67102835253283, -487.52174990163024, -99.39653495241015, -244.19269349210398, -153.3239522512195, -91.4638053487798, -63.392627444630364, -1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992, -1318.6482980942087, -201.7385977810427, -523.6946337531621, -192.20356412715387, -31.170135141848416, -32.309417361429276, -57.312706711361976, -192.78908402669856, -111.84112819927788, -338.5006268137718, -83.36600694480204, -571.4309055766968, -1333.6186692273634, -178.46947211061692, -319.52740532475224, -348.1212707778832, -660.284386656297, -1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424], "episode_lengths": [44, 75, 150, 90, 55, 118, 52, 150, 98, 76, 150, 101, 99, 142, 59, 91, 79, 66, 146, 150, 82, 92, 150, 150, 56, 59, 150, 150, 150, 150, 122, 63, 111, 91, 150, 49, 99, 94, 71, 60, 150, 95, 150, 150, 67, 150, 49, 135, 150, 150, 49, 150, 140, 150, 101, 150, 150, 55, 150, 42, 150, 150, 93, 104, 75, 150, 83, 105, 101, 50, 46, 37, 81, 79, 131, 71, 150, 150, 85, 149, 113, 150, 150, 150, 126, 66, 78, 150, 150, 62, 96, 84, 69, 93, 50, 102, 58, 98, 70, 150], "policy_policy_0_reward": [-20.645686771332468, -94.70279328187173, -766.4808163044877, -216.14303437266062, -44.3110802820026, -302.74871284341776, -42.53791365254945, -461.1448454410662, -295.76175501049045, -117.43656459549938, -640.7233528824922, -254.79743188134066, -148.27872974739773, -391.1754837517791, -70.93446912901156, -217.5501294786546, -152.038521231724, -101.00920904975634, -391.2273954115141, -507.35333816101536, -151.70084759540723, -346.3384020060684, -874.787971170163, -767.4406083230348, -70.16541032548734, -71.89791614693551, -668.7765422856604, -883.3141636845124, -795.5308038378641, -1184.6139363729496, -252.7778429592641, -61.82824993690675, -219.8962031600308, -235.67102835253283, -487.52174990163024, -99.39653495241015, -244.19269349210398, -153.3239522512195, -91.4638053487798, -63.392627444630364, -1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992, -1318.6482980942087, -201.7385977810427, -523.6946337531621, -192.20356412715387, -31.170135141848416, -32.309417361429276, -57.312706711361976, -192.78908402669856, -111.84112819927788, -338.5006268137718, -83.36600694480204, -571.4309055766968, -1333.6186692273634, -178.46947211061692, -319.52740532475224, -348.1212707778832, -660.284386656297, -1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541314122756793, "mean_inference_ms": 1.693985923827577, "mean_action_processing_ms": 0.27280964471863817, "mean_env_wait_ms": 3.30873945776332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012046098709106445, "StateBufferConnector_ms": 0.008046388626098633, "ViewRequirementAgentConnector_ms": 0.19649219512939453}, "num_episodes": 35, "episode_return_max": -12.640533310449255, "episode_return_min": -1333.6186692273634, "episode_return_mean": -397.86874021707035, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.60200621380267, "num_env_steps_trained_throughput_per_sec": 352.60200621380267, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 11864.465, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11864.391, "sample_time_ms": 1142.787, "learn_time_ms": 10656.334, "learn_throughput": 375.364, "synch_weights_time_ms": 64.431}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "89531_00000", "date": "2024-08-05_11-23-55", "timestamp": 1722837235, "time_this_iter_s": 11.358011484146118, "time_total_s": 652.2856864929199, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644789750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 652.2856864929199, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.63125, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.97083655297756, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9853090807795525, "policy_loss": -0.00869531920228231, "vf_loss": 0.9878204741204778, "vf_explained_var": 0.98929547611624, "kl": 0.009257558866435563, "entropy": 0.649241225173076, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -12.640533310449255, "episode_reward_min": -1333.6186692273634, "episode_reward_mean": -417.73185203945906, "episode_len_mean": 106.77, "episode_media": {}, "episodes_timesteps_total": 10677, "policy_reward_min": {"policy_0": -1333.6186692273634}, "policy_reward_max": {"policy_0": -12.640533310449255}, "policy_reward_mean": {"policy_0": -417.73185203945906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992, -1318.6482980942087, -201.7385977810427, -523.6946337531621, -192.20356412715387, -31.170135141848416, -32.309417361429276, -57.312706711361976, -192.78908402669856, -111.84112819927788, -338.5006268137718, -83.36600694480204, -571.4309055766968, -1333.6186692273634, -178.46947211061692, -319.52740532475224, -348.1212707778832, -660.284386656297, -1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424, -935.6609459582947, -194.60226955377246, -336.010848337315, -33.37248318795419, -364.14833014742084, -286.4566680238706, -1210.2598613709765, -111.23818279365177, -20.951998092987196, -397.9840716288819, -288.41524332080365, -851.257885998914, -315.9542563622781, -646.5822801897624, -163.67661463288286, -215.54240660030607, -191.51011661398897, -305.5205109591981, -515.8681738166127, -400.1655280267463, -165.38648146722136, -249.48625544917724, -311.65567156744845, -199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928], "episode_lengths": [150, 95, 150, 150, 67, 150, 49, 135, 150, 150, 49, 150, 140, 150, 101, 150, 150, 55, 150, 42, 150, 150, 93, 104, 75, 150, 83, 105, 101, 50, 46, 37, 81, 79, 131, 71, 150, 150, 85, 149, 113, 150, 150, 150, 126, 66, 78, 150, 150, 62, 96, 84, 69, 93, 50, 102, 58, 98, 70, 150, 150, 67, 111, 41, 150, 127, 150, 68, 42, 150, 114, 150, 104, 150, 90, 106, 91, 109, 129, 118, 80, 108, 101, 87, 63, 80, 106, 150, 96, 139, 110, 68, 150, 83, 103, 86, 150, 54, 94, 64], "policy_policy_0_reward": [-1143.957773413899, -253.1326983620656, -1281.8254716308472, -581.6407132389857, -86.59722412335873, -691.8884957872712, -56.51578096638933, -374.0338825463035, -336.3251292345697, -950.9327447951442, -22.49405287908036, -658.0906797483447, -372.2795835642199, -1066.7631331411742, -175.94935654741235, -997.1816966248381, -1204.4424944012271, -57.146012608664975, -311.1665092174803, -12.640533310449255, -1039.4374272128525, -891.5521477127506, -175.97329239253187, -170.66998282430407, -258.4300402009992, -1318.6482980942087, -201.7385977810427, -523.6946337531621, -192.20356412715387, -31.170135141848416, -32.309417361429276, -57.312706711361976, -192.78908402669856, -111.84112819927788, -338.5006268137718, -83.36600694480204, -571.4309055766968, -1333.6186692273634, -178.46947211061692, -319.52740532475224, -348.1212707778832, -660.284386656297, -1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424, -935.6609459582947, -194.60226955377246, -336.010848337315, -33.37248318795419, -364.14833014742084, -286.4566680238706, -1210.2598613709765, -111.23818279365177, -20.951998092987196, -397.9840716288819, -288.41524332080365, -851.257885998914, -315.9542563622781, -646.5822801897624, -163.67661463288286, -215.54240660030607, -191.51011661398897, -305.5205109591981, -515.8681738166127, -400.1655280267463, -165.38648146722136, -249.48625544917724, -311.65567156744845, -199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537777985704331, "mean_inference_ms": 1.692530784909881, "mean_action_processing_ms": 0.2727711410038576, "mean_env_wait_ms": 3.3086955939108917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012018918991088867, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.19353771209716797}, "num_episodes": 40, "episode_return_max": -12.640533310449255, "episode_return_min": -1333.6186692273634, "episode_return_mean": -417.73185203945906, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.77144724028165, "num_env_steps_trained_throughput_per_sec": 396.77144724028165, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 11604.984, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11604.91, "sample_time_ms": 1131.862, "learn_time_ms": 10407.265, "learn_throughput": 384.347, "synch_weights_time_ms": 64.903}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "89531_00000", "date": "2024-08-05_11-24-05", "timestamp": 1722837245, "time_this_iter_s": 10.09361481666565, "time_total_s": 662.3793013095856, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 662.3793013095856, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 20.535714285714285, "ram_util_percent": 29.22142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.06928299665451, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9861546124642094, "policy_loss": -0.014066237592487596, "vf_loss": 0.9913306722417474, "vf_explained_var": 0.9918481548627217, "kl": 0.013290467275146512, "entropy": 0.8088560984780391, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -20.951998092987196, "episode_reward_min": -1275.2403847567653, "episode_reward_mean": -318.6516310224444, "episode_len_mean": 101.9, "episode_media": {}, "episodes_timesteps_total": 10190, "policy_reward_min": {"policy_0": -1275.2403847567653}, "policy_reward_max": {"policy_0": -20.951998092987196}, "policy_reward_mean": {"policy_0": -318.6516310224444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424, -935.6609459582947, -194.60226955377246, -336.010848337315, -33.37248318795419, -364.14833014742084, -286.4566680238706, -1210.2598613709765, -111.23818279365177, -20.951998092987196, -397.9840716288819, -288.41524332080365, -851.257885998914, -315.9542563622781, -646.5822801897624, -163.67661463288286, -215.54240660030607, -191.51011661398897, -305.5205109591981, -515.8681738166127, -400.1655280267463, -165.38648146722136, -249.48625544917724, -311.65567156744845, -199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928, -345.2544017301884, -702.9610120652592, -105.96316624100226, -123.19580965452724, -343.8584837669919, -375.69136293667844, -157.60940452158619, -142.49769361402124, -667.6565548327609, -163.96113679416425, -233.82278526917327, -195.97241930261097, -371.8425396975563, -67.42559390991028, -128.91954672415096, -47.05751636032054, -360.41722550012787, -157.3575196063568, -142.84498318816344, -88.58998667018, -137.91563179323742, -410.12793883461086, -122.19782126123093, -74.23011803452323, -114.17744425029267, -284.4403072409271, -305.63899327612995, -110.27006962598179, -368.3492406822869, -128.91208654150907, -198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785], "episode_lengths": [150, 150, 126, 66, 78, 150, 150, 62, 96, 84, 69, 93, 50, 102, 58, 98, 70, 150, 150, 67, 111, 41, 150, 127, 150, 68, 42, 150, 114, 150, 104, 150, 90, 106, 91, 109, 129, 118, 80, 108, 101, 87, 63, 80, 106, 150, 96, 139, 110, 68, 150, 83, 103, 86, 150, 54, 94, 64, 150, 150, 74, 73, 150, 150, 81, 95, 150, 89, 91, 113, 150, 56, 78, 48, 150, 83, 72, 69, 76, 150, 80, 65, 78, 118, 110, 84, 150, 79, 81, 99, 126, 63, 53, 150, 85, 103, 94, 69, 73, 141], "policy_policy_0_reward": [-1275.2403847567653, -1076.6855966835876, -285.3191292809451, -108.3249035366479, -135.71786423158426, -767.2425961725145, -1195.464474290547, -67.77840599513046, -153.82765272822272, -188.97355012175194, -104.15852473731316, -215.9728125566239, -32.34136234148067, -181.22767428800714, -63.999217474421776, -212.70569155722677, -122.89148287914294, -971.8769801339424, -935.6609459582947, -194.60226955377246, -336.010848337315, -33.37248318795419, -364.14833014742084, -286.4566680238706, -1210.2598613709765, -111.23818279365177, -20.951998092987196, -397.9840716288819, -288.41524332080365, -851.257885998914, -315.9542563622781, -646.5822801897624, -163.67661463288286, -215.54240660030607, -191.51011661398897, -305.5205109591981, -515.8681738166127, -400.1655280267463, -165.38648146722136, -249.48625544917724, -311.65567156744845, -199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928, -345.2544017301884, -702.9610120652592, -105.96316624100226, -123.19580965452724, -343.8584837669919, -375.69136293667844, -157.60940452158619, -142.49769361402124, -667.6565548327609, -163.96113679416425, -233.82278526917327, -195.97241930261097, -371.8425396975563, -67.42559390991028, -128.91954672415096, -47.05751636032054, -360.41722550012787, -157.3575196063568, -142.84498318816344, -88.58998667018, -137.91563179323742, -410.12793883461086, -122.19782126123093, -74.23011803452323, -114.17744425029267, -284.4403072409271, -305.63899327612995, -110.27006962598179, -368.3492406822869, -128.91208654150907, -198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540957299852269, "mean_inference_ms": 1.691922767038389, "mean_action_processing_ms": 0.27270470600010055, "mean_env_wait_ms": 3.3074668007099395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011887788772583008, "StateBufferConnector_ms": 0.007862567901611328, "ViewRequirementAgentConnector_ms": 0.19070172309875488}, "num_episodes": 42, "episode_return_max": -20.951998092987196, "episode_return_min": -1275.2403847567653, "episode_return_mean": -318.6516310224444, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.6607059641784, "num_env_steps_trained_throughput_per_sec": 344.6607059641784, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 11504.994, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11504.914, "sample_time_ms": 1117.325, "learn_time_ms": 10322.479, "learn_throughput": 387.504, "synch_weights_time_ms": 64.23}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "89531_00000", "date": "2024-08-05_11-24-16", "timestamp": 1722837256, "time_this_iter_s": 11.616936922073364, "time_total_s": 673.9962382316589, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 673.9962382316589, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.294117647058822, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.21360228161016, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9526377628557384, "policy_loss": -0.013622565349699774, "vf_loss": 0.9570857419011494, "vf_explained_var": 0.9980646622056762, "kl": 0.013713733813468361, "entropy": 0.8218168997205794, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -16.753874816453198, "episode_reward_min": -1106.1911008375293, "episode_reward_mean": -272.91697566663896, "episode_len_mean": 96.19, "episode_media": {}, "episodes_timesteps_total": 9619, "policy_reward_min": {"policy_0": -1106.1911008375293}, "policy_reward_max": {"policy_0": -16.753874816453198}, "policy_reward_mean": {"policy_0": -272.91697566663896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928, -345.2544017301884, -702.9610120652592, -105.96316624100226, -123.19580965452724, -343.8584837669919, -375.69136293667844, -157.60940452158619, -142.49769361402124, -667.6565548327609, -163.96113679416425, -233.82278526917327, -195.97241930261097, -371.8425396975563, -67.42559390991028, -128.91954672415096, -47.05751636032054, -360.41722550012787, -157.3575196063568, -142.84498318816344, -88.58998667018, -137.91563179323742, -410.12793883461086, -122.19782126123093, -74.23011803452323, -114.17744425029267, -284.4403072409271, -305.63899327612995, -110.27006962598179, -368.3492406822869, -128.91208654150907, -198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785, -523.1786709391048, -62.67804673747493, -197.73095271627582, -309.70369398088525, -17.76409833105448, -179.04177151695671, -123.67863247008442, -70.36720645623448, -976.6751247037342, -943.7829395752103, -97.61227981105664, -105.62946860528032, -191.31212268460115, -16.753874816453198, -252.58294454460759, -331.2569866686628, -81.2763984200226, -197.31604131420735, -93.9943906202939, -533.6023939083257, -97.91546361331575, -305.5351244201017, -158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866], "episode_lengths": [87, 63, 80, 106, 150, 96, 139, 110, 68, 150, 83, 103, 86, 150, 54, 94, 64, 150, 150, 74, 73, 150, 150, 81, 95, 150, 89, 91, 113, 150, 56, 78, 48, 150, 83, 72, 69, 76, 150, 80, 65, 78, 118, 110, 84, 150, 79, 81, 99, 126, 63, 53, 150, 85, 103, 94, 69, 73, 141, 150, 59, 71, 124, 39, 97, 69, 69, 150, 150, 63, 72, 67, 42, 110, 87, 62, 88, 64, 150, 60, 105, 77, 106, 85, 74, 53, 105, 124, 150, 123, 50, 150, 65, 117, 53, 82, 150, 55, 92, 78], "policy_policy_0_reward": [-199.9765751577971, -98.89989220128615, -149.02941127388397, -242.42202156707654, -1102.645945629403, -260.0134341593286, -374.15205713636664, -342.690909254299, -201.17937636058784, -1106.1911008375293, -184.00189466138437, -501.58501247242555, -136.54324828618977, -1032.3494633483288, -23.618752975453855, -383.0025844364114, -97.33497120829928, -345.2544017301884, -702.9610120652592, -105.96316624100226, -123.19580965452724, -343.8584837669919, -375.69136293667844, -157.60940452158619, -142.49769361402124, -667.6565548327609, -163.96113679416425, -233.82278526917327, -195.97241930261097, -371.8425396975563, -67.42559390991028, -128.91954672415096, -47.05751636032054, -360.41722550012787, -157.3575196063568, -142.84498318816344, -88.58998667018, -137.91563179323742, -410.12793883461086, -122.19782126123093, -74.23011803452323, -114.17744425029267, -284.4403072409271, -305.63899327612995, -110.27006962598179, -368.3492406822869, -128.91208654150907, -198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785, -523.1786709391048, -62.67804673747493, -197.73095271627582, -309.70369398088525, -17.76409833105448, -179.04177151695671, -123.67863247008442, -70.36720645623448, -976.6751247037342, -943.7829395752103, -97.61227981105664, -105.62946860528032, -191.31212268460115, -16.753874816453198, -252.58294454460759, -331.2569866686628, -81.2763984200226, -197.31604131420735, -93.9943906202939, -533.6023939083257, -97.91546361331575, -305.5351244201017, -158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542871773607011, "mean_inference_ms": 1.691750407367532, "mean_action_processing_ms": 0.2726684371163526, "mean_env_wait_ms": 3.308700152079301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012226581573486328, "StateBufferConnector_ms": 0.007977724075317383, "ViewRequirementAgentConnector_ms": 0.19322586059570312}, "num_episodes": 41, "episode_return_max": -16.753874816453198, "episode_return_min": -1106.1911008375293, "episode_return_mean": -272.91697566663896, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.3855090271143, "num_env_steps_trained_throughput_per_sec": 366.3855090271143, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 11369.557, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11369.477, "sample_time_ms": 1130.006, "learn_time_ms": 10175.681, "learn_throughput": 393.094, "synch_weights_time_ms": 62.92}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "89531_00000", "date": "2024-08-05_11-24-27", "timestamp": 1722837267, "time_this_iter_s": 10.929641485214233, "time_total_s": 684.9258797168732, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 684.9258797168732, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.125, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.3571872641643, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8224910214698563, "policy_loss": -0.014857369042389715, "vf_loss": 0.8282986541589101, "vf_explained_var": 0.9982981921484073, "kl": 0.013494362251852484, "entropy": 0.589573879695187, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -13.816280320354052, "episode_reward_min": -1174.7276355400306, "episode_reward_mean": -269.09174409089655, "episode_len_mean": 92.34, "episode_media": {}, "episodes_timesteps_total": 9234, "policy_reward_min": {"policy_0": -1174.7276355400306}, "policy_reward_max": {"policy_0": -13.816280320354052}, "policy_reward_mean": {"policy_0": -269.09174409089655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785, -523.1786709391048, -62.67804673747493, -197.73095271627582, -309.70369398088525, -17.76409833105448, -179.04177151695671, -123.67863247008442, -70.36720645623448, -976.6751247037342, -943.7829395752103, -97.61227981105664, -105.62946860528032, -191.31212268460115, -16.753874816453198, -252.58294454460759, -331.2569866686628, -81.2763984200226, -197.31604131420735, -93.9943906202939, -533.6023939083257, -97.91546361331575, -305.5351244201017, -158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866, -183.61952545254323, -96.23959913945713, -29.63277957616087, -71.84886567617669, -136.69057548460637, -532.8356555622531, -799.769390551335, -50.14312179952295, -188.87570791288917, -833.6799588129683, -151.4742851490721, -255.55244842570832, -1127.4244475324858, -139.75226712366953, -107.9920980561015, -120.93168186824715, -39.906560377430154, -13.816280320354052, -1102.2209191106226, -83.25227455618766, -108.37384216524546, -1061.4212483765955, -163.76321242139073, -156.4688951815004, -127.05985962410787, -334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198], "episode_lengths": [81, 99, 126, 63, 53, 150, 85, 103, 94, 69, 73, 141, 150, 59, 71, 124, 39, 97, 69, 69, 150, 150, 63, 72, 67, 42, 110, 87, 62, 88, 64, 150, 60, 105, 77, 106, 85, 74, 53, 105, 124, 150, 123, 50, 150, 65, 117, 53, 82, 150, 55, 92, 78, 109, 64, 46, 60, 78, 150, 150, 58, 106, 150, 103, 105, 150, 87, 70, 75, 58, 39, 150, 66, 76, 150, 98, 85, 86, 129, 43, 84, 89, 63, 100, 47, 50, 150, 150, 47, 71, 40, 116, 59, 111, 150, 150, 77, 126, 55, 84], "policy_policy_0_reward": [-198.53254817649596, -236.80455992894397, -266.3673029419723, -76.33056333461217, -55.64199688120973, -722.7637425144519, -208.34270024516275, -155.08556556515254, -225.6173446293744, -87.42502486946472, -112.58971734396172, -433.41120305479785, -523.1786709391048, -62.67804673747493, -197.73095271627582, -309.70369398088525, -17.76409833105448, -179.04177151695671, -123.67863247008442, -70.36720645623448, -976.6751247037342, -943.7829395752103, -97.61227981105664, -105.62946860528032, -191.31212268460115, -16.753874816453198, -252.58294454460759, -331.2569866686628, -81.2763984200226, -197.31604131420735, -93.9943906202939, -533.6023939083257, -97.91546361331575, -305.5351244201017, -158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866, -183.61952545254323, -96.23959913945713, -29.63277957616087, -71.84886567617669, -136.69057548460637, -532.8356555622531, -799.769390551335, -50.14312179952295, -188.87570791288917, -833.6799588129683, -151.4742851490721, -255.55244842570832, -1127.4244475324858, -139.75226712366953, -107.9920980561015, -120.93168186824715, -39.906560377430154, -13.816280320354052, -1102.2209191106226, -83.25227455618766, -108.37384216524546, -1061.4212483765955, -163.76321242139073, -156.4688951815004, -127.05985962410787, -334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539524867841764, "mean_inference_ms": 1.692333200446745, "mean_action_processing_ms": 0.2729282122953175, "mean_env_wait_ms": 3.3128824248681266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012273788452148438, "StateBufferConnector_ms": 0.00796818733215332, "ViewRequirementAgentConnector_ms": 0.1937255859375}, "num_episodes": 47, "episode_return_max": -13.816280320354052, "episode_return_min": -1174.7276355400306, "episode_return_mean": -269.09174409089655, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.6541059149894, "num_env_steps_trained_throughput_per_sec": 400.6541059149894, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 11124.306, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11124.227, "sample_time_ms": 1130.541, "learn_time_ms": 9931.627, "learn_throughput": 402.754, "synch_weights_time_ms": 61.201}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "89531_00000", "date": "2024-08-05_11-24-37", "timestamp": 1722837277, "time_this_iter_s": 9.995694637298584, "time_total_s": 694.9215743541718, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644715120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 694.9215743541718, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 21.371428571428574, "ram_util_percent": 29.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.12925183276336, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8523990727340182, "policy_loss": -0.019575219535666596, "vf_loss": 0.8625493051329006, "vf_explained_var": 0.9966236166035135, "kl": 0.014072737402936278, "entropy": 0.7411134210415184, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -13.816280320354052, "episode_reward_min": -1174.7276355400306, "episode_reward_mean": -293.1328200403689, "episode_len_mean": 96.2, "episode_media": {}, "episodes_timesteps_total": 9620, "policy_reward_min": {"policy_0": -1174.7276355400306}, "policy_reward_max": {"policy_0": -13.816280320354052}, "policy_reward_mean": {"policy_0": -293.1328200403689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866, -183.61952545254323, -96.23959913945713, -29.63277957616087, -71.84886567617669, -136.69057548460637, -532.8356555622531, -799.769390551335, -50.14312179952295, -188.87570791288917, -833.6799588129683, -151.4742851490721, -255.55244842570832, -1127.4244475324858, -139.75226712366953, -107.9920980561015, -120.93168186824715, -39.906560377430154, -13.816280320354052, -1102.2209191106226, -83.25227455618766, -108.37384216524546, -1061.4212483765955, -163.76321242139073, -156.4688951815004, -127.05985962410787, -334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198, -261.55740176232484, -186.35297449791338, -314.73586701051863, -337.812415919481, -1118.7683059963151, -525.5491117360282, -832.6516816650062, -258.0133375897418, -140.78631199915282, -1138.150225385963, -484.6987229748817, -386.00859485410865, -52.94482612887479, -328.7916364091201, -44.15940632814584, -178.25448881407212, -39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532], "episode_lengths": [77, 106, 85, 74, 53, 105, 124, 150, 123, 50, 150, 65, 117, 53, 82, 150, 55, 92, 78, 109, 64, 46, 60, 78, 150, 150, 58, 106, 150, 103, 105, 150, 87, 70, 75, 58, 39, 150, 66, 76, 150, 98, 85, 86, 129, 43, 84, 89, 63, 100, 47, 50, 150, 150, 47, 71, 40, 116, 59, 111, 150, 150, 77, 126, 55, 84, 98, 99, 104, 140, 150, 131, 150, 119, 94, 150, 150, 150, 63, 91, 55, 86, 53, 138, 56, 72, 99, 150, 66, 55, 64, 61, 103, 118, 63, 108, 64, 150, 150, 71], "policy_policy_0_reward": [-158.57910153382144, -216.48665508190604, -126.00222925658375, -156.94391823921308, -46.68878974470628, -259.99026641868875, -296.8818751574726, -871.7535676765431, -233.6842531689306, -23.954521606735458, -916.0933976121643, -101.15441841806262, -331.75620674033655, -31.29808224519407, -172.12357681703048, -1062.8248195370504, -34.92855319328009, -207.18361879214294, -140.27337419197866, -183.61952545254323, -96.23959913945713, -29.63277957616087, -71.84886567617669, -136.69057548460637, -532.8356555622531, -799.769390551335, -50.14312179952295, -188.87570791288917, -833.6799588129683, -151.4742851490721, -255.55244842570832, -1127.4244475324858, -139.75226712366953, -107.9920980561015, -120.93168186824715, -39.906560377430154, -13.816280320354052, -1102.2209191106226, -83.25227455618766, -108.37384216524546, -1061.4212483765955, -163.76321242139073, -156.4688951815004, -127.05985962410787, -334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198, -261.55740176232484, -186.35297449791338, -314.73586701051863, -337.812415919481, -1118.7683059963151, -525.5491117360282, -832.6516816650062, -258.0133375897418, -140.78631199915282, -1138.150225385963, -484.6987229748817, -386.00859485410865, -52.94482612887479, -328.7916364091201, -44.15940632814584, -178.25448881407212, -39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540383259301955, "mean_inference_ms": 1.691505649977532, "mean_action_processing_ms": 0.27304046797994075, "mean_env_wait_ms": 3.314185525974363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01195979118347168, "StateBufferConnector_ms": 0.008294343948364258, "ViewRequirementAgentConnector_ms": 0.19734930992126465}, "num_episodes": 34, "episode_return_max": -13.816280320354052, "episode_return_min": -1174.7276355400306, "episode_return_mean": -293.1328200403689, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.90350424212556, "num_env_steps_trained_throughput_per_sec": 330.90350424212556, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 11207.671, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11207.592, "sample_time_ms": 1125.475, "learn_time_ms": 10020.616, "learn_throughput": 399.177, "synch_weights_time_ms": 60.639}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "89531_00000", "date": "2024-08-05_11-24-50", "timestamp": 1722837290, "time_this_iter_s": 12.098627090454102, "time_total_s": 707.0202014446259, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644789c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.0202014446259, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.08235294117647, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.26768385966619, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0832622923577826, "policy_loss": -0.016760711904498748, "vf_loss": 1.0916975517757237, "vf_explained_var": 0.9956251346195738, "kl": 0.0124659699453332, "entropy": 0.8907565483202536, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -4.498640878686232, "episode_reward_min": -1347.136911205424, "episode_reward_mean": -308.98600449990494, "episode_len_mean": 98.36, "episode_media": {}, "episodes_timesteps_total": 9836, "policy_reward_min": {"policy_0": -1347.136911205424}, "policy_reward_max": {"policy_0": -4.498640878686232}, "policy_reward_mean": {"policy_0": -308.98600449990494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198, -261.55740176232484, -186.35297449791338, -314.73586701051863, -337.812415919481, -1118.7683059963151, -525.5491117360282, -832.6516816650062, -258.0133375897418, -140.78631199915282, -1138.150225385963, -484.6987229748817, -386.00859485410865, -52.94482612887479, -328.7916364091201, -44.15940632814584, -178.25448881407212, -39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532, -138.23742447203915, -46.271730707046174, -50.836234543067434, -188.26771335597783, -4.498640878686232, -23.02652252894088, -733.4993994213547, -91.34404628731096, -283.997706091425, -293.9114968024569, -198.22399171910118, -1014.0716374481808, -505.8789801193276, -332.15724858721006, -449.78285242092613, -55.538214007171895, -138.52408199735484, -372.0066679786976, -1096.1181692351095, -57.86807114599967, -27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391], "episode_lengths": [129, 43, 84, 89, 63, 100, 47, 50, 150, 150, 47, 71, 40, 116, 59, 111, 150, 150, 77, 126, 55, 84, 98, 99, 104, 140, 150, 131, 150, 119, 94, 150, 150, 150, 63, 91, 55, 86, 53, 138, 56, 72, 99, 150, 66, 55, 64, 61, 103, 118, 63, 108, 64, 150, 150, 71, 78, 53, 62, 98, 37, 45, 150, 49, 108, 121, 116, 150, 150, 109, 150, 56, 53, 128, 150, 62, 53, 127, 104, 55, 79, 150, 110, 96, 50, 66, 150, 65, 122, 71, 150, 130, 56, 150, 150, 57, 123, 35, 150, 150], "policy_policy_0_reward": [-334.03323727869275, -25.824140930064264, -177.2308004375555, -208.1586028528457, -76.30006792756514, -224.0863097757292, -31.787170712804965, -44.37348409534767, -1174.7276355400306, -268.31370610654074, -33.59930445242278, -92.32488232738675, -20.583466999768582, -260.862596992219, -56.61287161961011, -183.12453027985754, -937.9807741966881, -516.0831915145651, -158.96619578306303, -326.80721062573383, -66.37583053853204, -131.3707760746198, -261.55740176232484, -186.35297449791338, -314.73586701051863, -337.812415919481, -1118.7683059963151, -525.5491117360282, -832.6516816650062, -258.0133375897418, -140.78631199915282, -1138.150225385963, -484.6987229748817, -386.00859485410865, -52.94482612887479, -328.7916364091201, -44.15940632814584, -178.25448881407212, -39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532, -138.23742447203915, -46.271730707046174, -50.836234543067434, -188.26771335597783, -4.498640878686232, -23.02652252894088, -733.4993994213547, -91.34404628731096, -283.997706091425, -293.9114968024569, -198.22399171910118, -1014.0716374481808, -505.8789801193276, -332.15724858721006, -449.78285242092613, -55.538214007171895, -138.52408199735484, -372.0066679786976, -1096.1181692351095, -57.86807114599967, -27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543151148677393, "mean_inference_ms": 1.6904272489532912, "mean_action_processing_ms": 0.2728481989093764, "mean_env_wait_ms": 3.313292393980796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011795520782470703, "StateBufferConnector_ms": 0.008199691772460938, "ViewRequirementAgentConnector_ms": 0.19481396675109863}, "num_episodes": 44, "episode_return_max": -4.498640878686232, "episode_return_min": -1347.136911205424, "episode_return_mean": -308.98600449990494, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.0519464577513, "num_env_steps_trained_throughput_per_sec": 323.0519464577513, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 11255.263, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11255.183, "sample_time_ms": 1113.965, "learn_time_ms": 10078.178, "learn_throughput": 396.897, "synch_weights_time_ms": 62.16}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "89531_00000", "date": "2024-08-05_11-25-02", "timestamp": 1722837302, "time_this_iter_s": 12.393694400787354, "time_total_s": 719.4138958454132, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478a5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 719.4138958454132, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.083333333333336, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.93815983136496, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0356712015345693, "policy_loss": -0.012182848471275065, "vf_loss": 1.0379210509049395, "vf_explained_var": 0.9958782406523824, "kl": 0.014819155078294033, "entropy": 0.6993126006176075, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -4.498640878686232, "episode_reward_min": -1347.136911205424, "episode_reward_mean": -317.5956441437114, "episode_len_mean": 99.76, "episode_media": {}, "episodes_timesteps_total": 9976, "policy_reward_min": {"policy_0": -1347.136911205424}, "policy_reward_max": {"policy_0": -4.498640878686232}, "policy_reward_mean": {"policy_0": -317.5956441437114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532, -138.23742447203915, -46.271730707046174, -50.836234543067434, -188.26771335597783, -4.498640878686232, -23.02652252894088, -733.4993994213547, -91.34404628731096, -283.997706091425, -293.9114968024569, -198.22399171910118, -1014.0716374481808, -505.8789801193276, -332.15724858721006, -449.78285242092613, -55.538214007171895, -138.52408199735484, -372.0066679786976, -1096.1181692351095, -57.86807114599967, -27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391, -443.6137626568386, -328.99259798214575, -510.5698798955977, -100.05320028104192, -33.4036181786453, -956.5897237055123, -170.47164763411755, -129.92705813622854, -1072.657094035172, -5.073579086033524, -193.38364186317835, -185.49778711151163, -264.4760430534876, -236.564038207102, -788.3885933060255, -127.37435413385958, -259.8356494817559, -1049.1485894062523, -177.97253228217141, -186.38635322490774, -118.84994512552876, -170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675], "episode_lengths": [53, 138, 56, 72, 99, 150, 66, 55, 64, 61, 103, 118, 63, 108, 64, 150, 150, 71, 78, 53, 62, 98, 37, 45, 150, 49, 108, 121, 116, 150, 150, 109, 150, 56, 53, 128, 150, 62, 53, 127, 104, 55, 79, 150, 110, 96, 50, 66, 150, 65, 122, 71, 150, 130, 56, 150, 150, 57, 123, 35, 150, 150, 150, 131, 150, 66, 39, 150, 79, 79, 150, 31, 84, 95, 107, 120, 150, 69, 91, 150, 88, 81, 71, 77, 102, 73, 97, 98, 96, 150, 109, 111, 150, 72, 129, 150, 150, 104, 92, 70], "policy_policy_0_reward": [-39.74190550495324, -241.80262112336064, -37.98873121321793, -100.07892489464325, -242.74215223362788, -611.3116862779931, -101.37610742915932, -86.6106396772199, -83.24048991409776, -203.68593464454295, -153.394592245433, -382.3636667391586, -61.49156598811769, -298.9962267546437, -102.88997590628432, -617.7851256381146, -807.0906375156386, -130.58219851492532, -138.23742447203915, -46.271730707046174, -50.836234543067434, -188.26771335597783, -4.498640878686232, -23.02652252894088, -733.4993994213547, -91.34404628731096, -283.997706091425, -293.9114968024569, -198.22399171910118, -1014.0716374481808, -505.8789801193276, -332.15724858721006, -449.78285242092613, -55.538214007171895, -138.52408199735484, -372.0066679786976, -1096.1181692351095, -57.86807114599967, -27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391, -443.6137626568386, -328.99259798214575, -510.5698798955977, -100.05320028104192, -33.4036181786453, -956.5897237055123, -170.47164763411755, -129.92705813622854, -1072.657094035172, -5.073579086033524, -193.38364186317835, -185.49778711151163, -264.4760430534876, -236.564038207102, -788.3885933060255, -127.37435413385958, -259.8356494817559, -1049.1485894062523, -177.97253228217141, -186.38635322490774, -118.84994512552876, -170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541280236281003, "mean_inference_ms": 1.690549369239692, "mean_action_processing_ms": 0.27289868575762866, "mean_env_wait_ms": 3.3113372373622463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012115478515625, "StateBufferConnector_ms": 0.00775456428527832, "ViewRequirementAgentConnector_ms": 0.19376516342163086}, "num_episodes": 38, "episode_return_max": -4.498640878686232, "episode_return_min": -1347.136911205424, "episode_return_mean": -317.5956441437114, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.1014964736445, "num_env_steps_trained_throughput_per_sec": 312.1014964736445, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 11450.943, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11450.863, "sample_time_ms": 1108.725, "learn_time_ms": 10280.307, "learn_throughput": 389.093, "synch_weights_time_ms": 60.979}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "89531_00000", "date": "2024-08-05_11-25-15", "timestamp": 1722837315, "time_this_iter_s": 12.829854965209961, "time_total_s": 732.2437508106232, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644714790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 732.2437508106232, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.561111111111114, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.03156048953534, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9410126242010544, "policy_loss": -0.01287936443137975, "vf_loss": 0.9458601583416263, "vf_explained_var": 0.9957153221592308, "kl": 0.011990030284384072, "entropy": 0.6144234066208204, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -5.073579086033524, "episode_reward_min": -1347.136911205424, "episode_reward_mean": -339.1263453674691, "episode_len_mean": 101.21, "episode_media": {}, "episodes_timesteps_total": 10121, "policy_reward_min": {"policy_0": -1347.136911205424}, "policy_reward_max": {"policy_0": -5.073579086033524}, "policy_reward_mean": {"policy_0": -339.1263453674691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391, -443.6137626568386, -328.99259798214575, -510.5698798955977, -100.05320028104192, -33.4036181786453, -956.5897237055123, -170.47164763411755, -129.92705813622854, -1072.657094035172, -5.073579086033524, -193.38364186317835, -185.49778711151163, -264.4760430534876, -236.564038207102, -788.3885933060255, -127.37435413385958, -259.8356494817559, -1049.1485894062523, -177.97253228217141, -186.38635322490774, -118.84994512552876, -170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675, -868.6441713774161, -150.47999569424022, -567.1807133154167, -1066.5696794255514, -138.56568287109562, -972.6748180716567, -114.1116865407826, -218.6979806448151, -28.464520229534145, -282.0295094218473, -283.4413726186323, -143.69229612361877, -143.6533246297824, -209.10564387093243, -89.76694825233884, -246.719706809791, -465.22738216149776, -36.92984475334491, -178.7449580680647, -1245.0972613183496, -164.51737627094798, -141.50020726756043, -80.1614803335127, -322.9644345040944, -68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292], "episode_lengths": [53, 127, 104, 55, 79, 150, 110, 96, 50, 66, 150, 65, 122, 71, 150, 130, 56, 150, 150, 57, 123, 35, 150, 150, 150, 131, 150, 66, 39, 150, 79, 79, 150, 31, 84, 95, 107, 120, 150, 69, 91, 150, 88, 81, 71, 77, 102, 73, 97, 98, 96, 150, 109, 111, 150, 72, 129, 150, 150, 104, 92, 70, 150, 96, 130, 150, 76, 150, 71, 92, 44, 143, 93, 81, 65, 106, 62, 106, 150, 54, 80, 150, 79, 58, 64, 125, 68, 52, 106, 54, 72, 41, 150, 43, 150, 68, 150, 150, 113, 119], "policy_policy_0_reward": [-27.153681011227665, -298.81862534551965, -186.292077639666, -49.29480258887081, -321.9543814103398, -735.0736488815248, -244.94677179920006, -254.042969770625, -28.502602861200963, -90.30613929328665, -485.27296625440124, -85.400015128599, -308.6403313186988, -137.79234185073125, -721.7249320402213, -319.32513597261016, -32.0901761456886, -1347.136911205424, -628.0774315036688, -54.908259130612194, -258.14010159076446, -6.231126155818041, -999.5649964192505, -961.9139165767391, -443.6137626568386, -328.99259798214575, -510.5698798955977, -100.05320028104192, -33.4036181786453, -956.5897237055123, -170.47164763411755, -129.92705813622854, -1072.657094035172, -5.073579086033524, -193.38364186317835, -185.49778711151163, -264.4760430534876, -236.564038207102, -788.3885933060255, -127.37435413385958, -259.8356494817559, -1049.1485894062523, -177.97253228217141, -186.38635322490774, -118.84994512552876, -170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675, -868.6441713774161, -150.47999569424022, -567.1807133154167, -1066.5696794255514, -138.56568287109562, -972.6748180716567, -114.1116865407826, -218.6979806448151, -28.464520229534145, -282.0295094218473, -283.4413726186323, -143.69229612361877, -143.6533246297824, -209.10564387093243, -89.76694825233884, -246.719706809791, -465.22738216149776, -36.92984475334491, -178.7449580680647, -1245.0972613183496, -164.51737627094798, -141.50020726756043, -80.1614803335127, -322.9644345040944, -68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535207661019892, "mean_inference_ms": 1.6900620947462346, "mean_action_processing_ms": 0.2728124874824609, "mean_env_wait_ms": 3.308566878632206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012064218521118164, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.19022870063781738}, "num_episodes": 38, "episode_return_max": -5.073579086033524, "episode_return_min": -1347.136911205424, "episode_return_mean": -339.1263453674691, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.74019978566866, "num_env_steps_trained_throughput_per_sec": 370.74019978566866, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 11339.148, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11339.067, "sample_time_ms": 1108.891, "learn_time_ms": 10166.89, "learn_throughput": 393.434, "synch_weights_time_ms": 62.432}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "89531_00000", "date": "2024-08-05_11-25-26", "timestamp": 1722837326, "time_this_iter_s": 10.800658702850342, "time_total_s": 743.0444095134735, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644716440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 743.0444095134735, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.519999999999996, "ram_util_percent": 29.213333333333328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.63636126269897, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0199268297990784, "policy_loss": -0.010212558886754172, "vf_loss": 1.0229151838148633, "vf_explained_var": 0.9868252826854587, "kl": 0.010787123871371781, "entropy": 0.5710277227063973, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -6.906452082041038, "episode_reward_min": -1245.0972613183496, "episode_reward_mean": -289.1213389966255, "episode_len_mean": 96.7, "episode_media": {}, "episodes_timesteps_total": 9670, "policy_reward_min": {"policy_0": -1245.0972613183496}, "policy_reward_max": {"policy_0": -6.906452082041038}, "policy_reward_mean": {"policy_0": -289.1213389966255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675, -868.6441713774161, -150.47999569424022, -567.1807133154167, -1066.5696794255514, -138.56568287109562, -972.6748180716567, -114.1116865407826, -218.6979806448151, -28.464520229534145, -282.0295094218473, -283.4413726186323, -143.69229612361877, -143.6533246297824, -209.10564387093243, -89.76694825233884, -246.719706809791, -465.22738216149776, -36.92984475334491, -178.7449580680647, -1245.0972613183496, -164.51737627094798, -141.50020726756043, -80.1614803335127, -322.9644345040944, -68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292, -264.6123020356084, -303.6350547030947, -359.11191694386395, -45.60089681845388, -65.83891125888952, -278.4295808589334, -214.05234891999402, -31.230834946712662, -219.94086531303546, -141.63846044347892, -114.4535805419013, -198.48950718786884, -34.441003509725725, -55.796413662603726, -178.34853331071741, -78.09067337349221, -15.271812654152145, -22.659560515892036, -151.88635727136827, -80.632329313729, -127.37552509666057, -70.75511221056438, -112.52448252256976, -280.05298400473197, -366.37889008280007, -478.6292696103639, -160.38339786038708, -609.1099575561569, -236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944], "episode_lengths": [77, 102, 73, 97, 98, 96, 150, 109, 111, 150, 72, 129, 150, 150, 104, 92, 70, 150, 96, 130, 150, 76, 150, 71, 92, 44, 143, 93, 81, 65, 106, 62, 106, 150, 54, 80, 150, 79, 58, 64, 125, 68, 52, 106, 54, 72, 41, 150, 43, 150, 68, 150, 150, 113, 119, 102, 76, 149, 54, 59, 99, 103, 59, 108, 96, 75, 93, 43, 55, 83, 68, 37, 48, 86, 60, 81, 66, 76, 76, 112, 127, 81, 133, 82, 95, 70, 150, 125, 121, 75, 128, 105, 150, 121, 150, 100, 58, 87, 146, 61], "policy_policy_0_reward": [-170.24842643670226, -332.40565482280067, -99.71842329453082, -289.3195813127868, -246.88594873536385, -144.73066167193053, -1043.1367551653004, -256.57168389737865, -487.57402484197047, -411.54576166019774, -121.42852139627433, -324.5865851325606, -546.3327076787516, -515.8541014678442, -202.40919764137504, -133.64336496812615, -134.10497160292675, -868.6441713774161, -150.47999569424022, -567.1807133154167, -1066.5696794255514, -138.56568287109562, -972.6748180716567, -114.1116865407826, -218.6979806448151, -28.464520229534145, -282.0295094218473, -283.4413726186323, -143.69229612361877, -143.6533246297824, -209.10564387093243, -89.76694825233884, -246.719706809791, -465.22738216149776, -36.92984475334491, -178.7449580680647, -1245.0972613183496, -164.51737627094798, -141.50020726756043, -80.1614803335127, -322.9644345040944, -68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292, -264.6123020356084, -303.6350547030947, -359.11191694386395, -45.60089681845388, -65.83891125888952, -278.4295808589334, -214.05234891999402, -31.230834946712662, -219.94086531303546, -141.63846044347892, -114.4535805419013, -198.48950718786884, -34.441003509725725, -55.796413662603726, -178.34853331071741, -78.09067337349221, -15.271812654152145, -22.659560515892036, -151.88635727136827, -80.632329313729, -127.37552509666057, -70.75511221056438, -112.52448252256976, -280.05298400473197, -366.37889008280007, -478.6292696103639, -160.38339786038708, -609.1099575561569, -236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541584452602567, "mean_inference_ms": 1.6896301981399375, "mean_action_processing_ms": 0.27295864083957205, "mean_env_wait_ms": 3.311331766848913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011841773986816406, "StateBufferConnector_ms": 0.00794363021850586, "ViewRequirementAgentConnector_ms": 0.19813227653503418}, "num_episodes": 45, "episode_return_max": -6.906452082041038, "episode_return_min": -1245.0972613183496, "episode_return_mean": -289.1213389966255, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.28779160844823, "num_env_steps_trained_throughput_per_sec": 311.28779160844823, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 11485.796, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11485.713, "sample_time_ms": 1126.09, "learn_time_ms": 10297.491, "learn_throughput": 388.444, "synch_weights_time_ms": 61.279}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "89531_00000", "date": "2024-08-05_11-25-39", "timestamp": 1722837339, "time_this_iter_s": 12.860810995101929, "time_total_s": 755.9052205085754, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 755.9052205085754, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.363157894736844, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.50315560996532, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.935785833451276, "policy_loss": -0.015435182149424994, "vf_loss": 0.9408928113679091, "vf_explained_var": 0.9961277609070142, "kl": 0.015391413500340907, "entropy": 0.6100095702335239, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -6.906452082041038, "episode_reward_min": -1185.7922172518956, "episode_reward_mean": -285.5660968067761, "episode_len_mean": 95.86, "episode_media": {}, "episodes_timesteps_total": 9586, "policy_reward_min": {"policy_0": -1185.7922172518956}, "policy_reward_max": {"policy_0": -6.906452082041038}, "policy_reward_mean": {"policy_0": -285.5660968067761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292, -264.6123020356084, -303.6350547030947, -359.11191694386395, -45.60089681845388, -65.83891125888952, -278.4295808589334, -214.05234891999402, -31.230834946712662, -219.94086531303546, -141.63846044347892, -114.4535805419013, -198.48950718786884, -34.441003509725725, -55.796413662603726, -178.34853331071741, -78.09067337349221, -15.271812654152145, -22.659560515892036, -151.88635727136827, -80.632329313729, -127.37552509666057, -70.75511221056438, -112.52448252256976, -280.05298400473197, -366.37889008280007, -478.6292696103639, -160.38339786038708, -609.1099575561569, -236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944, -543.8006773738215, -47.04707383950482, -1055.5631415794023, -386.32817000924376, -40.28628329159283, -34.84123298821101, -136.5548607501625, -853.5577580959905, -26.246969710568344, -146.06607300217308, -190.8627329422665, -204.23624738260168, -148.11584199408034, -63.85333859227738, -223.17079515452355, -207.70014630955944, -30.92591256814382, -995.2015845938969, -191.93128540882165, -636.7822056250935, -1185.7922172518956, -22.900743879083155, -77.61126766393662, -470.64345306935945, -416.96758331514246, -125.84915097547007, -172.20909038531374, -52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206], "episode_lengths": [68, 52, 106, 54, 72, 41, 150, 43, 150, 68, 150, 150, 113, 119, 102, 76, 149, 54, 59, 99, 103, 59, 108, 96, 75, 93, 43, 55, 83, 68, 37, 48, 86, 60, 81, 66, 76, 76, 112, 127, 81, 133, 82, 95, 70, 150, 125, 121, 75, 128, 105, 150, 121, 150, 100, 58, 87, 146, 61, 127, 64, 150, 150, 55, 56, 81, 150, 52, 97, 86, 64, 79, 64, 106, 94, 54, 150, 86, 150, 150, 39, 70, 150, 150, 89, 65, 65, 116, 79, 83, 70, 95, 150, 150, 88, 150, 85, 137, 150, 75], "policy_policy_0_reward": [-68.91051573989724, -31.166227210947515, -235.3352121944515, -67.80628307727795, -139.56941686619555, -6.906452082041038, -326.3350558440053, -30.383959534971666, -531.0951005563403, -71.49672252235163, -1024.0719120353965, -906.0771415541728, -280.5800844570805, -651.6290560883292, -264.6123020356084, -303.6350547030947, -359.11191694386395, -45.60089681845388, -65.83891125888952, -278.4295808589334, -214.05234891999402, -31.230834946712662, -219.94086531303546, -141.63846044347892, -114.4535805419013, -198.48950718786884, -34.441003509725725, -55.796413662603726, -178.34853331071741, -78.09067337349221, -15.271812654152145, -22.659560515892036, -151.88635727136827, -80.632329313729, -127.37552509666057, -70.75511221056438, -112.52448252256976, -280.05298400473197, -366.37889008280007, -478.6292696103639, -160.38339786038708, -609.1099575561569, -236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944, -543.8006773738215, -47.04707383950482, -1055.5631415794023, -386.32817000924376, -40.28628329159283, -34.84123298821101, -136.5548607501625, -853.5577580959905, -26.246969710568344, -146.06607300217308, -190.8627329422665, -204.23624738260168, -148.11584199408034, -63.85333859227738, -223.17079515452355, -207.70014630955944, -30.92591256814382, -995.2015845938969, -191.93128540882165, -636.7822056250935, -1185.7922172518956, -22.900743879083155, -77.61126766393662, -470.64345306935945, -416.96758331514246, -125.84915097547007, -172.20909038531374, -52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543800759160833, "mean_inference_ms": 1.6899342876751582, "mean_action_processing_ms": 0.2729137913201316, "mean_env_wait_ms": 3.3118756442139294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214742660522461, "StateBufferConnector_ms": 0.008053779602050781, "ViewRequirementAgentConnector_ms": 0.1992778778076172}, "num_episodes": 41, "episode_return_max": -6.906452082041038, "episode_return_min": -1185.7922172518956, "episode_return_mean": -285.5660968067761, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.9272949894086, "num_env_steps_trained_throughput_per_sec": 331.9272949894086, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 11556.456, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11556.374, "sample_time_ms": 1127.608, "learn_time_ms": 10365.931, "learn_throughput": 385.879, "synch_weights_time_ms": 61.979}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "89531_00000", "date": "2024-08-05_11-25-51", "timestamp": 1722837351, "time_this_iter_s": 12.06325626373291, "time_total_s": 767.9684767723083, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644788ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.9684767723083, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.83529411764706, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.94735449353854, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.067499366728589, "policy_loss": -0.01589131545770215, "vf_loss": 1.073335683532059, "vf_explained_var": 0.9946268207083145, "kl": 0.014991647052617471, "entropy": 0.6436344921588898, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -15.643329359886724, "episode_reward_min": -1333.0878478368945, "episode_reward_mean": -319.8070052044293, "episode_len_mean": 99.96, "episode_media": {}, "episodes_timesteps_total": 9996, "policy_reward_min": {"policy_0": -1333.0878478368945}, "policy_reward_max": {"policy_0": -15.643329359886724}, "policy_reward_mean": {"policy_0": -319.8070052044293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944, -543.8006773738215, -47.04707383950482, -1055.5631415794023, -386.32817000924376, -40.28628329159283, -34.84123298821101, -136.5548607501625, -853.5577580959905, -26.246969710568344, -146.06607300217308, -190.8627329422665, -204.23624738260168, -148.11584199408034, -63.85333859227738, -223.17079515452355, -207.70014630955944, -30.92591256814382, -995.2015845938969, -191.93128540882165, -636.7822056250935, -1185.7922172518956, -22.900743879083155, -77.61126766393662, -470.64345306935945, -416.96758331514246, -125.84915097547007, -172.20909038531374, -52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206, -523.8616999251562, -36.20843270688107, -196.78105592329675, -319.8292151257138, -57.09906037911823, -133.79307786028411, -1168.2777293625084, -143.21779416931363, -218.59460167293958, -107.13903248028736, -59.42103835180596, -233.64469189509032, -79.18171141121613, -694.992231991926, -490.06353056171895, -173.52458974206954, -410.5365033469837, -373.21614050016, -940.4651751607666, -35.921984277865384, -548.4165693412905, -21.23898019537141, -280.8877830960228, -58.86797238444429, -173.82318701623777, -1333.0878478368945, -176.84509246966866, -256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116], "episode_lengths": [82, 95, 70, 150, 125, 121, 75, 128, 105, 150, 121, 150, 100, 58, 87, 146, 61, 127, 64, 150, 150, 55, 56, 81, 150, 52, 97, 86, 64, 79, 64, 106, 94, 54, 150, 86, 150, 150, 39, 70, 150, 150, 89, 65, 65, 116, 79, 83, 70, 95, 150, 150, 88, 150, 85, 137, 150, 75, 145, 47, 93, 101, 60, 76, 150, 77, 88, 69, 62, 99, 66, 150, 117, 88, 115, 147, 150, 57, 150, 35, 134, 57, 81, 150, 89, 104, 150, 126, 92, 74, 85, 69, 150, 118, 67, 66, 150, 43, 48, 56], "policy_policy_0_reward": [-236.48947861670567, -195.2989548210375, -221.25233550278097, -1154.8225929299874, -251.26333735563483, -549.481763611306, -127.22695776604633, -308.36368604588904, -235.37202639183397, -865.1583973581809, -318.4697584489682, -452.3446897647302, -161.5317563081233, -64.95542572019193, -216.1692354306454, -453.1600132597699, -50.602421737864944, -543.8006773738215, -47.04707383950482, -1055.5631415794023, -386.32817000924376, -40.28628329159283, -34.84123298821101, -136.5548607501625, -853.5577580959905, -26.246969710568344, -146.06607300217308, -190.8627329422665, -204.23624738260168, -148.11584199408034, -63.85333859227738, -223.17079515452355, -207.70014630955944, -30.92591256814382, -995.2015845938969, -191.93128540882165, -636.7822056250935, -1185.7922172518956, -22.900743879083155, -77.61126766393662, -470.64345306935945, -416.96758331514246, -125.84915097547007, -172.20909038531374, -52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206, -523.8616999251562, -36.20843270688107, -196.78105592329675, -319.8292151257138, -57.09906037911823, -133.79307786028411, -1168.2777293625084, -143.21779416931363, -218.59460167293958, -107.13903248028736, -59.42103835180596, -233.64469189509032, -79.18171141121613, -694.992231991926, -490.06353056171895, -173.52458974206954, -410.5365033469837, -373.21614050016, -940.4651751607666, -35.921984277865384, -548.4165693412905, -21.23898019537141, -280.8877830960228, -58.86797238444429, -173.82318701623777, -1333.0878478368945, -176.84509246966866, -256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548704766870176, "mean_inference_ms": 1.6891661486206626, "mean_action_processing_ms": 0.273131780877467, "mean_env_wait_ms": 3.3103107915647443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012351036071777344, "StateBufferConnector_ms": 0.007988691329956055, "ViewRequirementAgentConnector_ms": 0.19304728507995605}, "num_episodes": 42, "episode_return_max": -15.643329359886724, "episode_return_min": -1333.0878478368945, "episode_return_mean": -319.8070052044293, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.67640314698315, "num_env_steps_trained_throughput_per_sec": 325.67640314698315, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 11776.532, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11776.45, "sample_time_ms": 1127.733, "learn_time_ms": 10585.864, "learn_throughput": 377.862, "synch_weights_time_ms": 62.042}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "89531_00000", "date": "2024-08-05_11-26-03", "timestamp": 1722837363, "time_this_iter_s": 12.294452428817749, "time_total_s": 780.2629292011261, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644789750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 780.2629292011261, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.93529411764706, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.34614578733841, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0002197190498312, "policy_loss": -0.008510912834996514, "vf_loss": 1.0016991832604012, "vf_explained_var": 0.9870965635403991, "kl": 0.010517203554263718, "entropy": 0.6766746012804409, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -12.894472563087369, "episode_reward_min": -1333.0878478368945, "episode_reward_mean": -281.9996854363444, "episode_len_mean": 96.84, "episode_media": {}, "episodes_timesteps_total": 9684, "policy_reward_min": {"policy_0": -1333.0878478368945}, "policy_reward_max": {"policy_0": -12.894472563087369}, "policy_reward_mean": {"policy_0": -281.9996854363444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206, -523.8616999251562, -36.20843270688107, -196.78105592329675, -319.8292151257138, -57.09906037911823, -133.79307786028411, -1168.2777293625084, -143.21779416931363, -218.59460167293958, -107.13903248028736, -59.42103835180596, -233.64469189509032, -79.18171141121613, -694.992231991926, -490.06353056171895, -173.52458974206954, -410.5365033469837, -373.21614050016, -940.4651751607666, -35.921984277865384, -548.4165693412905, -21.23898019537141, -280.8877830960228, -58.86797238444429, -173.82318701623777, -1333.0878478368945, -176.84509246966866, -256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116, -286.98268143971626, -541.0175196591299, -266.74818955843256, -363.0530764421211, -230.17442149799544, -74.53091425818899, -436.5044213047157, -325.2889611760551, -816.202127716026, -12.894472563087369, -281.2187049313546, -171.16422152287495, -325.08721975878626, -435.113213617079, -124.12912545465815, -360.6969135216026, -246.30611680463335, -885.913732629246, -20.57871797192795, -46.18411260681363, -55.590697230087066, -16.907377463060147, -295.7573815034091, -147.82645745999432, -496.34178947682943, -78.64635053945615, -132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702], "episode_lengths": [65, 116, 79, 83, 70, 95, 150, 150, 88, 150, 85, 137, 150, 75, 145, 47, 93, 101, 60, 76, 150, 77, 88, 69, 62, 99, 66, 150, 117, 88, 115, 147, 150, 57, 150, 35, 134, 57, 81, 150, 89, 104, 150, 126, 92, 74, 85, 69, 150, 118, 67, 66, 150, 43, 48, 56, 133, 113, 106, 106, 113, 62, 150, 108, 150, 39, 107, 91, 129, 127, 76, 150, 112, 150, 40, 60, 51, 38, 98, 76, 150, 70, 89, 69, 49, 59, 61, 150, 94, 76, 73, 141, 108, 52, 45, 49, 67, 122, 133, 98], "policy_policy_0_reward": [-52.093354812852674, -275.2906604948036, -131.6319644367047, -151.25828270972727, -85.28850297961748, -257.02110778672056, -577.2226777644203, -975.824258121928, -134.61182152927742, -665.9545371214856, -177.87877105888708, -254.9016020316425, -798.4236810641496, -91.46608765235206, -523.8616999251562, -36.20843270688107, -196.78105592329675, -319.8292151257138, -57.09906037911823, -133.79307786028411, -1168.2777293625084, -143.21779416931363, -218.59460167293958, -107.13903248028736, -59.42103835180596, -233.64469189509032, -79.18171141121613, -694.992231991926, -490.06353056171895, -173.52458974206954, -410.5365033469837, -373.21614050016, -940.4651751607666, -35.921984277865384, -548.4165693412905, -21.23898019537141, -280.8877830960228, -58.86797238444429, -173.82318701623777, -1333.0878478368945, -176.84509246966866, -256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116, -286.98268143971626, -541.0175196591299, -266.74818955843256, -363.0530764421211, -230.17442149799544, -74.53091425818899, -436.5044213047157, -325.2889611760551, -816.202127716026, -12.894472563087369, -281.2187049313546, -171.16422152287495, -325.08721975878626, -435.113213617079, -124.12912545465815, -360.6969135216026, -246.30611680463335, -885.913732629246, -20.57871797192795, -46.18411260681363, -55.590697230087066, -16.907377463060147, -295.7573815034091, -147.82645745999432, -496.34178947682943, -78.64635053945615, -132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547480802923386, "mean_inference_ms": 1.6871521510479923, "mean_action_processing_ms": 0.27313376726391514, "mean_env_wait_ms": 3.3093713584077222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012038230895996094, "StateBufferConnector_ms": 0.007941246032714844, "ViewRequirementAgentConnector_ms": 0.19196581840515137}, "num_episodes": 44, "episode_return_max": -12.894472563087369, "episode_return_min": -1333.0878478368945, "episode_return_mean": -281.9996854363444, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.7526252995246, "num_env_steps_trained_throughput_per_sec": 332.7526252995246, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 11818.063, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11817.987, "sample_time_ms": 1127.613, "learn_time_ms": 10626.045, "learn_throughput": 376.434, "synch_weights_time_ms": 63.518}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "89531_00000", "date": "2024-08-05_11-26-15", "timestamp": 1722837375, "time_this_iter_s": 12.033184051513672, "time_total_s": 792.2961132526398, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 792.2961132526398, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.96470588235294, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.26809162000815, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9638146398278574, "policy_loss": -0.015920441238995407, "vf_loss": 0.9711246853073437, "vf_explained_var": 0.9943710764870047, "kl": 0.012849871223200703, "entropy": 0.6326909729745239, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": -5.774814268867448, "episode_reward_min": -992.6417474300265, "episode_reward_mean": -233.154043741648, "episode_len_mean": 93.58, "episode_media": {}, "episodes_timesteps_total": 9358, "policy_reward_min": {"policy_0": -992.6417474300265}, "policy_reward_max": {"policy_0": -5.774814268867448}, "policy_reward_mean": {"policy_0": -233.154043741648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116, -286.98268143971626, -541.0175196591299, -266.74818955843256, -363.0530764421211, -230.17442149799544, -74.53091425818899, -436.5044213047157, -325.2889611760551, -816.202127716026, -12.894472563087369, -281.2187049313546, -171.16422152287495, -325.08721975878626, -435.113213617079, -124.12912545465815, -360.6969135216026, -246.30611680463335, -885.913732629246, -20.57871797192795, -46.18411260681363, -55.590697230087066, -16.907377463060147, -295.7573815034091, -147.82645745999432, -496.34178947682943, -78.64635053945615, -132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702, -171.31614696515297, -123.66528228482385, -121.68728535759382, -207.24003129953047, -929.0141408144716, -434.49735037445186, -18.47145312241564, -336.56894002609613, -260.10444936859955, -268.8650612290559, -202.69256074256884, -349.49300529214474, -44.34313868669923, -277.8588241654008, -122.47347841240715, -78.65962835068727, -252.2341324294536, -245.4405108958575, -992.6417474300265, -194.16321009810522, -159.34019481370925, -320.49195244773466, -38.373278247981496, -104.30280068666049, -225.70909579826298, -13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077], "episode_lengths": [104, 150, 126, 92, 74, 85, 69, 150, 118, 67, 66, 150, 43, 48, 56, 133, 113, 106, 106, 113, 62, 150, 108, 150, 39, 107, 91, 129, 127, 76, 150, 112, 150, 40, 60, 51, 38, 98, 76, 150, 70, 89, 69, 49, 59, 61, 150, 94, 76, 73, 141, 108, 52, 45, 49, 67, 122, 133, 98, 96, 69, 81, 92, 150, 150, 45, 122, 117, 116, 88, 150, 56, 121, 74, 62, 113, 89, 150, 92, 100, 135, 48, 82, 100, 39, 70, 126, 94, 65, 37, 70, 85, 91, 109, 68, 89, 46, 82, 102, 149], "policy_policy_0_reward": [-256.0798934625716, -939.0287909702649, -283.46871801454347, -166.1651456708053, -118.89192619782861, -347.15895111154344, -89.41678893537987, -548.8820445829772, -424.72129257323786, -90.02859511306255, -62.959230419133064, -438.49564629863704, -15.643329359886724, -29.09508936349914, -55.85237079813116, -286.98268143971626, -541.0175196591299, -266.74818955843256, -363.0530764421211, -230.17442149799544, -74.53091425818899, -436.5044213047157, -325.2889611760551, -816.202127716026, -12.894472563087369, -281.2187049313546, -171.16422152287495, -325.08721975878626, -435.113213617079, -124.12912545465815, -360.6969135216026, -246.30611680463335, -885.913732629246, -20.57871797192795, -46.18411260681363, -55.590697230087066, -16.907377463060147, -295.7573815034091, -147.82645745999432, -496.34178947682943, -78.64635053945615, -132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702, -171.31614696515297, -123.66528228482385, -121.68728535759382, -207.24003129953047, -929.0141408144716, -434.49735037445186, -18.47145312241564, -336.56894002609613, -260.10444936859955, -268.8650612290559, -202.69256074256884, -349.49300529214474, -44.34313868669923, -277.8588241654008, -122.47347841240715, -78.65962835068727, -252.2341324294536, -245.4405108958575, -992.6417474300265, -194.16321009810522, -159.34019481370925, -320.49195244773466, -38.373278247981496, -104.30280068666049, -225.70909579826298, -13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547722889467772, "mean_inference_ms": 1.687464459687126, "mean_action_processing_ms": 0.2731017422888622, "mean_env_wait_ms": 3.309881784829953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687278747558594, "StateBufferConnector_ms": 0.007843255996704102, "ViewRequirementAgentConnector_ms": 0.1910407543182373}, "num_episodes": 41, "episode_return_max": -5.774814268867448, "episode_return_min": -992.6417474300265, "episode_return_mean": -233.154043741648, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.5251833225038, "num_env_steps_trained_throughput_per_sec": 369.5251833225038, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 11808.787, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11808.71, "sample_time_ms": 1130.23, "learn_time_ms": 10613.543, "learn_throughput": 376.877, "synch_weights_time_ms": 64.109}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "89531_00000", "date": "2024-08-05_11-26-26", "timestamp": 1722837386, "time_this_iter_s": 10.836440563201904, "time_total_s": 803.1325538158417, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447167a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 803.1325538158417, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.4375, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.2389844318231, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8004796552937478, "policy_loss": -0.01400196325169721, "vf_loss": 0.803364314744249, "vf_explained_var": 0.9990384702881178, "kl": 0.016569658753481584, "entropy": 0.6721585842470328, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -5.774814268867448, "episode_reward_min": -1186.2336864564088, "episode_reward_mean": -257.91133321258746, "episode_len_mean": 93.97, "episode_media": {}, "episodes_timesteps_total": 9397, "policy_reward_min": {"policy_0": -1186.2336864564088}, "policy_reward_max": {"policy_0": -5.774814268867448}, "policy_reward_mean": {"policy_0": -257.91133321258746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702, -171.31614696515297, -123.66528228482385, -121.68728535759382, -207.24003129953047, -929.0141408144716, -434.49735037445186, -18.47145312241564, -336.56894002609613, -260.10444936859955, -268.8650612290559, -202.69256074256884, -349.49300529214474, -44.34313868669923, -277.8588241654008, -122.47347841240715, -78.65962835068727, -252.2341324294536, -245.4405108958575, -992.6417474300265, -194.16321009810522, -159.34019481370925, -320.49195244773466, -38.373278247981496, -104.30280068666049, -225.70909579826298, -13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077, -186.98751382461944, -317.35517323144285, -1065.1856005858942, -10.477354884065585, -70.26905055588055, -217.5226996848749, -739.6419732256976, -33.75665257934159, -89.77352480672882, -683.398999723186, -1142.286795528906, -51.96940267766906, -90.23658726766321, -291.72730699804407, -172.50035997976977, -473.1659977114236, -32.815981308753635, -77.60683540855601, -134.9212402791816, -37.43736291214134, -103.7522822311261, -282.5096695375244, -15.744464988605502, -100.62109732729432, -579.0022779892626, -140.44319201149364, -1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158], "episode_lengths": [89, 69, 49, 59, 61, 150, 94, 76, 73, 141, 108, 52, 45, 49, 67, 122, 133, 98, 96, 69, 81, 92, 150, 150, 45, 122, 117, 116, 88, 150, 56, 121, 74, 62, 113, 89, 150, 92, 100, 135, 48, 82, 100, 39, 70, 126, 94, 65, 37, 70, 85, 91, 109, 68, 89, 46, 82, 102, 149, 89, 124, 150, 41, 68, 99, 150, 58, 56, 150, 150, 54, 67, 98, 134, 150, 53, 58, 76, 47, 71, 98, 38, 80, 150, 97, 150, 121, 129, 86, 150, 107, 91, 103, 150, 150, 53, 57, 118, 69, 102], "policy_policy_0_reward": [-132.41406152586953, -117.55927801499662, -80.85250810535017, -189.06905971065373, -77.29482973462936, -421.6650354279955, -403.1126393202275, -190.07971504284876, -172.57326163309997, -362.2352493432955, -311.52353956997945, -31.843244191386002, -33.073733701000855, -42.88063054333703, -83.56425492607487, -177.91626989168984, -326.83786587109256, -220.92259735252702, -171.31614696515297, -123.66528228482385, -121.68728535759382, -207.24003129953047, -929.0141408144716, -434.49735037445186, -18.47145312241564, -336.56894002609613, -260.10444936859955, -268.8650612290559, -202.69256074256884, -349.49300529214474, -44.34313868669923, -277.8588241654008, -122.47347841240715, -78.65962835068727, -252.2341324294536, -245.4405108958575, -992.6417474300265, -194.16321009810522, -159.34019481370925, -320.49195244773466, -38.373278247981496, -104.30280068666049, -225.70909579826298, -13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077, -186.98751382461944, -317.35517323144285, -1065.1856005858942, -10.477354884065585, -70.26905055588055, -217.5226996848749, -739.6419732256976, -33.75665257934159, -89.77352480672882, -683.398999723186, -1142.286795528906, -51.96940267766906, -90.23658726766321, -291.72730699804407, -172.50035997976977, -473.1659977114236, -32.815981308753635, -77.60683540855601, -134.9212402791816, -37.43736291214134, -103.7522822311261, -282.5096695375244, -15.744464988605502, -100.62109732729432, -579.0022779892626, -140.44319201149364, -1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542569016762682, "mean_inference_ms": 1.6861231385487099, "mean_action_processing_ms": 0.2729505398493071, "mean_env_wait_ms": 3.3083856527184228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01163792610168457, "StateBufferConnector_ms": 0.0077571868896484375, "ViewRequirementAgentConnector_ms": 0.18857836723327637}, "num_episodes": 41, "episode_return_max": -5.774814268867448, "episode_return_min": -1186.2336864564088, "episode_return_mean": -257.91133321258746, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.9424627491777, "num_env_steps_trained_throughput_per_sec": 336.9424627491777, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 11997.566, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11997.489, "sample_time_ms": 1129.109, "learn_time_ms": 10803.372, "learn_throughput": 370.255, "synch_weights_time_ms": 64.18}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "89531_00000", "date": "2024-08-05_11-26-38", "timestamp": 1722837398, "time_this_iter_s": 11.883756637573242, "time_total_s": 815.0163104534149, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d664336f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 815.0163104534149, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.852941176470587, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.65369503696759, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7957871771262338, "policy_loss": -0.010068292274081615, "vf_loss": 0.7978818873564403, "vf_explained_var": 0.9956921447689334, "kl": 0.011912875908941157, "entropy": 0.676085806141297, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -1.6158345799196714, "episode_reward_min": -1329.7425060858525, "episode_reward_mean": -298.63538302844586, "episode_len_mean": 95.19, "episode_media": {}, "episodes_timesteps_total": 9519, "policy_reward_min": {"policy_0": -1329.7425060858525}, "policy_reward_max": {"policy_0": -1.6158345799196714}, "policy_reward_mean": {"policy_0": -298.63538302844586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077, -186.98751382461944, -317.35517323144285, -1065.1856005858942, -10.477354884065585, -70.26905055588055, -217.5226996848749, -739.6419732256976, -33.75665257934159, -89.77352480672882, -683.398999723186, -1142.286795528906, -51.96940267766906, -90.23658726766321, -291.72730699804407, -172.50035997976977, -473.1659977114236, -32.815981308753635, -77.60683540855601, -134.9212402791816, -37.43736291214134, -103.7522822311261, -282.5096695375244, -15.744464988605502, -100.62109732729432, -579.0022779892626, -140.44319201149364, -1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158, -1151.3203277491634, -363.9279613492841, -957.7967966061008, -556.2328911839628, -39.749572757685264, -1314.557206335824, -114.52251610524918, -1.6158345799196714, -27.14175437005656, -1329.7425060858525, -64.82331038863191, -285.4120989495084, -415.6322609257791, -680.6956079992052, -367.679019084502, -164.23794384619276, -353.9895234120687, -265.807015203784, -351.4472500432506, -212.5322568546231, -228.25782148482116, -116.887887082989, -75.96372119172125, -371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413], "episode_lengths": [39, 70, 126, 94, 65, 37, 70, 85, 91, 109, 68, 89, 46, 82, 102, 149, 89, 124, 150, 41, 68, 99, 150, 58, 56, 150, 150, 54, 67, 98, 134, 150, 53, 58, 76, 47, 71, 98, 38, 80, 150, 97, 150, 121, 129, 86, 150, 107, 91, 103, 150, 150, 53, 57, 118, 69, 102, 150, 116, 150, 150, 60, 150, 71, 34, 53, 150, 58, 112, 92, 118, 132, 105, 150, 97, 140, 112, 112, 76, 62, 150, 45, 79, 51, 38, 150, 68, 66, 83, 53, 150, 96, 79, 71, 150, 61, 59, 44, 62, 150], "policy_policy_0_reward": [-13.759248746902427, -84.33244194423365, -321.89624087889797, -253.47713504321294, -173.3341766735549, -5.774814268867448, -81.26794227502047, -154.75718397900997, -171.1833962237807, -232.25129938587227, -100.99237186872, -206.79504608450742, -41.025071080940386, -103.35037425106412, -192.41262093794847, -116.98280629753077, -186.98751382461944, -317.35517323144285, -1065.1856005858942, -10.477354884065585, -70.26905055588055, -217.5226996848749, -739.6419732256976, -33.75665257934159, -89.77352480672882, -683.398999723186, -1142.286795528906, -51.96940267766906, -90.23658726766321, -291.72730699804407, -172.50035997976977, -473.1659977114236, -32.815981308753635, -77.60683540855601, -134.9212402791816, -37.43736291214134, -103.7522822311261, -282.5096695375244, -15.744464988605502, -100.62109732729432, -579.0022779892626, -140.44319201149364, -1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158, -1151.3203277491634, -363.9279613492841, -957.7967966061008, -556.2328911839628, -39.749572757685264, -1314.557206335824, -114.52251610524918, -1.6158345799196714, -27.14175437005656, -1329.7425060858525, -64.82331038863191, -285.4120989495084, -415.6322609257791, -680.6956079992052, -367.679019084502, -164.23794384619276, -353.9895234120687, -265.807015203784, -351.4472500432506, -212.5322568546231, -228.25782148482116, -116.887887082989, -75.96372119172125, -371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547159662231768, "mean_inference_ms": 1.686267922426195, "mean_action_processing_ms": 0.2729438109509497, "mean_env_wait_ms": 3.31012930149429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011980533599853516, "StateBufferConnector_ms": 0.007910966873168945, "ViewRequirementAgentConnector_ms": 0.192277193069458}, "num_episodes": 43, "episode_return_max": -1.6158345799196714, "episode_return_min": -1329.7425060858525, "episode_return_mean": -298.63538302844586, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.82383008091284, "num_env_steps_trained_throughput_per_sec": 326.82383008091284, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 12012.656, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12012.577, "sample_time_ms": 1136.759, "learn_time_ms": 10810.232, "learn_throughput": 370.02, "synch_weights_time_ms": 64.762}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "89531_00000", "date": "2024-08-05_11-26-50", "timestamp": 1722837410, "time_this_iter_s": 12.252214431762695, "time_total_s": 827.2685248851776, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.2685248851776, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.13529411764706, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.41741395990054, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8630103384299824, "policy_loss": -0.007663628342561424, "vf_loss": 0.8635001343674957, "vf_explained_var": 0.9936387511591117, "kl": 0.010722422382120124, "entropy": 0.638044101310273, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": -1.6158345799196714, "episode_reward_min": -1329.7425060858525, "episode_reward_mean": -319.3921021029034, "episode_len_mean": 97.14, "episode_media": {}, "episodes_timesteps_total": 9714, "policy_reward_min": {"policy_0": -1329.7425060858525}, "policy_reward_max": {"policy_0": -1.6158345799196714}, "policy_reward_mean": {"policy_0": -319.3921021029034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158, -1151.3203277491634, -363.9279613492841, -957.7967966061008, -556.2328911839628, -39.749572757685264, -1314.557206335824, -114.52251610524918, -1.6158345799196714, -27.14175437005656, -1329.7425060858525, -64.82331038863191, -285.4120989495084, -415.6322609257791, -680.6956079992052, -367.679019084502, -164.23794384619276, -353.9895234120687, -265.807015203784, -351.4472500432506, -212.5322568546231, -228.25782148482116, -116.887887082989, -75.96372119172125, -371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413, -212.26412098611365, -76.11084298036992, -163.49109265486933, -623.873572467558, -58.625294271186775, -87.42362276733557, -4.642437881558633, -142.72688754885056, -194.90182779536698, -64.73491318822053, -53.79245819624061, -107.82126414335833, -365.3250561494826, -285.89265732867517, -277.5171690901406, -25.18185775131072, -1283.3454561535502, -84.24277145997208, -241.11563049677147, -238.61688039883265, -296.75465973133373, -142.07277154218272, -428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498], "episode_lengths": [150, 121, 129, 86, 150, 107, 91, 103, 150, 150, 53, 57, 118, 69, 102, 150, 116, 150, 150, 60, 150, 71, 34, 53, 150, 58, 112, 92, 118, 132, 105, 150, 97, 140, 112, 112, 76, 62, 150, 45, 79, 51, 38, 150, 68, 66, 83, 53, 150, 96, 79, 71, 150, 61, 59, 44, 62, 150, 102, 67, 86, 146, 54, 62, 36, 68, 98, 64, 57, 74, 98, 100, 119, 47, 150, 69, 100, 109, 79, 91, 150, 103, 150, 78, 90, 107, 33, 115, 150, 77, 101, 145, 116, 43, 150, 121, 94, 75, 88, 61], "policy_policy_0_reward": [-1094.5892183525282, -306.865505212361, -331.57561074763737, -201.87300824918174, -1134.7429992140455, -343.34774622667396, -148.1619687501545, -292.6333218717124, -901.7037223878885, -1186.2336864564088, -43.82831122753069, -33.31371550440218, -245.83572841900394, -103.03107728701214, -173.63066090705158, -1151.3203277491634, -363.9279613492841, -957.7967966061008, -556.2328911839628, -39.749572757685264, -1314.557206335824, -114.52251610524918, -1.6158345799196714, -27.14175437005656, -1329.7425060858525, -64.82331038863191, -285.4120989495084, -415.6322609257791, -680.6956079992052, -367.679019084502, -164.23794384619276, -353.9895234120687, -265.807015203784, -351.4472500432506, -212.5322568546231, -228.25782148482116, -116.887887082989, -75.96372119172125, -371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413, -212.26412098611365, -76.11084298036992, -163.49109265486933, -623.873572467558, -58.625294271186775, -87.42362276733557, -4.642437881558633, -142.72688754885056, -194.90182779536698, -64.73491318822053, -53.79245819624061, -107.82126414335833, -365.3250561494826, -285.89265732867517, -277.5171690901406, -25.18185775131072, -1283.3454561535502, -84.24277145997208, -241.11563049677147, -238.61688039883265, -296.75465973133373, -142.07277154218272, -428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551236309696154, "mean_inference_ms": 1.6859974423619741, "mean_action_processing_ms": 0.2730608088394016, "mean_env_wait_ms": 3.3132651278975573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012303352355957031, "StateBufferConnector_ms": 0.007963895797729492, "ViewRequirementAgentConnector_ms": 0.19379353523254395}, "num_episodes": 42, "episode_return_max": -1.6158345799196714, "episode_return_min": -1329.7425060858525, "episode_return_mean": -319.3921021029034, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.8905882955755, "num_env_steps_trained_throughput_per_sec": 413.8905882955755, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 11740.904, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11740.826, "sample_time_ms": 1135.774, "learn_time_ms": 10540.563, "learn_throughput": 379.486, "synch_weights_time_ms": 63.682}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "89531_00000", "date": "2024-08-05_11-27-00", "timestamp": 1722837420, "time_this_iter_s": 9.675135850906372, "time_total_s": 836.943660736084, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644789cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 836.943660736084, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.771428571428572, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.30272198120753, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.815834971848138, "policy_loss": -0.01469745245121885, "vf_loss": 0.8204404313427707, "vf_explained_var": 0.9964528363818924, "kl": 0.015006895662979029, "entropy": 0.37662144085237137, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -1.741925598753515, "episode_reward_min": -1283.3454561535502, "episode_reward_mean": -279.8925657401667, "episode_len_mean": 93.99, "episode_media": {}, "episodes_timesteps_total": 9399, "policy_reward_min": {"policy_0": -1283.3454561535502}, "policy_reward_max": {"policy_0": -1.741925598753515}, "policy_reward_mean": {"policy_0": -279.8925657401667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413, -212.26412098611365, -76.11084298036992, -163.49109265486933, -623.873572467558, -58.625294271186775, -87.42362276733557, -4.642437881558633, -142.72688754885056, -194.90182779536698, -64.73491318822053, -53.79245819624061, -107.82126414335833, -365.3250561494826, -285.89265732867517, -277.5171690901406, -25.18185775131072, -1283.3454561535502, -84.24277145997208, -241.11563049677147, -238.61688039883265, -296.75465973133373, -142.07277154218272, -428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498, -417.182698890002, -144.6388939139677, -520.1962459571149, -211.49269520191322, -86.69928470595706, -308.0133018030098, -305.911986896068, -571.958334589692, -182.02687691143882, -86.7430761205146, -140.74095221851294, -113.69443200400553, -195.6879439392659, -1242.866698184984, -149.28787978954213, -350.77407516690243, -291.7019571736428, -161.80834573390163, -62.08910171165391, -476.76077590385324, -1049.0699347153193, -99.72436345094683, -225.60414940715725, -107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067], "episode_lengths": [150, 45, 79, 51, 38, 150, 68, 66, 83, 53, 150, 96, 79, 71, 150, 61, 59, 44, 62, 150, 102, 67, 86, 146, 54, 62, 36, 68, 98, 64, 57, 74, 98, 100, 119, 47, 150, 69, 100, 109, 79, 91, 150, 103, 150, 78, 90, 107, 33, 115, 150, 77, 101, 145, 116, 43, 150, 121, 94, 75, 88, 61, 150, 83, 150, 89, 75, 82, 119, 137, 84, 72, 76, 66, 106, 150, 88, 112, 119, 85, 58, 150, 150, 68, 88, 83, 58, 77, 150, 39, 150, 67, 90, 46, 112, 150, 150, 92, 81, 69], "policy_policy_0_reward": [-371.3416283382139, -16.229331117538056, -144.82671399992262, -35.98051472178586, -4.127046217598894, -742.6610730497249, -92.17436088871099, -117.24064588386797, -129.0455608302119, -44.10908109774662, -575.2577762461207, -253.22138434380992, -143.1595967250173, -129.06619404049817, -1008.5221331956018, -71.45839741083445, -63.47404660654452, -31.313379986453647, -75.38043039806264, -438.9080761433413, -212.26412098611365, -76.11084298036992, -163.49109265486933, -623.873572467558, -58.625294271186775, -87.42362276733557, -4.642437881558633, -142.72688754885056, -194.90182779536698, -64.73491318822053, -53.79245819624061, -107.82126414335833, -365.3250561494826, -285.89265732867517, -277.5171690901406, -25.18185775131072, -1283.3454561535502, -84.24277145997208, -241.11563049677147, -238.61688039883265, -296.75465973133373, -142.07277154218272, -428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498, -417.182698890002, -144.6388939139677, -520.1962459571149, -211.49269520191322, -86.69928470595706, -308.0133018030098, -305.911986896068, -571.958334589692, -182.02687691143882, -86.7430761205146, -140.74095221851294, -113.69443200400553, -195.6879439392659, -1242.866698184984, -149.28787978954213, -350.77407516690243, -291.7019571736428, -161.80834573390163, -62.08910171165391, -476.76077590385324, -1049.0699347153193, -99.72436345094683, -225.60414940715725, -107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551367508354187, "mean_inference_ms": 1.6856889427366593, "mean_action_processing_ms": 0.2730515053319152, "mean_env_wait_ms": 3.3103800999713453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012315988540649414, "StateBufferConnector_ms": 0.007938623428344727, "ViewRequirementAgentConnector_ms": 0.22280669212341309}, "num_episodes": 38, "episode_return_max": -1.741925598753515, "episode_return_min": -1283.3454561535502, "episode_return_mean": -279.8925657401667, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.12908872803854, "num_env_steps_trained_throughput_per_sec": 382.12908872803854, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 11506.036, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11505.958, "sample_time_ms": 1148.886, "learn_time_ms": 10293.396, "learn_throughput": 388.599, "synch_weights_time_ms": 62.866}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "89531_00000", "date": "2024-08-05_11-27-10", "timestamp": 1722837430, "time_this_iter_s": 10.479186296463013, "time_total_s": 847.422847032547, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644789f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.422847032547, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.026666666666667, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.72229280173778, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9155810240656137, "policy_loss": -0.011517324682305723, "vf_loss": 0.9178434753014396, "vf_explained_var": 0.9917849086225032, "kl": 0.01379730994549396, "entropy": 0.5830874084650228, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": 5.935226458236362, "episode_reward_min": -1242.866698184984, "episode_reward_mean": -294.37157615973524, "episode_len_mean": 98.42, "episode_media": {}, "episodes_timesteps_total": 9842, "policy_reward_min": {"policy_0": -1242.866698184984}, "policy_reward_max": {"policy_0": 5.935226458236362}, "policy_reward_mean": {"policy_0": -294.37157615973524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498, -417.182698890002, -144.6388939139677, -520.1962459571149, -211.49269520191322, -86.69928470595706, -308.0133018030098, -305.911986896068, -571.958334589692, -182.02687691143882, -86.7430761205146, -140.74095221851294, -113.69443200400553, -195.6879439392659, -1242.866698184984, -149.28787978954213, -350.77407516690243, -291.7019571736428, -161.80834573390163, -62.08910171165391, -476.76077590385324, -1049.0699347153193, -99.72436345094683, -225.60414940715725, -107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067, -282.2093593780044, -353.7077668701986, -332.2257053885696, -71.9444111996807, -19.88691155213381, -472.1004098305309, -257.06400235544464, -106.52365559951059, -21.068708142802976, -167.12640072013699, -264.53495743029316, -939.2622470948029, -833.2554153122198, -163.1534854464768, -204.5907449171841, 5.935226458236362, -157.23859218523927, -788.7717072040398, -71.45685646623055, -164.84860521353454, -106.62333864478393, -231.93195392248128, -362.33220000853055, -165.8328984071975, -146.03918916074215, -62.11180853989869, -218.09016196076715, -45.788122707643296, -278.29237521319504, -150.9574989578573, -865.5860822823712, -83.81248281065335, -116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365], "episode_lengths": [150, 103, 150, 78, 90, 107, 33, 115, 150, 77, 101, 145, 116, 43, 150, 121, 94, 75, 88, 61, 150, 83, 150, 89, 75, 82, 119, 137, 84, 72, 76, 66, 106, 150, 88, 112, 119, 85, 58, 150, 150, 68, 88, 83, 58, 77, 150, 39, 150, 67, 90, 46, 112, 150, 150, 92, 81, 69, 121, 130, 147, 71, 42, 127, 116, 68, 45, 87, 116, 150, 150, 102, 69, 29, 83, 150, 57, 80, 90, 90, 150, 89, 78, 69, 88, 63, 101, 94, 150, 74, 73, 150, 54, 108, 129, 87, 115, 60, 73, 99], "policy_policy_0_reward": [-428.02065610775657, -238.2143954492864, -939.3549520188147, -150.6109765193569, -152.50473952801772, -252.13099314261157, -3.730340435894589, -233.50982411735905, -975.6496694342125, -141.76189277038475, -222.7143686276262, -698.704991284662, -239.71085996943285, -29.036941100704794, -928.1676783787286, -286.2457010170198, -168.50137055441036, -114.10803903889642, -161.77704864235395, -75.44479152415498, -417.182698890002, -144.6388939139677, -520.1962459571149, -211.49269520191322, -86.69928470595706, -308.0133018030098, -305.911986896068, -571.958334589692, -182.02687691143882, -86.7430761205146, -140.74095221851294, -113.69443200400553, -195.6879439392659, -1242.866698184984, -149.28787978954213, -350.77407516690243, -291.7019571736428, -161.80834573390163, -62.08910171165391, -476.76077590385324, -1049.0699347153193, -99.72436345094683, -225.60414940715725, -107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067, -282.2093593780044, -353.7077668701986, -332.2257053885696, -71.9444111996807, -19.88691155213381, -472.1004098305309, -257.06400235544464, -106.52365559951059, -21.068708142802976, -167.12640072013699, -264.53495743029316, -939.2622470948029, -833.2554153122198, -163.1534854464768, -204.5907449171841, 5.935226458236362, -157.23859218523927, -788.7717072040398, -71.45685646623055, -164.84860521353454, -106.62333864478393, -231.93195392248128, -362.33220000853055, -165.8328984071975, -146.03918916074215, -62.11180853989869, -218.09016196076715, -45.788122707643296, -278.29237521319504, -150.9574989578573, -865.5860822823712, -83.81248281065335, -116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551525220193289, "mean_inference_ms": 1.6864725168068295, "mean_action_processing_ms": 0.27326716075568547, "mean_env_wait_ms": 3.3100360173739363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012317657470703125, "StateBufferConnector_ms": 0.007821321487426758, "ViewRequirementAgentConnector_ms": 0.22365713119506836}, "num_episodes": 42, "episode_return_max": 5.935226458236362, "episode_return_min": -1242.866698184984, "episode_return_mean": -294.37157615973524, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.10502015444507, "num_env_steps_trained_throughput_per_sec": 362.10502015444507, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 11531.765, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11531.69, "sample_time_ms": 1139.354, "learn_time_ms": 10330.528, "learn_throughput": 387.202, "synch_weights_time_ms": 61.004}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "89531_00000", "date": "2024-08-05_11-27-22", "timestamp": 1722837442, "time_this_iter_s": 11.058238744735718, "time_total_s": 858.4810857772827, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478b880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 858.4810857772827, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.5375, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.80981474618117, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.90046981984439, "policy_loss": -0.011957635232344424, "vf_loss": 0.903347711202999, "vf_explained_var": 0.993932011226813, "kl": 0.013533635124834636, "entropy": 0.5545731562500199, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 5.935226458236362, "episode_reward_min": -1134.4171171332446, "episode_reward_mean": -264.7082272670904, "episode_len_mean": 96.11, "episode_media": {}, "episodes_timesteps_total": 9611, "policy_reward_min": {"policy_0": -1134.4171171332446}, "policy_reward_max": {"policy_0": 5.935226458236362}, "policy_reward_mean": {"policy_0": -264.7082272670904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067, -282.2093593780044, -353.7077668701986, -332.2257053885696, -71.9444111996807, -19.88691155213381, -472.1004098305309, -257.06400235544464, -106.52365559951059, -21.068708142802976, -167.12640072013699, -264.53495743029316, -939.2622470948029, -833.2554153122198, -163.1534854464768, -204.5907449171841, 5.935226458236362, -157.23859218523927, -788.7717072040398, -71.45685646623055, -164.84860521353454, -106.62333864478393, -231.93195392248128, -362.33220000853055, -165.8328984071975, -146.03918916074215, -62.11180853989869, -218.09016196076715, -45.788122707643296, -278.29237521319504, -150.9574989578573, -865.5860822823712, -83.81248281065335, -116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365, -539.8602024666827, -217.28068941481095, -141.0154978374183, -214.552741305133, -32.4095764722191, -262.2213063549503, -215.79206671059032, -301.7946594114449, -243.45227125918038, -503.4440445497611, -199.34560915192733, -161.14471184644563, -174.65053983422516, -214.25051972015348, -12.506776705187763, -317.6697380470345, -771.32344980882, -254.3236052311651, -38.09801629836896, -54.209530718285734, -419.53776291133755, -359.6879409533477, -413.1684081148496, -538.9963626137896, -135.98860893678693, -619.9108534910102, -28.32509463275782, -843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058], "episode_lengths": [83, 58, 77, 150, 39, 150, 67, 90, 46, 112, 150, 150, 92, 81, 69, 121, 130, 147, 71, 42, 127, 116, 68, 45, 87, 116, 150, 150, 102, 69, 29, 83, 150, 57, 80, 90, 90, 150, 89, 78, 69, 88, 63, 101, 94, 150, 74, 73, 150, 54, 108, 129, 87, 115, 60, 73, 99, 150, 105, 91, 102, 57, 104, 76, 105, 70, 150, 83, 84, 92, 104, 40, 126, 150, 116, 53, 54, 150, 114, 115, 150, 75, 150, 49, 150, 53, 98, 91, 108, 110, 75, 105, 54, 144, 94, 62, 150, 48, 39, 77], "policy_policy_0_reward": [-107.61082866155309, -46.199320541584115, -152.85197255086015, -535.9359560997549, -1.741925598753515, -473.88552655139665, -93.27597109988453, -229.0389090100946, -12.561320868807506, -306.33891772904366, -1033.339937805108, -1134.4171171332446, -231.09379680243242, -151.0799060963971, -127.3403171918067, -282.2093593780044, -353.7077668701986, -332.2257053885696, -71.9444111996807, -19.88691155213381, -472.1004098305309, -257.06400235544464, -106.52365559951059, -21.068708142802976, -167.12640072013699, -264.53495743029316, -939.2622470948029, -833.2554153122198, -163.1534854464768, -204.5907449171841, 5.935226458236362, -157.23859218523927, -788.7717072040398, -71.45685646623055, -164.84860521353454, -106.62333864478393, -231.93195392248128, -362.33220000853055, -165.8328984071975, -146.03918916074215, -62.11180853989869, -218.09016196076715, -45.788122707643296, -278.29237521319504, -150.9574989578573, -865.5860822823712, -83.81248281065335, -116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365, -539.8602024666827, -217.28068941481095, -141.0154978374183, -214.552741305133, -32.4095764722191, -262.2213063549503, -215.79206671059032, -301.7946594114449, -243.45227125918038, -503.4440445497611, -199.34560915192733, -161.14471184644563, -174.65053983422516, -214.25051972015348, -12.506776705187763, -317.6697380470345, -771.32344980882, -254.3236052311651, -38.09801629836896, -54.209530718285734, -419.53776291133755, -359.6879409533477, -413.1684081148496, -538.9963626137896, -135.98860893678693, -619.9108534910102, -28.32509463275782, -843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553659386061982, "mean_inference_ms": 1.6855608435014489, "mean_action_processing_ms": 0.2731512328022027, "mean_env_wait_ms": 3.3099477751362008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012485504150390625, "StateBufferConnector_ms": 0.007848739624023438, "ViewRequirementAgentConnector_ms": 0.20303583145141602}, "num_episodes": 43, "episode_return_max": 5.935226458236362, "episode_return_min": -1134.4171171332446, "episode_return_mean": -264.7082272670904, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.7637191808224, "num_env_steps_trained_throughput_per_sec": 393.7637191808224, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 11262.618, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11262.546, "sample_time_ms": 1122.978, "learn_time_ms": 10076.641, "learn_throughput": 396.958, "synch_weights_time_ms": 62.122}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "89531_00000", "date": "2024-08-05_11-27-32", "timestamp": 1722837452, "time_this_iter_s": 10.170443773269653, "time_total_s": 868.6515295505524, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644788790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 868.6515295505524, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.04285714285714, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.71504096786181, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9421765392413363, "policy_loss": -0.00904878613606949, "vf_loss": 0.9375239326929052, "vf_explained_var": 0.9958705119167764, "kl": 0.020378166352566042, "entropy": 0.5387040260558327, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -12.14658160545436, "episode_reward_min": -880.1151034052655, "episode_reward_mean": -245.01598689178616, "episode_len_mean": 94.59, "episode_media": {}, "episodes_timesteps_total": 9459, "policy_reward_min": {"policy_0": -880.1151034052655}, "policy_reward_max": {"policy_0": -12.14658160545436}, "policy_reward_mean": {"policy_0": -245.01598689178616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365, -539.8602024666827, -217.28068941481095, -141.0154978374183, -214.552741305133, -32.4095764722191, -262.2213063549503, -215.79206671059032, -301.7946594114449, -243.45227125918038, -503.4440445497611, -199.34560915192733, -161.14471184644563, -174.65053983422516, -214.25051972015348, -12.506776705187763, -317.6697380470345, -771.32344980882, -254.3236052311651, -38.09801629836896, -54.209530718285734, -419.53776291133755, -359.6879409533477, -413.1684081148496, -538.9963626137896, -135.98860893678693, -619.9108534910102, -28.32509463275782, -843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058, -204.27782723963955, -147.682329043109, -170.58938786672317, -257.47090611331487, -142.73549458366261, -294.7064002089696, -177.29379585569274, -169.1940419872808, -43.67007552213195, -65.07799460128318, -782.7946867957087, -551.0564040072315, -609.2713932166547, -434.9863613546249, -53.81428591958205, -257.67802454976135, -67.87705091613068, -880.1151034052655, -207.45616843882638, -18.27165292153967, -380.0389438496724, -71.60224584610505, -231.20377163268282, -24.77495080573824, -121.52710792428095, -48.99417075285317, -142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558], "episode_lengths": [73, 150, 54, 108, 129, 87, 115, 60, 73, 99, 150, 105, 91, 102, 57, 104, 76, 105, 70, 150, 83, 84, 92, 104, 40, 126, 150, 116, 53, 54, 150, 114, 115, 150, 75, 150, 49, 150, 53, 98, 91, 108, 110, 75, 105, 54, 144, 94, 62, 150, 48, 39, 77, 104, 92, 88, 118, 73, 106, 65, 89, 56, 66, 150, 150, 150, 150, 63, 97, 59, 150, 96, 38, 150, 59, 98, 54, 71, 51, 79, 60, 92, 90, 119, 108, 92, 81, 150, 45, 73, 150, 101, 104, 150, 72, 73, 54, 105, 58, 39], "policy_policy_0_reward": [-116.17538753849199, -549.8197988061033, -98.83176550825875, -222.71245188108446, -358.71539035464315, -196.21572416214448, -606.1778580880581, -90.60052011975375, -130.6616629029844, -213.52827035531365, -539.8602024666827, -217.28068941481095, -141.0154978374183, -214.552741305133, -32.4095764722191, -262.2213063549503, -215.79206671059032, -301.7946594114449, -243.45227125918038, -503.4440445497611, -199.34560915192733, -161.14471184644563, -174.65053983422516, -214.25051972015348, -12.506776705187763, -317.6697380470345, -771.32344980882, -254.3236052311651, -38.09801629836896, -54.209530718285734, -419.53776291133755, -359.6879409533477, -413.1684081148496, -538.9963626137896, -135.98860893678693, -619.9108534910102, -28.32509463275782, -843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058, -204.27782723963955, -147.682329043109, -170.58938786672317, -257.47090611331487, -142.73549458366261, -294.7064002089696, -177.29379585569274, -169.1940419872808, -43.67007552213195, -65.07799460128318, -782.7946867957087, -551.0564040072315, -609.2713932166547, -434.9863613546249, -53.81428591958205, -257.67802454976135, -67.87705091613068, -880.1151034052655, -207.45616843882638, -18.27165292153967, -380.0389438496724, -71.60224584610505, -231.20377163268282, -24.77495080573824, -121.52710792428095, -48.99417075285317, -142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556070523072997, "mean_inference_ms": 1.6856990068843891, "mean_action_processing_ms": 0.2732347976739017, "mean_env_wait_ms": 3.31075791096782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012442350387573242, "StateBufferConnector_ms": 0.007843255996704102, "ViewRequirementAgentConnector_ms": 0.19258999824523926}, "num_episodes": 47, "episode_return_max": -12.14658160545436, "episode_return_min": -880.1151034052655, "episode_return_mean": -245.01598689178616, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.3495552278943, "num_env_steps_trained_throughput_per_sec": 315.3495552278943, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 11325.97, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11325.892, "sample_time_ms": 1122.152, "learn_time_ms": 10141.557, "learn_throughput": 394.417, "synch_weights_time_ms": 61.373}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "89531_00000", "date": "2024-08-05_11-27-45", "timestamp": 1722837465, "time_this_iter_s": 12.697552680969238, "time_total_s": 881.3490822315216, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 881.3490822315216, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.105263157894736, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.43406337201596, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.7559262513221863, "policy_loss": -0.013309764439569941, "vf_loss": 0.7557762518835565, "vf_explained_var": 0.9985416518524289, "kl": 0.013354580142671086, "entropy": 0.6174793805927038, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 1.069696709009108, "episode_reward_min": -1158.7252841030772, "episode_reward_mean": -250.45109616363385, "episode_len_mean": 92.09, "episode_media": {}, "episodes_timesteps_total": 9209, "policy_reward_min": {"policy_0": -1158.7252841030772}, "policy_reward_max": {"policy_0": 1.069696709009108}, "policy_reward_mean": {"policy_0": -250.45109616363385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058, -204.27782723963955, -147.682329043109, -170.58938786672317, -257.47090611331487, -142.73549458366261, -294.7064002089696, -177.29379585569274, -169.1940419872808, -43.67007552213195, -65.07799460128318, -782.7946867957087, -551.0564040072315, -609.2713932166547, -434.9863613546249, -53.81428591958205, -257.67802454976135, -67.87705091613068, -880.1151034052655, -207.45616843882638, -18.27165292153967, -380.0389438496724, -71.60224584610505, -231.20377163268282, -24.77495080573824, -121.52710792428095, -48.99417075285317, -142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558, -519.057426724951, -929.4906347455974, -29.138816591459257, -42.66729347067456, -179.46520936218135, -72.21499951215914, -141.02599951260316, -1158.7252841030772, -156.02572629512161, -217.65439591941785, -31.282731871680987, -628.5983198112341, -32.84621439461769, -270.8891912768724, -158.85968499387332, -470.59754489496015, -373.84245626071885, -62.284034203304536, -270.1452820717801, -130.00888612725055, -287.96398703082184, -71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136], "episode_lengths": [150, 53, 98, 91, 108, 110, 75, 105, 54, 144, 94, 62, 150, 48, 39, 77, 104, 92, 88, 118, 73, 106, 65, 89, 56, 66, 150, 150, 150, 150, 63, 97, 59, 150, 96, 38, 150, 59, 98, 54, 71, 51, 79, 60, 92, 90, 119, 108, 92, 81, 150, 45, 73, 150, 101, 104, 150, 72, 73, 54, 105, 58, 39, 150, 150, 51, 45, 89, 61, 80, 150, 73, 104, 46, 150, 50, 116, 77, 130, 134, 53, 130, 82, 118, 67, 150, 39, 84, 49, 55, 87, 75, 64, 117, 84, 62, 79, 62, 150, 150], "policy_policy_0_reward": [-843.2971603006115, -50.10214038125286, -179.37256605125336, -186.74604150744386, -208.05713074496444, -215.7049317523159, -119.52286793121817, -325.4432687672336, -48.180375910472094, -396.03816062258716, -188.82622561846622, -78.03501089370104, -472.786174045952, -12.14658160545436, -15.337303652549311, -143.68282020340058, -204.27782723963955, -147.682329043109, -170.58938786672317, -257.47090611331487, -142.73549458366261, -294.7064002089696, -177.29379585569274, -169.1940419872808, -43.67007552213195, -65.07799460128318, -782.7946867957087, -551.0564040072315, -609.2713932166547, -434.9863613546249, -53.81428591958205, -257.67802454976135, -67.87705091613068, -880.1151034052655, -207.45616843882638, -18.27165292153967, -380.0389438496724, -71.60224584610505, -231.20377163268282, -24.77495080573824, -121.52710792428095, -48.99417075285317, -142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558, -519.057426724951, -929.4906347455974, -29.138816591459257, -42.66729347067456, -179.46520936218135, -72.21499951215914, -141.02599951260316, -1158.7252841030772, -156.02572629512161, -217.65439591941785, -31.282731871680987, -628.5983198112341, -32.84621439461769, -270.8891912768724, -158.85968499387332, -470.59754489496015, -373.84245626071885, -62.284034203304536, -270.1452820717801, -130.00888612725055, -287.96398703082184, -71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552096425937314, "mean_inference_ms": 1.6857826270853062, "mean_action_processing_ms": 0.2731602415465616, "mean_env_wait_ms": 3.311370955592856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325763702392578, "StateBufferConnector_ms": 0.007875204086303711, "ViewRequirementAgentConnector_ms": 0.19628477096557617}, "num_episodes": 37, "episode_return_max": 1.069696709009108, "episode_return_min": -1158.7252841030772, "episode_return_mean": -250.45109616363385, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0211663560616, "num_env_steps_trained_throughput_per_sec": 317.0211663560616, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 11359.502, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11359.424, "sample_time_ms": 1122.23, "learn_time_ms": 10175.266, "learn_throughput": 393.11, "synch_weights_time_ms": 61.114}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "89531_00000", "date": "2024-08-05_11-27-57", "timestamp": 1722837477, "time_this_iter_s": 12.629388809204102, "time_total_s": 893.9784710407257, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d7a7f6bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 893.9784710407257, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.561111111111114, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.21867715219656, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.9294716200752494, "policy_loss": -0.013750324627229324, "vf_loss": 0.9318976660259068, "vf_explained_var": 0.9967663103093704, "kl": 0.011243474756520353, "entropy": 0.597353667858988, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": 1.069696709009108, "episode_reward_min": -1176.4289621995129, "episode_reward_mean": -268.0515990577496, "episode_len_mean": 91.27, "episode_media": {}, "episodes_timesteps_total": 9127, "policy_reward_min": {"policy_0": -1176.4289621995129}, "policy_reward_max": {"policy_0": 1.069696709009108}, "policy_reward_mean": {"policy_0": -268.0515990577496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558, -519.057426724951, -929.4906347455974, -29.138816591459257, -42.66729347067456, -179.46520936218135, -72.21499951215914, -141.02599951260316, -1158.7252841030772, -156.02572629512161, -217.65439591941785, -31.282731871680987, -628.5983198112341, -32.84621439461769, -270.8891912768724, -158.85968499387332, -470.59754489496015, -373.84245626071885, -62.284034203304536, -270.1452820717801, -130.00888612725055, -287.96398703082184, -71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136, -171.74584168030253, -194.4159545756454, -165.77489458180347, -98.03083733583479, -54.61373350835649, -1036.206777917391, -81.83125436414092, -121.36138790614213, -179.35857101306632, -463.1115654388848, -794.1483473705491, -132.06627350415351, -31.865148784094963, -104.3956492052825, -76.30028615608622, -233.78309988701488, -995.8396682050959, -116.59365827408335, -97.84963694317342, -11.947289093813813, -89.96698219034245, -926.1887764883455, -42.82162883540306, -120.84169623826776, -255.30773401717443, -1020.8790056595149, -156.45991157000338, -130.2639156236474, -244.8671287416437, -44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348], "episode_lengths": [79, 60, 92, 90, 119, 108, 92, 81, 150, 45, 73, 150, 101, 104, 150, 72, 73, 54, 105, 58, 39, 150, 150, 51, 45, 89, 61, 80, 150, 73, 104, 46, 150, 50, 116, 77, 130, 134, 53, 130, 82, 118, 67, 150, 39, 84, 49, 55, 87, 75, 64, 117, 84, 62, 79, 62, 150, 150, 87, 90, 101, 66, 52, 150, 65, 73, 82, 150, 150, 74, 38, 68, 62, 78, 150, 71, 70, 43, 66, 150, 57, 76, 143, 150, 100, 82, 112, 51, 64, 38, 38, 150, 150, 45, 98, 48, 150, 150, 120, 61], "policy_policy_0_reward": [-142.26270892524013, -64.36582529610216, -127.46376784772498, -138.99689029557186, -318.2655203149568, -283.6433681351679, -194.2764313381613, -314.2366512983124, -833.1879538818124, -25.476472014136498, -111.5122394404922, -705.139167438036, -170.41747086273998, -308.7498097864081, -347.6518902997004, -99.87889248739343, -147.7370438545657, -34.22445375668405, -203.51668906048778, -41.63655625775955, -23.120136725298558, -519.057426724951, -929.4906347455974, -29.138816591459257, -42.66729347067456, -179.46520936218135, -72.21499951215914, -141.02599951260316, -1158.7252841030772, -156.02572629512161, -217.65439591941785, -31.282731871680987, -628.5983198112341, -32.84621439461769, -270.8891912768724, -158.85968499387332, -470.59754489496015, -373.84245626071885, -62.284034203304536, -270.1452820717801, -130.00888612725055, -287.96398703082184, -71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136, -171.74584168030253, -194.4159545756454, -165.77489458180347, -98.03083733583479, -54.61373350835649, -1036.206777917391, -81.83125436414092, -121.36138790614213, -179.35857101306632, -463.1115654388848, -794.1483473705491, -132.06627350415351, -31.865148784094963, -104.3956492052825, -76.30028615608622, -233.78309988701488, -995.8396682050959, -116.59365827408335, -97.84963694317342, -11.947289093813813, -89.96698219034245, -926.1887764883455, -42.82162883540306, -120.84169623826776, -255.30773401717443, -1020.8790056595149, -156.45991157000338, -130.2639156236474, -244.8671287416437, -44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554726727689439, "mean_inference_ms": 1.6848646253062314, "mean_action_processing_ms": 0.273165235756087, "mean_env_wait_ms": 3.3078097540886673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160539627075195, "StateBufferConnector_ms": 0.007756471633911133, "ViewRequirementAgentConnector_ms": 0.19481158256530762}, "num_episodes": 42, "episode_return_max": 1.069696709009108, "episode_return_min": -1176.4289621995129, "episode_return_mean": -268.0515990577496, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.7593920631582, "num_env_steps_trained_throughput_per_sec": 316.7593920631582, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 11420.196, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11420.119, "sample_time_ms": 1119.257, "learn_time_ms": 10239.738, "learn_throughput": 390.635, "synch_weights_time_ms": 60.312}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "89531_00000", "date": "2024-08-05_11-28-10", "timestamp": 1722837490, "time_this_iter_s": 12.640103101730347, "time_total_s": 906.618574142456, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447167a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 906.618574142456, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.28628382881483, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.885213689149047, "policy_loss": -0.011942113396556427, "vf_loss": 0.8891116480653485, "vf_explained_var": 0.9945794135952989, "kl": 0.008004369755038472, "entropy": 0.6026810446133216, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 1.069696709009108, "episode_reward_min": -1176.4289621995129, "episode_reward_mean": -274.7142090941968, "episode_len_mean": 91.05, "episode_media": {}, "episodes_timesteps_total": 9105, "policy_reward_min": {"policy_0": -1176.4289621995129}, "policy_reward_max": {"policy_0": 1.069696709009108}, "policy_reward_mean": {"policy_0": -274.7142090941968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136, -171.74584168030253, -194.4159545756454, -165.77489458180347, -98.03083733583479, -54.61373350835649, -1036.206777917391, -81.83125436414092, -121.36138790614213, -179.35857101306632, -463.1115654388848, -794.1483473705491, -132.06627350415351, -31.865148784094963, -104.3956492052825, -76.30028615608622, -233.78309988701488, -995.8396682050959, -116.59365827408335, -97.84963694317342, -11.947289093813813, -89.96698219034245, -926.1887764883455, -42.82162883540306, -120.84169623826776, -255.30773401717443, -1020.8790056595149, -156.45991157000338, -130.2639156236474, -244.8671287416437, -44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348, -123.97284921404548, -105.94908419693651, -632.5738247160682, -102.07625426832642, -261.39783541397736, -179.4649597219624, -183.24879389944613, -148.15007825930783, -24.42360714241705, -245.83348103811025, -834.6045548041278, -112.55458333165132, -54.43152903991069, -887.1149208730844, -130.6065651748708, -44.018538477905054, -178.48245893143184, -183.4492302120158, -60.37675827052737, -69.8195194921263, -127.18460505786676, -30.198566620347876, -69.75397197326497, -1018.6416900430961, -59.29343749345692, -359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277], "episode_lengths": [67, 150, 39, 84, 49, 55, 87, 75, 64, 117, 84, 62, 79, 62, 150, 150, 87, 90, 101, 66, 52, 150, 65, 73, 82, 150, 150, 74, 38, 68, 62, 78, 150, 71, 70, 43, 66, 150, 57, 76, 143, 150, 100, 82, 112, 51, 64, 38, 38, 150, 150, 45, 98, 48, 150, 150, 120, 61, 79, 67, 140, 67, 114, 84, 83, 74, 40, 119, 150, 74, 54, 150, 75, 54, 94, 103, 53, 56, 73, 50, 61, 150, 56, 145, 113, 150, 69, 97, 127, 69, 104, 101, 150, 150, 54, 150, 84, 52, 76, 101], "policy_policy_0_reward": [-71.11999371496975, -995.2203989991331, 1.069696709009108, -190.06377012932543, -39.01702813689779, -61.935078387977214, -180.36119303748254, -107.73251150171727, -198.95097893235513, -246.53168184000137, -166.90871040542007, -69.53200972106177, -151.5191482859347, -77.26302814123191, -1012.0588982147246, -781.9814897857136, -171.74584168030253, -194.4159545756454, -165.77489458180347, -98.03083733583479, -54.61373350835649, -1036.206777917391, -81.83125436414092, -121.36138790614213, -179.35857101306632, -463.1115654388848, -794.1483473705491, -132.06627350415351, -31.865148784094963, -104.3956492052825, -76.30028615608622, -233.78309988701488, -995.8396682050959, -116.59365827408335, -97.84963694317342, -11.947289093813813, -89.96698219034245, -926.1887764883455, -42.82162883540306, -120.84169623826776, -255.30773401717443, -1020.8790056595149, -156.45991157000338, -130.2639156236474, -244.8671287416437, -44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348, -123.97284921404548, -105.94908419693651, -632.5738247160682, -102.07625426832642, -261.39783541397736, -179.4649597219624, -183.24879389944613, -148.15007825930783, -24.42360714241705, -245.83348103811025, -834.6045548041278, -112.55458333165132, -54.43152903991069, -887.1149208730844, -130.6065651748708, -44.018538477905054, -178.48245893143184, -183.4492302120158, -60.37675827052737, -69.8195194921263, -127.18460505786676, -30.198566620347876, -69.75397197326497, -1018.6416900430961, -59.29343749345692, -359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550190043173295, "mean_inference_ms": 1.6838281145245042, "mean_action_processing_ms": 0.2729396346511864, "mean_env_wait_ms": 3.306648416880593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939764022827148, "StateBufferConnector_ms": 0.007756471633911133, "ViewRequirementAgentConnector_ms": 0.19591379165649414}, "num_episodes": 42, "episode_return_max": 1.069696709009108, "episode_return_min": -1176.4289621995129, "episode_return_mean": -274.7142090941968, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.70746263001604, "num_env_steps_trained_throughput_per_sec": 329.70746263001604, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 11550.922, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11550.846, "sample_time_ms": 1103.018, "learn_time_ms": 10386.025, "learn_throughput": 385.133, "synch_weights_time_ms": 61.004}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "89531_00000", "date": "2024-08-05_11-28-22", "timestamp": 1722837502, "time_this_iter_s": 12.142930507659912, "time_total_s": 918.761504650116, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447ec0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 918.761504650116, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.941176470588236, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.8218600978454, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.8786313919505725, "policy_loss": -0.014994364896362336, "vf_loss": 0.8821662986340623, "vf_explained_var": 0.9983609447876612, "kl": 0.011388429330721313, "entropy": 0.713281464514633, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -2.5164518539001395, "episode_reward_min": -1183.5323935332, "episode_reward_mean": -310.41363755250495, "episode_len_mean": 96.48, "episode_media": {}, "episodes_timesteps_total": 9648, "policy_reward_min": {"policy_0": -1183.5323935332}, "policy_reward_max": {"policy_0": -2.5164518539001395}, "policy_reward_mean": {"policy_0": -310.41363755250495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348, -123.97284921404548, -105.94908419693651, -632.5738247160682, -102.07625426832642, -261.39783541397736, -179.4649597219624, -183.24879389944613, -148.15007825930783, -24.42360714241705, -245.83348103811025, -834.6045548041278, -112.55458333165132, -54.43152903991069, -887.1149208730844, -130.6065651748708, -44.018538477905054, -178.48245893143184, -183.4492302120158, -60.37675827052737, -69.8195194921263, -127.18460505786676, -30.198566620347876, -69.75397197326497, -1018.6416900430961, -59.29343749345692, -359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277, -1101.9124344950114, -148.47598518100938, -1159.744428575001, -101.17790592348592, -420.3636090662827, -354.0076674035712, -84.76672835940369, -828.919969416886, -454.64416539248856, -35.43173979177873, -64.33850694505398, -285.6817466271688, -206.734891637739, -116.89383684376551, -208.6120698162782, -129.48366226733205, -266.5855538199684, -1045.200121401601, -366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406], "episode_lengths": [51, 64, 38, 38, 150, 150, 45, 98, 48, 150, 150, 120, 61, 79, 67, 140, 67, 114, 84, 83, 74, 40, 119, 150, 74, 54, 150, 75, 54, 94, 103, 53, 56, 73, 50, 61, 150, 56, 145, 113, 150, 69, 97, 127, 69, 104, 101, 150, 150, 54, 150, 84, 52, 76, 101, 150, 80, 150, 65, 121, 128, 74, 150, 150, 46, 60, 119, 99, 77, 99, 74, 113, 150, 150, 93, 57, 51, 150, 67, 150, 66, 104, 107, 150, 38, 34, 113, 85, 150, 61, 150, 150, 52, 59, 102, 150, 103, 47, 150, 79], "policy_policy_0_reward": [-44.70288364474478, -85.2688539169063, -8.691650508709587, -6.536073864744481, -461.14181897122467, -1176.4289621995129, -5.303310541877505, -140.9675908972149, -42.70414094605103, -535.2366782005035, -613.1692747946557, -327.44538168606715, -61.05634947744348, -123.97284921404548, -105.94908419693651, -632.5738247160682, -102.07625426832642, -261.39783541397736, -179.4649597219624, -183.24879389944613, -148.15007825930783, -24.42360714241705, -245.83348103811025, -834.6045548041278, -112.55458333165132, -54.43152903991069, -887.1149208730844, -130.6065651748708, -44.018538477905054, -178.48245893143184, -183.4492302120158, -60.37675827052737, -69.8195194921263, -127.18460505786676, -30.198566620347876, -69.75397197326497, -1018.6416900430961, -59.29343749345692, -359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277, -1101.9124344950114, -148.47598518100938, -1159.744428575001, -101.17790592348592, -420.3636090662827, -354.0076674035712, -84.76672835940369, -828.919969416886, -454.64416539248856, -35.43173979177873, -64.33850694505398, -285.6817466271688, -206.734891637739, -116.89383684376551, -208.6120698162782, -129.48366226733205, -266.5855538199684, -1045.200121401601, -366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551451635300435, "mean_inference_ms": 1.6847523205754193, "mean_action_processing_ms": 0.2730925621661829, "mean_env_wait_ms": 3.307537416887247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011964797973632812, "StateBufferConnector_ms": 0.007811307907104492, "ViewRequirementAgentConnector_ms": 0.19179868698120117}, "num_episodes": 45, "episode_return_max": -2.5164518539001395, "episode_return_min": -1183.5323935332, "episode_return_mean": -310.41363755250495, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.5665288608368, "num_env_steps_trained_throughput_per_sec": 315.5665288608368, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 11631.338, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11631.26, "sample_time_ms": 1116.569, "learn_time_ms": 10452.241, "learn_throughput": 382.693, "synch_weights_time_ms": 61.639}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "89531_00000", "date": "2024-08-05_11-28-35", "timestamp": 1722837515, "time_this_iter_s": 12.68559980392456, "time_total_s": 931.4471044540405, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d6447ecd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.4471044540405, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.77777777777778, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.26651097635428, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.9211891903386762, "policy_loss": -0.010431077795995709, "vf_loss": 0.9208402556056777, "vf_explained_var": 0.9960693599656224, "kl": 0.010699048395023702, "entropy": 0.5277535863841574, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": -2.5164518539001395, "episode_reward_min": -1183.5323935332, "episode_reward_mean": -350.436362002423, "episode_len_mean": 102.68, "episode_media": {}, "episodes_timesteps_total": 10268, "policy_reward_min": {"policy_0": -1183.5323935332}, "policy_reward_max": {"policy_0": -2.5164518539001395}, "policy_reward_mean": {"policy_0": -350.436362002423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277, -1101.9124344950114, -148.47598518100938, -1159.744428575001, -101.17790592348592, -420.3636090662827, -354.0076674035712, -84.76672835940369, -828.919969416886, -454.64416539248856, -35.43173979177873, -64.33850694505398, -285.6817466271688, -206.734891637739, -116.89383684376551, -208.6120698162782, -129.48366226733205, -266.5855538199684, -1045.200121401601, -366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406, -110.88523066485904, -518.1691560604054, -881.3017353294879, -170.14451888995097, -1010.6891160995326, -354.5760423021357, -124.5513420359074, -154.1885382570707, -220.76117074537797, -3.4105503080214654, -645.53648284544, -9.614660370523815, -452.18719629842366, -200.6990711933585, -56.97472733215313, -93.90115361845203, -165.270484974295, -248.02227248933409, -51.407929860512766, -16.05362059776993, -1127.4334713139958, -1182.5979616461457, -296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913], "episode_lengths": [145, 113, 150, 69, 97, 127, 69, 104, 101, 150, 150, 54, 150, 84, 52, 76, 101, 150, 80, 150, 65, 121, 128, 74, 150, 150, 46, 60, 119, 99, 77, 99, 74, 113, 150, 150, 93, 57, 51, 150, 67, 150, 66, 104, 107, 150, 38, 34, 113, 85, 150, 61, 150, 150, 52, 59, 102, 150, 103, 47, 150, 79, 76, 150, 150, 83, 150, 150, 70, 80, 116, 39, 150, 39, 150, 123, 54, 48, 83, 98, 55, 51, 150, 150, 76, 112, 150, 56, 150, 98, 78, 90, 74, 142, 150, 62, 106, 99, 95, 150], "policy_policy_0_reward": [-359.4599433646522, -477.4052975248915, -469.45803847502907, -67.49331681941591, -226.98061820044165, -288.864261613779, -115.05025405749409, -311.79143542029965, -191.55415858533985, -763.5615460511692, -1114.0574726849634, -54.974827819606595, -462.7148084209216, -192.55141044295684, -150.0480057615558, -121.84228660116364, -229.37568262586277, -1101.9124344950114, -148.47598518100938, -1159.744428575001, -101.17790592348592, -420.3636090662827, -354.0076674035712, -84.76672835940369, -828.919969416886, -454.64416539248856, -35.43173979177873, -64.33850694505398, -285.6817466271688, -206.734891637739, -116.89383684376551, -208.6120698162782, -129.48366226733205, -266.5855538199684, -1045.200121401601, -366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406, -110.88523066485904, -518.1691560604054, -881.3017353294879, -170.14451888995097, -1010.6891160995326, -354.5760423021357, -124.5513420359074, -154.1885382570707, -220.76117074537797, -3.4105503080214654, -645.53648284544, -9.614660370523815, -452.18719629842366, -200.6990711933585, -56.97472733215313, -93.90115361845203, -165.270484974295, -248.02227248933409, -51.407929860512766, -16.05362059776993, -1127.4334713139958, -1182.5979616461457, -296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553786169224674, "mean_inference_ms": 1.6847418665094125, "mean_action_processing_ms": 0.27325518287016154, "mean_env_wait_ms": 3.3064216774570907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991262435913086, "StateBufferConnector_ms": 0.007921695709228516, "ViewRequirementAgentConnector_ms": 0.19465923309326172}, "num_episodes": 38, "episode_return_max": -2.5164518539001395, "episode_return_min": -1183.5323935332, "episode_return_mean": -350.436362002423, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.98033693776875, "num_env_steps_trained_throughput_per_sec": 358.98033693776875, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 11521.703, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11521.627, "sample_time_ms": 1105.511, "learn_time_ms": 10354.134, "learn_throughput": 386.319, "synch_weights_time_ms": 61.17}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "89531_00000", "date": "2024-08-05_11-28-46", "timestamp": 1722837526, "time_this_iter_s": 11.153963565826416, "time_total_s": 942.601068019867, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644717eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 942.601068019867, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 18.44375, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.4341384857893, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.8144827257376164, "policy_loss": -0.00856926888372982, "vf_loss": 0.8124871523274729, "vf_explained_var": 0.9961589719479282, "kl": 0.010498717267728353, "entropy": 0.6510886332641045, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -0.23067266622412497, "episode_reward_min": -1188.3846058647466, "episode_reward_mean": -359.20330951821796, "episode_len_mean": 102.42, "episode_media": {}, "episodes_timesteps_total": 10242, "policy_reward_min": {"policy_0": -1188.3846058647466}, "policy_reward_max": {"policy_0": -0.23067266622412497}, "policy_reward_mean": {"policy_0": -359.20330951821796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406, -110.88523066485904, -518.1691560604054, -881.3017353294879, -170.14451888995097, -1010.6891160995326, -354.5760423021357, -124.5513420359074, -154.1885382570707, -220.76117074537797, -3.4105503080214654, -645.53648284544, -9.614660370523815, -452.18719629842366, -200.6990711933585, -56.97472733215313, -93.90115361845203, -165.270484974295, -248.02227248933409, -51.407929860512766, -16.05362059776993, -1127.4334713139958, -1182.5979616461457, -296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913, -699.7419424678186, -1188.3846058647466, -0.23067266622412497, -362.7199421988547, -1024.0785110976192, -803.6508793810235, -161.03955776526863, -1054.6982519882183, -356.0501646110773, -59.27326215986761, -24.698986664820918, -315.43786175054186, -385.2285304587283, -208.45608059555087, -251.54305550876978, -43.157821023415835, -49.88270018240766, -35.34142126288377, -56.998902885789285, -862.3354303570609, -101.50748465850329, -150.53479567171945, -504.9377822606145, -847.6475559842039, -104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596], "episode_lengths": [150, 93, 57, 51, 150, 67, 150, 66, 104, 107, 150, 38, 34, 113, 85, 150, 61, 150, 150, 52, 59, 102, 150, 103, 47, 150, 79, 76, 150, 150, 83, 150, 150, 70, 80, 116, 39, 150, 39, 150, 123, 54, 48, 83, 98, 55, 51, 150, 150, 76, 112, 150, 56, 150, 98, 78, 90, 74, 142, 150, 62, 106, 99, 95, 150, 150, 150, 36, 150, 150, 150, 81, 150, 150, 58, 51, 101, 113, 69, 101, 61, 55, 45, 57, 150, 83, 78, 116, 150, 72, 150, 150, 150, 68, 79, 127, 141, 150, 69, 60], "policy_policy_0_reward": [-366.7113211062518, -212.63765038127926, -68.81757036420247, -35.808973626889795, -816.1622876417491, -84.27613473172197, -593.1960529727687, -100.541516858163, -200.9164423095122, -216.5216907429929, -824.3069701880006, -2.5164518539001395, -6.953276253437003, -300.16165230144196, -167.0111838976687, -1166.231197192089, -79.35044378622416, -603.8058704157049, -719.4934635172485, -32.84382254842808, -48.61751978119443, -107.5793225965476, -1183.5323935332, -192.03461309797032, -11.275550553690822, -759.4767661361947, -154.15056211271406, -110.88523066485904, -518.1691560604054, -881.3017353294879, -170.14451888995097, -1010.6891160995326, -354.5760423021357, -124.5513420359074, -154.1885382570707, -220.76117074537797, -3.4105503080214654, -645.53648284544, -9.614660370523815, -452.18719629842366, -200.6990711933585, -56.97472733215313, -93.90115361845203, -165.270484974295, -248.02227248933409, -51.407929860512766, -16.05362059776993, -1127.4334713139958, -1182.5979616461457, -296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913, -699.7419424678186, -1188.3846058647466, -0.23067266622412497, -362.7199421988547, -1024.0785110976192, -803.6508793810235, -161.03955776526863, -1054.6982519882183, -356.0501646110773, -59.27326215986761, -24.698986664820918, -315.43786175054186, -385.2285304587283, -208.45608059555087, -251.54305550876978, -43.157821023415835, -49.88270018240766, -35.34142126288377, -56.998902885789285, -862.3354303570609, -101.50748465850329, -150.53479567171945, -504.9377822606145, -847.6475559842039, -104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551019860065185, "mean_inference_ms": 1.6836665069232655, "mean_action_processing_ms": 0.273094836035269, "mean_env_wait_ms": 3.304061083674176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01202249526977539, "StateBufferConnector_ms": 0.007903099060058594, "ViewRequirementAgentConnector_ms": 0.1938626766204834}, "num_episodes": 35, "episode_return_max": -0.23067266622412497, "episode_return_min": -1188.3846058647466, "episode_return_mean": -359.20330951821796, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.61503336654187, "num_env_steps_trained_throughput_per_sec": 331.61503336654187, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 11761.482, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11761.406, "sample_time_ms": 1107.881, "learn_time_ms": 10591.559, "learn_throughput": 377.659, "synch_weights_time_ms": 61.16}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "89531_00000", "date": "2024-08-05_11-28-58", "timestamp": 1722837538, "time_this_iter_s": 12.07461142539978, "time_total_s": 954.6756794452667, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644716ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 954.6756794452667, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.51764705882353, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.38120217422644, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.8524417418365677, "policy_loss": -0.010125611689484988, "vf_loss": 0.8542844804624716, "vf_explained_var": 0.9915576118354996, "kl": 0.008249786472530711, "entropy": 0.7003552726780374, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -0.23067266622412497, "episode_reward_min": -1192.608350115046, "episode_reward_mean": -338.8756918492257, "episode_len_mean": 99.6, "episode_media": {}, "episodes_timesteps_total": 9960, "policy_reward_min": {"policy_0": -1192.608350115046}, "policy_reward_max": {"policy_0": -0.23067266622412497}, "policy_reward_mean": {"policy_0": -338.8756918492257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913, -699.7419424678186, -1188.3846058647466, -0.23067266622412497, -362.7199421988547, -1024.0785110976192, -803.6508793810235, -161.03955776526863, -1054.6982519882183, -356.0501646110773, -59.27326215986761, -24.698986664820918, -315.43786175054186, -385.2285304587283, -208.45608059555087, -251.54305550876978, -43.157821023415835, -49.88270018240766, -35.34142126288377, -56.998902885789285, -862.3354303570609, -101.50748465850329, -150.53479567171945, -504.9377822606145, -847.6475559842039, -104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596, -443.1604587948112, -704.8815620439931, -194.95531300029523, -45.027882907065205, -2.6154445851678165, -1192.608350115046, -587.0778191370163, -989.2164533340272, -126.76673791679524, -554.6983724078535, -183.31064465165738, -15.673115506952666, -46.890164260506545, -239.59486546059577, -69.26120300431022, -51.81449620462642, -527.0869116325795, -131.41352268902787, -160.34943554368652, -194.83680196558424, -34.45545956000044, -277.94799705477584, -591.0062485483676, -101.03968025360751, -225.80387822309459, -936.6043742202705, -319.71041489221903, -141.85715532064657, -196.75130629536582, -281.66196712750053, -131.6652514131804, -130.99521808790462, -922.3604770680871, -82.06788547163924, -107.17810458942873, -154.76548651878952, -92.75687083176673, -94.58138374233874, -179.2846642278281, -210.66723885416718, -86.08591146403995, -1120.999509797371, -92.36728639537347, -1077.1990562076871, -294.75770212225024, -136.45811824709202, -194.46018178043977, -106.92504586877337, -36.891937489502745], "episode_lengths": [76, 112, 150, 56, 150, 98, 78, 90, 74, 142, 150, 62, 106, 99, 95, 150, 150, 150, 36, 150, 150, 150, 81, 150, 150, 58, 51, 101, 113, 69, 101, 61, 55, 45, 57, 150, 83, 78, 116, 150, 72, 150, 150, 150, 68, 79, 127, 141, 150, 69, 60, 129, 150, 92, 61, 34, 150, 116, 150, 89, 119, 82, 37, 51, 96, 65, 47, 150, 86, 83, 101, 47, 129, 150, 73, 90, 150, 127, 77, 87, 147, 80, 72, 150, 45, 74, 78, 69, 63, 84, 91, 62, 150, 64, 150, 102, 78, 97, 70, 57], "policy_policy_0_reward": [-296.82493995954263, -320.72223148292977, -767.4088659663504, -58.689049145926546, -339.00673566264146, -224.67682084056494, -169.50139949478668, -215.5531130439967, -114.83738089115525, -424.54749304023545, -887.5890311515149, -83.1127414624398, -165.5943237079803, -202.2493784014312, -262.5575193119093, -1047.2996555111913, -699.7419424678186, -1188.3846058647466, -0.23067266622412497, -362.7199421988547, -1024.0785110976192, -803.6508793810235, -161.03955776526863, -1054.6982519882183, -356.0501646110773, -59.27326215986761, -24.698986664820918, -315.43786175054186, -385.2285304587283, -208.45608059555087, -251.54305550876978, -43.157821023415835, -49.88270018240766, -35.34142126288377, -56.998902885789285, -862.3354303570609, -101.50748465850329, -150.53479567171945, -504.9377822606145, -847.6475559842039, -104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596, -443.1604587948112, -704.8815620439931, -194.95531300029523, -45.027882907065205, -2.6154445851678165, -1192.608350115046, -587.0778191370163, -989.2164533340272, -126.76673791679524, -554.6983724078535, -183.31064465165738, -15.673115506952666, -46.890164260506545, -239.59486546059577, -69.26120300431022, -51.81449620462642, -527.0869116325795, -131.41352268902787, -160.34943554368652, -194.83680196558424, -34.45545956000044, -277.94799705477584, -591.0062485483676, -101.03968025360751, -225.80387822309459, -936.6043742202705, -319.71041489221903, -141.85715532064657, -196.75130629536582, -281.66196712750053, -131.6652514131804, -130.99521808790462, -922.3604770680871, -82.06788547163924, -107.17810458942873, -154.76548651878952, -92.75687083176673, -94.58138374233874, -179.2846642278281, -210.66723885416718, -86.08591146403995, -1120.999509797371, -92.36728639537347, -1077.1990562076871, -294.75770212225024, -136.45811824709202, -194.46018178043977, -106.92504586877337, -36.891937489502745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550812337499308, "mean_inference_ms": 1.6832909453266678, "mean_action_processing_ms": 0.27293072803687596, "mean_env_wait_ms": 3.3059565342423567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011888980865478516, "StateBufferConnector_ms": 0.007733583450317383, "ViewRequirementAgentConnector_ms": 0.191148042678833}, "num_episodes": 49, "episode_return_max": -0.23067266622412497, "episode_return_min": -1192.608350115046, "episode_return_mean": -338.8756918492257, "episodes_this_iter": 49}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.5615575463149, "num_env_steps_trained_throughput_per_sec": 311.5615575463149, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 11998.571, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11998.494, "sample_time_ms": 1096.476, "learn_time_ms": 10838.979, "learn_throughput": 369.038, "synch_weights_time_ms": 62.224}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "89531_00000", "date": "2024-08-05_11-29-11", "timestamp": 1722837551, "time_this_iter_s": 12.851486682891846, "time_total_s": 967.5271661281586, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d644788f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.5271661281586, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.827777777777776, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78.97827080239853, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.8008904902109255, "policy_loss": -0.01040752136032097, "vf_loss": 0.7997686817310751, "vf_explained_var": 0.9977256864309311, "kl": 0.011433597616011563, "entropy": 0.4719038140028715, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": -2.6154445851678165, "episode_reward_min": -1192.608350115046, "episode_reward_mean": -294.82480821719355, "episode_len_mean": 92.88, "episode_media": {}, "episodes_timesteps_total": 9288, "policy_reward_min": {"policy_0": -1192.608350115046}, "policy_reward_max": {"policy_0": -2.6154445851678165}, "policy_reward_mean": {"policy_0": -294.82480821719355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596, -443.1604587948112, -704.8815620439931, -194.95531300029523, -45.027882907065205, -2.6154445851678165, -1192.608350115046, -587.0778191370163, -989.2164533340272, -126.76673791679524, -554.6983724078535, -183.31064465165738, -15.673115506952666, -46.890164260506545, -239.59486546059577, -69.26120300431022, -51.81449620462642, -527.0869116325795, -131.41352268902787, -160.34943554368652, -194.83680196558424, -34.45545956000044, -277.94799705477584, -591.0062485483676, -101.03968025360751, -225.80387822309459, -936.6043742202705, -319.71041489221903, -141.85715532064657, -196.75130629536582, -281.66196712750053, -131.6652514131804, -130.99521808790462, -922.3604770680871, -82.06788547163924, -107.17810458942873, -154.76548651878952, -92.75687083176673, -94.58138374233874, -179.2846642278281, -210.66723885416718, -86.08591146403995, -1120.999509797371, -92.36728639537347, -1077.1990562076871, -294.75770212225024, -136.45811824709202, -194.46018178043977, -106.92504586877337, -36.891937489502745, -76.0249189377821, -216.1565784149051, -105.00091550305675, -45.88297234591668, -300.3490246433436, -60.96860537383958, -2.9998253216792943, -74.22012232143018, -1155.8944809663, -165.94612802183659, -180.38385607203136, -106.4101388587002, -58.195446986069484, -41.77507446208543, -136.82362059944413, -128.36748093145863, -1125.3041351842699, -89.82558578438737, -154.32907371401865, -10.458186140215961, -365.98038972074005, -35.319364223656116, -83.76192369132126, -182.94543048984275, -68.81835430881448, -1159.380832518202, -162.9251545646981, -825.7377531201012, -202.7093819037562, -289.01878598772225, -240.8547415584053, -73.76713245958545, -169.07242238025978, -522.2861020730229, -475.34137485722124, -17.077574962536477, -45.7968536575022, -353.45671892048875, -1102.4417859869804, -110.65026736949564], "episode_lengths": [72, 150, 150, 150, 68, 79, 127, 141, 150, 69, 60, 129, 150, 92, 61, 34, 150, 116, 150, 89, 119, 82, 37, 51, 96, 65, 47, 150, 86, 83, 101, 47, 129, 150, 73, 90, 150, 127, 77, 87, 147, 80, 72, 150, 45, 74, 78, 69, 63, 84, 91, 62, 150, 64, 150, 102, 78, 97, 70, 57, 63, 87, 68, 53, 108, 55, 39, 61, 150, 80, 86, 68, 57, 50, 72, 74, 150, 51, 106, 41, 150, 46, 64, 84, 61, 150, 78, 150, 101, 98, 113, 62, 70, 150, 150, 43, 53, 102, 150, 77], "policy_policy_0_reward": [-104.53372728648357, -197.24210694285048, -952.2711009422874, -462.34661879118886, -61.05310409836355, -130.18147830774708, -329.53813554293737, -444.2335111439378, -1096.5677484417674, -92.9887442712489, -68.32066377831596, -443.1604587948112, -704.8815620439931, -194.95531300029523, -45.027882907065205, -2.6154445851678165, -1192.608350115046, -587.0778191370163, -989.2164533340272, -126.76673791679524, -554.6983724078535, -183.31064465165738, -15.673115506952666, -46.890164260506545, -239.59486546059577, -69.26120300431022, -51.81449620462642, -527.0869116325795, -131.41352268902787, -160.34943554368652, -194.83680196558424, -34.45545956000044, -277.94799705477584, -591.0062485483676, -101.03968025360751, -225.80387822309459, -936.6043742202705, -319.71041489221903, -141.85715532064657, -196.75130629536582, -281.66196712750053, -131.6652514131804, -130.99521808790462, -922.3604770680871, -82.06788547163924, -107.17810458942873, -154.76548651878952, -92.75687083176673, -94.58138374233874, -179.2846642278281, -210.66723885416718, -86.08591146403995, -1120.999509797371, -92.36728639537347, -1077.1990562076871, -294.75770212225024, -136.45811824709202, -194.46018178043977, -106.92504586877337, -36.891937489502745, -76.0249189377821, -216.1565784149051, -105.00091550305675, -45.88297234591668, -300.3490246433436, -60.96860537383958, -2.9998253216792943, -74.22012232143018, -1155.8944809663, -165.94612802183659, -180.38385607203136, -106.4101388587002, -58.195446986069484, -41.77507446208543, -136.82362059944413, -128.36748093145863, -1125.3041351842699, -89.82558578438737, -154.32907371401865, -10.458186140215961, -365.98038972074005, -35.319364223656116, -83.76192369132126, -182.94543048984275, -68.81835430881448, -1159.380832518202, -162.9251545646981, -825.7377531201012, -202.7093819037562, -289.01878598772225, -240.8547415584053, -73.76713245958545, -169.07242238025978, -522.2861020730229, -475.34137485722124, -17.077574962536477, -45.7968536575022, -353.45671892048875, -1102.4417859869804, -110.65026736949564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551166524840202, "mean_inference_ms": 1.6831526654241193, "mean_action_processing_ms": 0.2730796084854272, "mean_env_wait_ms": 3.3060324998668995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011816024780273438, "StateBufferConnector_ms": 0.007691860198974609, "ViewRequirementAgentConnector_ms": 0.18766546249389648}, "num_episodes": 40, "episode_return_max": -2.6154445851678165, "episode_return_min": -1192.608350115046, "episode_return_mean": -294.82480821719355, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3458736831419, "num_env_steps_trained_throughput_per_sec": 310.3458736831419, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 12182.804, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12182.725, "sample_time_ms": 1096.18, "learn_time_ms": 11022.445, "learn_throughput": 362.896, "synch_weights_time_ms": 63.277}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "89531_00000", "date": "2024-08-05_11-29-24", "timestamp": 1722837564, "time_this_iter_s": 12.900930166244507, "time_total_s": 980.4280962944031, "pid": 663900, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70d64478b5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 980.4280962944031, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 21.516666666666666, "ram_util_percent": 29.200000000000003}}
