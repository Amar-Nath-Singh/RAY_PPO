{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0053408150250713, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.528871348500251, "policy_loss": -0.006670910882530734, "vf_loss": 9.561811391512553, "vf_explained_var": 0.03239871294548114, "kl": 0.01079622594029388, "entropy": 1.4214191711197297, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -0.1845223790415823, "episode_reward_min": -1197.4536972588223, "episode_reward_mean": -516.604566691987, "episode_len_mean": 122.04, "episode_media": {}, "episodes_timesteps_total": 3051, "policy_reward_min": {"policy_0": -1197.4536972588223}, "policy_reward_max": {"policy_0": -0.1845223790415823}, "policy_reward_mean": {"policy_0": -516.604566691987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907], "episode_lengths": [150, 150, 117, 150, 40, 150, 106, 150, 37, 88, 150, 150, 103, 150, 39, 150, 150, 106, 150, 150, 92, 73, 150, 150, 150], "policy_policy_0_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.579732711992436, "mean_inference_ms": 1.675158346580167, "mean_action_processing_ms": 0.28442893975669725, "mean_env_wait_ms": 3.0308345393790006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019120216369628906, "StateBufferConnector_ms": 0.008066177368164062, "ViewRequirementAgentConnector_ms": 0.17970943450927734}, "num_episodes": 25, "episode_return_max": -0.1845223790415823, "episode_return_min": -1197.4536972588223, "episode_return_mean": -516.604566691987, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.32891514421806, "num_env_steps_trained_throughput_per_sec": 329.32891514421806, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12145.923, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12145.847, "sample_time_ms": 1061.847, "learn_time_ms": 11007.035, "learn_throughput": 363.404, "synch_weights_time_ms": 76.237}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-03", "timestamp": 1722635883, "time_this_iter_s": 12.158480644226074, "time_total_s": 12.158480644226074, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.158480644226074, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.983333333333334, "ram_util_percent": 27.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0948907230049372, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.571099373201529, "policy_loss": -0.008453306380154875, "vf_loss": 9.60616821050644, "vf_explained_var": 0.05229267540077368, "kl": 0.010507603323700702, "entropy": 1.4358512147019307, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -0.1845223790415823, "episode_reward_min": -1197.4536972588223, "episode_reward_mean": -628.8114480142311, "episode_len_mean": 129.69230769230768, "episode_media": {}, "episodes_timesteps_total": 6744, "policy_reward_min": {"policy_0": -1197.4536972588223}, "policy_reward_max": {"policy_0": -0.1845223790415823}, "policy_reward_mean": {"policy_0": -628.8114480142311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203], "episode_lengths": [150, 150, 117, 150, 40, 150, 106, 150, 37, 88, 150, 150, 103, 150, 39, 150, 150, 106, 150, 150, 92, 73, 150, 150, 150, 71, 78, 45, 131, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5723543341649261, "mean_inference_ms": 1.6693619850161585, "mean_action_processing_ms": 0.2838063671161511, "mean_env_wait_ms": 2.9998388496755712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017117078487689678, "StateBufferConnector_ms": 0.008271749203021709, "ViewRequirementAgentConnector_ms": 0.18245623661921576}, "num_episodes": 27, "episode_return_max": -0.1845223790415823, "episode_return_min": -1197.4536972588223, "episode_return_mean": -628.8114480142311, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.9520403013388, "num_env_steps_trained_throughput_per_sec": 356.9520403013388, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11675.96, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11675.892, "sample_time_ms": 1057.367, "learn_time_ms": 10549.602, "learn_throughput": 379.161, "synch_weights_time_ms": 68.17}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-14", "timestamp": 1722635894, "time_this_iter_s": 11.218677759170532, "time_total_s": 23.377158403396606, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415cd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.377158403396606, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.19375, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8450142559595406, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.325178334116936, "policy_loss": -0.006770718674912738, "vf_loss": 9.35684031645457, "vf_explained_var": 0.07762381757299106, "kl": 0.013691102924804, "entropy": 1.381472517301639, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -0.1845223790415823, "episode_reward_min": -1197.4536972588223, "episode_reward_mean": -640.3223000374398, "episode_len_mean": 131.44871794871796, "episode_media": {}, "episodes_timesteps_total": 10253, "policy_reward_min": {"policy_0": -1197.4536972588223}, "policy_reward_max": {"policy_0": -0.1845223790415823}, "policy_reward_mean": {"policy_0": -640.3223000374398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417], "episode_lengths": [150, 150, 117, 150, 40, 150, 106, 150, 37, 88, 150, 150, 103, 150, 39, 150, 150, 106, 150, 150, 92, 73, 150, 150, 150, 71, 78, 45, 131, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 117, 150, 150, 150, 150, 150, 150, 50, 150, 45, 150, 150, 150, 150, 150, 150, 150, 91, 150, 63, 150], "policy_policy_0_reward": [-664.1943531761372, -556.4526770535839, -264.1649892267392, -993.9377396714874, -13.40317946101269, -620.7596641945405, -372.9761500249923, -360.58083874989956, -0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5707452032131444, "mean_inference_ms": 1.6713240186342766, "mean_action_processing_ms": 0.2839867250673233, "mean_env_wait_ms": 2.997162323350159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01568182920798277, "StateBufferConnector_ms": 0.008466610541710487, "ViewRequirementAgentConnector_ms": 0.18533621078882462}, "num_episodes": 26, "episode_return_max": -0.1845223790415823, "episode_return_min": -1197.4536972588223, "episode_return_mean": -640.3223000374398, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 563.290989854077, "num_env_steps_trained_throughput_per_sec": 563.290989854077, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10151.019, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10150.952, "sample_time_ms": 1043.441, "learn_time_ms": 9045.203, "learn_throughput": 442.223, "synch_weights_time_ms": 61.556}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-21", "timestamp": 1722635901, "time_this_iter_s": 7.1119842529296875, "time_total_s": 30.489142656326294, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.489142656326294, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.12, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.22052417229861, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.07542467067639, "policy_loss": -0.009775551407559153, "vf_loss": 9.111159473160903, "vf_explained_var": 0.21578928908954065, "kl": 0.015850212789246143, "entropy": 1.4564644313106934, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -0.1845223790415823, "episode_reward_min": -1197.4536972588223, "episode_reward_mean": -649.1689098709735, "episode_len_mean": 132.46, "episode_media": {}, "episodes_timesteps_total": 13246, "policy_reward_min": {"policy_0": -1197.4536972588223}, "policy_reward_max": {"policy_0": -0.1845223790415823}, "policy_reward_mean": {"policy_0": -649.1689098709735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579], "episode_lengths": [37, 88, 150, 150, 103, 150, 39, 150, 150, 106, 150, 150, 92, 73, 150, 150, 150, 71, 78, 45, 131, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 117, 150, 150, 150, 150, 150, 150, 50, 150, 45, 150, 150, 150, 150, 150, 150, 150, 91, 150, 63, 150, 150, 61, 150, 150, 150, 150, 150, 150, 64, 150, 60, 150, 150, 150, 132, 150, 150, 150, 142, 150, 71, 86, 150, 90, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-0.1845223790415823, -112.81812461793741, -801.039211885286, -1003.7283937634024, -341.7022459725821, -877.6042354850854, -8.403869213999988, -1197.4536972588223, -847.2289258222683, -425.98356229691456, -427.2681758188674, -359.33725175076324, -344.9351274419306, -222.108364854191, -688.6667385330913, -767.1243928138061, -643.0577358332907, -138.15140285346433, -255.0129263736709, -26.111579661861505, -592.1153582456925, -1118.804773028331, -345.6635714579985, -867.6220619679359, -1108.0204175234617, -938.4007915020029, -955.9071060118275, -806.426633644772, -1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5696020444752395, "mean_inference_ms": 1.672983740024767, "mean_action_processing_ms": 0.2841624279560056, "mean_env_wait_ms": 2.9953749725724355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013720512390136719, "StateBufferConnector_ms": 0.008591175079345703, "ViewRequirementAgentConnector_ms": 0.18636274337768555}, "num_episodes": 30, "episode_return_max": -0.1845223790415823, "episode_return_min": -1197.4536972588223, "episode_return_mean": -649.1689098709735, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 565.1913006600124, "num_env_steps_trained_throughput_per_sec": 565.1913006600124, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9382.581, "restore_workers_time_ms": 0.03, "training_step_time_ms": 9382.51, "sample_time_ms": 1047.231, "learn_time_ms": 8275.6, "learn_throughput": 483.349, "synch_weights_time_ms": 58.931}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-28", "timestamp": 1722635908, "time_this_iter_s": 7.090256690979004, "time_total_s": 37.5793993473053, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415e5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.5793993473053, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.08, "ram_util_percent": 27.310000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.790957301668823, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.34152971704801, "policy_loss": -0.006969043666807314, "vf_loss": 9.375711538394292, "vf_explained_var": 0.1851307353625695, "kl": 0.013422268553676989, "entropy": 1.4948612737158935, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -9.588572714475378, "episode_reward_min": -1289.7971261893097, "episode_reward_mean": -730.364191554062, "episode_len_mean": 140.07, "episode_media": {}, "episodes_timesteps_total": 14007, "policy_reward_min": {"policy_0": -1289.7971261893097}, "policy_reward_max": {"policy_0": -9.588572714475378}, "policy_reward_mean": {"policy_0": -730.364191554062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 117, 150, 150, 150, 150, 150, 150, 50, 150, 45, 150, 150, 150, 150, 150, 150, 150, 91, 150, 63, 150, 150, 61, 150, 150, 150, 150, 150, 150, 64, 150, 60, 150, 150, 150, 132, 150, 150, 150, 142, 150, 71, 86, 150, 90, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1001.4980133058328, -970.921192001472, -812.7247742870613, -660.3875595243699, -852.6117730209288, -797.6358777017368, -711.09044598456, -779.4735697771494, -1054.6915337242299, -363.1477006388055, -877.1074551601697, -1096.3603874560413, -667.9956067963177, -663.8615502665177, -485.20394492793355, -836.133122596203, -618.7148267787574, -1092.5037702684986, -966.3686796594808, -563.9607338107824, -294.9172508737866, -420.59251791833026, -874.2169172263739, -1147.2516867962543, -1049.6280516381719, -767.2311836357493, -1038.298816991295, -1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5658140986501313, "mean_inference_ms": 1.6776535292169783, "mean_action_processing_ms": 0.28461966717252596, "mean_env_wait_ms": 2.990920869757628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013409614562988281, "StateBufferConnector_ms": 0.008629560470581055, "ViewRequirementAgentConnector_ms": 0.1865077018737793}, "num_episodes": 28, "episode_return_max": -9.588572714475378, "episode_return_min": -1289.7971261893097, "episode_return_mean": -730.364191554062, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.0169801321355, "num_env_steps_trained_throughput_per_sec": 314.0169801321355, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10053.7, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10053.631, "sample_time_ms": 1057.347, "learn_time_ms": 8933.097, "learn_throughput": 447.773, "synch_weights_time_ms": 62.429}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-41", "timestamp": 1722635921, "time_this_iter_s": 12.751132249832153, "time_total_s": 50.33053159713745, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.33053159713745, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.77777777777778, "ram_util_percent": 27.388888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.982213521748781, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.584582545856636, "policy_loss": -0.01310363619607718, "vf_loss": 8.622892428934573, "vf_explained_var": 0.28699981483320397, "kl": 0.015275963543717807, "entropy": 1.413071820884943, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -9.588572714475378, "episode_reward_min": -1289.7971261893097, "episode_reward_mean": -707.8504095455156, "episode_len_mean": 138.59, "episode_media": {}, "episodes_timesteps_total": 13859, "policy_reward_min": {"policy_0": -1289.7971261893097}, "policy_reward_max": {"policy_0": -9.588572714475378}, "policy_reward_mean": {"policy_0": -707.8504095455156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959], "episode_lengths": [150, 50, 150, 45, 150, 150, 150, 150, 150, 150, 150, 91, 150, 63, 150, 150, 61, 150, 150, 150, 150, 150, 150, 64, 150, 60, 150, 150, 150, 132, 150, 150, 150, 142, 150, 71, 86, 150, 90, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 80, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 105, 150, 150], "policy_policy_0_reward": [-1174.5105538093726, -9.588572714475378, -818.5785826225236, -76.06467660592406, -809.67418684583, -661.4189309152083, -253.09797873015498, -324.69006875880234, -695.5606868486798, -889.171577369464, -614.0115625485763, -250.905172751819, -746.5085242073089, -150.08807180202305, -939.3905240526417, -1092.7691425149912, -137.2403164414271, -818.2395357537639, -724.3158421180735, -942.3222128602291, -492.0049403286568, -886.3389163723607, -780.3399955459689, -122.1005363838216, -679.4748246229377, -158.78357491113692, -965.3756563868621, -558.7404131877903, -564.9529679366336, -452.51989349439606, -836.3910563897364, -1091.8385956160917, -915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5645385281933641, "mean_inference_ms": 1.681520603788562, "mean_action_processing_ms": 0.2846970192454395, "mean_env_wait_ms": 2.997392262912558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01306772232055664, "StateBufferConnector_ms": 0.008551359176635742, "ViewRequirementAgentConnector_ms": 0.18646025657653809}, "num_episodes": 27, "episode_return_max": -9.588572714475378, "episode_return_min": -1289.7971261893097, "episode_return_mean": -707.8504095455156, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.5419367835939, "num_env_steps_trained_throughput_per_sec": 309.5419367835939, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10531.805, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10531.738, "sample_time_ms": 1051.682, "learn_time_ms": 9417.564, "learn_throughput": 424.738, "synch_weights_time_ms": 61.735}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "3541f_00002", "date": "2024-08-03_03-28-54", "timestamp": 1722635934, "time_this_iter_s": 12.934631109237671, "time_total_s": 63.26516270637512, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafae290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.26516270637512, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.094736842105267, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.10553823026518, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.441649600863457, "policy_loss": -0.011187554437977571, "vf_loss": 8.478294304013252, "vf_explained_var": 0.4248168579613169, "kl": 0.017758323983374194, "entropy": 1.4504410905142626, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -68.87977420170755, "episode_reward_min": -1309.4716138488131, "episode_reward_mean": -733.6143294925627, "episode_len_mean": 141.02, "episode_media": {}, "episodes_timesteps_total": 14102, "policy_reward_min": {"policy_0": -1309.4716138488131}, "policy_reward_max": {"policy_0": -68.87977420170755}, "policy_reward_mean": {"policy_0": -733.6143294925627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945], "episode_lengths": [150, 142, 150, 71, 86, 150, 90, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 80, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 105, 150, 150, 150, 116, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 99, 150, 78, 150, 150, 94, 85, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-915.9662237481069, -499.07678686178446, -362.28217458343954, -104.79103239175006, -68.87977420170755, -820.6735769487699, -228.35866769280963, -823.877397566794, -939.6866812283424, -448.35056515608136, -619.0112538026148, -705.8815564658938, -977.6370642224579, -450.2635741164616, -244.50560721961028, -790.0820040193989, -1231.239206215795, -1289.7971261893097, -861.1424997045281, -1174.5274525198413, -801.3624928606318, -317.71233177253976, -856.2054367886254, -901.6770267334831, -1267.1219299295522, -306.1427513206727, -1034.0043553077642, -1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632330478162941, "mean_inference_ms": 1.6838229841185166, "mean_action_processing_ms": 0.2842874121922475, "mean_env_wait_ms": 2.9995994434457827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012469768524169922, "StateBufferConnector_ms": 0.008325338363647461, "ViewRequirementAgentConnector_ms": 0.1874377727508545}, "num_episodes": 32, "episode_return_max": -68.87977420170755, "episode_return_min": -1309.4716138488131, "episode_return_mean": -733.6143294925627, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.15223771803227, "num_env_steps_trained_throughput_per_sec": 313.15223771803227, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10852.026, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10851.957, "sample_time_ms": 1051.792, "learn_time_ms": 9737.968, "learn_throughput": 410.763, "synch_weights_time_ms": 61.442}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "3541f_00002", "date": "2024-08-03_03-29-07", "timestamp": 1722635947, "time_this_iter_s": 12.787447690963745, "time_total_s": 76.05261039733887, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafaee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.05261039733887, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.15555555555555, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.313003297150136, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.204296445349852, "policy_loss": -0.013933806209630953, "vf_loss": 8.245344708363215, "vf_explained_var": 0.5736859140917658, "kl": 0.02141837473079704, "entropy": 1.5699068213502565, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -64.52936476317554, "episode_reward_min": -1309.4716138488131, "episode_reward_mean": -744.1675212402656, "episode_len_mean": 140.22, "episode_media": {}, "episodes_timesteps_total": 14022, "policy_reward_min": {"policy_0": -1309.4716138488131}, "policy_reward_max": {"policy_0": -64.52936476317554}, "policy_reward_mean": {"policy_0": -744.1675212402656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 80, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 105, 150, 150, 150, 116, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 99, 150, 78, 150, 150, 94, 85, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 48, 150, 150, 88, 150, 150], "policy_policy_0_reward": [-1037.0073763482724, -506.0208428185211, -891.8316699278254, -841.249974463492, -945.6229285854745, -990.9337984760854, -1020.9621537375433, -1013.9543064668286, -779.0812090895188, -921.8618792960033, -919.1140526403591, -1080.8291626163227, -1022.5216771976081, -843.6345399590593, -552.8288458032367, -329.2696406765924, -713.0084612389774, -474.9137550475983, -860.4869740089787, -457.4009097092777, -677.9862480783173, -239.7960573088504, -827.5567650475688, -170.57442224390843, -476.16973152519364, -1041.274466426151, -1191.5925499786663, -1230.98946714027, -757.4599624928538, -1076.0933882196846, -1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5607280107650279, "mean_inference_ms": 1.6839686105772234, "mean_action_processing_ms": 0.2838009004279587, "mean_env_wait_ms": 3.0003366639864164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012362241744995117, "StateBufferConnector_ms": 0.008169174194335938, "ViewRequirementAgentConnector_ms": 0.19422292709350586}, "num_episodes": 27, "episode_return_max": -64.52936476317554, "episode_return_min": -1309.4716138488131, "episode_return_mean": -744.1675212402656, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3985957956075, "num_env_steps_trained_throughput_per_sec": 301.3985957956075, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11154.457, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11154.389, "sample_time_ms": 1065.509, "learn_time_ms": 10026.431, "learn_throughput": 398.946, "synch_weights_time_ms": 61.685}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "3541f_00002", "date": "2024-08-03_03-29-20", "timestamp": 1722635960, "time_this_iter_s": 13.284996271133423, "time_total_s": 89.33760666847229, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415c940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.33760666847229, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.231578947368423, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.143502676238615, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.809484655658404, "policy_loss": -0.007167324757028836, "vf_loss": 7.844832077125708, "vf_explained_var": 0.5954858001321555, "kl": 0.012399536774197872, "entropy": 1.594996794561545, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -64.52936476317554, "episode_reward_min": -1351.6791139602028, "episode_reward_mean": -715.1753071969491, "episode_len_mean": 136.22, "episode_media": {}, "episodes_timesteps_total": 13622, "policy_reward_min": {"policy_0": -1351.6791139602028}, "policy_reward_max": {"policy_0": -64.52936476317554}, "policy_reward_mean": {"policy_0": -715.1753071969491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337], "episode_lengths": [150, 150, 150, 150, 150, 150, 117, 150, 105, 150, 150, 150, 116, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 99, 150, 78, 150, 150, 94, 85, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 48, 150, 150, 88, 150, 150, 92, 150, 64, 150, 150, 143, 95, 128, 150, 150, 150, 149, 150, 150, 119, 150, 146, 150, 150, 150, 49, 150, 150, 150, 139, 56, 150, 55, 150, 150], "policy_policy_0_reward": [-1102.486017121908, -633.7068673737008, -1075.5166426841613, -820.2454593882566, -1220.0370535032957, -378.84291144145635, -387.91931991946876, -1182.9210882810298, -344.4574737273135, -406.03192797746505, -583.5843355479959, -823.6487671066163, -388.0251566529002, -971.8364345324405, -1052.9439541650136, -748.3900327117017, -1309.4716138488131, -183.08163918968862, -971.5051251989152, -581.8965154452767, -481.2653571644085, -788.8607509328425, -1133.8773974663993, -162.4373353767133, -920.0154351085107, -205.14466609045851, -308.45416446414, -754.286755852672, -291.12937695710224, -200.8628315813423, -1019.9703528328139, -1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597078785008673, "mean_inference_ms": 1.6835810351485267, "mean_action_processing_ms": 0.28303598788334156, "mean_env_wait_ms": 3.007042708005701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012264728546142578, "StateBufferConnector_ms": 0.008084535598754883, "ViewRequirementAgentConnector_ms": 0.19861984252929688}, "num_episodes": 30, "episode_return_max": -64.52936476317554, "episode_return_min": -1351.6791139602028, "episode_return_mean": -715.1753071969491, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.56687769198606, "num_env_steps_trained_throughput_per_sec": 304.56687769198606, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11374.342, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11374.272, "sample_time_ms": 1064.397, "learn_time_ms": 10245.897, "learn_throughput": 390.4, "synch_weights_time_ms": 63.219}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "3541f_00002", "date": "2024-08-03_03-29-33", "timestamp": 1722635973, "time_this_iter_s": 13.145059585571289, "time_total_s": 102.48266625404358, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafafa30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.48266625404358, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.321052631578947, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.07846025476853, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.165122991800308, "policy_loss": -0.011624664230233369, "vf_loss": 8.202148837347826, "vf_explained_var": 0.7925508906443913, "kl": 0.01647724514040572, "entropy": 1.5172172989696264, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6.19874633693748, "episode_reward_min": -1351.6791139602028, "episode_reward_mean": -711.7859054807075, "episode_len_mean": 135.28, "episode_media": {}, "episodes_timesteps_total": 13528, "policy_reward_min": {"policy_0": -1351.6791139602028}, "policy_reward_max": {"policy_0": -6.19874633693748}, "policy_reward_mean": {"policy_0": -711.7859054807075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096], "episode_lengths": [150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 48, 150, 150, 88, 150, 150, 92, 150, 64, 150, 150, 143, 95, 128, 150, 150, 150, 149, 150, 150, 119, 150, 146, 150, 150, 150, 49, 150, 150, 150, 139, 56, 150, 55, 150, 150, 144, 36, 150, 150, 150, 75, 89, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 84, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1013.647996684186, -775.8521470291258, -908.0324520569474, -356.4984567347524, -634.1044429430784, -1197.24180114713, -888.4857079768509, -997.8221574196131, -472.23305941139387, -615.0861200571488, -418.730556406728, -718.5615256066945, -774.9216750107398, -897.9332733527867, -952.6021839694652, -143.19884967831592, -946.1582554870886, -821.1315762883924, -759.8349639356625, -989.8139991480238, -671.7567565989742, -692.5827501711703, -1219.7971812318467, -1067.8871369715052, -1021.9632211424623, -408.17885673033044, -587.6603224221516, -886.0786062387142, -145.44418978472473, -897.2181329079013, -430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5586393108242278, "mean_inference_ms": 1.6824290838296188, "mean_action_processing_ms": 0.28272936844788477, "mean_env_wait_ms": 3.013845371808365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012421846389770508, "StateBufferConnector_ms": 0.007977962493896484, "ViewRequirementAgentConnector_ms": 0.19780492782592773}, "num_episodes": 31, "episode_return_max": -6.19874633693748, "episode_return_min": -1351.6791139602028, "episode_return_mean": -711.7859054807075, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.84539850740146, "num_env_steps_trained_throughput_per_sec": 299.84539850740146, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11570.93, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11570.859, "sample_time_ms": 1063.976, "learn_time_ms": 10442.372, "learn_throughput": 383.055, "synch_weights_time_ms": 63.743}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "3541f_00002", "date": "2024-08-03_03-29-47", "timestamp": 1722635987, "time_this_iter_s": 13.353440284729004, "time_total_s": 115.83610653877258, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafae3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.83610653877258, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.210526315789473, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.86110698978106, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.574632935225964, "policy_loss": -0.0159033079680133, "vf_loss": 7.617503639062246, "vf_explained_var": 0.841469224790732, "kl": 0.014894102226374646, "entropy": 1.5717819174130758, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -6.19874633693748, "episode_reward_min": -1351.6791139602028, "episode_reward_mean": -671.9901811360854, "episode_len_mean": 131.62, "episode_media": {}, "episodes_timesteps_total": 13162, "policy_reward_min": {"policy_0": -1351.6791139602028}, "policy_reward_max": {"policy_0": -6.19874633693748}, "policy_reward_mean": {"policy_0": -671.9901811360854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304], "episode_lengths": [150, 150, 150, 48, 150, 150, 88, 150, 150, 92, 150, 64, 150, 150, 143, 95, 128, 150, 150, 150, 149, 150, 150, 119, 150, 146, 150, 150, 150, 49, 150, 150, 150, 139, 56, 150, 55, 150, 150, 144, 36, 150, 150, 150, 75, 89, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 84, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 101, 150, 77, 76, 81, 150, 116, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150], "policy_policy_0_reward": [-430.86509920399715, -665.1894974141917, -888.7198612837545, -64.52936476317554, -929.1954657462804, -1094.2861276227047, -293.3423383854544, -1027.3166291834211, -817.9694096658193, -301.077158936726, -1309.387258370118, -111.78751873849912, -1139.0889755357198, -1112.7892180118045, -606.3693378043259, -177.17549897397927, -151.78962136190412, -896.6898281642166, -928.5986607930635, -804.8765863699198, -442.5885417523512, -933.3762180385819, -1056.9364292982327, -107.76880110194983, -644.7162238473289, -567.8126899646494, -750.7839886927388, -1042.6433662692787, -806.5232910262702, -90.62984703264826, -1122.1951522413874, -1351.6791139602028, -865.7225473495349, -291.943668703751, -105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572329599125665, "mean_inference_ms": 1.683127591058159, "mean_action_processing_ms": 0.28258845287668105, "mean_env_wait_ms": 3.0202744602449805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01212310791015625, "StateBufferConnector_ms": 0.007903575897216797, "ViewRequirementAgentConnector_ms": 0.19250869750976562}, "num_episodes": 30, "episode_return_max": -6.19874633693748, "episode_return_min": -1351.6791139602028, "episode_return_mean": -671.9901811360854, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.35119950042224, "num_env_steps_trained_throughput_per_sec": 305.35119950042224, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11666.306, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11666.236, "sample_time_ms": 1062.793, "learn_time_ms": 10540.129, "learn_throughput": 379.502, "synch_weights_time_ms": 62.54}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "3541f_00002", "date": "2024-08-03_03-30-00", "timestamp": 1722636000, "time_this_iter_s": 13.112107753753662, "time_total_s": 128.94821429252625, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafaff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.94821429252625, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.366666666666667, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.369602153201896, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.384036029378573, "policy_loss": -0.01387088355065013, "vf_loss": 7.425806184609731, "vf_explained_var": 0.8192866932600736, "kl": 0.018203926579735717, "entropy": 1.6680219521125157, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -4.447787204132665, "episode_reward_min": -1469.950813911932, "episode_reward_mean": -675.0853661514982, "episode_len_mean": 129.35, "episode_media": {}, "episodes_timesteps_total": 12935, "policy_reward_min": {"policy_0": -1469.950813911932}, "policy_reward_max": {"policy_0": -4.447787204132665}, "policy_reward_mean": {"policy_0": -675.0853661514982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627], "episode_lengths": [56, 150, 55, 150, 150, 144, 36, 150, 150, 150, 75, 89, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 84, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 101, 150, 77, 76, 81, 150, 116, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 64, 63, 150, 150, 95, 150, 150, 150, 45, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 101, 150, 83, 150, 56, 92, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-105.76023247190237, -705.0467901385015, -125.23804272777973, -1138.7839519591996, -1303.0272526008337, -469.45322155881325, -6.19874633693748, -963.4278659300907, -333.2287830356001, -951.9558969500481, -206.085042671003, -252.0050432759498, -18.90278707473267, -681.2154101560731, -1102.850139958791, -708.2451917702193, -1047.7786536249505, -267.93737442727644, -610.0563297536485, -1183.013013712399, -531.5047422401798, -641.2170003693656, -213.84395410399628, -200.11742783912757, -990.5477801310517, -973.6071379775835, -641.9576614163891, -684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563412799163955, "mean_inference_ms": 1.6844140356083444, "mean_action_processing_ms": 0.2822958384452841, "mean_env_wait_ms": 3.0295157349545216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012068510055541992, "StateBufferConnector_ms": 0.007782697677612305, "ViewRequirementAgentConnector_ms": 0.18842744827270508}, "num_episodes": 34, "episode_return_max": -4.447787204132665, "episode_return_min": -1469.950813911932, "episode_return_mean": -675.0853661514982, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.9992151967282, "num_env_steps_trained_throughput_per_sec": 303.9992151967282, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11861.5, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11861.429, "sample_time_ms": 1063.42, "learn_time_ms": 10734.532, "learn_throughput": 372.629, "synch_weights_time_ms": 62.696}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "3541f_00002", "date": "2024-08-03_03-30-13", "timestamp": 1722636013, "time_this_iter_s": 13.170675992965698, "time_total_s": 142.11889028549194, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafafe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.11889028549194, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.389473684210525, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.734904251496, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.201986340681712, "policy_loss": -0.007711294658171634, "vf_loss": 7.237667012711366, "vf_explained_var": 0.7844320196037491, "kl": 0.018161184584490304, "entropy": 1.6708851606895527, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -4.447787204132665, "episode_reward_min": -1469.950813911932, "episode_reward_mean": -721.7970126318994, "episode_len_mean": 132.27, "episode_media": {}, "episodes_timesteps_total": 13227, "policy_reward_min": {"policy_0": -1469.950813911932}, "policy_reward_max": {"policy_0": -4.447787204132665}, "policy_reward_mean": {"policy_0": -721.7970126318994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 101, 150, 77, 76, 81, 150, 116, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 64, 63, 150, 150, 95, 150, 150, 150, 45, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 101, 150, 83, 150, 56, 92, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 137, 150, 40, 150, 150, 133, 150, 150, 66, 99], "policy_policy_0_reward": [-684.5450215584984, -997.2411383778102, -946.3353249850771, -1019.4741245236031, -431.2015290094268, -792.1460925776039, -895.0669420543313, -1178.3463201488553, -1154.4068904712096, -912.4248816654564, -846.6227220628358, -389.35515843107663, -716.2664811604126, -11.404642032542933, -1149.77836664594, -751.8308473776355, -202.33262202030818, -658.7897730634238, -112.97077700124419, -227.84159855445208, -86.27943032800938, -688.8000804868556, -189.5185590049136, -165.4064458732898, -446.71830549514806, -478.91210600021464, -789.4165720321118, -1098.3431723845763, -1079.233574903927, -761.9045998540612, -1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554564453611188, "mean_inference_ms": 1.6840135548374713, "mean_action_processing_ms": 0.2821520655336465, "mean_env_wait_ms": 3.0316243339407043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011720657348632812, "StateBufferConnector_ms": 0.007818222045898438, "ViewRequirementAgentConnector_ms": 0.18966054916381836}, "num_episodes": 27, "episode_return_max": -4.447787204132665, "episode_return_min": -1469.950813911932, "episode_return_mean": -721.7970126318994, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.3698955498286, "num_env_steps_trained_throughput_per_sec": 298.3698955498286, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12492.006, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12491.933, "sample_time_ms": 1069.322, "learn_time_ms": 11357.035, "learn_throughput": 352.205, "synch_weights_time_ms": 64.796}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "3541f_00002", "date": "2024-08-03_03-30-26", "timestamp": 1722636026, "time_this_iter_s": 13.417707920074463, "time_total_s": 155.5365982055664, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f253f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.5365982055664, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.294736842105266, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.249160303672156, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.691049825151762, "policy_loss": -0.011736062532872894, "vf_loss": 6.73145593504111, "vf_explained_var": 0.8167429355283579, "kl": 0.019254521540839658, "entropy": 1.7223220616579056, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -4.447787204132665, "episode_reward_min": -1469.950813911932, "episode_reward_mean": -739.1642593000562, "episode_len_mean": 132.71, "episode_media": {}, "episodes_timesteps_total": 13271, "policy_reward_min": {"policy_0": -1469.950813911932}, "policy_reward_max": {"policy_0": -4.447787204132665}, "policy_reward_mean": {"policy_0": -739.1642593000562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847], "episode_lengths": [150, 150, 150, 150, 150, 41, 150, 150, 150, 64, 63, 150, 150, 95, 150, 150, 150, 45, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 101, 150, 83, 150, 56, 92, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 137, 150, 40, 150, 150, 133, 150, 150, 66, 99, 100, 143, 150, 84, 132, 83, 150, 150, 150, 44, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 112, 150, 150, 150], "policy_policy_0_reward": [-1145.7681960945486, -445.2060943527901, -907.9369319080638, -792.5716626712859, -778.6621126056065, -36.004200833357004, -986.2056544661529, -996.8337324081597, -1047.546618363304, -81.52991175228944, -167.67731655840765, -673.4836358847537, -1268.793496260819, -178.35102582685434, -1121.5725589645153, -937.1818306351602, -1469.950813911932, -4.447787204132665, -799.1255111404902, -295.07776931152375, -790.2752529200671, -1082.3445003990776, -1383.329195346414, -855.2655541419466, -1018.7580340605458, -719.3963145854167, -1344.9956514518253, -1236.3810220626053, -16.860160365736096, -1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552745234551022, "mean_inference_ms": 1.683592168328547, "mean_action_processing_ms": 0.2812921730658989, "mean_env_wait_ms": 3.037408875168659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01175832748413086, "StateBufferConnector_ms": 0.007734060287475586, "ViewRequirementAgentConnector_ms": 0.19536161422729492}, "num_episodes": 30, "episode_return_max": -4.447787204132665, "episode_return_min": -1469.950813911932, "episode_return_mean": -739.1642593000562, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.32260966528645, "num_env_steps_trained_throughput_per_sec": 304.32260966528645, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13098.675, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13098.603, "sample_time_ms": 1071.074, "learn_time_ms": 11961.004, "learn_throughput": 334.42, "synch_weights_time_ms": 65.746}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "3541f_00002", "date": "2024-08-03_03-30-40", "timestamp": 1722636040, "time_this_iter_s": 13.15607213973999, "time_total_s": 168.6926703453064, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafae560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.6926703453064, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.221052631578946, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.21333211561044, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.435307045280934, "policy_loss": -0.018772346090797025, "vf_loss": 6.477858584125837, "vf_explained_var": 0.8927493443091711, "kl": 0.019880913773886292, "entropy": 1.4871739109357198, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -4.546686629355241, "episode_reward_min": -1426.1325007154146, "episode_reward_mean": -722.6520658153527, "episode_len_mean": 134.75, "episode_media": {}, "episodes_timesteps_total": 13475, "policy_reward_min": {"policy_0": -1426.1325007154146}, "policy_reward_max": {"policy_0": -4.546686629355241}, "policy_reward_mean": {"policy_0": -722.6520658153527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422], "episode_lengths": [150, 150, 101, 150, 83, 150, 56, 92, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 137, 150, 40, 150, 150, 133, 150, 150, 66, 99, 100, 143, 150, 84, 132, 83, 150, 150, 150, 44, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 112, 150, 150, 150, 150, 69, 150, 100, 150, 150, 150, 150, 67, 150, 150, 150, 80, 126, 150, 150, 150, 61, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1087.8417076386581, -862.5244391706145, -366.47497100788735, -777.8161887810028, -200.7758826106624, -945.8685656913085, -70.13134570100736, -144.2375889479984, -241.18531728800528, -580.4102042471447, -585.8012621209606, -643.5129273857051, -1242.3599856341566, -942.144108139627, -208.25879488384464, -802.0593044530426, -1057.3010143503423, -1074.403021217916, -537.4136060062226, -751.236458679863, -1177.1084963976184, -1165.872329776178, -512.8500274801015, -1129.0781318390186, -1224.4633176108232, -38.445933636437125, -1231.4070263267597, -985.5382741228738, -662.6920417516525, -686.5258187463463, -1426.1325007154146, -629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546296076000234, "mean_inference_ms": 1.6822419516100018, "mean_action_processing_ms": 0.28096322865498047, "mean_env_wait_ms": 3.0383650234833532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011786460876464844, "StateBufferConnector_ms": 0.007853984832763672, "ViewRequirementAgentConnector_ms": 0.19962620735168457}, "num_episodes": 29, "episode_return_max": -4.546686629355241, "episode_return_min": -1426.1325007154146, "episode_return_mean": -722.6520658153527, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.47806646821573, "num_env_steps_trained_throughput_per_sec": 307.47806646821573, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13125.764, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13125.691, "sample_time_ms": 1067.734, "learn_time_ms": 11992.853, "learn_throughput": 333.532, "synch_weights_time_ms": 64.323}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "3541f_00002", "date": "2024-08-03_03-30-53", "timestamp": 1722636053, "time_this_iter_s": 13.022972345352173, "time_total_s": 181.71564269065857, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafaf010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.71564269065857, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.766666666666666, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.15741552114487, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.117812639474868, "policy_loss": -0.0147580906234604, "vf_loss": 6.157334586481253, "vf_explained_var": 0.8973013693466783, "kl": 0.023765593586055445, "entropy": 1.5946767183641593, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -4.546686629355241, "episode_reward_min": -1409.2463766945639, "episode_reward_mean": -703.8548258930596, "episode_len_mean": 134.82, "episode_media": {}, "episodes_timesteps_total": 13482, "policy_reward_min": {"policy_0": -1409.2463766945639}, "policy_reward_max": {"policy_0": -4.546686629355241}, "policy_reward_mean": {"policy_0": -703.8548258930596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875], "episode_lengths": [137, 150, 40, 150, 150, 133, 150, 150, 66, 99, 100, 143, 150, 84, 132, 83, 150, 150, 150, 44, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 112, 150, 150, 150, 150, 69, 150, 100, 150, 150, 150, 150, 67, 150, 150, 150, 80, 126, 150, 150, 150, 61, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 46, 150, 150, 106, 79, 150, 150, 150, 150, 150, 147, 150, 144], "policy_policy_0_reward": [-629.8156283287741, -973.8635476605904, -13.607134799543845, -1046.7615296943634, -935.8160834233503, -633.351088702185, -1052.9788765908236, -697.8282713626508, -136.91219238517004, -252.44967131066306, -384.29177546284006, -629.8691455595027, -895.4840553612345, -310.5234549035053, -646.5914779857719, -243.5218062692198, -750.8494981445461, -1127.795942350149, -1121.7677503501639, -4.546686629355241, -1275.548423380835, -860.0664070745587, -380.9507569540805, -532.3633644501928, -1051.2289433760077, -499.4190626127789, -912.3571162729488, -854.2963176501835, -1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544684181068942, "mean_inference_ms": 1.68353874598788, "mean_action_processing_ms": 0.2808242677406136, "mean_env_wait_ms": 3.0448535824858483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165151596069336, "StateBufferConnector_ms": 0.0078277587890625, "ViewRequirementAgentConnector_ms": 0.20470714569091797}, "num_episodes": 31, "episode_return_max": -4.546686629355241, "episode_return_min": -1409.2463766945639, "episode_return_mean": -703.8548258930596, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.02530847973594, "num_env_steps_trained_throughput_per_sec": 306.02530847973594, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13140.614, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13140.539, "sample_time_ms": 1070.367, "learn_time_ms": 12004.73, "learn_throughput": 333.202, "synch_weights_time_ms": 64.662}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "3541f_00002", "date": "2024-08-03_03-31-06", "timestamp": 1722636066, "time_this_iter_s": 13.0827956199646, "time_total_s": 194.79843831062317, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.79843831062317, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.06315789473684, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.062969913085304, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.655020797252655, "policy_loss": -0.01129930762690492, "vf_loss": 6.691084922850132, "vf_explained_var": 0.9278846396133303, "kl": 0.014675141851500938, "entropy": 1.568431317806244, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -23.400803737948912, "episode_reward_min": -1409.2463766945639, "episode_reward_mean": -706.8423682975081, "episode_len_mean": 137.08, "episode_media": {}, "episodes_timesteps_total": 13708, "policy_reward_min": {"policy_0": -1409.2463766945639}, "policy_reward_max": {"policy_0": -23.400803737948912}, "policy_reward_mean": {"policy_0": -706.8423682975081}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097], "episode_lengths": [150, 150, 150, 81, 150, 150, 150, 150, 112, 150, 150, 150, 150, 69, 150, 100, 150, 150, 150, 150, 67, 150, 150, 150, 80, 126, 150, 150, 150, 61, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 46, 150, 150, 106, 79, 150, 150, 150, 150, 150, 147, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 92, 133, 80, 150, 150, 99, 150, 150, 150, 150, 150, 102, 150, 150, 150, 84], "policy_policy_0_reward": [-1319.080302865504, -1033.0170672322379, -710.2452472498339, -145.48735434301292, -1247.8867394200636, -755.1648592314934, -397.162328259919, -1061.2514698854125, -370.3143963594644, -803.2538260971282, -609.1735657295787, -666.1296254389847, -774.2961581070377, -207.94748329232246, -1029.7330475578542, -371.11174242817117, -1098.0319162947742, -1056.9945158817106, -856.0843152607267, -333.6347760930263, -166.26027353633316, -703.355094431919, -744.975724100876, -961.8045510765932, -209.89278393334453, -430.43398980462564, -819.3074964926852, -899.0506001703101, -1046.5253807341685, -70.08946790535396, -1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543171811127905, "mean_inference_ms": 1.6814014444862762, "mean_action_processing_ms": 0.28035271082443713, "mean_env_wait_ms": 3.043508498224099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011899232864379883, "StateBufferConnector_ms": 0.007862567901611328, "ViewRequirementAgentConnector_ms": 0.20548009872436523}, "num_episodes": 28, "episode_return_max": -23.400803737948912, "episode_return_min": -1409.2463766945639, "episode_return_mean": -706.8423682975081, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.7818493380189, "num_env_steps_trained_throughput_per_sec": 307.7818493380189, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13162.902, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13162.828, "sample_time_ms": 1068.465, "learn_time_ms": 12028.444, "learn_throughput": 332.545, "synch_weights_time_ms": 65.136}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "3541f_00002", "date": "2024-08-03_03-31-19", "timestamp": 1722636079, "time_this_iter_s": 13.008809566497803, "time_total_s": 207.80724787712097, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.80724787712097, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.068421052631578, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.82708205680052, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.594135528802871, "policy_loss": -0.020405664171751898, "vf_loss": 6.642580654720465, "vf_explained_var": 0.9160906846945485, "kl": 0.016249466538314057, "entropy": 1.7675858927269776, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.400803737948912, "episode_reward_min": -1492.681910208108, "episode_reward_mean": -710.6214441225943, "episode_len_mean": 137.01, "episode_media": {}, "episodes_timesteps_total": 13701, "policy_reward_min": {"policy_0": -1492.681910208108}, "policy_reward_max": {"policy_0": -23.400803737948912}, "policy_reward_mean": {"policy_0": -710.6214441225943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736], "episode_lengths": [150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 46, 150, 150, 106, 79, 150, 150, 150, 150, 150, 147, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 92, 133, 80, 150, 150, 99, 150, 150, 150, 150, 150, 102, 150, 150, 150, 84, 150, 150, 150, 150, 150, 86, 95, 150, 137, 150, 150, 55, 150, 150, 150, 124, 140, 79, 120, 150, 150, 150, 150, 116, 150, 150, 150, 93, 94, 150], "policy_policy_0_reward": [-1409.2463766945639, -588.547523207922, -420.035656939791, -388.107390780867, -1132.5113025712158, -569.7230904942655, -828.3467093602355, -1018.2017346135857, -1028.970419170265, -1049.500537976651, -717.5931391062422, -1030.5394021794302, -1145.1112787108136, -856.7331996726998, -681.9053442323032, -1140.2243974681558, -311.5689288284491, -705.4150287273721, -159.0305429230923, -947.7580441972764, -726.1033448360286, -862.5559789714918, -576.4174826101257, -538.2981393117591, -965.356731904894, -877.4622131353146, -425.6014672976061, -1006.2013513785349, -37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539888080643122, "mean_inference_ms": 1.681219466431551, "mean_action_processing_ms": 0.28020689782676156, "mean_env_wait_ms": 3.0439804593277726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011986732482910156, "StateBufferConnector_ms": 0.0077457427978515625, "ViewRequirementAgentConnector_ms": 0.19559764862060547}, "num_episodes": 30, "episode_return_max": -23.400803737948912, "episode_return_min": -1492.681910208108, "episode_return_mean": -710.6214441225943, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9747779861619, "num_env_steps_trained_throughput_per_sec": 297.9747779861619, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13178.151, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13178.078, "sample_time_ms": 1073.433, "learn_time_ms": 12038.747, "learn_throughput": 332.26, "synch_weights_time_ms": 65.124}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "3541f_00002", "date": "2024-08-03_03-31-32", "timestamp": 1722636092, "time_this_iter_s": 13.435957431793213, "time_total_s": 221.24320530891418, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f255a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.24320530891418, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.12105263157895, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.1250460922718, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.051327536255121, "policy_loss": -0.01278984675494333, "vf_loss": 6.089049582183361, "vf_explained_var": 0.8912691688165069, "kl": 0.013808442609903675, "entropy": 1.5573009128371875, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -23.400803737948912, "episode_reward_min": -1492.681910208108, "episode_reward_mean": -699.2527618474971, "episode_len_mean": 134.88, "episode_media": {}, "episodes_timesteps_total": 13488, "policy_reward_min": {"policy_0": -1492.681910208108}, "policy_reward_max": {"policy_0": -23.400803737948912}, "policy_reward_mean": {"policy_0": -699.2527618474971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414], "episode_lengths": [63, 46, 150, 150, 106, 79, 150, 150, 150, 150, 150, 147, 150, 144, 100, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 92, 133, 80, 150, 150, 99, 150, 150, 150, 150, 150, 102, 150, 150, 150, 84, 150, 150, 150, 150, 150, 86, 95, 150, 137, 150, 150, 55, 150, 150, 150, 124, 140, 79, 120, 150, 150, 150, 150, 116, 150, 150, 150, 93, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 53, 150, 106, 150, 150, 150, 150, 150, 117, 108, 150, 150, 150, 150, 150, 99], "policy_policy_0_reward": [-37.614459818949946, -23.400803737948912, -932.4973136218517, -987.7611034210174, -411.92277324135523, -253.99851716882182, -285.05785865430755, -1231.6529084661202, -559.7094941887729, -730.7425258278671, -668.2015092358793, -736.794332667027, -1048.020111691761, -618.4900120028875, -361.7101083953006, -866.8311138382603, -1212.730065043068, -1257.6715629953737, -1045.219396494881, -888.6566558451034, -429.7457684150553, -316.1272996726825, -295.02087947098283, -493.1198437754795, -1058.1006769550033, -916.8705705168032, -211.71722022823914, -610.1256718962137, -303.56294269125544, -363.1305963122935, -935.0671281504758, -355.1748629847497, -1132.1715578106398, -944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536588724556915, "mean_inference_ms": 1.6809920848410045, "mean_action_processing_ms": 0.2799417792096629, "mean_env_wait_ms": 3.0449241092017116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325286865234375, "StateBufferConnector_ms": 0.007860660552978516, "ViewRequirementAgentConnector_ms": 0.19878315925598145}, "num_episodes": 28, "episode_return_max": -23.400803737948912, "episode_return_min": -1492.681910208108, "episode_return_mean": -699.2527618474971, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.2078679413631, "num_env_steps_trained_throughput_per_sec": 303.2078679413631, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13184.037, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13183.965, "sample_time_ms": 1073.431, "learn_time_ms": 12046.337, "learn_throughput": 332.051, "synch_weights_time_ms": 63.409}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "3541f_00002", "date": "2024-08-03_03-31-46", "timestamp": 1722636106, "time_this_iter_s": 13.20499849319458, "time_total_s": 234.44820380210876, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f25ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.44820380210876, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.089473684210528, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.909277288119, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.389401050905387, "policy_loss": -0.011153919764910824, "vf_loss": 6.426428294678529, "vf_explained_var": 0.8876467367013295, "kl": 0.01593469382884604, "entropy": 1.6521960253516832, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -42.38298212416961, "episode_reward_min": -1492.681910208108, "episode_reward_mean": -731.4382606527056, "episode_len_mean": 136.42, "episode_media": {}, "episodes_timesteps_total": 13642, "policy_reward_min": {"policy_0": -1492.681910208108}, "policy_reward_max": {"policy_0": -42.38298212416961}, "policy_reward_mean": {"policy_0": -731.4382606527056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888], "episode_lengths": [150, 150, 150, 150, 102, 150, 150, 150, 84, 150, 150, 150, 150, 150, 86, 95, 150, 137, 150, 150, 55, 150, 150, 150, 124, 140, 79, 120, 150, 150, 150, 150, 116, 150, 150, 150, 93, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 53, 150, 106, 150, 150, 150, 150, 150, 117, 108, 150, 150, 150, 150, 150, 99, 150, 150, 82, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 144, 57, 150, 100, 150, 150, 150, 126, 121, 150, 150, 150, 150, 150, 83, 150, 150, 150], "policy_policy_0_reward": [-944.4764200673516, -915.4563672940691, -973.4470145351702, -794.0155960347313, -149.06738631919237, -343.89158275572834, -1046.7321534432197, -841.7360236596767, -92.03378388983097, -1170.7038560131182, -1150.6764217843727, -942.9264340173569, -827.0004299203729, -1196.4623443789103, -187.2586833110349, -261.6847203513394, -766.911155406721, -446.94484805531755, -655.9113305899725, -350.9206762281485, -99.90081085928034, -702.5787658195594, -1051.9892285829117, -1227.4021824249558, -568.7176548349936, -108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534699134688109, "mean_inference_ms": 1.6818669672161113, "mean_action_processing_ms": 0.27994695603874153, "mean_env_wait_ms": 3.049770518475926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012333154678344727, "StateBufferConnector_ms": 0.007690906524658203, "ViewRequirementAgentConnector_ms": 0.19099640846252441}, "num_episodes": 33, "episode_return_max": -42.38298212416961, "episode_return_min": -1492.681910208108, "episode_return_mean": -731.4382606527056, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.17609417973546, "num_env_steps_trained_throughput_per_sec": 303.17609417973546, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13169.381, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13169.311, "sample_time_ms": 1076.83, "learn_time_ms": 12028.971, "learn_throughput": 332.531, "synch_weights_time_ms": 62.731}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "3541f_00002", "date": "2024-08-03_03-31-59", "timestamp": 1722636119, "time_this_iter_s": 13.206783056259155, "time_total_s": 247.65498685836792, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.65498685836792, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.644444444444446, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.92657894690832, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.501294787228107, "policy_loss": -0.005080754086763287, "vf_loss": 5.541608804712693, "vf_explained_var": 0.9130413443470995, "kl": 0.01344928456761257, "entropy": 2.064271704107523, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -42.38298212416961, "episode_reward_min": -1492.681910208108, "episode_reward_mean": -767.4044963888124, "episode_len_mean": 136.97, "episode_media": {}, "episodes_timesteps_total": 13697, "policy_reward_min": {"policy_0": -1492.681910208108}, "policy_reward_max": {"policy_0": -42.38298212416961}, "policy_reward_mean": {"policy_0": -767.4044963888124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376], "episode_lengths": [140, 79, 120, 150, 150, 150, 150, 116, 150, 150, 150, 93, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 53, 150, 106, 150, 150, 150, 150, 150, 117, 108, 150, 150, 150, 150, 150, 99, 150, 150, 82, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 144, 57, 150, 100, 150, 150, 150, 126, 121, 150, 150, 150, 150, 150, 83, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 128, 79, 150, 150, 62, 150, 150, 150, 150, 150, 106, 150, 83, 150, 150, 145], "policy_policy_0_reward": [-108.49136121141396, -184.8738480665915, -155.34584415622544, -1492.681910208108, -1236.6030953375491, -718.1992138840018, -540.4897564953103, -194.2043884402483, -1206.4954031182526, -1354.3532405237172, -1156.5825734349794, -166.84278474020604, -103.1583634594303, -1049.2923560686736, -490.7783894752487, -724.3163592653578, -1135.2791940050124, -906.3689682708939, -485.98259619322323, -1162.656241573963, -1297.0320283693247, -1279.4390387571596, -1150.9785909321463, -469.4493570274853, -445.1108466044165, -395.6345754171212, -102.67392293970322, -762.9926135031374, -396.5889629626201, -855.7258352597413, -1228.4404201826515, -393.77291091898576, -1188.6283968194093, -671.3856474915005, -234.98821529898677, -371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526411470240936, "mean_inference_ms": 1.6811432710498986, "mean_action_processing_ms": 0.27953748611772256, "mean_env_wait_ms": 3.05263225684254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857986450195312, "StateBufferConnector_ms": 0.00761723518371582, "ViewRequirementAgentConnector_ms": 0.18887758255004883}, "num_episodes": 25, "episode_return_max": -42.38298212416961, "episode_return_min": -1492.681910208108, "episode_return_mean": -767.4044963888124, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.169379505261, "num_env_steps_trained_throughput_per_sec": 398.169379505261, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12864.012, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12863.941, "sample_time_ms": 1082.083, "learn_time_ms": 11718.842, "learn_throughput": 341.331, "synch_weights_time_ms": 62.243}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "3541f_00002", "date": "2024-08-03_03-32-09", "timestamp": 1722636129, "time_this_iter_s": 10.05922794342041, "time_total_s": 257.71421480178833, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.71421480178833, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.939999999999998, "ram_util_percent": 27.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.5127590139707, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.023960719257593, "policy_loss": -0.009890117067940688, "vf_loss": 6.060873930156231, "vf_explained_var": 0.9472310320163767, "kl": 0.014004861088809209, "entropy": 1.6662636917084455, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -24.540764665731267, "episode_reward_min": -1516.4454744594452, "episode_reward_mean": -756.4560768710285, "episode_len_mean": 134.04, "episode_media": {}, "episodes_timesteps_total": 13404, "policy_reward_min": {"policy_0": -1516.4454744594452}, "policy_reward_max": {"policy_0": -24.540764665731267}, "policy_reward_mean": {"policy_0": -756.4560768710285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038], "episode_lengths": [108, 150, 150, 150, 150, 150, 99, 150, 150, 82, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 144, 57, 150, 100, 150, 150, 150, 126, 121, 150, 150, 150, 150, 150, 83, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 128, 79, 150, 150, 62, 150, 150, 150, 150, 150, 106, 150, 83, 150, 150, 145, 150, 77, 123, 150, 131, 150, 150, 75, 150, 150, 150, 150, 150, 150, 80, 150, 128, 150, 150, 150, 90, 50, 150, 150, 56, 93, 107, 91, 150, 150, 150, 150, 150, 150, 86], "policy_policy_0_reward": [-371.21641022198247, -802.4877902878746, -841.9362767956213, -702.1137212710069, -1025.7497410907913, -1267.285824751722, -181.18565410415414, -391.9257881412753, -1104.99842231218, -142.06218088324493, -1033.0583090161044, -1265.6815192997303, -698.7581793687652, -816.305633301908, -42.38298212416961, -733.9387679500963, -1273.0003123131512, -1025.820315124271, -716.8226791174503, -1047.6968494920504, -1294.5295758180353, -631.241123450875, -674.6079022702123, -140.17688442038317, -1423.4350713192111, -409.9931719527264, -583.2022856982892, -1007.368260952024, -793.9461002277937, -513.8721820216882, -526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522685131839757, "mean_inference_ms": 1.681091201663545, "mean_action_processing_ms": 0.2795338421418755, "mean_env_wait_ms": 3.057604150511497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000083923339844, "StateBufferConnector_ms": 0.0076940059661865234, "ViewRequirementAgentConnector_ms": 0.18876028060913086}, "num_episodes": 35, "episode_return_max": -24.540764665731267, "episode_return_min": -1516.4454744594452, "episode_return_mean": -756.4560768710285, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0267067595576, "num_env_steps_trained_throughput_per_sec": 311.0267067595576, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12834.282, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12834.212, "sample_time_ms": 1085.07, "learn_time_ms": 11685.928, "learn_throughput": 342.292, "synch_weights_time_ms": 62.438}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "3541f_00002", "date": "2024-08-03_03-32-22", "timestamp": 1722636142, "time_this_iter_s": 12.872941017150879, "time_total_s": 270.5871558189392, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafae320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.5871558189392, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.505555555555556, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.1879748940468, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.5408568578461805, "policy_loss": -0.01124647879890593, "vf_loss": 5.578207784642776, "vf_explained_var": 0.9527951445430517, "kl": 0.013001045457516153, "entropy": 1.5977465081959963, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -24.540764665731267, "episode_reward_min": -1516.4454744594452, "episode_reward_mean": -729.686066266923, "episode_len_mean": 132.38, "episode_media": {}, "episodes_timesteps_total": 13238, "policy_reward_min": {"policy_0": -1516.4454744594452}, "policy_reward_max": {"policy_0": -24.540764665731267}, "policy_reward_mean": {"policy_0": -729.686066266923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907], "episode_lengths": [121, 150, 150, 150, 150, 150, 83, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 128, 79, 150, 150, 62, 150, 150, 150, 150, 150, 106, 150, 83, 150, 150, 145, 150, 77, 123, 150, 131, 150, 150, 75, 150, 150, 150, 150, 150, 150, 80, 150, 128, 150, 150, 150, 90, 50, 150, 150, 56, 93, 107, 91, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 85, 150, 63, 150, 54, 150, 150, 77, 150, 150, 150, 150, 127, 150, 150, 150, 145, 126, 88, 150, 65, 150, 150, 150, 79, 150], "policy_policy_0_reward": [-526.0837269716698, -907.2953768885495, -1077.109603868849, -935.2445649741354, -986.6860410387084, -642.8815639219483, -162.11684642707658, -795.7353925227319, -438.06533064627683, -561.1245819216888, -488.89224107508875, -1446.006000549865, -651.9815321995969, -1100.8509243485003, -771.2057412378516, -1015.5610216375724, -1275.3289843941977, -1205.6257585316196, -1117.9682186279401, -300.961287251823, -71.60765199863806, -974.9432281961431, -1162.9691949154444, -73.87186114717856, -804.6945875905477, -1100.3519463688763, -935.8946692337163, -989.1425667046707, -1298.7515332299217, -405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55188054850647, "mean_inference_ms": 1.6786478768299862, "mean_action_processing_ms": 0.27920657289792866, "mean_env_wait_ms": 3.0577787565665266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012018918991088867, "StateBufferConnector_ms": 0.007779359817504883, "ViewRequirementAgentConnector_ms": 0.18991851806640625}, "num_episodes": 30, "episode_return_max": -24.540764665731267, "episode_return_min": -1516.4454744594452, "episode_return_mean": -729.686066266923, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.47100902321455, "num_env_steps_trained_throughput_per_sec": 306.47100902321455, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12798.845, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12798.774, "sample_time_ms": 1084.376, "learn_time_ms": 11651.596, "learn_throughput": 343.301, "synch_weights_time_ms": 62.02}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "3541f_00002", "date": "2024-08-03_03-32-35", "timestamp": 1722636155, "time_this_iter_s": 13.065640211105347, "time_total_s": 283.65279603004456, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f252d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.65279603004456, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.126315789473683, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.21587391495704, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.023085908095042, "policy_loss": -0.004245587221521419, "vf_loss": 5.053771427770456, "vf_explained_var": 0.954051596733431, "kl": 0.013847982440772007, "entropy": 1.6335758933176596, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -24.540764665731267, "episode_reward_min": -1516.4454744594452, "episode_reward_mean": -694.6523068329817, "episode_len_mean": 130.26, "episode_media": {}, "episodes_timesteps_total": 13026, "policy_reward_min": {"policy_0": -1516.4454744594452}, "policy_reward_max": {"policy_0": -24.540764665731267}, "policy_reward_mean": {"policy_0": -694.6523068329817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707], "episode_lengths": [106, 150, 83, 150, 150, 145, 150, 77, 123, 150, 131, 150, 150, 75, 150, 150, 150, 150, 150, 150, 80, 150, 128, 150, 150, 150, 90, 50, 150, 150, 56, 93, 107, 91, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 85, 150, 63, 150, 54, 150, 150, 77, 150, 150, 150, 150, 127, 150, 150, 150, 145, 126, 88, 150, 65, 150, 150, 150, 79, 150, 150, 66, 150, 145, 117, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 53, 150, 66, 150, 150, 150, 59, 150, 150, 150, 150, 46, 150], "policy_policy_0_reward": [-405.38817314507816, -1415.3520540751974, -109.74142275878754, -832.7809848928546, -894.6134883731727, -860.9843717037376, -818.8667689137721, -177.47477325774713, -405.3432313529256, -1277.063468107002, -363.04593036647566, -1204.900051964776, -666.3421015756774, -67.56411440187316, -643.7503635963335, -952.9381597376605, -948.4947422398183, -837.585302344453, -944.1587034138975, -1006.3625365036855, -330.5535828228583, -1096.2289362078718, -561.0682879429033, -1052.07375966706, -224.16273850029816, -641.8154462365849, -283.1068777566907, -24.540764665731267, -822.6276818411212, -1516.4454744594452, -39.87272169921034, -310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516911575309789, "mean_inference_ms": 1.6790703843791654, "mean_action_processing_ms": 0.27914627879065135, "mean_env_wait_ms": 3.0607026349304034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012212991714477539, "StateBufferConnector_ms": 0.007874011993408203, "ViewRequirementAgentConnector_ms": 0.19757437705993652}, "num_episodes": 29, "episode_return_max": -24.540764665731267, "episode_return_min": -1516.4454744594452, "episode_return_mean": -694.6523068329817, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.81307143234613, "num_env_steps_trained_throughput_per_sec": 308.81307143234613, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12779.732, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12779.662, "sample_time_ms": 1084.019, "learn_time_ms": 11632.656, "learn_throughput": 343.86, "synch_weights_time_ms": 62.203}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "3541f_00002", "date": "2024-08-03_03-32-48", "timestamp": 1722636168, "time_this_iter_s": 12.964900016784668, "time_total_s": 296.6176960468292, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f265f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.6176960468292, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.83888888888889, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.43071290651957, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.005213274558385, "policy_loss": -0.007413660885261682, "vf_loss": 5.044060628861189, "vf_explained_var": 0.9579845143482089, "kl": 0.013119758785205705, "entropy": 1.8668792363256217, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -26.424486680138056, "episode_reward_min": -1391.3218021871164, "episode_reward_mean": -699.4936967550854, "episode_len_mean": 131.61, "episode_media": {}, "episodes_timesteps_total": 13161, "policy_reward_min": {"policy_0": -1391.3218021871164}, "policy_reward_max": {"policy_0": -26.424486680138056}, "policy_reward_mean": {"policy_0": -699.4936967550854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583], "episode_lengths": [93, 107, 91, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 85, 150, 63, 150, 54, 150, 150, 77, 150, 150, 150, 150, 127, 150, 150, 150, 145, 126, 88, 150, 65, 150, 150, 150, 79, 150, 150, 66, 150, 145, 117, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 53, 150, 66, 150, 150, 150, 59, 150, 150, 150, 150, 46, 150, 150, 112, 84, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 116, 68, 131, 150, 150, 150, 150, 150, 150, 114, 114, 55], "policy_policy_0_reward": [-310.5475641136032, -305.9818235030626, -199.2628674573394, -1011.9019519794145, -780.2794461296353, -1074.4372520106645, -1391.3218021871164, -1005.439546122495, -1207.1465142093532, -158.29001134584038, -869.6644539762555, -980.1586526223318, -471.34913747579355, -1376.777568330056, -109.65263800747405, -1123.4754719852392, -72.64587009585742, -930.4268023846832, -39.5608451614663, -662.4979057014476, -872.679153942193, -248.51347270194847, -891.3626404371687, -562.3064484218282, -564.6223454278241, -702.7763565569962, -286.83012017341383, -1142.3344370439468, -992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512040545737119, "mean_inference_ms": 1.6788272421961454, "mean_action_processing_ms": 0.2789288019227654, "mean_env_wait_ms": 3.0624694388304374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012136220932006836, "StateBufferConnector_ms": 0.00802302360534668, "ViewRequirementAgentConnector_ms": 0.2068192958831787}, "num_episodes": 31, "episode_return_max": -26.424486680138056, "episode_return_min": -1391.3218021871164, "episode_return_mean": -699.4936967550854, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7038819367571, "num_env_steps_trained_throughput_per_sec": 308.7038819367571, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12774.567, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12774.497, "sample_time_ms": 1084.652, "learn_time_ms": 11626.487, "learn_throughput": 344.042, "synch_weights_time_ms": 62.568}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-01", "timestamp": 1722636181, "time_this_iter_s": 12.969135522842407, "time_total_s": 309.58683156967163, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f26ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.58683156967163, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.326315789473686, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.64645158251128, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.24004945581158, "policy_loss": -0.012616714045482999, "vf_loss": 5.279652076214552, "vf_explained_var": 0.9684152963260809, "kl": 0.015339431761952937, "entropy": 1.6944327759246032, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -26.424486680138056, "episode_reward_min": -1416.022240327778, "episode_reward_mean": -718.8101675261624, "episode_len_mean": 133.64, "episode_media": {}, "episodes_timesteps_total": 13364, "policy_reward_min": {"policy_0": -1416.022240327778}, "policy_reward_max": {"policy_0": -26.424486680138056}, "policy_reward_mean": {"policy_0": -718.8101675261624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594], "episode_lengths": [150, 150, 145, 126, 88, 150, 65, 150, 150, 150, 79, 150, 150, 66, 150, 145, 117, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 53, 150, 66, 150, 150, 150, 59, 150, 150, 150, 150, 46, 150, 150, 112, 84, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 116, 68, 131, 150, 150, 150, 150, 150, 150, 114, 114, 55, 150, 150, 150, 150, 150, 150, 149, 150, 150, 96, 150, 150, 81, 58, 150, 150, 89, 150, 99, 150, 150, 150, 150, 150, 150, 114, 150, 150], "policy_policy_0_reward": [-992.4165840814846, -619.3817955076919, -496.0574049599652, -473.14341452943387, -273.9136272076066, -715.646494238245, -113.01953870022096, -1294.816712510367, -1066.5634027207739, -810.5859479018942, -216.3010482177459, -1300.3185636668907, -739.2014839207867, -26.424486680138056, -583.1415246978, -808.2727381651745, -424.22999169479266, -951.6047335412271, -755.5969538684488, -689.4405154979829, -1095.4252295858673, -729.7020902195749, -792.049136315959, -562.6830200375398, -810.8915700150402, -635.300983914707, -1046.685428882962, -484.3546477587398, -36.311001247524004, -860.1462382558997, -58.08241311182951, -1381.079180071427, -1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510820103126981, "mean_inference_ms": 1.6782126996095115, "mean_action_processing_ms": 0.2784914572634339, "mean_env_wait_ms": 3.0627586232933863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259483337402344, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.20726656913757324}, "num_episodes": 28, "episode_return_max": -26.424486680138056, "episode_return_min": -1416.022240327778, "episode_return_mean": -718.8101675261624, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.891266207598, "num_env_steps_trained_throughput_per_sec": 319.891266207598, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12717.91, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12717.841, "sample_time_ms": 1087.496, "learn_time_ms": 11565.955, "learn_throughput": 345.843, "synch_weights_time_ms": 63.598}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-14", "timestamp": 1722636194, "time_this_iter_s": 12.516974925994873, "time_total_s": 322.1038064956665, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafaedd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.1038064956665, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.505555555555553, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.1524714211623, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.141765164335569, "policy_loss": -0.009104300083708949, "vf_loss": 5.183249092598756, "vf_explained_var": 0.9687147450943788, "kl": 0.016574619410524398, "entropy": 1.9919101886451245, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -51.37705742747676, "episode_reward_min": -1416.022240327778, "episode_reward_mean": -708.0684856555449, "episode_len_mean": 131.66, "episode_media": {}, "episodes_timesteps_total": 13166, "policy_reward_min": {"policy_0": -1416.022240327778}, "policy_reward_max": {"policy_0": -51.37705742747676}, "policy_reward_mean": {"policy_0": -708.0684856555449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528], "episode_lengths": [150, 150, 59, 150, 150, 150, 150, 46, 150, 150, 112, 84, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 116, 68, 131, 150, 150, 150, 150, 150, 150, 114, 114, 55, 150, 150, 150, 150, 150, 150, 149, 150, 150, 96, 150, 150, 81, 58, 150, 150, 89, 150, 99, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 100, 54, 150, 64, 123, 150, 150, 150, 112, 150, 150, 150, 150, 112, 150, 150, 91, 150, 49, 116, 150, 150, 150, 102, 76, 150, 150, 108, 150, 145, 94], "policy_policy_0_reward": [-1037.657077566634, -1115.9321946069058, -70.98401546610421, -973.402548972132, -1295.9429584889756, -543.831725025269, -1174.8675084292038, -51.37705742747676, -580.9575815605707, -759.7608965047167, -234.73567846823025, -115.14729756814374, -253.04336199016691, -891.1629291652998, -827.0809192301192, -1194.1163410516729, -662.3621755172535, -1123.6192574591066, -591.609797085169, -1167.2601938668586, -1267.589667541822, -1138.2356070034737, -680.3738869275746, -96.12067356352667, -411.34113308518164, -1119.1153104293994, -896.9986891275078, -766.7901716827884, -344.6626734516715, -122.32575485189788, -646.862983779108, -976.8699514393677, -988.305537330435, -1033.0667774562953, -479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514904207690211, "mean_inference_ms": 1.6803090547531938, "mean_action_processing_ms": 0.27879059028335346, "mean_env_wait_ms": 3.0677930687577577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012149572372436523, "StateBufferConnector_ms": 0.007911205291748047, "ViewRequirementAgentConnector_ms": 0.21392226219177246}, "num_episodes": 32, "episode_return_max": -51.37705742747676, "episode_return_min": -1416.022240327778, "episode_return_mean": -708.0684856555449, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.93754554243134, "num_env_steps_trained_throughput_per_sec": 315.93754554243134, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12684.361, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12684.291, "sample_time_ms": 1093.363, "learn_time_ms": 11527.055, "learn_throughput": 347.01, "synch_weights_time_ms": 63.085}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-26", "timestamp": 1722636206, "time_this_iter_s": 12.673304796218872, "time_total_s": 334.7771112918854, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f26dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.7771112918854, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.783333333333335, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.86250824928283, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.860010372598966, "policy_loss": -0.010270212226896547, "vf_loss": 4.897881338745355, "vf_explained_var": 0.9813420447210471, "kl": 0.015922229490661292, "entropy": 1.7382885217666626, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -66.08214784985451, "episode_reward_min": -1416.022240327778, "episode_reward_mean": -696.1875237910963, "episode_len_mean": 130.67, "episode_media": {}, "episodes_timesteps_total": 13067, "policy_reward_min": {"policy_0": -1416.022240327778}, "policy_reward_max": {"policy_0": -66.08214784985451}, "policy_reward_mean": {"policy_0": -696.1875237910963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922], "episode_lengths": [150, 150, 150, 114, 114, 55, 150, 150, 150, 150, 150, 150, 149, 150, 150, 96, 150, 150, 81, 58, 150, 150, 89, 150, 99, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 100, 54, 150, 64, 123, 150, 150, 150, 112, 150, 150, 150, 150, 112, 150, 150, 91, 150, 49, 116, 150, 150, 150, 102, 76, 150, 150, 108, 150, 145, 94, 150, 107, 150, 150, 116, 150, 96, 150, 72, 150, 150, 72, 150, 107, 81, 150, 112, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 107, 150, 93], "policy_policy_0_reward": [-479.0337647604138, -1268.040942958584, -807.457370221714, -489.78495066909784, -433.9073921393738, -122.60392040910583, -1257.3118777439377, -863.4364827201141, -641.3074815446797, -997.2382873989628, -709.3914010454288, -1064.956541412734, -417.08876319364435, -1142.2090456206508, -1007.5979002769456, -136.43662551745228, -991.0852154906261, -704.0649397421055, -302.69017255725424, -76.04950310631757, -1259.8152561108805, -1238.0596528641536, -342.9573695645242, -839.3354659672138, -295.94306307788435, -772.214604470519, -954.3098473904718, -909.0911862371537, -537.8884919664243, -806.9847639956728, -1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518387148644446, "mean_inference_ms": 1.680675057403705, "mean_action_processing_ms": 0.2788205538053054, "mean_env_wait_ms": 3.071823862018491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012135505676269531, "StateBufferConnector_ms": 0.007844209671020508, "ViewRequirementAgentConnector_ms": 0.19998788833618164}, "num_episodes": 34, "episode_return_max": -66.08214784985451, "episode_return_min": -1416.022240327778, "episode_return_mean": -696.1875237910963, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6353529814342, "num_env_steps_trained_throughput_per_sec": 304.6353529814342, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12655.011, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12654.941, "sample_time_ms": 1076.826, "learn_time_ms": 11513.53, "learn_throughput": 347.417, "synch_weights_time_ms": 63.794}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-39", "timestamp": 1722636219, "time_this_iter_s": 13.141945600509644, "time_total_s": 347.919056892395, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f24040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.919056892395, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.51111111111111, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.08391571442286, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.118631410598755, "policy_loss": -0.009099766941896329, "vf_loss": 5.159719248861075, "vf_explained_var": 0.9676651737342278, "kl": 0.01404893750592843, "entropy": 1.9155044126013914, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": 3.6728409172660745, "episode_reward_min": -1416.022240327778, "episode_reward_mean": -668.2869328143316, "episode_len_mean": 126.34, "episode_media": {}, "episodes_timesteps_total": 12634, "policy_reward_min": {"policy_0": -1416.022240327778}, "policy_reward_max": {"policy_0": 3.6728409172660745}, "policy_reward_mean": {"policy_0": -668.2869328143316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277], "episode_lengths": [150, 114, 150, 150, 150, 100, 54, 150, 64, 123, 150, 150, 150, 112, 150, 150, 150, 150, 112, 150, 150, 91, 150, 49, 116, 150, 150, 150, 102, 76, 150, 150, 108, 150, 145, 94, 150, 107, 150, 150, 116, 150, 96, 150, 72, 150, 150, 72, 150, 107, 81, 150, 112, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 107, 150, 93, 150, 150, 36, 65, 150, 108, 150, 111, 150, 76, 150, 150, 37, 150, 98, 76, 150, 133, 150, 150, 150, 150, 150, 76, 150, 138, 50, 150, 85, 83], "policy_policy_0_reward": [-1416.022240327778, -351.8346870847678, -730.0785491396972, -518.4907610441594, -813.5010432145978, -372.7524517547225, -81.24389213537006, -785.5537231112598, -165.13505340879897, -443.00709806705527, -402.496178860867, -752.539542894607, -548.5237559107995, -333.3540845170907, -1287.0361386473655, -947.7449449966103, -1098.0440045401742, -1140.3639930253357, -218.79080987652648, -1083.2677361679757, -621.4804959679612, -189.19020681173254, -1321.7367428781254, -66.08214784985451, -272.3861925074424, -1013.3145481789983, -445.59795478452656, -1151.0317718466467, -349.67524028730156, -146.1946282056728, -1029.2526342453052, -1066.864379396954, -283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521240122409384, "mean_inference_ms": 1.6821553882420301, "mean_action_processing_ms": 0.27869958539950157, "mean_env_wait_ms": 3.0742333833036537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011748790740966797, "StateBufferConnector_ms": 0.007784605026245117, "ViewRequirementAgentConnector_ms": 0.19934463500976562}, "num_episodes": 30, "episode_return_max": 3.6728409172660745, "episode_return_min": -1416.022240327778, "episode_return_mean": -668.2869328143316, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.72294404250596, "num_env_steps_trained_throughput_per_sec": 448.72294404250596, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12227.203, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12227.131, "sample_time_ms": 1084.007, "learn_time_ms": 11079.05, "learn_throughput": 361.042, "synch_weights_time_ms": 63.295}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-48", "timestamp": 1722636228, "time_this_iter_s": 8.9263756275177, "time_total_s": 356.8454325199127, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f26710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 356.8454325199127, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 20.63076923076923, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 175.0161234021187, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.083012250562509, "policy_loss": -0.007756089553974259, "vf_loss": 5.119113050897917, "vf_explained_var": 0.9770223285381993, "kl": 0.01459689590525768, "entropy": 1.74566453533868, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 3.6728409172660745, "episode_reward_min": -1348.3954500952532, "episode_reward_mean": -647.6654307987975, "episode_len_mean": 124.26, "episode_media": {}, "episodes_timesteps_total": 12426, "policy_reward_min": {"policy_0": -1348.3954500952532}, "policy_reward_max": {"policy_0": 3.6728409172660745}, "policy_reward_mean": {"policy_0": -647.6654307987975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853], "episode_lengths": [108, 150, 145, 94, 150, 107, 150, 150, 116, 150, 96, 150, 72, 150, 150, 72, 150, 107, 81, 150, 112, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 107, 150, 93, 150, 150, 36, 65, 150, 108, 150, 111, 150, 76, 150, 150, 37, 150, 98, 76, 150, 133, 150, 150, 150, 150, 150, 76, 150, 138, 50, 150, 85, 83, 75, 150, 50, 117, 150, 89, 150, 110, 150, 150, 150, 89, 150, 150, 48, 150, 100, 150, 56, 53, 150, 150, 150, 150, 128, 150, 150, 128, 150, 74, 88, 150], "policy_policy_0_reward": [-283.37932119970765, -1348.3954500952532, -707.3829195191021, -283.3006297602528, -837.084143646199, -367.9009560285959, -1152.2151387910299, -883.6187391191256, -281.19382561851944, -777.6630421911957, -367.80848002811024, -1065.5682672769485, -88.2515565980968, -689.8798907303114, -1295.6249828081886, -134.50992736691845, -1301.0091182355786, -224.8910731341468, -207.62724426955566, -486.4985852477687, -370.7722790764042, -312.02502277372685, -856.0724553437408, -996.6261107550698, -1001.7100006955227, -1123.2782050170795, -1219.516600827959, -993.2730017538314, -955.0697921994318, -553.8071610923408, -973.4424505603572, -976.2986930051829, -143.94716248240624, -1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520079920301191, "mean_inference_ms": 1.6821062099502633, "mean_action_processing_ms": 0.27853634157664187, "mean_env_wait_ms": 3.075186447146441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011819839477539062, "StateBufferConnector_ms": 0.0077207088470458984, "ViewRequirementAgentConnector_ms": 0.19138145446777344}, "num_episodes": 32, "episode_return_max": 3.6728409172660745, "episode_return_min": -1348.3954500952532, "episode_return_mean": -647.6654307987975, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.4773688130018, "num_env_steps_trained_throughput_per_sec": 532.4773688130018, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11659.044, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11658.97, "sample_time_ms": 1077.726, "learn_time_ms": 10515.466, "learn_throughput": 380.392, "synch_weights_time_ms": 65.001}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "3541f_00002", "date": "2024-08-03_03-33-56", "timestamp": 1722636236, "time_this_iter_s": 7.526204586029053, "time_total_s": 364.3716371059418, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f255a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 364.3716371059418, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.009090909090908, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 222.28684382637343, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.7218942950169245, "policy_loss": -0.011052492404511819, "vf_loss": 4.768315352499485, "vf_explained_var": 0.9738354759911696, "kl": 0.012906842507004556, "entropy": 2.058832663670182, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": 3.6728409172660745, "episode_reward_min": -1330.4126232093872, "episode_reward_mean": -641.128699840718, "episode_len_mean": 125.2, "episode_media": {}, "episodes_timesteps_total": 12520, "policy_reward_min": {"policy_0": -1330.4126232093872}, "policy_reward_max": {"policy_0": 3.6728409172660745}, "policy_reward_mean": {"policy_0": -641.128699840718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283], "episode_lengths": [150, 150, 107, 150, 93, 150, 150, 36, 65, 150, 108, 150, 111, 150, 76, 150, 150, 37, 150, 98, 76, 150, 133, 150, 150, 150, 150, 150, 76, 150, 138, 50, 150, 85, 83, 75, 150, 50, 117, 150, 89, 150, 110, 150, 150, 150, 89, 150, 150, 48, 150, 100, 150, 56, 53, 150, 150, 150, 150, 128, 150, 150, 128, 150, 74, 88, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 67, 150, 86, 150, 150, 150, 150, 150, 150, 56, 150, 142, 150, 109, 96, 150, 150, 150, 81, 150, 150, 150, 55], "policy_policy_0_reward": [-1330.4126232093872, -714.8653695956875, -266.8974059625879, -662.5033332319005, -353.5515080022922, -1032.9315671230488, -650.3525968117806, -13.354959822797033, -195.23399432364374, -1131.0029987417008, -543.1690900984876, -403.8918945547002, -218.15535581014592, -1085.446370788037, -60.504571900645054, -654.6078871270594, -1080.4561017841584, 3.6728409172660745, -894.1854602528311, -236.01453350039012, -275.006748972392, -803.5610489418707, -541.5938547566532, -1044.368362520962, -853.0357499345329, -1197.616219480121, -1299.5110653464676, -1078.5321002253288, -150.24195713294623, -1277.6397704202489, -775.8017210598103, -14.233067775292852, -1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531103411897176, "mean_inference_ms": 1.6984617043785377, "mean_action_processing_ms": 0.2781098974548518, "mean_env_wait_ms": 3.074151193803807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011780500411987305, "StateBufferConnector_ms": 0.0076558589935302734, "ViewRequirementAgentConnector_ms": 0.18912816047668457}, "num_episodes": 33, "episode_return_max": 3.6728409172660745, "episode_return_min": -1330.4126232093872, "episode_return_mean": -641.128699840718, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.413908566856, "num_env_steps_trained_throughput_per_sec": 438.413908566856, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11566.826, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11566.75, "sample_time_ms": 1107.871, "learn_time_ms": 10393.522, "learn_throughput": 384.855, "synch_weights_time_ms": 64.576}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "3541f_00002", "date": "2024-08-03_03-34-05", "timestamp": 1722636245, "time_this_iter_s": 9.136539220809937, "time_total_s": 373.5081763267517, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f240d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.5081763267517, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.87692307692308, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.99938073952993, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.563577566792568, "policy_loss": -0.006797340884804726, "vf_loss": 4.609038963665565, "vf_explained_var": 0.9893562824154893, "kl": 0.013566029574652324, "entropy": 2.2384389815231165, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -14.876224853824121, "episode_reward_min": -1378.4935558270306, "episode_reward_mean": -666.0305173483024, "episode_len_mean": 125.6, "episode_media": {}, "episodes_timesteps_total": 12560, "policy_reward_min": {"policy_0": -1378.4935558270306}, "policy_reward_max": {"policy_0": -14.876224853824121}, "policy_reward_mean": {"policy_0": -666.0305173483024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508], "episode_lengths": [150, 85, 83, 75, 150, 50, 117, 150, 89, 150, 110, 150, 150, 150, 89, 150, 150, 48, 150, 100, 150, 56, 53, 150, 150, 150, 150, 128, 150, 150, 128, 150, 74, 88, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 67, 150, 86, 150, 150, 150, 150, 150, 150, 56, 150, 142, 150, 109, 96, 150, 150, 150, 81, 150, 150, 150, 55, 150, 150, 73, 150, 150, 57, 59, 150, 150, 123, 76, 48, 150, 68, 150, 94, 84, 150, 150, 150, 87, 150, 150, 150, 150, 103, 150, 150, 150, 150, 72, 150], "policy_policy_0_reward": [-1165.694426192968, -177.9791653828638, -227.78338263296277, -111.4162012769444, -417.5273726498401, -91.19743496854434, -478.46765104466056, -519.8006758024998, -226.58591520652084, -808.8079029806236, -386.6607659845291, -1136.5140317035498, -1294.659749090394, -612.6034203733759, -275.8619197869214, -527.0822993584918, -1058.904239613962, -74.82912113484096, -1211.9937543877784, -342.7322548898954, -930.0217744326133, -14.876224853824121, -143.1164024419883, -795.0104747559157, -889.2557822381119, -1111.1743798381226, -1197.3570534890619, -316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534934727047753, "mean_inference_ms": 1.7159327622192666, "mean_action_processing_ms": 0.2781231111083373, "mean_env_wait_ms": 3.0766966361257677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011739253997802734, "StateBufferConnector_ms": 0.007588386535644531, "ViewRequirementAgentConnector_ms": 0.18685173988342285}, "num_episodes": 32, "episode_return_max": -14.876224853824121, "episode_return_min": -1378.4935558270306, "episode_return_mean": -666.0305173483024, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.49559286403854, "num_env_steps_trained_throughput_per_sec": 299.49559286403854, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11616.342, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11616.266, "sample_time_ms": 1123.171, "learn_time_ms": 10427.1, "learn_throughput": 383.616, "synch_weights_time_ms": 65.226}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "3541f_00002", "date": "2024-08-03_03-34-19", "timestamp": 1722636259, "time_this_iter_s": 13.367391109466553, "time_total_s": 386.87556743621826, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f27d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.87556743621826, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.557894736842105, "ram_util_percent": 27.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.87569346427918, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.759136523058017, "policy_loss": -0.011060330760665238, "vf_loss": 4.810536329944928, "vf_explained_var": 0.9862869288151462, "kl": 0.015190796264687379, "entropy": 2.3587661760548753, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -41.91891135367749, "episode_reward_min": -1442.88625390417, "episode_reward_mean": -692.8458844850454, "episode_len_mean": 127.9, "episode_media": {}, "episodes_timesteps_total": 12790, "policy_reward_min": {"policy_0": -1442.88625390417}, "policy_reward_max": {"policy_0": -41.91891135367749}, "policy_reward_mean": {"policy_0": -692.8458844850454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746], "episode_lengths": [128, 150, 150, 128, 150, 74, 88, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 67, 150, 86, 150, 150, 150, 150, 150, 150, 56, 150, 142, 150, 109, 96, 150, 150, 150, 81, 150, 150, 150, 55, 150, 150, 73, 150, 150, 57, 59, 150, 150, 123, 76, 48, 150, 68, 150, 94, 84, 150, 150, 150, 87, 150, 150, 150, 150, 103, 150, 150, 150, 150, 72, 150, 150, 150, 90, 50, 150, 150, 82, 150, 150, 102, 150, 150, 125, 150, 150, 150, 150, 70, 150, 150, 150, 55, 150, 67, 150, 150, 94], "policy_policy_0_reward": [-316.22649510820446, -895.8256194164442, -932.859196151431, -338.9407359890238, -395.48324729508977, -120.95104411049633, -176.6185309396781, -1267.0757588192853, -790.9500906583289, -457.5904785367116, -1239.069685951402, -655.8255108272616, -1159.6115298244922, -589.987797730186, -771.6806028340644, -393.01738198909266, -1274.7898729339843, -744.2404563677633, -113.75770124961682, -881.6602401067269, -190.08277761024195, -249.755542997067, -861.3173496655254, -1114.963533432176, -1048.9064421055327, -586.3139294633958, -1198.4894445458958, -49.72249183034406, -636.5518801109359, -868.4485938809762, -646.3094079461378, -326.7067778794253, -391.135119202914, -784.276681536371, -1068.1585929289922, -807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538539813787237, "mean_inference_ms": 1.728617921146372, "mean_action_processing_ms": 0.27780643132085037, "mean_env_wait_ms": 3.0751563563438156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011790752410888672, "StateBufferConnector_ms": 0.007582187652587891, "ViewRequirementAgentConnector_ms": 0.18712902069091797}, "num_episodes": 27, "episode_return_max": -41.91891135367749, "episode_return_min": -1442.88625390417, "episode_return_mean": -692.8458844850454, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.5671512283834, "num_env_steps_trained_throughput_per_sec": 319.5671512283834, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11562.855, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11562.779, "sample_time_ms": 1124.285, "learn_time_ms": 10372.514, "learn_throughput": 385.635, "synch_weights_time_ms": 65.208}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "3541f_00002", "date": "2024-08-03_03-34-31", "timestamp": 1722636271, "time_this_iter_s": 12.528865814208984, "time_total_s": 399.40443325042725, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f276d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.40443325042725, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.85, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.1499011794726, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.4399358180662, "policy_loss": -0.010235365312352467, "vf_loss": 4.49137010400494, "vf_explained_var": 0.9867600246643027, "kl": 0.01657822428860533, "entropy": 2.4329556923359634, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -41.91891135367749, "episode_reward_min": -1481.6936349134292, "episode_reward_mean": -714.9165448095847, "episode_len_mean": 124.71, "episode_media": {}, "episodes_timesteps_total": 12471, "policy_reward_min": {"policy_0": -1481.6936349134292}, "policy_reward_max": {"policy_0": -41.91891135367749}, "policy_reward_mean": {"policy_0": -714.9165448095847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076], "episode_lengths": [150, 81, 150, 150, 150, 55, 150, 150, 73, 150, 150, 57, 59, 150, 150, 123, 76, 48, 150, 68, 150, 94, 84, 150, 150, 150, 87, 150, 150, 150, 150, 103, 150, 150, 150, 150, 72, 150, 150, 150, 90, 50, 150, 150, 82, 150, 150, 102, 150, 150, 125, 150, 150, 150, 150, 70, 150, 150, 150, 55, 150, 67, 150, 150, 94, 100, 150, 150, 150, 77, 71, 76, 99, 150, 150, 57, 111, 86, 150, 150, 97, 150, 150, 120, 150, 150, 150, 89, 52, 150, 150, 49, 150, 150, 150, 150, 150, 150, 122, 150], "policy_policy_0_reward": [-807.5452524924749, -300.85090658677296, -1114.9334103306617, -908.686872702312, -332.4324063816304, -48.200368800283, -955.8635827024459, -1027.3414979929394, -183.59195157540668, -1117.936579328562, -1248.0676172005446, -98.51679098260946, -47.57834800503867, -1036.9966682785725, -968.3442389198169, -382.4716569020608, -227.700429688585, -41.91891135367749, -525.3915703700197, -83.88754535645691, -868.1608463092231, -190.19876668258797, -310.78366445060635, -1125.4359167931327, -915.532621545599, -1122.1007964294406, -147.46056642291612, -1045.0926269804963, -1113.1809805013345, -1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534415957435777, "mean_inference_ms": 1.7335547712327712, "mean_action_processing_ms": 0.2778844831479199, "mean_env_wait_ms": 3.080453492004643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011873245239257812, "StateBufferConnector_ms": 0.007673740386962891, "ViewRequirementAgentConnector_ms": 0.19055628776550293}, "num_episodes": 35, "episode_return_max": -41.91891135367749, "episode_return_min": -1481.6936349134292, "episode_return_mean": -714.9165448095847, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.4955394001062, "num_env_steps_trained_throughput_per_sec": 299.4955394001062, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11603.152, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11603.075, "sample_time_ms": 1127.721, "learn_time_ms": 10409.079, "learn_throughput": 384.28, "synch_weights_time_ms": 65.502}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "3541f_00002", "date": "2024-08-03_03-34-45", "timestamp": 1722636285, "time_this_iter_s": 13.36878752708435, "time_total_s": 412.7732207775116, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f24040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.7732207775116, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.278947368421054, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 278.7463617702325, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.194573822245002, "policy_loss": -0.009182986102435583, "vf_loss": 4.245165122548739, "vf_explained_var": 0.9798632299527525, "kl": 0.017360592153878973, "entropy": 2.4610294036567213, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -13.30153992515151, "episode_reward_min": -1481.6936349134292, "episode_reward_mean": -792.1218359442089, "episode_len_mean": 130.54, "episode_media": {}, "episodes_timesteps_total": 13054, "policy_reward_min": {"policy_0": -1481.6936349134292}, "policy_reward_max": {"policy_0": -13.30153992515151}, "policy_reward_mean": {"policy_0": -792.1218359442089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727], "episode_lengths": [150, 150, 103, 150, 150, 150, 150, 72, 150, 150, 150, 90, 50, 150, 150, 82, 150, 150, 102, 150, 150, 125, 150, 150, 150, 150, 70, 150, 150, 150, 55, 150, 67, 150, 150, 94, 100, 150, 150, 150, 77, 71, 76, 99, 150, 150, 57, 111, 86, 150, 150, 97, 150, 150, 120, 150, 150, 150, 89, 52, 150, 150, 49, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 106, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150], "policy_policy_0_reward": [-1378.4935558270306, -1133.156745163349, -320.7941133769974, -1375.136593763946, -1142.6319175218007, -1359.2801010834808, -520.232688982002, -112.96654634705618, -1198.9417622113508, -1088.1676742911882, -750.344958924622, -291.18302417106725, -66.18995482457878, -1222.4686088774513, -1004.617360857926, -118.57495701278691, -510.99317651976247, -1161.943902258365, -431.37210066679523, -897.5849698825126, -1333.6800441484872, -327.53637262767, -1033.8974808525713, -689.0555156366332, -563.1092640228644, -650.7718569723265, -104.12183580155741, -1219.3480634087264, -706.5859096887652, -793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536474109634208, "mean_inference_ms": 1.7310178220683172, "mean_action_processing_ms": 0.2775614066042484, "mean_env_wait_ms": 3.084025656114621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012063264846801758, "StateBufferConnector_ms": 0.007711172103881836, "ViewRequirementAgentConnector_ms": 0.19194769859313965}, "num_episodes": 29, "episode_return_max": -13.30153992515151, "episode_return_min": -1481.6936349134292, "episode_return_mean": -792.1218359442089, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.1733521929402, "num_env_steps_trained_throughput_per_sec": 407.1733521929402, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11289.795, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11289.717, "sample_time_ms": 1122.807, "learn_time_ms": 10102.814, "learn_throughput": 395.929, "synch_weights_time_ms": 63.333}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "3541f_00002", "date": "2024-08-03_03-34-55", "timestamp": 1722636295, "time_this_iter_s": 9.834872722625732, "time_total_s": 422.60809350013733, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f24ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.60809350013733, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.52857142857143, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 256.7696384270986, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.925997535387675, "policy_loss": -0.004147908735709886, "vf_loss": 3.9774477516611415, "vf_explained_var": 0.9807705537726482, "kl": 0.01272625596147924, "entropy": 2.6514559894800187, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -13.30153992515151, "episode_reward_min": -1481.6936349134292, "episode_reward_mean": -808.0987433815973, "episode_len_mean": 131.41, "episode_media": {}, "episodes_timesteps_total": 13141, "policy_reward_min": {"policy_0": -1481.6936349134292}, "policy_reward_max": {"policy_0": -13.30153992515151}, "policy_reward_mean": {"policy_0": -808.0987433815973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727], "episode_lengths": [150, 55, 150, 67, 150, 150, 94, 100, 150, 150, 150, 77, 71, 76, 99, 150, 150, 57, 111, 86, 150, 150, 97, 150, 150, 120, 150, 150, 150, 89, 52, 150, 150, 49, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 106, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 104, 150, 150, 104, 150, 150, 150, 150, 150, 55, 150, 150, 78, 150, 150, 150, 103, 150, 118, 150], "policy_policy_0_reward": [-793.5464092957992, -123.41977349164655, -1186.2426139787744, -72.63239786340236, -939.5659428869684, -1442.88625390417, -179.61006731866746, -309.66833168243767, -1110.3206044666056, -1158.1262824932994, -1154.7040511280145, -100.33650694315992, -107.72506529040109, -103.21384760188249, -350.05841859600525, -1053.1370421518784, -1264.809807894936, -67.50946856979137, -289.9357607464537, -132.03007316618292, -729.0106683733707, -1150.4018833677621, -150.92451791530868, -627.7747368066849, -1261.8873865828273, -597.6594186045994, -1242.3310480021357, -844.1731432670663, -1481.6936349134292, -152.74486646150655, -53.22071991502471, -1238.5216459917972, -915.1942014089744, -42.78018154626786, -765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532821403196649, "mean_inference_ms": 1.7294495117958533, "mean_action_processing_ms": 0.2772636813952724, "mean_env_wait_ms": 3.0843326301393246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181997299194336, "StateBufferConnector_ms": 0.007784605026245117, "ViewRequirementAgentConnector_ms": 0.19423770904541016}, "num_episodes": 29, "episode_return_max": -13.30153992515151, "episode_return_min": -1481.6936349134292, "episode_return_mean": -808.0987433815973, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1046119096656, "num_env_steps_trained_throughput_per_sec": 309.1046119096656, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11333.431, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11333.353, "sample_time_ms": 1122.156, "learn_time_ms": 10146.919, "learn_throughput": 394.208, "synch_weights_time_ms": 63.515}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "3541f_00002", "date": "2024-08-03_03-35-08", "timestamp": 1722636308, "time_this_iter_s": 12.954838037490845, "time_total_s": 435.5629315376282, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafafe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 435.5629315376282, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.438888888888886, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 256.9087739229202, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.634703805545966, "policy_loss": -0.012212074851656022, "vf_loss": 4.680390262852113, "vf_explained_var": 0.9703357414032022, "kl": 0.014369895869701136, "entropy": 1.9970414631068707, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -12.365875472157038, "episode_reward_min": -1555.122376151152, "episode_reward_mean": -823.463032978652, "episode_len_mean": 133.87, "episode_media": {}, "episodes_timesteps_total": 13387, "policy_reward_min": {"policy_0": -1555.122376151152}, "policy_reward_max": {"policy_0": -12.365875472157038}, "policy_reward_mean": {"policy_0": -823.463032978652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957], "episode_lengths": [150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 106, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 104, 150, 150, 104, 150, 150, 150, 150, 150, 55, 150, 150, 78, 150, 150, 150, 103, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 62, 150, 150, 65, 150, 150, 120, 91, 150, 150, 79, 150, 67, 150, 90, 150, 44, 150, 150, 83, 150, 41, 150, 61], "policy_policy_0_reward": [-765.2947442265136, -1227.5059819936869, -1363.951689320242, -1336.1377056837182, -732.322279907737, -1037.401439166822, -463.9792576980416, -1127.8801625446076, -841.8978393446338, -864.3798501294239, -385.63831499562053, -626.6080176602036, -1127.6017490856202, -1370.424668937749, -1131.7617430471696, -857.5161908102939, -602.4741308816414, -1286.5341103098797, -965.791502734557, -1200.8569138442158, -1355.137104704268, -569.7932298606298, -103.41204913896792, -602.0912473609486, -306.6279043214455, -424.68017757864516, -1455.6219406896223, -733.7652192205677, -1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552621736409951, "mean_inference_ms": 1.7270141068557052, "mean_action_processing_ms": 0.27714241161365594, "mean_env_wait_ms": 3.0874076890851456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011833667755126953, "StateBufferConnector_ms": 0.00777888298034668, "ViewRequirementAgentConnector_ms": 0.1920616626739502}, "num_episodes": 34, "episode_return_max": -12.365875472157038, "episode_return_min": -1555.122376151152, "episode_return_mean": -823.463032978652, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8120730451216, "num_env_steps_trained_throughput_per_sec": 302.8120730451216, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11388.309, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11388.231, "sample_time_ms": 1121.536, "learn_time_ms": 10201.661, "learn_throughput": 392.093, "synch_weights_time_ms": 64.231}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "3541f_00002", "date": "2024-08-03_03-35-21", "timestamp": 1722636321, "time_this_iter_s": 13.223309993743896, "time_total_s": 448.78624153137207, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafafd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 448.78624153137207, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.263157894736842, "ram_util_percent": 27.405263157894733}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 296.5528815229734, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.228779141853253, "policy_loss": -0.011276676764828153, "vf_loss": 4.282674020528793, "vf_explained_var": 0.9843603062753876, "kl": 0.01178923451564818, "entropy": 2.3961678822835286, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -12.365875472157038, "episode_reward_min": -1555.122376151152, "episode_reward_mean": -779.6708592160177, "episode_len_mean": 131.36, "episode_media": {}, "episodes_timesteps_total": 13136, "policy_reward_min": {"policy_0": -1555.122376151152}, "policy_reward_max": {"policy_0": -12.365875472157038}, "policy_reward_mean": {"policy_0": -779.6708592160177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 104, 150, 150, 104, 150, 150, 150, 150, 150, 55, 150, 150, 78, 150, 150, 150, 103, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 62, 150, 150, 65, 150, 150, 120, 91, 150, 150, 79, 150, 67, 150, 90, 150, 44, 150, 150, 83, 150, 41, 150, 61, 150, 150, 62, 150, 140, 73, 150, 150, 140, 150, 150, 90, 150, 150, 150, 60, 74, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1400.5419387680818, -1172.787888093992, -1026.2986241385738, -1389.680177495266, -982.5824096076866, -1295.8679297565411, -959.0438246465586, -13.30153992515151, -964.0142684406727, -1122.61648950737, -954.2437506798452, -1076.0101491224125, -1239.2720455718304, -1426.9026169288663, -1007.751845726727, -225.06152559862858, -754.6327642062088, -465.7718961630318, -428.15675635137825, -387.05781725809936, -412.97020081357385, -451.9007099988227, -1167.720826411905, -1204.6461003779725, -1175.4308319458312, -1329.262461328017, -1216.1241663481019, -63.21383568281357, -1221.7632915824115, -1126.0836967273992, -133.21383280601958, -1414.4199946230062, -922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55236090715528, "mean_inference_ms": 1.7253781643153991, "mean_action_processing_ms": 0.2768928417473476, "mean_env_wait_ms": 3.0888219712283815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011523246765136719, "StateBufferConnector_ms": 0.007758378982543945, "ViewRequirementAgentConnector_ms": 0.1912064552307129}, "num_episodes": 28, "episode_return_max": -12.365875472157038, "episode_return_min": -1555.122376151152, "episode_return_mean": -779.6708592160177, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.64975903938733, "num_env_steps_trained_throughput_per_sec": 308.64975903938733, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11371.231, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11371.153, "sample_time_ms": 1124.98, "learn_time_ms": 10180.5, "learn_throughput": 392.908, "synch_weights_time_ms": 64.864}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "3541f_00002", "date": "2024-08-03_03-35-34", "timestamp": 1722636334, "time_this_iter_s": 12.971616744995117, "time_total_s": 461.7578582763672, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f983a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.7578582763672, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 238.46621354023617, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.219674259920915, "policy_loss": -0.015854828860998774, "vf_loss": 4.273136408130328, "vf_explained_var": 0.9883720931907495, "kl": 0.016124409862641187, "entropy": 2.2431648877759773, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -12.365875472157038, "episode_reward_min": -1555.122376151152, "episode_reward_mean": -725.8598852410283, "episode_len_mean": 128.42, "episode_media": {}, "episodes_timesteps_total": 12842, "policy_reward_min": {"policy_0": -1555.122376151152}, "policy_reward_max": {"policy_0": -12.365875472157038}, "policy_reward_mean": {"policy_0": -725.8598852410283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201], "episode_lengths": [150, 150, 103, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 62, 150, 150, 65, 150, 150, 120, 91, 150, 150, 79, 150, 67, 150, 90, 150, 44, 150, 150, 83, 150, 41, 150, 61, 150, 150, 62, 150, 140, 73, 150, 150, 140, 150, 150, 90, 150, 150, 150, 60, 74, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 79, 150, 150, 150, 150, 84, 82, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 58, 111, 82, 150, 150, 150, 150, 71, 72], "policy_policy_0_reward": [-922.6095152576203, -1369.6257961509648, -227.53344735630617, -336.9283171154266, -177.56461385118686, -1272.382503970727, -479.3196943556045, -605.3715443130629, -911.4331196152859, -533.9034469942599, -957.6733372814507, -1297.4214319903172, -960.1864988977027, -1313.4994384880451, -1440.2660219846216, -727.375349863519, -59.94040299724344, -1063.0805356431724, -897.0670204609635, -80.94341161660415, -888.7405988792697, -1555.122376151152, -599.5653445859156, -169.2392333818783, -649.588972811031, -682.2260385663427, -116.85903094337729, -1143.5495425066908, -155.34957306662528, -1201.2450988327496, -142.428301920261, -1310.8496552388435, -22.149041202740932, -902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525299569493047, "mean_inference_ms": 1.7224578121323193, "mean_action_processing_ms": 0.27680798046388355, "mean_env_wait_ms": 3.0898544350015493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011761188507080078, "StateBufferConnector_ms": 0.007849693298339844, "ViewRequirementAgentConnector_ms": 0.19338250160217285}, "num_episodes": 32, "episode_return_max": -12.365875472157038, "episode_return_min": -1555.122376151152, "episode_return_mean": -725.8598852410283, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.56324476507723, "num_env_steps_trained_throughput_per_sec": 301.56324476507723, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11806.234, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11806.155, "sample_time_ms": 1119.241, "learn_time_ms": 10619.282, "learn_throughput": 376.673, "synch_weights_time_ms": 66.78}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "3541f_00002", "date": "2024-08-03_03-35-47", "timestamp": 1722636347, "time_this_iter_s": 13.276628494262695, "time_total_s": 475.0344867706299, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 475.0344867706299, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 27.405263157894733}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 300.4170898834864, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.542828698456288, "policy_loss": -0.0024905453882335376, "vf_loss": 4.580605075260004, "vf_explained_var": 0.949629872230192, "kl": 0.014362439096263795, "entropy": 2.087446151673794, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -12.365875472157038, "episode_reward_min": -1464.543205235137, "episode_reward_mean": -681.9088341337355, "episode_len_mean": 125.69, "episode_media": {}, "episodes_timesteps_total": 12569, "policy_reward_min": {"policy_0": -1464.543205235137}, "policy_reward_max": {"policy_0": -12.365875472157038}, "policy_reward_mean": {"policy_0": -681.9088341337355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462], "episode_lengths": [150, 150, 83, 150, 41, 150, 61, 150, 150, 62, 150, 140, 73, 150, 150, 140, 150, 150, 90, 150, 150, 150, 60, 74, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 79, 150, 150, 150, 150, 84, 82, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 58, 111, 82, 150, 150, 150, 150, 71, 72, 150, 75, 150, 150, 150, 79, 150, 115, 150, 150, 150, 150, 84, 58, 142, 111, 93, 98, 150, 150, 150, 150, 75, 94, 95, 150, 94, 150, 57, 125, 150, 150, 64], "policy_policy_0_reward": [-902.229745611514, -887.4461227376815, -309.76484841439986, -777.1367744157365, -12.365875472157038, -952.4664267602108, -158.42187633227957, -1314.861162149759, -1063.5614597166011, -168.89610482870748, -387.30752885593057, -623.0806248416922, -85.74048261870202, -917.4390601675342, -1183.0360964314725, -407.2351899820784, -694.7906722156845, -1257.4841287945892, -227.21711439544552, -1204.0679049289129, -1464.543205235137, -539.4588124429621, -66.52064058217492, -208.7558218292436, -587.9819454948237, -995.9026310841158, -883.1802894829538, -1070.9740379717343, -952.009034906152, -146.41671650858845, -1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527426685292451, "mean_inference_ms": 1.7212120162480877, "mean_action_processing_ms": 0.27675390706510183, "mean_env_wait_ms": 3.0927797799569405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012135982513427734, "StateBufferConnector_ms": 0.008041143417358398, "ViewRequirementAgentConnector_ms": 0.2058255672454834}, "num_episodes": 33, "episode_return_max": -12.365875472157038, "episode_return_min": -1464.543205235137, "episode_return_mean": -681.9088341337355, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.13597228236097, "num_env_steps_trained_throughput_per_sec": 299.13597228236097, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12392.213, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12392.133, "sample_time_ms": 1132.655, "learn_time_ms": 11193.064, "learn_throughput": 357.364, "synch_weights_time_ms": 65.551}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "3541f_00002", "date": "2024-08-03_03-36-01", "timestamp": 1722636361, "time_this_iter_s": 13.384366512298584, "time_total_s": 488.41885328292847, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f26680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.41885328292847, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.46315789473684, "ram_util_percent": 27.44736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 322.2625211437543, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.5695050255705914, "policy_loss": -0.010922928923294724, "vf_loss": 3.628620605915785, "vf_explained_var": 0.9880747416367134, "kl": 0.012487597433785943, "entropy": 2.6906034097075464, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -34.57544572991014, "episode_reward_min": -1521.5862855963942, "episode_reward_mean": -742.9128545397706, "episode_len_mean": 129.46, "episode_media": {}, "episodes_timesteps_total": 12946, "policy_reward_min": {"policy_0": -1521.5862855963942}, "policy_reward_max": {"policy_0": -34.57544572991014}, "policy_reward_mean": {"policy_0": -742.9128545397706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 79, 150, 150, 150, 150, 84, 82, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 58, 111, 82, 150, 150, 150, 150, 71, 72, 150, 75, 150, 150, 150, 79, 150, 115, 150, 150, 150, 150, 84, 58, 142, 111, 93, 98, 150, 150, 150, 150, 75, 94, 95, 150, 94, 150, 57, 125, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 102, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 83, 95, 150, 150, 44, 136, 150, 150, 150], "policy_policy_0_reward": [-1227.2818543770245, -738.7590813536415, -702.5142383888867, -767.3757727268539, -601.4781766226336, -934.163148431259, -562.7184538417741, -102.70466868493415, -1339.9508053490015, -711.1429509056975, -126.52372445161392, -1392.7748036829012, -1252.4370680470138, -390.50132974206105, -838.2983428108623, -310.0089532103373, -288.9532229372863, -1146.4832629232926, -1292.203120035703, -1376.3863361523001, -1232.790273748486, -1175.1268091657464, -53.5473178139085, -1049.2315590867488, -1339.2591553645989, -759.6440101141278, -705.1725131187492, -788.6047729427347, -66.14708815796602, -243.6645254059587, -200.3900098879549, -930.2317517911702, -524.9276696606448, -1070.2139698575481, -1410.0692970244627, -108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533624423910396, "mean_inference_ms": 1.7205397251255508, "mean_action_processing_ms": 0.2768778686119937, "mean_env_wait_ms": 3.096693009087357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012052536010742188, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.20449209213256836}, "num_episodes": 30, "episode_return_max": -34.57544572991014, "episode_return_min": -1521.5862855963942, "episode_return_mean": -742.9128545397706, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.86924776634567, "num_env_steps_trained_throughput_per_sec": 301.86924776634567, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12804.91, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12804.832, "sample_time_ms": 1105.026, "learn_time_ms": 11632.895, "learn_throughput": 343.853, "synch_weights_time_ms": 66.05}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "3541f_00002", "date": "2024-08-03_03-36-14", "timestamp": 1722636374, "time_this_iter_s": 13.262772560119629, "time_total_s": 501.6816258430481, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f256c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 501.6816258430481, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.96315789473684, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 262.1831525981426, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.337506334235271, "policy_loss": -0.010119904187740758, "vf_loss": 4.3847312271595005, "vf_explained_var": 0.9775276842837533, "kl": 0.015656846552375706, "entropy": 2.207528348515431, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -33.85202094214765, "episode_reward_min": -1521.5862855963942, "episode_reward_mean": -645.5857377686549, "episode_len_mean": 120.73, "episode_media": {}, "episodes_timesteps_total": 12073, "policy_reward_min": {"policy_0": -1521.5862855963942}, "policy_reward_max": {"policy_0": -33.85202094214765}, "policy_reward_mean": {"policy_0": -645.5857377686549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735], "episode_lengths": [71, 72, 150, 75, 150, 150, 150, 79, 150, 115, 150, 150, 150, 150, 84, 58, 142, 111, 93, 98, 150, 150, 150, 150, 75, 94, 95, 150, 94, 150, 57, 125, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 102, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 83, 95, 150, 150, 44, 136, 150, 150, 150, 62, 63, 61, 51, 150, 101, 150, 150, 73, 55, 150, 137, 136, 100, 124, 150, 150, 68, 103, 150, 64, 150, 150, 150, 75, 74, 150, 57, 61, 82, 76, 69, 150, 150, 150], "policy_policy_0_reward": [-108.20081896969238, -104.77707581734201, -1063.4806830946047, -80.18285787019636, -1239.7477046901204, -632.6077140599026, -1417.451865753157, -273.9325433050998, -895.817076143812, -191.44333400300084, -599.1253979950104, -920.3318489814095, -798.9171124907784, -1158.0687927952922, -99.98020216603865, -63.52352759737251, -814.7005889754269, -387.05490394138184, -333.9446882806343, -328.0862505873013, -888.9435580119294, -925.679246861886, -785.0220077272509, -1001.2675077506962, -156.09533856404667, -359.66526786442626, -199.02394922677536, -348.95911701800793, -368.2034602068558, -1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553264736570347, "mean_inference_ms": 1.7203337464680315, "mean_action_processing_ms": 0.27704565246927637, "mean_env_wait_ms": 3.1028608259463937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011782407760620117, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.20307493209838867}, "num_episodes": 35, "episode_return_max": -33.85202094214765, "episode_return_min": -1521.5862855963942, "episode_return_mean": -645.5857377686549, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.4926813445606, "num_env_steps_trained_throughput_per_sec": 301.4926813445606, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12796.063, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12795.985, "sample_time_ms": 1086.552, "learn_time_ms": 11642.282, "learn_throughput": 343.575, "synch_weights_time_ms": 66.29}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "3541f_00002", "date": "2024-08-03_03-36-27", "timestamp": 1722636387, "time_this_iter_s": 13.279648303985596, "time_total_s": 514.9612741470337, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f98310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 514.9612741470337, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.08421052631579, "ram_util_percent": 27.547368421052635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.9377016623815, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.774725642800331, "policy_loss": -0.010928433261384877, "vf_loss": 4.8234558321535586, "vf_explained_var": 0.965254910228153, "kl": 0.013719789622973665, "entropy": 2.1987841252237557, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -33.85202094214765, "episode_reward_min": -1521.5862855963942, "episode_reward_mean": -696.1776587863401, "episode_len_mean": 125.38, "episode_media": {}, "episodes_timesteps_total": 12538, "policy_reward_min": {"policy_0": -1521.5862855963942}, "policy_reward_max": {"policy_0": -33.85202094214765}, "policy_reward_mean": {"policy_0": -696.1776587863401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901], "episode_lengths": [150, 57, 125, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 102, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 83, 95, 150, 150, 44, 136, 150, 150, 150, 62, 63, 61, 51, 150, 101, 150, 150, 73, 55, 150, 137, 136, 100, 124, 150, 150, 68, 103, 150, 64, 150, 150, 150, 75, 74, 150, 57, 61, 82, 76, 69, 150, 150, 150, 99, 150, 74, 131, 150, 150, 95, 83, 150, 150, 150, 150, 136, 150, 150, 122, 150, 150, 150, 150, 145, 150, 150, 150, 150, 79, 150, 150, 107], "policy_policy_0_reward": [-1070.4501744940096, -73.34602744896341, -407.40215295497524, -925.4310099726238, -962.1146205731852, -105.93261415547462, -1349.5403733657877, -1521.5862855963942, -835.7231723091602, -1241.635356424297, -974.2365425585612, -400.47124368621246, -990.6619321413052, -1003.0110951197075, -229.70250257983272, -849.918595721326, -412.28121222876257, -1157.4845512540392, -1203.9389536135302, -199.64893428280766, -935.2383871094166, -1296.822550250639, -1015.9575251683953, -1090.2578619026715, -1136.3422369738194, -1371.416878810681, -1021.4679011438969, -184.2302847775704, -180.9955991717443, -921.6496632224804, -1063.615192079075, -34.57544572991014, -330.19918252702325, -1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536959749307439, "mean_inference_ms": 1.720161297542994, "mean_action_processing_ms": 0.2770465145943265, "mean_env_wait_ms": 3.102303492218026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01197195053100586, "StateBufferConnector_ms": 0.00787043571472168, "ViewRequirementAgentConnector_ms": 0.19211483001708984}, "num_episodes": 29, "episode_return_max": -33.85202094214765, "episode_return_min": -1521.5862855963942, "episode_return_mean": -696.1776587863401, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.31809072173246, "num_env_steps_trained_throughput_per_sec": 310.31809072173246, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12833.369, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12833.293, "sample_time_ms": 1085.8, "learn_time_ms": 11680.95, "learn_throughput": 342.438, "synch_weights_time_ms": 65.694}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "3541f_00002", "date": "2024-08-03_03-36-40", "timestamp": 1722636400, "time_this_iter_s": 12.903580904006958, "time_total_s": 527.8648550510406, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f993f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.8648550510406, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.578947368421055, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 292.1533556898435, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.537880549579858, "policy_loss": -0.013830936701560858, "vf_loss": 4.590238633006811, "vf_explained_var": 0.9798011904582381, "kl": 0.014991660527569669, "entropy": 2.263670077299078, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -19.49602031010077, "episode_reward_min": -1406.2320166038237, "episode_reward_mean": -627.7538958500448, "episode_len_mean": 122.44, "episode_media": {}, "episodes_timesteps_total": 12244, "policy_reward_min": {"policy_0": -1406.2320166038237}, "policy_reward_max": {"policy_0": -19.49602031010077}, "policy_reward_mean": {"policy_0": -627.7538958500448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794], "episode_lengths": [150, 150, 150, 62, 63, 61, 51, 150, 101, 150, 150, 73, 55, 150, 137, 136, 100, 124, 150, 150, 68, 103, 150, 64, 150, 150, 150, 75, 74, 150, 57, 61, 82, 76, 69, 150, 150, 150, 99, 150, 74, 131, 150, 150, 95, 83, 150, 150, 150, 150, 136, 150, 150, 122, 150, 150, 150, 150, 145, 150, 150, 150, 150, 79, 150, 150, 107, 150, 48, 93, 150, 89, 150, 105, 150, 150, 150, 150, 150, 150, 70, 150, 150, 54, 150, 150, 150, 120, 150, 64, 150, 51, 112, 150, 124, 150, 99, 150, 125, 77], "policy_policy_0_reward": [-1257.2615412531245, -1225.4191065034418, -1115.4042683068799, -45.25772469426459, -157.26476191929834, -74.78808121623, -33.85202094214765, -1247.747818511482, -191.83403887002476, -1289.4582589775862, -1220.4829686170801, -66.08333673755901, -47.87307576938745, -791.9521314041791, -530.3920047763751, -583.756916387514, -319.6615295299662, -328.117361796709, -302.23573612827937, -1292.882688230229, -189.17119768168433, -180.46138878971857, -583.7174182523003, -50.799267655927025, -993.790693978896, -1337.4787801247005, -1156.8488182556434, -79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533459107280507, "mean_inference_ms": 1.7192666609014124, "mean_action_processing_ms": 0.27703889292189404, "mean_env_wait_ms": 3.103340066848216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012157201766967773, "StateBufferConnector_ms": 0.007921457290649414, "ViewRequirementAgentConnector_ms": 0.19569015502929688}, "num_episodes": 33, "episode_return_max": -19.49602031010077, "episode_return_min": -1406.2320166038237, "episode_return_mean": -627.7538958500448, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.8219958286794, "num_env_steps_trained_throughput_per_sec": 332.8219958286794, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12699.634, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12699.557, "sample_time_ms": 1083.167, "learn_time_ms": 11550.265, "learn_throughput": 346.312, "synch_weights_time_ms": 65.269}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "3541f_00002", "date": "2024-08-03_03-36-52", "timestamp": 1722636412, "time_this_iter_s": 12.030685424804688, "time_total_s": 539.8955404758453, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f99cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.8955404758453, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 299.1646018008391, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.0405721992254255, "policy_loss": -0.0022184909529945193, "vf_loss": 4.089517358442148, "vf_explained_var": 0.9736194863915444, "kl": 0.015259312440624248, "entropy": 2.679667580748598, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -19.49602031010077, "episode_reward_min": -1495.4995014528645, "episode_reward_mean": -671.1953661220978, "episode_len_mean": 127.83, "episode_media": {}, "episodes_timesteps_total": 12783, "policy_reward_min": {"policy_0": -1495.4995014528645}, "policy_reward_max": {"policy_0": -19.49602031010077}, "policy_reward_mean": {"policy_0": -671.1953661220978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544], "episode_lengths": [75, 74, 150, 57, 61, 82, 76, 69, 150, 150, 150, 99, 150, 74, 131, 150, 150, 95, 83, 150, 150, 150, 150, 136, 150, 150, 122, 150, 150, 150, 150, 145, 150, 150, 150, 150, 79, 150, 150, 107, 150, 48, 93, 150, 89, 150, 105, 150, 150, 150, 150, 150, 150, 70, 150, 150, 54, 150, 150, 150, 120, 150, 64, 150, 51, 112, 150, 124, 150, 99, 150, 125, 77, 150, 150, 150, 142, 119, 132, 52, 150, 150, 97, 86, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150], "policy_policy_0_reward": [-79.36051283608492, -75.56824679486222, -1370.3431665336814, -50.55108594072296, -41.77438776540296, -121.42560897390143, -40.702266063820566, -155.2286121024125, -783.269768132582, -1137.4127713725911, -1047.4239149410735, -367.4586298118366, -902.438285102114, -207.48303517787684, -599.2796365840856, -928.7544676673272, -1201.231844754936, -292.70568100576463, -114.15468932424272, -1214.554111803767, -705.4504080713793, -1224.6842073929583, -480.16725090978883, -641.4385747093257, -1250.1959508415093, -1081.4993730292779, -509.06926995034803, -1212.1580822369228, -912.7017581036363, -323.867955060047, -1253.6802451305136, -573.3860051243021, -661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537367019877844, "mean_inference_ms": 1.71659218932542, "mean_action_processing_ms": 0.27695217623159696, "mean_env_wait_ms": 3.103289726598818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012114286422729492, "StateBufferConnector_ms": 0.007883787155151367, "ViewRequirementAgentConnector_ms": 0.19526886940002441}, "num_episodes": 27, "episode_return_max": -19.49602031010077, "episode_return_min": -1495.4995014528645, "episode_return_mean": -671.1953661220978, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.4186961678955, "num_env_steps_trained_throughput_per_sec": 339.4186961678955, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12895.737, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12895.659, "sample_time_ms": 1089.898, "learn_time_ms": 11737.869, "learn_throughput": 340.777, "synch_weights_time_ms": 67.04}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "3541f_00002", "date": "2024-08-03_03-37-04", "timestamp": 1722636424, "time_this_iter_s": 11.797062158584595, "time_total_s": 551.6926026344299, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f24160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.6926026344299, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.076470588235292, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 293.379497607549, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.9139751424392064, "policy_loss": -0.008311140699273285, "vf_loss": 3.9724967276056606, "vf_explained_var": 0.9804334172358116, "kl": 0.014489425914447011, "entropy": 2.8365347693363825, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -11.132132644522107, "episode_reward_min": -1495.4995014528645, "episode_reward_mean": -707.3548376567976, "episode_len_mean": 129.26, "episode_media": {}, "episodes_timesteps_total": 12926, "policy_reward_min": {"policy_0": -1495.4995014528645}, "policy_reward_max": {"policy_0": -11.132132644522107}, "policy_reward_mean": {"policy_0": -707.3548376567976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952], "episode_lengths": [150, 150, 150, 150, 79, 150, 150, 107, 150, 48, 93, 150, 89, 150, 105, 150, 150, 150, 150, 150, 150, 70, 150, 150, 54, 150, 150, 150, 120, 150, 64, 150, 51, 112, 150, 124, 150, 99, 150, 125, 77, 150, 150, 150, 142, 119, 132, 52, 150, 150, 97, 86, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 135, 150, 102, 150, 150, 150, 150, 150, 150, 150, 50, 150, 105, 39, 92, 150, 150, 150, 150, 98, 150, 71, 150, 150, 150, 150, 41, 150, 53, 136, 150, 150], "policy_policy_0_reward": [-661.0922377030864, -920.6825871469442, -739.1253793982971, -817.6103392245186, -265.5412539810053, -1017.3522884595154, -873.2857853244437, -312.3772094881901, -704.1652768013793, -19.49602031010077, -154.08392551588966, -506.46305136796707, -163.48381611680463, -901.2965330769775, -233.5823049760055, -913.8552912510879, -1336.5309651209775, -813.8413834240187, -968.2206919461498, -524.4310390302761, -459.79719179547953, -117.54386282013168, -1277.3497982255772, -694.5567602184673, -51.16406283498351, -1064.1168554567053, -800.4815713398249, -453.2431058553106, -496.13900529344744, -1072.9879088797368, -32.06831190090291, -797.01953805928, -44.33936890734614, -272.17946695213095, -850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553361008245681, "mean_inference_ms": 1.7163651891467635, "mean_action_processing_ms": 0.276882249009538, "mean_env_wait_ms": 3.1041151964409686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011941194534301758, "StateBufferConnector_ms": 0.007985830307006836, "ViewRequirementAgentConnector_ms": 0.19405698776245117}, "num_episodes": 32, "episode_return_max": -11.132132644522107, "episode_return_min": -1495.4995014528645, "episode_return_mean": -707.3548376567976, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.8271330322692, "num_env_steps_trained_throughput_per_sec": 351.8271330322692, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12738.599, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12738.521, "sample_time_ms": 1097.623, "learn_time_ms": 11574.762, "learn_throughput": 345.579, "synch_weights_time_ms": 65.286}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "3541f_00002", "date": "2024-08-03_03-37-16", "timestamp": 1722636436, "time_this_iter_s": 11.381557703018188, "time_total_s": 563.0741603374481, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f27640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 563.0741603374481, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.8375, "ram_util_percent": 27.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 328.23055698474246, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.5177190246681374, "policy_loss": -0.009049332757422235, "vf_loss": 3.579317400852839, "vf_explained_var": 0.9719779493908087, "kl": 0.012043872130197997, "entropy": 2.8984395012259485, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -11.132132644522107, "episode_reward_min": -1495.4995014528645, "episode_reward_mean": -772.4613820978224, "episode_len_mean": 132.23, "episode_media": {}, "episodes_timesteps_total": 13223, "policy_reward_min": {"policy_0": -1495.4995014528645}, "policy_reward_max": {"policy_0": -11.132132644522107}, "policy_reward_mean": {"policy_0": -772.4613820978224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282], "episode_lengths": [150, 124, 150, 99, 150, 125, 77, 150, 150, 150, 142, 119, 132, 52, 150, 150, 97, 86, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 135, 150, 102, 150, 150, 150, 150, 150, 150, 150, 50, 150, 105, 39, 92, 150, 150, 150, 150, 98, 150, 71, 150, 150, 150, 150, 41, 150, 53, 136, 150, 150, 150, 62, 150, 114, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 73, 150, 63, 150, 137, 150, 150, 150, 57, 150, 150, 150, 104, 150, 81, 150, 150, 150], "policy_policy_0_reward": [-850.5408861231273, -477.19970799268185, -1406.2320166038237, -373.98786058997075, -1158.4957955365091, -441.3342537592012, -74.6821376364794, -1339.2999573996647, -373.4155635588192, -1043.2311894377804, -416.87126427168204, -519.0633436797168, -795.5352193242925, -47.765558025329426, -1318.2520015728185, -1083.4268895848215, -138.03036896480663, -336.3577243417595, -1136.085052867346, -251.2326232796847, -1086.3940992604435, -754.9398080418866, -1051.1481470955523, -1172.1468010823248, -887.120759390004, -865.1465425475157, -1495.4995014528645, -468.8289607675172, -953.5276400273226, -462.8637859333936, -1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531388674495675, "mean_inference_ms": 1.715683341638176, "mean_action_processing_ms": 0.2769980609223138, "mean_env_wait_ms": 3.106581185438534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01181793212890625, "StateBufferConnector_ms": 0.007920026779174805, "ViewRequirementAgentConnector_ms": 0.1922590732574463}, "num_episodes": 34, "episode_return_max": -11.132132644522107, "episode_return_min": -1495.4995014528645, "episode_return_mean": -772.4613820978224, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.44963390830765, "num_env_steps_trained_throughput_per_sec": 325.44963390830765, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12646.716, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12646.639, "sample_time_ms": 1102.848, "learn_time_ms": 11479.153, "learn_throughput": 348.458, "synch_weights_time_ms": 63.831}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "3541f_00002", "date": "2024-08-03_03-37-28", "timestamp": 1722636448, "time_this_iter_s": 12.30098032951355, "time_total_s": 575.3751406669617, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f996c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 575.3751406669617, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 21.682352941176468, "ram_util_percent": 27.541176470588233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 297.50958890914916, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.5307716336101294, "policy_loss": -0.01489808407156185, "vf_loss": 3.5945420131087302, "vf_explained_var": 0.9862725756441554, "kl": 0.013522311047866727, "entropy": 2.7478665622572103, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -11.132132644522107, "episode_reward_min": -1477.6685504211716, "episode_reward_mean": -740.0598367001434, "episode_len_mean": 128.72, "episode_media": {}, "episodes_timesteps_total": 12872, "policy_reward_min": {"policy_0": -1477.6685504211716}, "policy_reward_max": {"policy_0": -11.132132644522107}, "policy_reward_mean": {"policy_0": -740.0598367001434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307], "episode_lengths": [150, 150, 105, 150, 135, 150, 102, 150, 150, 150, 150, 150, 150, 150, 50, 150, 105, 39, 92, 150, 150, 150, 150, 98, 150, 71, 150, 150, 150, 150, 41, 150, 53, 136, 150, 150, 150, 62, 150, 114, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 73, 150, 63, 150, 137, 150, 150, 150, 57, 150, 150, 150, 104, 150, 81, 150, 150, 150, 150, 150, 63, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 58, 82, 47, 150, 123, 75, 150, 150, 81, 150, 76, 52, 150, 150], "policy_policy_0_reward": [-1025.375415345852, -692.686522965138, -200.8386152713364, -1043.0566070262544, -396.65724021228544, -689.2874425168678, -232.85172518773072, -1107.392606092503, -1012.4790949413442, -1452.0836253736486, -1276.1475372409213, -959.3542089354119, -835.8324666020064, -955.7383806010529, -59.83811312568301, -1172.933728571252, -383.27968256157686, -11.132132644522107, -352.1335831138042, -902.5532152039649, -1212.644848449945, -1091.8268571545104, -1280.5141007970929, -207.82664045177094, -578.1077405865625, -99.95338277943749, -1477.6685504211716, -944.099411785891, -1385.7202351623096, -344.413202393424, -19.037825118052503, -1055.3526601159597, -130.19547894993025, -676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529707151701986, "mean_inference_ms": 1.7171876485044026, "mean_action_processing_ms": 0.2772612828381576, "mean_env_wait_ms": 3.110877771869966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011883974075317383, "StateBufferConnector_ms": 0.007827520370483398, "ViewRequirementAgentConnector_ms": 0.19018816947937012}, "num_episodes": 30, "episode_return_max": -11.132132644522107, "episode_return_min": -1477.6685504211716, "episode_return_mean": -740.0598367001434, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.8791835520741, "num_env_steps_trained_throughput_per_sec": 336.8791835520741, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12538.119, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12538.039, "sample_time_ms": 1112.24, "learn_time_ms": 11362.092, "learn_throughput": 352.048, "synch_weights_time_ms": 62.907}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "3541f_00002", "date": "2024-08-03_03-37-40", "timestamp": 1722636460, "time_this_iter_s": 11.886631488800049, "time_total_s": 587.2617721557617, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f98550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 587.2617721557617, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 20.50588235294118, "ram_util_percent": 27.729411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 318.05388917128244, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.051559549570084, "policy_loss": -0.012543748449873722, "vf_loss": 4.116473010679086, "vf_explained_var": 0.9807990728567044, "kl": 0.01359026751621665, "entropy": 2.9242668899397057, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -19.613515516359367, "episode_reward_min": -1499.6927580938159, "episode_reward_mean": -758.0380492200188, "episode_len_mean": 128.11, "episode_media": {}, "episodes_timesteps_total": 12811, "policy_reward_min": {"policy_0": -1499.6927580938159}, "policy_reward_max": {"policy_0": -19.613515516359367}, "policy_reward_mean": {"policy_0": -758.0380492200188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965], "episode_lengths": [136, 150, 150, 150, 62, 150, 114, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 73, 150, 63, 150, 137, 150, 150, 150, 57, 150, 150, 150, 104, 150, 81, 150, 150, 150, 150, 150, 63, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 58, 82, 47, 150, 123, 75, 150, 150, 81, 150, 76, 52, 150, 150, 117, 135, 150, 150, 150, 150, 84, 80, 145, 150, 150, 46, 150, 71, 150, 100, 120, 49, 150, 150, 150, 150, 150, 150, 65, 150, 44, 150, 150, 150, 117, 107, 150], "policy_policy_0_reward": [-676.0133165587772, -1035.3147699517917, -1176.9831531178952, -1216.5063231939405, -185.4050394266774, -590.1895502169244, -385.88450403896326, -1165.0767901287252, -1074.1317668238664, -682.7170289722677, -1342.0633888315915, -812.8052980925098, -459.3810915357189, -1222.4937458585005, -813.3784735390359, -1006.410022998791, -1256.6027247305688, -931.8689011417483, -1176.5034204076017, -187.66000418303818, -1222.796503416171, -164.38820328258043, -874.5280748531736, -878.0025102264962, -1129.503510998815, -821.0088696732413, -690.4121218263447, -27.073705138893576, -533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533556057589283, "mean_inference_ms": 1.7168522678697302, "mean_action_processing_ms": 0.27757395270055873, "mean_env_wait_ms": 3.114574794854222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857748031616211, "StateBufferConnector_ms": 0.0077838897705078125, "ViewRequirementAgentConnector_ms": 0.19247961044311523}, "num_episodes": 33, "episode_return_max": -19.613515516359367, "episode_return_min": -1499.6927580938159, "episode_return_mean": -758.0380492200188, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.5269444722491, "num_env_steps_trained_throughput_per_sec": 300.5269444722491, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12542.693, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12542.614, "sample_time_ms": 1116.113, "learn_time_ms": 11363.147, "learn_throughput": 352.015, "synch_weights_time_ms": 62.597}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "3541f_00002", "date": "2024-08-03_03-37-53", "timestamp": 1722636473, "time_this_iter_s": 13.322257995605469, "time_total_s": 600.5840301513672, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f9a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 600.5840301513672, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.11052631578947, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 338.08132624427475, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.2280258626987535, "policy_loss": -0.008169087902933825, "vf_loss": 3.2930446933954953, "vf_explained_var": 0.9743789504592617, "kl": 0.011305298366066079, "entropy": 3.0968559520939984, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -19.613515516359367, "episode_reward_min": -1499.6927580938159, "episode_reward_mean": -754.0764973967144, "episode_len_mean": 126.41, "episode_media": {}, "episodes_timesteps_total": 12641, "policy_reward_min": {"policy_0": -1499.6927580938159}, "policy_reward_max": {"policy_0": -19.613515516359367}, "policy_reward_mean": {"policy_0": -754.0764973967144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488], "episode_lengths": [150, 150, 150, 104, 150, 81, 150, 150, 150, 150, 150, 63, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 58, 82, 47, 150, 123, 75, 150, 150, 81, 150, 76, 52, 150, 150, 117, 135, 150, 150, 150, 150, 84, 80, 145, 150, 150, 46, 150, 71, 150, 100, 120, 49, 150, 150, 150, 150, 150, 150, 65, 150, 44, 150, 150, 150, 117, 107, 150, 150, 105, 71, 150, 150, 150, 86, 150, 150, 150, 150, 150, 123, 50, 148, 150, 49, 51, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-533.9377183728514, -549.6244543481621, -836.9818515124836, -441.0812206424245, -873.748556228876, -60.614565824749896, -1353.3696487703573, -848.4850638763695, -1175.5239791929282, -526.4878513906837, -1382.8910790221776, -19.613515516359367, -33.7818156048982, -996.0381399956158, -1168.6280894889915, -978.9202098157543, -524.5122918304615, -1155.0035734503113, -588.3599399265889, -379.12301345984355, -782.4533830123521, -1308.2139256630714, -342.18350938325716, -956.715939663067, -429.2090867803548, -114.41686323820574, -272.810200838722, -22.655019546558776, -1049.0394828530777, -411.33720304754246, -228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534372517669264, "mean_inference_ms": 1.7162752750244943, "mean_action_processing_ms": 0.2777844136262257, "mean_env_wait_ms": 3.116832865482103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214742660522461, "StateBufferConnector_ms": 0.007883787155151367, "ViewRequirementAgentConnector_ms": 0.19411396980285645}, "num_episodes": 28, "episode_return_max": -19.613515516359367, "episode_return_min": -1499.6927580938159, "episode_return_mean": -754.0764973967144, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.7126780339329, "num_env_steps_trained_throughput_per_sec": 306.7126780339329, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12509.66, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12509.584, "sample_time_ms": 1114.094, "learn_time_ms": 11332.89, "learn_throughput": 352.955, "synch_weights_time_ms": 61.857}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "3541f_00002", "date": "2024-08-03_03-38-06", "timestamp": 1722636486, "time_this_iter_s": 13.054787158966064, "time_total_s": 613.6388173103333, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f9a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.6388173103333, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.65263157894737, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 430.7116114417712, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.0762946830441553, "policy_loss": -0.010643293053241602, "vf_loss": 3.1511089065422615, "vf_explained_var": 0.9839378276839852, "kl": 0.013215723368512044, "entropy": 3.5059001468122006, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -24.519115405381864, "episode_reward_min": -1517.9992300321896, "episode_reward_mean": -840.8145110867065, "episode_len_mean": 129.81, "episode_media": {}, "episodes_timesteps_total": 12981, "policy_reward_min": {"policy_0": -1517.9992300321896}, "policy_reward_max": {"policy_0": -24.519115405381864}, "policy_reward_mean": {"policy_0": -840.8145110867065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549], "episode_lengths": [75, 150, 150, 81, 150, 76, 52, 150, 150, 117, 135, 150, 150, 150, 150, 84, 80, 145, 150, 150, 46, 150, 71, 150, 100, 120, 49, 150, 150, 150, 150, 150, 150, 65, 150, 44, 150, 150, 150, 117, 107, 150, 150, 105, 71, 150, 150, 150, 86, 150, 150, 150, 150, 150, 123, 50, 148, 150, 49, 51, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 97, 100, 150, 150, 150, 150, 64], "policy_policy_0_reward": [-228.14432174023824, -501.3813553192446, -1184.7167277938497, -294.72164277726506, -1163.7107821023042, -89.57685612321497, -32.89296663527996, -1476.9301373098554, -1124.0319970521307, -472.11038179550025, -641.5001743580339, -617.4312105805533, -1218.000404457694, -1239.8859345324681, -871.718862373668, -206.3032861782288, -92.04550008809963, -646.6339344103638, -921.6318066062448, -1460.8556609103177, -81.96239989141742, -1399.034617156628, -124.58484030362177, -1369.7035161374035, -414.89201810873675, -513.6857332741114, -47.03589918333916, -1242.5494504153996, -1469.4384792226767, -1317.511197853584, -990.1662867264934, -1061.1971089321014, -1376.8976548621174, -48.47089449262839, -643.4991231000109, -24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542043349699801, "mean_inference_ms": 1.715857461019396, "mean_action_processing_ms": 0.277841058075835, "mean_env_wait_ms": 3.1229421308419543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012315750122070312, "StateBufferConnector_ms": 0.007900238037109375, "ViewRequirementAgentConnector_ms": 0.19458603858947754}, "num_episodes": 30, "episode_return_max": -24.519115405381864, "episode_return_min": -1517.9992300321896, "episode_return_mean": -840.8145110867065, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.68990497680295, "num_env_steps_trained_throughput_per_sec": 297.68990497680295, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 12528.263, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12528.187, "sample_time_ms": 1108.265, "learn_time_ms": 11355.292, "learn_throughput": 352.259, "synch_weights_time_ms": 63.867}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "3541f_00002", "date": "2024-08-03_03-38-20", "timestamp": 1722636500, "time_this_iter_s": 13.450188398361206, "time_total_s": 627.0890057086945, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f25750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 627.0890057086945, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 20.384210526315787, "ram_util_percent": 27.878947368421056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 345.0191621700923, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.4386460529019436, "policy_loss": -0.0018630642671875345, "vf_loss": 3.495758659640948, "vf_explained_var": 0.9750748565420508, "kl": 0.018289788433078987, "entropy": 3.173998021086057, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -24.519115405381864, "episode_reward_min": -1517.9992300321896, "episode_reward_mean": -836.9389892976988, "episode_len_mean": 130.79, "episode_media": {}, "episodes_timesteps_total": 13079, "policy_reward_min": {"policy_0": -1517.9992300321896}, "policy_reward_max": {"policy_0": -24.519115405381864}, "policy_reward_mean": {"policy_0": -836.9389892976988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614], "episode_lengths": [44, 150, 150, 150, 117, 107, 150, 150, 105, 71, 150, 150, 150, 86, 150, 150, 150, 150, 150, 123, 50, 148, 150, 49, 51, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 97, 100, 150, 150, 150, 150, 64, 150, 150, 76, 150, 150, 51, 150, 150, 150, 150, 56, 150, 150, 47, 50, 150, 150, 150, 150, 123, 56, 91, 144, 117, 150, 38, 150, 95, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-24.519115405381864, -1191.6359996413496, -1499.6927580938159, -1485.9185807249034, -201.53049241167727, -339.4604454616827, -1155.3303619965, -401.9197545385151, -110.79506997080946, -129.39648260332245, -1198.0576442070396, -751.7370679167566, -791.0546074062034, -234.80334713233742, -1004.1628480434747, -1315.6315469664798, -1334.8771137669214, -1161.971804511557, -1114.820311405719, -571.7011435956051, -72.36601156249687, -762.3520049445787, -1399.7662683228011, -101.68158192974342, -57.86886578766794, -234.3725024779222, -1095.007960665544, -1420.7980662304758, -934.264996672507, -1177.562566890566, -1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539060515966886, "mean_inference_ms": 1.7161054947945096, "mean_action_processing_ms": 0.2777184363289843, "mean_env_wait_ms": 3.124691729900656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153148651123047, "StateBufferConnector_ms": 0.007898569107055664, "ViewRequirementAgentConnector_ms": 0.19578099250793457}, "num_episodes": 35, "episode_return_max": -24.519115405381864, "episode_return_min": -1517.9992300321896, "episode_return_mean": -836.9389892976988, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.57658513106907, "num_env_steps_trained_throughput_per_sec": 301.57658513106907, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 12527.893, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12527.819, "sample_time_ms": 1112.166, "learn_time_ms": 11351.497, "learn_throughput": 352.376, "synch_weights_time_ms": 63.388}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "3541f_00002", "date": "2024-08-03_03-38-33", "timestamp": 1722636513, "time_this_iter_s": 13.275749444961548, "time_total_s": 640.364755153656, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f276d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.364755153656, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.689473684210526, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 344.7006169080734, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.450076483686765, "policy_loss": -0.00670412047135566, "vf_loss": 3.508627282952269, "vf_explained_var": 0.9803705329075456, "kl": 0.013125457055927351, "entropy": 2.887657091766596, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -27.53239012359199, "episode_reward_min": -1517.9992300321896, "episode_reward_mean": -808.5203674640633, "episode_len_mean": 129.14, "episode_media": {}, "episodes_timesteps_total": 12914, "policy_reward_min": {"policy_0": -1517.9992300321896}, "policy_reward_max": {"policy_0": -27.53239012359199}, "policy_reward_mean": {"policy_0": -808.5203674640633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 97, 100, 150, 150, 150, 150, 64, 150, 150, 76, 150, 150, 51, 150, 150, 150, 150, 56, 150, 150, 47, 50, 150, 150, 150, 150, 123, 56, 91, 144, 117, 150, 38, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 70, 150, 150, 45, 53, 46, 150, 150, 137, 150, 122, 137, 150, 150, 142, 83, 150, 62, 94, 150, 150, 103, 150, 107], "policy_policy_0_reward": [-1082.9596798093012, -1370.860052913648, -833.4507877941172, -681.9150769675439, -1462.7924658005488, -1470.5146089346838, -1206.9125947519283, -1284.7739973451655, -422.81607680607925, -503.2497098643953, -1305.4998627929135, -1219.7789551038634, -1204.793099345128, -1165.0260482760675, -1119.0609780093293, -1183.3422540753697, -299.79101135365534, -1517.9992300321896, -947.6304949689987, -637.6225025391749, -1159.3457511601628, -1261.48155026247, -1090.1098229856216, -1228.929907904223, -1194.2565632892272, -500.75904365488583, -1200.609515551253, -1109.0729464321744, -225.21997647734867, -359.61629732808797, -986.864906237576, -858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544726190778752, "mean_inference_ms": 1.7152021713720915, "mean_action_processing_ms": 0.27778991537942443, "mean_env_wait_ms": 3.128120531580548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011611461639404297, "StateBufferConnector_ms": 0.007644176483154297, "ViewRequirementAgentConnector_ms": 0.19106483459472656}, "num_episodes": 30, "episode_return_max": -27.53239012359199, "episode_return_min": -1517.9992300321896, "episode_return_mean": -808.5203674640633, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.66741587714677, "num_env_steps_trained_throughput_per_sec": 402.66741587714677, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12232.269, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12232.193, "sample_time_ms": 1117.887, "learn_time_ms": 11051.674, "learn_throughput": 361.936, "synch_weights_time_ms": 61.866}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "3541f_00002", "date": "2024-08-03_03-38-43", "timestamp": 1722636523, "time_this_iter_s": 9.946089506149292, "time_total_s": 650.3108446598053, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f27e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.3108446598053, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 20.38571428571429, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 371.09110560218494, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.660531582683325, "policy_loss": -0.010851127673716595, "vf_loss": 3.72503100335598, "vf_explained_var": 0.982488599481682, "kl": 0.014244555404729908, "entropy": 3.00291821261247, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -24.883664092014666, "episode_reward_min": -1528.8594845981356, "episode_reward_mean": -750.908606408389, "episode_len_mean": 125.08, "episode_media": {}, "episodes_timesteps_total": 12508, "policy_reward_min": {"policy_0": -1528.8594845981356}, "policy_reward_max": {"policy_0": -24.883664092014666}, "policy_reward_mean": {"policy_0": -750.908606408389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416], "episode_lengths": [150, 150, 150, 64, 150, 150, 76, 150, 150, 51, 150, 150, 150, 150, 56, 150, 150, 47, 50, 150, 150, 150, 150, 123, 56, 91, 144, 117, 150, 38, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 70, 150, 150, 45, 53, 46, 150, 150, 137, 150, 122, 137, 150, 150, 142, 83, 150, 62, 94, 150, 150, 103, 150, 107, 150, 62, 150, 95, 150, 150, 54, 150, 150, 56, 76, 96, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 63, 150, 150, 94, 150, 150, 150, 150], "policy_policy_0_reward": [-858.9863750691295, -1047.9108053054622, -968.0112032699967, -109.57647216974549, -912.0655524052464, -1047.2455705607529, -233.75638638658668, -1346.5205338177486, -1280.8930703597669, -76.33608494804866, -1452.695230488448, -1271.0928201603583, -762.5741313301407, -1438.645480855362, -76.60004667609553, -551.9146295613697, -682.9033381989902, -71.10025331262257, -52.385829005995426, -965.3482419493571, -1339.9516831978633, -449.15349875852934, -511.79365964127527, -680.2090423572836, -95.36517917245307, -57.96258951427433, -854.6842558556405, -618.2496962447418, -345.48142247514863, -62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543630723649283, "mean_inference_ms": 1.7152596304883643, "mean_action_processing_ms": 0.27780643621270157, "mean_env_wait_ms": 3.128677645252492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011620759963989258, "StateBufferConnector_ms": 0.0077190399169921875, "ViewRequirementAgentConnector_ms": 0.20293569564819336}, "num_episodes": 31, "episode_return_max": -24.883664092014666, "episode_return_min": -1528.8594845981356, "episode_return_mean": -750.908606408389, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3814710505235, "num_env_steps_trained_throughput_per_sec": 304.3814710505235, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12344.566, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12344.492, "sample_time_ms": 1130.389, "learn_time_ms": 11150.813, "learn_throughput": 358.718, "synch_weights_time_ms": 62.52}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "3541f_00002", "date": "2024-08-03_03-38-56", "timestamp": 1722636536, "time_this_iter_s": 13.155928134918213, "time_total_s": 663.4667727947235, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f9ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.4667727947235, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.105263157894736, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 370.1218381881714, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.647978610172868, "policy_loss": -0.011027037282959402, "vf_loss": 3.713564407080412, "vf_explained_var": 0.985889477096498, "kl": 0.014660553461665959, "entropy": 3.057800294458866, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -15.491505715204147, "episode_reward_min": -1528.8594845981356, "episode_reward_mean": -793.0144318914276, "episode_len_mean": 129.15, "episode_media": {}, "episodes_timesteps_total": 12915, "policy_reward_min": {"policy_0": -1528.8594845981356}, "policy_reward_max": {"policy_0": -15.491505715204147}, "policy_reward_mean": {"policy_0": -793.0144318914276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416, -1335.9820142384092, -439.5558743715339, -1270.0747634800373, -1266.1522020572404, -974.4637545423825, -1315.69901663912, -127.87275815510564, -1046.5386773737912, -554.9736051783007, -323.4332965775531, -951.580618241728, -251.85719147315658, -1083.1526240025773, -1190.2131051414303, -1434.0162452144539, -1081.3487120627303, -1480.606762676584, -412.317405608521, -913.1658201159505, -745.9045970811046, -196.0429430290658, -907.6179910109806, -112.2277995113962, -1420.1861244642412, -1155.6701196901922, -818.3835406330592, -644.3723369247148, -15.491505715204147, -901.0942261417184], "episode_lengths": [38, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 75, 70, 150, 150, 45, 53, 46, 150, 150, 137, 150, 122, 137, 150, 150, 142, 83, 150, 62, 94, 150, 150, 103, 150, 107, 150, 62, 150, 95, 150, 150, 54, 150, 150, 56, 76, 96, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 63, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 112, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 72, 150, 150, 140, 150, 39, 150], "policy_policy_0_reward": [-62.41840257854909, -1389.0679655349104, -178.6531758657306, -1428.1639104337926, -904.5259710530831, -1057.990709693599, -528.2102802391191, -1068.300593016812, -1162.4390400276857, -1242.6027082266614, -1114.4501341641876, -1049.0602533797169, -1262.7042111624085, -1155.9878966510735, -40.27838625568968, -154.3132652489607, -91.66590000787703, -1038.9076405635212, -997.821630094473, -27.53239012359199, -41.38237102244869, -63.365376529053385, -1223.1509306529358, -1420.4038104689935, -529.2283030298453, -482.3007896245116, -325.27695208701005, -437.4436226744464, -1312.7871183203881, -1072.066653608984, -582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416, -1335.9820142384092, -439.5558743715339, -1270.0747634800373, -1266.1522020572404, -974.4637545423825, -1315.69901663912, -127.87275815510564, -1046.5386773737912, -554.9736051783007, -323.4332965775531, -951.580618241728, -251.85719147315658, -1083.1526240025773, -1190.2131051414303, -1434.0162452144539, -1081.3487120627303, -1480.606762676584, -412.317405608521, -913.1658201159505, -745.9045970811046, -196.0429430290658, -907.6179910109806, -112.2277995113962, -1420.1861244642412, -1155.6701196901922, -818.3835406330592, -644.3723369247148, -15.491505715204147, -901.0942261417184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547820548421999, "mean_inference_ms": 1.7129268165250702, "mean_action_processing_ms": 0.27776568388175965, "mean_env_wait_ms": 3.130630865295393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011834144592285156, "StateBufferConnector_ms": 0.00783395767211914, "ViewRequirementAgentConnector_ms": 0.20514655113220215}, "num_episodes": 29, "episode_return_max": -15.491505715204147, "episode_return_min": -1528.8594845981356, "episode_return_mean": -793.0144318914276, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1694949044703, "num_env_steps_trained_throughput_per_sec": 307.1694949044703, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12468.293, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12468.22, "sample_time_ms": 1131.61, "learn_time_ms": 11273.624, "learn_throughput": 354.81, "synch_weights_time_ms": 62.216}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "3541f_00002", "date": "2024-08-03_03-39-09", "timestamp": 1722636549, "time_this_iter_s": 13.034608602523804, "time_total_s": 676.5013813972473, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f992d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 676.5013813972473, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.48421052631579, "ram_util_percent": 27.85789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 293.48827949762347, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.618886243055264, "policy_loss": -0.010186781784674774, "vf_loss": 4.674523080388705, "vf_explained_var": 0.9607293725013732, "kl": 0.013752129049741373, "entropy": 2.581925819814205, "entropy_coeff": 0.02}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -15.491505715204147, "episode_reward_min": -1528.8594845981356, "episode_reward_mean": -767.6966527894969, "episode_len_mean": 130.09, "episode_media": {}, "episodes_timesteps_total": 13009, "policy_reward_min": {"policy_0": -1528.8594845981356}, "policy_reward_max": {"policy_0": -15.491505715204147}, "policy_reward_mean": {"policy_0": -767.6966527894969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416, -1335.9820142384092, -439.5558743715339, -1270.0747634800373, -1266.1522020572404, -974.4637545423825, -1315.69901663912, -127.87275815510564, -1046.5386773737912, -554.9736051783007, -323.4332965775531, -951.580618241728, -251.85719147315658, -1083.1526240025773, -1190.2131051414303, -1434.0162452144539, -1081.3487120627303, -1480.606762676584, -412.317405608521, -913.1658201159505, -745.9045970811046, -196.0429430290658, -907.6179910109806, -112.2277995113962, -1420.1861244642412, -1155.6701196901922, -818.3835406330592, -644.3723369247148, -15.491505715204147, -901.0942261417184, -1045.3337772127882, -755.5717036335835, -55.44996826780553, -279.1599461769352, -923.0352836953086, -1163.8512514610366, -131.46297156763742, -1286.7791976511833, -475.8718932534243, -1391.7451686758375, -84.97087761648731, -355.45996502014043, -1167.2865881992886, -440.7450384177341, -856.1480102054385, -386.7725586595111, -302.6594243185873, -838.6118578643315, -615.9335614112931, -225.37865580820798, -388.75401484070045, -427.7631137822638, -972.4942641728667, -1305.770121176626, -1210.7391164823418, -1227.5592473824443, -1160.363794258275, -202.10507946706372, -463.7677027709257, -189.1783286969323], "episode_lengths": [142, 83, 150, 62, 94, 150, 150, 103, 150, 107, 150, 62, 150, 95, 150, 150, 54, 150, 150, 56, 76, 96, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 63, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 112, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 72, 150, 150, 140, 150, 39, 150, 150, 150, 51, 119, 150, 150, 87, 150, 131, 150, 73, 106, 150, 104, 142, 150, 90, 139, 125, 94, 150, 118, 150, 150, 150, 150, 150, 107, 150, 73], "policy_policy_0_reward": [-582.6578275366471, -239.1387585329607, -1048.5983177656133, -108.80603840784907, -161.1939291488373, -1254.624596054766, -1319.0420881150062, -375.8666416146726, -1131.4706117589703, -371.6686933153942, -1056.7604441274902, -81.63491010965336, -1461.2508005727948, -216.29319062984595, -374.1616923318867, -1050.4338757592693, -24.883664092014666, -958.7898598590175, -1116.2137206062964, -62.53812333040414, -173.46081021132676, -276.4729666216882, -1285.2861875764806, -1220.409629024713, -1154.0800569025623, -1066.7765618408855, -752.9891553429024, -1012.9534776647625, -1075.2225726788743, -821.7465894103314, -1368.9873403144927, -989.3010047092332, -1528.8594845981356, -157.64603512342435, -1503.413888088089, -783.6781824122783, -280.75779453565946, -769.4657655528054, -984.3824320778482, -1376.6531991695654, -490.37624792496416, -1335.9820142384092, -439.5558743715339, -1270.0747634800373, -1266.1522020572404, -974.4637545423825, -1315.69901663912, -127.87275815510564, -1046.5386773737912, -554.9736051783007, -323.4332965775531, -951.580618241728, -251.85719147315658, -1083.1526240025773, -1190.2131051414303, -1434.0162452144539, -1081.3487120627303, -1480.606762676584, -412.317405608521, -913.1658201159505, -745.9045970811046, -196.0429430290658, -907.6179910109806, -112.2277995113962, -1420.1861244642412, -1155.6701196901922, -818.3835406330592, -644.3723369247148, -15.491505715204147, -901.0942261417184, -1045.3337772127882, -755.5717036335835, -55.44996826780553, -279.1599461769352, -923.0352836953086, -1163.8512514610366, -131.46297156763742, -1286.7791976511833, -475.8718932534243, -1391.7451686758375, -84.97087761648731, -355.45996502014043, -1167.2865881992886, -440.7450384177341, -856.1480102054385, -386.7725586595111, -302.6594243185873, -838.6118578643315, -615.9335614112931, -225.37865580820798, -388.75401484070045, -427.7631137822638, -972.4942641728667, -1305.770121176626, -1210.7391164823418, -1227.5592473824443, -1160.363794258275, -202.10507946706372, -463.7677027709257, -189.1783286969323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546293659739433, "mean_inference_ms": 1.7135258097261223, "mean_action_processing_ms": 0.2778346884694358, "mean_env_wait_ms": 3.1318582018222743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01176905632019043, "StateBufferConnector_ms": 0.007792949676513672, "ViewRequirementAgentConnector_ms": 0.20167994499206543}, "num_episodes": 30, "episode_return_max": -15.491505715204147, "episode_return_min": -1528.8594845981356, "episode_return_mean": -767.6966527894969, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.85305312093664, "num_env_steps_trained_throughput_per_sec": 302.85305312093664, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12652.143, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12652.071, "sample_time_ms": 1130.85, "learn_time_ms": 11458.146, "learn_throughput": 349.097, "synch_weights_time_ms": 62.306}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "3541f_00002", "date": "2024-08-03_03-39-23", "timestamp": 1722636563, "time_this_iter_s": 13.21930193901062, "time_total_s": 689.7206833362579, "pid": 447591, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467a8f9b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.02, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 689.7206833362579, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.43888888888889, "ram_util_percent": 27.600000000000005}}
