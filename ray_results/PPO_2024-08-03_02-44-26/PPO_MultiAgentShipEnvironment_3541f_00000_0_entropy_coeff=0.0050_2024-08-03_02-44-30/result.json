{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0356321319937707, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.5332601249218, "policy_loss": -0.006357852361785868, "vf_loss": 9.544976955652237, "vf_explained_var": -0.026415373757481576, "kl": 0.008978648473112116, "entropy": 1.4309426431854566, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -41.1106886660015, "episode_reward_min": -1077.4919712923827, "episode_reward_mean": -609.7080515980242, "episode_len_mean": 130.52173913043478, "episode_media": {}, "episodes_timesteps_total": 3002, "policy_reward_min": {"policy_0": -1077.4919712923827}, "policy_reward_max": {"policy_0": -41.1106886660015}, "policy_reward_mean": {"policy_0": -609.7080515980242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423], "episode_lengths": [150, 150, 52, 150, 150, 150, 150, 150, 82, 150, 107, 150, 38, 150, 150, 150, 150, 106, 150, 150, 150, 67, 150], "policy_policy_0_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612062933001228, "mean_inference_ms": 1.6596141051810347, "mean_action_processing_ms": 0.28163910082323257, "mean_env_wait_ms": 2.945678499804205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011875318444293478, "StateBufferConnector_ms": 0.009231982023819633, "ViewRequirementAgentConnector_ms": 0.18029316611911939}, "num_episodes": 23, "episode_return_max": -41.1106886660015, "episode_return_min": -1077.4919712923827, "episode_return_mean": -609.7080515980242, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9864679718637, "num_env_steps_trained_throughput_per_sec": 299.9864679718637, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13333.946, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13333.883, "sample_time_ms": 1038.055, "learn_time_ms": 12238.601, "learn_throughput": 326.835, "synch_weights_time_ms": 56.507}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-00", "timestamp": 1722633300, "time_this_iter_s": 13.344499826431274, "time_total_s": 13.344499826431274, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53c693f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.344499826431274, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.830000000000002, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0233187454131742, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.558231683572133, "policy_loss": -0.007062500640555905, "vf_loss": 9.57003003358841, "vf_explained_var": 0.030775774953265986, "kl": 0.011539481689123934, "entropy": 1.4087481221805016, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -37.46366501337231, "episode_reward_min": -1156.3444985767114, "episode_reward_mean": -645.3906381610831, "episode_len_mean": 132.3877551020408, "episode_media": {}, "episodes_timesteps_total": 6487, "policy_reward_min": {"policy_0": -1156.3444985767114}, "policy_reward_max": {"policy_0": -37.46366501337231}, "policy_reward_mean": {"policy_0": -645.3906381610831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086], "episode_lengths": [150, 150, 52, 150, 150, 150, 150, 150, 82, 150, 107, 150, 38, 150, 150, 150, 150, 106, 150, 150, 150, 67, 150, 138, 65, 150, 110, 150, 150, 150, 110, 44, 76, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609698545885449, "mean_inference_ms": 1.6638678586292779, "mean_action_processing_ms": 0.28172766385218984, "mean_env_wait_ms": 2.960669722602387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013877421009297274, "StateBufferConnector_ms": 0.008921233975157445, "ViewRequirementAgentConnector_ms": 0.18385332457873285}, "num_episodes": 26, "episode_return_max": -37.46366501337231, "episode_return_min": -1156.3444985767114, "episode_return_mean": -645.3906381610831, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.6410422704481, "num_env_steps_trained_throughput_per_sec": 305.6410422704481, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13210.604, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13210.533, "sample_time_ms": 1029.255, "learn_time_ms": 12121.156, "learn_throughput": 330.002, "synch_weights_time_ms": 59.357}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-13", "timestamp": 1722633313, "time_this_iter_s": 13.098944902420044, "time_total_s": 26.44344472885132, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.44344472885132, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.483333333333334, "ram_util_percent": 26.572222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.011134285479784, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.455618713299433, "policy_loss": -0.007892449204518925, "vf_loss": 9.46750353773435, "vf_explained_var": 0.09544910800953706, "kl": 0.015303968470864978, "entropy": 1.4106347151100636, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -37.46366501337231, "episode_reward_min": -1156.3444985767114, "episode_reward_mean": -647.9283030041516, "episode_len_mean": 133.0909090909091, "episode_media": {}, "episodes_timesteps_total": 10248, "policy_reward_min": {"policy_0": -1156.3444985767114}, "policy_reward_max": {"policy_0": -37.46366501337231}, "policy_reward_mean": {"policy_0": -647.9283030041516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099], "episode_lengths": [150, 150, 52, 150, 150, 150, 150, 150, 82, 150, 107, 150, 38, 150, 150, 150, 150, 106, 150, 150, 150, 67, 150, 138, 65, 150, 110, 150, 150, 150, 110, 44, 76, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 140, 53, 150, 150, 150, 150, 150, 101, 150, 106, 150, 150, 150, 150, 150, 121, 54, 63, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-657.7241018158579, -795.6200847408669, -48.96105074263357, -1077.4919712923827, -850.3887046878839, -835.9531790851079, -554.1688432154319, -520.4709090788117, -292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628864716147809, "mean_inference_ms": 1.6716004672074092, "mean_action_processing_ms": 0.28224008539968637, "mean_env_wait_ms": 2.9695672463265192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01371216464352298, "StateBufferConnector_ms": 0.009014699366185572, "ViewRequirementAgentConnector_ms": 0.18830980573381698}, "num_episodes": 28, "episode_return_max": -37.46366501337231, "episode_return_min": -1156.3444985767114, "episode_return_mean": -647.9283030041516, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.8860747891982, "num_env_steps_trained_throughput_per_sec": 297.8860747891982, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13283.057, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13282.988, "sample_time_ms": 1071.265, "learn_time_ms": 12151.074, "learn_throughput": 329.189, "synch_weights_time_ms": 59.901}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-26", "timestamp": 1722633326, "time_this_iter_s": 13.440657615661621, "time_total_s": 39.88410234451294, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d70700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.88410234451294, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.073684210526313, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5779538533960777, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.375027972459794, "policy_loss": -0.010750464978142797, "vf_loss": 9.390489515662193, "vf_explained_var": 0.13601470179855824, "kl": 0.01383246530185716, "entropy": 1.4955116767436265, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -37.46366501337231, "episode_reward_min": -1177.7925640613746, "episode_reward_mean": -667.9358511031742, "episode_len_mean": 133.72, "episode_media": {}, "episodes_timesteps_total": 13372, "policy_reward_min": {"policy_0": -1177.7925640613746}, "policy_reward_max": {"policy_0": -37.46366501337231}, "policy_reward_mean": {"policy_0": -667.9358511031742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458], "episode_lengths": [82, 150, 107, 150, 38, 150, 150, 150, 150, 106, 150, 150, 150, 67, 150, 138, 65, 150, 110, 150, 150, 150, 110, 44, 76, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 140, 53, 150, 150, 150, 150, 150, 101, 150, 106, 150, 150, 150, 150, 150, 121, 54, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 83, 150, 150, 101, 138, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 70, 150, 150, 150, 150, 90, 150, 150, 150, 94, 150, 150], "policy_policy_0_reward": [-292.7119392648076, -871.7740778332131, -217.87047983867393, -818.8798826353369, -41.1106886660015, -871.1398536745081, -834.5915082768677, -744.8399417286864, -482.8853305186123, -413.19960518911205, -971.6162701896286, -950.3222740273505, -318.90902429992946, -170.07748041810981, -682.5779855347423, -441.32194282329806, -37.46366501337231, -1141.6531403484141, -191.8983023696341, -676.2650387168773, -1112.8720555532925, -1135.8555307469271, -256.678459735578, -62.53243046715913, -264.5932725189643, -926.2493298792663, -731.8801983354025, -981.2372388390322, -826.9717871099374, -751.8819472669159, -295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632699772852076, "mean_inference_ms": 1.6796084833647975, "mean_action_processing_ms": 0.28348939362169073, "mean_env_wait_ms": 2.9813678504064374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01392364501953125, "StateBufferConnector_ms": 0.008774280548095703, "ViewRequirementAgentConnector_ms": 0.1916980743408203}, "num_episodes": 31, "episode_return_max": -37.46366501337231, "episode_return_min": -1177.7925640613746, "episode_return_mean": -667.9358511031742, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.135621816504, "num_env_steps_trained_throughput_per_sec": 310.135621816504, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13186.692, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13186.623, "sample_time_ms": 1060.887, "learn_time_ms": 12063.716, "learn_throughput": 331.573, "synch_weights_time_ms": 61.28}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-39", "timestamp": 1722633339, "time_this_iter_s": 12.90981388092041, "time_total_s": 52.79391622543335, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f81360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.79391622543335, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.852631578947367, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.262756879876057, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.227536869049072, "policy_loss": -0.007495804186328314, "vf_loss": 9.240009618798892, "vf_explained_var": 0.22516067065298556, "kl": 0.012201837108652096, "entropy": 1.4834668640047313, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -37.5711856929465, "episode_reward_min": -1209.1893616860627, "episode_reward_mean": -705.1605685537196, "episode_len_mean": 136.61, "episode_media": {}, "episodes_timesteps_total": 13661, "policy_reward_min": {"policy_0": -1209.1893616860627}, "policy_reward_max": {"policy_0": -37.5711856929465}, "policy_reward_mean": {"policy_0": -705.1605685537196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303], "episode_lengths": [150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 140, 53, 150, 150, 150, 150, 150, 101, 150, 106, 150, 150, 150, 150, 150, 121, 54, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 83, 150, 150, 101, 138, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 70, 150, 150, 150, 150, 90, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 123, 150, 150, 150, 47, 150, 150, 103, 150, 150, 150, 122, 100, 150], "policy_policy_0_reward": [-295.2611966287156, -316.83749906379853, -492.0184663127757, -767.9157762195891, -816.9802077198786, -720.5924695678411, -1061.6283528355211, -522.7666033188491, -1156.3444985767114, -810.7093000837516, -1100.4473730870086, -1143.691184345577, -707.027618478158, -646.8142500684953, -299.589201963967, -511.1350242328681, -68.7777281506457, -749.5136562491567, -866.3949690255703, -826.132193003543, -1064.7802838992031, -776.9574278189095, -301.6603912992994, -986.4376762235848, -197.42760578321364, -778.3239559984767, -760.5818427524993, -719.6852424429758, -922.9209975452158, -432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5650016387515402, "mean_inference_ms": 1.686921442669612, "mean_action_processing_ms": 0.2843553045009451, "mean_env_wait_ms": 2.991627189072724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013854265213012695, "StateBufferConnector_ms": 0.008945941925048828, "ViewRequirementAgentConnector_ms": 0.19468164443969727}, "num_episodes": 30, "episode_return_max": -37.5711856929465, "episode_return_min": -1209.1893616860627, "episode_return_mean": -705.1605685537196, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.3265836992168, "num_env_steps_trained_throughput_per_sec": 544.3265836992168, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12019.062, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12018.994, "sample_time_ms": 1050.275, "learn_time_ms": 10904.678, "learn_throughput": 366.815, "synch_weights_time_ms": 63.305}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-47", "timestamp": 1722633347, "time_this_iter_s": 7.360248327255249, "time_total_s": 60.1541645526886, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f81bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.1541645526886, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.66, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.043240103125573, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.762669348716736, "policy_loss": -0.01047410505610363, "vf_loss": 8.777236124873161, "vf_explained_var": 0.445936514933904, "kl": 0.014407325614471726, "entropy": 1.3948209238549074, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -37.5711856929465, "episode_reward_min": -1237.8968735588269, "episode_reward_mean": -690.2386489860296, "episode_len_mean": 135.55, "episode_media": {}, "episodes_timesteps_total": 13555, "policy_reward_min": {"policy_0": -1237.8968735588269}, "policy_reward_max": {"policy_0": -37.5711856929465}, "policy_reward_mean": {"policy_0": -690.2386489860296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762], "episode_lengths": [150, 121, 54, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 83, 150, 150, 101, 138, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 70, 150, 150, 150, 150, 90, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 123, 150, 150, 150, 47, 150, 150, 103, 150, 150, 150, 122, 100, 150, 150, 150, 136, 150, 64, 150, 150, 150, 150, 150, 150, 86, 94, 150, 150, 150, 150, 122, 150, 150, 150, 99, 150, 95, 150, 113, 150, 150, 150], "policy_policy_0_reward": [-432.1675088722254, -386.9716816428625, -37.5711856929465, -44.00645606491373, -1029.7090612570375, -864.1689858674898, -1011.0945337900284, -472.56965263192455, -721.9098104053217, -938.3179359205099, -730.9180276613793, -658.109172134694, -819.217868249128, -182.1862209710047, -147.5265437825057, -784.819458854925, -1046.8233901290012, -148.88574419900337, -614.1499853205408, -842.1917036550456, -685.5072036584987, -793.8424351142334, -1068.6074808816709, -895.1756129481191, -809.8167429602339, -190.7726179778337, -1177.7925640613746, -808.2647684696481, -1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638913653665678, "mean_inference_ms": 1.689427568296576, "mean_action_processing_ms": 0.2847150618238495, "mean_env_wait_ms": 2.9949672452402187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013332843780517578, "StateBufferConnector_ms": 0.008811712265014648, "ViewRequirementAgentConnector_ms": 0.19143986701965332}, "num_episodes": 29, "episode_return_max": -37.5711856929465, "episode_return_min": -1237.8968735588269, "episode_return_mean": -690.2386489860296, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.42769446123776, "num_env_steps_trained_throughput_per_sec": 454.42769446123776, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11482.936, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11482.865, "sample_time_ms": 1045.729, "learn_time_ms": 10374.319, "learn_throughput": 385.567, "synch_weights_time_ms": 62.069}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "3541f_00000", "date": "2024-08-03_02-45-56", "timestamp": 1722633356, "time_this_iter_s": 8.814484357833862, "time_total_s": 68.96864891052246, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d70700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.96864891052246, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.87692307692308, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.693251039584478, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.850855069359143, "policy_loss": -0.017600440530804916, "vf_loss": 8.871311968068282, "vf_explained_var": 0.3765351497257749, "kl": 0.02086148479156691, "entropy": 1.4057547996441524, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -50.16354239511844, "episode_reward_min": -1258.5914818700378, "episode_reward_mean": -686.5362270414497, "episode_len_mean": 136.01, "episode_media": {}, "episodes_timesteps_total": 13601, "policy_reward_min": {"policy_0": -1258.5914818700378}, "policy_reward_max": {"policy_0": -50.16354239511844}, "policy_reward_mean": {"policy_0": -686.5362270414497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393], "episode_lengths": [150, 70, 150, 150, 150, 150, 90, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 123, 150, 150, 150, 47, 150, 150, 103, 150, 150, 150, 122, 100, 150, 150, 150, 136, 150, 64, 150, 150, 150, 150, 150, 150, 86, 94, 150, 150, 150, 150, 122, 150, 150, 150, 99, 150, 95, 150, 113, 150, 150, 150, 150, 150, 61, 150, 150, 106, 150, 150, 150, 150, 121, 85, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 113, 91, 150, 150, 97], "policy_policy_0_reward": [-1121.457327578238, -169.0898052632947, -753.2189713722323, -927.5273181537214, -960.4033380480192, -726.1240802824507, -339.32879389840326, -974.6147867436739, -927.5713158892504, -1138.9964802748498, -351.3633433029873, -928.5155299424994, -521.0659918782458, -875.7635491248338, -1052.609734173463, -992.6904150122795, -380.75355582055334, -88.13047197708944, -1158.4543314378923, -1196.9800786193537, -1136.6590436753947, -1041.849312692361, -852.8373330821396, -104.26235928368533, -838.2334400506421, -953.2211870658274, -809.004053527967, -860.8032408418695, -1209.1893616860627, -477.78660960315716, -902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620468112918879, "mean_inference_ms": 1.6890260106123796, "mean_action_processing_ms": 0.2848738837777248, "mean_env_wait_ms": 2.9987774580844273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013393640518188477, "StateBufferConnector_ms": 0.008509635925292969, "ViewRequirementAgentConnector_ms": 0.18883323669433594}, "num_episodes": 28, "episode_return_max": -50.16354239511844, "episode_return_min": -1258.5914818700378, "episode_return_mean": -686.5362270414497, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.85049122240935, "num_env_steps_trained_throughput_per_sec": 306.85049122240935, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11704.756, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11704.685, "sample_time_ms": 1043.694, "learn_time_ms": 10595.054, "learn_throughput": 377.535, "synch_weights_time_ms": 65.174}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "3541f_00000", "date": "2024-08-03_02-46-09", "timestamp": 1722633369, "time_this_iter_s": 13.048626899719238, "time_total_s": 82.0172758102417, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f82440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.0172758102417, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.999999999999996, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.875735475122928, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.315926757951578, "policy_loss": -0.012545157358787643, "vf_loss": 8.330161799490451, "vf_explained_var": 0.46821759790182116, "kl": 0.017586823737898764, "entropy": 1.3931891669829686, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -49.08447198745923, "episode_reward_min": -1271.0378357640118, "episode_reward_mean": -646.6220168987337, "episode_len_mean": 135.78, "episode_media": {}, "episodes_timesteps_total": 13578, "policy_reward_min": {"policy_0": -1271.0378357640118}, "policy_reward_max": {"policy_0": -49.08447198745923}, "policy_reward_mean": {"policy_0": -646.6220168987337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455], "episode_lengths": [150, 150, 150, 47, 150, 150, 103, 150, 150, 150, 122, 100, 150, 150, 150, 136, 150, 64, 150, 150, 150, 150, 150, 150, 86, 94, 150, 150, 150, 150, 122, 150, 150, 150, 99, 150, 95, 150, 113, 150, 150, 150, 150, 150, 61, 150, 150, 106, 150, 150, 150, 150, 121, 85, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 113, 91, 150, 150, 97, 150, 150, 150, 150, 150, 61, 150, 81, 150, 150, 150, 150, 150, 150, 128, 150, 150, 99, 103, 150, 79, 110, 150, 150, 150, 150, 150, 150, 150, 130], "policy_policy_0_reward": [-902.355230387392, -1027.1450565294288, -912.7481229684272, -50.16354239511844, -648.8446535802981, -824.1053973061746, -253.30171436409407, -886.0793011833076, -663.9711792653181, -465.57052929683283, -545.5543328039738, -344.435341198622, -390.8299479206303, -891.9664396910615, -859.0301800071478, -579.432124815732, -922.0130379649455, -117.25513431326581, -774.3133729835421, -878.2765284705649, -593.8294143682216, -624.2874616541275, -720.3533426139302, -486.06686573249084, -85.00513672858824, -332.4453788802212, -818.7068108114139, -1111.692364787142, -754.9664741497122, -699.9853821556998, -296.4885386177919, -900.3745509076758, -1237.8968735588269, -385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595008987919846, "mean_inference_ms": 1.6848323727929275, "mean_action_processing_ms": 0.2842556062718315, "mean_env_wait_ms": 2.9940117931567842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012835025787353516, "StateBufferConnector_ms": 0.008140802383422852, "ViewRequirementAgentConnector_ms": 0.18582534790039062}, "num_episodes": 30, "episode_return_max": -49.08447198745923, "episode_return_min": -1271.0378357640118, "episode_return_mean": -646.6220168987337, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.3234875813044, "num_env_steps_trained_throughput_per_sec": 308.3234875813044, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11863.337, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11863.265, "sample_time_ms": 1041.419, "learn_time_ms": 10754.967, "learn_throughput": 371.921, "synch_weights_time_ms": 66.115}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "3541f_00000", "date": "2024-08-03_02-46-22", "timestamp": 1722633382, "time_this_iter_s": 12.986738204956055, "time_total_s": 95.00401401519775, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f812d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 95.00401401519775, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 16.999999999999996, "ram_util_percent": 26.510526315789477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.929417258004346, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.003451544046403, "policy_loss": -0.011514770807601356, "vf_loss": 8.017482447624207, "vf_explained_var": 0.5232675744841496, "kl": 0.016183578657971046, "entropy": 1.4742441133906443, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -5.761847040161287, "episode_reward_min": -1271.0378357640118, "episode_reward_mean": -646.8796614055788, "episode_len_mean": 135.35, "episode_media": {}, "episodes_timesteps_total": 13535, "policy_reward_min": {"policy_0": -1271.0378357640118}, "policy_reward_max": {"policy_0": -5.761847040161287}, "policy_reward_mean": {"policy_0": -646.8796614055788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964], "episode_lengths": [150, 99, 150, 95, 150, 113, 150, 150, 150, 150, 150, 61, 150, 150, 106, 150, 150, 150, 150, 121, 85, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 113, 91, 150, 150, 97, 150, 150, 150, 150, 150, 61, 150, 81, 150, 150, 150, 150, 150, 150, 128, 150, 150, 99, 103, 150, 79, 110, 150, 150, 150, 150, 150, 150, 150, 130, 55, 150, 150, 150, 150, 120, 36, 150, 120, 150, 150, 150, 111, 150, 67, 150, 150, 144, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 127, 118, 150, 150, 146], "policy_policy_0_reward": [-385.4819682098327, -254.2782659429559, -764.4094867402024, -165.80472892583995, -407.49831669466346, -473.6668375709307, -988.8978430209786, -960.325735292624, -812.4124403166762, -749.8438939018187, -1045.2002330416897, -66.6579544646437, -1139.8913830848435, -691.0007344372593, -170.70202984683687, -720.9391907351177, -364.08349734889316, -493.1602086829644, -1156.1026291694047, -342.8763181905885, -134.86009441611137, -1258.5914818700378, -936.3418490884408, -1165.9792184434586, -293.8776140461948, -740.1465003106978, -999.8195992255007, -1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572670736229461, "mean_inference_ms": 1.6812668518909009, "mean_action_processing_ms": 0.282903834801439, "mean_env_wait_ms": 2.9905095936263195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012509822845458984, "StateBufferConnector_ms": 0.007821083068847656, "ViewRequirementAgentConnector_ms": 0.18494892120361328}, "num_episodes": 33, "episode_return_max": -5.761847040161287, "episode_return_min": -1271.0378357640118, "episode_return_mean": -646.8796614055788, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.2614108379949, "num_env_steps_trained_throughput_per_sec": 306.2614108379949, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11996.383, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11996.311, "sample_time_ms": 1040.952, "learn_time_ms": 10888.302, "learn_throughput": 367.367, "synch_weights_time_ms": 66.298}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "3541f_00000", "date": "2024-08-03_02-46-35", "timestamp": 1722633395, "time_this_iter_s": 13.07304334640503, "time_total_s": 108.07705736160278, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 108.07705736160278, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.049999999999997, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.530864291389783, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.128912482659022, "policy_loss": -0.01786335679644253, "vf_loss": 8.147964445749919, "vf_explained_var": 0.5381989660983284, "kl": 0.022577825496159675, "entropy": 1.592387505620718, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -5.761847040161287, "episode_reward_min": -1272.0249030277585, "episode_reward_mean": -643.7033998837435, "episode_len_mean": 133.17, "episode_media": {}, "episodes_timesteps_total": 13317, "policy_reward_min": {"policy_0": -1272.0249030277585}, "policy_reward_max": {"policy_0": -5.761847040161287}, "policy_reward_mean": {"policy_0": -643.7033998837435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592], "episode_lengths": [150, 150, 132, 150, 150, 113, 91, 150, 150, 97, 150, 150, 150, 150, 150, 61, 150, 81, 150, 150, 150, 150, 150, 150, 128, 150, 150, 99, 103, 150, 79, 110, 150, 150, 150, 150, 150, 150, 150, 130, 55, 150, 150, 150, 150, 120, 36, 150, 120, 150, 150, 150, 111, 150, 67, 150, 150, 144, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 127, 118, 150, 150, 146, 150, 85, 150, 150, 150, 104, 71, 150, 150, 150, 150, 150, 150, 47, 150, 93, 150, 106, 150, 150, 150, 73, 76, 107, 150, 150, 150], "policy_policy_0_reward": [-1027.3697947453145, -588.7245455094088, -622.1880645891732, -334.6044798182404, -501.27086949357516, -392.4487352941094, -251.5639444194919, -687.1072368436663, -709.0582488371316, -388.44180886148393, -700.1684762838202, -537.875337441702, -1014.466124517095, -713.2531899741756, -615.0416369280358, -49.08447198745923, -840.5418741991679, -129.89070178265692, -531.9045122413484, -803.2670513344898, -441.1259125883096, -1120.6126804373025, -905.8055292026881, -943.2064877109012, -305.7917271568014, -407.5254326734677, -1213.599582203586, -167.25754574652976, -387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570334038729563, "mean_inference_ms": 1.6815981276042504, "mean_action_processing_ms": 0.282482692285812, "mean_env_wait_ms": 2.9940276134079324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012519359588623047, "StateBufferConnector_ms": 0.00774836540222168, "ViewRequirementAgentConnector_ms": 0.18611764907836914}, "num_episodes": 27, "episode_return_max": -5.761847040161287, "episode_return_min": -1272.0249030277585, "episode_return_mean": -643.7033998837435, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.1486130714027, "num_env_steps_trained_throughput_per_sec": 352.1486130714027, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11932.63, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11932.559, "sample_time_ms": 1049.189, "learn_time_ms": 10817.041, "learn_throughput": 369.787, "synch_weights_time_ms": 65.572}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "3541f_00000", "date": "2024-08-03_02-46-46", "timestamp": 1722633406, "time_this_iter_s": 11.370333671569824, "time_total_s": 119.44739103317261, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.44739103317261, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.647058823529413, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.212754540145397, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.043923217058182, "policy_loss": -0.007823885164786286, "vf_loss": 8.054763587315877, "vf_explained_var": 0.5510631928220391, "kl": 0.01188671526174404, "entropy": 1.6731063310056924, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -5.761847040161287, "episode_reward_min": -1272.0249030277585, "episode_reward_mean": -700.0524428969939, "episode_len_mean": 134.27, "episode_media": {}, "episodes_timesteps_total": 13427, "policy_reward_min": {"policy_0": -1272.0249030277585}, "policy_reward_max": {"policy_0": -5.761847040161287}, "policy_reward_mean": {"policy_0": -700.0524428969939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128], "episode_lengths": [103, 150, 79, 110, 150, 150, 150, 150, 150, 150, 150, 130, 55, 150, 150, 150, 150, 120, 36, 150, 120, 150, 150, 150, 111, 150, 67, 150, 150, 144, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 127, 118, 150, 150, 146, 150, 85, 150, 150, 150, 104, 71, 150, 150, 150, 150, 150, 150, 47, 150, 93, 150, 106, 150, 150, 150, 73, 76, 107, 150, 150, 150, 150, 140, 41, 150, 150, 150, 117, 81, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-387.29401939152996, -515.455036409918, -246.75463927010705, -362.09502701621085, -1271.0378357640118, -1017.8326120699585, -788.9932106247555, -864.7529121444476, -1106.1536698107561, -467.1232609714766, -796.6718037119861, -612.5018444361455, -86.61661669224523, -1029.9722648900383, -503.26450919178626, -936.4462271948145, -1015.8777415798411, -276.10720734433494, -5.761847040161287, -1097.477452431382, -412.24906857344484, -445.33048611092636, -552.0407466570828, -1227.0470244727223, -223.06445912917985, -931.3322954432786, -86.52045088177249, -814.8700066267475, -784.5221971501471, -431.42219804071095, -606.2593483771841, -935.3066916741961, -595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563554813173569, "mean_inference_ms": 1.6822978140139788, "mean_action_processing_ms": 0.2819870775310821, "mean_env_wait_ms": 3.0014974965514423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016643762588500977, "StateBufferConnector_ms": 0.007943391799926758, "ViewRequirementAgentConnector_ms": 0.19563579559326172}, "num_episodes": 28, "episode_return_max": -5.761847040161287, "episode_return_min": -1272.0249030277585, "episode_return_mean": -700.0524428969939, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.7891732691252, "num_env_steps_trained_throughput_per_sec": 297.7891732691252, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11942.469, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11942.396, "sample_time_ms": 1063.552, "learn_time_ms": 10812.362, "learn_throughput": 369.947, "synch_weights_time_ms": 65.725}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "3541f_00000", "date": "2024-08-03_02-47-00", "timestamp": 1722633420, "time_this_iter_s": 13.444175720214844, "time_total_s": 132.89156675338745, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.89156675338745, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.831578947368424, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.47084380934636, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.633321863909562, "policy_loss": -0.010719474706759987, "vf_loss": 7.644512449701627, "vf_explained_var": 0.7249459711834788, "kl": 0.016530220652445374, "entropy": 1.5819423492997884, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -26.389649400984677, "episode_reward_min": -1350.9952835109518, "episode_reward_mean": -710.1281897482866, "episode_len_mean": 134.58, "episode_media": {}, "episodes_timesteps_total": 13458, "policy_reward_min": {"policy_0": -1350.9952835109518}, "policy_reward_max": {"policy_0": -26.389649400984677}, "policy_reward_mean": {"policy_0": -710.1281897482866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888], "episode_lengths": [150, 150, 87, 150, 150, 150, 150, 150, 127, 118, 150, 150, 146, 150, 85, 150, 150, 150, 104, 71, 150, 150, 150, 150, 150, 150, 47, 150, 93, 150, 106, 150, 150, 150, 73, 76, 107, 150, 150, 150, 150, 140, 41, 150, 150, 150, 117, 81, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 130, 150, 52, 91, 150, 150, 150, 150, 150, 150, 150, 150, 45, 111, 150, 150, 150, 150, 130, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-595.2536756607744, -1182.8296880122934, -119.98333412007968, -737.1586106914139, -1216.2717083888122, -1148.268811528473, -624.8416945580702, -777.6828156713046, -173.54867267615182, -364.5451435381902, -1052.3869197652784, -556.4224074172918, -674.5718915660964, -1011.7068058194818, -212.15355200361626, -1028.128384805267, -428.0381425238618, -1248.4025817004078, -310.6693055372462, -160.5851937276149, -965.516020203841, -758.5488322111095, -1188.1187153498033, -1272.0249030277585, -972.9898608389921, -648.8761740113212, -26.389649400984677, -415.22180376315737, -295.5810430094391, -678.1690529997378, -358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564527352880488, "mean_inference_ms": 1.6826469279271317, "mean_action_processing_ms": 0.28138639737870735, "mean_env_wait_ms": 3.006614792632062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016538381576538086, "StateBufferConnector_ms": 0.007959604263305664, "ViewRequirementAgentConnector_ms": 0.19589781761169434}, "num_episodes": 32, "episode_return_max": -26.389649400984677, "episode_return_min": -1350.9952835109518, "episode_return_mean": -710.1281897482866, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.417204240593, "num_env_steps_trained_throughput_per_sec": 304.417204240593, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11947.73, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11947.659, "sample_time_ms": 1063.929, "learn_time_ms": 10817.726, "learn_throughput": 369.763, "synch_weights_time_ms": 65.254}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "3541f_00000", "date": "2024-08-03_02-47-13", "timestamp": 1722633433, "time_this_iter_s": 13.152992248535156, "time_total_s": 146.0445590019226, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.0445590019226, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.95, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.06109547317028, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.266647225121657, "policy_loss": -0.00703048324988534, "vf_loss": 7.275713696579138, "vf_explained_var": 0.7349767120555043, "kl": 0.011986938189511433, "entropy": 1.4860172246893246, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -13.871258135904165, "episode_reward_min": -1398.1404457305994, "episode_reward_mean": -705.0362470067971, "episode_len_mean": 133.76, "episode_media": {}, "episodes_timesteps_total": 13376, "policy_reward_min": {"policy_0": -1398.1404457305994}, "policy_reward_max": {"policy_0": -13.871258135904165}, "policy_reward_mean": {"policy_0": -705.0362470067971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894], "episode_lengths": [106, 150, 150, 150, 73, 76, 107, 150, 150, 150, 150, 140, 41, 150, 150, 150, 117, 81, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 130, 150, 52, 91, 150, 150, 150, 150, 150, 150, 150, 150, 45, 111, 150, 150, 150, 150, 130, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 92, 142, 100, 150, 92, 150, 150, 150, 150, 108, 150, 69, 150, 150, 56, 150, 90, 150, 150, 150, 150, 47, 150, 150, 150], "policy_policy_0_reward": [-358.6282599026576, -914.0427984736768, -1100.1107319476569, -365.1897853075424, -125.79491772580094, -134.92356254144684, -383.34307028649516, -750.7242253416147, -698.4942306711057, -912.8522977040592, -1175.7117991910395, -686.3500818706661, -76.60012836501339, -1264.176001568517, -1072.606160110319, -1066.223416156996, -515.779287784754, -177.5083243606839, -650.7894918880405, -1217.445597529988, -706.0656807410164, -1060.3537093982895, -1073.5014666483603, -275.6716129329696, -989.1710429972838, -818.0963011417384, -1188.9957935876046, -933.7793870805235, -737.9902753829232, -839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565095342896125, "mean_inference_ms": 1.683115902941839, "mean_action_processing_ms": 0.28095764934699946, "mean_env_wait_ms": 3.0117601613270386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01656937599182129, "StateBufferConnector_ms": 0.008008718490600586, "ViewRequirementAgentConnector_ms": 0.19771456718444824}, "num_episodes": 30, "episode_return_max": -13.871258135904165, "episode_return_min": -1398.1404457305994, "episode_return_mean": -705.0362470067971, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.08234234977004, "num_env_steps_trained_throughput_per_sec": 305.08234234977004, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11916.056, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11915.985, "sample_time_ms": 1049.58, "learn_time_ms": 10800.653, "learn_throughput": 370.348, "synch_weights_time_ms": 65.002}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "3541f_00000", "date": "2024-08-03_02-47-26", "timestamp": 1722633446, "time_this_iter_s": 13.122967720031738, "time_total_s": 159.16752672195435, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.16752672195435, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.94736842105263, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.7316365296642, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.803816011051337, "policy_loss": -0.008478588977595791, "vf_loss": 7.814720191061497, "vf_explained_var": 0.7932779755443334, "kl": 0.013173054404145053, "entropy": 1.6706947057197492, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -13.871258135904165, "episode_reward_min": -1417.2264168866484, "episode_reward_mean": -694.1777417065333, "episode_len_mean": 134.5, "episode_media": {}, "episodes_timesteps_total": 13450, "policy_reward_min": {"policy_0": -1417.2264168866484}, "policy_reward_max": {"policy_0": -13.871258135904165}, "policy_reward_mean": {"policy_0": -694.1777417065333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 130, 150, 52, 91, 150, 150, 150, 150, 150, 150, 150, 150, 45, 111, 150, 150, 150, 150, 130, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 92, 142, 100, 150, 92, 150, 150, 150, 150, 108, 150, 69, 150, 150, 56, 150, 90, 150, 150, 150, 150, 47, 150, 150, 150, 150, 48, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 130, 106, 150, 150, 150, 104, 119, 150, 66, 150, 150, 150, 150], "policy_policy_0_reward": [-839.8036067553528, -760.8313062835354, -598.4203688830645, -976.7640145971541, -771.6984523683361, -515.5864014194879, -910.7299351479469, -873.7633185633571, -643.6873413912128, -429.83496266650315, -1093.5716035543353, -74.2510165235547, -454.0077863403967, -924.444922282038, -33.78245418546724, -150.58766150873186, -1019.8938795387614, -390.3804286071953, -794.5772734393043, -500.9164528608798, -1044.1896534984166, -1120.4229039473591, -1252.6970175887282, -896.9934900601098, -32.694174210365816, -509.1700514980881, -917.4282959240942, -530.3007242443023, -1113.0563244812517, -537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559345357207335, "mean_inference_ms": 1.6808752758204397, "mean_action_processing_ms": 0.2802706351069963, "mean_env_wait_ms": 3.0137898974777655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012528657913208008, "StateBufferConnector_ms": 0.00802159309387207, "ViewRequirementAgentConnector_ms": 0.19163966178894043}, "num_episodes": 29, "episode_return_max": -13.871258135904165, "episode_return_min": -1417.2264168866484, "episode_return_mean": -694.1777417065333, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1435211224501, "num_env_steps_trained_throughput_per_sec": 301.1435211224501, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11954.568, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11954.495, "sample_time_ms": 1051.689, "learn_time_ms": 10836.255, "learn_throughput": 369.131, "synch_weights_time_ms": 65.776}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "3541f_00000", "date": "2024-08-03_02-47-39", "timestamp": 1722633459, "time_this_iter_s": 13.296180963516235, "time_total_s": 172.46370768547058, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.46370768547058, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.878947368421052, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.99068006426096, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.015965746839841, "policy_loss": -0.015296816407741668, "vf_loss": 7.032778279483319, "vf_explained_var": 0.8734801791608333, "kl": 0.014913255872640245, "entropy": 1.645336528867483, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 1.035857069038704, "episode_reward_min": -1417.2264168866484, "episode_reward_mean": -683.4921047441462, "episode_len_mean": 134.1, "episode_media": {}, "episodes_timesteps_total": 13410, "policy_reward_min": {"policy_0": -1417.2264168866484}, "policy_reward_max": {"policy_0": 1.035857069038704}, "policy_reward_mean": {"policy_0": -683.4921047441462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606], "episode_lengths": [150, 130, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 92, 142, 100, 150, 92, 150, 150, 150, 150, 108, 150, 69, 150, 150, 56, 150, 90, 150, 150, 150, 150, 47, 150, 150, 150, 150, 48, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 130, 106, 150, 150, 150, 104, 119, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 39, 62, 80, 150, 150, 81, 150, 150, 55, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-537.0408225381913, -442.21191966937363, -861.6168794821434, -173.76739590457962, -393.5107081837727, -744.1475657872228, -827.1632421715653, -792.2597715423365, -926.7361710231041, -1350.9952835109518, -213.39663782922636, -1299.6819216501888, -718.0617478309008, -1398.1404457305994, -374.2302336214095, -473.25276219417816, -387.1481822764475, -276.14950002568526, -672.8603906942551, -370.3792477057141, -909.011921724477, -171.3857867353635, -1245.9781257355348, -356.26417196920386, -1176.0682192833017, -1133.0186643599022, -381.2452540441964, -1106.7257154633865, -57.814369950656484, -599.8146182849468, -666.3904459195883, -26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554350396720462, "mean_inference_ms": 1.6801421438748119, "mean_action_processing_ms": 0.2800026066970231, "mean_env_wait_ms": 3.0176671186187507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013223409652709961, "StateBufferConnector_ms": 0.0081329345703125, "ViewRequirementAgentConnector_ms": 0.19271039962768555}, "num_episodes": 29, "episode_return_max": 1.035857069038704, "episode_return_min": -1417.2264168866484, "episode_return_mean": -683.4921047441462, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.82852743668957, "num_env_steps_trained_throughput_per_sec": 300.82852743668957, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12549.377, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12549.303, "sample_time_ms": 1053.817, "learn_time_ms": 11426.814, "learn_throughput": 350.054, "synch_weights_time_ms": 67.88}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "3541f_00000", "date": "2024-08-03_02-47-53", "timestamp": 1722633473, "time_this_iter_s": 13.308548927307129, "time_total_s": 185.7722566127777, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0712170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.7722566127777, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.74736842105263, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.213389676809314, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.32865331719319, "policy_loss": -0.018952697243366855, "vf_loss": 6.347301223377387, "vf_explained_var": 0.8784736544514696, "kl": 0.01933775797363829, "entropy": 1.6794396424045166, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 1.035857069038704, "episode_reward_min": -1417.2264168866484, "episode_reward_mean": -699.9966497565277, "episode_len_mean": 133.71, "episode_media": {}, "episodes_timesteps_total": 13371, "policy_reward_min": {"policy_0": -1417.2264168866484}, "policy_reward_max": {"policy_0": 1.035857069038704}, "policy_reward_mean": {"policy_0": -699.9966497565277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351], "episode_lengths": [56, 150, 90, 150, 150, 150, 150, 47, 150, 150, 150, 150, 48, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 130, 106, 150, 150, 150, 104, 119, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 39, 62, 80, 150, 150, 81, 150, 150, 55, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 106, 150, 150, 150, 58, 150, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 150, 150, 150, 80, 150], "policy_policy_0_reward": [-26.224537882073083, -913.1078876857695, -286.6224374691345, -1120.0547615827813, -826.7772116308713, -847.252530524227, -1075.872461646642, -13.871258135904165, -938.9592569896206, -569.904012688869, -1243.1049605932894, -1417.2264168866484, -108.90769263286062, -761.5647108003748, -570.7698804246091, -832.9715061192501, -956.7500017695072, -531.8647986692364, -744.4170397058047, -1142.4752543675047, -568.559114951099, -1004.5837592984717, -1026.7241068043013, -1041.074342990102, -768.1864293935565, -315.47807389676836, -107.94555767148594, -562.0775336663331, -157.78665916250827, -799.7491914641763, -1112.1020927382574, -759.4730358122013, -357.15427643446515, -506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551164631114064, "mean_inference_ms": 1.6786351070863794, "mean_action_processing_ms": 0.2791388642586368, "mean_env_wait_ms": 3.0198583479663044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013422966003417969, "StateBufferConnector_ms": 0.008022308349609375, "ViewRequirementAgentConnector_ms": 0.190460205078125}, "num_episodes": 31, "episode_return_max": 1.035857069038704, "episode_return_min": -1417.2264168866484, "episode_return_mean": -699.9966497565277, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6604121551907, "num_env_steps_trained_throughput_per_sec": 300.6604121551907, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12999.552, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12999.479, "sample_time_ms": 1056.588, "learn_time_ms": 11873.051, "learn_throughput": 336.897, "synch_weights_time_ms": 69.047}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "3541f_00000", "date": "2024-08-03_02-48-06", "timestamp": 1722633486, "time_this_iter_s": 13.316311120986938, "time_total_s": 199.08856773376465, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.08856773376465, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.073684210526313, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.63306664327781, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.218543810149034, "policy_loss": -0.0075961592616901425, "vf_loss": 6.228343247870604, "vf_explained_var": 0.8923970884953936, "kl": 0.013855194135491427, "entropy": 1.6876226683457694, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": 1.035857069038704, "episode_reward_min": -1436.3453543484836, "episode_reward_mean": -719.3432730435857, "episode_len_mean": 134.89, "episode_media": {}, "episodes_timesteps_total": 13489, "policy_reward_min": {"policy_0": -1436.3453543484836}, "policy_reward_max": {"policy_0": 1.035857069038704}, "policy_reward_mean": {"policy_0": -719.3432730435857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453], "episode_lengths": [119, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 39, 62, 80, 150, 150, 81, 150, 150, 55, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 106, 150, 150, 150, 58, 150, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 39, 150, 150, 65, 150, 150, 47, 150, 150, 101, 150], "policy_policy_0_reward": [-506.2030819197562, -1014.5420670719076, -73.1148487872139, -516.6488599879425, -501.1534236983887, -856.8374250186076, -1228.7277264690736, -789.0341916787678, -1100.1638872145452, -1062.8631263561801, -525.0740588299217, -1040.8256240111232, -560.6025614417508, -970.5900217368511, -350.5705138907213, -451.0669378370531, 1.035857069038704, -38.806497382305466, -249.19202338994492, -791.7159790621675, -353.0749305346876, -108.94097237751261, -584.7350120646119, -1039.9547733038462, -131.15654740932723, -564.8180883926564, -460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550500165763376, "mean_inference_ms": 1.6778930349543242, "mean_action_processing_ms": 0.2788592531583597, "mean_env_wait_ms": 3.0249348929487354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0130615234375, "StateBufferConnector_ms": 0.008120536804199219, "ViewRequirementAgentConnector_ms": 0.19268202781677246}, "num_episodes": 33, "episode_return_max": 1.035857069038704, "episode_return_min": -1436.3453543484836, "episode_return_mean": -719.3432730435857, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.2531499241149, "num_env_steps_trained_throughput_per_sec": 301.2531499241149, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13023.773, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13023.699, "sample_time_ms": 1059.234, "learn_time_ms": 11897.66, "learn_throughput": 336.201, "synch_weights_time_ms": 66.026}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "3541f_00000", "date": "2024-08-03_02-48-20", "timestamp": 1722633500, "time_this_iter_s": 13.290899753570557, "time_total_s": 212.3794674873352, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f832e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.3794674873352, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.863157894736844, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.89001811246077, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.2976125235358875, "policy_loss": -0.012835306185782732, "vf_loss": 6.311435494820277, "vf_explained_var": 0.9245107436552644, "kl": 0.016132378481294552, "entropy": 1.6494474786023299, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -7.245764957606987, "episode_reward_min": -1436.3453543484836, "episode_reward_mean": -746.6241955279718, "episode_len_mean": 137.19, "episode_media": {}, "episodes_timesteps_total": 13719, "policy_reward_min": {"policy_0": -1436.3453543484836}, "policy_reward_max": {"policy_0": -7.245764957606987}, "policy_reward_mean": {"policy_0": -746.6241955279718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015], "episode_lengths": [150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 106, 150, 150, 150, 58, 150, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 39, 150, 150, 65, 150, 150, 47, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 128, 150, 150, 150, 150, 150, 116, 150, 98, 150, 150, 150, 150, 48, 150, 74, 150], "policy_policy_0_reward": [-460.78826746633376, -291.34543902148135, -1016.5250026321397, -1326.2943562009848, -844.896144797151, -908.4112893503003, -747.1437346441354, -915.8400358198827, -1003.1975976138081, -879.3303687394606, -1249.2800524800311, -7.245764957606987, -481.13844128473346, -757.6256911770212, -851.7819624005047, -261.1584208225041, -544.6813979489333, -1246.2076278916966, -1066.9565730827874, -86.01653150385103, -989.1494490430574, -1128.21073466704, -970.5131632508017, -868.3825362157781, -174.53540061264596, -1079.0328024249302, -957.1283785963947, -1200.3368633508194, -909.6695579210499, -251.43334214618162, -1041.4297733700253, -30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544730337935849, "mean_inference_ms": 1.6762700842884697, "mean_action_processing_ms": 0.27852261872868594, "mean_env_wait_ms": 3.0263353010443073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013071775436401367, "StateBufferConnector_ms": 0.007901191711425781, "ViewRequirementAgentConnector_ms": 0.19037675857543945}, "num_episodes": 26, "episode_return_max": -7.245764957606987, "episode_return_min": -1436.3453543484836, "episode_return_mean": -746.6241955279718, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5654322182685, "num_env_steps_trained_throughput_per_sec": 296.5654322182685, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13075.209, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13075.136, "sample_time_ms": 1072.892, "learn_time_ms": 11935.43, "learn_throughput": 335.137, "synch_weights_time_ms": 66.041}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "3541f_00000", "date": "2024-08-03_02-48-33", "timestamp": 1722633513, "time_this_iter_s": 13.49980616569519, "time_total_s": 225.8792736530304, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.8792736530304, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.031578947368423, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.59223562677701, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.864239531010389, "policy_loss": -0.009647378324492214, "vf_loss": 5.87471565703551, "vf_explained_var": 0.9216659108797709, "kl": 0.017071742659633574, "entropy": 1.7022030625492335, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -9.465825886277413, "episode_reward_min": -1436.3453543484836, "episode_reward_mean": -703.7062734694935, "episode_len_mean": 131.39, "episode_media": {}, "episodes_timesteps_total": 13139, "policy_reward_min": {"policy_0": -1436.3453543484836}, "policy_reward_max": {"policy_0": -9.465825886277413}, "policy_reward_mean": {"policy_0": -703.7062734694935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947], "episode_lengths": [51, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 39, 150, 150, 65, 150, 150, 47, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 128, 150, 150, 150, 150, 150, 116, 150, 98, 150, 150, 150, 150, 48, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 94, 150, 150, 150, 51, 79, 150, 150, 109, 150, 58, 150, 150, 48, 37, 150, 150, 91, 73, 150, 81], "policy_policy_0_reward": [-30.041308415112386, -787.2155790097363, -1047.285218848673, -1285.7302082687943, -457.1103988867288, -641.6218810874424, -844.381455817205, -548.9250421886182, -101.23099058223004, -821.4660758276351, -655.0692647319673, -1280.8204748691653, -999.1428401651053, -1002.983656558169, -756.7712267111616, -729.582740653819, -476.5994405922803, -1104.7706512850089, -899.593133517742, -319.7358655272803, -553.1554214400659, -905.9991410402305, -1436.3453543484836, -1218.055425462321, -1308.2246830140589, -317.5795270343807, -1328.3621511158706, -576.2246361955937, -492.67149192975666, -125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545053161708474, "mean_inference_ms": 1.6768937872614176, "mean_action_processing_ms": 0.2786056684811722, "mean_env_wait_ms": 3.032830079634544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012711048126220703, "StateBufferConnector_ms": 0.008027791976928711, "ViewRequirementAgentConnector_ms": 0.19217324256896973}, "num_episodes": 31, "episode_return_max": -9.465825886277413, "episode_return_min": -1436.3453543484836, "episode_return_mean": -703.7062734694935, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.496902346086, "num_env_steps_trained_throughput_per_sec": 304.496902346086, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13082.777, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13082.705, "sample_time_ms": 1076.759, "learn_time_ms": 11939.052, "learn_throughput": 335.035, "synch_weights_time_ms": 66.119}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "3541f_00000", "date": "2024-08-03_02-48-46", "timestamp": 1722633526, "time_this_iter_s": 13.147968292236328, "time_total_s": 239.02724194526672, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.02724194526672, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 16.805263157894736, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.93815382520357, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.5632339534660185, "policy_loss": -0.007937096783522671, "vf_loss": 5.572307188808918, "vf_explained_var": 0.9390523658444484, "kl": 0.0152108560616095, "entropy": 1.596203376352787, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -9.465825886277413, "episode_reward_min": -1349.7992220637132, "episode_reward_mean": -685.6787368479247, "episode_len_mean": 129.05, "episode_media": {}, "episodes_timesteps_total": 12905, "policy_reward_min": {"policy_0": -1349.7992220637132}, "policy_reward_max": {"policy_0": -9.465825886277413}, "policy_reward_mean": {"policy_0": -685.6787368479247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444], "episode_lengths": [58, 150, 150, 39, 150, 150, 65, 150, 150, 47, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 128, 150, 150, 150, 150, 150, 116, 150, 98, 150, 150, 150, 150, 48, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 94, 150, 150, 150, 51, 79, 150, 150, 109, 150, 58, 150, 150, 48, 37, 150, 150, 91, 73, 150, 81, 150, 150, 150, 103, 142, 150, 121, 150, 150, 150, 150, 150, 58, 150, 77, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150], "policy_policy_0_reward": [-125.1926405686322, -988.264374484513, -1161.5880231391077, -16.273036578448306, -801.5672014280947, -1037.779501948965, -117.30854298433239, -865.521075313313, -931.3479459786487, -9.465825886277413, -1185.928617212591, -1181.033247809326, -219.6704612408568, -441.62750042895453, -1346.8873143687117, -1126.687408540036, -454.8485118920366, -421.83985336610186, -485.90903856699055, -1140.629806149394, -406.9113530738251, -252.65221989604288, -785.2009953560034, -329.86623943013564, -1083.7459339892182, -1061.048835700247, -903.5480269749194, -954.964228911481, -1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545113273197845, "mean_inference_ms": 1.6768004942283978, "mean_action_processing_ms": 0.27843544112421015, "mean_env_wait_ms": 3.035248280470788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012911558151245117, "StateBufferConnector_ms": 0.008028268814086914, "ViewRequirementAgentConnector_ms": 0.19057321548461914}, "num_episodes": 29, "episode_return_max": -9.465825886277413, "episode_return_min": -1349.7992220637132, "episode_return_mean": -685.6787368479247, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3059995862679, "num_env_steps_trained_throughput_per_sec": 300.3059995862679, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13278.868, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13278.796, "sample_time_ms": 1068.155, "learn_time_ms": 12142.84, "learn_throughput": 329.412, "synch_weights_time_ms": 67.029}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "3541f_00000", "date": "2024-08-03_02-49-00", "timestamp": 1722633540, "time_this_iter_s": 13.332529067993164, "time_total_s": 252.3597710132599, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0712830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.3597710132599, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.057894736842105, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.86738380988439, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.2308362506330015, "policy_loss": -0.014966770396373856, "vf_loss": 5.248885008444389, "vf_explained_var": 0.9610031713421147, "kl": 0.013669064231286636, "entropy": 1.846611927698056, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -13.030865480098614, "episode_reward_min": -1349.7992220637132, "episode_reward_mean": -691.4755078113725, "episode_len_mean": 132.17, "episode_media": {}, "episodes_timesteps_total": 13217, "policy_reward_min": {"policy_0": -1349.7992220637132}, "policy_reward_max": {"policy_0": -13.030865480098614}, "policy_reward_mean": {"policy_0": -691.4755078113725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282], "episode_lengths": [150, 116, 150, 98, 150, 150, 150, 150, 48, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 94, 150, 150, 150, 51, 79, 150, 150, 109, 150, 58, 150, 150, 48, 37, 150, 150, 91, 73, 150, 81, 150, 150, 150, 103, 142, 150, 121, 150, 150, 150, 150, 150, 58, 150, 77, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 101, 143, 70, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1004.1989531472647, -253.68611117599139, -381.62630173396536, -271.62204564515434, -1313.0603783862573, -1052.6881507108192, -855.1309764678196, -1117.3455049546137, -40.14177513245026, -565.7688117796907, -127.14009860944265, -400.3206972778015, -635.3355488824302, -943.6158745831315, -1180.6492313627896, -1010.9844178712124, -1027.0567330017757, -902.7671156085601, -1349.7992220637132, -685.4057455978631, -55.302951981503334, -539.6255524631149, -289.6269586514952, -972.2177958646658, -775.4168611311779, -1118.4969852289444, -23.718018431744433, -91.71528751501148, -1224.2181373361122, -1135.1156524685919, -234.34608675395555, -888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547675834002009, "mean_inference_ms": 1.676455060778626, "mean_action_processing_ms": 0.27824078239227373, "mean_env_wait_ms": 3.038814606230034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01275181770324707, "StateBufferConnector_ms": 0.008041620254516602, "ViewRequirementAgentConnector_ms": 0.19250774383544922}, "num_episodes": 28, "episode_return_max": -13.030865480098614, "episode_return_min": -1349.7992220637132, "episode_return_mean": -691.4755078113725, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.07160415353997, "num_env_steps_trained_throughput_per_sec": 320.07160415353997, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13185.356, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13185.284, "sample_time_ms": 1053.166, "learn_time_ms": 12064.449, "learn_throughput": 331.553, "synch_weights_time_ms": 66.901}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "3541f_00000", "date": "2024-08-03_02-49-12", "timestamp": 1722633552, "time_this_iter_s": 12.509502649307251, "time_total_s": 264.86927366256714, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f832e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.86927366256714, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.272222222222226, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.37045819362004, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.87767682398359, "policy_loss": -0.014412600478196206, "vf_loss": 5.894033885995547, "vf_explained_var": 0.9399283689136306, "kl": 0.016355512500861855, "entropy": 1.8608864770581326, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -13.030865480098614, "episode_reward_min": -1470.7496179925286, "episode_reward_mean": -704.4769313885358, "episode_len_mean": 134.94, "episode_media": {}, "episodes_timesteps_total": 13494, "policy_reward_min": {"policy_0": -1470.7496179925286}, "policy_reward_max": {"policy_0": -13.030865480098614}, "policy_reward_mean": {"policy_0": -704.4769313885358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964], "episode_lengths": [150, 58, 150, 150, 48, 37, 150, 150, 91, 73, 150, 81, 150, 150, 150, 103, 142, 150, 121, 150, 150, 150, 150, 150, 58, 150, 77, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 101, 143, 70, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 59, 150, 105, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-888.1279123355266, -87.79413791646668, -794.5736208105119, -781.7253643200924, -110.27136344935525, -20.310723628542615, -1320.6302490587732, -552.5800880460791, -267.2841641002826, -87.94314571178998, -973.5392732063843, -143.70027620463947, -1086.2836140896645, -847.1209387938534, -651.8364563006749, -402.2010457516699, -508.1272597942514, -850.9481019300847, -191.70083839329834, -767.4535642128611, -495.53316523986757, -1140.02757983918, -1296.1590567224648, -945.0191024905595, -120.72660494615222, -456.43056479917857, -169.91050917095592, -833.4962801552601, -13.030865480098614, -651.391782831579, -1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545366248124545, "mean_inference_ms": 1.6766675348738462, "mean_action_processing_ms": 0.27811166563138884, "mean_env_wait_ms": 3.0443713765956573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01236271858215332, "StateBufferConnector_ms": 0.007980585098266602, "ViewRequirementAgentConnector_ms": 0.1930835247039795}, "num_episodes": 31, "episode_return_max": -13.030865480098614, "episode_return_min": -1470.7496179925286, "episode_return_mean": -704.4769313885358, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.04992494035673, "num_env_steps_trained_throughput_per_sec": 305.04992494035673, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13182.63, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13182.558, "sample_time_ms": 1057.51, "learn_time_ms": 12056.734, "learn_throughput": 331.765, "synch_weights_time_ms": 67.546}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "3541f_00000", "date": "2024-08-03_02-49-25", "timestamp": 1722633565, "time_this_iter_s": 13.124600887298584, "time_total_s": 277.9938745498657, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.9938745498657, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.568421052631578, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.29920991460483, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.849165346970161, "policy_loss": -0.012987158820518136, "vf_loss": 4.8629223220050335, "vf_explained_var": 0.9624511818711956, "kl": 0.016343135358488324, "entropy": 1.6248446890463433, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -42.53651351341206, "episode_reward_min": -1470.7496179925286, "episode_reward_mean": -747.2354099003463, "episode_len_mean": 139.74, "episode_media": {}, "episodes_timesteps_total": 13974, "policy_reward_min": {"policy_0": -1470.7496179925286}, "policy_reward_max": {"policy_0": -42.53651351341206}, "policy_reward_mean": {"policy_0": -747.2354099003463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 101, 143, 70, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 59, 150, 105, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 104, 150, 150, 81, 150, 150, 150, 150, 92, 150, 150, 150, 60, 150, 150, 113, 69, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1336.3748151229, -958.4103242408605, -953.3701306594803, -891.5445938698102, -797.1145898622065, -1045.3223471528897, -975.3787834470635, -1120.8385119522195, -74.94279892228238, -791.0478584769593, -752.199538319444, -510.5027002716586, -954.5736138057814, -362.49203149948727, -465.1111949564918, -73.30711312724476, -570.86428997434, -669.0913135235791, -1097.9753463143577, -1028.21259749822, -132.22687677383394, -579.9751050189019, -819.6477935040862, -1247.2244203839002, -531.9445537762684, -1187.1910573631262, -379.0759643439618, -1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541555375276928, "mean_inference_ms": 1.6763970771434034, "mean_action_processing_ms": 0.2781656471870286, "mean_env_wait_ms": 3.046482117805949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012062788009643555, "StateBufferConnector_ms": 0.00791168212890625, "ViewRequirementAgentConnector_ms": 0.19328713417053223}, "num_episodes": 30, "episode_return_max": -42.53651351341206, "episode_return_min": -1470.7496179925286, "episode_return_mean": -747.2354099003463, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.5233578631625, "num_env_steps_trained_throughput_per_sec": 297.5233578631625, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13215.941, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13215.868, "sample_time_ms": 1077.914, "learn_time_ms": 12069.433, "learn_throughput": 331.416, "synch_weights_time_ms": 67.745}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "3541f_00000", "date": "2024-08-03_02-49-39", "timestamp": 1722633579, "time_this_iter_s": 13.457293510437012, "time_total_s": 291.45116806030273, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d70700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.45116806030273, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.715789473684207, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.91630113124847, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.2661540992558, "policy_loss": -0.007145945726855037, "vf_loss": 5.277625977744659, "vf_explained_var": 0.9295083806539576, "kl": 0.01136355627107456, "entropy": 1.8879088564465443, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -42.53651351341206, "episode_reward_min": -1470.7496179925286, "episode_reward_mean": -747.303619089918, "episode_len_mean": 137.98, "episode_media": {}, "episodes_timesteps_total": 13798, "policy_reward_min": {"policy_0": -1470.7496179925286}, "policy_reward_max": {"policy_0": -42.53651351341206}, "policy_reward_mean": {"policy_0": -747.303619089918}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 59, 150, 105, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 104, 150, 150, 81, 150, 150, 150, 150, 92, 150, 150, 150, 60, 150, 150, 113, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 118, 150, 150, 150, 84, 150, 150, 150, 150, 150, 109, 150, 150, 150, 73, 150, 150, 150, 150, 92, 124, 87], "policy_policy_0_reward": [-1095.0786970980387, -760.4896821334082, -1189.3187016484208, -979.1896148679056, -938.7939009147238, -675.7817162116096, -823.1919315750155, -408.69837153597746, -367.8159753035273, -486.19604731672456, -975.0435819720417, -1107.9706648493282, -713.3128244996798, -980.8623034748913, -683.3281375468738, -1470.7496179925286, -814.7446982579027, -764.793089075169, -1047.9121199511342, -1020.615176335336, -832.2991907838465, -1107.872470051614, -755.6705673178768, -788.423898880737, -157.27510567075475, -1092.1123305374804, -386.25561589628717, -904.1870449947384, -47.39321148924557, -528.413503157087, -460.584853369615, -652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539312442750416, "mean_inference_ms": 1.6768847233929085, "mean_action_processing_ms": 0.2781187023191682, "mean_env_wait_ms": 3.0501444253418573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012244701385498047, "StateBufferConnector_ms": 0.007921934127807617, "ViewRequirementAgentConnector_ms": 0.19426918029785156}, "num_episodes": 27, "episode_return_max": -42.53651351341206, "episode_return_min": -1470.7496179925286, "episode_return_mean": -747.303619089918, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.3314492134816, "num_env_steps_trained_throughput_per_sec": 355.3314492134816, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13013.382, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13013.308, "sample_time_ms": 1078.254, "learn_time_ms": 11868.025, "learn_throughput": 337.04, "synch_weights_time_ms": 66.277}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "3541f_00000", "date": "2024-08-03_02-49-50", "timestamp": 1722633590, "time_this_iter_s": 11.270512342453003, "time_total_s": 302.72168040275574, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07117e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.72168040275574, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.643749999999997, "ram_util_percent": 26.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.45616795818012, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.373707225173712, "policy_loss": -0.003238767867636246, "vf_loss": 4.3809378455082575, "vf_explained_var": 0.9379509177679817, "kl": 0.012739667266911663, "entropy": 1.9449395017077526, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -42.53651351341206, "episode_reward_min": -1474.975752568114, "episode_reward_mean": -750.9198962721472, "episode_len_mean": 137.27, "episode_media": {}, "episodes_timesteps_total": 13727, "policy_reward_min": {"policy_0": -1474.975752568114}, "policy_reward_max": {"policy_0": -42.53651351341206}, "policy_reward_mean": {"policy_0": -750.9198962721472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384], "episode_lengths": [150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 104, 150, 150, 81, 150, 150, 150, 150, 92, 150, 150, 150, 60, 150, 150, 113, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 118, 150, 150, 150, 84, 150, 150, 150, 150, 150, 109, 150, 150, 150, 73, 150, 150, 150, 150, 92, 124, 87, 150, 150, 150, 137, 150, 150, 150, 112, 129, 150, 92, 134, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 135, 150], "policy_policy_0_reward": [-652.2748695462697, -778.9750894009638, -160.72550029885744, -610.6836996674484, -1384.4048231383613, -42.53651351341206, -207.78463364194403, -1280.3755118138624, -780.4657973909669, -1065.1366987542383, -669.4521728368791, -688.6652702493964, -1101.9010511648119, -1318.6505320258668, -797.7147774342676, -394.6056793124825, -408.320712751858, -849.464453084734, -348.5796068386382, -858.5979427400456, -951.6185976722461, -187.28509341472724, -335.5335271662325, -502.11493175536725, -1212.9455036937231, -468.0701170738781, -174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539670220268947, "mean_inference_ms": 1.6775982728426855, "mean_action_processing_ms": 0.2783178682612477, "mean_env_wait_ms": 3.0543523133923727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012294769287109375, "StateBufferConnector_ms": 0.008034944534301758, "ViewRequirementAgentConnector_ms": 0.19565916061401367}, "num_episodes": 31, "episode_return_max": -42.53651351341206, "episode_return_min": -1474.975752568114, "episode_return_mean": -750.9198962721472, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.52578822359146, "num_env_steps_trained_throughput_per_sec": 314.52578822359146, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12955.477, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12955.401, "sample_time_ms": 1085.673, "learn_time_ms": 11804.174, "learn_throughput": 338.863, "synch_weights_time_ms": 64.806}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "3541f_00000", "date": "2024-08-03_02-50-03", "timestamp": 1722633603, "time_this_iter_s": 12.730202436447144, "time_total_s": 315.4518828392029, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 315.4518828392029, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.62777777777778, "ram_util_percent": 26.777777777777782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.32638519605, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.668693998456002, "policy_loss": -0.009813622791746942, "vf_loss": 4.682959865033626, "vf_explained_var": 0.9537169195711612, "kl": 0.012907657086240457, "entropy": 2.0521388524522384, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -3.667729992078008, "episode_reward_min": -1474.975752568114, "episode_reward_mean": -771.5013865937207, "episode_len_mean": 136.48, "episode_media": {}, "episodes_timesteps_total": 13648, "policy_reward_min": {"policy_0": -1474.975752568114}, "policy_reward_max": {"policy_0": -3.667729992078008}, "policy_reward_mean": {"policy_0": -771.5013865937207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354], "episode_lengths": [92, 150, 150, 150, 60, 150, 150, 113, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 118, 150, 150, 150, 84, 150, 150, 150, 150, 150, 109, 150, 150, 150, 73, 150, 150, 150, 150, 92, 124, 87, 150, 150, 150, 137, 150, 150, 150, 112, 129, 150, 92, 134, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 135, 150, 150, 150, 95, 95, 150, 150, 150, 144, 58, 35, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-174.97518177760946, -817.6536234593685, -618.513417486408, -1252.679769329037, -140.7527317623327, -1000.6403154647797, -986.1881954995929, -298.0766141210567, -194.70901319126375, -982.0985376954702, -817.3889081133902, -859.0209744212964, -1279.5678478839502, -641.1145690325518, -837.569283745288, -1095.373991798853, -1049.1511650680504, -935.8328992416796, -1106.5192420246663, -143.41102007647646, -788.4980769883664, -360.76639019140555, -1149.0162416319074, -798.8720537207698, -1003.0923497556487, -317.40254102719325, -442.4836091418109, -1272.4730049967484, -865.4924491935014, -1249.6627715323714, -1230.3686763930082, -471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55406289577559, "mean_inference_ms": 1.6778111880091384, "mean_action_processing_ms": 0.2781839557318643, "mean_env_wait_ms": 3.0572873039677004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012227058410644531, "StateBufferConnector_ms": 0.007977485656738281, "ViewRequirementAgentConnector_ms": 0.1984100341796875}, "num_episodes": 26, "episode_return_max": -3.667729992078008, "episode_return_min": -1474.975752568114, "episode_return_mean": -771.5013865937207, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.3974438565192, "num_env_steps_trained_throughput_per_sec": 299.3974438565192, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12961.089, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12961.015, "sample_time_ms": 1089.661, "learn_time_ms": 11807.185, "learn_throughput": 338.777, "synch_weights_time_ms": 63.429}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "3541f_00000", "date": "2024-08-03_02-50-16", "timestamp": 1722633616, "time_this_iter_s": 13.37294316291809, "time_total_s": 328.824826002121, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07136d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 328.824826002121, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.242105263157896, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.5175504207611, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.0955396729211015, "policy_loss": -0.011454974618391133, "vf_loss": 5.109767326464255, "vf_explained_var": 0.9576765117545922, "kl": 0.017095816562596157, "entropy": 2.093157845363021, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -3.667729992078008, "episode_reward_min": -1474.975752568114, "episode_reward_mean": -757.7020911599454, "episode_len_mean": 135.92, "episode_media": {}, "episodes_timesteps_total": 13592, "policy_reward_min": {"policy_0": -1474.975752568114}, "policy_reward_max": {"policy_0": -3.667729992078008}, "policy_reward_mean": {"policy_0": -757.7020911599454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597], "episode_lengths": [109, 150, 150, 150, 73, 150, 150, 150, 150, 92, 124, 87, 150, 150, 150, 137, 150, 150, 150, 112, 129, 150, 92, 134, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 135, 150, 150, 150, 95, 95, 150, 150, 150, 144, 58, 35, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 66, 61, 150, 150, 150, 38, 150, 150, 150, 92, 150, 150], "policy_policy_0_reward": [-471.1435719091654, -700.8733002779927, -811.1341970798205, -866.228648182981, -238.27592482172963, -782.1914691550948, -1084.4801506771012, -740.0347691812757, -696.8316994579135, -424.3548248559887, -485.51463097516853, -298.6755055607368, -1069.9195708946386, -776.1506302252039, -1207.064096783914, -370.01430673654744, -859.9697788470816, -1363.7818342446053, -968.774935310727, -474.17647295710157, -545.6288576675096, -800.2192557606209, -141.79444420333263, -669.1752054561382, -1194.7711905669319, -903.2624529576372, -117.73573960199154, -597.8543892841362, -901.4204734249021, -590.5057507084422, -899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536291526869896, "mean_inference_ms": 1.6776266037339935, "mean_action_processing_ms": 0.2780621126176509, "mean_env_wait_ms": 3.0625744833719666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012402772903442383, "StateBufferConnector_ms": 0.00811767578125, "ViewRequirementAgentConnector_ms": 0.20042204856872559}, "num_episodes": 31, "episode_return_max": -3.667729992078008, "episode_return_min": -1474.975752568114, "episode_return_mean": -757.7020911599454, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6508001595183, "num_env_steps_trained_throughput_per_sec": 300.6508001595183, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12963.749, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12963.674, "sample_time_ms": 1090.254, "learn_time_ms": 11807.454, "learn_throughput": 338.769, "synch_weights_time_ms": 65.226}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "3541f_00000", "date": "2024-08-03_02-50-30", "timestamp": 1722633630, "time_this_iter_s": 13.317712783813477, "time_total_s": 342.14253878593445, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0713eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.14253878593445, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.00526315789474, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.17157545487086, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.635720977683862, "policy_loss": -0.01122908952141491, "vf_loss": 4.651040642460187, "vf_explained_var": 0.970080358783404, "kl": 0.015174004750103191, "entropy": 2.1837733207891383, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -3.667729992078008, "episode_reward_min": -1478.79765044487, "episode_reward_mean": -812.7510457329555, "episode_len_mean": 138.68, "episode_media": {}, "episodes_timesteps_total": 13868, "policy_reward_min": {"policy_0": -1478.79765044487}, "policy_reward_max": {"policy_0": -3.667729992078008}, "policy_reward_mean": {"policy_0": -812.7510457329555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 135, 150, 150, 150, 95, 95, 150, 150, 150, 144, 58, 35, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 66, 61, 150, 150, 150, 38, 150, 150, 150, 92, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 94, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150], "policy_policy_0_reward": [-899.9361394611616, -1044.9325848590536, -767.379326304014, -1018.4517663800519, -886.3893938815853, -862.015449381497, -1090.0216942718623, -1474.975752568114, -461.07286195977855, -955.5055597552279, -478.44418349831795, -469.6342122006565, -765.0240527796384, -758.023928373583, -1021.6015175335511, -196.42822321130654, -208.4226188553098, -1047.6218478800895, -912.0864256002154, -560.4248630536257, -737.393194722514, -111.31641501976358, -3.667729992078008, -1165.409239426485, -410.69141320703886, -696.8420977230529, -1227.2862181508428, -989.0983958030699, -1196.5234762304676, -700.8149556242297, -574.1124875737337, -605.2929865556604, -709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531783132159586, "mean_inference_ms": 1.6768458244622264, "mean_action_processing_ms": 0.27765877259111965, "mean_env_wait_ms": 3.0668972527533964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01239919662475586, "StateBufferConnector_ms": 0.008249282836914062, "ViewRequirementAgentConnector_ms": 0.1998305320739746}, "num_episodes": 30, "episode_return_max": -3.667729992078008, "episode_return_min": -1478.79765044487, "episode_return_mean": -812.7510457329555, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.11526109300655, "num_env_steps_trained_throughput_per_sec": 349.11526109300655, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12760.728, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12760.652, "sample_time_ms": 1081.445, "learn_time_ms": 11612.536, "learn_throughput": 344.455, "synch_weights_time_ms": 65.918}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "3541f_00000", "date": "2024-08-03_02-50-41", "timestamp": 1722633641, "time_this_iter_s": 11.466641187667847, "time_total_s": 353.6091799736023, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 353.6091799736023, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 28.31875, "ram_util_percent": 27.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 175.21191025575, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.629821540415287, "policy_loss": -0.010351045822123222, "vf_loss": 4.6437351914743585, "vf_explained_var": 0.9598356924330195, "kl": 0.014575825699709354, "entropy": 2.024343959490458, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -4.984960519112905, "episode_reward_min": -1478.79765044487, "episode_reward_mean": -812.9577730445312, "episode_len_mean": 136.77, "episode_media": {}, "episodes_timesteps_total": 13677, "policy_reward_min": {"policy_0": -1478.79765044487}, "policy_reward_max": {"policy_0": -4.984960519112905}, "policy_reward_mean": {"policy_0": -812.9577730445312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 66, 61, 150, 150, 150, 38, 150, 150, 150, 92, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 94, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 142, 76, 150, 150, 150, 98, 150, 43, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 110], "policy_policy_0_reward": [-709.2447444319115, -975.4274488693283, -880.3749599528546, -1125.077902912916, -1462.7575561976091, -892.0278746777568, -947.0636169598354, -750.8457736871652, -854.563744829598, -682.4008005349154, -1136.4338395545847, -894.1255754261772, -312.3529552648092, -697.9288818958474, -1133.8174283315197, -875.3668896833906, -1177.3643147666128, -927.4414384373571, -1241.3529955047454, -921.6573567389675, -871.6858588658395, -1099.8621483798204, -755.3846425863682, -869.4500713812764, -644.1781791731962, -238.81623459258813, -185.63345971987673, -73.75106828459127, -1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534425051197658, "mean_inference_ms": 1.678781221395382, "mean_action_processing_ms": 0.2780374850152241, "mean_env_wait_ms": 3.0704523104590944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011992454528808594, "StateBufferConnector_ms": 0.008240461349487305, "ViewRequirementAgentConnector_ms": 0.2037203311920166}, "num_episodes": 32, "episode_return_max": -4.984960519112905, "episode_return_min": -1478.79765044487, "episode_return_mean": -812.9577730445312, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.7124670606518, "num_env_steps_trained_throughput_per_sec": 338.7124670606518, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12628.028, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12627.952, "sample_time_ms": 1105.105, "learn_time_ms": 11453.198, "learn_throughput": 349.247, "synch_weights_time_ms": 68.833}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "3541f_00000", "date": "2024-08-03_02-50-53", "timestamp": 1722633653, "time_this_iter_s": 11.826640367507935, "time_total_s": 365.43582034111023, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d415a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 365.43582034111023, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.4470588235294, "ram_util_percent": 31.517647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.92071029543877, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.705788897226254, "policy_loss": -0.011480946681695059, "vf_loss": 4.718915250400702, "vf_explained_var": 0.9833615352089207, "kl": 0.017679742997764487, "entropy": 1.9202572541932266, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -4.984960519112905, "episode_reward_min": -1478.79765044487, "episode_reward_mean": -754.8552385035562, "episode_len_mean": 131.51, "episode_media": {}, "episodes_timesteps_total": 13151, "policy_reward_min": {"policy_0": -1478.79765044487}, "policy_reward_max": {"policy_0": -4.984960519112905}, "policy_reward_mean": {"policy_0": -754.8552385035562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701], "episode_lengths": [150, 150, 150, 38, 150, 150, 150, 92, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 94, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 142, 76, 150, 150, 150, 98, 150, 43, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 110, 69, 150, 150, 66, 150, 150, 56, 95, 150, 150, 74, 150, 150, 150, 150, 50, 150, 104, 150, 57, 150, 150, 150, 150, 150, 120, 56, 46], "policy_policy_0_reward": [-1171.018386828411, -595.5359623094947, -1216.7081343659609, -11.061950722962916, -823.5223297419076, -883.2845496047618, -652.9774575970166, -158.2339960752436, -1017.5006274277138, -455.178870075597, -1019.4265020717072, -998.6580576076267, -1050.9483618128816, -594.9462492117027, -739.6127119991918, -1071.0152507410985, -1062.6247334918687, -814.6729126374838, -692.9681361539675, -1478.79765044487, -1228.036282892397, -327.52433848064913, -15.314067738755588, -779.8493202763522, -933.6890150671477, -769.4450678844927, -1475.8572178141983, -573.4457068723164, -1025.329770141547, -971.4211523637018, -817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5601672039207056, "mean_inference_ms": 1.6989187364433223, "mean_action_processing_ms": 0.2813538581858066, "mean_env_wait_ms": 3.102159958327907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601480484008789, "StateBufferConnector_ms": 0.021351337432861328, "ViewRequirementAgentConnector_ms": 0.261974573135376}, "num_episodes": 28, "episode_return_max": -4.984960519112905, "episode_return_min": -1478.79765044487, "episode_return_mean": -754.8552385035562, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.46353196380215, "num_env_steps_trained_throughput_per_sec": 289.46353196380215, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12677.921, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12677.841, "sample_time_ms": 1259.111, "learn_time_ms": 11349.581, "learn_throughput": 352.436, "synch_weights_time_ms": 68.332}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "3541f_00000", "date": "2024-08-03_02-51-07", "timestamp": 1722633667, "time_this_iter_s": 13.831051588058472, "time_total_s": 379.2668719291687, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.2668719291687, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 46.25500000000001, "ram_util_percent": 32.27500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.68288151621817, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.642104205240806, "policy_loss": -0.010804335117669931, "vf_loss": 4.655341709405183, "vf_explained_var": 0.9804878555859129, "kl": 0.016972859663959148, "entropy": 2.0141951722403366, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -4.984960519112905, "episode_reward_min": -1403.9235461963058, "episode_reward_mean": -722.7089428654915, "episode_len_mean": 129.68, "episode_media": {}, "episodes_timesteps_total": 12968, "policy_reward_min": {"policy_0": -1403.9235461963058}, "policy_reward_max": {"policy_0": -4.984960519112905}, "policy_reward_mean": {"policy_0": -722.7089428654915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263], "episode_lengths": [150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 142, 76, 150, 150, 150, 98, 150, 43, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 110, 69, 150, 150, 66, 150, 150, 56, 95, 150, 150, 74, 150, 150, 150, 150, 50, 150, 104, 150, 57, 150, 150, 150, 150, 150, 120, 56, 46, 150, 150, 47, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 65, 144, 61, 81, 150, 150], "policy_policy_0_reward": [-817.291255316438, -1183.451819135628, -705.5017002545114, -1358.2844235681757, -853.197359439618, -1273.2172592156167, -145.0055032813207, -406.9553679070606, -1187.9424436011248, -1102.4238976439772, -976.5916200162965, -608.4194402747673, -1403.9235461963058, -1224.6992427716252, -1091.3368781308934, -40.786913417650574, -344.9968490722301, -852.1715239037292, -966.8166031064547, -1107.1736742929847, -731.5060883511375, -835.7483457971601, -211.83197330900148, -1066.280756741151, -1129.6695866601037, -764.959989595668, -184.1008966056649, -976.9072210025073, -30.871067792000257, -861.2822683179199, -4.984960519112905, -760.4142154338854, -1094.7476225497066, -1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5667879612496114, "mean_inference_ms": 1.7375857550059788, "mean_action_processing_ms": 0.2849102777248489, "mean_env_wait_ms": 3.1328393689026814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02602219581604004, "StateBufferConnector_ms": 0.02134227752685547, "ViewRequirementAgentConnector_ms": 0.2614600658416748}, "num_episodes": 30, "episode_return_max": -4.984960519112905, "episode_return_min": -1403.9235461963058, "episode_return_mean": -722.7089428654915, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.31188879135027, "num_env_steps_trained_throughput_per_sec": 359.31188879135027, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12541.439, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12541.361, "sample_time_ms": 1300.61, "learn_time_ms": 11172.618, "learn_throughput": 358.018, "synch_weights_time_ms": 67.316}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "3541f_00000", "date": "2024-08-03_02-51-18", "timestamp": 1722633678, "time_this_iter_s": 11.14488410949707, "time_total_s": 390.41175603866577, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.41175603866577, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.724999999999998, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.29496788581213, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.309993879497052, "policy_loss": -0.009624334459173649, "vf_loss": 4.3220749343434965, "vf_explained_var": 0.9651927491029103, "kl": 0.014005479781917567, "entropy": 1.7518405036379894, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -21.914463961293603, "episode_reward_min": -1319.8563078220143, "episode_reward_mean": -681.0709233380996, "episode_len_mean": 128.29, "episode_media": {}, "episodes_timesteps_total": 12829, "policy_reward_min": {"policy_0": -1319.8563078220143}, "policy_reward_max": {"policy_0": -21.914463961293603}, "policy_reward_mean": {"policy_0": -681.0709233380996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 44, 110, 69, 150, 150, 66, 150, 150, 56, 95, 150, 150, 74, 150, 150, 150, 150, 50, 150, 104, 150, 57, 150, 150, 150, 150, 150, 120, 56, 46, 150, 150, 47, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 65, 144, 61, 81, 150, 150, 150, 93, 137, 49, 150, 77, 64, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 89, 150, 150, 150, 150, 58, 72], "policy_policy_0_reward": [-1003.7651617513109, -984.4087835204671, -632.5150726482578, -864.4108758859704, -1167.9643846296667, -1105.807014447831, -929.40107260689, -60.5674594598697, -298.4526341869511, -131.08811890544013, -461.31670571193285, -898.7087980058709, -39.07968833042029, -830.656885637679, -895.4888055452105, -105.0393512483091, -227.75305978327117, -1218.966728500568, -1142.1443028201795, -141.2459570018659, -717.3095246949196, -1270.449039746041, -1117.8868978423754, -1163.7833100389348, -21.914463961293603, -831.5842490287359, -201.76301095877184, -923.077258735369, -107.09541363438186, -991.5048209324763, -1169.277914006404, -1318.0088834921285, -560.7087593645595, -557.1870092537176, -354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5737984892723967, "mean_inference_ms": 1.7793049855334544, "mean_action_processing_ms": 0.2884843412660516, "mean_env_wait_ms": 3.166226066378311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026103496551513672, "StateBufferConnector_ms": 0.021193981170654297, "ViewRequirementAgentConnector_ms": 0.26223254203796387}, "num_episodes": 33, "episode_return_max": -21.914463961293603, "episode_return_min": -1319.8563078220143, "episode_return_mean": -681.0709233380996, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.8151939422432, "num_env_steps_trained_throughput_per_sec": 322.8151939422432, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12469.277, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12469.2, "sample_time_ms": 1316.539, "learn_time_ms": 11083.553, "learn_throughput": 360.895, "synch_weights_time_ms": 68.287}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "3541f_00000", "date": "2024-08-03_02-51-31", "timestamp": 1722633691, "time_this_iter_s": 12.402977466583252, "time_total_s": 402.814733505249, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.814733505249, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.541176470588237, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.11430617570878, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.640661600853006, "policy_loss": -0.016170038679168403, "vf_loss": 4.658599947144588, "vf_explained_var": 0.9870201660320163, "kl": 0.01654121801766454, "entropy": 1.8423732366412877, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -15.737095488413166, "episode_reward_min": -1319.8563078220143, "episode_reward_mean": -663.0442913000747, "episode_len_mean": 128.65, "episode_media": {}, "episodes_timesteps_total": 12865, "policy_reward_min": {"policy_0": -1319.8563078220143}, "policy_reward_max": {"policy_0": -15.737095488413166}, "policy_reward_mean": {"policy_0": -663.0442913000747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516], "episode_lengths": [120, 56, 46, 150, 150, 47, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 65, 144, 61, 81, 150, 150, 150, 93, 137, 49, 150, 77, 64, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 89, 150, 150, 150, 150, 58, 72, 150, 150, 150, 47, 150, 150, 48, 150, 53, 106, 150, 123, 87, 150, 150, 84, 150, 150, 150, 150, 150, 34, 39, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-354.5813590408928, -92.30922378116547, -36.20476754102701, -711.6108636392877, -886.7557610249196, -47.119357478995646, -944.4950708755192, -1175.8402484327908, -829.4773079595448, -1106.0529061645136, -58.83292471373476, -1220.277485620952, -1257.7448729506477, -937.5473773905402, -580.4477869019491, -864.9170656848529, -682.5137292465314, -1017.0969604283096, -783.1290761745188, -1143.443093324438, -982.7954519435768, -838.1050217216866, -45.9603695531306, -396.2121947883306, -906.2573143277333, -830.0143620512042, -908.7760240040883, -61.924049114192904, -682.2761392668842, -57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5740210663481494, "mean_inference_ms": 1.8025906962304443, "mean_action_processing_ms": 0.28856457925798706, "mean_env_wait_ms": 3.173434249376235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025731325149536133, "StateBufferConnector_ms": 0.008185625076293945, "ViewRequirementAgentConnector_ms": 0.20574069023132324}, "num_episodes": 34, "episode_return_max": -15.737095488413166, "episode_return_min": -1319.8563078220143, "episode_return_mean": -663.0442913000747, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.97578021405434, "num_env_steps_trained_throughput_per_sec": 304.97578021405434, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12436.425, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12436.347, "sample_time_ms": 1299.814, "learn_time_ms": 11065.92, "learn_throughput": 361.47, "synch_weights_time_ms": 69.792}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "3541f_00000", "date": "2024-08-03_02-51-44", "timestamp": 1722633704, "time_this_iter_s": 13.126965045928955, "time_total_s": 415.941698551178, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0738d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.941698551178, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 16.842105263157897, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 240.60021672050158, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.251039799054464, "policy_loss": -0.019828106002144828, "vf_loss": 4.271843034774065, "vf_explained_var": 0.9857725075135628, "kl": 0.018138396753238376, "entropy": 1.827485457683603, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -1.5565879895423902, "episode_reward_min": -1319.8563078220143, "episode_reward_mean": -668.4474310556184, "episode_len_mean": 129.68, "episode_media": {}, "episodes_timesteps_total": 12968, "policy_reward_min": {"policy_0": -1319.8563078220143}, "policy_reward_max": {"policy_0": -1.5565879895423902}, "policy_reward_mean": {"policy_0": -668.4474310556184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643], "episode_lengths": [61, 81, 150, 150, 150, 93, 137, 49, 150, 77, 64, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 89, 150, 150, 150, 150, 58, 72, 150, 150, 150, 47, 150, 150, 48, 150, 53, 106, 150, 123, 87, 150, 150, 84, 150, 150, 150, 150, 150, 34, 39, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 38, 150, 65, 150, 77, 150], "policy_policy_0_reward": [-57.96093581011281, -119.56979505501717, -376.7279072209535, -940.0937537776263, -851.8671523880002, -415.1043346620407, -696.3643276794983, -75.86232973831973, -703.4680568092884, -130.1675651089314, -129.04366320971005, -423.6813724576551, -888.4796093719848, -608.8312644412039, -1098.935411710254, -594.3988510086213, -798.727563074357, -368.4345711963803, -1201.957668957332, -781.5441262765528, -936.9055324636963, -1113.4638405291344, -622.6692995802307, -564.9131655690378, -820.9232957228659, -836.6862826310992, -995.7590696131189, -657.8799893849425, -1230.1521188114848, -265.96491526723867, -184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5732528036620551, "mean_inference_ms": 1.8004534783125994, "mean_action_processing_ms": 0.28805432896456223, "mean_env_wait_ms": 3.1715477755676136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011932849884033203, "StateBufferConnector_ms": 0.008359432220458984, "ViewRequirementAgentConnector_ms": 0.1946549415588379}, "num_episodes": 29, "episode_return_max": -1.5565879895423902, "episode_return_min": -1319.8563078220143, "episode_return_mean": -668.4474310556184, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2890264173398, "num_env_steps_trained_throughput_per_sec": 307.2890264173398, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12612.419, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12612.345, "sample_time_ms": 1299.862, "learn_time_ms": 11241.121, "learn_throughput": 355.836, "synch_weights_time_ms": 70.529}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "3541f_00000", "date": "2024-08-03_02-51-57", "timestamp": 1722633717, "time_this_iter_s": 13.02981686592102, "time_total_s": 428.971515417099, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 428.971515417099, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.857894736842105, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 255.66647445162138, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.15415797183911, "policy_loss": -0.015565298134364032, "vf_loss": 4.172803509235382, "vf_explained_var": 0.987348277742664, "kl": 0.01726995677175492, "entropy": 2.170344610636433, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -1.5565879895423902, "episode_reward_min": -1319.8563078220143, "episode_reward_mean": -704.9297113216769, "episode_len_mean": 130.59, "episode_media": {}, "episodes_timesteps_total": 13059, "policy_reward_min": {"policy_0": -1319.8563078220143}, "policy_reward_max": {"policy_0": -1.5565879895423902}, "policy_reward_mean": {"policy_0": -704.9297113216769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023], "episode_lengths": [89, 150, 150, 150, 150, 58, 72, 150, 150, 150, 47, 150, 150, 48, 150, 53, 106, 150, 123, 87, 150, 150, 84, 150, 150, 150, 150, 150, 34, 39, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 38, 150, 65, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 42, 81, 150, 150, 59, 150, 150, 150, 97, 150, 150, 150, 150, 150, 81, 92, 150], "policy_policy_0_reward": [-184.2018647265591, -1319.8563078220143, -874.0413404704029, -1014.3330711769665, -756.933525615575, -47.72423431527384, -130.4146386924614, -924.2341708197271, -984.909628486162, -841.5406385943107, -21.67149747353354, -1092.9764782594132, -1239.1081123399813, -87.42375798995664, -1002.0422793038941, -30.986393318496543, -298.4328896268019, -856.3864438098341, -409.9350050174154, -216.41420590030032, -886.1517916772139, -850.0677233066659, -175.63533355924534, -911.2027844603168, -896.1455787463138, -1198.7835574364356, -1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5723345405095158, "mean_inference_ms": 1.7954662391678002, "mean_action_processing_ms": 0.2876970653458156, "mean_env_wait_ms": 3.1669895400972568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011789083480834961, "StateBufferConnector_ms": 0.00818634033203125, "ViewRequirementAgentConnector_ms": 0.1896376609802246}, "num_episodes": 30, "episode_return_max": -1.5565879895423902, "episode_return_min": -1319.8563078220143, "episode_return_mean": -704.9297113216769, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.05919209175335, "num_env_steps_trained_throughput_per_sec": 337.05919209175335, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12527.398, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12527.325, "sample_time_ms": 1293.889, "learn_time_ms": 11163.12, "learn_throughput": 358.323, "synch_weights_time_ms": 69.489}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "3541f_00000", "date": "2024-08-03_02-52-09", "timestamp": 1722633729, "time_this_iter_s": 11.879794836044312, "time_total_s": 440.8513102531433, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.8513102531433, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.68235294117647, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 303.79982834060985, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.161656742791335, "policy_loss": -0.006383738847216591, "vf_loss": 4.170723809301853, "vf_explained_var": 0.9864620197564363, "kl": 0.01687653553920735, "entropy": 2.0555507907023034, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -1.5565879895423902, "episode_reward_min": -1283.0134806743674, "episode_reward_mean": -750.2933423400166, "episode_len_mean": 136.39, "episode_media": {}, "episodes_timesteps_total": 13639, "policy_reward_min": {"policy_0": -1283.0134806743674}, "policy_reward_max": {"policy_0": -1.5565879895423902}, "policy_reward_mean": {"policy_0": -750.2933423400166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383], "episode_lengths": [150, 150, 34, 39, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 38, 150, 65, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 42, 81, 150, 150, 59, 150, 150, 150, 97, 150, 150, 150, 150, 150, 81, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 111, 150], "policy_policy_0_reward": [-1001.2091276926434, -464.8050163286447, -38.19247896062681, -15.737095488413166, -828.5233838274208, -520.2419496930157, -449.0844915213132, -959.556067124861, -727.0573993424922, -940.4104108433052, -353.9555888904566, -934.6748523613741, -383.80243980641546, -1184.2954053617248, -562.0742351468516, -1149.4325016823661, -1283.0134806743674, -489.92451402270484, -919.8338004720086, -298.06612494638205, -703.4854974235315, -595.6389374286413, -1178.4827672858964, -860.7033818565327, -1046.4765090704057, -753.7357681228546, -695.8461753455583, -149.06604746561854, -1029.6636509620614, -661.0661848529408, -980.3171353816965, -982.3505352385524, -144.44045593530083, -1253.793964051421, -455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5720414394183176, "mean_inference_ms": 1.7916325622473719, "mean_action_processing_ms": 0.28704626347381895, "mean_env_wait_ms": 3.1654721758588464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0118560791015625, "StateBufferConnector_ms": 0.008123159408569336, "ViewRequirementAgentConnector_ms": 0.1938459873199463}, "num_episodes": 26, "episode_return_max": -1.5565879895423902, "episode_return_min": -1283.0134806743674, "episode_return_mean": -750.2933423400166, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.29596637737006, "num_env_steps_trained_throughput_per_sec": 304.29596637737006, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12505.892, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12505.816, "sample_time_ms": 1291.381, "learn_time_ms": 11143.173, "learn_throughput": 358.964, "synch_weights_time_ms": 70.43}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "3541f_00000", "date": "2024-08-03_02-52-22", "timestamp": 1722633742, "time_this_iter_s": 13.157416343688965, "time_total_s": 454.0087265968323, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 454.0087265968323, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.172222222222224, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 247.9673580745856, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.177542604506016, "policy_loss": -0.014821112010395154, "vf_loss": 4.1939891025424005, "vf_explained_var": 0.9862909357994795, "kl": 0.016732134935925083, "entropy": 1.830968217427532, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -1.5565879895423902, "episode_reward_min": -1438.4670867396596, "episode_reward_mean": -735.6387051848922, "episode_len_mean": 134.36, "episode_media": {}, "episodes_timesteps_total": 13436, "policy_reward_min": {"policy_0": -1438.4670867396596}, "policy_reward_max": {"policy_0": -1.5565879895423902}, "policy_reward_mean": {"policy_0": -735.6387051848922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768], "episode_lengths": [150, 150, 150, 150, 38, 150, 65, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 42, 81, 150, 150, 59, 150, 150, 150, 97, 150, 150, 150, 150, 150, 81, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 111, 150, 150, 150, 150, 150, 131, 87, 150, 150, 101, 150, 47, 150, 150, 98, 150, 150, 150, 150, 150, 41, 78, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 62], "policy_policy_0_reward": [-455.9440696430047, -567.3221653432662, -848.8545007864718, -718.1637670377096, -1.5565879895423902, -1062.925774589268, -56.49560370401387, -644.2378497550842, -210.531981352951, -1181.6624082801643, -965.9490014341794, -1015.0221281880126, -860.5362906566876, -736.4051832333706, -1065.2922739535522, -1122.2782160407978, -798.8454161824552, -805.8016746747188, -688.5690880649448, -1121.149001882255, -1106.4579892479012, -761.1554369918332, -172.40171784875713, -5.46023246755847, -202.04309880359887, -1129.3315122134093, -1160.6204791600235, -49.600988613441366, -1084.0099109369485, -958.3179680327967, -1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5709478560538137, "mean_inference_ms": 1.7883444715182784, "mean_action_processing_ms": 0.2872519970795646, "mean_env_wait_ms": 3.1615669724888846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011673688888549805, "StateBufferConnector_ms": 0.007850885391235352, "ViewRequirementAgentConnector_ms": 0.19633221626281738}, "num_episodes": 34, "episode_return_max": -1.5565879895423902, "episode_return_min": -1438.4670867396596, "episode_return_mean": -735.6387051848922, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.36966853685766, "num_env_steps_trained_throughput_per_sec": 302.36966853685766, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12498.329, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12498.253, "sample_time_ms": 1291.185, "learn_time_ms": 11137.607, "learn_throughput": 359.144, "synch_weights_time_ms": 68.628}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "3541f_00000", "date": "2024-08-03_02-52-35", "timestamp": 1722633755, "time_this_iter_s": 13.24094843864441, "time_total_s": 467.2496750354767, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0738b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 467.2496750354767, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.105263157894736, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 253.15538640618325, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.907998325675726, "policy_loss": -0.012770990613595738, "vf_loss": 4.920558731754621, "vf_explained_var": 0.973415732756257, "kl": 0.018426900568086584, "entropy": 1.6163022068639596, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -12.51466857084234, "episode_reward_min": -1438.4670867396596, "episode_reward_mean": -713.4609830556054, "episode_len_mean": 132.79, "episode_media": {}, "episodes_timesteps_total": 13279, "policy_reward_min": {"policy_0": -1438.4670867396596}, "policy_reward_max": {"policy_0": -12.51466857084234}, "policy_reward_mean": {"policy_0": -713.4609830556054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713], "episode_lengths": [150, 97, 150, 150, 150, 150, 150, 81, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 111, 150, 150, 150, 150, 150, 131, 87, 150, 150, 101, 150, 47, 150, 150, 98, 150, 150, 150, 150, 150, 41, 78, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 62, 150, 150, 86, 150, 150, 150, 89, 55, 150, 103, 150, 150, 150, 150, 150, 84, 84, 46, 68, 150, 150, 150, 150, 150, 150, 150, 54, 98, 150, 150], "policy_policy_0_reward": [-1282.075375338852, -394.75405922880276, -1044.9096974251852, -906.959943734117, -800.4190255580539, -670.7521652750813, -832.7304078119565, -213.98792519703812, -302.2489070410135, -696.6806808952023, -840.9352952993208, -868.9666978067572, -1205.4383029840353, -1030.1487114705774, -671.1594640283106, -659.6912660478755, -1003.6505874804772, -869.3738290139418, -1247.900807894245, -761.0342881346302, -598.6636988623638, -1010.5539939543964, -496.844694672538, -208.33057856510956, -689.6082712449609, -865.0949114533147, -1064.0065848276417, -1263.2128009340393, -1219.6703433237853, -1012.8012049050615, -513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5700586236918852, "mean_inference_ms": 1.7844171522923193, "mean_action_processing_ms": 0.2868170191517861, "mean_env_wait_ms": 3.1611666295023473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011380434036254883, "StateBufferConnector_ms": 0.00786733627319336, "ViewRequirementAgentConnector_ms": 0.19925832748413086}, "num_episodes": 30, "episode_return_max": -12.51466857084234, "episode_return_min": -1438.4670867396596, "episode_return_mean": -713.4609830556054, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65115574930724, "num_env_steps_trained_throughput_per_sec": 300.65115574930724, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12683.021, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12682.945, "sample_time_ms": 1288.521, "learn_time_ms": 11327.127, "learn_throughput": 353.135, "synch_weights_time_ms": 66.467}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "3541f_00000", "date": "2024-08-03_02-52-49", "timestamp": 1722633769, "time_this_iter_s": 13.31757926940918, "time_total_s": 480.56725430488586, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.56725430488586, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 16.894736842105264, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.1254033446312, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.292254957308372, "policy_loss": -0.009989755696733483, "vf_loss": 4.304094765086969, "vf_explained_var": 0.9880779925733805, "kl": 0.020205971566307858, "entropy": 2.1885482631623745, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -12.51466857084234, "episode_reward_min": -1438.4670867396596, "episode_reward_mean": -710.1962623423487, "episode_len_mean": 131.27, "episode_media": {}, "episodes_timesteps_total": 13127, "policy_reward_min": {"policy_0": -1438.4670867396596}, "policy_reward_max": {"policy_0": -12.51466857084234}, "policy_reward_mean": {"policy_0": -710.1962623423487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295], "episode_lengths": [113, 150, 150, 150, 111, 150, 150, 150, 150, 150, 131, 87, 150, 150, 101, 150, 47, 150, 150, 98, 150, 150, 150, 150, 150, 41, 78, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 62, 150, 150, 86, 150, 150, 150, 89, 55, 150, 103, 150, 150, 150, 150, 150, 84, 84, 46, 68, 150, 150, 150, 150, 150, 150, 150, 54, 98, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 41, 150], "policy_policy_0_reward": [-513.9036903143774, -549.4502201061825, -947.0702790107295, -1051.3640968302223, -269.41173948549374, -869.6299961288383, -778.0691421001154, -725.7629327319232, -473.82612105999243, -579.2974155964865, -243.97354147215006, -110.02615523647424, -909.9720266470798, -1181.1604125267495, -424.323333768921, -1027.310726955639, -77.66409019215477, -563.4191260682759, -374.86635802787555, -212.86359802787803, -1326.1713262216033, -423.43273824673537, -620.6021891121832, -545.0648546373602, -1154.5428297075714, -33.023339407705535, -108.7450623799135, -412.9337333075729, -874.1189110030385, -745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5700068647188085, "mean_inference_ms": 1.7820463720840465, "mean_action_processing_ms": 0.2865471737952752, "mean_env_wait_ms": 3.1614671651539563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011512517929077148, "StateBufferConnector_ms": 0.007843255996704102, "ViewRequirementAgentConnector_ms": 0.19353127479553223}, "num_episodes": 30, "episode_return_max": -12.51466857084234, "episode_return_min": -1438.4670867396596, "episode_return_mean": -710.1962623423487, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.6207619687824, "num_env_steps_trained_throughput_per_sec": 314.6207619687824, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12773.45, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12773.375, "sample_time_ms": 1278.026, "learn_time_ms": 11431.355, "learn_throughput": 349.915, "synch_weights_time_ms": 63.227}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "3541f_00000", "date": "2024-08-03_02-53-01", "timestamp": 1722633781, "time_this_iter_s": 12.725808143615723, "time_total_s": 493.2930624485016, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0739d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.2930624485016, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.599999999999998, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.86722293893496, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.244774844994148, "policy_loss": -0.009098396947956644, "vf_loss": 4.258428154389064, "vf_explained_var": 0.9776641379420956, "kl": 0.009315042249045336, "entropy": 2.168511724844575, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -12.51466857084234, "episode_reward_min": -1487.0763483603143, "episode_reward_mean": -746.4046417226259, "episode_len_mean": 131.47, "episode_media": {}, "episodes_timesteps_total": 13147, "policy_reward_min": {"policy_0": -1487.0763483603143}, "policy_reward_max": {"policy_0": -12.51466857084234}, "policy_reward_mean": {"policy_0": -746.4046417226259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773], "episode_lengths": [150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 62, 150, 150, 86, 150, 150, 150, 89, 55, 150, 103, 150, 150, 150, 150, 150, 84, 84, 46, 68, 150, 150, 150, 150, 150, 150, 150, 54, 98, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 41, 150, 150, 90, 134, 150, 150, 150, 57, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 59, 150, 65, 150, 72, 150, 88], "policy_policy_0_reward": [-745.6900907480718, -1155.7878140844832, -1438.4670867396596, -756.922040221809, -1198.0713473238989, -12.51466857084234, -1191.2056813981244, -1154.8132900679761, -1020.1461800314906, -1129.8791617738382, -88.82633370038768, -761.9602272903898, -1354.9234080314232, -304.5246343542188, -928.8268420852617, -371.82734357135945, -950.6843607962525, -271.92817536128985, -41.68576821381172, -792.0586073748343, -196.38994065145062, -541.3599006483349, -839.7477657334847, -1106.7459849427119, -460.6838958050745, -1104.6799998986182, -254.93924597230605, -231.0820862969542, -82.75687311964379, -117.28725625124297, -1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5696589096217184, "mean_inference_ms": 1.7793211170381218, "mean_action_processing_ms": 0.2861813128565727, "mean_env_wait_ms": 3.160031448284771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011602401733398438, "StateBufferConnector_ms": 0.0077877044677734375, "ViewRequirementAgentConnector_ms": 0.19315481185913086}, "num_episodes": 29, "episode_return_max": -12.51466857084234, "episode_return_min": -1487.0763483603143, "episode_return_mean": -746.4046417226259, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.68655742813445, "num_env_steps_trained_throughput_per_sec": 312.68655742813445, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12670.819, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12670.746, "sample_time_ms": 1127.521, "learn_time_ms": 11478.587, "learn_throughput": 348.475, "synch_weights_time_ms": 63.86}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "3541f_00000", "date": "2024-08-03_02-53-14", "timestamp": 1722633794, "time_this_iter_s": 12.803978443145752, "time_total_s": 506.09704089164734, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0713760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.09704089164734, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.36315789473684, "ram_util_percent": 27.205263157894734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.9122162202994, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.539055778086185, "policy_loss": -0.01458505854922502, "vf_loss": 4.553171827395757, "vf_explained_var": 0.9816334109753371, "kl": 0.014617371601586153, "entropy": 1.8795474470903477, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -13.819830380654743, "episode_reward_min": -1487.0763483603143, "episode_reward_mean": -764.3391279405216, "episode_len_mean": 135.85, "episode_media": {}, "episodes_timesteps_total": 13585, "policy_reward_min": {"policy_0": -1487.0763483603143}, "policy_reward_max": {"policy_0": -13.819830380654743}, "policy_reward_mean": {"policy_0": -764.3391279405216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 54, 98, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 41, 150, 150, 90, 134, 150, 150, 150, 57, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 59, 150, 65, 150, 72, 150, 88, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 106, 88, 150, 150, 150, 150, 150, 150, 76, 150, 111], "policy_policy_0_reward": [-1310.5219376127218, -671.7744237356509, -1172.5850946951577, -475.0934048758355, -1083.539908246298, -973.5152793835979, -686.8004711465215, -72.96082580201931, -376.85624858587596, -893.2791575169907, -908.151036180713, -1265.7185944306882, -165.79116641941178, -636.5562640405509, -736.154316364076, -984.2300048135262, -1187.8448796327898, -1311.968049477872, -1109.0397273313524, -1080.6855675801594, -780.6528965041995, -814.5928944252109, -457.3508344587723, -610.4464149389105, -538.0488771273624, -950.7879667604292, -1220.5727768145966, -56.229996119472624, -927.1893557439323, -634.4946507439046, -1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5687786926503451, "mean_inference_ms": 1.774984056832132, "mean_action_processing_ms": 0.28544429114942343, "mean_env_wait_ms": 3.1584336735571044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011620283126831055, "StateBufferConnector_ms": 0.007816314697265625, "ViewRequirementAgentConnector_ms": 0.19023633003234863}, "num_episodes": 30, "episode_return_max": -13.819830380654743, "episode_return_min": -1487.0763483603143, "episode_return_mean": -764.3391279405216, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7843922088081, "num_env_steps_trained_throughput_per_sec": 305.7843922088081, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12865.692, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12865.616, "sample_time_ms": 1087.918, "learn_time_ms": 11710.93, "learn_throughput": 341.561, "synch_weights_time_ms": 65.985}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "3541f_00000", "date": "2024-08-03_02-53-27", "timestamp": 1722633807, "time_this_iter_s": 13.09440016746521, "time_total_s": 519.1914410591125, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0712710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.1914410591125, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.133333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 277.6605281710625, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.639935261259477, "policy_loss": -0.015531363197078462, "vf_loss": 4.658284144848585, "vf_explained_var": 0.9811381239444017, "kl": 0.012703248579540222, "entropy": 2.278447061901291, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -12.125307499744743, "episode_reward_min": -1487.0763483603143, "episode_reward_mean": -724.0593814268422, "episode_len_mean": 132.32, "episode_media": {}, "episodes_timesteps_total": 13232, "policy_reward_min": {"policy_0": -1487.0763483603143}, "policy_reward_max": {"policy_0": -12.125307499744743}, "policy_reward_mean": {"policy_0": -724.0593814268422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015], "episode_lengths": [150, 150, 150, 150, 150, 150, 66, 150, 150, 41, 150, 150, 90, 134, 150, 150, 150, 57, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 59, 150, 65, 150, 72, 150, 88, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 106, 88, 150, 150, 150, 150, 150, 150, 76, 150, 111, 150, 150, 66, 86, 150, 150, 150, 150, 54, 150, 145, 150, 150, 150, 150, 93, 150, 86, 150, 47, 124, 40, 150, 103, 150, 150, 150, 150, 102, 137], "policy_policy_0_reward": [-1358.0048415947215, -1013.2787697995001, -553.5738179505171, -849.7993278432425, -1126.5905201961875, -1064.065623342168, -53.09796686207836, -303.7056527471418, -1377.0541691432388, -13.819830380654743, -1224.7866954963295, -659.6815224513176, -303.06744765094095, -432.5386458497029, -1080.1994905483746, -696.6393908707428, -1307.3362055497694, -35.48542874502252, -763.903287743002, -396.9176396038397, -858.9153815351069, -1487.0763483603143, -866.0046683776354, -558.0203143860706, -1081.873892124171, -1089.484167433845, -841.2131166008505, -1472.5243311372674, -790.9162676008399, -495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.568824406228977, "mean_inference_ms": 1.7736808912636786, "mean_action_processing_ms": 0.2853308115974624, "mean_env_wait_ms": 3.1550869924556104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01177978515625, "StateBufferConnector_ms": 0.007917165756225586, "ViewRequirementAgentConnector_ms": 0.19066858291625977}, "num_episodes": 30, "episode_return_max": -12.125307499744743, "episode_return_min": -1487.0763483603143, "episode_return_mean": -724.0593814268422, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.85094016416383, "num_env_steps_trained_throughput_per_sec": 295.85094016416383, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12978.625, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12978.549, "sample_time_ms": 1084.627, "learn_time_ms": 11828.077, "learn_throughput": 338.178, "synch_weights_time_ms": 65.055}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "3541f_00000", "date": "2024-08-03_02-53-41", "timestamp": 1722633821, "time_this_iter_s": 13.534322738647461, "time_total_s": 532.72576379776, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 532.72576379776, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 16.775, "ram_util_percent": 27.259999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 263.70285609165825, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.225643263508876, "policy_loss": -0.008367174861875052, "vf_loss": 4.236614391207695, "vf_explained_var": 0.9803193003560106, "kl": 0.01330896653119756, "entropy": 2.317502504090468, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -8.679446993668275, "episode_reward_min": -1555.440257661799, "episode_reward_mean": -725.6979714922338, "episode_len_mean": 131.82, "episode_media": {}, "episodes_timesteps_total": 13182, "policy_reward_min": {"policy_0": -1555.440257661799}, "policy_reward_max": {"policy_0": -8.679446993668275}, "policy_reward_mean": {"policy_0": -725.6979714922338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248], "episode_lengths": [150, 150, 150, 150, 59, 150, 65, 150, 72, 150, 88, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 106, 88, 150, 150, 150, 150, 150, 150, 76, 150, 111, 150, 150, 66, 86, 150, 150, 150, 150, 54, 150, 145, 150, 150, 150, 150, 93, 150, 86, 150, 47, 124, 40, 150, 103, 150, 150, 150, 150, 102, 137, 150, 150, 70, 150, 150, 44, 150, 150, 150, 108, 98, 150, 150, 105, 150, 150, 150, 150, 150, 144, 150, 150, 150, 120, 150, 150, 98, 113, 150], "policy_policy_0_reward": [-495.13380187046846, -959.0013761644867, -1324.0482026056732, -846.9227319188667, -90.65629933797655, -787.3450209619757, -140.04572651340968, -552.4104896129969, -83.76246389277432, -702.5334228733363, -299.1808420181773, -379.46887234011234, -1117.3239686719535, -853.0720517022816, -1411.4601023062623, -1119.3005219952934, -419.12792264286804, -722.3328133741146, -626.8273184620888, -870.5049374036173, -457.0930548830675, -802.6392375586498, -174.3632765998195, -755.5962002652642, -379.2254860665953, -646.1668308400549, -1091.4769568752413, -1121.5454879366273, -658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5684358969485821, "mean_inference_ms": 1.7707474787016813, "mean_action_processing_ms": 0.2851660518464434, "mean_env_wait_ms": 3.1546014701988194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013631820678710938, "StateBufferConnector_ms": 0.007919549942016602, "ViewRequirementAgentConnector_ms": 0.19115614891052246}, "num_episodes": 29, "episode_return_max": -8.679446993668275, "episode_return_min": -1555.440257661799, "episode_return_mean": -725.6979714922338, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8970380014599, "num_env_steps_trained_throughput_per_sec": 307.8970380014599, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12966.181, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12966.105, "sample_time_ms": 1085.187, "learn_time_ms": 11817.165, "learn_throughput": 338.491, "synch_weights_time_ms": 62.968}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "3541f_00000", "date": "2024-08-03_02-53-54", "timestamp": 1722633834, "time_this_iter_s": 13.00300145149231, "time_total_s": 545.7287652492523, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 545.7287652492523, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.133333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 331.5122722625732, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.159533250580231, "policy_loss": -0.00933344056926823, "vf_loss": 4.170827853182952, "vf_explained_var": 0.9886070039123297, "kl": 0.014613374965119958, "entropy": 2.365039057160417, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -8.679446993668275, "episode_reward_min": -1555.440257661799, "episode_reward_mean": -769.7598068923868, "episode_len_mean": 134.3, "episode_media": {}, "episodes_timesteps_total": 13430, "policy_reward_min": {"policy_0": -1555.440257661799}, "policy_reward_max": {"policy_0": -8.679446993668275}, "policy_reward_mean": {"policy_0": -769.7598068923868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377], "episode_lengths": [150, 150, 106, 88, 150, 150, 150, 150, 150, 150, 76, 150, 111, 150, 150, 66, 86, 150, 150, 150, 150, 54, 150, 145, 150, 150, 150, 150, 93, 150, 86, 150, 47, 124, 40, 150, 103, 150, 150, 150, 150, 102, 137, 150, 150, 70, 150, 150, 44, 150, 150, 150, 108, 98, 150, 150, 105, 150, 150, 150, 150, 150, 144, 150, 150, 150, 120, 150, 150, 98, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 86, 150, 150], "policy_policy_0_reward": [-658.399492331731, -1251.4428513608593, -274.1685256341852, -223.12462329494392, -1135.5837662831173, -724.0026120238484, -1237.935310940297, -1109.9589874977253, -780.9913645919959, -871.075619841284, -82.65891172767837, -862.2517797079843, -240.7457476892769, -1047.7064086237367, -1159.43732701873, -84.91950940158289, -244.5636915851878, -1252.7728222718868, -1129.7287488370982, -807.3013504494073, -1347.7671334253841, -117.11184737379939, -484.8479085668802, -678.4232670802592, -669.5789433466639, -994.6000597565502, -364.9450547218865, -1426.9629526218785, -126.90891838925982, -757.7556291543119, -250.16024496990897, -1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682341542508926, "mean_inference_ms": 1.7697763434224254, "mean_action_processing_ms": 0.2850225359979507, "mean_env_wait_ms": 3.1541809064134294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013800859451293945, "StateBufferConnector_ms": 0.007981538772583008, "ViewRequirementAgentConnector_ms": 0.19318246841430664}, "num_episodes": 28, "episode_return_max": -8.679446993668275, "episode_return_min": -1555.440257661799, "episode_return_mean": -769.7598068923868, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6316690657214, "num_env_steps_trained_throughput_per_sec": 304.6316690657214, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12977.536, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12977.461, "sample_time_ms": 1083.875, "learn_time_ms": 11828.871, "learn_throughput": 338.156, "synch_weights_time_ms": 63.941}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "3541f_00000", "date": "2024-08-03_02-54-07", "timestamp": 1722633847, "time_this_iter_s": 13.143322229385376, "time_total_s": 558.8720874786377, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 558.8720874786377, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.057894736842105, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.63694443702695, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.65569148461024, "policy_loss": -0.0021016262047245013, "vf_loss": 4.655316542088985, "vf_explained_var": 0.9690725093707442, "kl": 0.016427430243493347, "entropy": 1.7223887130618096, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -8.679446993668275, "episode_reward_min": -1555.440257661799, "episode_reward_mean": -736.7318599190289, "episode_len_mean": 133.98, "episode_media": {}, "episodes_timesteps_total": 13398, "policy_reward_min": {"policy_0": -1555.440257661799}, "policy_reward_max": {"policy_0": -8.679446993668275}, "policy_reward_mean": {"policy_0": -736.7318599190289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867], "episode_lengths": [150, 47, 124, 40, 150, 103, 150, 150, 150, 150, 102, 137, 150, 150, 70, 150, 150, 44, 150, 150, 150, 108, 98, 150, 150, 105, 150, 150, 150, 150, 150, 144, 150, 150, 150, 120, 150, 150, 98, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 86, 150, 150, 150, 150, 53, 112, 101, 150, 150, 150, 71, 150, 150, 150, 150, 120, 150, 76, 150, 150, 150, 128, 150, 55, 150, 150, 150, 54, 150, 150, 150, 150, 109], "policy_policy_0_reward": [-1410.8082094949496, -12.125307499744743, -490.644028264332, -26.89737306640851, -725.4672619548398, -380.39428837135563, -1191.5103097011363, -1084.061767923345, -489.3892915423621, -570.1590384210527, -318.3836566077016, -420.12601969899015, -1091.591050367876, -697.5349510174159, -131.37191798559886, -1163.2602432111191, -591.6213425543795, -8.679446993668275, -1030.3171510092855, -1449.1469520769642, -1555.440257661799, -432.55205449855197, -178.4428829880584, -1059.915722188878, -965.7816474108179, -412.01299809936427, -1012.3238279680443, -627.1944545456488, -1199.89497343349, -1177.2717686729295, -736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5675596859937186, "mean_inference_ms": 1.7668535856729575, "mean_action_processing_ms": 0.284586356624196, "mean_env_wait_ms": 3.1535638674241495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013727426528930664, "StateBufferConnector_ms": 0.008032560348510742, "ViewRequirementAgentConnector_ms": 0.19301080703735352}, "num_episodes": 31, "episode_return_max": -8.679446993668275, "episode_return_min": -1555.440257661799, "episode_return_mean": -736.7318599190289, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.552947962427, "num_env_steps_trained_throughput_per_sec": 300.552947962427, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 13121.683, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13121.606, "sample_time_ms": 1087.502, "learn_time_ms": 11968.1, "learn_throughput": 334.222, "synch_weights_time_ms": 65.223}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "3541f_00000", "date": "2024-08-03_02-54-21", "timestamp": 1722633861, "time_this_iter_s": 13.321249723434448, "time_total_s": 572.1933372020721, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.1933372020721, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 16.952631578947365, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 350.3625272512436, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.115960312883059, "policy_loss": -0.004222175648222522, "vf_loss": 4.121358654399713, "vf_explained_var": 0.9845783974975347, "kl": 0.015502664402902155, "entropy": 2.3280935919533174, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -59.789716356254495, "episode_reward_min": -1512.8749415225102, "episode_reward_mean": -740.3225783638553, "episode_len_mean": 135.38, "episode_media": {}, "episodes_timesteps_total": 13538, "policy_reward_min": {"policy_0": -1512.8749415225102}, "policy_reward_max": {"policy_0": -59.789716356254495}, "policy_reward_mean": {"policy_0": -740.3225783638553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578], "episode_lengths": [150, 144, 150, 150, 150, 120, 150, 150, 98, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 86, 150, 150, 150, 150, 53, 112, 101, 150, 150, 150, 71, 150, 150, 150, 150, 120, 150, 76, 150, 150, 150, 128, 150, 55, 150, 150, 150, 54, 150, 150, 150, 150, 109, 71, 136, 150, 150, 150, 109, 150, 150, 150, 150, 105, 116, 150, 150, 89, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 95], "policy_policy_0_reward": [-736.0933231307334, -521.717677058966, -590.8540364273506, -875.7985169745765, -1512.8749415225102, -276.31515665783616, -1075.2755708137647, -1323.256037751517, -368.263358017963, -487.12083696423133, -1271.5106704604248, -895.9943345449908, -1345.3336684492147, -705.1406908716375, -1163.82488002202, -609.338350528698, -1270.0989571136276, -1013.0143403952685, -828.0397256925052, -978.5175068796913, -1000.8652734720446, -638.5493555590106, -1363.5995450593796, -79.12600101027486, -977.0142455129057, -572.5234969501066, -680.5384288429235, -868.9952083761463, -1318.1505773743681, -972.746032694984, -1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5672897868380838, "mean_inference_ms": 1.7648478622270067, "mean_action_processing_ms": 0.2844333719458174, "mean_env_wait_ms": 3.1525066803242385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011581659317016602, "StateBufferConnector_ms": 0.008085966110229492, "ViewRequirementAgentConnector_ms": 0.1945960521697998}, "num_episodes": 30, "episode_return_max": -59.789716356254495, "episode_return_min": -1512.8749415225102, "episode_return_mean": -740.3225783638553, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.53456200593786, "num_env_steps_trained_throughput_per_sec": 300.53456200593786, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 13138.135, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13138.058, "sample_time_ms": 1087.997, "learn_time_ms": 11983.977, "learn_throughput": 333.779, "synch_weights_time_ms": 65.307}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "3541f_00000", "date": "2024-08-03_02-54-34", "timestamp": 1722633874, "time_this_iter_s": 13.32423734664917, "time_total_s": 585.5175745487213, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 585.5175745487213, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.036842105263155, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 312.97921527226765, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.9062304114302, "policy_loss": -0.012667032368578171, "vf_loss": 3.9227728518346945, "vf_explained_var": 0.9900584248825908, "kl": 0.01089650959405238, "entropy": 2.246113021299243, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -59.789716356254495, "episode_reward_min": -1457.0044903852101, "episode_reward_mean": -719.6190632540763, "episode_len_mean": 135.11, "episode_media": {}, "episodes_timesteps_total": 13511, "policy_reward_min": {"policy_0": -1457.0044903852101}, "policy_reward_max": {"policy_0": -59.789716356254495}, "policy_reward_mean": {"policy_0": -719.6190632540763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749], "episode_lengths": [150, 150, 150, 150, 150, 119, 86, 150, 150, 150, 150, 53, 112, 101, 150, 150, 150, 71, 150, 150, 150, 150, 120, 150, 76, 150, 150, 150, 128, 150, 55, 150, 150, 150, 54, 150, 150, 150, 150, 109, 71, 136, 150, 150, 150, 109, 150, 150, 150, 150, 105, 116, 150, 150, 89, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 95, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 50, 97, 76, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1142.4501980781383, -961.68440303925, -1141.2253692340394, -613.887394197793, -626.7353666283252, -195.35438090183973, -199.68836393888998, -486.0711386582357, -986.2417236830377, -633.2487692581004, -1170.064093829705, -73.99836571894525, -269.2147146617466, -379.1305975857861, -705.9505894587134, -691.6749652061052, -612.5899858139348, -153.46025711006695, -850.475136783451, -1250.80817033932, -645.2559127614177, -330.0286883406089, -507.9552732526712, -714.9458220971395, -148.44792407154105, -915.6370375681017, -366.15376051032024, -833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5669600880997235, "mean_inference_ms": 1.7631189266644431, "mean_action_processing_ms": 0.2842376323205742, "mean_env_wait_ms": 3.15126966609546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011494874954223633, "StateBufferConnector_ms": 0.008116483688354492, "ViewRequirementAgentConnector_ms": 0.19381499290466309}, "num_episodes": 30, "episode_return_max": -59.789716356254495, "episode_return_min": -1457.0044903852101, "episode_return_mean": -719.6190632540763, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.40755387038286, "num_env_steps_trained_throughput_per_sec": 349.40755387038286, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12960.046, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12959.969, "sample_time_ms": 1088.111, "learn_time_ms": 11805.442, "learn_throughput": 338.827, "synch_weights_time_ms": 65.64}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "3541f_00000", "date": "2024-08-03_02-54-45", "timestamp": 1722633885, "time_this_iter_s": 11.46004033088684, "time_total_s": 596.9776148796082, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07116c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 596.9776148796082, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.125, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 244.43115702470143, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.264817203084628, "policy_loss": -0.012536765199426252, "vf_loss": 4.277644892036915, "vf_explained_var": 0.9865198594207565, "kl": 0.014457148796464073, "entropy": 2.009897679835558, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -16.2185544528093, "episode_reward_min": -1490.2882498783563, "episode_reward_mean": -764.3740940696563, "episode_len_mean": 136.97, "episode_media": {}, "episodes_timesteps_total": 13697, "policy_reward_min": {"policy_0": -1490.2882498783563}, "policy_reward_max": {"policy_0": -16.2185544528093}, "policy_reward_mean": {"policy_0": -764.3740940696563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393], "episode_lengths": [150, 128, 150, 55, 150, 150, 150, 54, 150, 150, 150, 150, 109, 71, 136, 150, 150, 150, 109, 150, 150, 150, 150, 105, 116, 150, 150, 89, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 95, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 50, 97, 76, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 122, 53, 150, 77, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-833.9454854632509, -412.15713777751375, -1010.9976778243022, -86.81535331607236, -719.7964869707477, -549.9644854161545, -1290.984795634458, -63.556891315812464, -1225.806196397863, -738.0322455285968, -547.185073943951, -803.9415254172405, -392.81329380993867, -90.70389615653144, -519.7728396104102, -1382.579401038661, -977.2151268951822, -889.4264049727624, -440.8186012557872, -1011.7759469041068, -952.9708110992412, -1015.5104084754594, -1190.513742261731, -374.0614889832357, -481.0998716152883, -490.97159889613823, -925.6208438131446, -263.09618987808267, -699.4006709235247, -754.8773538264347, -880.4561345753726, -59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566367852521029, "mean_inference_ms": 1.7601208538404414, "mean_action_processing_ms": 0.2841664304728882, "mean_env_wait_ms": 3.1504820456992086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01158595085144043, "StateBufferConnector_ms": 0.008109569549560547, "ViewRequirementAgentConnector_ms": 0.19354748725891113}, "num_episodes": 27, "episode_return_max": -16.2185544528093, "episode_return_min": -1490.2882498783563, "episode_return_mean": -764.3740940696563, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.6097864112559, "num_env_steps_trained_throughput_per_sec": 305.6097864112559, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12938.459, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12938.384, "sample_time_ms": 1088.601, "learn_time_ms": 11783.133, "learn_throughput": 339.468, "synch_weights_time_ms": 65.883}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "3541f_00000", "date": "2024-08-03_02-54-59", "timestamp": 1722633899, "time_this_iter_s": 13.100373029708862, "time_total_s": 610.077987909317, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.077987909317, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 16.894736842105264, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 308.35079167286557, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.447246662527323, "policy_loss": -0.015100101934513077, "vf_loss": 4.461684299757083, "vf_explained_var": 0.974342798255384, "kl": 0.013321298137937814, "entropy": 1.66588130419453, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -16.2185544528093, "episode_reward_min": -1490.2882498783563, "episode_reward_mean": -750.6149163969594, "episode_len_mean": 137.67, "episode_media": {}, "episodes_timesteps_total": 13767, "policy_reward_min": {"policy_0": -1490.2882498783563}, "policy_reward_max": {"policy_0": -16.2185544528093}, "policy_reward_mean": {"policy_0": -750.6149163969594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836], "episode_lengths": [51, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 95, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 50, 97, 76, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 122, 53, 150, 77, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 134, 58, 150, 150, 150, 150, 150, 78, 150, 52, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 119, 150], "policy_policy_0_reward": [-59.789716356254495, -941.0316953314258, -1057.6730694837308, -638.5494423329787, -590.6429423646924, -739.5662328098215, -1273.0186399881663, -1191.450543406425, -857.3467383672262, -84.69089820874923, -1272.3841150231995, -216.37667485897578, -1182.3932600009753, -559.7820752286008, -797.7790329336739, -523.8746860968464, -579.0983190297799, -615.0044749140438, -901.5594401447839, -420.2550374148644, -1400.5118283935792, -1149.061157369533, -112.9696818521, -338.83998421471216, -248.70346633703278, -1292.012229058687, -728.0771676133551, -496.4079648734923, -638.4876686057692, -757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5659303797567002, "mean_inference_ms": 1.7584738790915313, "mean_action_processing_ms": 0.2839136811118336, "mean_env_wait_ms": 3.1491963476752836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011676311492919922, "StateBufferConnector_ms": 0.008034229278564453, "ViewRequirementAgentConnector_ms": 0.19423890113830566}, "num_episodes": 31, "episode_return_max": -16.2185544528093, "episode_return_min": -1490.2882498783563, "episode_return_mean": -750.6149163969594, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.44840018262323, "num_env_steps_trained_throughput_per_sec": 369.44840018262323, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12749.782, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12749.708, "sample_time_ms": 1076.98, "learn_time_ms": 11606.542, "learn_throughput": 344.633, "synch_weights_time_ms": 65.418}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "3541f_00000", "date": "2024-08-03_02-55-10", "timestamp": 1722633910, "time_this_iter_s": 10.838895082473755, "time_total_s": 620.9168829917908, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 620.9168829917908, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.666666666666668, "ram_util_percent": 27.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 297.1544453660647, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.682848097880681, "policy_loss": -0.0148779353214195, "vf_loss": 4.697947061806917, "vf_explained_var": 0.9771004560713966, "kl": 0.014675641322113128, "entropy": 2.0254202502469223, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -16.2185544528093, "episode_reward_min": -1490.2882498783563, "episode_reward_mean": -750.1413043570042, "episode_len_mean": 140.77, "episode_media": {}, "episodes_timesteps_total": 14077, "policy_reward_min": {"policy_0": -1490.2882498783563}, "policy_reward_max": {"policy_0": -16.2185544528093}, "policy_reward_mean": {"policy_0": -750.1413043570042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 122, 53, 150, 77, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 134, 58, 150, 150, 150, 150, 150, 78, 150, 52, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 118, 150, 129, 91, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137], "policy_policy_0_reward": [-757.4550006234429, -740.1873062060099, -1194.1067860093838, -818.7453927770702, -1082.179454640365, -1457.0044903852101, -1025.5254173255282, -1072.4813912742377, -969.3773781216518, -919.2066094879751, -725.9812981529636, -1137.000873153112, -366.0703619129749, -1262.6947172811065, -413.52156011280067, -966.047250861472, -588.3844152273792, -16.2185544528093, -882.4449557975912, -158.68657528751794, -557.1829792583876, -358.51058012454143, -922.3158993836704, -936.4487092534495, -606.8076781556866, -463.92433794864843, -888.7938372250671, -1463.5285171622063, -1296.203131488179, -408.38743638736923, -506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5658188867923255, "mean_inference_ms": 1.756825819520021, "mean_action_processing_ms": 0.2837750990640134, "mean_env_wait_ms": 3.149830088215473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012677192687988281, "StateBufferConnector_ms": 0.00811910629272461, "ViewRequirementAgentConnector_ms": 0.1971430778503418}, "num_episodes": 29, "episode_return_max": -16.2185544528093, "episode_return_min": -1490.2882498783563, "episode_return_mean": -750.1413043570042, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.32671072660435, "num_env_steps_trained_throughput_per_sec": 333.32671072660435, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12670.57, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12670.495, "sample_time_ms": 1073.797, "learn_time_ms": 11531.829, "learn_throughput": 346.866, "synch_weights_time_ms": 64.11}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "3541f_00000", "date": "2024-08-03_02-55-22", "timestamp": 1722633922, "time_this_iter_s": 12.011790990829468, "time_total_s": 632.9286739826202, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0738b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 632.9286739826202, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.788235294117644, "ram_util_percent": 27.423529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 325.39503026803334, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.08807781462868, "policy_loss": -0.012599357181655554, "vf_loss": 4.1007622450590135, "vf_explained_var": 0.9863558593516548, "kl": 0.0148995186729735, "entropy": 2.028448035940528, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -40.19133062091741, "episode_reward_min": -1490.2882498783563, "episode_reward_mean": -730.5973261950685, "episode_len_mean": 137.71, "episode_media": {}, "episodes_timesteps_total": 13771, "policy_reward_min": {"policy_0": -1490.2882498783563}, "policy_reward_max": {"policy_0": -40.19133062091741}, "policy_reward_mean": {"policy_0": -730.5973261950685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827], "episode_lengths": [150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 134, 58, 150, 150, 150, 150, 150, 78, 150, 52, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 118, 150, 129, 91, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 72, 150, 150, 150, 150, 150, 141, 150, 69, 150, 150, 121, 88, 64, 150, 150, 56, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 139], "policy_policy_0_reward": [-506.2577096858273, -1490.2882498783563, -288.71071931479725, -775.9356965579365, -1134.167308016645, -1450.5663528958569, -798.8031881186005, -437.24464180944415, -1250.2859193584347, -925.5205632414393, -427.440352428989, -410.8910205996373, -1081.861177909026, -428.41801737468126, -40.19133062091741, -716.0456887160965, -696.5236335643792, -1159.5396274268242, -641.2827576741794, -407.1485823172882, -256.3922755467324, -628.3481422107035, -47.94852345538483, -534.3415698986403, -759.4672055721938, -427.05734522347893, -1117.670449612976, -305.55612572324844, -802.5341834625934, -1006.5369574288886, -646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5651598492989541, "mean_inference_ms": 1.754649506290963, "mean_action_processing_ms": 0.28354895589010526, "mean_env_wait_ms": 3.147400626291934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013086318969726562, "StateBufferConnector_ms": 0.008027315139770508, "ViewRequirementAgentConnector_ms": 0.19547104835510254}, "num_episodes": 30, "episode_return_max": -40.19133062091741, "episode_return_min": -1490.2882498783563, "episode_return_mean": -730.5973261950685, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.01089892518775, "num_env_steps_trained_throughput_per_sec": 343.01089892518775, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 12528.602, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12528.528, "sample_time_ms": 1080.762, "learn_time_ms": 11378.563, "learn_throughput": 351.538, "synch_weights_time_ms": 68.368}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "3541f_00000", "date": "2024-08-03_02-55-33", "timestamp": 1722633933, "time_this_iter_s": 11.680137157440186, "time_total_s": 644.6088111400604, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.6088111400604, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 43.84117647058823, "ram_util_percent": 29.629411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 273.5181881090005, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.998942883809407, "policy_loss": -0.017424457517336123, "vf_loss": 5.0169717701772845, "vf_explained_var": 0.9770824168498318, "kl": 0.013345402083480973, "entropy": 1.9225168198347091, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -35.6823599078957, "episode_reward_min": -1474.1437580264223, "episode_reward_mean": -715.4186980975933, "episode_len_mean": 136.92, "episode_media": {}, "episodes_timesteps_total": 13692, "policy_reward_min": {"policy_0": -1474.1437580264223}, "policy_reward_max": {"policy_0": -35.6823599078957}, "policy_reward_mean": {"policy_0": -715.4186980975933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 73, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 118, 150, 129, 91, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 72, 150, 150, 150, 150, 150, 141, 150, 69, 150, 150, 121, 88, 64, 150, 150, 56, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 139, 150, 150, 137, 150, 150, 150, 91, 109, 150, 150, 150, 150, 84, 150, 150, 150, 46, 150, 110, 150, 150, 121, 150, 80, 150, 150, 147, 150, 150, 112], "policy_policy_0_reward": [-646.9570469328232, -741.4289368792279, -1027.7624862304574, -824.8967828107722, -971.065097288193, -945.5844482989468, -948.7399882852634, -97.47835941402887, -1169.106674240553, -442.8464564157214, -929.8889691644836, -1042.6624601134774, -1004.6139817882593, -886.6912842064603, -568.3429248559174, -1063.7459974285878, -851.5486709697223, -1106.8281825751978, -732.4708657228934, -710.180232571724, -111.57704024495392, -523.6222053165501, -1200.7775286833291, -348.74367612393917, -235.66880551385876, -954.0242804903843, -639.3692675622833, -553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5686751880355932, "mean_inference_ms": 1.7653522461483084, "mean_action_processing_ms": 0.28522862115570274, "mean_env_wait_ms": 3.164959500401327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026093006134033203, "StateBufferConnector_ms": 0.008301496505737305, "ViewRequirementAgentConnector_ms": 0.2606029510498047}, "num_episodes": 30, "episode_return_max": -35.6823599078957, "episode_return_min": -1474.1437580264223, "episode_return_mean": -715.4186980975933, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.45313938357515, "num_env_steps_trained_throughput_per_sec": 312.45313938357515, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 12456.762, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12456.686, "sample_time_ms": 1232.938, "learn_time_ms": 11154.841, "learn_throughput": 358.589, "synch_weights_time_ms": 68.078}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "3541f_00000", "date": "2024-08-03_02-55-46", "timestamp": 1722633946, "time_this_iter_s": 12.810927391052246, "time_total_s": 657.4197385311127, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.4197385311127, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 77.28888888888889, "ram_util_percent": 41.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 317.20026766061784, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.0611313493301475, "policy_loss": -0.006531750677337792, "vf_loss": 4.069655187924703, "vf_explained_var": 0.9755262360597651, "kl": 0.012987660410847942, "entropy": 2.151753418147564, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -35.6823599078957, "episode_reward_min": -1502.55894230534, "episode_reward_mean": -726.8683071529529, "episode_len_mean": 137.48, "episode_media": {}, "episodes_timesteps_total": 13748, "policy_reward_min": {"policy_0": -1502.55894230534}, "policy_reward_max": {"policy_0": -35.6823599078957}, "policy_reward_mean": {"policy_0": -726.8683071529529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408], "episode_lengths": [150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 72, 150, 150, 150, 150, 150, 141, 150, 69, 150, 150, 121, 88, 64, 150, 150, 56, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 139, 150, 150, 137, 150, 150, 150, 91, 109, 150, 150, 150, 150, 84, 150, 150, 150, 46, 150, 110, 150, 150, 121, 150, 80, 150, 150, 147, 150, 150, 112, 150, 150, 150, 150, 125, 150, 150, 145, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 56], "policy_policy_0_reward": [-553.1867199446301, -458.9041562300873, -1126.9571642537887, -424.90989791638174, -819.9310495160338, -567.5887069121727, -378.3597747998833, -1105.9606622620643, -333.5277867782691, -1200.3791156554053, -1250.3262323103252, -329.9729017475344, -329.10540612382454, -1227.409632055622, -1295.1107490293186, -97.8222164542435, -751.9827242151916, -928.2043368674132, -768.4350441749696, -1474.1437580264223, -832.4691741777697, -397.46115785741955, -1005.589176842555, -84.91355117147714, -1095.5344125202676, -492.87835080241723, -480.5106973998492, -194.44635153657524, -40.522831423365965, -1175.8376019454263, -636.4319662220564, -106.2280239943835, -689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5715619147781296, "mean_inference_ms": 1.7750304587156733, "mean_action_processing_ms": 0.28666809134164933, "mean_env_wait_ms": 3.18240797354785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025945663452148438, "StateBufferConnector_ms": 0.008224248886108398, "ViewRequirementAgentConnector_ms": 0.26079392433166504}, "num_episodes": 27, "episode_return_max": -35.6823599078957, "episode_return_min": -1502.55894230534, "episode_return_mean": -726.8683071529529, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.226812700428, "num_env_steps_trained_throughput_per_sec": 317.226812700428, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12418.554, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12418.478, "sample_time_ms": 1243.316, "learn_time_ms": 11105.274, "learn_throughput": 360.189, "synch_weights_time_ms": 69.064}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "3541f_00000", "date": "2024-08-03_02-55-59", "timestamp": 1722633959, "time_this_iter_s": 12.620481491088867, "time_total_s": 670.0402200222015, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 670.0402200222015, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 31.488888888888894, "ram_util_percent": 46.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.29317963520685, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.980868551135063, "policy_loss": -0.011144422768848018, "vf_loss": 4.9907516765097775, "vf_explained_var": 0.9774520414570967, "kl": 0.01413736064969271, "entropy": 1.6562879494701823, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -35.6823599078957, "episode_reward_min": -1502.55894230534, "episode_reward_mean": -686.9262088559643, "episode_len_mean": 132.51, "episode_media": {}, "episodes_timesteps_total": 13251, "policy_reward_min": {"policy_0": -1502.55894230534}, "policy_reward_max": {"policy_0": -35.6823599078957}, "policy_reward_mean": {"policy_0": -686.9262088559643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696], "episode_lengths": [150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 139, 150, 150, 137, 150, 150, 150, 91, 109, 150, 150, 150, 150, 84, 150, 150, 150, 46, 150, 110, 150, 150, 121, 150, 80, 150, 150, 147, 150, 150, 112, 150, 150, 150, 150, 125, 150, 150, 145, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 56, 121, 150, 150, 133, 75, 150, 150, 150, 95, 87, 123, 93, 150, 150, 121, 62, 135, 150, 109, 150, 67, 126, 150, 84, 104, 150, 150, 65, 150, 150, 51, 99], "policy_policy_0_reward": [-689.7899268235498, -1185.3106816665727, -1144.309219795925, -819.3415865768171, -1155.4514932505924, -43.3137831107746, -1141.887612649998, -1096.8993551383767, -735.0862848041853, -776.6468054698779, -627.056573280827, -707.2502360291652, -951.3411604947329, -488.9373493720691, -668.2085498586407, -793.8901253471045, -1070.4882401578186, -137.69752902742954, -369.8962129291369, -1317.823583557949, -1038.2185971166916, -429.1108840496993, -701.2334182471197, -116.16931969937102, -434.05875884586976, -427.0514911826793, -1222.3950531184207, -35.6823599078957, -1048.895379857255, -183.6579929922069, -761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5746579891519751, "mean_inference_ms": 1.7859097909827468, "mean_action_processing_ms": 0.2881529357020144, "mean_env_wait_ms": 3.1987072463958244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.008247137069702148, "ViewRequirementAgentConnector_ms": 0.26254963874816895}, "num_episodes": 32, "episode_return_max": -35.6823599078957, "episode_return_min": -1502.55894230534, "episode_return_mean": -686.9262088559643, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.4289547889971, "num_env_steps_trained_throughput_per_sec": 322.4289547889971, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12346.076, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12345.999, "sample_time_ms": 1259.168, "learn_time_ms": 11020.198, "learn_throughput": 362.97, "synch_weights_time_ms": 65.812}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "3541f_00000", "date": "2024-08-03_02-56-11", "timestamp": 1722633971, "time_this_iter_s": 12.416062355041504, "time_total_s": 682.456282377243, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 682.456282377243, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 46.416666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 281.99834822416307, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.051127362747987, "policy_loss": -0.01749776910194972, "vf_loss": 5.066607802609602, "vf_explained_var": 0.9736195458720128, "kl": 0.014728411294496861, "entropy": 1.5848682063321273, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -19.492113589640727, "episode_reward_min": -1502.55894230534, "episode_reward_mean": -652.1650914074436, "episode_len_mean": 129.97, "episode_media": {}, "episodes_timesteps_total": 12997, "policy_reward_min": {"policy_0": -1502.55894230534}, "policy_reward_max": {"policy_0": -19.492113589640727}, "policy_reward_mean": {"policy_0": -652.1650914074436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494], "episode_lengths": [150, 150, 121, 150, 80, 150, 150, 147, 150, 150, 112, 150, 150, 150, 150, 125, 150, 150, 145, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 56, 121, 150, 150, 133, 75, 150, 150, 150, 95, 87, 123, 93, 150, 150, 121, 62, 135, 150, 109, 150, 67, 126, 150, 84, 104, 150, 150, 65, 150, 150, 51, 99, 67, 150, 91, 150, 42, 150, 70, 61, 150, 150, 150, 150, 103, 150, 150, 91, 105, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 134, 150, 150], "policy_policy_0_reward": [-761.3973029201414, -656.789955281751, -502.5649088323448, -953.6450311427144, -135.3093495723278, -1082.4049590344443, -673.9891611093374, -635.135929711134, -778.0088093894033, -870.8906394405222, -242.9702176713048, -606.8695471789459, -708.0923936075105, -1035.1964822751665, -409.2638070541875, -519.926728232785, -1187.1475277039856, -663.6165015930508, -658.5950177214208, -105.28782458011928, -1065.7314597105824, -781.8966125954447, -875.2818734730431, -585.930577598988, -772.592718153191, -1103.3161373168884, -821.2329989664482, -740.259894573275, -1193.1454095453316, -1088.7796689655438, -1502.55894230534, -1154.3404648057672, -1220.9609597106983, -1145.7402567191157, -586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5753601879665667, "mean_inference_ms": 1.788655533421132, "mean_action_processing_ms": 0.2884679957653885, "mean_env_wait_ms": 3.201877786562828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012415647506713867, "StateBufferConnector_ms": 0.008131742477416992, "ViewRequirementAgentConnector_ms": 0.2117621898651123}, "num_episodes": 30, "episode_return_max": -19.492113589640727, "episode_return_min": -1502.55894230534, "episode_return_mean": -652.1650914074436, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.30359403909273, "num_env_steps_trained_throughput_per_sec": 304.30359403909273, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12329.671, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12329.596, "sample_time_ms": 1266.245, "learn_time_ms": 10999.023, "learn_throughput": 363.669, "synch_weights_time_ms": 63.521}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "3541f_00000", "date": "2024-08-03_02-56-24", "timestamp": 1722633984, "time_this_iter_s": 13.155574560165405, "time_total_s": 695.6118569374084, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 695.6118569374084, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 32.9421052631579, "ram_util_percent": 46.52105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 282.30737682580946, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.354924875001113, "policy_loss": -0.012346152689133305, "vf_loss": 4.366700792064269, "vf_explained_var": 0.9726764475305875, "kl": 0.014866968688208242, "entropy": 1.892994042734305, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -19.492113589640727, "episode_reward_min": -1485.8772440157966, "episode_reward_mean": -608.3619789456504, "episode_len_mean": 125.72, "episode_media": {}, "episodes_timesteps_total": 12572, "policy_reward_min": {"policy_0": -1485.8772440157966}, "policy_reward_max": {"policy_0": -19.492113589640727}, "policy_reward_mean": {"policy_0": -608.3619789456504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853], "episode_lengths": [150, 150, 123, 56, 121, 150, 150, 133, 75, 150, 150, 150, 95, 87, 123, 93, 150, 150, 121, 62, 135, 150, 109, 150, 67, 126, 150, 84, 104, 150, 150, 65, 150, 150, 51, 99, 67, 150, 91, 150, 42, 150, 70, 61, 150, 150, 150, 150, 103, 150, 150, 91, 105, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 134, 150, 150, 150, 150, 73, 75, 150, 79, 150, 57, 150, 150, 143, 150, 150, 124, 150, 150, 150, 150, 76, 150, 150, 143, 150, 150, 150, 90, 72, 150, 47, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-586.1608111961581, -751.6649169758414, -460.1720207869847, -127.82200231816408, -251.225525380037, -1459.2785151412882, -857.798488179951, -734.3047533502006, -80.79126145261662, -965.6642074915243, -886.5823442830136, -655.0872561995405, -261.7849771663955, -198.56051021717022, -259.41207915100773, -281.8119772662476, -988.7996097827801, -1196.7136486472086, -379.96534886560113, -131.58073373366796, -295.7021875543303, -1418.2657269138074, -293.01601185108706, -608.6744958154021, -218.7057430996748, -397.0608377492825, -924.0445435936986, -191.0910501675073, -228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5756520799551385, "mean_inference_ms": 1.7891040871314903, "mean_action_processing_ms": 0.2883319070463295, "mean_env_wait_ms": 3.200290170799038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012375593185424805, "StateBufferConnector_ms": 0.00806117057800293, "ViewRequirementAgentConnector_ms": 0.19725394248962402}, "num_episodes": 34, "episode_return_max": -19.492113589640727, "episode_return_min": -1485.8772440157966, "episode_return_mean": -608.3619789456504, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.6808096794739, "num_env_steps_trained_throughput_per_sec": 277.6808096794739, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12439.212, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12439.139, "sample_time_ms": 1280.714, "learn_time_ms": 11093.211, "learn_throughput": 360.581, "synch_weights_time_ms": 64.403}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "3541f_00000", "date": "2024-08-03_02-56-39", "timestamp": 1722633999, "time_this_iter_s": 14.412971019744873, "time_total_s": 710.0248279571533, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0738040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 710.0248279571533, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 32.199999999999996, "ram_util_percent": 46.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 300.263022261858, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.24379967575272, "policy_loss": -0.007712214462420282, "vf_loss": 4.2531439910332365, "vf_explained_var": 0.982326545442144, "kl": 0.01330333434877204, "entropy": 2.122370204826196, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -13.773069368019499, "episode_reward_min": -1485.8772440157966, "episode_reward_mean": -649.296764458022, "episode_len_mean": 128.52, "episode_media": {}, "episodes_timesteps_total": 12852, "policy_reward_min": {"policy_0": -1485.8772440157966}, "policy_reward_max": {"policy_0": -13.773069368019499}, "policy_reward_mean": {"policy_0": -649.296764458022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056], "episode_lengths": [104, 150, 150, 65, 150, 150, 51, 99, 67, 150, 91, 150, 42, 150, 70, 61, 150, 150, 150, 150, 103, 150, 150, 91, 105, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 134, 150, 150, 150, 150, 73, 75, 150, 79, 150, 57, 150, 150, 143, 150, 150, 124, 150, 150, 150, 150, 76, 150, 150, 143, 150, 150, 150, 90, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 88, 86, 150, 123, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 66, 150, 150, 150, 120, 150, 150, 150, 55, 131, 150, 150], "policy_policy_0_reward": [-228.489593527216, -714.7834525633513, -1312.8377381939229, -138.28920901116365, -458.5285012419205, -969.6670522394647, -43.81778581243858, -168.4963358257696, -137.678375979019, -612.5455679456993, -208.70851899950904, -1299.777440827449, -19.492113589640727, -1228.5527733783933, -176.35020140110282, -68.70292912809867, -725.734710676432, -809.9476348013653, -577.533410276894, -1196.6059164968829, -457.4629279010688, -679.8029360813022, -608.6877567225079, -303.8916176722803, -232.32674296013792, -853.8086088894946, -926.752981232284, -686.2521177132404, -656.6342363811979, -662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5755321514776506, "mean_inference_ms": 1.7868414477770498, "mean_action_processing_ms": 0.28808871663083085, "mean_env_wait_ms": 3.197634556996939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012119531631469727, "StateBufferConnector_ms": 0.007921934127807617, "ViewRequirementAgentConnector_ms": 0.19537806510925293}, "num_episodes": 28, "episode_return_max": -13.773069368019499, "episode_return_min": -1485.8772440157966, "episode_return_mean": -649.296764458022, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.2143397521538, "num_env_steps_trained_throughput_per_sec": 477.2143397521538, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 12132.614, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12132.543, "sample_time_ms": 1282.455, "learn_time_ms": 10786.033, "learn_throughput": 370.85, "synch_weights_time_ms": 63.246}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "3541f_00000", "date": "2024-08-03_02-56-47", "timestamp": 1722634007, "time_this_iter_s": 8.393959999084473, "time_total_s": 718.4187879562378, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 718.4187879562378, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.15833333333333, "ram_util_percent": 46.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 231.96894217133521, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.71684547290206, "policy_loss": -0.010001240510609933, "vf_loss": 4.7281430455545586, "vf_explained_var": 0.9876311530048648, "kl": 0.014564879236392459, "entropy": 2.2255231112241747, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -13.773069368019499, "episode_reward_min": -1485.8772440157966, "episode_reward_mean": -682.1071755421987, "episode_len_mean": 132.73, "episode_media": {}, "episodes_timesteps_total": 13273, "policy_reward_min": {"policy_0": -1485.8772440157966}, "policy_reward_max": {"policy_0": -13.773069368019499}, "policy_reward_mean": {"policy_0": -682.1071755421987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224], "episode_lengths": [150, 150, 50, 150, 150, 150, 134, 150, 150, 150, 150, 73, 75, 150, 79, 150, 57, 150, 150, 143, 150, 150, 124, 150, 150, 150, 150, 76, 150, 150, 143, 150, 150, 150, 90, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 88, 86, 150, 123, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 66, 150, 150, 150, 120, 150, 150, 150, 55, 131, 150, 150, 150, 131, 150, 142, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 93, 150, 150, 145, 86, 150, 68, 150, 120, 150], "policy_policy_0_reward": [-662.7678565085608, -865.3179306042155, -28.90236747599523, -558.9914807737955, -1485.8772440157966, -436.3043858615937, -351.9929269868298, -541.1329601772269, -682.4511480486494, -1240.3309107457094, -837.938623204188, -94.17157458252117, -197.71879940958974, -609.7519844186254, -175.26421648421555, -611.8846680824371, -138.45038758738923, -647.2202003156806, -771.5107380484698, -542.8801239914816, -595.7555043577229, -833.1107264570247, -592.9726918470734, -505.4768129235482, -1298.2040121412808, -908.8246471073484, -1155.5710033483488, -79.62148682427387, -603.0816483210023, -1323.2778870114876, -686.4001631019928, -928.0435943012961, -1046.552941011331, -1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5748436535106914, "mean_inference_ms": 1.7838240522790472, "mean_action_processing_ms": 0.28760986901352104, "mean_env_wait_ms": 3.1931425741324158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189112663269043, "StateBufferConnector_ms": 0.007881641387939453, "ViewRequirementAgentConnector_ms": 0.1944887638092041}, "num_episodes": 29, "episode_return_max": -13.773069368019499, "episode_return_min": -1485.8772440157966, "episode_return_mean": -682.1071755421987, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.57749142303487, "num_env_steps_trained_throughput_per_sec": 334.57749142303487, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 12019.293, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12019.221, "sample_time_ms": 1293.756, "learn_time_ms": 10661.33, "learn_throughput": 375.188, "synch_weights_time_ms": 63.326}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "3541f_00000", "date": "2024-08-03_02-56-59", "timestamp": 1722634019, "time_this_iter_s": 11.965070962905884, "time_total_s": 730.3838589191437, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 730.3838589191437, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.08823529411765, "ram_util_percent": 31.058823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 334.5593129634857, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.224348913133144, "policy_loss": -0.00540687266960352, "vf_loss": 4.229648723453283, "vf_explained_var": 0.9759861646840969, "kl": 0.015974527823740026, "entropy": 2.135149026537935, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": -13.773069368019499, "episode_reward_min": -1533.3093665942492, "episode_reward_mean": -694.9676243042695, "episode_len_mean": 133.71, "episode_media": {}, "episodes_timesteps_total": 13371, "policy_reward_min": {"policy_0": -1533.3093665942492}, "policy_reward_max": {"policy_0": -13.773069368019499}, "policy_reward_mean": {"policy_0": -694.9676243042695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944], "episode_lengths": [150, 90, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 88, 86, 150, 123, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 66, 150, 150, 150, 120, 150, 150, 150, 55, 131, 150, 150, 150, 131, 150, 142, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 93, 150, 150, 145, 86, 150, 68, 150, 120, 150, 150, 150, 150, 150, 150, 150, 123, 150, 74, 150, 150, 129, 150, 150, 150, 101, 150, 150, 54, 150, 150, 150, 64, 150, 114, 150, 150, 150, 150, 93, 150, 150, 150], "policy_policy_0_reward": [-1113.8084417197938, -172.82024647723077, -186.90233424838357, -1027.846924633758, -41.13778118999165, -892.4000260503371, -561.8541885654744, -473.54209289788224, -1033.5646055445668, -930.6668353614853, -616.7924621724438, -846.4392164670458, -190.93225650489967, -223.44713941462712, -1203.6755632231936, -606.5374550804411, -621.0344175657447, -1304.4709103909759, -896.4460247890822, -855.6189389224576, -858.0839859399234, -625.1821708187244, -317.77118717560046, -1012.6373930390187, -1343.8272091790323, -13.773069368019499, -184.0995256029245, -723.0916290275832, -981.0780218747383, -592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5742410212500743, "mean_inference_ms": 1.7820040959613752, "mean_action_processing_ms": 0.28736749441290393, "mean_env_wait_ms": 3.19099840750397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011544227600097656, "StateBufferConnector_ms": 0.007845163345336914, "ViewRequirementAgentConnector_ms": 0.1921999454498291}, "num_episodes": 33, "episode_return_max": -13.773069368019499, "episode_return_min": -1533.3093665942492, "episode_return_mean": -694.9676243042695, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.11743762886294, "num_env_steps_trained_throughput_per_sec": 348.11743762886294, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 12085.636, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12085.562, "sample_time_ms": 1288.133, "learn_time_ms": 10728.248, "learn_throughput": 372.847, "synch_weights_time_ms": 68.3}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "3541f_00000", "date": "2024-08-03_02-57-11", "timestamp": 1722634031, "time_this_iter_s": 11.508201837539673, "time_total_s": 741.8920607566833, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x746e53d43eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.8920607566833, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 45.3875, "ram_util_percent": 29.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 235.1622792204221, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.1607469742496805, "policy_loss": -0.011279601088608615, "vf_loss": 5.171157948424419, "vf_explained_var": 0.9716685101389885, "kl": 0.015127010582197424, "entropy": 1.8684252619743347, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -13.56305214813696, "episode_reward_min": -1533.3093665942492, "episode_reward_mean": -675.3464892756851, "episode_len_mean": 133.94, "episode_media": {}, "episodes_timesteps_total": 13394, "policy_reward_min": {"policy_0": -1533.3093665942492}, "policy_reward_max": {"policy_0": -13.56305214813696}, "policy_reward_mean": {"policy_0": -675.3464892756851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164], "episode_lengths": [150, 120, 150, 150, 150, 55, 131, 150, 150, 150, 131, 150, 142, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 93, 150, 150, 145, 86, 150, 68, 150, 120, 150, 150, 150, 150, 150, 150, 150, 123, 150, 74, 150, 150, 129, 150, 150, 150, 101, 150, 150, 54, 150, 150, 150, 64, 150, 114, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 114, 68, 124, 83, 44, 150, 107, 150, 150, 121, 150, 81, 150, 150, 150], "policy_policy_0_reward": [-592.8729426710588, -517.6168750297954, -526.0740176839987, -1257.5401250552593, -1267.6619214223656, -37.38175000775546, -318.58970502595986, -1148.946158186475, -863.5980639282056, -674.38788498357, -548.2673312311007, -472.1303534125156, -468.2087895893406, -98.69023548622408, -673.3291386262468, -680.298957665088, -999.0433260312441, -974.875007369105, -771.6443017430155, -636.8184726810931, -1480.3379490973816, -1237.6332228763818, -437.35387421468226, -598.1832567560065, -1421.085119859107, -839.6923637948348, -112.68646919656177, -805.3433062115087, -285.62824544203266, -807.6238650277378, -664.7648037143839, -504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5769090132912743, "mean_inference_ms": 1.789038903698444, "mean_action_processing_ms": 0.28869374404058545, "mean_env_wait_ms": 3.2044809638893024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020277738571166992, "StateBufferConnector_ms": 0.010506868362426758, "ViewRequirementAgentConnector_ms": 0.2564427852630615}, "num_episodes": 29, "episode_return_max": -13.56305214813696, "episode_return_min": -1533.3093665942492, "episode_return_mean": -675.3464892756851, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.0852917930504, "num_env_steps_trained_throughput_per_sec": 290.0852917930504, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 12264.517, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12264.44, "sample_time_ms": 1431.662, "learn_time_ms": 10756.326, "learn_throughput": 371.874, "synch_weights_time_ms": 75.514}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "3541f_00000", "date": "2024-08-03_02-57-25", "timestamp": 1722634045, "time_this_iter_s": 13.809632778167725, "time_total_s": 755.7016935348511, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 755.7016935348511, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 80.315, "ram_util_percent": 41.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 267.99392859737077, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.85936367114385, "policy_loss": -0.00820120989131586, "vf_loss": 4.8664413305620355, "vf_explained_var": 0.9801655690496166, "kl": 0.014855593642884489, "entropy": 1.7807939644902944, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -13.56305214813696, "episode_reward_min": -1533.3093665942492, "episode_reward_mean": -650.9407600682063, "episode_len_mean": 130.62, "episode_media": {}, "episodes_timesteps_total": 13062, "policy_reward_min": {"policy_0": -1533.3093665942492}, "policy_reward_max": {"policy_0": -13.56305214813696}, "policy_reward_mean": {"policy_0": -650.9407600682063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852], "episode_lengths": [145, 86, 150, 68, 150, 120, 150, 150, 150, 150, 150, 150, 150, 123, 150, 74, 150, 150, 129, 150, 150, 150, 101, 150, 150, 54, 150, 150, 150, 64, 150, 114, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 114, 68, 124, 83, 44, 150, 107, 150, 150, 121, 150, 81, 150, 150, 150, 150, 130, 55, 77, 150, 150, 112, 150, 89, 58, 150, 90, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 58, 150, 150, 150, 150, 150, 150, 75, 150], "policy_policy_0_reward": [-504.9673781391633, -217.26560936800817, -888.3531398458407, -80.72980116049136, -1319.8408386508127, -511.6088545655192, -572.4083991479224, -411.3847419485616, -691.8088236071569, -1159.921147005251, -714.8377278777649, -622.7644183751313, -967.9217864216342, -536.2724220995946, -455.74634111349775, -57.79158558381843, -402.05837702070096, -625.4709009996076, -664.6265014532482, -497.97873978720565, -1260.4534937696462, -1016.6569148288647, -158.70366976294636, -811.6691461001758, -488.44904191839163, -41.41450628326657, -404.88049293965815, -905.950985861875, -1471.4063669887732, -161.7244114294657, -1427.9413899877954, -323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5816485433854931, "mean_inference_ms": 1.8045814852270012, "mean_action_processing_ms": 0.29135124087215464, "mean_env_wait_ms": 3.2274647450782674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020799636840820312, "StateBufferConnector_ms": 0.010621309280395508, "ViewRequirementAgentConnector_ms": 0.29725050926208496}, "num_episodes": 31, "episode_return_max": -13.56305214813696, "episode_return_min": -1533.3093665942492, "episode_return_mean": -650.9407600682063, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.5693298140244, "num_env_steps_trained_throughput_per_sec": 265.5693298140244, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12604.573, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12604.491, "sample_time_ms": 1530.892, "learn_time_ms": 11001.177, "learn_throughput": 363.597, "synch_weights_time_ms": 71.549}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "3541f_00000", "date": "2024-08-03_02-57-40", "timestamp": 1722634060, "time_this_iter_s": 15.075405359268188, "time_total_s": 770.7770988941193, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 770.7770988941193, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 27.53809523809524, "ram_util_percent": 46.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 262.14187197089194, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.439140789707502, "policy_loss": -0.003945244911301415, "vf_loss": 4.442820231368144, "vf_explained_var": 0.9772383291895191, "kl": 0.01444433423951826, "entropy": 1.8968279335647822, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -10.889295725123946, "episode_reward_min": -1533.3093665942492, "episode_reward_mean": -616.527358725643, "episode_len_mean": 128.52, "episode_media": {}, "episodes_timesteps_total": 12852, "policy_reward_min": {"policy_0": -1533.3093665942492}, "policy_reward_max": {"policy_0": -10.889295725123946}, "policy_reward_mean": {"policy_0": -616.527358725643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225], "episode_lengths": [114, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 114, 68, 124, 83, 44, 150, 107, 150, 150, 121, 150, 81, 150, 150, 150, 150, 130, 55, 77, 150, 150, 112, 150, 89, 58, 150, 90, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 58, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 57, 100, 113, 142, 39, 150, 150, 150, 131, 66, 143, 99, 150, 63, 146, 94, 150, 150, 124, 150, 148], "policy_policy_0_reward": [-323.2861976908895, -877.4067985836692, -1064.8808010405403, -827.7838280933979, -577.9283792215983, -154.38783148602698, -663.820728169092, -1533.3093665942492, -1343.1606582402944, -564.9950015740224, -766.9609930903746, -1062.4852315688986, -94.53184664412717, -167.59058600719692, -1310.4048737793091, -422.8204645880252, -594.291926433481, -488.1686321840062, -1387.0601719606414, -390.9842867336541, -847.0783997752573, -575.9150546920636, -497.7569503674424, -322.30468543330653, -198.5547836268061, -412.8340652837176, -266.19648783346946, -13.56305214813696, -1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5854455326364821, "mean_inference_ms": 1.8188760254046454, "mean_action_processing_ms": 0.29410040937767845, "mean_env_wait_ms": 3.2494182607152533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02108168601989746, "StateBufferConnector_ms": 0.010645627975463867, "ViewRequirementAgentConnector_ms": 0.3106532096862793}, "num_episodes": 31, "episode_return_max": -10.889295725123946, "episode_return_min": -1533.3093665942492, "episode_return_mean": -616.527358725643, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.4631344493551, "num_env_steps_trained_throughput_per_sec": 290.4631344493551, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12701.491, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12701.412, "sample_time_ms": 1386.58, "learn_time_ms": 11242.406, "learn_throughput": 355.796, "synch_weights_time_ms": 71.553}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "3541f_00000", "date": "2024-08-03_02-57-54", "timestamp": 1722634074, "time_this_iter_s": 13.783677339553833, "time_total_s": 784.5607762336731, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b88b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 784.5607762336731, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.00500000000001, "ram_util_percent": 46.540000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 298.5349245587985, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.536441779385011, "policy_loss": -0.017320613254075093, "vf_loss": 4.555994124462207, "vf_explained_var": 0.9833799886206785, "kl": 0.012290505888874339, "entropy": 2.105564074218273, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -10.889295725123946, "episode_reward_min": -1397.8886456481478, "episode_reward_mean": -617.8020791048874, "episode_len_mean": 129.37, "episode_media": {}, "episodes_timesteps_total": 12937, "policy_reward_min": {"policy_0": -1397.8886456481478}, "policy_reward_max": {"policy_0": -10.889295725123946}, "policy_reward_mean": {"policy_0": -617.8020791048874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253], "episode_lengths": [150, 107, 150, 150, 121, 150, 81, 150, 150, 150, 150, 130, 55, 77, 150, 150, 112, 150, 89, 58, 150, 90, 150, 150, 150, 150, 150, 74, 150, 150, 107, 150, 58, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 57, 100, 113, 142, 39, 150, 150, 150, 131, 66, 143, 99, 150, 63, 146, 94, 150, 150, 124, 150, 148, 150, 60, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 101, 150, 58, 150, 134, 42, 146, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1151.8070522783996, -186.1344352083692, -1017.2253729177785, -1005.1138345379987, -204.14972246267774, -1086.1772296235893, -232.3595807778283, -349.1700093983742, -1069.5005945324715, -1211.2332249255164, -1004.9973119593392, -451.8657033427435, -86.14166873256907, -152.16446823257849, -1011.3154981043206, -567.2289937064263, -528.1754381229565, -1269.1777385690264, -119.67626544809701, -33.427422102136845, -1002.2738142683015, -312.81473319459684, -507.02148790076984, -1178.4269169204415, -827.1788545230934, -454.04443115189474, -864.0022784930836, -85.63538227392303, -1177.9362204964214, -1079.109513913655, -143.92213750091395, -784.8101175293727, -159.17947501711393, -1101.5009951895627, -540.6327747372985, -472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5877289646585723, "mean_inference_ms": 1.826868760287947, "mean_action_processing_ms": 0.29565849375365677, "mean_env_wait_ms": 3.262305571312635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013065099716186523, "StateBufferConnector_ms": 0.008144855499267578, "ViewRequirementAgentConnector_ms": 0.2668592929840088}, "num_episodes": 28, "episode_return_max": -10.889295725123946, "episode_return_min": -1397.8886456481478, "episode_return_mean": -617.8020791048874, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.61668908823293, "num_env_steps_trained_throughput_per_sec": 285.61668908823293, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12841.042, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12840.963, "sample_time_ms": 1393.419, "learn_time_ms": 11373.752, "learn_throughput": 351.687, "synch_weights_time_ms": 72.905}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "3541f_00000", "date": "2024-08-03_02-58-08", "timestamp": 1722634088, "time_this_iter_s": 14.016556024551392, "time_total_s": 798.5773322582245, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 798.5773322582245, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.82, "ram_util_percent": 46.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.94325381914774, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.719933090855678, "policy_loss": -0.00811100514450421, "vf_loss": 4.728758429735899, "vf_explained_var": 0.9769002613301079, "kl": 0.014587986041078693, "entropy": 2.112243526180585, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -10.889295725123946, "episode_reward_min": -1490.0248143109268, "episode_reward_mean": -626.4709010186143, "episode_len_mean": 132.41, "episode_media": {}, "episodes_timesteps_total": 13241, "policy_reward_min": {"policy_0": -1490.0248143109268}, "policy_reward_max": {"policy_0": -10.889295725123946}, "policy_reward_mean": {"policy_0": -626.4709010186143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835], "episode_lengths": [150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 57, 100, 113, 142, 39, 150, 150, 150, 131, 66, 143, 99, 150, 63, 146, 94, 150, 150, 124, 150, 148, 150, 60, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 101, 150, 58, 150, 134, 42, 146, 150, 150, 150, 150, 150, 150, 103, 150, 150, 80, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 113, 150, 70, 150, 150, 105, 150, 94, 112, 150, 150, 150, 150, 150, 150, 108], "policy_policy_0_reward": [-472.8374478248789, -1039.3308852035802, -1074.4923741687223, -894.8090917399938, -214.48695856982886, -639.1185143344852, -597.9905201467992, -446.3860916955103, -887.3296273328439, -810.6135027165, -685.6423599123038, -1076.1721728162704, -22.70818448027657, -719.924760591009, -523.222491021671, -1349.4430358373718, -45.763673682260006, -390.5429386069191, -174.95252574769577, -400.81509645728346, -10.889295725123946, -997.8628264115983, -567.9561163984731, -1207.8223331813579, -459.97253116628974, -112.20931813683268, -416.1877502486204, -266.21674967447433, -922.4236292716151, -76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5886465329464877, "mean_inference_ms": 1.830241711008538, "mean_action_processing_ms": 0.29629506134738426, "mean_env_wait_ms": 3.2647456452501378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013310432434082031, "StateBufferConnector_ms": 0.008058309555053711, "ViewRequirementAgentConnector_ms": 0.21007895469665527}, "num_episodes": 35, "episode_return_max": -10.889295725123946, "episode_return_min": -1490.0248143109268, "episode_return_mean": -626.4709010186143, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.79154012244993, "num_env_steps_trained_throughput_per_sec": 399.79154012244993, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12600.981, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12600.9, "sample_time_ms": 1397.754, "learn_time_ms": 11129.304, "learn_throughput": 359.412, "synch_weights_time_ms": 72.955}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "3541f_00000", "date": "2024-08-03_02-58-18", "timestamp": 1722634098, "time_this_iter_s": 10.012682437896729, "time_total_s": 808.5900146961212, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 808.5900146961212, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 46.49285714285714, "ram_util_percent": 44.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 374.7183054526647, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.759581016004086, "policy_loss": -0.008769315129514628, "vf_loss": 4.77232401718696, "vf_explained_var": 0.9799512512981892, "kl": 0.011601467236656997, "entropy": 2.360933392867446, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -21.289068633198514, "episode_reward_min": -1509.3445127905952, "episode_reward_mean": -655.319747258642, "episode_len_mean": 132.95, "episode_media": {}, "episodes_timesteps_total": 13295, "policy_reward_min": {"policy_0": -1509.3445127905952}, "policy_reward_max": {"policy_0": -21.289068633198514}, "policy_reward_mean": {"policy_0": -655.319747258642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294], "episode_lengths": [63, 146, 94, 150, 150, 124, 150, 148, 150, 60, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 101, 150, 58, 150, 134, 42, 146, 150, 150, 150, 150, 150, 150, 103, 150, 150, 80, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 113, 150, 70, 150, 150, 105, 150, 94, 112, 150, 150, 150, 150, 150, 150, 108, 118, 150, 150, 150, 150, 150, 150, 150, 150, 131, 80, 88, 150, 150, 150, 150, 83, 61, 150, 146, 74, 150, 150, 66, 150, 150, 61, 150, 150], "policy_policy_0_reward": [-76.0290236449876, -391.15197216432455, -199.40329040988541, -503.2971319247854, -751.3281056597394, -320.571106606655, -872.93249025857, -403.9071678574225, -1101.9901904324502, -21.289068633198514, -845.4155658967853, -660.3879365706384, -352.2176699172957, -625.7222845061265, -333.1566697147916, -142.66444172761024, -979.3682682541632, -635.4389366586396, -1397.8886456481478, -463.7686665599788, -908.534320518732, -672.9840734079824, -1233.768168378324, -320.779779241648, -476.9501230196282, -34.679737131482426, -1188.1745631516, -469.8185669469761, -31.833775090944176, -349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5884613724643117, "mean_inference_ms": 1.8294580007482886, "mean_action_processing_ms": 0.2961643431792933, "mean_env_wait_ms": 3.2646101507945833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012780427932739258, "StateBufferConnector_ms": 0.00792384147644043, "ViewRequirementAgentConnector_ms": 0.19332504272460938}, "num_episodes": 29, "episode_return_max": -21.289068633198514, "episode_return_min": -1509.3445127905952, "episode_return_mean": -655.319747258642, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.24573299099404, "num_env_steps_trained_throughput_per_sec": 320.24573299099404, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 12535.544, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12535.465, "sample_time_ms": 1395.113, "learn_time_ms": 11065.827, "learn_throughput": 361.473, "synch_weights_time_ms": 73.639}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "3541f_00000", "date": "2024-08-03_02-58-30", "timestamp": 1722634110, "time_this_iter_s": 12.50276803970337, "time_total_s": 821.0927827358246, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 821.0927827358246, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 21.183333333333334, "ram_util_percent": 27.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 386.49230749607085, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.735815666864315, "policy_loss": -0.003067632910097018, "vf_loss": 4.7355534287790455, "vf_explained_var": 0.9801838029796879, "kl": 0.0203474696310878, "entropy": 2.0809299694995085, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -27.08974418293697, "episode_reward_min": -1509.3445127905952, "episode_reward_mean": -714.4382515633322, "episode_len_mean": 134.17, "episode_media": {}, "episodes_timesteps_total": 13417, "policy_reward_min": {"policy_0": -1509.3445127905952}, "policy_reward_max": {"policy_0": -27.08974418293697}, "policy_reward_mean": {"policy_0": -714.4382515633322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985], "episode_lengths": [146, 150, 150, 150, 150, 150, 150, 103, 150, 150, 80, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 113, 150, 70, 150, 150, 105, 150, 94, 112, 150, 150, 150, 150, 150, 150, 108, 118, 150, 150, 150, 150, 150, 150, 150, 150, 131, 80, 88, 150, 150, 150, 150, 83, 61, 150, 146, 74, 150, 150, 66, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 48, 150, 135, 150, 150, 150, 150, 52, 150, 150, 67, 150, 150, 150, 128, 150, 150, 150, 107, 74], "policy_policy_0_reward": [-349.13659635110685, -1163.8238255751946, -744.8002299807564, -427.4610930810409, -1121.3578799158768, -865.8084675665035, -308.7145768905253, -289.0642889847558, -769.3610365888359, -1218.551583772465, -216.13764849455322, -1490.0248143109268, -461.60634617159377, -1172.8325561163106, -164.62125700745574, -974.2014013270552, -591.0132677472147, -723.64184275885, -1171.0144252519192, -383.09464102624815, -572.8351884626688, -544.4803948587088, -754.9785396377706, -904.8380291361518, -708.241989435858, -1181.7302164654245, -248.73729020322241, -1125.996318037121, -43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5880720449671898, "mean_inference_ms": 1.8274002288087339, "mean_action_processing_ms": 0.29595869628303645, "mean_env_wait_ms": 3.2653533189854107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012635231018066406, "StateBufferConnector_ms": 0.007938623428344727, "ViewRequirementAgentConnector_ms": 0.19115042686462402}, "num_episodes": 29, "episode_return_max": -27.08974418293697, "episode_return_min": -1509.3445127905952, "episode_return_mean": -714.4382515633322, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.2460470418066, "num_env_steps_trained_throughput_per_sec": 332.2460470418066, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 12298.969, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12298.888, "sample_time_ms": 1388.214, "learn_time_ms": 10832.423, "learn_throughput": 369.262, "synch_weights_time_ms": 77.338}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "3541f_00000", "date": "2024-08-03_02-58-42", "timestamp": 1722634122, "time_this_iter_s": 12.056611776351929, "time_total_s": 833.1493945121765, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 833.1493945121765, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 50.65882352941176, "ram_util_percent": 30.164705882352937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 265.31597156127293, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.659486330052217, "policy_loss": -0.015284060885217816, "vf_loss": 4.673708529025316, "vf_explained_var": 0.973718584018449, "kl": 0.011303872007799025, "entropy": 2.0766633513073125, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -27.08974418293697, "episode_reward_min": -1509.3445127905952, "episode_reward_mean": -692.1369621064275, "episode_len_mean": 133.03, "episode_media": {}, "episodes_timesteps_total": 13303, "policy_reward_min": {"policy_0": -1509.3445127905952}, "policy_reward_max": {"policy_0": -27.08974418293697}, "policy_reward_mean": {"policy_0": -692.1369621064275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592], "episode_lengths": [70, 150, 150, 105, 150, 94, 112, 150, 150, 150, 150, 150, 150, 108, 118, 150, 150, 150, 150, 150, 150, 150, 150, 131, 80, 88, 150, 150, 150, 150, 83, 61, 150, 146, 74, 150, 150, 66, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 48, 150, 135, 150, 150, 150, 150, 52, 150, 150, 67, 150, 150, 150, 128, 150, 150, 150, 107, 74, 150, 150, 150, 134, 150, 150, 150, 150, 150, 122, 126, 104, 150, 150, 150, 69, 150, 150, 150, 150, 91, 150, 95, 150, 150, 150, 115, 150], "policy_policy_0_reward": [-43.04116779227148, -1055.3170537164083, -859.1090633169636, -378.9524792166704, -630.9649467673697, -262.5783062958421, -380.15526389827744, -1090.633555125663, -1051.0312699329136, -733.1184659596249, -590.238233171779, -364.36013216484287, -471.36697005475844, -244.54290625782835, -368.90136185527837, -524.1811949960804, -718.7856274238522, -737.749311844737, -948.9426870386835, -748.6314923295861, -1377.2086559241304, -1509.3445127905952, -1114.3338460807643, -611.7633998376648, -153.85161583385354, -161.8536369793394, -931.4149721019845, -822.9768335113257, -1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5892708373339753, "mean_inference_ms": 1.8327063304111744, "mean_action_processing_ms": 0.29677950923668467, "mean_env_wait_ms": 3.2762391232949217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024147748947143555, "StateBufferConnector_ms": 0.008106231689453125, "ViewRequirementAgentConnector_ms": 0.22570013999938965}, "num_episodes": 28, "episode_return_max": -27.08974418293697, "episode_return_min": -1509.3445127905952, "episode_return_mean": -692.1369621064275, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.42571785406955, "num_env_steps_trained_throughput_per_sec": 286.42571785406955, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 12857.294, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12857.211, "sample_time_ms": 1541.055, "learn_time_ms": 11237.826, "learn_throughput": 355.941, "synch_weights_time_ms": 77.415}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "3541f_00000", "date": "2024-08-03_02-58-56", "timestamp": 1722634136, "time_this_iter_s": 13.973073244094849, "time_total_s": 847.1224677562714, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0710430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.1224677562714, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 80.45, "ram_util_percent": 42.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 296.7377241929372, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.57461153442661, "policy_loss": -0.00814350735017797, "vf_loss": 4.583002103120089, "vf_explained_var": 0.9791541959469517, "kl": 0.009567631539630384, "entropy": 1.98686018101871, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -27.08974418293697, "episode_reward_min": -1560.342687551192, "episode_reward_mean": -701.1802997085151, "episode_len_mean": 134.13, "episode_media": {}, "episodes_timesteps_total": 13413, "policy_reward_min": {"policy_0": -1560.342687551192}, "policy_reward_max": {"policy_0": -27.08974418293697}, "policy_reward_mean": {"policy_0": -701.1802997085151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657], "episode_lengths": [150, 150, 83, 61, 150, 146, 74, 150, 150, 66, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 48, 150, 135, 150, 150, 150, 150, 52, 150, 150, 67, 150, 150, 150, 128, 150, 150, 150, 107, 74, 150, 150, 150, 134, 150, 150, 150, 150, 150, 122, 126, 104, 150, 150, 150, 69, 150, 150, 150, 150, 91, 150, 95, 150, 150, 150, 115, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 121, 150, 150, 115, 66, 150, 150, 150, 150, 150, 150, 146, 90], "policy_policy_0_reward": [-1262.9815086914073, -1285.3440449636798, -108.0120397480855, -89.86146809227299, -1202.5483511840212, -718.9390861139452, -126.3300473637119, -414.2308520546257, -953.6364430592204, -66.6353784144772, -811.1554442362831, -841.2516941935222, -76.5808104677405, -374.62296098055316, -1250.9381489919294, -1115.8517646416856, -1389.2726392995344, -833.4874203167334, -598.6930198015484, -910.0541809379293, -997.6956705870781, -289.7101892313601, -621.8253537438267, -970.782220727157, -27.08974418293697, -1115.8032168558316, -590.4057791184742, -1039.85985475536, -872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5911520490215898, "mean_inference_ms": 1.8395576303937093, "mean_action_processing_ms": 0.29777694649523206, "mean_env_wait_ms": 3.2868838516189633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02742791175842285, "StateBufferConnector_ms": 0.008095026016235352, "ViewRequirementAgentConnector_ms": 0.22655153274536133}, "num_episodes": 28, "episode_return_max": -27.08974418293697, "episode_return_min": -1560.342687551192, "episode_return_mean": -701.1802997085151, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.25876815969775, "num_env_steps_trained_throughput_per_sec": 292.25876815969775, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 13030.406, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13030.323, "sample_time_ms": 1541.208, "learn_time_ms": 11409.021, "learn_throughput": 350.6, "synch_weights_time_ms": 79.133}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "3541f_00000", "date": "2024-08-03_02-59-10", "timestamp": 1722634150, "time_this_iter_s": 13.699997425079346, "time_total_s": 860.8224651813507, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 860.8224651813507, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 21.915789473684214, "ram_util_percent": 46.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 291.89469999869664, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.740384061386188, "policy_loss": -0.006574917615701755, "vf_loss": 4.745045228799184, "vf_explained_var": 0.9811555391798417, "kl": 0.011009804420700675, "entropy": 1.8467352497080962, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -67.680732969966, "episode_reward_min": -1560.342687551192, "episode_reward_mean": -697.6279540240212, "episode_len_mean": 137.52, "episode_media": {}, "episodes_timesteps_total": 13752, "policy_reward_min": {"policy_0": -1560.342687551192}, "policy_reward_max": {"policy_0": -67.680732969966}, "policy_reward_mean": {"policy_0": -697.6279540240212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766], "episode_lengths": [150, 150, 150, 52, 150, 150, 67, 150, 150, 150, 128, 150, 150, 150, 107, 74, 150, 150, 150, 134, 150, 150, 150, 150, 150, 122, 126, 104, 150, 150, 150, 69, 150, 150, 150, 150, 91, 150, 95, 150, 150, 150, 115, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 121, 150, 150, 115, 66, 150, 150, 150, 150, 150, 150, 146, 90, 150, 84, 150, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 125, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-872.7092611786364, -576.867529084571, -1037.7292009700493, -82.17907729677957, -1352.9505018260581, -780.377484485787, -215.74769144523052, -1265.784545523962, -1364.8607233299674, -606.6285484955001, -394.37166535415315, -871.9255465642123, -1070.8510503430527, -964.9427073739869, -262.57498385622057, -106.2705990748985, -951.4635955552579, -889.0532165932532, -592.4068194574971, -439.9759476773884, -585.924070308623, -801.3583181967472, -537.2694274884743, -1109.6624637091663, -717.8460026087962, -256.76922916915515, -362.94873561700126, -183.38095047025232, -1098.8429944449053, -649.5489183914702, -839.7746034232397, -103.0041364861493, -1022.5249519403791, -603.8103375208914, -1423.3550658100721, -1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5939909471143361, "mean_inference_ms": 1.84763965533422, "mean_action_processing_ms": 0.29890808219576015, "mean_env_wait_ms": 3.298260244757834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02711343765258789, "StateBufferConnector_ms": 0.008059263229370117, "ViewRequirementAgentConnector_ms": 0.2291877269744873}, "num_episodes": 28, "episode_return_max": -67.680732969966, "episode_return_min": -1560.342687551192, "episode_return_mean": -697.6279540240212, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.0672175979393, "num_env_steps_trained_throughput_per_sec": 322.0672175979393, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 13123.346, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13123.261, "sample_time_ms": 1565.499, "learn_time_ms": 11481.27, "learn_throughput": 348.394, "synch_weights_time_ms": 75.598}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "3541f_00000", "date": "2024-08-03_02-59-23", "timestamp": 1722634163, "time_this_iter_s": 12.431409120559692, "time_total_s": 873.2538743019104, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 873.2538743019104, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 37.77222222222222, "ram_util_percent": 46.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 240.97433413863183, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.138192618141572, "policy_loss": -0.010153455116960686, "vf_loss": 5.148364910483361, "vf_explained_var": 0.9673518366490801, "kl": 0.009359831974749546, "entropy": 1.899130922059218, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -16.159945736866888, "episode_reward_min": -1560.342687551192, "episode_reward_mean": -663.7043587846005, "episode_len_mean": 137.81, "episode_media": {}, "episodes_timesteps_total": 13781, "policy_reward_min": {"policy_0": -1560.342687551192}, "policy_reward_max": {"policy_0": -16.159945736866888}, "policy_reward_mean": {"policy_0": -663.7043587846005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392], "episode_lengths": [150, 91, 150, 95, 150, 150, 150, 115, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 121, 150, 150, 115, 66, 150, 150, 150, 150, 150, 150, 146, 90, 150, 84, 150, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 125, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 128, 150, 150, 150, 150, 150, 150, 90, 150, 119, 150, 150, 150, 114, 130, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 57, 82, 125], "policy_policy_0_reward": [-1194.5883408899854, -178.72454348242425, -700.383902984021, -195.78005026848402, -839.6442162571982, -936.8928200088361, -481.44608679428256, -373.4830479640344, -348.1140059476592, -1560.342687551192, -454.4959940172445, -523.8029696500718, -187.54172205472156, -647.1393582946065, -335.8421585253732, -1152.1774332062264, -1310.15698394267, -767.5949712150432, -929.0701153666766, -420.14410475627324, -710.8518783343125, -904.417650333655, -1222.8401101497313, -382.47757760589, -424.167626208787, -1172.4543418053618, -962.9635784803103, -358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5946807912531749, "mean_inference_ms": 1.8489755173469866, "mean_action_processing_ms": 0.2991103534143918, "mean_env_wait_ms": 3.296958056831293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015303850173950195, "StateBufferConnector_ms": 0.007988214492797852, "ViewRequirementAgentConnector_ms": 0.21899175643920898}, "num_episodes": 35, "episode_return_max": -16.159945736866888, "episode_return_min": -1560.342687551192, "episode_return_mean": -663.7043587846005, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.470023581989, "num_env_steps_trained_throughput_per_sec": 279.470023581989, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 13175.721, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13175.64, "sample_time_ms": 1440.118, "learn_time_ms": 11664.439, "learn_throughput": 342.923, "synch_weights_time_ms": 70.206}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "3541f_00000", "date": "2024-08-03_02-59-37", "timestamp": 1722634177, "time_this_iter_s": 14.325274229049683, "time_total_s": 887.5791485309601, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073b880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 887.5791485309601, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 22.184999999999995, "ram_util_percent": 46.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 263.25978565216064, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.912171143790086, "policy_loss": -0.006849258718527078, "vf_loss": 4.919028014441332, "vf_explained_var": 0.9631744282320142, "kl": 0.010700132186320844, "entropy": 2.1682978089898826, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -16.159945736866888, "episode_reward_min": -1444.8721226430957, "episode_reward_mean": -682.122551874294, "episode_len_mean": 137.39, "episode_media": {}, "episodes_timesteps_total": 13739, "policy_reward_min": {"policy_0": -1444.8721226430957}, "policy_reward_max": {"policy_0": -16.159945736866888}, "policy_reward_mean": {"policy_0": -682.122551874294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287], "episode_lengths": [115, 66, 150, 150, 150, 150, 150, 150, 146, 90, 150, 84, 150, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 125, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 128, 150, 150, 150, 150, 150, 150, 90, 150, 119, 150, 150, 150, 114, 130, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 57, 82, 125, 150, 135, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 131, 129, 129, 140, 150, 150, 150, 150, 91, 150, 150, 59, 150, 126], "policy_policy_0_reward": [-358.2618844478188, -67.680732969966, -1063.852579991349, -646.9077388134668, -566.2713376349423, -481.71537131067026, -1326.853655657473, -588.1276286944869, -450.31064663388923, -171.2198847756657, -884.2310733496535, -157.30260646881175, -857.561325074415, -395.9578136855095, -1290.5740851829428, -558.4872866731419, -124.44568216376103, -926.2312993023221, -862.4694339629058, -217.37598116929948, -1308.2267700027567, -950.369652272652, -645.2275122857865, -581.148594303704, -1157.645740369628, -958.5268833017842, -579.7785768699242, -673.4179844332158, -904.8551068348921, -328.7295605182997, -463.1996403924538, -469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.594678576256943, "mean_inference_ms": 1.847636616805215, "mean_action_processing_ms": 0.29916054734406694, "mean_env_wait_ms": 3.295973730343746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015164852142333984, "StateBufferConnector_ms": 0.00787353515625, "ViewRequirementAgentConnector_ms": 0.19186973571777344}, "num_episodes": 27, "episode_return_max": -16.159945736866888, "episode_return_min": -1444.8721226430957, "episode_return_mean": -682.122551874294, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.54115313768193, "num_env_steps_trained_throughput_per_sec": 298.54115313768193, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 13009.371, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13009.295, "sample_time_ms": 1348.619, "learn_time_ms": 11590.099, "learn_throughput": 345.122, "synch_weights_time_ms": 69.712}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "3541f_00000", "date": "2024-08-03_02-59-50", "timestamp": 1722634190, "time_this_iter_s": 13.410333633422852, "time_total_s": 900.9894821643829, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 900.9894821643829, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.37500000000001, "ram_util_percent": 46.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 309.9008153398832, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.832900836567084, "policy_loss": -0.010564424724725541, "vf_loss": 4.84365926583608, "vf_explained_var": 0.9806959970543782, "kl": 0.009853641557250133, "entropy": 2.034164296214779, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -16.159945736866888, "episode_reward_min": -1444.8721226430957, "episode_reward_mean": -670.2780747045998, "episode_len_mean": 135.02, "episode_media": {}, "episodes_timesteps_total": 13502, "policy_reward_min": {"policy_0": -1444.8721226430957}, "policy_reward_max": {"policy_0": -16.159945736866888}, "policy_reward_mean": {"policy_0": -670.2780747045998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 128, 150, 150, 150, 150, 150, 150, 90, 150, 119, 150, 150, 150, 114, 130, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 57, 82, 125, 150, 135, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 131, 129, 129, 140, 150, 150, 150, 150, 91, 150, 150, 59, 150, 126, 150, 150, 150, 51, 150, 111, 81, 150, 126, 70, 150, 150, 75, 150, 150, 150, 150, 124, 150, 150, 150, 150, 121, 150, 150, 59, 150, 88, 150, 150, 76], "policy_policy_0_reward": [-469.1760049419535, -1333.082426291551, -681.9564957002356, -449.3471359988589, -667.7813180609209, -636.6749187913683, -664.5838559027766, -521.7999562995108, -827.8196213355968, -774.5976520558652, -494.85132264730913, -274.051201954696, -560.9589704760505, -455.9607093766563, -996.1908819851965, -1225.5002941011976, -955.0359479245204, -785.6088093897341, -639.0438820253561, -518.5342344290666, -195.1899241311874, -1080.7133936143218, -456.6097028869206, -860.2120603915027, -635.1140819851663, -849.170043232273, -284.83177899341484, -536.9371092399196, -1077.10623192833, -751.4142491866243, -236.21466598177602, -800.9130881531794, -929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5945470439376987, "mean_inference_ms": 1.8471206846740165, "mean_action_processing_ms": 0.2989809396156893, "mean_env_wait_ms": 3.294048113982247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011597394943237305, "StateBufferConnector_ms": 0.00787210464477539, "ViewRequirementAgentConnector_ms": 0.2009270191192627}, "num_episodes": 31, "episode_return_max": -16.159945736866888, "episode_return_min": -1444.8721226430957, "episode_return_mean": -670.2780747045998, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.15478072239176, "num_env_steps_trained_throughput_per_sec": 279.15478072239176, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13065.157, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13065.08, "sample_time_ms": 1349.374, "learn_time_ms": 11643.695, "learn_throughput": 343.534, "synch_weights_time_ms": 71.153}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "3541f_00000", "date": "2024-08-03_03-00-05", "timestamp": 1722634205, "time_this_iter_s": 14.341926336288452, "time_total_s": 915.3314085006714, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0738700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 915.3314085006714, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 22.065000000000005, "ram_util_percent": 46.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 246.18814484477042, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.542968735595545, "policy_loss": -0.004553391560330055, "vf_loss": 5.54122206022342, "vf_explained_var": 0.9680211993555228, "kl": 0.015058717036542173, "entropy": 1.789377413317561, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -6.215297360949678, "episode_reward_min": -1517.935136004028, "episode_reward_mean": -617.4789446540261, "episode_len_mean": 127.94, "episode_media": {}, "episodes_timesteps_total": 12794, "policy_reward_min": {"policy_0": -1517.935136004028}, "policy_reward_max": {"policy_0": -6.215297360949678}, "policy_reward_mean": {"policy_0": -617.4789446540261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 57, 82, 125, 150, 135, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 131, 129, 129, 140, 150, 150, 150, 150, 91, 150, 150, 59, 150, 126, 150, 150, 150, 51, 150, 111, 81, 150, 126, 70, 150, 150, 75, 150, 150, 150, 150, 124, 150, 150, 150, 150, 121, 150, 150, 59, 150, 88, 150, 150, 76, 116, 145, 69, 150, 150, 150, 150, 150, 119, 150, 150, 71, 112, 130, 150, 150, 150, 150, 53, 84, 150, 39, 146, 112, 77, 150, 150, 132, 119, 48, 49, 69], "policy_policy_0_reward": [-929.7555006167916, -412.2319699042082, -375.32052689173855, -630.5316368661321, -494.31478400703656, -806.646200918287, -597.7452751373163, -16.159945736866888, -195.49806775253015, -350.7476555734392, -815.5545549594968, -611.8006044366564, -1120.1997013395958, -1122.2167886116708, -1413.7646176727699, -83.59823366070323, -785.2027786320431, -948.0961394175262, -1439.015093881005, -750.7012725286698, -1195.3982110349336, -406.1609309409586, -845.2023887590254, -243.90034894092025, -698.161263116372, -525.0965086919521, -726.9479652126197, -771.8361134998706, -681.4026518743713, -599.5010878120369, -1241.6071295998042, -220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.593487069086574, "mean_inference_ms": 1.8440033004272494, "mean_action_processing_ms": 0.2985311332375329, "mean_env_wait_ms": 3.2907844921204927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907577514648438, "StateBufferConnector_ms": 0.007867813110351562, "ViewRequirementAgentConnector_ms": 0.20589876174926758}, "num_episodes": 32, "episode_return_max": -6.215297360949678, "episode_return_min": -1517.935136004028, "episode_return_mean": -617.4789446540261, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.3275309254105, "num_env_steps_trained_throughput_per_sec": 298.3275309254105, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 13005.488, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13005.404, "sample_time_ms": 1346.496, "learn_time_ms": 11586.376, "learn_throughput": 345.233, "synch_weights_time_ms": 71.688}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "3541f_00000", "date": "2024-08-03_03-00-18", "timestamp": 1722634218, "time_this_iter_s": 13.421322345733643, "time_total_s": 928.752730846405, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 928.752730846405, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 43.631578947368425, "ram_util_percent": 46.84210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 322.2643231153488, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.947758052994808, "policy_loss": -0.015013157054878927, "vf_loss": 4.962203288823366, "vf_explained_var": 0.9861468113337953, "kl": 0.01027062530995129, "entropy": 1.9662158338973919, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": -6.215297360949678, "episode_reward_min": -1517.935136004028, "episode_reward_mean": -591.2197428754122, "episode_len_mean": 124.84, "episode_media": {}, "episodes_timesteps_total": 12484, "policy_reward_min": {"policy_0": -1517.935136004028}, "policy_reward_max": {"policy_0": -6.215297360949678}, "policy_reward_mean": {"policy_0": -591.2197428754122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987], "episode_lengths": [91, 150, 150, 59, 150, 126, 150, 150, 150, 51, 150, 111, 81, 150, 126, 70, 150, 150, 75, 150, 150, 150, 150, 124, 150, 150, 150, 150, 121, 150, 150, 59, 150, 88, 150, 150, 76, 116, 145, 69, 150, 150, 150, 150, 150, 119, 150, 150, 71, 112, 130, 150, 150, 150, 150, 53, 84, 150, 39, 146, 112, 77, 150, 150, 132, 119, 48, 49, 69, 61, 150, 123, 83, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 45, 105, 142, 150, 150, 74, 91, 150, 150, 150, 150, 84, 150, 150], "policy_policy_0_reward": [-220.36686719664263, -600.2020217955061, -1378.0401905740168, -56.03679896284673, -1444.8721226430957, -434.4751992693287, -1203.0315850018844, -1238.0498592647505, -1007.0270816894589, -99.21185907924875, -573.300930361578, -449.0877963610966, -100.62349614229564, -299.3075368484695, -216.64031136965318, -61.215706223855605, -1189.4536158102749, -388.69148715212276, -166.9652941236427, -906.9108765434669, -656.8472105624357, -1396.3051358801615, -507.19203631687816, -473.63519237116367, -770.6808342384783, -943.1251963680481, -645.0582305066647, -1122.9435841214513, -559.1149640179458, -342.17474145684895, -765.4878279213669, -73.52214836114828, -853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5931608650277469, "mean_inference_ms": 1.8432921492980865, "mean_action_processing_ms": 0.2983178082875931, "mean_env_wait_ms": 3.291348352380709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01191401481628418, "StateBufferConnector_ms": 0.008112430572509766, "ViewRequirementAgentConnector_ms": 0.20564794540405273}, "num_episodes": 31, "episode_return_max": -6.215297360949678, "episode_return_min": -1517.935136004028, "episode_return_mean": -591.2197428754122, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.7256271452842, "num_env_steps_trained_throughput_per_sec": 292.7256271452842, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 13371.434, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13371.349, "sample_time_ms": 1345.321, "learn_time_ms": 11950.578, "learn_throughput": 334.712, "synch_weights_time_ms": 74.589}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "3541f_00000", "date": "2024-08-03_03-00-32", "timestamp": 1722634232, "time_this_iter_s": 13.67789912223816, "time_total_s": 942.4306299686432, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 942.4306299686432, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 22.145, "ram_util_percent": 46.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 240.21008372505506, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.847767872363329, "policy_loss": -0.010844877758063375, "vf_loss": 4.857891006767749, "vf_explained_var": 0.9800063621252775, "kl": 0.01037039646850341, "entropy": 1.9556503819922606, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -6.215297360949678, "episode_reward_min": -1517.935136004028, "episode_reward_mean": -588.7679934265514, "episode_len_mean": 124.9, "episode_media": {}, "episodes_timesteps_total": 12490, "policy_reward_min": {"policy_0": -1517.935136004028}, "policy_reward_max": {"policy_0": -6.215297360949678}, "policy_reward_mean": {"policy_0": -588.7679934265514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756], "episode_lengths": [150, 88, 150, 150, 76, 116, 145, 69, 150, 150, 150, 150, 150, 119, 150, 150, 71, 112, 130, 150, 150, 150, 150, 53, 84, 150, 39, 146, 112, 77, 150, 150, 132, 119, 48, 49, 69, 61, 150, 123, 83, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 45, 105, 142, 150, 150, 74, 91, 150, 150, 150, 150, 84, 150, 150, 150, 116, 102, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 87, 150, 58, 150, 150, 150, 150, 106, 57, 97, 126, 56, 150, 107, 150, 150, 150, 150, 63], "policy_policy_0_reward": [-853.473984427572, -112.31347110996069, -906.2556055235232, -1128.1603552586582, -206.7083981640614, -382.7696338493357, -784.8358018196993, -68.2975180468441, -337.8291655326913, -1517.935136004028, -619.8531330551609, -1073.0231748641904, -1084.841751656153, -621.1586581141117, -739.3744819767943, -976.4647473783579, -114.03739944947107, -307.0940320547777, -276.67859399522774, -1031.5567507864118, -553.5817493017538, -819.4135431889756, -1099.8209886243894, -36.82448903003343, -224.95831756055853, -421.4851600175054, -6.215297360949678, -305.1697297428198, -290.9527617373115, -126.52866711864456, -581.3186166063323, -895.0061015464352, -466.99549831217576, -333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5923667936391647, "mean_inference_ms": 1.8409180662209204, "mean_action_processing_ms": 0.2980980988657807, "mean_env_wait_ms": 3.287531867659137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012020587921142578, "StateBufferConnector_ms": 0.00819087028503418, "ViewRequirementAgentConnector_ms": 0.19707775115966797}, "num_episodes": 32, "episode_return_max": -6.215297360949678, "episode_return_min": -1517.935136004028, "episode_return_mean": -588.7679934265514, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.7997823893907, "num_env_steps_trained_throughput_per_sec": 341.7997823893907, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 13292.669, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13292.584, "sample_time_ms": 1354.532, "learn_time_ms": 11863.422, "learn_throughput": 337.171, "synch_weights_time_ms": 73.769}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "3541f_00000", "date": "2024-08-03_03-00-44", "timestamp": 1722634244, "time_this_iter_s": 11.713593006134033, "time_total_s": 954.1442229747772, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f0711870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 954.1442229747772, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 40.95625, "ram_util_percent": 46.912499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.35367882847785, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.04894830584526, "policy_loss": -0.013282467414198133, "vf_loss": 5.061784883091847, "vf_explained_var": 0.9749052168801426, "kl": 0.010051048856864024, "entropy": 1.9461582095672687, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -17.581429991346393, "episode_reward_min": -1525.3736012956617, "episode_reward_mean": -604.6157608770441, "episode_len_mean": 126.48, "episode_media": {}, "episodes_timesteps_total": 12648, "policy_reward_min": {"policy_0": -1525.3736012956617}, "policy_reward_max": {"policy_0": -17.581429991346393}, "policy_reward_mean": {"policy_0": -604.6157608770441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403], "episode_lengths": [119, 48, 49, 69, 61, 150, 123, 83, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 45, 105, 142, 150, 150, 74, 91, 150, 150, 150, 150, 84, 150, 150, 150, 116, 102, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 87, 150, 58, 150, 150, 150, 150, 106, 57, 97, 126, 56, 150, 107, 150, 150, 150, 150, 63, 85, 69, 150, 150, 124, 150, 150, 150, 150, 137, 97, 150, 150, 150, 114, 93, 150, 150, 150, 108, 75, 150, 150, 83, 150, 150, 150, 150, 103, 150, 39, 150, 150], "policy_policy_0_reward": [-333.19858644228003, -60.346406807281134, -81.3919079711243, -178.1111644038319, -120.78939839462514, -605.4130125974954, -457.48825078142727, -243.10590335142484, -488.7472630340117, -97.79467724007186, -1182.2619372189977, -1162.8983585174897, -1201.4261969674728, -1221.9756222244703, -779.6793320396818, -714.967939748104, -654.7404613368445, -807.2991472239498, -1084.2527669438462, -1044.476810874158, -208.86516688118635, -20.304177054110188, -265.6903344999462, -328.47280610914254, -1109.1332023036523, -567.061950833045, -171.56966575112205, -183.4216502201844, -336.3832961297695, -672.0885960741484, -1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5924247292502498, "mean_inference_ms": 1.8407186088627492, "mean_action_processing_ms": 0.29801408924850875, "mean_env_wait_ms": 3.2867428475625786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011813640594482422, "StateBufferConnector_ms": 0.00820016860961914, "ViewRequirementAgentConnector_ms": 0.19220685958862305}, "num_episodes": 33, "episode_return_max": -17.581429991346393, "episode_return_min": -1525.3736012956617, "episode_return_mean": -604.6157608770441, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.0766098767938, "num_env_steps_trained_throughput_per_sec": 290.0766098767938, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 13467.688, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13467.604, "sample_time_ms": 1365.15, "learn_time_ms": 12031.891, "learn_throughput": 332.45, "synch_weights_time_ms": 69.73}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "3541f_00000", "date": "2024-08-03_03-00-58", "timestamp": 1722634258, "time_this_iter_s": 13.801854848861694, "time_total_s": 967.9460778236389, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.9460778236389, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 22.340000000000003, "ram_util_percent": 46.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 259.27535178661344, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.157295164217552, "policy_loss": -0.01482398632603387, "vf_loss": 5.1708125953873, "vf_explained_var": 0.9866805179665487, "kl": 0.010886659303105261, "entropy": 1.9432381824900706, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": -12.828275015993682, "episode_reward_min": -1525.3736012956617, "episode_reward_mean": -611.8604024639769, "episode_len_mean": 128.87, "episode_media": {}, "episodes_timesteps_total": 12887, "policy_reward_min": {"policy_0": -1525.3736012956617}, "policy_reward_max": {"policy_0": -12.828275015993682}, "policy_reward_mean": {"policy_0": -611.8604024639769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085], "episode_lengths": [150, 150, 84, 150, 150, 150, 116, 102, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 87, 150, 58, 150, 150, 150, 150, 106, 57, 97, 126, 56, 150, 107, 150, 150, 150, 150, 63, 85, 69, 150, 150, 124, 150, 150, 150, 150, 137, 97, 150, 150, 150, 114, 93, 150, 150, 150, 108, 75, 150, 150, 83, 150, 150, 150, 150, 103, 150, 39, 150, 150, 150, 82, 115, 42, 150, 150, 78, 150, 87, 150, 150, 150, 86, 150, 150, 122, 150, 150, 150, 51, 150, 150, 150, 150, 120, 150, 150, 150, 150, 43], "policy_policy_0_reward": [-1155.065940605816, -632.0650731360122, -161.21160855424262, -569.1525098933101, -960.5927136261987, -1236.2463730032362, -428.40775960342074, -195.30103809835074, -850.592892705128, -673.166044906823, -558.9760311190029, -1015.6752601727728, -737.3325901667918, -968.9753783251381, -689.6419088959627, -550.4131580985403, -1159.6954179041231, -398.17446284248274, -107.71220832687236, -683.6878624784886, -69.11448615154687, -1133.0478646553743, -1143.2750579827182, -617.412866054481, -817.3128189318516, -351.4001294208099, -38.987807754423294, -258.83351498050956, -257.7423568860477, -49.03872462068718, -863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5925118430599352, "mean_inference_ms": 1.8404084960541092, "mean_action_processing_ms": 0.29838448614865354, "mean_env_wait_ms": 3.2870145623183156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011962413787841797, "StateBufferConnector_ms": 0.008150815963745117, "ViewRequirementAgentConnector_ms": 0.20557475090026855}, "num_episodes": 30, "episode_return_max": -12.828275015993682, "episode_return_min": -1525.3736012956617, "episode_return_mean": -611.8604024639769, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.23766826359537, "num_env_steps_trained_throughput_per_sec": 308.23766826359537, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 13368.865, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13368.782, "sample_time_ms": 1221.937, "learn_time_ms": 12074.044, "learn_throughput": 331.289, "synch_weights_time_ms": 71.966}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "3541f_00000", "date": "2024-08-03_03-01-11", "timestamp": 1722634271, "time_this_iter_s": 12.990755081176758, "time_total_s": 980.9368329048157, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 980.9368329048157, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 39.205555555555556, "ram_util_percent": 46.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 264.2969773213069, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.161118833223979, "policy_loss": -0.014929900965459335, "vf_loss": 5.174757759273052, "vf_explained_var": 0.9815760188425581, "kl": 0.010649529288396823, "entropy": 1.8983353120585282, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -12.828275015993682, "episode_reward_min": -1525.3736012956617, "episode_reward_mean": -616.972657231216, "episode_len_mean": 130.0, "episode_media": {}, "episodes_timesteps_total": 13000, "policy_reward_min": {"policy_0": -1525.3736012956617}, "policy_reward_max": {"policy_0": -12.828275015993682}, "policy_reward_mean": {"policy_0": -616.972657231216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477], "episode_lengths": [150, 107, 150, 150, 150, 150, 63, 85, 69, 150, 150, 124, 150, 150, 150, 150, 137, 97, 150, 150, 150, 114, 93, 150, 150, 150, 108, 75, 150, 150, 83, 150, 150, 150, 150, 103, 150, 39, 150, 150, 150, 82, 115, 42, 150, 150, 78, 150, 87, 150, 150, 150, 86, 150, 150, 122, 150, 150, 150, 51, 150, 150, 150, 150, 120, 150, 150, 150, 150, 43, 134, 150, 150, 150, 150, 61, 150, 150, 101, 150, 144, 150, 150, 150, 150, 64, 108, 149, 150, 112, 150, 150, 150, 122, 150, 150, 97, 82, 103, 150], "policy_policy_0_reward": [-863.3438699308855, -301.5389138158147, -601.032466548327, -1330.6495791587517, -914.048109612673, -991.0795335651791, -52.56630693252756, -182.73374148586876, -92.08191261317324, -585.5819542174875, -940.5726527015902, -377.01872131367134, -394.2252621880126, -1124.9978089047124, -735.587763126562, -1525.3736012956617, -749.8462335954189, -382.1962241585698, -926.2579949818959, -1172.800178291776, -1505.4898855043425, -255.81544400101043, -269.2399712006216, -617.6076036226245, -331.75114966028093, -629.254774272923, -315.82630410321735, -190.2062325607561, -552.0707391782222, -673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5927586381077143, "mean_inference_ms": 1.8407599915597015, "mean_action_processing_ms": 0.2982258519894728, "mean_env_wait_ms": 3.288360070469939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204991340637207, "StateBufferConnector_ms": 0.008072614669799805, "ViewRequirementAgentConnector_ms": 0.20990681648254395}, "num_episodes": 30, "episode_return_max": -12.828275015993682, "episode_return_min": -1525.3736012956617, "episode_return_mean": -616.972657231216, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.3651876246792, "num_env_steps_trained_throughput_per_sec": 280.3651876246792, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 13426.925, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13426.843, "sample_time_ms": 1228.833, "learn_time_ms": 12126.882, "learn_throughput": 329.846, "synch_weights_time_ms": 70.337}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "3541f_00000", "date": "2024-08-03_03-01-25", "timestamp": 1722634285, "time_this_iter_s": 14.279608249664307, "time_total_s": 995.21644115448, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f83760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 995.21644115448, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.18095238095238, "ram_util_percent": 47.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 293.3214990019798, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.868364347765843, "policy_loss": -0.010568077388355353, "vf_loss": 4.877686836322149, "vf_explained_var": 0.9790813074757655, "kl": 0.011439421115092803, "entropy": 2.067364711686969, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": -12.819101617452786, "episode_reward_min": -1446.3661619937159, "episode_reward_mean": -625.3419443937248, "episode_len_mean": 130.58, "episode_media": {}, "episodes_timesteps_total": 13058, "policy_reward_min": {"policy_0": -1446.3661619937159}, "policy_reward_max": {"policy_0": -12.819101617452786}, "policy_reward_mean": {"policy_0": -625.3419443937248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335], "episode_lengths": [150, 83, 150, 150, 150, 150, 103, 150, 39, 150, 150, 150, 82, 115, 42, 150, 150, 78, 150, 87, 150, 150, 150, 86, 150, 150, 122, 150, 150, 150, 51, 150, 150, 150, 150, 120, 150, 150, 150, 150, 43, 134, 150, 150, 150, 150, 61, 150, 150, 101, 150, 144, 150, 150, 150, 150, 64, 108, 149, 150, 112, 150, 150, 150, 122, 150, 150, 97, 82, 103, 150, 150, 150, 150, 77, 150, 109, 150, 150, 150, 63, 150, 150, 150, 150, 150, 43, 150, 150, 150, 103, 122, 126, 37, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-673.4448388680053, -175.41622194160954, -553.0378687027026, -629.5276010659572, -1009.7178658766011, -848.5721196971873, -364.58892672108936, -750.3495811197347, -17.581429991346393, -910.9020502281484, -766.034801073403, -435.239460378816, -119.61463087445881, -364.23681245454634, -12.828275015993682, -574.0653727727358, -786.4023841235136, -238.80534121934747, -1149.515203809216, -253.7390253948141, -947.4436942732436, -952.8872156723894, -1203.3418452418484, -105.91698265310397, -620.6588546590915, -663.5284600687709, -199.34584493025804, -1147.463109847906, -520.872150686147, -678.3132853363272, -45.28884934893682, -584.683522963942, -500.691180668419, -547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5920777896394486, "mean_inference_ms": 1.8377800863428222, "mean_action_processing_ms": 0.2977755503142622, "mean_env_wait_ms": 3.2847568142744006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217521667480469, "StateBufferConnector_ms": 0.008134841918945312, "ViewRequirementAgentConnector_ms": 0.21901917457580566}, "num_episodes": 29, "episode_return_max": -12.819101617452786, "episode_return_min": -1446.3661619937159, "episode_return_mean": -625.3419443937248, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.2845256710315, "num_env_steps_trained_throughput_per_sec": 324.2845256710315, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 13418.433, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13418.353, "sample_time_ms": 1221.898, "learn_time_ms": 12125.493, "learn_throughput": 329.883, "synch_weights_time_ms": 70.173}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "3541f_00000", "date": "2024-08-03_03-01-37", "timestamp": 1722634297, "time_this_iter_s": 12.348729133605957, "time_total_s": 1007.5651702880859, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1007.5651702880859, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 46.66470588235295, "ram_util_percent": 47.170588235294126}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 261.78058158159257, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.562886226425568, "policy_loss": -0.01198830660287058, "vf_loss": 5.575319128980239, "vf_explained_var": 0.9672843267520269, "kl": 0.00920452606563534, "entropy": 1.9528353198120991, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -12.819101617452786, "episode_reward_min": -1446.3661619937159, "episode_reward_mean": -643.0871292358694, "episode_len_mean": 133.04, "episode_media": {}, "episodes_timesteps_total": 13304, "policy_reward_min": {"policy_0": -1446.3661619937159}, "policy_reward_max": {"policy_0": -12.819101617452786}, "policy_reward_mean": {"policy_0": -643.0871292358694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335, -674.8365055361472, -53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101], "episode_lengths": [150, 150, 120, 150, 150, 150, 150, 43, 134, 150, 150, 150, 150, 61, 150, 150, 101, 150, 144, 150, 150, 150, 150, 64, 108, 149, 150, 112, 150, 150, 150, 122, 150, 150, 97, 82, 103, 150, 150, 150, 150, 77, 150, 109, 150, 150, 150, 63, 150, 150, 150, 150, 150, 43, 150, 150, 150, 103, 122, 126, 37, 150, 150, 150, 150, 150, 150, 150, 69, 81, 150, 111, 150, 95, 150, 150, 101, 150, 67, 150, 150, 120, 131, 150, 150, 136, 150, 150, 105, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150], "policy_policy_0_reward": [-547.6803144486666, -454.5880760458844, -503.366469335244, -1446.3661619937159, -470.67852087085, -1213.759486998656, -351.4551958217409, -15.044420759601085, -433.69152372495375, -802.0428598806617, -414.76077748598016, -876.3025915542619, -398.6810692581702, -97.00193902482012, -671.7354232928724, -563.1771833609404, -159.57546731921443, -1053.81829527008, -399.369446476806, -764.0732564455498, -578.4088486566081, -1224.829109969029, -561.592879448455, -126.27193362954074, -223.18381622995793, -420.97591304478595, -1368.0020305129383, -258.8978431310075, -1299.1441966591635, -1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335, -674.8365055361472, -53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5921728477012548, "mean_inference_ms": 1.837433036314052, "mean_action_processing_ms": 0.29761835977168344, "mean_env_wait_ms": 3.283008665840264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012289285659790039, "StateBufferConnector_ms": 0.008104562759399414, "ViewRequirementAgentConnector_ms": 0.21413540840148926}, "num_episodes": 33, "episode_return_max": -12.819101617452786, "episode_return_min": -1446.3661619937159, "episode_return_mean": -643.0871292358694, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.21791854510263, "num_env_steps_trained_throughput_per_sec": 307.21791854510263, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 13289.16, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13289.08, "sample_time_ms": 1225.192, "learn_time_ms": 11994.362, "learn_throughput": 333.49, "synch_weights_time_ms": 68.765}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "3541f_00000", "date": "2024-08-03_03-01-50", "timestamp": 1722634310, "time_this_iter_s": 13.032326459884644, "time_total_s": 1020.5974967479706, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1020.5974967479706, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 22.531578947368423, "ram_util_percent": 47.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.030806128184, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.647338644663493, "policy_loss": -0.014001484040636569, "vf_loss": 5.659357535342376, "vf_explained_var": 0.9628706581890583, "kl": 0.01063285329152374, "entropy": 1.756631909434994, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -12.819101617452786, "episode_reward_min": -1404.271438006543, "episode_reward_mean": -624.3578000286996, "episode_len_mean": 130.74, "episode_media": {}, "episodes_timesteps_total": 13074, "policy_reward_min": {"policy_0": -1404.271438006543}, "policy_reward_max": {"policy_0": -12.819101617452786}, "policy_reward_mean": {"policy_0": -624.3578000286996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335, -674.8365055361472, -53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826], "episode_lengths": [150, 150, 122, 150, 150, 97, 82, 103, 150, 150, 150, 150, 77, 150, 109, 150, 150, 150, 63, 150, 150, 150, 150, 150, 43, 150, 150, 150, 103, 122, 126, 37, 150, 150, 150, 150, 150, 150, 150, 69, 81, 150, 111, 150, 95, 150, 150, 101, 150, 67, 150, 150, 120, 131, 150, 150, 136, 150, 150, 105, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 102, 131, 75, 150, 82, 150, 150, 66, 150, 125, 118, 150, 101, 126, 63, 150, 150, 150, 123, 118, 115, 150, 150, 150, 150, 143, 134, 84], "policy_policy_0_reward": [-1240.5946618790679, -780.1953402471661, -450.99337891256164, -1156.5648436238, -1275.942870997374, -340.3067755144907, -160.64062200420346, -271.6975837294698, -607.0048553411477, -973.118245709289, -692.8011445075331, -626.4696510606616, -95.76205740742199, -682.8355469549655, -272.4165688551463, -562.6825784651322, -1102.1556029445815, -813.9503708402094, -166.03339393047773, -735.3690983301703, -494.7865965487423, -1228.8303603864729, -1089.0852708955942, -465.21393760538973, -60.23572821442618, -1259.3910133841462, -865.5911294543376, -910.4224889216174, -435.4933758265006, -291.48177921129263, -483.11325636641595, -12.819101617452786, -926.8265644812124, -1105.8073403635535, -369.78384478920015, -898.7429312029151, -1404.271438006543, -722.2332325120335, -674.8365055361472, -53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.591782394614746, "mean_inference_ms": 1.8356632405144484, "mean_action_processing_ms": 0.2974904424836787, "mean_env_wait_ms": 3.2809525899586465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012351751327514648, "StateBufferConnector_ms": 0.008108854293823242, "ViewRequirementAgentConnector_ms": 0.20914196968078613}, "num_episodes": 29, "episode_return_max": -12.819101617452786, "episode_return_min": -1404.271438006543, "episode_return_mean": -624.3578000286996, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.71947797656287, "num_env_steps_trained_throughput_per_sec": 324.71947797656287, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 13181.143, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13181.064, "sample_time_ms": 1226.185, "learn_time_ms": 11887.129, "learn_throughput": 336.498, "synch_weights_time_ms": 66.991}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "3541f_00000", "date": "2024-08-03_03-02-03", "timestamp": 1722634323, "time_this_iter_s": 12.329464673995972, "time_total_s": 1032.9269614219666, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1032.9269614219666, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 39.54705882352942, "ram_util_percent": 47.20588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.33552678028744, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.508386740336816, "policy_loss": -0.007034438550666285, "vf_loss": 5.513738145927588, "vf_explained_var": 0.9511884674429893, "kl": 0.01079972989725017, "entropy": 1.8503376174718142, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": -24.746335430385763, "episode_reward_min": -1381.8051860710318, "episode_reward_mean": -537.7252027007924, "episode_len_mean": 122.37, "episode_media": {}, "episodes_timesteps_total": 12237, "policy_reward_min": {"policy_0": -1381.8051860710318}, "policy_reward_max": {"policy_0": -24.746335430385763}, "policy_reward_mean": {"policy_0": -537.7252027007924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826, -573.9926378146683, -24.746335430385763, -751.305687490505, -700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122], "episode_lengths": [69, 81, 150, 111, 150, 95, 150, 150, 101, 150, 67, 150, 150, 120, 131, 150, 150, 136, 150, 150, 105, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 102, 131, 75, 150, 82, 150, 150, 66, 150, 125, 118, 150, 101, 126, 63, 150, 150, 150, 123, 118, 115, 150, 150, 150, 150, 143, 134, 84, 144, 41, 150, 150, 150, 150, 63, 125, 150, 150, 87, 93, 78, 150, 70, 121, 54, 64, 53, 150, 150, 62, 150, 122, 97, 78, 57, 150, 72, 150, 150, 72, 96, 150, 131, 150, 150, 60, 57], "policy_policy_0_reward": [-53.434945788422574, -157.12898234315952, -634.403388781875, -308.07872829197447, -696.9927427349767, -125.6049148061222, -1104.557666049996, -433.3264063014309, -314.1719316300129, -981.1789597244951, -153.75269392013277, -1092.461484773691, -914.1396755331809, -458.4631022927755, -615.3647531238634, -425.2914866862159, -406.44826570076845, -616.4523746764454, -764.6706277521382, -899.5157963106808, -379.61318388042395, -1025.922079538349, -886.5972397466896, -729.7970144497485, -813.1873268026397, -552.9863632676006, -870.6502618198666, -436.55933021380866, -944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826, -573.9926378146683, -24.746335430385763, -751.305687490505, -700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5919010366016592, "mean_inference_ms": 1.837494365175524, "mean_action_processing_ms": 0.2980863472853903, "mean_env_wait_ms": 3.2827728705214456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012292146682739258, "StateBufferConnector_ms": 0.014485359191894531, "ViewRequirementAgentConnector_ms": 0.19639277458190918}, "num_episodes": 39, "episode_return_max": -24.746335430385763, "episode_return_min": -1381.8051860710318, "episode_return_mean": -537.7252027007924, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.6267700767913, "num_env_steps_trained_throughput_per_sec": 287.6267700767913, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 13138.937, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13138.859, "sample_time_ms": 1222.243, "learn_time_ms": 11848.653, "learn_throughput": 337.591, "synch_weights_time_ms": 67.191}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "3541f_00000", "date": "2024-08-03_03-02-17", "timestamp": 1722634337, "time_this_iter_s": 13.92016053199768, "time_total_s": 1046.8471219539642, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073b520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1046.8471219539642, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 21.979999999999997, "ram_util_percent": 47.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 281.0410775701205, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.016580833991369, "policy_loss": -0.012492979663754037, "vf_loss": 5.028454498449961, "vf_explained_var": 0.9790399524693688, "kl": 0.010883069172329455, "entropy": 2.079959479346871, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": -24.746335430385763, "episode_reward_min": -1381.8051860710318, "episode_reward_mean": -550.5931025294902, "episode_len_mean": 121.5, "episode_media": {}, "episodes_timesteps_total": 12150, "policy_reward_min": {"policy_0": -1381.8051860710318}, "policy_reward_max": {"policy_0": -24.746335430385763}, "policy_reward_mean": {"policy_0": -550.5931025294902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826, -573.9926378146683, -24.746335430385763, -751.305687490505, -700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104], "episode_lengths": [150, 150, 150, 150, 150, 102, 131, 75, 150, 82, 150, 150, 66, 150, 125, 118, 150, 101, 126, 63, 150, 150, 150, 123, 118, 115, 150, 150, 150, 150, 143, 134, 84, 144, 41, 150, 150, 150, 150, 63, 125, 150, 150, 87, 93, 78, 150, 70, 121, 54, 64, 53, 150, 150, 62, 150, 122, 97, 78, 57, 150, 72, 150, 150, 72, 96, 150, 131, 150, 150, 60, 57, 150, 150, 62, 150, 150, 150, 150, 88, 129, 150, 150, 118, 128, 150, 92, 54, 150, 114, 150, 61, 150, 51, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-944.1475602710633, -667.2481826258917, -550.277593649869, -891.3117228696101, -477.1179747937793, -353.44971292780343, -520.9623617810001, -143.607432914441, -940.3802279806545, -201.47603356306655, -511.168678412654, -806.900463382456, -105.86826412092934, -933.4488699822058, -300.0161756332733, -538.9394731268719, -577.4013938664367, -288.846904028525, -293.1123327494005, -188.5694244040877, -702.1863234580821, -697.3259663070954, -1051.8422029238745, -540.907050570154, -295.6071118209306, -321.67490468554735, -546.5493994784143, -1214.0925058993607, -689.7997586105693, -1381.8051860710318, -415.5599801861238, -646.8385621046968, -140.08745414969826, -573.9926378146683, -24.746335430385763, -751.305687490505, -700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5915625851538558, "mean_inference_ms": 1.8360652086952165, "mean_action_processing_ms": 0.2978533927571293, "mean_env_wait_ms": 3.28266607079012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382268905639648, "StateBufferConnector_ms": 0.014293670654296875, "ViewRequirementAgentConnector_ms": 0.19901561737060547}, "num_episodes": 28, "episode_return_max": -24.746335430385763, "episode_return_min": -1381.8051860710318, "episode_return_mean": -550.5931025294902, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.73781984615437, "num_env_steps_trained_throughput_per_sec": 301.73781984615437, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 13123.783, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13123.71, "sample_time_ms": 1223.481, "learn_time_ms": 11835.25, "learn_throughput": 337.973, "synch_weights_time_ms": 64.211}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "3541f_00000", "date": "2024-08-03_03-02-30", "timestamp": 1722634350, "time_this_iter_s": 13.267605304718018, "time_total_s": 1060.1147272586823, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1060.1147272586823, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 37.44736842105263, "ram_util_percent": 47.20526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.56477844715118, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.164871217310429, "policy_loss": -0.013428766074745606, "vf_loss": 5.176944586386283, "vf_explained_var": 0.9698000902310013, "kl": 0.010980735458709508, "entropy": 1.9525175961355368, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -31.282549772428556, "episode_reward_min": -1372.3824569385658, "episode_reward_mean": -554.091808066289, "episode_len_mean": 121.3, "episode_media": {}, "episodes_timesteps_total": 12130, "policy_reward_min": {"policy_0": -1372.3824569385658}, "policy_reward_max": {"policy_0": -31.282549772428556}, "policy_reward_mean": {"policy_0": -554.091808066289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412], "episode_lengths": [150, 150, 150, 63, 125, 150, 150, 87, 93, 78, 150, 70, 121, 54, 64, 53, 150, 150, 62, 150, 122, 97, 78, 57, 150, 72, 150, 150, 72, 96, 150, 131, 150, 150, 60, 57, 150, 150, 62, 150, 150, 150, 150, 88, 129, 150, 150, 118, 128, 150, 92, 54, 150, 114, 150, 61, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 84, 150, 64, 117, 102, 150, 86, 150, 121, 133, 107, 150, 59, 129, 55, 150, 150, 150, 150, 150, 84, 137, 123, 150, 95, 150, 150, 150], "policy_policy_0_reward": [-700.9228153783171, -645.7297201417434, -552.2427889161922, -158.28551408966965, -622.9428867025844, -1016.3839529744786, -857.724137790487, -250.75286366116714, -79.17854531454257, -142.13998522915193, -594.8048806845107, -193.97907356633226, -471.604799984117, -39.75366794376744, -61.112123522055875, -85.42080175638428, -553.4445783401052, -729.7832061025262, -149.68665137674515, -1153.047745999767, -398.52922079852175, -365.480805288847, -297.72959227101205, -95.55355859848879, -1069.0177507204285, -94.41549747745938, -740.6633540087576, -433.2601310725375, -154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5912480909135318, "mean_inference_ms": 1.8334805100977696, "mean_action_processing_ms": 0.29742896136250196, "mean_env_wait_ms": 3.277357494417879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012165307998657227, "StateBufferConnector_ms": 0.014272212982177734, "ViewRequirementAgentConnector_ms": 0.19323110580444336}, "num_episodes": 36, "episode_return_max": -31.282549772428556, "episode_return_min": -1372.3824569385658, "episode_return_mean": -554.091808066289, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3730301572464, "num_env_steps_trained_throughput_per_sec": 297.3730301572464, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 13102.427, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13102.357, "sample_time_ms": 1214.575, "learn_time_ms": 11822.67, "learn_throughput": 338.333, "synch_weights_time_ms": 64.356}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "3541f_00000", "date": "2024-08-03_03-02-44", "timestamp": 1722634364, "time_this_iter_s": 13.465414047241211, "time_total_s": 1073.5801413059235, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f2f832e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1073.5801413059235, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 22.44736842105263, "ram_util_percent": 47.21578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 273.87884351213773, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.45727046529452, "policy_loss": -0.01369964384114913, "vf_loss": 4.472908538579941, "vf_explained_var": 0.9781500766674678, "kl": 0.009013977526713823, "entropy": 2.213014763469497, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -2.0713769678220237, "episode_reward_min": -1372.3824569385658, "episode_reward_mean": -599.7180379720068, "episode_len_mean": 125.39, "episode_media": {}, "episodes_timesteps_total": 12539, "policy_reward_min": {"policy_0": -1372.3824569385658}, "policy_reward_max": {"policy_0": -2.0713769678220237}, "policy_reward_mean": {"policy_0": -599.7180379720068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451], "episode_lengths": [72, 96, 150, 131, 150, 150, 60, 57, 150, 150, 62, 150, 150, 150, 150, 88, 129, 150, 150, 118, 128, 150, 92, 54, 150, 114, 150, 61, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 84, 150, 64, 117, 102, 150, 86, 150, 121, 133, 107, 150, 59, 129, 55, 150, 150, 150, 150, 150, 84, 137, 123, 150, 95, 150, 150, 150, 150, 89, 107, 150, 100, 87, 150, 150, 150, 150, 150, 150, 150, 150, 43, 93, 150, 110, 150, 150, 150, 89, 150, 41, 83, 150, 150, 113], "policy_policy_0_reward": [-154.5724034372142, -301.66450741095673, -1372.3824569385658, -723.6311941029024, -842.2349305046109, -623.6429731445991, -67.40280242270097, -54.07477538035122, -565.5848680259588, -979.9560925740639, -31.282549772428556, -819.1793498855727, -341.2467242266131, -1036.4754643050403, -1072.5347443020505, -126.01336945419835, -609.2165834430681, -1195.4817460797415, -1248.5184364265872, -479.64436371088203, -280.7848595251456, -638.3675507797656, -177.8245640798757, -132.5676293531672, -1083.2810887815901, -505.8663651584175, -1243.905154126954, -81.10828833790274, -1358.8190003313678, -33.742065722123286, -990.9332491551431, -546.2195998320312, -392.2109684970294, -820.8315870375767, -818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.591621079497903, "mean_inference_ms": 1.83191630670512, "mean_action_processing_ms": 0.29702080453900115, "mean_env_wait_ms": 3.2749582766865517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012286901473999023, "StateBufferConnector_ms": 0.007894515991210938, "ViewRequirementAgentConnector_ms": 0.19368791580200195}, "num_episodes": 28, "episode_return_max": -2.0713769678220237, "episode_return_min": -1372.3824569385658, "episode_return_mean": -599.7180379720068, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.8083531410566, "num_env_steps_trained_throughput_per_sec": 269.8083531410566, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 13414.685, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13414.613, "sample_time_ms": 1213.552, "learn_time_ms": 12126.405, "learn_throughput": 329.859, "synch_weights_time_ms": 73.821}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "3541f_00000", "date": "2024-08-03_03-02-58", "timestamp": 1722634378, "time_this_iter_s": 14.84759521484375, "time_total_s": 1088.4277365207672, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1088.4277365207672, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 35.20952380952381, "ram_util_percent": 47.22380952380953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 285.78924988508226, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.2210435899595415, "policy_loss": -0.01806088438509808, "vf_loss": 5.237827681998412, "vf_explained_var": 0.9857512564087908, "kl": 0.01150732801919131, "entropy": 2.0748744358619056, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": -2.0713769678220237, "episode_reward_min": -1432.6503651205098, "episode_reward_mean": -582.833599638851, "episode_len_mean": 125.27, "episode_media": {}, "episodes_timesteps_total": 12527, "policy_reward_min": {"policy_0": -1432.6503651205098}, "policy_reward_max": {"policy_0": -2.0713769678220237}, "policy_reward_mean": {"policy_0": -582.833599638851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442], "episode_lengths": [150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 84, 150, 64, 117, 102, 150, 86, 150, 121, 133, 107, 150, 59, 129, 55, 150, 150, 150, 150, 150, 84, 137, 123, 150, 95, 150, 150, 150, 150, 89, 107, 150, 100, 87, 150, 150, 150, 150, 150, 150, 150, 150, 43, 93, 150, 110, 150, 150, 150, 89, 150, 41, 83, 150, 150, 113, 150, 150, 74, 150, 150, 83, 83, 129, 90, 125, 150, 150, 100, 150, 70, 150, 150, 95, 150, 150, 150, 73, 150, 150, 73, 91, 150, 150, 150, 150, 72, 78, 150, 65], "policy_policy_0_reward": [-818.4241095058647, -527.5213373811104, -1152.1081636243957, -1089.8761091524357, -152.4713884440399, -1079.496824678475, -587.7748288781834, -1296.9637632976494, -556.8510495878171, -675.8735689058931, -114.45442313276436, -1052.528461237453, -55.560286990378955, -621.5945157518411, -275.92651833805803, -581.2096107560566, -163.01410504971412, -1288.0468969256397, -128.90288962998244, -520.178832357562, -530.3909859723682, -732.6982292820902, -55.758352336849505, -594.4240546624555, -107.09965810544938, -633.7274435596677, -861.2083951073294, -457.9737716564482, -699.180191896082, -396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5914079274452432, "mean_inference_ms": 1.8326606224063893, "mean_action_processing_ms": 0.296836525252545, "mean_env_wait_ms": 3.275048646040497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021086931228637695, "StateBufferConnector_ms": 0.008121252059936523, "ViewRequirementAgentConnector_ms": 0.2315073013305664}, "num_episodes": 34, "episode_return_max": -2.0713769678220237, "episode_return_min": -1432.6503651205098, "episode_return_mean": -582.833599638851, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.85042915128724, "num_env_steps_trained_throughput_per_sec": 320.85042915128724, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 13282.427, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13282.351, "sample_time_ms": 1238.726, "learn_time_ms": 11969.61, "learn_throughput": 334.18, "synch_weights_time_ms": 73.17}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "3541f_00000", "date": "2024-08-03_03-03-11", "timestamp": 1722634391, "time_this_iter_s": 12.481374740600586, "time_total_s": 1100.9091112613678, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1100.9091112613678, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 26.750000000000004, "ram_util_percent": 47.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 313.87953759034474, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.737721417099237, "policy_loss": -0.01760237998290298, "vf_loss": 4.7546470602353414, "vf_explained_var": 0.9880551397800446, "kl": 0.011566919729011794, "entropy": 2.2069506615400316, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -2.0713769678220237, "episode_reward_min": -1432.6503651205098, "episode_reward_mean": -602.3633181085166, "episode_len_mean": 127.21, "episode_media": {}, "episodes_timesteps_total": 12721, "policy_reward_min": {"policy_0": -1432.6503651205098}, "policy_reward_max": {"policy_0": -2.0713769678220237}, "policy_reward_mean": {"policy_0": -602.3633181085166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057], "episode_lengths": [150, 84, 137, 123, 150, 95, 150, 150, 150, 150, 89, 107, 150, 100, 87, 150, 150, 150, 150, 150, 150, 150, 150, 43, 93, 150, 110, 150, 150, 150, 89, 150, 41, 83, 150, 150, 113, 150, 150, 74, 150, 150, 83, 83, 129, 90, 125, 150, 150, 100, 150, 70, 150, 150, 95, 150, 150, 150, 73, 150, 150, 73, 91, 150, 150, 150, 150, 72, 78, 150, 65, 150, 81, 150, 150, 150, 150, 150, 60, 49, 120, 150, 113, 150, 132, 150, 150, 150, 150, 150, 150, 113, 132, 150, 94, 150, 132, 150, 150, 150], "policy_policy_0_reward": [-396.04809269056403, -130.93971242033135, -435.2531854032103, -343.55743541871783, -759.2355068305272, -190.73181956921908, -906.9190282917153, -603.1768123295296, -747.2874914941412, -1024.0865806417503, -134.88787080171664, -365.11183889562017, -992.9252855124772, -417.65522620373974, -146.46912053129438, -547.6717798911773, -479.61601573150443, -636.3730881003197, -993.7505514426324, -839.8976917042453, -879.0004893811441, -1053.504912885532, -1355.3704219615686, -79.21175497309723, -165.46391356878013, -689.7667184007979, -270.25397546595127, -1093.4920174128547, -731.1116548266648, -1193.462620771024, -314.29579208045516, -854.6204021977569, -2.0713769678220237, -200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5918726017011123, "mean_inference_ms": 1.8333329719487523, "mean_action_processing_ms": 0.29709341295398484, "mean_env_wait_ms": 3.2782252834192476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021372318267822266, "StateBufferConnector_ms": 0.008103132247924805, "ViewRequirementAgentConnector_ms": 0.23259782791137695}, "num_episodes": 29, "episode_return_max": -2.0713769678220237, "episode_return_min": -1432.6503651205098, "episode_return_mean": -602.3633181085166, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.498484990141, "num_env_steps_trained_throughput_per_sec": 291.498484990141, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 13356.947, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13356.867, "sample_time_ms": 1236.683, "learn_time_ms": 12039.195, "learn_throughput": 332.248, "synch_weights_time_ms": 80.057}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "3541f_00000", "date": "2024-08-03_03-03-25", "timestamp": 1722634405, "time_this_iter_s": 13.748176097869873, "time_total_s": 1114.6572873592377, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1114.6572873592377, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.289473684210524, "ram_util_percent": 47.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.0977988421917, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.263313591976961, "policy_loss": -0.011573972694653397, "vf_loss": 5.274742747098207, "vf_explained_var": 0.9773228854561845, "kl": 0.011001392682131458, "entropy": 2.1988181528945763, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -18.328794169228388, "episode_reward_min": -1523.472542511063, "episode_reward_mean": -613.8328768824382, "episode_len_mean": 125.96, "episode_media": {}, "episodes_timesteps_total": 12596, "policy_reward_min": {"policy_0": -1523.472542511063}, "policy_reward_max": {"policy_0": -18.328794169228388}, "policy_reward_mean": {"policy_0": -613.8328768824382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063], "episode_lengths": [83, 150, 150, 113, 150, 150, 74, 150, 150, 83, 83, 129, 90, 125, 150, 150, 100, 150, 70, 150, 150, 95, 150, 150, 150, 73, 150, 150, 73, 91, 150, 150, 150, 150, 72, 78, 150, 65, 150, 81, 150, 150, 150, 150, 150, 60, 49, 120, 150, 113, 150, 132, 150, 150, 150, 150, 150, 150, 113, 132, 150, 94, 150, 132, 150, 150, 150, 131, 150, 150, 150, 42, 59, 150, 150, 150, 109, 150, 116, 55, 150, 69, 150, 150, 150, 150, 61, 150, 139, 150, 114, 150, 150, 81, 150, 150, 150, 51, 46, 150], "policy_policy_0_reward": [-200.31863728553097, -755.4607052060504, -685.1843624984089, -215.1788349425451, -730.2145391460809, -715.9973574993614, -171.78380175003895, -665.6769056586978, -700.4793732833084, -153.36929715610313, -131.18917813695737, -550.599647156674, -330.73287313396116, -250.80135399513802, -856.1487474559909, -1432.6503651205098, -222.07753231076248, -325.3609554943526, -111.0242119419239, -1246.5855244642723, -652.6397323346134, -288.1174467368646, -1323.9566628868909, -518.9996720591706, -786.0448549167431, -214.98980350857545, -671.7641779502507, -728.50070879601, -131.7631616359368, -160.25886543324364, -1108.911070891629, -1130.9383231885718, -937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5940971899231566, "mean_inference_ms": 1.842589157973161, "mean_action_processing_ms": 0.2983352672449872, "mean_env_wait_ms": 3.2925371802786545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022762537002563477, "StateBufferConnector_ms": 0.00887441635131836, "ViewRequirementAgentConnector_ms": 0.3457202911376953}, "num_episodes": 33, "episode_return_max": -18.328794169228388, "episode_return_min": -1523.472542511063, "episode_return_mean": -613.8328768824382, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.1789964926736, "num_env_steps_trained_throughput_per_sec": 281.1789964926736, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 13352.818, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13352.736, "sample_time_ms": 1367.365, "learn_time_ms": 11903.575, "learn_throughput": 336.034, "synch_weights_time_ms": 80.867}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "3541f_00000", "date": "2024-08-03_03-03-39", "timestamp": 1722634419, "time_this_iter_s": 14.23919677734375, "time_total_s": 1128.8964841365814, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1128.8964841365814, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.09999999999999, "ram_util_percent": 47.4047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 248.04453779260317, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.295027747005224, "policy_loss": -0.017120389265376918, "vf_loss": 5.311620899538199, "vf_explained_var": 0.9795610983545582, "kl": 0.010405445713089094, "entropy": 2.00165620110929, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": -18.328794169228388, "episode_reward_min": -1524.552621896883, "episode_reward_mean": -603.2315197427417, "episode_len_mean": 126.25, "episode_media": {}, "episodes_timesteps_total": 12625, "policy_reward_min": {"policy_0": -1524.552621896883}, "policy_reward_max": {"policy_0": -18.328794169228388}, "policy_reward_mean": {"policy_0": -603.2315197427417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515], "episode_lengths": [150, 150, 72, 78, 150, 65, 150, 81, 150, 150, 150, 150, 150, 60, 49, 120, 150, 113, 150, 132, 150, 150, 150, 150, 150, 150, 113, 132, 150, 94, 150, 132, 150, 150, 150, 131, 150, 150, 150, 42, 59, 150, 150, 150, 109, 150, 116, 55, 150, 69, 150, 150, 150, 150, 61, 150, 139, 150, 114, 150, 150, 81, 150, 150, 150, 51, 46, 150, 120, 75, 107, 113, 150, 96, 150, 150, 150, 150, 139, 150, 80, 150, 81, 150, 150, 150, 150, 115, 150, 41, 150, 86, 150, 52, 150, 132, 150, 150, 150, 74], "policy_policy_0_reward": [-937.3005299404366, -671.4337181473539, -149.33422314514513, -226.64022653517438, -788.825003222632, -157.6486279172442, -1163.6125011038973, -114.92403123041676, -480.05980064296705, -801.9310145855842, -345.87211346128095, -981.0648333482388, -693.1442502901043, -77.9854591228865, -18.328794169228388, -500.30506050036445, -1097.4977866671031, -420.1017592412269, -1244.1768172402367, -442.1076279830821, -1056.2462215791884, -464.69283977852655, -745.7675992186569, -890.7655425679823, -847.289874658962, -1034.8492137388546, -340.98393598940345, -426.10033564907985, -1070.485959380039, -195.4119233638741, -1003.6325404912523, -344.60430001269094, -1288.9921808916285, -684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5963671725378308, "mean_inference_ms": 1.850605602425362, "mean_action_processing_ms": 0.3001659991053037, "mean_env_wait_ms": 3.306587691014169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013895511627197266, "StateBufferConnector_ms": 0.008968591690063477, "ViewRequirementAgentConnector_ms": 0.3219583034515381}, "num_episodes": 32, "episode_return_max": -18.328794169228388, "episode_return_min": -1524.552621896883, "episode_return_mean": -603.2315197427417, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.91870779909016, "num_env_steps_trained_throughput_per_sec": 312.91870779909016, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 13397.621, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13397.538, "sample_time_ms": 1376.206, "learn_time_ms": 11942.177, "learn_throughput": 334.947, "synch_weights_time_ms": 78.229}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "3541f_00000", "date": "2024-08-03_03-03-52", "timestamp": 1722634432, "time_this_iter_s": 12.793263673782349, "time_total_s": 1141.6897478103638, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1141.6897478103638, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 36.03888888888889, "ram_util_percent": 47.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.9931602080663, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.2632711994151276, "policy_loss": -0.0191877987672342, "vf_loss": 5.281612687309583, "vf_explained_var": 0.9817666174223025, "kl": 0.010893666668456111, "entropy": 2.0367055839548507, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -20.693532808927646, "episode_reward_min": -1524.552621896883, "episode_reward_mean": -579.3229265163038, "episode_len_mean": 125.26, "episode_media": {}, "episodes_timesteps_total": 12526, "policy_reward_min": {"policy_0": -1524.552621896883}, "policy_reward_max": {"policy_0": -20.693532808927646}, "policy_reward_mean": {"policy_0": -579.3229265163038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989], "episode_lengths": [150, 150, 131, 150, 150, 150, 42, 59, 150, 150, 150, 109, 150, 116, 55, 150, 69, 150, 150, 150, 150, 61, 150, 139, 150, 114, 150, 150, 81, 150, 150, 150, 51, 46, 150, 120, 75, 107, 113, 150, 96, 150, 150, 150, 150, 139, 150, 80, 150, 81, 150, 150, 150, 150, 115, 150, 41, 150, 86, 150, 52, 150, 132, 150, 150, 150, 74, 150, 150, 122, 150, 150, 87, 150, 111, 150, 150, 90, 150, 99, 150, 150, 150, 150, 150, 145, 92, 139, 150, 95, 128, 117, 64, 150, 150, 92, 73, 96, 90, 102], "policy_policy_0_reward": [-684.3577789306794, -588.9185173332057, -320.638613727073, -394.05833597104396, -1076.556850127082, -615.3236390183727, -33.76602557355859, -41.093883227948886, -843.6103358879454, -1474.0431081764182, -1185.0354468823996, -442.35510281986524, -1005.1291924653268, -348.9369806240539, -52.86590825761719, -908.9598910542896, -181.84224020814239, -1281.0488817746736, -709.3781428146095, -909.3794143892309, -1269.8238463681716, -44.2125586306245, -340.5135116752998, -763.3913851681726, -669.1508429638816, -420.99109597976206, -732.8796321832328, -641.7708129011329, -257.8096744108888, -1371.3875845750026, -412.9386003801516, -600.3036844054618, -20.693532808927646, -26.814764228595383, -1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5983767519185165, "mean_inference_ms": 1.858117076726847, "mean_action_processing_ms": 0.3013430567214262, "mean_env_wait_ms": 3.3140587676762583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013688325881958008, "StateBufferConnector_ms": 0.008921146392822266, "ViewRequirementAgentConnector_ms": 0.3207411766052246}, "num_episodes": 33, "episode_return_max": -20.693532808927646, "episode_return_min": -1524.552621896883, "episode_return_mean": -579.3229265163038, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.62334735425895, "num_env_steps_trained_throughput_per_sec": 421.62334735425895, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 13044.327, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13044.246, "sample_time_ms": 1370.523, "learn_time_ms": 11594.146, "learn_throughput": 345.002, "synch_weights_time_ms": 78.655}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "3541f_00000", "date": "2024-08-03_03-04-01", "timestamp": 1722634441, "time_this_iter_s": 9.501110553741455, "time_total_s": 1151.1908583641052, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1151.1908583641052, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.06153846153847, "ram_util_percent": 47.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.58978654146193, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.574573789785306, "policy_loss": -0.009565481324777162, "vf_loss": 5.582837286343177, "vf_explained_var": 0.9813624953230222, "kl": 0.011874008433718093, "entropy": 2.144089664767186, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": -24.29661234616156, "episode_reward_min": -1524.552621896883, "episode_reward_mean": -553.0013993790564, "episode_len_mean": 122.33, "episode_media": {}, "episodes_timesteps_total": 12233, "policy_reward_min": {"policy_0": -1524.552621896883}, "policy_reward_max": {"policy_0": -24.29661234616156}, "policy_reward_mean": {"policy_0": -553.0013993790564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112], "episode_lengths": [150, 120, 75, 107, 113, 150, 96, 150, 150, 150, 150, 139, 150, 80, 150, 81, 150, 150, 150, 150, 115, 150, 41, 150, 86, 150, 52, 150, 132, 150, 150, 150, 74, 150, 150, 122, 150, 150, 87, 150, 111, 150, 150, 90, 150, 99, 150, 150, 150, 150, 150, 145, 92, 139, 150, 95, 128, 117, 64, 150, 150, 92, 73, 96, 90, 102, 150, 150, 84, 105, 150, 55, 150, 150, 63, 108, 150, 150, 55, 79, 105, 150, 76, 150, 150, 150, 62, 150, 46, 121, 99, 150, 150, 74, 150, 105, 76, 150, 67, 150], "policy_policy_0_reward": [-1523.472542511063, -482.48214709089103, -87.25570429589008, -240.58317755929588, -186.09157909301246, -762.1977976478377, -172.3011119823964, -900.2291030173284, -958.872877694635, -728.9758869998867, -459.0287728936253, -352.60580595554165, -1077.2823932465506, -134.8213290277429, -615.8483028149367, -211.38096467132246, -366.55933177225694, -969.225039395618, -378.1789624474929, -779.8366126961103, -300.08399153293067, -480.89400168080823, -36.96540215279001, -628.5416025979405, -175.3879665391033, -1524.552621896883, -56.45057702725885, -970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5981124209467815, "mean_inference_ms": 1.859990112778814, "mean_action_processing_ms": 0.30201636211180133, "mean_env_wait_ms": 3.316382877452542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991024017333984, "StateBufferConnector_ms": 0.008156299591064453, "ViewRequirementAgentConnector_ms": 0.21658062934875488}, "num_episodes": 34, "episode_return_max": -24.29661234616156, "episode_return_min": -1524.552621896883, "episode_return_mean": -553.0013993790564, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.7629478697699, "num_env_steps_trained_throughput_per_sec": 284.7629478697699, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 13217.172, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13217.09, "sample_time_ms": 1378.211, "learn_time_ms": 11751.866, "learn_throughput": 340.371, "synch_weights_time_ms": 86.03}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "3541f_00000", "date": "2024-08-03_03-04-16", "timestamp": 1722634456, "time_this_iter_s": 14.072864055633545, "time_total_s": 1165.2637224197388, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1165.2637224197388, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 29.43, "ram_util_percent": 47.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 203.98908567031225, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.276781191428502, "policy_loss": -0.019852630251746935, "vf_loss": 5.296657195687294, "vf_explained_var": 0.9876432457317909, "kl": 0.010635915165949038, "entropy": 2.1584466132024924, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": -24.29661234616156, "episode_reward_min": -1422.703928258094, "episode_reward_mean": -575.0841919286648, "episode_len_mean": 122.89, "episode_media": {}, "episodes_timesteps_total": 12289, "policy_reward_min": {"policy_0": -1422.703928258094}, "policy_reward_max": {"policy_0": -24.29661234616156}, "policy_reward_mean": {"policy_0": -575.0841919286648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035], "episode_lengths": [150, 132, 150, 150, 150, 74, 150, 150, 122, 150, 150, 87, 150, 111, 150, 150, 90, 150, 99, 150, 150, 150, 150, 150, 145, 92, 139, 150, 95, 128, 117, 64, 150, 150, 92, 73, 96, 90, 102, 150, 150, 84, 105, 150, 55, 150, 150, 63, 108, 150, 150, 55, 79, 105, 150, 76, 150, 150, 150, 62, 150, 46, 121, 99, 150, 150, 74, 150, 105, 76, 150, 67, 150, 150, 102, 150, 128, 150, 84, 150, 150, 150, 150, 90, 150, 76, 51, 150, 150, 52, 150, 150, 145, 150, 150, 150, 37, 96, 150, 150], "policy_policy_0_reward": [-970.3768538640225, -548.7382696139244, -710.1749843749014, -602.7676395796834, -1103.884625512166, -105.0075333307515, -1184.8054988818078, -777.2365566851647, -392.7493368505827, -1038.1494690208128, -703.1157298363797, -95.68103003835341, -576.3171695398854, -293.91565991178624, -631.6636664063375, -1137.2009741993734, -137.06988527296673, -1094.6931487265117, -161.55631819639552, -1307.366200905134, -873.260498482448, -684.2970242203961, -1229.9957675816215, -1005.6396271238093, -756.9022772110978, -316.3089651063525, -546.4900687466943, -962.4874084662893, -220.0635607239771, -370.1957578936403, -216.62239057011038, -106.53541301892179, -346.0998823727168, -261.5988777914011, -271.4336870280285, -205.01237331258173, -214.65187635341556, -229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6005257280471963, "mean_inference_ms": 1.8652855029503346, "mean_action_processing_ms": 0.3026861182356878, "mean_env_wait_ms": 3.323329996690246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03344130516052246, "StateBufferConnector_ms": 0.008638858795166016, "ViewRequirementAgentConnector_ms": 0.3085498809814453}, "num_episodes": 27, "episode_return_max": -24.29661234616156, "episode_return_min": -1422.703928258094, "episode_return_mean": -575.0841919286648, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.35233468886, "num_env_steps_trained_throughput_per_sec": 288.35233468886, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 13213.673, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13213.589, "sample_time_ms": 1514.636, "learn_time_ms": 11613.637, "learn_throughput": 344.423, "synch_weights_time_ms": 84.341}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "3541f_00000", "date": "2024-08-03_03-04-29", "timestamp": 1722634469, "time_this_iter_s": 13.883832931518555, "time_total_s": 1179.1475553512573, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1179.1475553512573, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 36.245000000000005, "ram_util_percent": 47.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 256.440244881312, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.443520731230577, "policy_loss": -0.014144875618512742, "vf_loss": 5.458517128974199, "vf_explained_var": 0.9754192034403483, "kl": 0.010183697027908611, "entropy": 2.232500756904483, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -23.65409474804889, "episode_reward_min": -1543.897947417223, "episode_reward_mean": -526.4992024398771, "episode_len_mean": 120.33, "episode_media": {}, "episodes_timesteps_total": 12033, "policy_reward_min": {"policy_0": -1543.897947417223}, "policy_reward_max": {"policy_0": -23.65409474804889}, "policy_reward_mean": {"policy_0": -526.4992024398771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456], "episode_lengths": [90, 102, 150, 150, 84, 105, 150, 55, 150, 150, 63, 108, 150, 150, 55, 79, 105, 150, 76, 150, 150, 150, 62, 150, 46, 121, 99, 150, 150, 74, 150, 105, 76, 150, 67, 150, 150, 102, 150, 128, 150, 84, 150, 150, 150, 150, 90, 150, 76, 51, 150, 150, 52, 150, 150, 145, 150, 150, 150, 37, 96, 150, 150, 150, 150, 150, 79, 150, 82, 150, 150, 86, 97, 95, 111, 80, 100, 150, 44, 150, 94, 150, 77, 150, 150, 150, 104, 148, 111, 150, 150, 150, 150, 93, 65, 97, 150, 150, 101, 136], "policy_policy_0_reward": [-229.2652953909731, -282.875927304989, -1287.035782525057, -936.9148729822168, -284.3411616590726, -478.93698786360494, -905.1025707419022, -37.61917943283015, -390.9335130643627, -1422.703928258094, -64.21767437482814, -375.94416168441654, -500.34918388001165, -484.35875564375834, -33.91395862009889, -101.01608466502216, -274.9062403435055, -851.3281104624253, -114.41672432519762, -387.87684251307945, -1115.3856166938797, -1058.6711680875455, -135.4704712562715, -1233.9305920559914, -24.29661234616156, -499.4639403913484, -263.88992378204665, -756.9317000730163, -559.3363021254413, -156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6023917591407529, "mean_inference_ms": 1.8737158216633276, "mean_action_processing_ms": 0.3039743444618774, "mean_env_wait_ms": 3.3376397333796546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03389286994934082, "StateBufferConnector_ms": 0.008760929107666016, "ViewRequirementAgentConnector_ms": 0.31034326553344727}, "num_episodes": 37, "episode_return_max": -23.65409474804889, "episode_return_min": -1543.897947417223, "episode_return_mean": -526.4992024398771, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.1639002636215, "num_env_steps_trained_throughput_per_sec": 286.1639002636215, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 13285.819, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13285.735, "sample_time_ms": 1522.277, "learn_time_ms": 11670.986, "learn_throughput": 342.73, "synch_weights_time_ms": 91.412}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "3541f_00000", "date": "2024-08-03_03-04-44", "timestamp": 1722634484, "time_this_iter_s": 13.996194124221802, "time_total_s": 1193.1437494754791, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408dab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1193.1437494754791, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.195, "ram_util_percent": 47.71000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 251.83742643992107, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.300759061177572, "policy_loss": -0.018098717680065116, "vf_loss": 5.317555141448975, "vf_explained_var": 0.9783144134407242, "kl": 0.010839829040408795, "entropy": 1.9345371642460425, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": -23.65409474804889, "episode_reward_min": -1543.897947417223, "episode_reward_mean": -584.4696208845953, "episode_len_mean": 126.01, "episode_media": {}, "episodes_timesteps_total": 12601, "policy_reward_min": {"policy_0": -1543.897947417223}, "policy_reward_max": {"policy_0": -23.65409474804889}, "policy_reward_mean": {"policy_0": -584.4696208845953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699], "episode_lengths": [74, 150, 105, 76, 150, 67, 150, 150, 102, 150, 128, 150, 84, 150, 150, 150, 150, 90, 150, 76, 51, 150, 150, 52, 150, 150, 145, 150, 150, 150, 37, 96, 150, 150, 150, 150, 150, 79, 150, 82, 150, 150, 86, 97, 95, 111, 80, 100, 150, 44, 150, 94, 150, 77, 150, 150, 150, 104, 148, 111, 150, 150, 150, 150, 93, 65, 97, 150, 150, 101, 136, 110, 150, 150, 150, 94, 150, 105, 89, 150, 150, 150, 129, 150, 134, 150, 150, 150, 150, 150, 150, 51, 150, 150, 130, 150, 150, 150, 76, 150], "policy_policy_0_reward": [-156.29726934850038, -1044.7238511007758, -244.0588831669061, -244.10387134290545, -1140.3337312375793, -74.59106630620515, -554.4263698640112, -1085.710971913232, -155.65933805001072, -866.5952900342189, -444.6378414571712, -770.8912376952754, -157.69074678406963, -674.0080380475724, -539.8822259567548, -1195.6531182935387, -1372.1387890277451, -106.49189734706825, -988.5241976427872, -224.94501853645914, -29.422760131308024, -385.21046189910965, -917.8655071621035, -35.95535768822844, -917.6398847864688, -1418.7639703386963, -459.53363757451166, -504.1784168985858, -596.5805566312251, -1185.0471259843005, -30.64636314410874, -356.4434463517114, -735.083473762846, -643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6045737851732016, "mean_inference_ms": 1.8777426756587479, "mean_action_processing_ms": 0.3046785257332524, "mean_env_wait_ms": 3.3428195800503353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03423452377319336, "StateBufferConnector_ms": 0.008637428283691406, "ViewRequirementAgentConnector_ms": 0.30555081367492676}, "num_episodes": 29, "episode_return_max": -23.65409474804889, "episode_return_min": -1543.897947417223, "episode_return_mean": -584.4696208845953, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.94900039811887, "num_env_steps_trained_throughput_per_sec": 324.94900039811887, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 13171.67, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13171.583, "sample_time_ms": 1524.782, "learn_time_ms": 11554.015, "learn_throughput": 346.2, "synch_weights_time_ms": 91.724}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "3541f_00000", "date": "2024-08-03_03-04-56", "timestamp": 1722634496, "time_this_iter_s": 12.324259281158447, "time_total_s": 1205.4680087566376, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073b2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1205.4680087566376, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 25.505555555555556, "ram_util_percent": 47.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.02051643133163, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.091570819914341, "policy_loss": 0.010037005554962283, "vf_loss": 5.050134130815665, "vf_explained_var": 0.9849352079754075, "kl": 0.04162173809406046, "entropy": 2.148466205348571, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": -21.84900753717666, "episode_reward_min": -1543.897947417223, "episode_reward_mean": -571.194422970135, "episode_len_mean": 127.79, "episode_media": {}, "episodes_timesteps_total": 12779, "policy_reward_min": {"policy_0": -1543.897947417223}, "policy_reward_max": {"policy_0": -21.84900753717666}, "policy_reward_mean": {"policy_0": -571.194422970135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786], "episode_lengths": [150, 150, 150, 150, 79, 150, 82, 150, 150, 86, 97, 95, 111, 80, 100, 150, 44, 150, 94, 150, 77, 150, 150, 150, 104, 148, 111, 150, 150, 150, 150, 93, 65, 97, 150, 150, 101, 136, 110, 150, 150, 150, 94, 150, 105, 89, 150, 150, 150, 129, 150, 134, 150, 150, 150, 150, 150, 150, 51, 150, 150, 130, 150, 150, 150, 76, 150, 150, 150, 150, 150, 87, 146, 150, 150, 96, 150, 106, 150, 150, 92, 100, 109, 150, 129, 150, 150, 81, 150, 150, 150, 150, 131, 150, 52, 91, 89, 126, 150, 76], "policy_policy_0_reward": [-643.1851880629035, -1323.6056766473378, -630.9559366712552, -934.8275267182534, -54.790386273627796, -611.7626133952698, -114.47274230295986, -881.7469989080554, -489.9632897976794, -288.5172609928043, -261.70469403683825, -214.19839372009997, -346.55950245155316, -102.36672255030528, -238.57277863248152, -1070.5908198313232, -23.65409474804889, -415.72439332176094, -332.95091928982555, -585.4377167679896, -130.14516111609413, -1543.897947417223, -414.86795493152516, -383.2012498188239, -305.2719351500381, -377.58642851121, -403.4393569977724, -659.334122592016, -515.6059412869752, -532.2212045134577, -520.4947813909184, -258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6041862855281054, "mean_inference_ms": 1.8790875906800089, "mean_action_processing_ms": 0.305068232307502, "mean_env_wait_ms": 3.344413120068398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012677431106567383, "StateBufferConnector_ms": 0.008070945739746094, "ViewRequirementAgentConnector_ms": 0.20054864883422852}, "num_episodes": 33, "episode_return_max": -21.84900753717666, "episode_return_min": -1543.897947417223, "episode_return_mean": -571.194422970135, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.05461130572235, "num_env_steps_trained_throughput_per_sec": 288.05461130572235, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 13077.761, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13077.677, "sample_time_ms": 1525.728, "learn_time_ms": 11466.29, "learn_throughput": 348.849, "synch_weights_time_ms": 84.666}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "3541f_00000", "date": "2024-08-03_03-05-10", "timestamp": 1722634510, "time_this_iter_s": 13.898857593536377, "time_total_s": 1219.366866350174, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1219.366866350174, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.515789473684215, "ram_util_percent": 47.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 284.4299766341845, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 4.487996429949999, "policy_loss": -0.002753346704412252, "vf_loss": 4.489601207772891, "vf_explained_var": 0.9755343490590652, "kl": 0.00906403416217175, "entropy": 2.5234875002255044, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -21.84900753717666, "episode_reward_min": -1565.9462056597215, "episode_reward_mean": -628.8920551229534, "episode_len_mean": 129.2, "episode_media": {}, "episodes_timesteps_total": 12920, "policy_reward_min": {"policy_0": -1565.9462056597215}, "policy_reward_max": {"policy_0": -21.84900753717666}, "policy_reward_mean": {"policy_0": -628.8920551229534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094], "episode_lengths": [93, 65, 97, 150, 150, 101, 136, 110, 150, 150, 150, 94, 150, 105, 89, 150, 150, 150, 129, 150, 134, 150, 150, 150, 150, 150, 150, 51, 150, 150, 130, 150, 150, 150, 76, 150, 150, 150, 150, 150, 87, 146, 150, 150, 96, 150, 106, 150, 150, 92, 100, 109, 150, 129, 150, 150, 81, 150, 150, 150, 150, 131, 150, 52, 91, 89, 126, 150, 76, 150, 150, 100, 146, 150, 88, 100, 150, 150, 150, 145, 150, 150, 133, 40, 150, 150, 150, 150, 150, 150, 98, 101, 56, 82, 150, 150, 150, 150, 150, 60], "policy_policy_0_reward": [-258.25905336539086, -109.37383116031387, -213.75172702132798, -507.9718226084326, -912.6786383836816, -201.42016731164725, -389.6432672373456, -357.90787978520063, -536.0716540896237, -785.0063356814464, -937.5694937856213, -140.1088087549388, -1383.1922177022573, -224.01726580467806, -147.30027164465983, -1004.2294566461687, -873.2460909083851, -1297.2410418378797, -710.8119267669825, -859.8445197869751, -575.9472665716899, -1251.526376295371, -702.8844746376698, -621.699657068091, -982.0000951264077, -1019.8210257124296, -606.8075163205193, -114.76436306429977, -714.4549479399182, -1025.9651258718986, -439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6048649904879871, "mean_inference_ms": 1.8776766706792836, "mean_action_processing_ms": 0.30501395569814, "mean_env_wait_ms": 3.3429363176302047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227259635925293, "StateBufferConnector_ms": 0.008014440536499023, "ViewRequirementAgentConnector_ms": 0.2144923210144043}, "num_episodes": 31, "episode_return_max": -21.84900753717666, "episode_return_min": -1565.9462056597215, "episode_return_mean": -628.8920551229534, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.05892672564715, "num_env_steps_trained_throughput_per_sec": 308.05892672564715, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 13129.526, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13129.445, "sample_time_ms": 1510.222, "learn_time_ms": 11533.869, "learn_throughput": 346.805, "synch_weights_time_ms": 84.34}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "3541f_00000", "date": "2024-08-03_03-05-23", "timestamp": 1722634523, "time_this_iter_s": 12.996494054794312, "time_total_s": 1232.3633604049683, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1232.3633604049683, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.631578947368418, "ram_util_percent": 28.973684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.51997105081875, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 5.386918056259552, "policy_loss": -0.01541367631968266, "vf_loss": 5.39665682464838, "vf_explained_var": 0.9859444533785184, "kl": 0.011061559988866066, "entropy": 2.224965551495552, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": -21.84900753717666, "episode_reward_min": -1565.9462056597215, "episode_reward_mean": -614.4429781143092, "episode_len_mean": 127.05, "episode_media": {}, "episodes_timesteps_total": 12705, "policy_reward_min": {"policy_0": -1565.9462056597215}, "policy_reward_max": {"policy_0": -21.84900753717666}, "policy_reward_mean": {"policy_0": -614.4429781143092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615], "episode_lengths": [130, 150, 150, 150, 76, 150, 150, 150, 150, 150, 87, 146, 150, 150, 96, 150, 106, 150, 150, 92, 100, 109, 150, 129, 150, 150, 81, 150, 150, 150, 150, 131, 150, 52, 91, 89, 126, 150, 76, 150, 150, 100, 146, 150, 88, 100, 150, 150, 150, 145, 150, 150, 133, 40, 150, 150, 150, 150, 150, 150, 98, 101, 56, 82, 150, 150, 150, 150, 150, 60, 150, 89, 150, 150, 150, 102, 88, 51, 106, 62, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 64, 63, 150, 77, 150, 150, 96], "policy_policy_0_reward": [-439.3808828319764, -662.9139727598395, -1088.3782564741036, -999.4590335806803, -119.79045874639371, -706.1347108228699, -976.8061038295011, -611.3313743832233, -598.8855624256773, -1223.9882648820378, -188.19261381089058, -492.9611367644461, -1387.4268672570302, -1111.7687550078606, -167.96105906730355, -1159.1333423070741, -372.6001457842492, -553.4361616526786, -539.1212938807796, -124.1211751365515, -361.70318905506457, -333.4179125497322, -824.1729247543927, -394.4552631481466, -1019.8273252214781, -377.81785663771603, -257.46182327477135, -933.7925666028832, -446.54697538996805, -410.24422675824513, -513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6047703712168955, "mean_inference_ms": 1.8775924767496295, "mean_action_processing_ms": 0.30491740245370247, "mean_env_wait_ms": 3.3437406658114117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012114286422729492, "StateBufferConnector_ms": 0.008118152618408203, "ViewRequirementAgentConnector_ms": 0.21136069297790527}, "num_episodes": 30, "episode_return_max": -21.84900753717666, "episode_return_min": -1565.9462056597215, "episode_return_mean": -614.4429781143092, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7615150801788, "num_env_steps_trained_throughput_per_sec": 302.7615150801788, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 13078.478, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13078.4, "sample_time_ms": 1499.085, "learn_time_ms": 11501.442, "learn_throughput": 347.782, "synch_weights_time_ms": 76.934}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "3541f_00000", "date": "2024-08-03_03-05-36", "timestamp": 1722634536, "time_this_iter_s": 13.2232506275177, "time_total_s": 1245.586611032486, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f073a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1245.586611032486, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.215789473684207, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 257.9702371676763, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 4.679833195110162, "policy_loss": -0.007351802903576754, "vf_loss": 4.683646453917026, "vf_explained_var": 0.9808920520668228, "kl": 0.009730001216424474, "entropy": 2.247778539607922, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": -2.6388342250205334, "episode_reward_min": -1565.9462056597215, "episode_reward_mean": -616.0431363946403, "episode_len_mean": 124.46, "episode_media": {}, "episodes_timesteps_total": 12446, "policy_reward_min": {"policy_0": -1565.9462056597215}, "policy_reward_max": {"policy_0": -2.6388342250205334}, "policy_reward_mean": {"policy_0": -616.0431363946403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334], "episode_lengths": [150, 131, 150, 52, 91, 89, 126, 150, 76, 150, 150, 100, 146, 150, 88, 100, 150, 150, 150, 145, 150, 150, 133, 40, 150, 150, 150, 150, 150, 150, 98, 101, 56, 82, 150, 150, 150, 150, 150, 60, 150, 89, 150, 150, 150, 102, 88, 51, 106, 62, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 64, 63, 150, 77, 150, 150, 96, 150, 150, 150, 150, 90, 53, 150, 150, 91, 71, 150, 86, 150, 150, 127, 150, 91, 150, 106, 150, 111, 150, 150, 150, 137, 150, 41, 150, 150, 39], "policy_policy_0_reward": [-513.5304804160846, -353.4994140633328, -568.1523087557292, -21.84900753717666, -358.96752806371774, -279.64198645369, -638.4546056149915, -558.3440231437061, -126.60165042982786, -588.3300465837668, -1126.4946078382757, -432.509236369068, -337.68889556465086, -837.2679370018266, -138.54140969391048, -214.3820559196224, -885.4130960468563, -473.93944312063707, -1242.2291515442932, -918.3176278889509, -653.570476837936, -1193.5747753515284, -766.3711292996585, -30.042714242208568, -628.9608568708055, -1185.227264598647, -1153.169823250892, -781.4657520241817, -583.4415200853439, -1226.52293698116, -310.368424102237, -378.6546557657796, -51.98677328506388, -155.80915948848835, -1209.6826737171648, -755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6047045902236082, "mean_inference_ms": 1.877680969950451, "mean_action_processing_ms": 0.304965393303989, "mean_env_wait_ms": 3.3450706782731414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012174129486083984, "StateBufferConnector_ms": 0.008813619613647461, "ViewRequirementAgentConnector_ms": 0.2140028476715088}, "num_episodes": 30, "episode_return_max": -2.6388342250205334, "episode_return_min": -1565.9462056597215, "episode_return_mean": -616.0431363946403, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.06457532909394, "num_env_steps_trained_throughput_per_sec": 304.06457532909394, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 12971.407, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12971.331, "sample_time_ms": 1349.997, "learn_time_ms": 11545.062, "learn_throughput": 346.468, "synch_weights_time_ms": 75.332}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "3541f_00000", "date": "2024-08-03_03-05-49", "timestamp": 1722634549, "time_this_iter_s": 13.167367458343506, "time_total_s": 1258.7539784908295, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408ca60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1258.7539784908295, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.178947368421053, "ram_util_percent": 27.342105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 261.75008188287416, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 4.8185730189085, "policy_loss": -0.007879180108041813, "vf_loss": 4.822100851933161, "vf_explained_var": 0.9816135035206874, "kl": 0.010286372407366191, "entropy": 2.254213884472847, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": -2.6388342250205334, "episode_reward_min": -1565.9462056597215, "episode_reward_mean": -629.7741445703156, "episode_len_mean": 125.61, "episode_media": {}, "episodes_timesteps_total": 12561, "policy_reward_min": {"policy_0": -1565.9462056597215}, "policy_reward_max": {"policy_0": -2.6388342250205334}, "policy_reward_mean": {"policy_0": -629.7741445703156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334, -1094.8723502137873, -667.498449683656, -218.4007226448813, -1276.2985864396437, -114.85724746757518, -1555.5836577545742, -322.9356792978598, -215.55937204033694, -836.77070457645, -318.08597948961597, -355.27386701692524, -1213.3151437233278, -293.8193797894174, -1092.756202984552, -405.4559407555182, -111.19719269590563, -1208.4584922507927, -347.004688721215, -824.7882094343751, -77.55595195730969, -701.7481660968685, -481.5683832580061, -400.56049088334663, -871.3771100439275, -995.7179387483272, -1187.1570461339804, -710.8129573121143, -439.20311648686715, -696.5937600600166, -534.2534652115455, -1156.1073315756043, -424.66680653162405, -91.95019106667081, -60.73163285849757, -993.1680503136149], "episode_lengths": [150, 150, 150, 150, 60, 150, 89, 150, 150, 150, 102, 88, 51, 106, 62, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 64, 63, 150, 77, 150, 150, 96, 150, 150, 150, 150, 90, 53, 150, 150, 91, 71, 150, 86, 150, 150, 127, 150, 91, 150, 106, 150, 111, 150, 150, 150, 137, 150, 41, 150, 150, 39, 150, 150, 98, 150, 76, 150, 133, 102, 150, 86, 135, 150, 134, 150, 111, 62, 150, 120, 150, 74, 150, 110, 150, 150, 150, 150, 150, 148, 137, 112, 150, 138, 79, 64, 150], "policy_policy_0_reward": [-755.9264207538442, -753.9429234153831, -382.95646027377666, -1565.9462056597215, -158.68250055259094, -1428.1298412123276, -288.89918869018265, -1007.5487228161832, -811.9796182711134, -1045.3281917396564, -310.81330852432615, -154.99635300394996, -50.541080161913094, -239.54063117633837, -27.005515284730116, -275.00675682417756, -1419.677406638086, -673.7911216833144, -1001.8802519609162, -455.3594425810928, -1027.5548344820518, -1190.077279369811, -278.4956633401346, -576.0918498128556, -855.0037134756562, -147.8944710588109, -738.5796611959586, -418.93409802538645, -68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334, -1094.8723502137873, -667.498449683656, -218.4007226448813, -1276.2985864396437, -114.85724746757518, -1555.5836577545742, -322.9356792978598, -215.55937204033694, -836.77070457645, -318.08597948961597, -355.27386701692524, -1213.3151437233278, -293.8193797894174, -1092.756202984552, -405.4559407555182, -111.19719269590563, -1208.4584922507927, -347.004688721215, -824.7882094343751, -77.55595195730969, -701.7481660968685, -481.5683832580061, -400.56049088334663, -871.3771100439275, -995.7179387483272, -1187.1570461339804, -710.8129573121143, -439.20311648686715, -696.5937600600166, -534.2534652115455, -1156.1073315756043, -424.66680653162405, -91.95019106667081, -60.73163285849757, -993.1680503136149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6036086422963646, "mean_inference_ms": 1.8749192108858255, "mean_action_processing_ms": 0.30429057470761983, "mean_env_wait_ms": 3.3441112893727016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221336364746094, "StateBufferConnector_ms": 0.008686304092407227, "ViewRequirementAgentConnector_ms": 0.19789862632751465}, "num_episodes": 35, "episode_return_max": -2.6388342250205334, "episode_return_min": -1565.9462056597215, "episode_return_mean": -629.7741445703156, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.95954710574557, "num_env_steps_trained_throughput_per_sec": 306.95954710574557, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 12996.223, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12996.146, "sample_time_ms": 1326.015, "learn_time_ms": 11591.849, "learn_throughput": 345.07, "synch_weights_time_ms": 77.343}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "3541f_00000", "date": "2024-08-03_03-06-02", "timestamp": 1722634562, "time_this_iter_s": 13.04303526878357, "time_total_s": 1271.797013759613, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408e4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1271.797013759613, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.42222222222222, "ram_util_percent": 27.39444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 238.23828383485477, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 4.9279346692065396, "policy_loss": -0.013013214880387144, "vf_loss": 4.93239084209005, "vf_explained_var": 0.9863263609508673, "kl": 0.0124037590310764, "entropy": 2.0562317613512278, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": -2.6388342250205334, "episode_reward_min": -1555.5836577545742, "episode_reward_mean": -633.7363581641279, "episode_len_mean": 128.23, "episode_media": {}, "episodes_timesteps_total": 12823, "policy_reward_min": {"policy_0": -1555.5836577545742}, "policy_reward_max": {"policy_0": -2.6388342250205334}, "policy_reward_mean": {"policy_0": -633.7363581641279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334, -1094.8723502137873, -667.498449683656, -218.4007226448813, -1276.2985864396437, -114.85724746757518, -1555.5836577545742, -322.9356792978598, -215.55937204033694, -836.77070457645, -318.08597948961597, -355.27386701692524, -1213.3151437233278, -293.8193797894174, -1092.756202984552, -405.4559407555182, -111.19719269590563, -1208.4584922507927, -347.004688721215, -824.7882094343751, -77.55595195730969, -701.7481660968685, -481.5683832580061, -400.56049088334663, -871.3771100439275, -995.7179387483272, -1187.1570461339804, -710.8129573121143, -439.20311648686715, -696.5937600600166, -534.2534652115455, -1156.1073315756043, -424.66680653162405, -91.95019106667081, -60.73163285849757, -993.1680503136149, -529.781542905369, -403.0683468003942, -822.308614891478, -717.4133797758119, -222.48412818750813, -461.4013799764695, -343.1152002774429, -555.095338451683, -490.0855167348591, -1250.2755482061814, -932.2794689992425, -917.1346444206639, -1073.390884939797, -450.45355560801295, -958.1065989744301, -394.77299436140015, -348.05745608178546, -793.9402471031965, -1380.6602494501135, -708.4651733341933, -405.65880557788506, -901.8462027930028, -33.02606697279734, -351.5113536842816, -749.7770342305622, -669.7642044813292, -331.82823242160623, -1241.1027017240217], "episode_lengths": [64, 63, 150, 77, 150, 150, 96, 150, 150, 150, 150, 90, 53, 150, 150, 91, 71, 150, 86, 150, 150, 127, 150, 91, 150, 106, 150, 111, 150, 150, 150, 137, 150, 41, 150, 150, 39, 150, 150, 98, 150, 76, 150, 133, 102, 150, 86, 135, 150, 134, 150, 111, 62, 150, 120, 150, 74, 150, 110, 150, 150, 150, 150, 150, 148, 137, 112, 150, 138, 79, 64, 150, 150, 150, 150, 150, 109, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 127, 90, 150, 150, 150, 97, 150, 46, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-68.7718609045684, -112.60104493452269, -471.4848627156658, -75.84600214680492, -1204.2717019477157, -1495.7913412439864, -168.71280280458615, -638.2297167839771, -747.9524421926461, -826.3888528308865, -1396.6620787847776, -215.95323558869993, -25.689726512276323, -641.0128566585719, -955.6389354183373, -288.231678206707, -118.55211472920283, -820.2257331348403, -186.96829650011466, -405.9905371519774, -589.1567152575462, -573.947945791088, -687.4116897919589, -177.96184883094855, -1009.6420652560691, -360.2814212619198, -986.7644629725721, -379.2636889378789, -1155.103732480357, -652.3596953306842, -1296.7167609268777, -695.7496971820952, -1369.547288135771, -12.30081016618492, -998.6789388889614, -828.2252629017398, -2.6388342250205334, -1094.8723502137873, -667.498449683656, -218.4007226448813, -1276.2985864396437, -114.85724746757518, -1555.5836577545742, -322.9356792978598, -215.55937204033694, -836.77070457645, -318.08597948961597, -355.27386701692524, -1213.3151437233278, -293.8193797894174, -1092.756202984552, -405.4559407555182, -111.19719269590563, -1208.4584922507927, -347.004688721215, -824.7882094343751, -77.55595195730969, -701.7481660968685, -481.5683832580061, -400.56049088334663, -871.3771100439275, -995.7179387483272, -1187.1570461339804, -710.8129573121143, -439.20311648686715, -696.5937600600166, -534.2534652115455, -1156.1073315756043, -424.66680653162405, -91.95019106667081, -60.73163285849757, -993.1680503136149, -529.781542905369, -403.0683468003942, -822.308614891478, -717.4133797758119, -222.48412818750813, -461.4013799764695, -343.1152002774429, -555.095338451683, -490.0855167348591, -1250.2755482061814, -932.2794689992425, -917.1346444206639, -1073.390884939797, -450.45355560801295, -958.1065989744301, -394.77299436140015, -348.05745608178546, -793.9402471031965, -1380.6602494501135, -708.4651733341933, -405.65880557788506, -901.8462027930028, -33.02606697279734, -351.5113536842816, -749.7770342305622, -669.7642044813292, -331.82823242160623, -1241.1027017240217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6034645161803214, "mean_inference_ms": 1.8740782229880673, "mean_action_processing_ms": 0.3043955194313004, "mean_env_wait_ms": 3.340762090417809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012084722518920898, "StateBufferConnector_ms": 0.008643150329589844, "ViewRequirementAgentConnector_ms": 0.1979811191558838}, "num_episodes": 28, "episode_return_max": -2.6388342250205334, "episode_return_min": -1555.5836577545742, "episode_return_mean": -633.7363581641279, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.98452501874397, "num_env_steps_trained_throughput_per_sec": 303.98452501874397, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 13363.365, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13363.288, "sample_time_ms": 1309.439, "learn_time_ms": 11975.819, "learn_throughput": 334.006, "synch_weights_time_ms": 77.101}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "3541f_00000", "date": "2024-08-03_03-06-16", "timestamp": 1722634576, "time_this_iter_s": 13.171038389205933, "time_total_s": 1284.968052148819, "pid": 429874, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1284.968052148819, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.74736842105263, "ram_util_percent": 27.399999999999995}}
