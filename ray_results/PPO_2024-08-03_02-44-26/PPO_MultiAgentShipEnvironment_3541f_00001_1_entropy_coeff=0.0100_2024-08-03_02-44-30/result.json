{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.951449442251275, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.607676423589389, "policy_loss": -0.008306931548092204, "vf_loss": 9.628037163615227, "vf_explained_var": -0.001036361294488112, "kl": 0.012173762438093642, "entropy": 1.448853932072719, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -35.71692061812328, "episode_reward_min": -1180.8774566674765, "episode_reward_mean": -747.3401167590304, "episode_len_mean": 134.91666666666666, "episode_media": {}, "episodes_timesteps_total": 3238, "policy_reward_min": {"policy_0": -1180.8774566674765}, "policy_reward_max": {"policy_0": -35.71692061812328}, "policy_reward_mean": {"policy_0": -747.3401167590304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 71, 150, 150, 150, 150, 150, 86, 114, 53, 150], "policy_policy_0_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6053756962856048, "mean_inference_ms": 1.724738630037459, "mean_action_processing_ms": 0.29221980703549105, "mean_env_wait_ms": 3.094295847918339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01128216584523519, "StateBufferConnector_ms": 0.00797112782796224, "ViewRequirementAgentConnector_ms": 0.1780549685160319}, "num_episodes": 24, "episode_return_max": -35.71692061812328, "episode_return_min": -1180.8774566674765, "episode_return_mean": -747.3401167590304, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.73372335275025, "num_env_steps_trained_throughput_per_sec": 314.73372335275025, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12709.165, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12709.105, "sample_time_ms": 1082.863, "learn_time_ms": 11562.713, "learn_throughput": 345.94, "synch_weights_time_ms": 62.81}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "3541f_00001", "date": "2024-08-03_03-06-46", "timestamp": 1722634606, "time_this_iter_s": 12.721433162689209, "time_total_s": 12.721433162689209, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.721433162689209, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.83157894736842, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0970560449796418, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.574171103040378, "policy_loss": -0.005113464653550182, "vf_loss": 9.591853707035382, "vf_explained_var": 0.1184856727719307, "kl": 0.010179979861307704, "entropy": 1.4605153946826854, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -35.71692061812328, "episode_reward_min": -1180.8774566674765, "episode_reward_mean": -753.6659237764628, "episode_len_mean": 140.08333333333334, "episode_media": {}, "episodes_timesteps_total": 6724, "policy_reward_min": {"policy_0": -1180.8774566674765}, "policy_reward_max": {"policy_0": -35.71692061812328}, "policy_reward_mean": {"policy_0": -753.6659237764628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 71, 150, 150, 150, 150, 150, 86, 114, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150], "policy_policy_0_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.592275477455417, "mean_inference_ms": 1.7166459613516676, "mean_action_processing_ms": 0.2908640306342222, "mean_env_wait_ms": 3.069447157316626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014004111289978027, "StateBufferConnector_ms": 0.008090337117513021, "ViewRequirementAgentConnector_ms": 0.18074661493301392}, "num_episodes": 24, "episode_return_max": -35.71692061812328, "episode_return_min": -1180.8774566674765, "episode_return_mean": -753.6659237764628, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.19589567983616, "num_env_steps_trained_throughput_per_sec": 307.19589567983616, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12865.091, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12865.031, "sample_time_ms": 1058.046, "learn_time_ms": 11746.007, "learn_throughput": 340.541, "synch_weights_time_ms": 60.264}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "3541f_00001", "date": "2024-08-03_03-06-59", "timestamp": 1722634619, "time_this_iter_s": 13.032671928405762, "time_total_s": 25.75410509109497, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.75410509109497, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.33333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1597552959807218, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.615833191076915, "policy_loss": -0.010532436039648018, "vf_loss": 9.63837473789851, "vf_explained_var": 0.09821456416199605, "kl": 0.013543842617938633, "entropy": 1.4717880251506965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -35.71692061812328, "episode_reward_min": -1244.626716577294, "episode_reward_mean": -752.4990572442933, "episode_len_mean": 141.12328767123287, "episode_media": {}, "episodes_timesteps_total": 10302, "policy_reward_min": {"policy_0": -1244.626716577294}, "policy_reward_max": {"policy_0": -35.71692061812328}, "policy_reward_mean": {"policy_0": -752.4990572442933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 71, 150, 150, 150, 150, 150, 86, 114, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150], "policy_policy_0_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.587284952675382, "mean_inference_ms": 1.7159954587672213, "mean_action_processing_ms": 0.2906716025360467, "mean_env_wait_ms": 3.062425826720222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013573528969124572, "StateBufferConnector_ms": 0.008276390702757116, "ViewRequirementAgentConnector_ms": 0.18541420975776568}, "num_episodes": 25, "episode_return_max": -35.71692061812328, "episode_return_min": -1244.626716577294, "episode_return_mean": -752.4990572442933, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.42310316633706, "num_env_steps_trained_throughput_per_sec": 396.42310316633706, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11940.141, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11940.08, "sample_time_ms": 1096.998, "learn_time_ms": 10786.566, "learn_throughput": 370.832, "synch_weights_time_ms": 55.809}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "3541f_00001", "date": "2024-08-03_03-07-09", "timestamp": 1722634629, "time_this_iter_s": 10.103322505950928, "time_total_s": 35.8574275970459, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.8574275970459, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.89333333333333, "ram_util_percent": 27.273333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8817385268708071, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.410527577002844, "policy_loss": -0.012833894596163494, "vf_loss": 9.43465540210406, "vf_explained_var": 0.11101352063318094, "kl": 0.016785188380072216, "entropy": 1.4650954763094584, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -7.113480863400949, "episode_reward_min": -1387.3854464060546, "episode_reward_mean": -766.6408245907277, "episode_len_mean": 139.91919191919192, "episode_media": {}, "episodes_timesteps_total": 13852, "policy_reward_min": {"policy_0": -1387.3854464060546}, "policy_reward_max": {"policy_0": -7.113480863400949}, "policy_reward_mean": {"policy_0": -766.6408245907277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 71, 150, 150, 150, 150, 150, 86, 114, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 147, 150, 150, 150, 117, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 146, 114, 83], "policy_policy_0_reward": [-730.6932840100311, -900.9186785444156, -921.1909608795122, -494.6448835564499, -1180.8774566674765, -1097.2748389772944, -1066.1207516103468, -512.2314976914454, -1113.5279954929988, -803.3951632088036, -748.7496525322491, -1018.3015762966452, -35.71692061812328, -993.6312177305219, -235.62593608146136, -874.2321863387411, -1078.0197541258171, -805.8237906905752, -803.1545224764425, -953.1056403976677, -269.75857458897224, -399.94751269625255, -62.734270361988585, -836.485736642497, -606.3919610166106, -453.78324441964867, -704.601350808759, -1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5829813875812224, "mean_inference_ms": 1.7144387819153277, "mean_action_processing_ms": 0.2898480076790152, "mean_env_wait_ms": 3.0563495954653495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014104024328366674, "StateBufferConnector_ms": 0.008383905044709794, "ViewRequirementAgentConnector_ms": 0.18605776507445057}, "num_episodes": 26, "episode_return_max": -7.113480863400949, "episode_return_min": -1387.3854464060546, "episode_return_mean": -766.6408245907277, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.2083949446304, "num_env_steps_trained_throughput_per_sec": 302.2083949446304, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12264.083, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12264.023, "sample_time_ms": 1079.372, "learn_time_ms": 11125.336, "learn_throughput": 359.54, "synch_weights_time_ms": 58.568}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "3541f_00001", "date": "2024-08-03_03-07-22", "timestamp": 1722634642, "time_this_iter_s": 13.24765157699585, "time_total_s": 49.10507917404175, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408eb00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.10507917404175, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.48888888888889, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0737968852743505, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.283054474492868, "policy_loss": -0.011674791077772776, "vf_loss": 9.305511030058065, "vf_explained_var": 0.24375993019590775, "kl": 0.017259214165475593, "entropy": 1.423358108351628, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -7.113480863400949, "episode_reward_min": -1387.3854464060546, "episode_reward_mean": -765.0771535304368, "episode_len_mean": 141.56, "episode_media": {}, "episodes_timesteps_total": 14156, "policy_reward_min": {"policy_0": -1387.3854464060546}, "policy_reward_max": {"policy_0": -7.113480863400949}, "policy_reward_mean": {"policy_0": -765.0771535304368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273], "episode_lengths": [150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 147, 150, 150, 150, 117, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 146, 114, 83, 150, 150, 150, 150, 101, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1082.50771988862, -537.18426499611, -1079.4050120460804, -840.9625672541858, -974.0599337012461, -93.81825053236761, -865.7435659050333, -970.8247208045017, -407.9157285441003, -976.2220821159262, -959.2528077846375, -568.2436409753499, -552.1709611964304, -721.853865364384, -973.6482594479347, -1018.4785568368296, -1165.490795881977, -303.61751296083645, -800.4566683935086, -726.6522699192244, -856.5157982591851, -397.35990265444605, -915.6382206982303, -286.49565333641084, -1090.794374110433, -733.1843666226603, -974.1587725486285, -553.9587295893199, -358.7130503365103, -923.3152313028546, -1132.413812071171, -866.7877912449869, -338.4859381843116, -1244.626716577294, -698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5736867501689636, "mean_inference_ms": 1.711201222296489, "mean_action_processing_ms": 0.28870182263128613, "mean_env_wait_ms": 3.041606925830574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01439523696899414, "StateBufferConnector_ms": 0.008672952651977539, "ViewRequirementAgentConnector_ms": 0.19141793251037598}, "num_episodes": 28, "episode_return_max": -7.113480863400949, "episode_return_min": -1387.3854464060546, "episode_return_mean": -765.0771535304368, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.82403883791415, "num_env_steps_trained_throughput_per_sec": 307.82403883791415, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12410.156, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12410.095, "sample_time_ms": 1067.645, "learn_time_ms": 11282.67, "learn_throughput": 354.526, "synch_weights_time_ms": 59.024}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "3541f_00001", "date": "2024-08-03_03-07-35", "timestamp": 1722634655, "time_this_iter_s": 13.006234169006348, "time_total_s": 62.111313343048096, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.111313343048096, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.131578947368425, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.898024974949658, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.120751491189003, "policy_loss": -0.011826881307448881, "vf_loss": 9.143371705710887, "vf_explained_var": 0.2743418860559662, "kl": 0.014979637037383024, "entropy": 1.3789279412478208, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -7.113480863400949, "episode_reward_min": -1387.3854464060546, "episode_reward_mean": -734.8926548992885, "episode_len_mean": 139.41, "episode_media": {}, "episodes_timesteps_total": 13941, "policy_reward_min": {"policy_0": -1387.3854464060546}, "policy_reward_max": {"policy_0": -7.113480863400949}, "policy_reward_mean": {"policy_0": -734.8926548992885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 147, 150, 150, 150, 117, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 146, 114, 83, 150, 150, 150, 150, 101, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 111, 132, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 135, 150, 126, 150, 150, 143, 150, 139, 150, 150, 75, 150, 70, 150, 65], "policy_policy_0_reward": [-698.4675335903489, -599.2086503022329, -615.3316369641826, -230.9359290317421, -917.2909711891359, -814.6124833851525, -1059.7838130395664, -289.2100683293385, -1075.3815903549753, -815.3013665364621, -665.8674972995744, -1159.1427382632282, -753.9048789558299, -594.7287434709299, -724.3015589649548, -1168.2053808138444, -1007.041989709286, -431.67202815389345, -1043.0083083312554, -1194.7043550599733, -954.492736487629, -146.61397972136615, -491.06511284381793, -1024.5078832699824, -955.046524169449, -810.3739508899798, -831.5034642905489, -1153.158459713921, -795.5046829063439, -975.489682013652, -1201.2410747893564, -1069.2259655095324, -7.113480863400949, -969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682108684909406, "mean_inference_ms": 1.7030027552545528, "mean_action_processing_ms": 0.2874552799080125, "mean_env_wait_ms": 3.0311200122370154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014019012451171875, "StateBufferConnector_ms": 0.008677244186401367, "ViewRequirementAgentConnector_ms": 0.1911160945892334}, "num_episodes": 34, "episode_return_max": -7.113480863400949, "episode_return_min": -1387.3854464060546, "episode_return_mean": -734.8926548992885, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.79952645151354, "num_env_steps_trained_throughput_per_sec": 316.79952645151354, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12446.179, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12446.117, "sample_time_ms": 1064.092, "learn_time_ms": 11321.76, "learn_throughput": 353.302, "synch_weights_time_ms": 59.511}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "3541f_00001", "date": "2024-08-03_03-07-48", "timestamp": 1722634668, "time_this_iter_s": 12.638391017913818, "time_total_s": 74.74970436096191, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.74970436096191, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.527777777777782, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.679206098740299, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.111251184344292, "policy_loss": -0.008483230842102785, "vf_loss": 9.12998245805502, "vf_explained_var": 0.39230439737439154, "kl": 0.015000559993010643, "entropy": 1.324812205756704, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -22.99691630055042, "episode_reward_min": -1387.3854464060546, "episode_reward_mean": -695.6423570864098, "episode_len_mean": 136.37, "episode_media": {}, "episodes_timesteps_total": 13637, "policy_reward_min": {"policy_0": -1387.3854464060546}, "policy_reward_max": {"policy_0": -22.99691630055042}, "policy_reward_mean": {"policy_0": -695.6423570864098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112], "episode_lengths": [150, 150, 146, 114, 83, 150, 150, 150, 150, 101, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 111, 132, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 135, 150, 126, 150, 150, 143, 150, 139, 150, 150, 75, 150, 70, 150, 65, 150, 100, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 61, 150, 150, 89, 150, 150, 65, 150], "policy_policy_0_reward": [-969.2490398153672, -1387.3854464060546, -736.4026309946472, -308.63011580642916, -230.43898169717252, -1029.400939713015, -277.41756515055573, -1279.3266646128689, -986.8300361252418, -128.31894439968215, -22.99691630055042, -959.8679009268767, -379.844331834342, -824.6338418250047, -720.4925765041836, -767.7670266963048, -1005.7502314847497, -1157.8352772277453, -1120.3540312756354, -1026.7390171017853, -1044.485729382482, -903.000649845983, -1165.3677169370847, -662.1066832970072, -172.24486782183476, -748.1455218020562, -572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5667932576566692, "mean_inference_ms": 1.7025650157377283, "mean_action_processing_ms": 0.28654389504660566, "mean_env_wait_ms": 3.03061215984032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01370692253112793, "StateBufferConnector_ms": 0.00857090950012207, "ViewRequirementAgentConnector_ms": 0.19703888893127441}, "num_episodes": 33, "episode_return_max": -22.99691630055042, "episode_return_min": -1387.3854464060546, "episode_return_mean": -695.6423570864098, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.940431621371, "num_env_steps_trained_throughput_per_sec": 426.940431621371, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12006.582, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12006.52, "sample_time_ms": 1064.114, "learn_time_ms": 10882.221, "learn_throughput": 367.572, "synch_weights_time_ms": 59.435}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "3541f_00001", "date": "2024-08-03_03-07-58", "timestamp": 1722634678, "time_this_iter_s": 9.382896184921265, "time_total_s": 84.13260054588318, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.13260054588318, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.207692307692305, "ram_util_percent": 27.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.479547658686837, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.113813961545626, "policy_loss": -0.012479616085086794, "vf_loss": 9.13662699063619, "vf_explained_var": 0.3145631145065029, "kl": 0.019095165268602925, "entropy": 1.4152430741737285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -28.41716167690995, "episode_reward_min": -1259.6540111624436, "episode_reward_mean": -707.4946347301141, "episode_len_mean": 136.17, "episode_media": {}, "episodes_timesteps_total": 13617, "policy_reward_min": {"policy_0": -1259.6540111624436}, "policy_reward_max": {"policy_0": -28.41716167690995}, "policy_reward_mean": {"policy_0": -707.4946347301141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 111, 132, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 135, 150, 126, 150, 150, 143, 150, 139, 150, 150, 75, 150, 70, 150, 65, 150, 100, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 61, 150, 150, 89, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 64, 150], "policy_policy_0_reward": [-572.6586334469881, -644.9631113004068, -466.22246574601803, -900.1072425493862, -154.5856571188559, -433.60457774932877, -756.1449188474273, -437.1757039391051, -586.8525097314134, -1126.7326779982325, -1117.5325869941353, -859.7717288818976, -852.435833258089, -156.55891151612437, -1234.7206796086127, -665.826109397436, -1255.8015842679013, -865.9316820664776, -350.07508958016535, -355.6963774438285, -1065.5609011111828, -948.4980072471488, -785.4781161565278, -234.89305520845238, -698.3488343837294, -1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5655283641172535, "mean_inference_ms": 1.6980957218894435, "mean_action_processing_ms": 0.2854609099783309, "mean_env_wait_ms": 3.0271648125523574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013338088989257812, "StateBufferConnector_ms": 0.008192300796508789, "ViewRequirementAgentConnector_ms": 0.19353675842285156}, "num_episodes": 26, "episode_return_max": -28.41716167690995, "episode_return_min": -1259.6540111624436, "episode_return_mean": -707.4946347301141, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.38727857927825, "num_env_steps_trained_throughput_per_sec": 507.38727857927825, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11491.201, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11491.138, "sample_time_ms": 1057.977, "learn_time_ms": 10374.032, "learn_throughput": 385.578, "synch_weights_time_ms": 58.386}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "3541f_00001", "date": "2024-08-03_03-08-06", "timestamp": 1722634686, "time_this_iter_s": 7.89609169960022, "time_total_s": 92.0286922454834, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.0286922454834, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.85833333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.936332837243874, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.529571744302908, "policy_loss": -0.010799539280318035, "vf_loss": 8.550616022447745, "vf_explained_var": 0.6340800357361634, "kl": 0.01863840426049138, "entropy": 1.3972455769777299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -28.41716167690995, "episode_reward_min": -1271.4446057757216, "episode_reward_mean": -722.6782211268597, "episode_len_mean": 136.34, "episode_media": {}, "episodes_timesteps_total": 13634, "policy_reward_min": {"policy_0": -1271.4446057757216}, "policy_reward_max": {"policy_0": -28.41716167690995}, "policy_reward_mean": {"policy_0": -722.6782211268597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114], "episode_lengths": [150, 135, 150, 126, 150, 150, 143, 150, 139, 150, 150, 75, 150, 70, 150, 65, 150, 100, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 61, 150, 150, 89, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 111], "policy_policy_0_reward": [-1179.301359702589, -336.6524836197725, -617.3031690211284, -465.3058180342442, -571.3697805893964, -885.2861964825081, -364.3445889445479, -1253.7214678187627, -519.2096912227186, -780.8638121037432, -857.4048850614574, -211.25410420524452, -375.25560613350797, -100.30714012320198, -1067.7089997444505, -89.32818737313941, -827.340740491441, -330.92541836231345, -984.7320991028589, -735.0978813280462, -1104.4249828608833, -562.700164188867, -1011.583557645975, -140.69428998823346, -684.5213950599702, -750.3305155336386, -579.1626795177207, -100.68514345010442, -211.824061775836, -1160.9152799156823, -1028.6238529589368, -773.6564677876682, -904.9740386488785, -982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636363173627493, "mean_inference_ms": 1.6935444714722712, "mean_action_processing_ms": 0.2842382578711431, "mean_env_wait_ms": 3.0193698942475895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012870311737060547, "StateBufferConnector_ms": 0.007968902587890625, "ViewRequirementAgentConnector_ms": 0.19134926795959473}, "num_episodes": 25, "episode_return_max": -28.41716167690995, "episode_return_min": -1271.4446057757216, "episode_return_mean": -722.6782211268597, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2746243731922, "num_env_steps_trained_throughput_per_sec": 307.2746243731922, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11660.81, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11660.747, "sample_time_ms": 1059.125, "learn_time_ms": 10541.778, "learn_throughput": 379.443, "synch_weights_time_ms": 59.099}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "3541f_00001", "date": "2024-08-03_03-08-19", "timestamp": 1722634699, "time_this_iter_s": 13.029414653778076, "time_total_s": 105.05810689926147, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408eb00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.05810689926147, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.33333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.069967287654679, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.64854291677475, "policy_loss": -0.013743922474289624, "vf_loss": 8.670963444312413, "vf_explained_var": 0.6675490152090788, "kl": 0.01961735018968891, "entropy": 1.260005682085951, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6.311874877219747, "episode_reward_min": -1271.4446057757216, "episode_reward_mean": -717.4776944075124, "episode_len_mean": 135.08, "episode_media": {}, "episodes_timesteps_total": 13508, "policy_reward_min": {"policy_0": -1271.4446057757216}, "policy_reward_max": {"policy_0": -6.311874877219747}, "policy_reward_mean": {"policy_0": -717.4776944075124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848], "episode_lengths": [150, 150, 150, 150, 150, 74, 150, 150, 61, 150, 150, 89, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 150, 150, 150, 78, 113, 150, 150, 150, 150, 150, 150, 58, 150, 47, 88, 150, 70, 95, 91, 96], "policy_policy_0_reward": [-982.4775258872975, -1224.4147149525118, -413.17685218375004, -1022.7610900695021, -778.2105234609594, -81.95603346748796, -823.4894318187318, -955.2819510954376, -50.507311527448636, -977.3287864701849, -564.2518678057091, -196.55707266940732, -652.6573759615898, -976.3455750815997, -111.58725197313929, -645.2128048852112, -1040.034347375834, -1064.3716553041127, -1259.6540111624436, -852.8088680107077, -1073.578490560387, -1131.4896838451689, -28.41716167690995, -895.6219206076573, -769.3310260846397, -619.0424820876515, -147.50227048650402, -1090.7381428874276, -676.7843290398981, -1017.1578526842574, -1083.893084299517, -762.4755160175224, -767.6078992029599, -783.1056979231059, -827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613862441013749, "mean_inference_ms": 1.6921313891551781, "mean_action_processing_ms": 0.28319073993713206, "mean_env_wait_ms": 3.019713162849867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012070178985595703, "StateBufferConnector_ms": 0.007749080657958984, "ViewRequirementAgentConnector_ms": 0.186936616897583}, "num_episodes": 33, "episode_return_max": -6.311874877219747, "episode_return_min": -1271.4446057757216, "episode_return_mean": -717.4776944075124, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.9868658781446, "num_env_steps_trained_throughput_per_sec": 303.9868658781446, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11810.577, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11810.512, "sample_time_ms": 1054.894, "learn_time_ms": 10695.284, "learn_throughput": 373.997, "synch_weights_time_ms": 59.585}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "3541f_00001", "date": "2024-08-03_03-08-32", "timestamp": 1722634712, "time_this_iter_s": 13.173065185546875, "time_total_s": 118.23117208480835, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.23117208480835, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.5563507946829, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.9930964405337965, "policy_loss": -0.014715090453682933, "vf_loss": 8.014707595606644, "vf_explained_var": 0.7539672313878933, "kl": 0.023580218036295265, "entropy": 1.161211570724845, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -6.311874877219747, "episode_reward_min": -1271.4446057757216, "episode_reward_mean": -684.992165929778, "episode_len_mean": 134.22, "episode_media": {}, "episodes_timesteps_total": 13422, "policy_reward_min": {"policy_0": -1271.4446057757216}, "policy_reward_max": {"policy_0": -6.311874877219747}, "policy_reward_mean": {"policy_0": -684.992165929778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056], "episode_lengths": [150, 150, 150, 79, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 150, 150, 150, 78, 113, 150, 150, 150, 150, 150, 150, 58, 150, 47, 88, 150, 70, 95, 91, 96, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 115, 92, 150, 52, 105, 116, 116, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-827.4321908425848, -1075.7419918665996, -918.2631776554774, -193.6949713291534, -1005.5913910613162, -803.0145301685502, -124.85771365340975, -1188.0500435212932, -1117.8643790992423, -1002.4346247467556, -864.1804871528494, -839.6568876271438, -818.030197809739, -621.9815947801433, -943.1365909049066, -783.2894042989811, -392.31562198833234, -522.3875411881965, -809.4887577539968, -954.8565935171796, -110.40480320872693, -885.9099579021492, -1207.4040377817753, -858.3667078247036, -866.1564520640608, -1271.4446057757216, -682.5729350901074, -568.0827998289025, -298.7287720919915, -888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597293027175541, "mean_inference_ms": 1.69162443894017, "mean_action_processing_ms": 0.28246767486034874, "mean_env_wait_ms": 3.0203059616963803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012025594711303711, "StateBufferConnector_ms": 0.00777888298034668, "ViewRequirementAgentConnector_ms": 0.18903255462646484}, "num_episodes": 34, "episode_return_max": -6.311874877219747, "episode_return_min": -1271.4446057757216, "episode_return_mean": -684.992165929778, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.623464209721, "num_env_steps_trained_throughput_per_sec": 314.623464209721, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11811.022, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11810.956, "sample_time_ms": 1053.843, "learn_time_ms": 10693.691, "learn_throughput": 374.052, "synch_weights_time_ms": 62.666}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "3541f_00001", "date": "2024-08-03_03-08-45", "timestamp": 1722634725, "time_this_iter_s": 12.722623586654663, "time_total_s": 130.953795671463, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.953795671463, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.966666666666665, "ram_util_percent": 26.894444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.6407792031765, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.567046950260798, "policy_loss": -0.015669769449838594, "vf_loss": 7.588665701448917, "vf_explained_var": 0.7773395940040548, "kl": 0.019816974691411828, "entropy": 1.1894081262250742, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -6.311874877219747, "episode_reward_min": -1299.931909597055, "episode_reward_mean": -635.9495287133558, "episode_len_mean": 130.31, "episode_media": {}, "episodes_timesteps_total": 13031, "policy_reward_min": {"policy_0": -1299.931909597055}, "policy_reward_max": {"policy_0": -6.311874877219747}, "policy_reward_mean": {"policy_0": -635.9495287133558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024], "episode_lengths": [150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 150, 150, 150, 78, 113, 150, 150, 150, 150, 150, 150, 58, 150, 47, 88, 150, 70, 95, 91, 96, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 115, 92, 150, 52, 105, 116, 116, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 114, 150, 150, 150, 47, 150, 150, 65, 150, 69, 150, 150, 150, 47, 150, 70, 150, 150, 150, 118, 112, 150], "policy_policy_0_reward": [-888.8279361687297, -887.0797051781648, -618.7091429481748, -231.22509849277114, -1001.3848011458355, -1013.6019784272115, -319.22316349529626, -1184.4682130566594, -1071.628145045477, -1268.444462943133, -1105.486221149149, -841.8974192438328, -673.2762034927308, -883.7303899182131, -130.51388649073542, -721.2236624914892, -1042.6275368057482, -901.4235987812457, -917.3034508290457, -582.5289169016318, -167.55877012815, -372.8864564285744, -674.5750107398469, -939.78785077521, -1209.4627220871146, -602.5551481569331, -594.4600013932442, -1075.5264302541718, -77.6396638182195, -216.1270328400738, -6.311874877219747, -219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591350265820728, "mean_inference_ms": 1.689799989578339, "mean_action_processing_ms": 0.2820161090461356, "mean_env_wait_ms": 3.015566574811234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011761188507080078, "StateBufferConnector_ms": 0.007848739624023438, "ViewRequirementAgentConnector_ms": 0.19157910346984863}, "num_episodes": 29, "episode_return_max": -6.311874877219747, "episode_return_min": -1299.931909597055, "episode_return_mean": -635.9495287133558, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.528132430312, "num_env_steps_trained_throughput_per_sec": 441.528132430312, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11414.867, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11414.796, "sample_time_ms": 1058.915, "learn_time_ms": 10292.357, "learn_throughput": 388.638, "synch_weights_time_ms": 62.763}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "3541f_00001", "date": "2024-08-03_03-08-54", "timestamp": 1722634734, "time_this_iter_s": 9.072096824645996, "time_total_s": 140.025892496109, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4128ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.025892496109, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.799999999999997, "ram_util_percent": 27.21538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.842611730098724, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.570386865238349, "policy_loss": -0.011255533917574213, "vf_loss": 7.586409254868825, "vf_explained_var": 0.8494098223124941, "kl": 0.020261936968260365, "entropy": 1.084542011655867, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -6.774730663171295, "episode_reward_min": -1299.931909597055, "episode_reward_mean": -582.3331121836235, "episode_len_mean": 128.24, "episode_media": {}, "episodes_timesteps_total": 12824, "policy_reward_min": {"policy_0": -1299.931909597055}, "policy_reward_max": {"policy_0": -6.774730663171295}, "policy_reward_mean": {"policy_0": -582.3331121836235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497], "episode_lengths": [88, 150, 70, 95, 91, 96, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 115, 92, 150, 52, 105, 116, 116, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 114, 150, 150, 150, 47, 150, 150, 65, 150, 69, 150, 150, 150, 47, 150, 70, 150, 150, 150, 118, 112, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 90, 150, 79, 55, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 87, 150, 141, 44, 150, 62, 150], "policy_policy_0_reward": [-219.63158636282552, -574.8229993365535, -65.7738776186749, -211.04300848452763, -265.794108301612, -114.03859504236848, -920.0191717276097, -801.3079201872464, -1020.02998977953, -70.40462058537109, -508.91854211163235, -882.0079753189332, -864.4247649078213, -1047.4391701142458, -1210.2201425669111, -988.8917744866568, -1038.2801615690898, -713.654445525734, -44.264859902065666, -1102.2064941923231, -614.3170449598401, -747.994418293354, -544.4479910999054, -129.534933183799, -656.2676191768968, -41.890965646363355, -372.81358109404505, -242.43370921869905, -215.1193817004981, -802.9457155169063, -1045.6687131013368, -335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585636181966324, "mean_inference_ms": 1.6884578997869781, "mean_action_processing_ms": 0.2817343988044576, "mean_env_wait_ms": 3.0141281439803236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199650764465332, "StateBufferConnector_ms": 0.00785684585571289, "ViewRequirementAgentConnector_ms": 0.19310665130615234}, "num_episodes": 31, "episode_return_max": -6.774730663171295, "episode_return_min": -1299.931909597055, "episode_return_mean": -582.3331121836235, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.7887331199048, "num_env_steps_trained_throughput_per_sec": 296.7887331199048, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11753.604, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11753.532, "sample_time_ms": 1048.911, "learn_time_ms": 10638.524, "learn_throughput": 375.992, "synch_weights_time_ms": 65.328}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "3541f_00001", "date": "2024-08-03_03-09-07", "timestamp": 1722634747, "time_this_iter_s": 13.490210056304932, "time_total_s": 153.51610255241394, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408e440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.51610255241394, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.82, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.42324567784866, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.759182263414065, "policy_loss": -0.014698348165256902, "vf_loss": 7.779774657885233, "vf_explained_var": 0.8098168851186832, "kl": 0.014528476051236807, "entropy": 1.243185874633491, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -6.774730663171295, "episode_reward_min": -1299.931909597055, "episode_reward_mean": -611.1092027823287, "episode_len_mean": 130.65, "episode_media": {}, "episodes_timesteps_total": 13065, "policy_reward_min": {"policy_0": -1299.931909597055}, "policy_reward_max": {"policy_0": -6.774730663171295}, "policy_reward_mean": {"policy_0": -611.1092027823287}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787], "episode_lengths": [150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 114, 150, 150, 150, 47, 150, 150, 65, 150, 69, 150, 150, 150, 47, 150, 70, 150, 150, 150, 118, 112, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 90, 150, 79, 55, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 87, 150, 141, 44, 150, 62, 150, 150, 44, 150, 150, 74, 150, 66, 150, 150, 150, 133, 110, 150, 150, 150, 150, 53, 150, 150, 150, 84, 150, 150, 150, 150, 150, 140, 150, 150, 85, 150], "policy_policy_0_reward": [-335.92370753910984, -1053.378519757059, -157.37933412201446, -931.844586260973, -721.6716376806579, -367.3241904244457, -365.20724554477584, -831.606868050041, -881.4375654473056, -726.9255405908525, -750.6392515337203, -100.11752182885621, -619.9284511527666, -903.1188636498173, -1299.931909597055, -513.6135761749382, -322.0086132106095, -828.7893529904024, -1117.0688770652825, -1020.0098881573908, -6.774730663171295, -756.7881849902906, -901.7973942670185, -90.13139041042984, -845.1299716830684, -54.59475509854677, -787.6418213798258, -1109.7564524604743, -1172.6103043940136, -34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588142077528119, "mean_inference_ms": 1.6871853878388914, "mean_action_processing_ms": 0.2816422886221421, "mean_env_wait_ms": 3.010458038036887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011780977249145508, "StateBufferConnector_ms": 0.00787210464477539, "ViewRequirementAgentConnector_ms": 0.1920921802520752}, "num_episodes": 31, "episode_return_max": -6.774730663171295, "episode_return_min": -1299.931909597055, "episode_return_mean": -611.1092027823287, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6867158247724, "num_env_steps_trained_throughput_per_sec": 304.6867158247724, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11742.838, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11742.765, "sample_time_ms": 1047.885, "learn_time_ms": 10629.638, "learn_throughput": 376.306, "synch_weights_time_ms": 64.478}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "3541f_00001", "date": "2024-08-03_03-09-20", "timestamp": 1722634760, "time_this_iter_s": 13.140036344528198, "time_total_s": 166.65613889694214, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.65613889694214, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.13888888888889, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.49475589742263, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.736061836779117, "policy_loss": -0.013025099059935505, "vf_loss": 6.755082130432129, "vf_explained_var": 0.7984637387717763, "kl": 0.01638141173013234, "entropy": 1.3366849288344382, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -9.861229732914856, "episode_reward_min": -1364.9645911685952, "episode_reward_mean": -605.1751763001432, "episode_len_mean": 131.45, "episode_media": {}, "episodes_timesteps_total": 13145, "policy_reward_min": {"policy_0": -1364.9645911685952}, "policy_reward_max": {"policy_0": -9.861229732914856}, "policy_reward_mean": {"policy_0": -605.1751763001432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277], "episode_lengths": [47, 150, 70, 150, 150, 150, 118, 112, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 90, 150, 79, 55, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 87, 150, 141, 44, 150, 62, 150, 150, 44, 150, 150, 74, 150, 66, 150, 150, 150, 133, 110, 150, 150, 150, 150, 53, 150, 150, 150, 84, 150, 150, 150, 150, 150, 140, 150, 150, 85, 150, 150, 150, 150, 123, 150, 100, 150, 150, 150, 150, 150, 150, 87, 150, 150, 75, 117, 143, 150, 150, 150, 150, 150, 49, 121, 150, 150, 124, 150], "policy_policy_0_reward": [-34.979529173733795, -522.6576239198945, -49.57913305405108, -672.8787415645887, -232.9235069383394, -1015.0925606211329, -266.5024970645346, -241.00114128749013, -688.0844559695024, -504.3796833344203, -903.3330311686409, -826.4171291642614, -516.753178123786, -232.77381019803687, -733.6160018743666, -598.2377216482339, -776.8133651084117, -1141.012616385955, -858.148941904217, -290.80813742627066, -923.9874750945515, -76.93901393198777, -47.98395902458175, -792.7137921094654, -585.9453829816521, -587.8039553096479, -452.2357626255782, -751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581201046147501, "mean_inference_ms": 1.6864142072838042, "mean_action_processing_ms": 0.28134202534441405, "mean_env_wait_ms": 3.0122077924087325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011807441711425781, "StateBufferConnector_ms": 0.007822751998901367, "ViewRequirementAgentConnector_ms": 0.19186043739318848}, "num_episodes": 29, "episode_return_max": -9.861229732914856, "episode_return_min": -1364.9645911685952, "episode_return_mean": -605.1751763001432, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.7630853416685, "num_env_steps_trained_throughput_per_sec": 309.7630853416685, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11734.704, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11734.63, "sample_time_ms": 1052.281, "learn_time_ms": 10616.35, "learn_throughput": 376.777, "synch_weights_time_ms": 65.24}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "3541f_00001", "date": "2024-08-03_03-09-33", "timestamp": 1722634773, "time_this_iter_s": 12.923208951950073, "time_total_s": 179.5793478488922, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408eb90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.5793478488922, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.10526315789474, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.34370684524377, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.938138023018837, "policy_loss": -0.011102691712828043, "vf_loss": 6.957156107823054, "vf_explained_var": 0.844636278351148, "kl": 0.01311807409517011, "entropy": 1.3818528460959594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -9.861229732914856, "episode_reward_min": -1364.9645911685952, "episode_reward_mean": -654.9904215624969, "episode_len_mean": 134.14, "episode_media": {}, "episodes_timesteps_total": 13414, "policy_reward_min": {"policy_0": -1364.9645911685952}, "policy_reward_max": {"policy_0": -9.861229732914856}, "policy_reward_mean": {"policy_0": -654.9904215624969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975], "episode_lengths": [150, 150, 150, 58, 150, 150, 87, 150, 141, 44, 150, 62, 150, 150, 44, 150, 150, 74, 150, 66, 150, 150, 150, 133, 110, 150, 150, 150, 150, 53, 150, 150, 150, 84, 150, 150, 150, 150, 150, 140, 150, 150, 85, 150, 150, 150, 150, 123, 150, 100, 150, 150, 150, 150, 150, 150, 87, 150, 150, 75, 117, 143, 150, 150, 150, 150, 150, 49, 121, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 78, 150, 150, 150, 150, 121, 150, 115], "policy_policy_0_reward": [-751.8260473940541, -579.8824825269979, -861.5591989165845, -97.71332240328861, -766.2091449759971, -328.0523866116004, -161.5217725072355, -1014.1359260694799, -312.06687739760827, -9.861229732914856, -604.0259751880615, -141.32943057374007, -381.76648981915497, -684.2268095586986, -86.11814593557327, -976.9351075180989, -938.5068734535209, -98.14437655642261, -478.1435097200121, -66.73212109044997, -1088.4515625160723, -1282.0525946555806, -993.6271139392397, -342.9022986044993, -444.3010313700318, -850.9537063899511, -573.7464028670285, -976.1293037578306, -469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567706037410899, "mean_inference_ms": 1.6826537390036327, "mean_action_processing_ms": 0.28067732585289784, "mean_env_wait_ms": 3.0103593959215154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011709928512573242, "StateBufferConnector_ms": 0.007846355438232422, "ViewRequirementAgentConnector_ms": 0.19269299507141113}, "num_episodes": 27, "episode_return_max": -9.861229732914856, "episode_return_min": -1364.9645911685952, "episode_return_mean": -654.9904215624969, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0349531854857, "num_env_steps_trained_throughput_per_sec": 313.0349531854857, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11749.889, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11749.814, "sample_time_ms": 1052.539, "learn_time_ms": 10631.134, "learn_throughput": 376.253, "synch_weights_time_ms": 65.375}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "3541f_00001", "date": "2024-08-03_03-09-46", "timestamp": 1722634786, "time_this_iter_s": 12.791126012802124, "time_total_s": 192.37047386169434, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.37047386169434, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.22222222222222, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.921525326371196, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.287863935033481, "policy_loss": -0.012273916849517263, "vf_loss": 7.307279233137766, "vf_explained_var": 0.7760152985652288, "kl": 0.016423707545588234, "entropy": 1.4532057497650386, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -37.692602525502274, "episode_reward_min": -1364.9645911685952, "episode_reward_mean": -722.8602996477816, "episode_len_mean": 139.33, "episode_media": {}, "episodes_timesteps_total": 13933, "policy_reward_min": {"policy_0": -1364.9645911685952}, "policy_reward_max": {"policy_0": -37.692602525502274}, "policy_reward_mean": {"policy_0": -722.8602996477816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459], "episode_lengths": [150, 53, 150, 150, 150, 84, 150, 150, 150, 150, 150, 140, 150, 150, 85, 150, 150, 150, 150, 123, 150, 100, 150, 150, 150, 150, 150, 150, 87, 150, 150, 75, 117, 143, 150, 150, 150, 150, 150, 49, 121, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 78, 150, 150, 150, 150, 121, 150, 115, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 108, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 122], "policy_policy_0_reward": [-469.6460323596793, -38.46994008549456, -659.2108287477984, -344.9602945879735, -1009.7643719650655, -86.55495000907405, -847.4318108881549, -600.2081613617917, -960.6384814605419, -1274.0993860510996, -1192.638491847396, -591.719554155894, -674.3640306353768, -993.9806015857257, -185.70247325344835, -1143.8569740563787, -279.6107194555921, -1084.335240130539, -844.0534501137985, -463.89926625736007, -777.6263517580388, -119.43611639822431, -653.4062199092398, -934.400566923677, -504.1789905724216, -685.9933931694185, -1364.9645911685952, -901.3223526371506, -245.92723090760646, -688.0366960156722, -817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559259853077827, "mean_inference_ms": 1.6797176925798376, "mean_action_processing_ms": 0.2801325594051626, "mean_env_wait_ms": 3.0084809288648704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01163172721862793, "StateBufferConnector_ms": 0.007693767547607422, "ViewRequirementAgentConnector_ms": 0.18989062309265137}, "num_episodes": 28, "episode_return_max": -37.692602525502274, "episode_return_min": -1364.9645911685952, "episode_return_mean": -722.8602996477816, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.49663674592443, "num_env_steps_trained_throughput_per_sec": 308.49663674592443, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12109.6, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12109.526, "sample_time_ms": 1051.933, "learn_time_ms": 10991.196, "learn_throughput": 363.928, "synch_weights_time_ms": 65.631}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "3541f_00001", "date": "2024-08-03_03-09-59", "timestamp": 1722634799, "time_this_iter_s": 12.977970361709595, "time_total_s": 205.34844422340393, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.34844422340393, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.3, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.72925721506278, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.721015387276808, "policy_loss": -0.012291785336856265, "vf_loss": 6.741071727375189, "vf_explained_var": 0.8718563472231229, "kl": 0.0136960656661207, "entropy": 1.392779781917731, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -2.138960602467095, "episode_reward_min": -1525.2878381016692, "episode_reward_mean": -731.6346051086377, "episode_len_mean": 139.34, "episode_media": {}, "episodes_timesteps_total": 13934, "policy_reward_min": {"policy_0": -1525.2878381016692}, "policy_reward_max": {"policy_0": -2.138960602467095}, "policy_reward_mean": {"policy_0": -731.6346051086377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542], "episode_lengths": [150, 75, 117, 143, 150, 150, 150, 150, 150, 49, 121, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 78, 150, 150, 150, 150, 121, 150, 115, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 108, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 41, 150, 80, 150, 93, 150, 150, 150, 50, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-817.3264470926824, -220.39111053194267, -383.42486914566024, -678.0254705797053, -305.08510779992656, -595.3489016393265, -1346.2431728344256, -954.214147915721, -1025.02059117461, -37.692602525502274, -250.77455034509813, -1186.3024668354162, -936.8881629994628, -347.23662913308385, -348.58244193646277, -312.7008356546377, -1014.9777838557757, -751.0821333638884, -1181.8819433146207, -818.5090765236403, -715.1414649740207, -925.1319842485351, -286.70799764569847, -780.0033845464227, -780.8089857833573, -621.6389525833345, -1185.3757590612088, -782.8013683221013, -1020.272649815459, -99.18781305384685, -416.68977256344886, -1148.4202511969984, -1008.2208281932103, -653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553735478079471, "mean_inference_ms": 1.6772848132544471, "mean_action_processing_ms": 0.2794730660111509, "mean_env_wait_ms": 3.0124254860879165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011717557907104492, "StateBufferConnector_ms": 0.007818222045898438, "ViewRequirementAgentConnector_ms": 0.19609594345092773}, "num_episodes": 30, "episode_return_max": -2.138960602467095, "episode_return_min": -1525.2878381016692, "episode_return_mean": -731.6346051086377, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.94798852683374, "num_env_steps_trained_throughput_per_sec": 305.94798852683374, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12628.66, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12628.585, "sample_time_ms": 1057.486, "learn_time_ms": 11503.66, "learn_throughput": 347.715, "synch_weights_time_ms": 66.671}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "3541f_00001", "date": "2024-08-03_03-10-12", "timestamp": 1722634812, "time_this_iter_s": 13.086535692214966, "time_total_s": 218.4349799156189, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4128e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.4349799156189, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.378947368421052, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.178946101665495, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.889012416203816, "policy_loss": -0.00727232905725638, "vf_loss": 6.899672195812067, "vf_explained_var": 0.9168682306384047, "kl": 0.017092438578220025, "entropy": 1.1079055218026042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 0.8074224705367234, "episode_reward_min": -1525.2878381016692, "episode_reward_mean": -675.3610785350779, "episode_len_mean": 132.77, "episode_media": {}, "episodes_timesteps_total": 13277, "policy_reward_min": {"policy_0": -1525.2878381016692}, "policy_reward_max": {"policy_0": 0.8074224705367234}, "policy_reward_mean": {"policy_0": -675.3610785350779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586], "episode_lengths": [150, 78, 150, 150, 150, 150, 121, 150, 115, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 108, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 41, 150, 80, 150, 93, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 104, 150, 53, 133, 66, 150, 150, 150, 71, 54, 150, 150, 150, 150, 55, 150, 40, 53, 65, 103, 100, 109, 150, 150, 150, 150, 109], "policy_policy_0_reward": [-653.5483100422992, -89.30206132616576, -1162.7425906405551, -932.4467926433906, -799.6481519744968, -1046.1904276445907, -495.8719493550928, -334.3914380383866, -191.43196687750975, -574.0614245913898, -65.75198016757217, -1175.346285375016, -1309.2858322837242, -1137.7692297198057, -1039.3018757208783, -547.018119414905, -1042.8600995677887, -695.5063434920853, -634.50174072114, -569.7838012552879, -805.1269088082175, -726.0658044760928, -542.9746193902192, -782.901725782641, -359.4209932078624, -1037.222746908779, -1214.8138032609636, -1053.8078172307382, -544.2433280008196, -1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549603764670656, "mean_inference_ms": 1.6767851244306728, "mean_action_processing_ms": 0.27919673105158305, "mean_env_wait_ms": 3.017416883185183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011886119842529297, "StateBufferConnector_ms": 0.007719755172729492, "ViewRequirementAgentConnector_ms": 0.19825243949890137}, "num_episodes": 33, "episode_return_max": 0.8074224705367234, "episode_return_min": -1525.2878381016692, "episode_return_mean": -675.3610785350779, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.59072861425363, "num_env_steps_trained_throughput_per_sec": 309.59072861425363, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12618.921, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12618.845, "sample_time_ms": 1053.852, "learn_time_ms": 11498.074, "learn_throughput": 347.884, "synch_weights_time_ms": 66.151}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "3541f_00001", "date": "2024-08-03_03-10-25", "timestamp": 1722634825, "time_this_iter_s": 12.933019638061523, "time_total_s": 231.36799955368042, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.36799955368042, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.24444444444444, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.23924449086189, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.153400648136934, "policy_loss": -0.01132749743507399, "vf_loss": 7.173419326047102, "vf_explained_var": 0.8494726687669754, "kl": 0.016727919864691427, "entropy": 1.621873646788299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.8074224705367234, "episode_reward_min": -1525.2878381016692, "episode_reward_mean": -697.9261540101526, "episode_len_mean": 131.32, "episode_media": {}, "episodes_timesteps_total": 13132, "policy_reward_min": {"policy_0": -1525.2878381016692}, "policy_reward_max": {"policy_0": 0.8074224705367234}, "policy_reward_mean": {"policy_0": -697.9261540101526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 41, 150, 80, 150, 93, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 104, 150, 53, 133, 66, 150, 150, 150, 71, 54, 150, 150, 150, 150, 55, 150, 40, 53, 65, 103, 100, 109, 150, 150, 150, 150, 109, 85, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 79, 150, 73, 67, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1216.1145221643785, -1052.580517552121, -1297.0865757638423, -982.3564599779584, -928.0227760695088, -491.26884551964787, -522.9418543072832, -329.7730198475459, -861.4149603853315, -576.5439865215142, -443.4062232459143, -995.0129229671156, -673.1500248423251, -438.96965330287543, -1194.0220288352148, -1061.5502891421963, -1104.6545401863516, -716.8538986702067, -676.9755772913568, -590.5480696032942, -815.3256057259945, -179.05267715458908, -706.6058300341334, -1525.2878381016692, -2.138960602467095, -942.4208435806703, -186.39005415984747, -547.6390177670776, -194.07674511212042, -780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545543017311167, "mean_inference_ms": 1.675465148192919, "mean_action_processing_ms": 0.2786496541778323, "mean_env_wait_ms": 3.020341531944021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011950016021728516, "StateBufferConnector_ms": 0.00783681869506836, "ViewRequirementAgentConnector_ms": 0.2012312412261963}, "num_episodes": 29, "episode_return_max": 0.8074224705367234, "episode_return_min": -1525.2878381016692, "episode_return_mean": -697.9261540101526, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.24423020673845, "num_env_steps_trained_throughput_per_sec": 301.24423020673845, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12630.901, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12630.825, "sample_time_ms": 1057.541, "learn_time_ms": 11507.226, "learn_throughput": 347.608, "synch_weights_time_ms": 65.295}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "3541f_00001", "date": "2024-08-03_03-10-39", "timestamp": 1722634839, "time_this_iter_s": 13.290879487991333, "time_total_s": 244.65887904167175, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.65887904167175, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.015789473684208, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.04347967207432, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.3555859540899595, "policy_loss": -0.007683930301573128, "vf_loss": 6.370411143700282, "vf_explained_var": 0.9152305702368418, "kl": 0.012368589200900715, "entropy": 1.2707111656665802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 0.8074224705367234, "episode_reward_min": -1395.5074758014841, "episode_reward_mean": -676.2756856965802, "episode_len_mean": 129.76, "episode_media": {}, "episodes_timesteps_total": 12976, "policy_reward_min": {"policy_0": -1395.5074758014841}, "policy_reward_max": {"policy_0": 0.8074224705367234}, "policy_reward_mean": {"policy_0": -676.2756856965802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964], "episode_lengths": [150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 104, 150, 53, 133, 66, 150, 150, 150, 71, 54, 150, 150, 150, 150, 55, 150, 40, 53, 65, 103, 100, 109, 150, 150, 150, 150, 109, 85, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 79, 150, 73, 67, 150, 150, 150, 150, 150, 114, 143, 150, 150, 150, 150, 150, 150, 150, 150, 140, 142, 42, 150, 81, 48, 150, 150, 69, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150], "policy_policy_0_reward": [-780.0307952647864, -954.2868761769317, -797.2892963413088, -57.59807728665574, -959.3431859457962, -987.3389733721862, -786.0778391687036, -1103.1818909104663, -640.6814328547542, -748.1506646571354, -666.4823893038426, -722.5730593040979, -557.4754238026791, -953.1518967490331, -306.5854861117489, -190.68707148608522, -1079.032747121334, -33.59233705215332, -387.98882040011244, -190.66227793610648, -1395.5074758014841, -793.3003340216459, -1186.6000329290375, -92.38858076260392, -45.5153369643998, -919.9102014394291, -606.8461819031189, -424.7111074151268, -728.4981161551507, -76.81970391373224, -586.6529979437383, 0.8074224705367234, -32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539931205574699, "mean_inference_ms": 1.6743561883716855, "mean_action_processing_ms": 0.2784700169359621, "mean_env_wait_ms": 3.0217547553931037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012042999267578125, "StateBufferConnector_ms": 0.0079345703125, "ViewRequirementAgentConnector_ms": 0.19941234588623047}, "num_episodes": 29, "episode_return_max": 0.8074224705367234, "episode_return_min": -1395.5074758014841, "episode_return_mean": -676.2756856965802, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.85754568635605, "num_env_steps_trained_throughput_per_sec": 307.85754568635605, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12658.842, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12658.767, "sample_time_ms": 1060.643, "learn_time_ms": 11534.802, "learn_throughput": 346.777, "synch_weights_time_ms": 62.552}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "3541f_00001", "date": "2024-08-03_03-10-52", "timestamp": 1722634852, "time_this_iter_s": 13.004401922225952, "time_total_s": 257.6632809638977, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.6632809638977, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.126315789473686, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.31418584883212, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.525174232323964, "policy_loss": -0.005741589289391414, "vf_loss": 6.5398996437589325, "vf_explained_var": 0.9120033246154586, "kl": 0.011128033066415847, "entropy": 1.3991431009645263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -16.37198605694262, "episode_reward_min": -1439.7040065155024, "episode_reward_mean": -697.9510608768328, "episode_len_mean": 130.37, "episode_media": {}, "episodes_timesteps_total": 13037, "policy_reward_min": {"policy_0": -1439.7040065155024}, "policy_reward_max": {"policy_0": -16.37198605694262}, "policy_reward_mean": {"policy_0": -697.9510608768328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381], "episode_lengths": [53, 65, 103, 100, 109, 150, 150, 150, 150, 109, 85, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 79, 150, 73, 67, 150, 150, 150, 150, 150, 114, 143, 150, 150, 150, 150, 150, 150, 150, 150, 140, 142, 42, 150, 81, 48, 150, 150, 69, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 141, 150, 139, 150, 150, 69, 71, 150, 150, 150, 95, 150, 150, 150, 150, 72, 150, 150, 150, 94, 94, 150, 150, 150, 73, 65, 93, 143, 150, 75, 150], "policy_policy_0_reward": [-32.32963447305931, -139.25442313856206, -433.886405042375, -216.03049133873364, -265.1397469477666, -919.1611876095253, -739.8637527111949, -765.1363123286322, -1157.7293245284286, -293.90090101171586, -143.96800560699825, -1206.705861061363, -709.062632833979, -1112.239429012216, -847.7425637066741, -227.24982542047994, -1208.7003665344782, -1049.9684378968202, -1066.308909062522, -1185.1947040274886, -1288.4850979747675, -583.5244608519318, -1072.967027553051, -1240.1968636930853, -384.8541615016315, -1236.9714606512052, -965.5164119764873, -242.72620095201518, -1180.9376036360134, -1004.3405072356015, -103.63044139435821, -977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536056038332375, "mean_inference_ms": 1.6727241034239446, "mean_action_processing_ms": 0.2780363622615737, "mean_env_wait_ms": 3.024558389628991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012052059173583984, "StateBufferConnector_ms": 0.008014678955078125, "ViewRequirementAgentConnector_ms": 0.19628453254699707}, "num_episodes": 32, "episode_return_max": -16.37198605694262, "episode_return_min": -1439.7040065155024, "episode_return_mean": -697.9510608768328, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7641982725884, "num_env_steps_trained_throughput_per_sec": 314.7641982725884, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13023.69, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13023.617, "sample_time_ms": 1058.961, "learn_time_ms": 11901.826, "learn_throughput": 336.083, "synch_weights_time_ms": 62.062}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "3541f_00001", "date": "2024-08-03_03-11-05", "timestamp": 1722634865, "time_this_iter_s": 12.720034122467041, "time_total_s": 270.38331508636475, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4128e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.38331508636475, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.444444444444443, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.78776638309161, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.826630508154631, "policy_loss": -0.012036228351644241, "vf_loss": 5.845984099060297, "vf_explained_var": 0.9051469104985396, "kl": 0.015032327875663545, "entropy": 1.4081895978500445, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.37198605694262, "episode_reward_min": -1439.7040065155024, "episode_reward_mean": -701.864330537035, "episode_len_mean": 132.69, "episode_media": {}, "episodes_timesteps_total": 13269, "policy_reward_min": {"policy_0": -1439.7040065155024}, "policy_reward_max": {"policy_0": -16.37198605694262}, "policy_reward_mean": {"policy_0": -701.864330537035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099], "episode_lengths": [150, 73, 67, 150, 150, 150, 150, 150, 114, 143, 150, 150, 150, 150, 150, 150, 150, 150, 140, 142, 42, 150, 81, 48, 150, 150, 69, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 141, 150, 139, 150, 150, 69, 71, 150, 150, 150, 95, 150, 150, 150, 150, 72, 150, 150, 150, 94, 94, 150, 150, 150, 73, 65, 93, 143, 150, 75, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 83, 75, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 116, 150, 150], "policy_policy_0_reward": [-977.2450736769657, -64.87805540598211, -70.47281093973915, -874.6844662319047, -605.5210226840718, -975.6363282487926, -1260.039145857226, -930.0778397980168, -235.05232093994232, -591.4787269590503, -1010.3502111184591, -580.0731052143161, -711.8555342742623, -670.5191873136135, -591.2089409153631, -1183.6201726416905, -942.5957184494374, -787.8643642203224, -289.0233421991065, -615.6657506341397, -16.37198605694262, -428.9614060394776, -107.92779682562924, -92.69170412321154, -997.809663589469, -1260.1182611543613, -36.94461964287429, -1179.496946492909, -608.9210399846438, -1021.8186049735331, -880.2019611511789, -601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552850193343898, "mean_inference_ms": 1.671688361538741, "mean_action_processing_ms": 0.2779604396714719, "mean_env_wait_ms": 3.0286294558963154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012080669403076172, "StateBufferConnector_ms": 0.007985830307006836, "ViewRequirementAgentConnector_ms": 0.19590306282043457}, "num_episodes": 31, "episode_return_max": -16.37198605694262, "episode_return_min": -1439.7040065155024, "episode_return_mean": -701.864330537035, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.0701390181242, "num_env_steps_trained_throughput_per_sec": 306.0701390181242, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12982.819, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12982.749, "sample_time_ms": 1053.199, "learn_time_ms": 11866.108, "learn_throughput": 337.095, "synch_weights_time_ms": 62.667}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "3541f_00001", "date": "2024-08-03_03-11-18", "timestamp": 1722634878, "time_this_iter_s": 13.082556009292603, "time_total_s": 283.46587109565735, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.46587109565735, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.926315789473684, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.0663781940937, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.786748966326316, "policy_loss": -0.011663293477613478, "vf_loss": 5.804248560468356, "vf_explained_var": 0.932585961620013, "kl": 0.016361702211906994, "entropy": 1.319905078286926, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -10.65898858958603, "episode_reward_min": -1439.7040065155024, "episode_reward_mean": -708.8180980373785, "episode_len_mean": 132.56, "episode_media": {}, "episodes_timesteps_total": 13256, "policy_reward_min": {"policy_0": -1439.7040065155024}, "policy_reward_max": {"policy_0": -10.65898858958603}, "policy_reward_mean": {"policy_0": -708.8180980373785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975], "episode_lengths": [150, 110, 150, 150, 150, 150, 150, 141, 150, 139, 150, 150, 69, 71, 150, 150, 150, 95, 150, 150, 150, 150, 72, 150, 150, 150, 94, 94, 150, 150, 150, 73, 65, 93, 143, 150, 75, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 83, 75, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 116, 150, 150, 150, 150, 55, 95, 150, 114, 150, 57, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 69, 110, 150, 150], "policy_policy_0_reward": [-601.3418659592149, -231.92880100399594, -726.6486241074648, -695.785178853804, -1149.8302690013911, -841.0313832374964, -1114.0015846686454, -614.5836848027784, -1193.7873495134809, -309.9586862663894, -1237.4122682762936, -424.2673168254281, -72.3155524633541, -121.18304089730285, -909.5930507988885, -849.4642435431269, -815.2606589766584, -362.32427407576836, -1153.9780445971408, -1439.7040065155024, -1108.5463583482888, -1274.080249759429, -102.763082061405, -1061.6688135411503, -862.2953545109821, -837.0103404510925, -205.82472346200925, -176.98279982565813, -1251.2619088174242, -1284.1209150648167, -733.8546150566372, -234.39708278580196, -55.920362485480815, -253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529133751549665, "mean_inference_ms": 1.672538787210833, "mean_action_processing_ms": 0.27804076534222455, "mean_env_wait_ms": 3.0324495820791646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012051820755004883, "StateBufferConnector_ms": 0.007974624633789062, "ViewRequirementAgentConnector_ms": 0.19508647918701172}, "num_episodes": 31, "episode_return_max": -10.65898858958603, "episode_return_min": -1439.7040065155024, "episode_return_mean": -708.8180980373785, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4469971829297, "num_env_steps_trained_throughput_per_sec": 307.4469971829297, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12971.033, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12970.961, "sample_time_ms": 1053.07, "learn_time_ms": 11853.117, "learn_throughput": 337.464, "synch_weights_time_ms": 63.985}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "3541f_00001", "date": "2024-08-03_03-11-31", "timestamp": 1722634891, "time_this_iter_s": 13.024238109588623, "time_total_s": 296.490109205246, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412ae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.490109205246, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.177777777777777, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.16700694362322, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.38977936655283, "policy_loss": -0.011085958458230986, "vf_loss": 5.406397696832816, "vf_explained_var": 0.9575748082250357, "kl": 0.015529012048318724, "entropy": 1.2520423701032997, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -10.65898858958603, "episode_reward_min": -1303.3685099776162, "episode_reward_mean": -661.4068410670761, "episode_len_mean": 129.7, "episode_media": {}, "episodes_timesteps_total": 12970, "policy_reward_min": {"policy_0": -1303.3685099776162}, "policy_reward_max": {"policy_0": -10.65898858958603}, "policy_reward_mean": {"policy_0": -661.4068410670761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204], "episode_lengths": [93, 143, 150, 75, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 83, 75, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 116, 150, 150, 150, 150, 55, 95, 150, 114, 150, 57, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 69, 110, 150, 150, 150, 150, 150, 49, 63, 64, 150, 150, 150, 150, 150, 150, 150, 43, 89, 65, 150, 150, 150, 150, 116, 57, 150, 78, 150, 49, 150, 150, 150, 64, 150, 150, 150], "policy_policy_0_reward": [-253.12597023140475, -384.33360787908526, -568.96695948003, -132.5168814030253, -780.1869186656381, -1169.2783587888728, -627.4767801388432, -859.0064144945181, -639.0595911561417, -998.5282630881389, -39.97640558428789, -919.5984428900525, -1081.314664678352, -526.1542104333686, -895.7588905373926, -348.095186710623, -882.8024902041258, -1265.246281667199, -617.1843168288382, -996.7525672364484, -646.7671031634808, -151.177406174242, -88.05658067868457, -766.7380037436798, -450.667001804932, -1216.3914139114297, -633.6248586840588, -1125.7949254126333, -985.2921822523982, -951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528932163552135, "mean_inference_ms": 1.6731839753205975, "mean_action_processing_ms": 0.2780125037866524, "mean_env_wait_ms": 3.034448617627742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012042760848999023, "StateBufferConnector_ms": 0.007879257202148438, "ViewRequirementAgentConnector_ms": 0.19414353370666504}, "num_episodes": 33, "episode_return_max": -10.65898858958603, "episode_return_min": -1303.3685099776162, "episode_return_mean": -661.4068410670761, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.96003571573175, "num_env_steps_trained_throughput_per_sec": 306.96003571573175, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12982.824, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12982.754, "sample_time_ms": 1050.542, "learn_time_ms": 11866.04, "learn_throughput": 337.096, "synch_weights_time_ms": 65.383}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "3541f_00001", "date": "2024-08-03_03-11-44", "timestamp": 1722634904, "time_this_iter_s": 13.043817281723022, "time_total_s": 309.533926486969, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.533926486969, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.105263157894733, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.0791433831056, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.897665839642286, "policy_loss": -0.01720445755199762, "vf_loss": 4.921596649537483, "vf_explained_var": 0.9756186104069153, "kl": 0.018325144909492067, "entropy": 1.497267146036029, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -10.65898858958603, "episode_reward_min": -1303.3685099776162, "episode_reward_mean": -658.1227088289568, "episode_len_mean": 126.53, "episode_media": {}, "episodes_timesteps_total": 12653, "policy_reward_min": {"policy_0": -1303.3685099776162}, "policy_reward_max": {"policy_0": -10.65898858958603}, "policy_reward_mean": {"policy_0": -658.1227088289568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746], "episode_lengths": [150, 90, 150, 150, 116, 150, 150, 150, 150, 55, 95, 150, 114, 150, 57, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 69, 110, 150, 150, 150, 150, 150, 49, 63, 64, 150, 150, 150, 150, 150, 150, 150, 43, 89, 65, 150, 150, 150, 150, 116, 57, 150, 78, 150, 49, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 67, 85, 67, 150, 65, 150, 89, 150, 150, 150, 150, 63, 91, 49, 150, 106, 150, 150, 72, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-951.8913956181309, -165.86492383250558, -1201.1099819975077, -1228.3633150615842, -468.31618791497283, -711.6755833452269, -757.0863897007099, -609.0359921164469, -849.4128818523167, -27.395148355147857, -322.38372264256617, -523.780957926741, -474.39531503901577, -1303.3685099776162, -147.84288081873717, -825.2615289599754, -955.7873576845137, -700.0270954378259, -1178.1665184441506, -726.6546436902433, -690.3819591142831, -10.65898858958603, -661.3029178381976, -590.9879942623787, -1029.1183603909722, -971.5083054002738, -766.0084352385536, -864.8866603709793, -165.91023718862175, -639.1739345604246, -1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530774453017658, "mean_inference_ms": 1.6729447195649483, "mean_action_processing_ms": 0.27798045042716196, "mean_env_wait_ms": 3.0352312787485825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01190328598022461, "StateBufferConnector_ms": 0.008025407791137695, "ViewRequirementAgentConnector_ms": 0.19884729385375977}, "num_episodes": 29, "episode_return_max": -10.65898858958603, "episode_return_min": -1303.3685099776162, "episode_return_mean": -658.1227088289568, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.9366456996439, "num_env_steps_trained_throughput_per_sec": 301.9366456996439, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 13029.795, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13029.722, "sample_time_ms": 1058.685, "learn_time_ms": 11904.323, "learn_throughput": 336.012, "synch_weights_time_ms": 65.931}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "3541f_00001", "date": "2024-08-03_03-11-57", "timestamp": 1722634917, "time_this_iter_s": 13.25865364074707, "time_total_s": 322.79258012771606, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07b84c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.79258012771606, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.24736842105263, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.29116366902988, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.117926197499036, "policy_loss": -0.002885836853723352, "vf_loss": 5.127834514280161, "vf_explained_var": 0.9440598917504152, "kl": 0.01723823824261975, "entropy": 1.4779692485928535, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -8.803065133055352, "episode_reward_min": -1481.4900333692908, "episode_reward_mean": -664.0384279151232, "episode_len_mean": 125.27, "episode_media": {}, "episodes_timesteps_total": 12527, "policy_reward_min": {"policy_0": -1481.4900333692908}, "policy_reward_max": {"policy_0": -8.803065133055352}, "policy_reward_mean": {"policy_0": -664.0384279151232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908], "episode_lengths": [150, 150, 150, 150, 69, 110, 150, 150, 150, 150, 150, 49, 63, 64, 150, 150, 150, 150, 150, 150, 150, 43, 89, 65, 150, 150, 150, 150, 116, 57, 150, 78, 150, 49, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 67, 85, 67, 150, 65, 150, 89, 150, 150, 150, 150, 63, 91, 49, 150, 106, 150, 150, 72, 150, 150, 150, 150, 150, 150, 78, 150, 150, 65, 150, 150, 150, 150, 62, 67, 150, 150, 150, 150, 130, 150, 56, 40, 150, 150, 150, 150, 150, 150, 150, 71, 88, 150, 150, 150], "policy_policy_0_reward": [-1123.988069047319, -778.4857384870969, -1234.5982913635016, -722.5688905174396, -50.000630867056536, -200.64358847755958, -973.9006609716964, -1176.86664215975, -1185.0889460053208, -1131.4138133922322, -547.4986992924457, -49.29889935353591, -167.83839403584227, -68.39278835773771, -692.524688039804, -1154.2112239644662, -1062.740884049746, -928.0586052703273, -840.8427553824116, -617.513015600743, -809.913034998088, -67.2903653108153, -117.05867860947342, -158.1681836425209, -478.3683731067768, -684.0499790679812, -653.7753833300598, -948.8316586096805, -225.24057750678875, -78.6071736568068, -642.5294328705612, -124.068992519429, -650.5690866515258, -30.009497466653944, -859.3837543337742, -671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534414695061058, "mean_inference_ms": 1.6732449537101959, "mean_action_processing_ms": 0.2779115766127774, "mean_env_wait_ms": 3.0374107220452755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012109041213989258, "StateBufferConnector_ms": 0.008088350296020508, "ViewRequirementAgentConnector_ms": 0.20073914527893066}, "num_episodes": 30, "episode_return_max": -8.803065133055352, "episode_return_min": -1481.4900333692908, "episode_return_mean": -664.0384279151232, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.34269144728364, "num_env_steps_trained_throughput_per_sec": 303.34269144728364, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 13051.825, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13051.751, "sample_time_ms": 1057.829, "learn_time_ms": 11928.023, "learn_throughput": 335.345, "synch_weights_time_ms": 65.116}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "3541f_00001", "date": "2024-08-03_03-12-10", "timestamp": 1722634930, "time_this_iter_s": 13.197755813598633, "time_total_s": 335.9903359413147, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.9903359413147, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.1, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.49146122038366, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.285272489239772, "policy_loss": -0.012786626439871421, "vf_loss": 5.306004591534535, "vf_explained_var": 0.9660294555748502, "kl": 0.014212556171059987, "entropy": 1.4341151228795448, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 2.065782860365895, "episode_reward_min": -1481.4900333692908, "episode_reward_mean": -704.1183190562988, "episode_len_mean": 126.28, "episode_media": {}, "episodes_timesteps_total": 12628, "policy_reward_min": {"policy_0": -1481.4900333692908}, "policy_reward_max": {"policy_0": 2.065782860365895}, "policy_reward_mean": {"policy_0": -704.1183190562988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205], "episode_lengths": [150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 67, 85, 67, 150, 65, 150, 89, 150, 150, 150, 150, 63, 91, 49, 150, 106, 150, 150, 72, 150, 150, 150, 150, 150, 150, 78, 150, 150, 65, 150, 150, 150, 150, 62, 67, 150, 150, 150, 150, 130, 150, 56, 40, 150, 150, 150, 150, 150, 150, 150, 71, 88, 150, 150, 150, 150, 150, 150, 69, 60, 77, 63, 150, 32, 150, 150, 150, 59, 150, 150, 150, 57, 150, 150, 150, 150, 150, 72, 116, 150, 150, 150, 150, 150, 102, 150, 96, 150, 150, 150], "policy_policy_0_reward": [-671.6334671659323, -824.6637721261695, -60.87241727290871, -877.9739384398513, -1145.1772039785483, -758.3931101151204, -1043.4035761904713, -824.4458239299055, -1135.4636200230022, -668.0102266335422, -120.05039739745257, -159.34656114339873, -122.17047793777469, -1026.8394402347894, -65.9754909783434, -986.7387919193427, -210.12016572874194, -702.7423940011042, -1150.3395804087234, -835.8934514485107, -935.0234050296542, -161.71569620875465, -177.2753100340405, -36.26863241993814, -833.06499283225, -252.69639058529586, -1302.2871109963849, -1067.9845244374844, -153.50959663830415, -1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537466196315585, "mean_inference_ms": 1.6731380893913532, "mean_action_processing_ms": 0.27796893387009564, "mean_env_wait_ms": 3.0396657092000767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012083292007446289, "StateBufferConnector_ms": 0.008298397064208984, "ViewRequirementAgentConnector_ms": 0.19919347763061523}, "num_episodes": 35, "episode_return_max": 2.065782860365895, "episode_return_min": -1481.4900333692908, "episode_return_mean": -704.1183190562988, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8103744519878, "num_env_steps_trained_throughput_per_sec": 311.8103744519878, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13027.244, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13027.17, "sample_time_ms": 1076.659, "learn_time_ms": 11885.307, "learn_throughput": 336.55, "synch_weights_time_ms": 64.42}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "3541f_00001", "date": "2024-08-03_03-12-23", "timestamp": 1722634943, "time_this_iter_s": 12.84011435508728, "time_total_s": 348.830450296402, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4129ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 348.830450296402, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.383333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.80954634745916, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.188565201063951, "policy_loss": -0.010690309954225086, "vf_loss": 5.205433206260205, "vf_explained_var": 0.9755784076328079, "kl": 0.01590286177064024, "entropy": 1.3333979723354181, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": 2.065782860365895, "episode_reward_min": -1481.4900333692908, "episode_reward_mean": -712.5917622700908, "episode_len_mean": 128.39, "episode_media": {}, "episodes_timesteps_total": 12839, "policy_reward_min": {"policy_0": -1481.4900333692908}, "policy_reward_max": {"policy_0": 2.065782860365895}, "policy_reward_mean": {"policy_0": -712.5917622700908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861], "episode_lengths": [150, 150, 150, 150, 150, 150, 78, 150, 150, 65, 150, 150, 150, 150, 62, 67, 150, 150, 150, 150, 130, 150, 56, 40, 150, 150, 150, 150, 150, 150, 150, 71, 88, 150, 150, 150, 150, 150, 150, 69, 60, 77, 63, 150, 32, 150, 150, 150, 59, 150, 150, 150, 57, 150, 150, 150, 150, 150, 72, 116, 150, 150, 150, 150, 150, 102, 150, 96, 150, 150, 150, 77, 150, 62, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 130, 85, 150, 129, 150, 58, 150, 61], "policy_policy_0_reward": [-1054.8888232731917, -719.9462318981173, -950.1006593427752, -1183.5414498078487, -830.1273570130919, -1011.489275617746, -223.45926874589892, -832.2388138808747, -752.0437878284935, -64.32692844329482, -841.4493960156482, -865.0124819738271, -838.6998861374275, -1140.627583654227, -77.15295380723872, -99.10871704447733, -882.1982097303476, -811.4991138453229, -889.2905423755426, -853.4519170133868, -420.7707837074837, -753.03645123025, -160.41078891796363, -8.803065133055352, -1208.9944751558046, -739.4576561212555, -789.6564633103615, -929.4358243027434, -724.4799378278155, -1357.2029437881424, -936.0676462795506, -105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537518862478658, "mean_inference_ms": 1.6736783326258307, "mean_action_processing_ms": 0.277859739786423, "mean_env_wait_ms": 3.0427030621026234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012096405029296875, "StateBufferConnector_ms": 0.008368968963623047, "ViewRequirementAgentConnector_ms": 0.1976311206817627}, "num_episodes": 29, "episode_return_max": 2.065782860365895, "episode_return_min": -1481.4900333692908, "episode_return_mean": -712.5917622700908, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.84688772859437, "num_env_steps_trained_throughput_per_sec": 346.84688772859437, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12888.462, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12888.389, "sample_time_ms": 1084.141, "learn_time_ms": 11737.714, "learn_throughput": 340.782, "synch_weights_time_ms": 65.751}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "3541f_00001", "date": "2024-08-03_03-12-35", "timestamp": 1722634955, "time_this_iter_s": 11.544654130935669, "time_total_s": 360.37510442733765, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d41291b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.37510442733765, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.212500000000002, "ram_util_percent": 27.337500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.0580045580864, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.169137841711442, "policy_loss": -0.013018011690292042, "vf_loss": 5.1904373022417225, "vf_explained_var": 0.9661177259559433, "kl": 0.018174335921745943, "entropy": 1.6459911988427243, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 2.065782860365895, "episode_reward_min": -1481.4900333692908, "episode_reward_mean": -706.5244978230093, "episode_len_mean": 128.43, "episode_media": {}, "episodes_timesteps_total": 12843, "policy_reward_min": {"policy_0": -1481.4900333692908}, "policy_reward_max": {"policy_0": 2.065782860365895}, "policy_reward_mean": {"policy_0": -706.5244978230093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963], "episode_lengths": [71, 88, 150, 150, 150, 150, 150, 150, 69, 60, 77, 63, 150, 32, 150, 150, 150, 59, 150, 150, 150, 57, 150, 150, 150, 150, 150, 72, 116, 150, 150, 150, 150, 150, 102, 150, 96, 150, 150, 150, 77, 150, 62, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 130, 85, 150, 129, 150, 58, 150, 61, 150, 150, 150, 150, 150, 77, 150, 150, 150, 125, 150, 150, 76, 150, 104, 150, 150, 150, 150, 73, 150, 150, 70, 150, 145, 150, 150, 150, 71, 150, 61], "policy_policy_0_reward": [-105.67079214790846, -155.8839674944497, -962.221275070037, -1205.188327634721, -1481.4900333692908, -1379.5277600312904, -1262.6198250732564, -1282.2592295380318, -196.0621459235725, -125.99628976739609, -115.97980356975758, -72.605702517879, -1090.886033468043, 2.065782860365895, -1418.8807148976646, -816.5276139478825, -1111.7909053665803, -71.7649241835889, -1145.5473451359974, -1248.4877700985116, -525.0259368552825, -70.79756166535995, -1033.5194162494467, -773.9530881616723, -920.0793688749627, -781.9199654072573, -558.3798092907434, -52.59778522348378, -314.39763665828303, -1107.9660133204366, -1163.7195895953516, -706.6339159397879, -1008.1116299162306, -993.0867510704512, -148.98083532660783, -913.016779966715, -216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531753577932992, "mean_inference_ms": 1.6731280850770247, "mean_action_processing_ms": 0.27769518558150424, "mean_env_wait_ms": 3.044562895428945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011750459671020508, "StateBufferConnector_ms": 0.0084075927734375, "ViewRequirementAgentConnector_ms": 0.19931745529174805}, "num_episodes": 31, "episode_return_max": 2.065782860365895, "episode_return_min": -1481.4900333692908, "episode_return_mean": -706.5244978230093, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.7751209512587, "num_env_steps_trained_throughput_per_sec": 306.7751209512587, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12864.523, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12864.449, "sample_time_ms": 1084.611, "learn_time_ms": 11713.097, "learn_throughput": 341.498, "synch_weights_time_ms": 65.958}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "3541f_00001", "date": "2024-08-03_03-12-48", "timestamp": 1722634968, "time_this_iter_s": 13.050830602645874, "time_total_s": 373.4259350299835, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.4259350299835, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.010526315789473, "ram_util_percent": 27.394736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.9309153318405, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.3380404765407246, "policy_loss": -0.013412119964292894, "vf_loss": 5.3571312216420965, "vf_explained_var": 0.9696839519465963, "kl": 0.01578147793503987, "entropy": 1.2780274865527947, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -6.261135887697318, "episode_reward_min": -1489.988071250013, "episode_reward_mean": -677.6888949366084, "episode_len_mean": 127.68, "episode_media": {}, "episodes_timesteps_total": 12768, "policy_reward_min": {"policy_0": -1489.988071250013}, "policy_reward_max": {"policy_0": -6.261135887697318}, "policy_reward_mean": {"policy_0": -677.6888949366084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545], "episode_lengths": [96, 150, 150, 150, 77, 150, 62, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 130, 85, 150, 129, 150, 58, 150, 61, 150, 150, 150, 150, 150, 77, 150, 150, 150, 125, 150, 150, 76, 150, 104, 150, 150, 150, 150, 73, 150, 150, 70, 150, 145, 150, 150, 150, 71, 150, 61, 150, 150, 150, 65, 150, 150, 150, 150, 65, 150, 150, 150, 93, 150, 150, 36, 60, 150, 60, 84, 65, 46, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 150, 56, 150], "policy_policy_0_reward": [-216.53104346090146, -738.8164938993525, -753.2972458210506, -1124.62736307205, -67.1867946016241, -1092.5751352239627, -82.75775981993138, -608.0456895955342, -911.4581407185464, -779.4138942060333, -1162.1975386167571, -1065.7540041857762, -89.97849581057574, -782.0009996550209, -1009.5743241471081, -341.12186244002925, -662.0779317506444, -771.6172868445608, -767.5188739181601, -1122.7662172169803, -203.50937658892315, -678.3846850771645, -912.194927245582, -1371.3940292351228, -905.3365043429744, -392.28523047908175, -273.87517998601976, -868.2662665649314, -379.19164736111117, -916.5097303853638, -102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526477251424589, "mean_inference_ms": 1.7010163316312994, "mean_action_processing_ms": 0.277446429332782, "mean_env_wait_ms": 3.0424801839292015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011825084686279297, "StateBufferConnector_ms": 0.008467912673950195, "ViewRequirementAgentConnector_ms": 0.1998293399810791}, "num_episodes": 36, "episode_return_max": -6.261135887697318, "episode_return_min": -1489.988071250013, "episode_return_mean": -677.6888949366084, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.2927122669578, "num_env_steps_trained_throughput_per_sec": 300.2927122669578, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12897.254, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12897.181, "sample_time_ms": 1119.491, "learn_time_ms": 11710.668, "learn_throughput": 341.569, "synch_weights_time_ms": 66.25}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-01", "timestamp": 1722634981, "time_this_iter_s": 13.335129737854004, "time_total_s": 386.7610647678375, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.7610647678375, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.67894736842105, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.5467997233073, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.039572816590468, "policy_loss": -0.0076724773738533255, "vf_loss": 5.051416316876809, "vf_explained_var": 0.9691000377138456, "kl": 0.016348293197218828, "entropy": 1.1527756995831926, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -5.564244581249909, "episode_reward_min": -1489.988071250013, "episode_reward_mean": -654.1083920124054, "episode_len_mean": 125.43, "episode_media": {}, "episodes_timesteps_total": 12543, "policy_reward_min": {"policy_0": -1489.988071250013}, "policy_reward_max": {"policy_0": -5.564244581249909}, "policy_reward_mean": {"policy_0": -654.1083920124054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875], "episode_lengths": [58, 150, 61, 150, 150, 150, 150, 150, 77, 150, 150, 150, 125, 150, 150, 76, 150, 104, 150, 150, 150, 150, 73, 150, 150, 70, 150, 145, 150, 150, 150, 71, 150, 61, 150, 150, 150, 65, 150, 150, 150, 150, 65, 150, 150, 150, 93, 150, 150, 36, 60, 150, 60, 84, 65, 46, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 150, 56, 150, 150, 150, 57, 150, 150, 150, 47, 76, 150, 134, 150, 150, 150, 150, 110, 150, 150, 82, 150, 150, 34, 150, 133, 75, 150, 150, 150, 85, 98, 150], "policy_policy_0_reward": [-102.23842918497321, -790.6368563626912, -47.55607606976861, -661.4111268864959, -1168.2079568601396, -992.5413976166559, -1291.5260599474489, -652.4576616041584, -164.8333015290847, -1285.9865049574373, -967.8554220403314, -800.772767980419, -518.0853058902042, -1024.830382007315, -531.9439188577886, -77.21357040747492, -523.1753475639357, -200.37037784710495, -1038.0337747243905, -466.85254462939827, -877.3232795412183, -795.1275291604953, -124.95679629391581, -1046.9185507445825, -920.5719834669013, -185.3626414487559, -945.4565080746795, -678.445713796454, -883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525374120217394, "mean_inference_ms": 1.7230899553736347, "mean_action_processing_ms": 0.2773078020841684, "mean_env_wait_ms": 3.0435614445790105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011782407760620117, "StateBufferConnector_ms": 0.008282184600830078, "ViewRequirementAgentConnector_ms": 0.1988694667816162}, "num_episodes": 30, "episode_return_max": -5.564244581249909, "episode_return_min": -1489.988071250013, "episode_return_mean": -654.1083920124054, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.1972817097241, "num_env_steps_trained_throughput_per_sec": 376.1972817097241, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12689.734, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12689.66, "sample_time_ms": 1116.326, "learn_time_ms": 11506.083, "learn_throughput": 347.642, "synch_weights_time_ms": 66.48}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-12", "timestamp": 1722634992, "time_this_iter_s": 10.645135879516602, "time_total_s": 397.4062006473541, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412a050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.4062006473541, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.693333333333335, "ram_util_percent": 27.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.09581235845883, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.129250347365936, "policy_loss": -0.011108799576565314, "vf_loss": 5.146021354198456, "vf_explained_var": 0.9828968858967225, "kl": 0.018576389753237284, "entropy": 1.4021570184578498, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -2.75336542104591, "episode_reward_min": -1489.988071250013, "episode_reward_mean": -661.7082263107941, "episode_len_mean": 125.61, "episode_media": {}, "episodes_timesteps_total": 12561, "policy_reward_min": {"policy_0": -1489.988071250013}, "policy_reward_max": {"policy_0": -2.75336542104591}, "policy_reward_mean": {"policy_0": -661.7082263107941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448], "episode_lengths": [150, 150, 150, 71, 150, 61, 150, 150, 150, 65, 150, 150, 150, 150, 65, 150, 150, 150, 93, 150, 150, 36, 60, 150, 60, 84, 65, 46, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 84, 150, 56, 150, 150, 150, 57, 150, 150, 150, 47, 76, 150, 134, 150, 150, 150, 150, 110, 150, 150, 82, 150, 150, 34, 150, 133, 75, 150, 150, 150, 85, 98, 150, 150, 142, 50, 44, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 35, 92, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150], "policy_policy_0_reward": [-883.6588189365635, -1066.9695838905368, -970.1630823069917, -77.86328826617027, -1319.6085651352441, -83.71922610274963, -1134.2904448237402, -1198.7251799689977, -1052.8917045129774, -74.3366618954035, -627.3185616825995, -574.4255085322927, -490.681243637578, -438.48684470696946, -126.65575019936703, -823.7778127828208, -1101.9956723134894, -1053.9007490269537, -312.54802117451607, -731.739532597105, -1489.988071250013, -6.261135887697318, -78.76154096909808, -1366.7331746066736, -103.89130904234639, -124.5353684591441, -66.90541639713521, -42.77139765562407, -944.8797094144869, -850.6571082572175, -915.3797506786686, -1185.3919674379667, -621.9723288328954, -868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522218596136982, "mean_inference_ms": 1.742365968904026, "mean_action_processing_ms": 0.2770466301952244, "mean_env_wait_ms": 3.0404750424356437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011749744415283203, "StateBufferConnector_ms": 0.008022069931030273, "ViewRequirementAgentConnector_ms": 0.19362664222717285}, "num_episodes": 28, "episode_return_max": -2.75336542104591, "episode_return_min": -1489.988071250013, "episode_return_mean": -661.7082263107941, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.1383295401915, "num_env_steps_trained_throughput_per_sec": 537.1383295401915, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12127.531, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12127.456, "sample_time_ms": 1128.509, "learn_time_ms": 10934.964, "learn_throughput": 365.799, "synch_weights_time_ms": 63.228}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-20", "timestamp": 1722635000, "time_this_iter_s": 7.460137128829956, "time_total_s": 404.8663377761841, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4129090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 404.8663377761841, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 21.918181818181814, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.15602174798647, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.740695829937855, "policy_loss": -0.014882794601241282, "vf_loss": 4.759099232157071, "vf_explained_var": 0.9841001630450289, "kl": 0.01937307609096024, "entropy": 1.2238499221081536, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -2.75336542104591, "episode_reward_min": -1410.219185979545, "episode_reward_mean": -677.3300507056804, "episode_len_mean": 129.69, "episode_media": {}, "episodes_timesteps_total": 12969, "policy_reward_min": {"policy_0": -1410.219185979545}, "policy_reward_max": {"policy_0": -2.75336542104591}, "policy_reward_mean": {"policy_0": -677.3300507056804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915], "episode_lengths": [150, 77, 150, 150, 150, 84, 150, 56, 150, 150, 150, 57, 150, 150, 150, 47, 76, 150, 134, 150, 150, 150, 150, 110, 150, 150, 82, 150, 150, 34, 150, 133, 75, 150, 150, 150, 85, 98, 150, 150, 142, 50, 44, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 35, 92, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 107, 80, 150, 150, 150, 150, 150, 89, 70, 150, 61, 150, 150, 79, 150, 143], "policy_policy_0_reward": [-868.2992062032534, -101.23973498036376, -598.7497133084896, -1136.7348226570991, -1165.0158986955457, -154.9543756455526, -370.0698663411534, -90.76570070270387, -1410.219185979545, -778.9673424816901, -1028.8867809346582, -131.962759854463, -562.5753078467508, -1114.1333169994427, -889.8215280432975, -50.56576891935326, -108.62453384721009, -837.5541042508993, -563.4298375345171, -594.6916697967347, -1268.5754833753258, -1152.463729518527, -322.79243809153803, -385.9718828864201, -981.1954131940372, -952.729508036264, -109.08351238062582, -949.273915233772, -1065.340917740064, -5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516711983783346, "mean_inference_ms": 1.742978898088507, "mean_action_processing_ms": 0.2767363223939005, "mean_env_wait_ms": 3.039714683480513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011755228042602539, "StateBufferConnector_ms": 0.007950067520141602, "ViewRequirementAgentConnector_ms": 0.19278836250305176}, "num_episodes": 33, "episode_return_max": -2.75336542104591, "episode_return_min": -1410.219185979545, "episode_return_mean": -677.3300507056804, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.6645970965756, "num_env_steps_trained_throughput_per_sec": 296.6645970965756, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12174.818, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12174.743, "sample_time_ms": 1131.038, "learn_time_ms": 10980.88, "learn_throughput": 364.27, "synch_weights_time_ms": 62.093}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-33", "timestamp": 1722635013, "time_this_iter_s": 13.497102499008179, "time_total_s": 418.36344027519226, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 418.36344027519226, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.973684210526315, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 244.5555896838506, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.516627510885398, "policy_loss": -0.013415095022840736, "vf_loss": 4.535946320494016, "vf_explained_var": 0.9824030206849178, "kl": 0.015469544146981207, "entropy": 1.2864989166458447, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -2.75336542104591, "episode_reward_min": -1253.9670031640105, "episode_reward_mean": -670.7395437699045, "episode_len_mean": 129.43, "episode_media": {}, "episodes_timesteps_total": 12943, "policy_reward_min": {"policy_0": -1253.9670031640105}, "policy_reward_max": {"policy_0": -2.75336542104591}, "policy_reward_mean": {"policy_0": -670.7395437699045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824], "episode_lengths": [34, 150, 133, 75, 150, 150, 150, 85, 98, 150, 150, 142, 50, 44, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 35, 92, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 107, 80, 150, 150, 150, 150, 150, 89, 70, 150, 61, 150, 150, 79, 150, 143, 150, 150, 150, 150, 150, 114, 150, 150, 109, 150, 150, 150, 150, 64, 128, 66, 150, 150, 150, 150, 70, 150, 114, 67, 54, 61, 150, 150, 150], "policy_policy_0_reward": [-5.564244581249909, -613.7834648812666, -403.9123137552153, -118.27565457170458, -697.8265254771343, -806.2272284996052, -935.3012438469825, -174.22371502996538, -348.28565837888533, -740.1745798629875, -1005.270082386619, -269.9083011225441, -46.804702640625976, -22.340566194278864, -567.3937898810651, -1176.833492616713, -1171.4273627844707, -494.95000203223066, -227.31807927508962, -968.9195181770335, -870.5136029747882, -941.0660257710346, -833.6848518154618, -866.0773842697216, -414.71219758256535, -2.75336542104591, -214.53972849466453, -1105.9939360304134, -1253.9670031640105, -1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517803191660384, "mean_inference_ms": 1.741727491212954, "mean_action_processing_ms": 0.2768072380782039, "mean_env_wait_ms": 3.0390117143313127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011774301528930664, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.19585680961608887}, "num_episodes": 29, "episode_return_max": -2.75336542104591, "episode_return_min": -1253.9670031640105, "episode_return_mean": -670.7395437699045, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.19334825278946, "num_env_steps_trained_throughput_per_sec": 306.19334825278946, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12178.081, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12178.006, "sample_time_ms": 1132.345, "learn_time_ms": 10985.12, "learn_throughput": 364.129, "synch_weights_time_ms": 59.759}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-46", "timestamp": 1722635026, "time_this_iter_s": 13.076016902923584, "time_total_s": 431.43945717811584, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.43945717811584, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.126315789473683, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 258.11969975630444, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.362675953780611, "policy_loss": -0.009777545922164184, "vf_loss": 4.381041448563337, "vf_explained_var": 0.987542845060428, "kl": 0.016080867033087996, "entropy": 1.5824343259756763, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -13.103964392759902, "episode_reward_min": -1265.407264721421, "episode_reward_mean": -718.3757606276865, "episode_len_mean": 133.1, "episode_media": {}, "episodes_timesteps_total": 13310, "policy_reward_min": {"policy_0": -1265.407264721421}, "policy_reward_max": {"policy_0": -13.103964392759902}, "policy_reward_mean": {"policy_0": -718.3757606276865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658], "episode_lengths": [150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 107, 80, 150, 150, 150, 150, 150, 89, 70, 150, 61, 150, 150, 79, 150, 143, 150, 150, 150, 150, 150, 114, 150, 150, 109, 150, 150, 150, 150, 64, 128, 66, 150, 150, 150, 150, 70, 150, 114, 67, 54, 61, 150, 150, 150, 150, 72, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 80, 150, 150, 150, 150, 71, 150, 106], "policy_policy_0_reward": [-1037.4682804823194, -1249.8964426978723, -759.3461283333739, -697.2894207774924, -29.156825417821377, -1043.0941320834356, -760.4178048043983, -825.3730997594488, -784.1590883425448, -825.8106807826123, -1065.7211171663653, -508.97060998723725, -580.4390212171703, -1033.065289482646, -869.6133602041238, -634.7016598708445, -1188.8672099155997, -886.1472595024782, -1106.7648568110162, -663.5440583375752, -881.7648481980821, -13.103964392759902, -958.5417194208165, -761.2155125315272, -886.5213639007449, -992.7644471747454, -352.23582810304885, -137.9842352558704, -973.4301854035699, -795.5072015406766, -1059.8051366268028, -774.8930757690441, -1152.5601032761354, -210.74481534486392, -72.0025246324714, -1011.2594370403535, -120.02125136392954, -672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519046532495067, "mean_inference_ms": 1.7405849422283666, "mean_action_processing_ms": 0.2767934109308833, "mean_env_wait_ms": 3.0408723474875483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011958122253417969, "StateBufferConnector_ms": 0.008049249649047852, "ViewRequirementAgentConnector_ms": 0.1983952522277832}, "num_episodes": 29, "episode_return_max": -13.103964392759902, "episode_return_min": -1265.407264721421, "episode_return_mean": -718.3757606276865, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.1083063464335, "num_env_steps_trained_throughput_per_sec": 313.1083063464335, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12130.811, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12130.739, "sample_time_ms": 1123.371, "learn_time_ms": 10945.78, "learn_throughput": 365.438, "synch_weights_time_ms": 60.805}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "3541f_00001", "date": "2024-08-03_03-13-59", "timestamp": 1722635039, "time_this_iter_s": 12.788841485977173, "time_total_s": 444.228298664093, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 444.228298664093, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 231.0924651503563, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.791752074162165, "policy_loss": -0.015275365854419458, "vf_loss": 4.810281692693631, "vf_explained_var": 0.9830613750964403, "kl": 0.016940837850233946, "entropy": 1.087763456751903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -4.0005923667385686, "episode_reward_min": -1265.407264721421, "episode_reward_mean": -647.0314759966377, "episode_len_mean": 126.06, "episode_media": {}, "episodes_timesteps_total": 12606, "policy_reward_min": {"policy_0": -1265.407264721421}, "policy_reward_max": {"policy_0": -4.0005923667385686}, "policy_reward_mean": {"policy_0": -647.0314759966377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658, -849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014], "episode_lengths": [150, 150, 79, 150, 143, 150, 150, 150, 150, 150, 114, 150, 150, 109, 150, 150, 150, 150, 64, 128, 66, 150, 150, 150, 150, 70, 150, 114, 67, 54, 61, 150, 150, 150, 150, 72, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 80, 150, 150, 150, 150, 71, 150, 106, 150, 150, 59, 47, 150, 150, 99, 150, 150, 108, 119, 97, 150, 79, 150, 78, 150, 44, 73, 150, 41, 71, 68, 150, 150, 58, 150, 150, 150, 108, 150, 150, 34, 106, 150, 150, 150], "policy_policy_0_reward": [-672.8786370174811, -919.5667383832349, -96.11208583852748, -917.3548010064021, -380.1539353718915, -597.0724227451632, -718.4497896922556, -863.4600062360984, -777.9746836681029, -1026.6824318646254, -278.6232653593825, -1109.9328757490048, -635.285367649228, -207.8264529619156, -1023.5478475628411, -881.5847598282509, -769.9224681246685, -616.3744770909016, -74.10713500656588, -476.31664530404987, -74.89700245575752, -1141.5369399814676, -963.9690589624531, -1099.762544921773, -854.6166189740178, -155.9766921246475, -1122.8018102959488, -481.872021913999, -208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658, -849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527028872352162, "mean_inference_ms": 1.7392271108597197, "mean_action_processing_ms": 0.2767919510471528, "mean_env_wait_ms": 3.040854793779817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011998176574707031, "StateBufferConnector_ms": 0.008032798767089844, "ViewRequirementAgentConnector_ms": 0.1985759735107422}, "num_episodes": 37, "episode_return_max": -4.0005923667385686, "episode_return_min": -1265.407264721421, "episode_return_mean": -647.0314759966377, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.84168848537513, "num_env_steps_trained_throughput_per_sec": 308.84168848537513, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12107.333, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12107.26, "sample_time_ms": 1122.488, "learn_time_ms": 10921.919, "learn_throughput": 366.236, "synch_weights_time_ms": 62.072}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "3541f_00001", "date": "2024-08-03_03-14-12", "timestamp": 1722635052, "time_this_iter_s": 12.963383197784424, "time_total_s": 457.19168186187744, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.19168186187744, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.866666666666664, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 246.07790760596592, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.5509071633219715, "policy_loss": -0.012321738207538147, "vf_loss": 4.571112167586883, "vf_explained_var": 0.9795237350588043, "kl": 0.015428988718334343, "entropy": 1.4826289188116788, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -4.0005923667385686, "episode_reward_min": -1322.057135316093, "episode_reward_mean": -661.1928979415333, "episode_len_mean": 125.69, "episode_media": {}, "episodes_timesteps_total": 12569, "policy_reward_min": {"policy_0": -1322.057135316093}, "policy_reward_max": {"policy_0": -4.0005923667385686}, "policy_reward_mean": {"policy_0": -661.1928979415333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658, -849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068], "episode_lengths": [67, 54, 61, 150, 150, 150, 150, 72, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 80, 150, 150, 150, 150, 71, 150, 106, 150, 150, 59, 47, 150, 150, 99, 150, 150, 108, 119, 97, 150, 79, 150, 78, 150, 44, 73, 150, 41, 71, 68, 150, 150, 58, 150, 150, 150, 108, 150, 150, 34, 106, 150, 150, 150, 150, 150, 148, 65, 150, 65, 150, 148, 150, 150, 150, 78, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 75, 150, 150, 81], "policy_policy_0_reward": [-208.91513816329865, -83.08962207211701, -150.09892065092725, -1052.0476334348275, -963.4010420282428, -675.4918870791824, -453.06014721454636, -120.27157452328362, -173.74023591963225, -1064.8882957257172, -1265.407264721421, -966.4413562848121, -772.510913960647, -882.2459927796608, -971.4630801825191, -1063.1223202167575, -639.3176135538563, -983.2335152692934, -908.2777087026867, -1056.4382972540623, -813.2425365325065, -1227.414256813491, -854.2492244996765, -885.5355019989505, -1008.5424178710513, -108.49236811613378, -478.9548292774683, -207.85152097773468, -970.8146637394391, -888.638005423572, -924.5406042814109, -970.7928025315152, -139.63393674555596, -1100.1286024847848, -162.42071969540658, -849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525044160460897, "mean_inference_ms": 1.7366789746245097, "mean_action_processing_ms": 0.27660180391952305, "mean_env_wait_ms": 3.039973226131065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012053966522216797, "StateBufferConnector_ms": 0.008214950561523438, "ViewRequirementAgentConnector_ms": 0.19671320915222168}, "num_episodes": 28, "episode_return_max": -4.0005923667385686, "episode_return_min": -1322.057135316093, "episode_return_mean": -661.1928979415333, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.5692737775863, "num_env_steps_trained_throughput_per_sec": 300.5692737775863, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12155.31, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12155.238, "sample_time_ms": 1105.108, "learn_time_ms": 10986.459, "learn_throughput": 364.085, "synch_weights_time_ms": 62.877}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "3541f_00001", "date": "2024-08-03_03-14-25", "timestamp": 1722635065, "time_this_iter_s": 13.320704221725464, "time_total_s": 470.5123860836029, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.5123860836029, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.352631578947367, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.32303961515427, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.577114446709554, "policy_loss": -0.014769173460566283, "vf_loss": 4.599146766712268, "vf_explained_var": 0.9885192982852459, "kl": 0.01479234432163139, "entropy": 1.3919706484302878, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -4.0005923667385686, "episode_reward_min": -1322.057135316093, "episode_reward_mean": -628.2768021904067, "episode_len_mean": 123.58, "episode_media": {}, "episodes_timesteps_total": 12358, "policy_reward_min": {"policy_0": -1322.057135316093}, "policy_reward_max": {"policy_0": -4.0005923667385686}, "policy_reward_mean": {"policy_0": -628.2768021904067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848], "episode_lengths": [150, 150, 59, 47, 150, 150, 99, 150, 150, 108, 119, 97, 150, 79, 150, 78, 150, 44, 73, 150, 41, 71, 68, 150, 150, 58, 150, 150, 150, 108, 150, 150, 34, 106, 150, 150, 150, 150, 150, 148, 65, 150, 65, 150, 148, 150, 150, 150, 78, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 75, 150, 150, 81, 87, 101, 150, 76, 150, 77, 150, 105, 150, 150, 150, 73, 150, 150, 150, 75, 150, 150, 57, 150, 150, 85, 74, 51, 150, 142, 150, 150, 150, 66, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-849.5275144142489, -1172.7866366208934, -124.09847910789009, -36.25314063911483, -556.5750586714167, -779.248958206504, -242.1905066402942, -822.0751590376693, -813.3449174252701, -226.77015447447263, -533.6706364225164, -379.15068571992356, -1013.2768680278471, -217.31967902514222, -709.636376384296, -114.54609761205612, -817.8522695732993, -11.424254375092344, -186.78125135881217, -1173.8057282721118, -48.688617150442504, -209.16901609484714, -186.10053095199495, -1078.9405325715722, -722.0314170343908, -56.19650360984325, -811.367247322232, -1018.0697629811203, -841.5283817411498, -294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532598086582285, "mean_inference_ms": 1.7366505689586669, "mean_action_processing_ms": 0.27669230964959585, "mean_env_wait_ms": 3.0425197185922848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012276649475097656, "StateBufferConnector_ms": 0.008131265640258789, "ViewRequirementAgentConnector_ms": 0.19368815422058105}, "num_episodes": 35, "episode_return_max": -4.0005923667385686, "episode_return_min": -1322.057135316093, "episode_return_mean": -628.2768021904067, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.93312614443084, "num_env_steps_trained_throughput_per_sec": 305.93312614443084, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12309.538, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12309.467, "sample_time_ms": 1096.661, "learn_time_ms": 11150.902, "learn_throughput": 358.715, "synch_weights_time_ms": 61.063}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "3541f_00001", "date": "2024-08-03_03-14-39", "timestamp": 1722635079, "time_this_iter_s": 13.087147235870361, "time_total_s": 483.59953331947327, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d408f2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 483.59953331947327, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 16.900000000000002, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 310.0203269004822, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.229731595143676, "policy_loss": -0.017041929944146734, "vf_loss": 4.252713206782937, "vf_explained_var": 0.9907919753342866, "kl": 0.0197728602449691, "entropy": 1.4837471403181552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -4.0005923667385686, "episode_reward_min": -1322.057135316093, "episode_reward_mean": -687.3709801669386, "episode_len_mean": 129.59, "episode_media": {}, "episodes_timesteps_total": 12959, "policy_reward_min": {"policy_0": -1322.057135316093}, "policy_reward_max": {"policy_0": -4.0005923667385686}, "policy_reward_mean": {"policy_0": -687.3709801669386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235], "episode_lengths": [108, 150, 150, 34, 106, 150, 150, 150, 150, 150, 148, 65, 150, 65, 150, 148, 150, 150, 150, 78, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 75, 150, 150, 81, 87, 101, 150, 76, 150, 77, 150, 105, 150, 150, 150, 73, 150, 150, 150, 75, 150, 150, 57, 150, 150, 85, 74, 51, 150, 142, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 101, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 133, 68, 86, 150, 150, 150, 50, 150, 150, 150, 150], "policy_policy_0_reward": [-294.4871433519371, -925.2341152929416, -694.8223880051396, -4.0005923667385686, -150.69260862484444, -854.4893893756422, -1002.002664880116, -891.6182494831014, -1047.7453082960817, -982.5761518418484, -853.2678358995331, -174.22498040268755, -1167.6722836010188, -89.06254429154517, -1322.057135316093, -676.8081234482487, -745.1100216094777, -750.042445446689, -654.8244273257634, -118.36655772968044, -942.5773017488117, -1076.60860869096, -1003.541483925774, -993.4677826617803, -774.3241451305275, -20.16856015400638, -932.2926862320202, -1008.6811611166344, -916.473570119815, -534.2138954251753, -892.591352912268, -1066.0648626076133, -93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526627189055469, "mean_inference_ms": 1.7336436534801534, "mean_action_processing_ms": 0.2766490386300136, "mean_env_wait_ms": 3.0427043001761622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011998414993286133, "StateBufferConnector_ms": 0.008095026016235352, "ViewRequirementAgentConnector_ms": 0.19176745414733887}, "num_episodes": 29, "episode_return_max": -4.0005923667385686, "episode_return_min": -1322.057135316093, "episode_return_mean": -687.3709801669386, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.677399494291, "num_env_steps_trained_throughput_per_sec": 307.677399494291, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12305.714, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12305.643, "sample_time_ms": 1093.718, "learn_time_ms": 11149.553, "learn_throughput": 358.759, "synch_weights_time_ms": 61.529}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "3541f_00001", "date": "2024-08-03_03-14-52", "timestamp": 1722635092, "time_this_iter_s": 13.013118267059326, "time_total_s": 496.6126515865326, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4128af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.6126515865326, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.189473684210526, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 272.4457697192828, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.605206018437942, "policy_loss": -0.012466501388310765, "vf_loss": 4.6243362327416735, "vf_explained_var": 0.9826901874194542, "kl": 0.015926202622480005, "entropy": 1.3830499495069186, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -17.80006581521325, "episode_reward_min": -1307.8957874512616, "episode_reward_mean": -682.4481379509438, "episode_len_mean": 128.71, "episode_media": {}, "episodes_timesteps_total": 12871, "policy_reward_min": {"policy_0": -1307.8957874512616}, "policy_reward_max": {"policy_0": -17.80006581521325}, "policy_reward_mean": {"policy_0": -682.4481379509438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662], "episode_lengths": [75, 150, 150, 81, 87, 101, 150, 76, 150, 77, 150, 105, 150, 150, 150, 73, 150, 150, 150, 75, 150, 150, 57, 150, 150, 85, 74, 51, 150, 142, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 101, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 133, 68, 86, 150, 150, 150, 50, 150, 150, 150, 150, 132, 150, 82, 107, 150, 150, 42, 44, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 53, 150, 150, 150, 126, 150], "policy_policy_0_reward": [-93.23318871177572, -620.49970701246, -758.7140087815816, -139.59158014034068, -181.82605107926653, -236.659514468336, -807.2919760704535, -63.26801500023524, -1140.3023994418052, -153.38006635474557, -847.4449496165425, -236.03023249931908, -688.892759891661, -736.0822349951621, -516.2962428666563, -108.40237486277388, -1215.1198099000794, -780.0427766019901, -979.3062815195376, -106.0665009504624, -858.3933420976026, -890.3548557590788, -54.13500777541104, -1168.9052615790968, -907.8938021320482, -166.58510322949599, -100.8945925615224, -32.47817798323685, -1099.169190961167, -538.0943810120618, -1038.1557132491882, -1034.1113808787043, -631.5755951427062, -63.03463995092052, -691.9242321065549, -885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528694886467755, "mean_inference_ms": 1.732784981907233, "mean_action_processing_ms": 0.2767688335726357, "mean_env_wait_ms": 3.044494510431921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847496032714844, "StateBufferConnector_ms": 0.00787663459777832, "ViewRequirementAgentConnector_ms": 0.1910240650177002}, "num_episodes": 32, "episode_return_max": -17.80006581521325, "episode_return_min": -1307.8957874512616, "episode_return_mean": -682.4481379509438, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.9273971958027, "num_env_steps_trained_throughput_per_sec": 303.9273971958027, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12289.785, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12289.712, "sample_time_ms": 1051.273, "learn_time_ms": 11175.835, "learn_throughput": 357.915, "synch_weights_time_ms": 61.753}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "3541f_00001", "date": "2024-08-03_03-15-05", "timestamp": 1722635105, "time_this_iter_s": 13.173455715179443, "time_total_s": 509.78610730171204, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415cd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 509.78610730171204, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.327777777777776, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.80355188449224, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.142364050696293, "policy_loss": -0.011760757372151905, "vf_loss": 5.157200349122286, "vf_explained_var": 0.9829848626628518, "kl": 0.016631294727873613, "entropy": 1.0559624527891478, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -17.80006581521325, "episode_reward_min": -1307.8957874512616, "episode_reward_mean": -689.0655507669211, "episode_len_mean": 129.87, "episode_media": {}, "episodes_timesteps_total": 12987, "policy_reward_min": {"policy_0": -1307.8957874512616}, "policy_reward_max": {"policy_0": -17.80006581521325}, "policy_reward_mean": {"policy_0": -689.0655507669211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 101, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 133, 68, 86, 150, 150, 150, 50, 150, 150, 150, 150, 132, 150, 82, 107, 150, 150, 42, 44, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 53, 150, 150, 150, 126, 150, 150, 46, 150, 150, 150, 82, 89, 150, 48, 150, 150, 150, 150, 150, 150, 150, 117, 85, 90, 115, 44, 121, 150, 150, 150, 72, 150, 150, 149, 150, 81, 150, 150, 52, 150], "policy_policy_0_reward": [-885.0214525766502, -917.5540503519635, -933.7067214012421, -1094.705288745848, -763.0895631063946, -1008.0529252066905, -1086.8776472030931, -1120.9809599822765, -426.6150392159991, -76.26594536240489, -1183.53570526254, -339.0100667278316, -1021.2085701810804, -289.0500583240184, -1071.998376626819, -992.1330424479087, -229.22175712369392, -1127.647297120875, -616.3096628235253, -948.9146747687785, -926.6070902671413, -441.3466996371574, -422.3872219689307, -132.27292271309526, -221.09261982323468, -1307.8957874512616, -1108.0174604590684, -739.4649389347995, -51.49442376422697, -1137.077229447378, -558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528155571289546, "mean_inference_ms": 1.731048209081477, "mean_action_processing_ms": 0.2765611528172867, "mean_env_wait_ms": 3.0453804925537185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687994003295898, "StateBufferConnector_ms": 0.007842063903808594, "ViewRequirementAgentConnector_ms": 0.19385743141174316}, "num_episodes": 35, "episode_return_max": -17.80006581521325, "episode_return_min": -1307.8957874512616, "episode_return_mean": -689.0655507669211, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.03971472422626, "num_env_steps_trained_throughput_per_sec": 296.03971472422626, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12577.683, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12577.61, "sample_time_ms": 1050.536, "learn_time_ms": 11463.276, "learn_throughput": 348.94, "synch_weights_time_ms": 62.949}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "3541f_00001", "date": "2024-08-03_03-15-18", "timestamp": 1722635118, "time_this_iter_s": 13.525790691375732, "time_total_s": 523.3118979930878, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415de10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 523.3118979930878, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 16.57, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 262.4000186741352, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.571968657275041, "policy_loss": -0.01264790698478464, "vf_loss": 4.585013077159723, "vf_explained_var": 0.9814404694984357, "kl": 0.018789746107965324, "entropy": 0.8851901986946662, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -12.198708291666188, "episode_reward_min": -1296.3730010845165, "episode_reward_mean": -614.2288113474347, "episode_len_mean": 124.76, "episode_media": {}, "episodes_timesteps_total": 12476, "policy_reward_min": {"policy_0": -1296.3730010845165}, "policy_reward_max": {"policy_0": -12.198708291666188}, "policy_reward_mean": {"policy_0": -614.2288113474347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527], "episode_lengths": [150, 150, 150, 132, 150, 82, 107, 150, 150, 42, 44, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 53, 150, 150, 150, 126, 150, 150, 46, 150, 150, 150, 82, 89, 150, 48, 150, 150, 150, 150, 150, 150, 150, 117, 85, 90, 115, 44, 121, 150, 150, 150, 72, 150, 150, 149, 150, 81, 150, 150, 52, 150, 103, 150, 150, 150, 150, 150, 118, 51, 150, 126, 65, 41, 150, 150, 49, 150, 150, 80, 150, 80, 150, 150, 82, 75, 150, 150, 150, 58, 53, 150], "policy_policy_0_reward": [-558.0222977288465, -1036.0498169683622, -1279.204378472235, -595.260112825951, -685.7437072014311, -219.12323381140334, -358.95194983770716, -899.088927260577, -1138.0926313171826, -17.80006581521325, -22.02968196569467, -991.8205797604305, -911.5166767737996, -917.4574286689956, -1033.1394978509957, -813.2256726413124, -952.2019363002549, -66.17775790483029, -1027.6680045757682, -742.726450555824, -1132.6192163102648, -867.3628365736879, -1047.1550946837112, -294.9480062932523, -55.57303904865057, -851.1222530471405, -1200.029875862835, -1071.9965049634736, -952.0879334953604, -22.693508731415307, -1102.644008192076, -1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531844595282631, "mean_inference_ms": 1.730032416885684, "mean_action_processing_ms": 0.27658884311026494, "mean_env_wait_ms": 3.0458093056824374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011842966079711914, "StateBufferConnector_ms": 0.007703542709350586, "ViewRequirementAgentConnector_ms": 0.1910536289215088}, "num_episodes": 30, "episode_return_max": -12.198708291666188, "episode_return_min": -1296.3730010845165, "episode_return_mean": -614.2288113474347, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6056220714929, "num_env_steps_trained_throughput_per_sec": 298.6056220714929, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 13172.555, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13172.483, "sample_time_ms": 1056.108, "learn_time_ms": 12050.245, "learn_throughput": 331.943, "synch_weights_time_ms": 65.277}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "3541f_00001", "date": "2024-08-03_03-15-32", "timestamp": 1722635132, "time_this_iter_s": 13.407199144363403, "time_total_s": 536.7190971374512, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415dbd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.7190971374512, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 16.931578947368422, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 273.0372409502665, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.531694385906061, "policy_loss": -0.016521450469250947, "vf_loss": 4.556080425282319, "vf_explained_var": 0.9826499526699384, "kl": 0.016714596779032382, "entropy": 1.5386154875159264, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -12.198708291666188, "episode_reward_min": -1296.3730010845165, "episode_reward_mean": -589.3452464783118, "episode_len_mean": 124.03, "episode_media": {}, "episodes_timesteps_total": 12403, "policy_reward_min": {"policy_0": -1296.3730010845165}, "policy_reward_max": {"policy_0": -12.198708291666188}, "policy_reward_mean": {"policy_0": -589.3452464783118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753], "episode_lengths": [150, 150, 126, 150, 150, 46, 150, 150, 150, 82, 89, 150, 48, 150, 150, 150, 150, 150, 150, 150, 117, 85, 90, 115, 44, 121, 150, 150, 150, 72, 150, 150, 149, 150, 81, 150, 150, 52, 150, 103, 150, 150, 150, 150, 150, 118, 51, 150, 126, 65, 41, 150, 150, 49, 150, 150, 80, 150, 80, 150, 150, 82, 75, 150, 150, 150, 58, 53, 150, 150, 93, 43, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 63, 150, 135, 150, 150, 94, 150, 150, 40, 150, 150, 150, 150, 150, 90, 59, 150], "policy_policy_0_reward": [-1153.3586396593075, -604.5950983644124, -578.7689229520867, -740.8469024699662, -849.0501591919347, -32.32327522095244, -592.6319472177182, -658.8912587178243, -727.6634646208099, -193.0331767990074, -77.72227333539455, -706.8471503035628, -27.037641480003927, -869.8840267026786, -1296.3730010845165, -854.9064116930087, -730.8077232296221, -775.3237859351142, -745.3326000920202, -616.6773195229744, -478.2021490490197, -231.4760832967795, -247.7130622186995, -204.5390914107715, -25.356064400626586, -507.5241188940661, -810.2213736050159, -473.03336413987483, -923.3309611587983, -74.74942235020792, -1208.211489766162, -982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553109210712912, "mean_inference_ms": 1.728480920788209, "mean_action_processing_ms": 0.27648554907687933, "mean_env_wait_ms": 3.0472668862458248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012017011642456055, "StateBufferConnector_ms": 0.007709026336669922, "ViewRequirementAgentConnector_ms": 0.190704345703125}, "num_episodes": 31, "episode_return_max": -12.198708291666188, "episode_return_min": -1296.3730010845165, "episode_return_mean": -589.3452464783118, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.4161047908035, "num_env_steps_trained_throughput_per_sec": 306.4161047908035, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 13129.645, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13129.575, "sample_time_ms": 1057.425, "learn_time_ms": 12003.473, "learn_throughput": 333.237, "synch_weights_time_ms": 67.805}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "3541f_00001", "date": "2024-08-03_03-15-45", "timestamp": 1722635145, "time_this_iter_s": 13.068201541900635, "time_total_s": 549.7872986793518, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d4129a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.7872986793518, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.144444444444446, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 318.9847736140092, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.645552935202916, "policy_loss": -0.013254028237618816, "vf_loss": 4.664972025652727, "vf_explained_var": 0.9793936491633455, "kl": 0.017329779743765098, "entropy": 1.3963458148762584, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -12.198708291666188, "episode_reward_min": -1226.423082737249, "episode_reward_mean": -632.0450947070925, "episode_len_mean": 126.34, "episode_media": {}, "episodes_timesteps_total": 12634, "policy_reward_min": {"policy_0": -1226.423082737249}, "policy_reward_max": {"policy_0": -12.198708291666188}, "policy_reward_mean": {"policy_0": -632.0450947070925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634], "episode_lengths": [150, 149, 150, 81, 150, 150, 52, 150, 103, 150, 150, 150, 150, 150, 118, 51, 150, 126, 65, 41, 150, 150, 49, 150, 150, 80, 150, 80, 150, 150, 82, 75, 150, 150, 150, 58, 53, 150, 150, 93, 43, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 63, 150, 135, 150, 150, 94, 150, 150, 40, 150, 150, 150, 150, 150, 90, 59, 150, 89, 150, 150, 57, 150, 118, 150, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 82, 61, 150, 150, 150, 128], "policy_policy_0_reward": [-982.0991171791237, -355.2423043736272, -606.1634539970869, -142.68758244455688, -1226.423082737249, -1081.1998581990895, -51.67990084222486, -961.5395335716038, -210.0707257249455, -1134.8695869620396, -873.9022351791178, -985.4403519263199, -545.6343349118304, -773.9433879133395, -302.7977043432295, -21.01028806308227, -298.47314045128405, -674.5475085096948, -73.28889083724715, -12.198708291666188, -1119.8837686580991, -926.3218174898923, -21.458796987683133, -622.7916580231852, -872.8586210850477, -167.6734462343815, -560.2903068978643, -102.6883741844756, -1063.0967827924137, -1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531330250842256, "mean_inference_ms": 1.7262704504863922, "mean_action_processing_ms": 0.2763925959673691, "mean_env_wait_ms": 3.046048018733484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011880636215209961, "StateBufferConnector_ms": 0.007686614990234375, "ViewRequirementAgentConnector_ms": 0.19019675254821777}, "num_episodes": 31, "episode_return_max": -12.198708291666188, "episode_return_min": -1226.423082737249, "episode_return_mean": -632.0450947070925, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.9154712708102, "num_env_steps_trained_throughput_per_sec": 301.9154712708102, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 13148.155, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13148.085, "sample_time_ms": 1057.722, "learn_time_ms": 12019.714, "learn_throughput": 332.787, "synch_weights_time_ms": 69.829}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "3541f_00001", "date": "2024-08-03_03-15-58", "timestamp": 1722635158, "time_this_iter_s": 13.260023355484009, "time_total_s": 563.0473220348358, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 563.0473220348358, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.121052631578948, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.426992893219, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.606153909116983, "policy_loss": -0.011593012393374617, "vf_loss": 4.6253526389598845, "vf_explained_var": 0.9759449551502863, "kl": 0.014950424650548227, "entropy": 1.4333411138504744, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -2.732083883455868, "episode_reward_min": -1377.50844949883, "episode_reward_mean": -662.8115246510498, "episode_len_mean": 128.33, "episode_media": {}, "episodes_timesteps_total": 12833, "policy_reward_min": {"policy_0": -1377.50844949883}, "policy_reward_max": {"policy_0": -2.732083883455868}, "policy_reward_mean": {"policy_0": -662.8115246510498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739], "episode_lengths": [150, 82, 75, 150, 150, 150, 58, 53, 150, 150, 93, 43, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 63, 150, 135, 150, 150, 94, 150, 150, 40, 150, 150, 150, 150, 150, 90, 59, 150, 89, 150, 150, 57, 150, 118, 150, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 82, 61, 150, 150, 150, 128, 58, 150, 41, 66, 150, 150, 45, 150, 150, 144, 150, 150, 150, 147, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 59, 150], "policy_policy_0_reward": [-1048.5265388472285, -213.00880175501294, -147.18965547182984, -394.4548248685814, -781.8458597153398, -674.601706118916, -111.48023963532607, -49.092569676656595, -352.4406255215527, -702.4726800725874, -259.5449988524286, -27.320345247537034, -1088.298206069181, -584.1640924647446, -1177.6908766158765, -29.62407345368181, -802.1918089097677, -895.698810601734, -1049.5690442322618, -722.0482965601269, -787.9456066578922, -1125.0595076058212, -968.7586597042546, -70.73919882632353, -704.670210570642, -627.5879293092343, -928.5763295512774, -890.0852263536951, -309.15003072086034, -1055.940023124437, -698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529488520299375, "mean_inference_ms": 1.7248661284240214, "mean_action_processing_ms": 0.2763668922594625, "mean_env_wait_ms": 3.045958653915642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011861085891723633, "StateBufferConnector_ms": 0.0077898502349853516, "ViewRequirementAgentConnector_ms": 0.1925201416015625}, "num_episodes": 29, "episode_return_max": -2.732083883455868, "episode_return_min": -1377.50844949883, "episode_return_mean": -662.8115246510498, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3268459802855, "num_env_steps_trained_throughput_per_sec": 317.3268459802855, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 13131.173, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13131.101, "sample_time_ms": 1060.253, "learn_time_ms": 12002.284, "learn_throughput": 333.27, "synch_weights_time_ms": 67.742}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "3541f_00001", "date": "2024-08-03_03-16-11", "timestamp": 1722635171, "time_this_iter_s": 12.617002248764038, "time_total_s": 575.6643242835999, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 575.6643242835999, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.305555555555557, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 289.868901737531, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.094786905497313, "policy_loss": -0.012542625125691605, "vf_loss": 5.11441767613093, "vf_explained_var": 0.9777450681353609, "kl": 0.0173101175865062, "entropy": 1.4877702655270695, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -2.732083883455868, "episode_reward_min": -1377.50844949883, "episode_reward_mean": -675.0172755906092, "episode_len_mean": 130.07, "episode_media": {}, "episodes_timesteps_total": 13007, "policy_reward_min": {"policy_0": -1377.50844949883}, "policy_reward_max": {"policy_0": -2.732083883455868}, "policy_reward_mean": {"policy_0": -675.0172755906092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829], "episode_lengths": [150, 40, 150, 150, 150, 150, 150, 90, 59, 150, 89, 150, 150, 57, 150, 118, 150, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 82, 61, 150, 150, 150, 128, 58, 150, 41, 66, 150, 150, 45, 150, 150, 144, 150, 150, 150, 147, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 59, 150, 150, 107, 62, 150, 150, 150, 79, 150, 150, 150, 85, 150, 150, 58, 150, 72, 150, 150, 150, 51, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-698.177654338425, -17.187541726723147, -759.8249471150598, -963.1390855364251, -568.4431323899743, -649.2322571172272, -713.1235379767903, -274.9783407021989, -73.5500695438309, -850.3840765753753, -139.4903484120034, -853.7311011088073, -1076.247622264013, -40.75307608135472, -874.7499178901361, -519.2724464133858, -997.7029724336378, -281.8384814352077, -697.7530667448543, -1121.141724539763, -737.037173638931, -859.3159128788114, -310.121459313385, -756.5499623943499, -865.0889842234554, -1025.9411237786792, -974.4883906547174, -631.3853655533137, -747.5784840161236, -987.0827107066718, -1141.1830517781925, -1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530687854876333, "mean_inference_ms": 1.7243722905698646, "mean_action_processing_ms": 0.2765462442818199, "mean_env_wait_ms": 3.0461733238577944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909246444702148, "StateBufferConnector_ms": 0.007880449295043945, "ViewRequirementAgentConnector_ms": 0.19551539421081543}, "num_episodes": 30, "episode_return_max": -2.732083883455868, "episode_return_min": -1377.50844949883, "episode_return_mean": -675.0172755906092, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.99393060185275, "num_env_steps_trained_throughput_per_sec": 313.99393060185275, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 13109.921, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13109.847, "sample_time_ms": 1060.198, "learn_time_ms": 11981.517, "learn_throughput": 333.848, "synch_weights_time_ms": 67.309}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "3541f_00001", "date": "2024-08-03_03-16-24", "timestamp": 1722635184, "time_this_iter_s": 12.752305030822754, "time_total_s": 588.4166293144226, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 588.4166293144226, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 277.9626551270485, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.711223158985376, "policy_loss": -0.012186894939804915, "vf_loss": 4.729652693370978, "vf_explained_var": 0.9632016162077586, "kl": 0.01715955110642736, "entropy": 1.3964458235229056, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -2.732083883455868, "episode_reward_min": -1377.50844949883, "episode_reward_mean": -681.8215784534332, "episode_len_mean": 130.49, "episode_media": {}, "episodes_timesteps_total": 13049, "policy_reward_min": {"policy_0": -1377.50844949883}, "policy_reward_max": {"policy_0": -2.732083883455868}, "policy_reward_mean": {"policy_0": -681.8215784534332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793], "episode_lengths": [150, 79, 150, 150, 82, 61, 150, 150, 150, 128, 58, 150, 41, 66, 150, 150, 45, 150, 150, 144, 150, 150, 150, 147, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 59, 150, 150, 107, 62, 150, 150, 150, 79, 150, 150, 150, 85, 150, 150, 58, 150, 72, 150, 150, 150, 51, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 75, 150, 150, 150, 150, 146, 150, 150, 150, 54, 150, 46, 150, 150, 150, 66, 80, 150, 130, 130], "policy_policy_0_reward": [-1109.2558505731033, -231.51858321369218, -1060.1068962550717, -1177.393429028609, -250.40191103681678, -33.99504048729423, -815.6777511702875, -808.5078169846474, -827.018333837565, -334.08779291412634, -135.72425246899866, -361.4563019593837, -2.732083883455868, -172.98067009978638, -1092.8732761405572, -654.1039221103898, -33.89781591941124, -662.6096771098975, -1019.9289809903964, -649.3736343459983, -1377.50844949883, -911.6151429145741, -772.7718550617262, -360.6726387768333, -1218.0367451989384, -1003.7086677042581, -485.79784110780145, -1137.207357685685, -807.3169426101273, -1101.2278364528559, -945.3438801134088, -722.0887248251496, -649.5544003077673, -936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552861964550218, "mean_inference_ms": 1.7227267089796259, "mean_action_processing_ms": 0.2764664382004742, "mean_env_wait_ms": 3.0470224291252777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011787891387939453, "StateBufferConnector_ms": 0.008127689361572266, "ViewRequirementAgentConnector_ms": 0.19724345207214355}, "num_episodes": 31, "episode_return_max": -2.732083883455868, "episode_return_min": -1377.50844949883, "episode_return_mean": -681.8215784534332, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.51576305118346, "num_env_steps_trained_throughput_per_sec": 306.51576305118346, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 13084.103, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13084.029, "sample_time_ms": 1059.329, "learn_time_ms": 11955.959, "learn_throughput": 334.561, "synch_weights_time_ms": 67.921}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "3541f_00001", "date": "2024-08-03_03-16-37", "timestamp": 1722635197, "time_this_iter_s": 13.062113523483276, "time_total_s": 601.4787428379059, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415edd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 601.4787428379059, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.289473684210527, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 303.05504729350406, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.5281915744145715, "policy_loss": -0.012210437535153081, "vf_loss": 4.548274993399779, "vf_explained_var": 0.9883146661023299, "kl": 0.01984053657482345, "entropy": 1.680123607069254, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -23.903325012286896, "episode_reward_min": -1343.3333443641886, "episode_reward_mean": -696.3135445559997, "episode_len_mean": 130.61, "episode_media": {}, "episodes_timesteps_total": 13061, "policy_reward_min": {"policy_0": -1343.3333443641886}, "policy_reward_max": {"policy_0": -23.903325012286896}, "policy_reward_mean": {"policy_0": -696.3135445559997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528], "episode_lengths": [150, 150, 150, 69, 59, 150, 150, 107, 62, 150, 150, 150, 79, 150, 150, 150, 85, 150, 150, 58, 150, 72, 150, 150, 150, 51, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 75, 150, 150, 150, 150, 146, 150, 150, 150, 54, 150, 46, 150, 150, 150, 66, 80, 150, 130, 130, 150, 150, 150, 61, 150, 150, 150, 150, 150, 71, 46, 53, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 137, 150, 92, 150, 150, 150, 68, 150, 77], "policy_policy_0_reward": [-936.4723952341934, -769.5947863025053, -688.4018408429793, -139.60485481385322, -112.09058181810809, -922.2227069092739, -1243.2720158473473, -414.0249460465069, -42.50378646609077, -1318.8840899800396, -618.6349903407908, -610.0792072822743, -94.1984324130391, -880.3696710273182, -523.7491600874687, -785.1970633794756, -195.93110999344682, -646.4034382000601, -1055.8824527671334, -99.48096793580225, -720.3897663804448, -102.46958648436969, -1247.4110615325799, -811.9359404850356, -551.9412876710862, -28.257190572844692, -285.7599111632914, -1343.3333443641886, -806.635955424661, -829.0399954144854, -1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529350926802309, "mean_inference_ms": 1.7220387444562233, "mean_action_processing_ms": 0.27656010329546343, "mean_env_wait_ms": 3.048559074163229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0117034912109375, "StateBufferConnector_ms": 0.008116960525512695, "ViewRequirementAgentConnector_ms": 0.1966722011566162}, "num_episodes": 33, "episode_return_max": -23.903325012286896, "episode_return_min": -1343.3333443641886, "episode_return_mean": -696.3135445559997, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1738075795118, "num_env_steps_trained_throughput_per_sec": 306.1738075795118, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 13083.075, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13083.001, "sample_time_ms": 1059.743, "learn_time_ms": 11954.033, "learn_throughput": 334.615, "synch_weights_time_ms": 68.453}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "3541f_00001", "date": "2024-08-03_03-16-50", "timestamp": 1722635210, "time_this_iter_s": 13.078185319900513, "time_total_s": 614.5569281578064, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 614.5569281578064, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.984210526315792, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.4457234323025, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.9802106576661265, "policy_loss": -0.010948818630034414, "vf_loss": 4.996175279716651, "vf_explained_var": 0.9726433175926407, "kl": 0.01815850508208617, "entropy": 1.3187140643596649, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -23.903325012286896, "episode_reward_min": -1313.6777168857964, "episode_reward_mean": -703.903074515784, "episode_len_mean": 132.69, "episode_media": {}, "episodes_timesteps_total": 13269, "policy_reward_min": {"policy_0": -1313.6777168857964}, "policy_reward_max": {"policy_0": -23.903325012286896}, "policy_reward_mean": {"policy_0": -703.903074515784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 75, 150, 150, 150, 150, 146, 150, 150, 150, 54, 150, 46, 150, 150, 150, 66, 80, 150, 130, 130, 150, 150, 150, 61, 150, 150, 150, 150, 150, 71, 46, 53, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 137, 150, 92, 150, 150, 150, 68, 150, 77, 150, 150, 112, 150, 67, 150, 150, 80, 150, 150, 150, 150, 150, 144, 124, 150, 137, 150, 150, 85, 92, 107, 150, 150, 80, 150, 66, 150, 150, 150], "policy_policy_0_reward": [-1313.6777168857964, -309.2481957073978, -552.834693305872, -833.0823187678678, -715.2796381746454, -820.4439369693829, -651.6085280296292, -878.7503943641378, -1005.0481665470078, -964.3938962633493, -999.2640060213461, -974.0208596695695, -853.5753963181269, -418.9575847610181, -674.128183427456, -661.1885742590192, -1008.3374520613213, -89.06705110208061, -786.9571118762725, -1003.7350676773686, -1033.3454117172407, -680.3315368085923, -626.3605028496446, -741.2442988512508, -842.5628522136545, -1027.0885943671487, -115.01119550504659, -1164.0333215801165, -23.903325012286896, -257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528543695726165, "mean_inference_ms": 1.7205586540890634, "mean_action_processing_ms": 0.2765552820892951, "mean_env_wait_ms": 3.048491132746439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011533737182617188, "StateBufferConnector_ms": 0.00805807113647461, "ViewRequirementAgentConnector_ms": 0.19491195678710938}, "num_episodes": 30, "episode_return_max": -23.903325012286896, "episode_return_min": -1313.6777168857964, "episode_return_mean": -703.903074515784, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7145828535078, "num_env_steps_trained_throughput_per_sec": 314.7145828535078, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 13054.005, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13053.931, "sample_time_ms": 1058.363, "learn_time_ms": 11925.984, "learn_throughput": 335.402, "synch_weights_time_ms": 68.811}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "3541f_00001", "date": "2024-08-03_03-17-03", "timestamp": 1722635223, "time_this_iter_s": 12.721161842346191, "time_total_s": 627.2780900001526, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 627.2780900001526, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.316666666666666, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 333.468025358518, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.536156863719225, "policy_loss": -0.01455786110648963, "vf_loss": 4.557263954728842, "vf_explained_var": 0.9884460514411331, "kl": 0.019547804162114872, "entropy": 1.5345750428115328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -44.961625276445965, "episode_reward_min": -1248.2873113012404, "episode_reward_mean": -705.9337221478378, "episode_len_mean": 131.66, "episode_media": {}, "episodes_timesteps_total": 13166, "policy_reward_min": {"policy_0": -1248.2873113012404}, "policy_reward_max": {"policy_0": -44.961625276445965}, "policy_reward_mean": {"policy_0": -705.9337221478378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677], "episode_lengths": [150, 150, 150, 66, 80, 150, 130, 130, 150, 150, 150, 61, 150, 150, 150, 150, 150, 71, 46, 53, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 137, 150, 92, 150, 150, 150, 68, 150, 77, 150, 150, 112, 150, 67, 150, 150, 80, 150, 150, 150, 150, 150, 144, 124, 150, 137, 150, 150, 85, 92, 107, 150, 150, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 47, 150, 87, 150, 150, 150, 115, 74, 150], "policy_policy_0_reward": [-257.4686168353391, -948.8483380684067, -1129.778403037475, -192.0865185980403, -245.62737122879852, -756.1635343900027, -571.7381046027958, -562.3001075206793, -1122.838574936876, -841.7049957385914, -435.5635563772344, -53.98013465905497, -808.2646188656709, -922.6889261856378, -1248.2873113012404, -1231.0296173646163, -1113.610532464475, -91.91717991015676, -60.903661521997385, -133.96791341932038, -918.7063865161169, -1031.3571985469719, -959.3347371267096, -918.1488362667669, -58.21300978465088, -1013.716353978243, -811.4052662956576, -1156.2411165746062, -1147.7791258665295, -939.393209467671, -720.9469393639264, -863.4138118164956, -553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526033320922634, "mean_inference_ms": 1.7198223401252588, "mean_action_processing_ms": 0.27652630970462955, "mean_env_wait_ms": 3.0488530183348335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011485815048217773, "StateBufferConnector_ms": 0.007743358612060547, "ViewRequirementAgentConnector_ms": 0.19100451469421387}, "num_episodes": 29, "episode_return_max": -44.961625276445965, "episode_return_min": -1248.2873113012404, "episode_return_mean": -705.9337221478378, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.9700785359711, "num_env_steps_trained_throughput_per_sec": 298.9700785359711, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 13075.828, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13075.755, "sample_time_ms": 1070.033, "learn_time_ms": 11936.522, "learn_throughput": 335.106, "synch_weights_time_ms": 68.42}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "3541f_00001", "date": "2024-08-03_03-17-16", "timestamp": 1722635236, "time_this_iter_s": 13.39269471168518, "time_total_s": 640.6707847118378, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.6707847118378, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.16842105263158, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.22528707583746, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.7221966614325845, "policy_loss": -0.013251871839262701, "vf_loss": 4.740820124000311, "vf_explained_var": 0.979002290032804, "kl": 0.018061245185708733, "entropy": 1.3499168479815125, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -22.46375314658416, "episode_reward_min": -1316.1817224153835, "episode_reward_mean": -685.2425910661973, "episode_len_mean": 131.18, "episode_media": {}, "episodes_timesteps_total": 13118, "policy_reward_min": {"policy_0": -1316.1817224153835}, "policy_reward_max": {"policy_0": -22.46375314658416}, "policy_reward_mean": {"policy_0": -685.2425910661973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291], "episode_lengths": [137, 150, 92, 150, 150, 150, 68, 150, 77, 150, 150, 112, 150, 67, 150, 150, 80, 150, 150, 150, 150, 150, 144, 124, 150, 137, 150, 150, 85, 92, 107, 150, 150, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 47, 150, 87, 150, 150, 150, 115, 74, 150, 150, 104, 150, 93, 150, 150, 94, 111, 52, 150, 150, 75, 150, 89, 150, 150, 150, 98, 39, 150, 150, 150, 150, 150, 139, 150, 150, 134, 134, 150, 100, 150], "policy_policy_0_reward": [-553.9408513309392, -746.1584841970017, -129.75574046144308, -795.6011438132905, -1046.2902797247975, -1130.8599524297351, -90.07765637768388, -1105.0245192757066, -174.56947108428528, -743.1435829315141, -1216.7208721357536, -342.4282470219686, -500.4604199522481, -112.58330522193125, -1123.7040410487566, -908.4726071267709, -246.70957938472202, -792.2533452089705, -1057.273856354295, -913.9429255876784, -1033.0798860401076, -708.2709634112229, -341.98434163175517, -416.21121245014126, -740.4302991823419, -593.752271021479, -1175.3835353431232, -680.9193818438018, -177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527798878879737, "mean_inference_ms": 1.7192083341934108, "mean_action_processing_ms": 0.27660523214562505, "mean_env_wait_ms": 3.0472805952949127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011712789535522461, "StateBufferConnector_ms": 0.007768154144287109, "ViewRequirementAgentConnector_ms": 0.19353818893432617}, "num_episodes": 32, "episode_return_max": -22.46375314658416, "episode_return_min": -1316.1817224153835, "episode_return_mean": -685.2425910661973, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1720987843377, "num_env_steps_trained_throughput_per_sec": 307.1720987843377, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 13026.859, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13026.787, "sample_time_ms": 1070.681, "learn_time_ms": 11887.674, "learn_throughput": 336.483, "synch_weights_time_ms": 67.651}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "3541f_00001", "date": "2024-08-03_03-17-29", "timestamp": 1722635249, "time_this_iter_s": 13.034776449203491, "time_total_s": 653.7055611610413, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d6c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 653.7055611610413, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.305555555555557, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.2587042888006, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.475911800811688, "policy_loss": -0.0047779780764055126, "vf_loss": 4.487034361809492, "vf_explained_var": 0.9840005776534478, "kl": 0.02254314844928261, "entropy": 1.6488988614330689, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -22.46375314658416, "episode_reward_min": -1360.8874532242182, "episode_reward_mean": -684.4527582102274, "episode_len_mean": 131.24, "episode_media": {}, "episodes_timesteps_total": 13124, "policy_reward_min": {"policy_0": -1360.8874532242182}, "policy_reward_max": {"policy_0": -22.46375314658416}, "policy_reward_mean": {"policy_0": -684.4527582102274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531], "episode_lengths": [85, 92, 107, 150, 150, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 47, 150, 87, 150, 150, 150, 115, 74, 150, 150, 104, 150, 93, 150, 150, 94, 111, 52, 150, 150, 75, 150, 89, 150, 150, 150, 98, 39, 150, 150, 150, 150, 150, 139, 150, 150, 134, 134, 150, 100, 150, 150, 81, 150, 150, 60, 150, 150, 75, 150, 150, 150, 150, 150, 112, 150, 97, 150, 150, 46, 150, 150, 147, 150, 140, 150, 136, 150, 150], "policy_policy_0_reward": [-177.2680066780695, -317.0007219919011, -366.77003768799773, -756.5234994667782, -829.3441400449027, -284.52914530217924, -890.581094634957, -112.30710812470717, -967.823802347614, -827.9590833140916, -405.2942206673313, -799.0518173705143, -1163.2765634944205, -1030.0389473101914, -920.6199006729163, -868.9730538050464, -1061.3505509696167, -940.7973995512481, -866.6839406668912, -407.8635740838525, -956.248232103472, -868.6751308880952, -966.6900464227049, -742.9261816133488, -826.1483998085812, -1034.3215338026735, -118.56103725683445, -788.6478138296335, -882.6398866504001, -881.2846901211154, -641.3084472692457, -44.961625276445965, -1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526652719350543, "mean_inference_ms": 1.718473281360875, "mean_action_processing_ms": 0.276339512392892, "mean_env_wait_ms": 3.04830016744024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011512041091918945, "StateBufferConnector_ms": 0.007767200469970703, "ViewRequirementAgentConnector_ms": 0.1929166316986084}, "num_episodes": 28, "episode_return_max": -22.46375314658416, "episode_return_min": -1360.8874532242182, "episode_return_mean": -684.4527582102274, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.737636417778, "num_env_steps_trained_throughput_per_sec": 316.737636417778, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12950.175, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12950.101, "sample_time_ms": 1055.653, "learn_time_ms": 11827.392, "learn_throughput": 338.198, "synch_weights_time_ms": 66.275}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "3541f_00001", "date": "2024-08-03_03-17-42", "timestamp": 1722635262, "time_this_iter_s": 12.641194581985474, "time_total_s": 666.3467557430267, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415cd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 666.3467557430267, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.311111111111114, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.63705150485038, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.048939375331004, "policy_loss": -0.005929333307237054, "vf_loss": 5.058047457536062, "vf_explained_var": 0.9744575255240003, "kl": 0.014095715659641508, "entropy": 1.2693361779364447, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -22.46375314658416, "episode_reward_min": -1360.8874532242182, "episode_reward_mean": -665.3331038790385, "episode_len_mean": 130.52, "episode_media": {}, "episodes_timesteps_total": 13052, "policy_reward_min": {"policy_0": -1360.8874532242182}, "policy_reward_max": {"policy_0": -22.46375314658416}, "policy_reward_mean": {"policy_0": -665.3331038790385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148], "episode_lengths": [150, 87, 150, 150, 150, 115, 74, 150, 150, 104, 150, 93, 150, 150, 94, 111, 52, 150, 150, 75, 150, 89, 150, 150, 150, 98, 39, 150, 150, 150, 150, 150, 139, 150, 150, 134, 134, 150, 100, 150, 150, 81, 150, 150, 60, 150, 150, 75, 150, 150, 150, 150, 150, 112, 150, 97, 150, 150, 46, 150, 150, 147, 150, 140, 150, 136, 150, 150, 150, 150, 123, 150, 136, 150, 150, 54, 123, 150, 150, 150, 64, 150, 56, 150, 150, 150, 101, 150, 137, 117, 150, 150, 150, 150, 150, 150, 92, 150, 100, 67], "policy_policy_0_reward": [-1233.9969489769148, -157.0682961338939, -484.42725111321107, -981.580980665558, -651.5947350689268, -412.7450624410173, -99.184272605607, -1138.878254326677, -915.4152397121353, -437.90277526425126, -569.8183144384593, -144.02863069975672, -791.2873893790943, -765.8434391058418, -295.6444329977267, -342.43206403816544, -54.02307856265173, -1015.1658738553624, -599.3083482962473, -74.1360321865461, -1264.1734879013115, -296.53022819689954, -1055.868857861806, -876.7860716160329, -1209.523961205419, -148.24063899502897, -22.46375314658416, -593.9423907399588, -1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529170563804885, "mean_inference_ms": 1.7189038436399209, "mean_action_processing_ms": 0.2765379770308077, "mean_env_wait_ms": 3.0504642607293135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809587478637695, "StateBufferConnector_ms": 0.007827043533325195, "ViewRequirementAgentConnector_ms": 0.19184255599975586}, "num_episodes": 32, "episode_return_max": -22.46375314658416, "episode_return_min": -1360.8874532242182, "episode_return_mean": -665.3331038790385, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.764018693563, "num_env_steps_trained_throughput_per_sec": 345.764018693563, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12801.619, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12801.545, "sample_time_ms": 1053.392, "learn_time_ms": 11684.08, "learn_throughput": 342.346, "synch_weights_time_ms": 63.309}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "3541f_00001", "date": "2024-08-03_03-17-54", "timestamp": 1722635274, "time_this_iter_s": 11.580731391906738, "time_total_s": 677.9274871349335, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415f9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 677.9274871349335, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 234.8440281510353, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.0460314631462095, "policy_loss": -0.0054988607778796, "vf_loss": 5.05424293205142, "vf_explained_var": 0.9651033520698548, "kl": 0.016083106124218222, "entropy": 1.3568706026300787, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -35.50805684894331, "episode_reward_min": -1360.8874532242182, "episode_reward_mean": -687.2614754415431, "episode_len_mean": 134.12, "episode_media": {}, "episodes_timesteps_total": 13412, "policy_reward_min": {"policy_0": -1360.8874532242182}, "policy_reward_max": {"policy_0": -35.50805684894331}, "policy_reward_mean": {"policy_0": -687.2614754415431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686], "episode_lengths": [150, 150, 150, 150, 139, 150, 150, 134, 134, 150, 100, 150, 150, 81, 150, 150, 60, 150, 150, 75, 150, 150, 150, 150, 150, 112, 150, 97, 150, 150, 46, 150, 150, 147, 150, 140, 150, 136, 150, 150, 150, 150, 123, 150, 136, 150, 150, 54, 123, 150, 150, 150, 64, 150, 56, 150, 150, 150, 101, 150, 137, 117, 150, 150, 150, 150, 150, 150, 92, 150, 100, 67, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 85, 110, 102, 150, 83, 103, 150, 139], "policy_policy_0_reward": [-1316.1817224153835, -980.6287911860464, -982.1971942067578, -869.3183311494856, -480.4190743767437, -1072.3738967184897, -728.9972831779469, -489.7264518876463, -598.3252695452669, -701.6863188309673, -357.99932380793655, -1147.9222349647291, -1360.8874532242182, -231.07800571248538, -1070.6333945937656, -554.1804747854319, -35.50805684894331, -668.1859485136438, -960.9528430240107, -263.87307977272957, -1170.2635317033041, -1131.467216320301, -595.2388592097408, -535.5136255900682, -1040.352371576826, -385.24289793392484, -879.6800755379917, -292.37013082681466, -937.1986657275686, -872.1537667537797, -75.0322719644239, -776.8988468062752, -781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523614260461049, "mean_inference_ms": 1.7166968670566254, "mean_action_processing_ms": 0.2763760909931931, "mean_env_wait_ms": 3.0487599092107835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012035131454467773, "StateBufferConnector_ms": 0.007871389389038086, "ViewRequirementAgentConnector_ms": 0.19087958335876465}, "num_episodes": 28, "episode_return_max": -35.50805684894331, "episode_return_min": -1360.8874532242182, "episode_return_mean": -687.2614754415431, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3115303062926, "num_env_steps_trained_throughput_per_sec": 310.3115303062926, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12765.773, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12765.694, "sample_time_ms": 1051.207, "learn_time_ms": 11651.5, "learn_throughput": 343.303, "synch_weights_time_ms": 62.215}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "3541f_00001", "date": "2024-08-03_03-18-07", "timestamp": 1722635287, "time_this_iter_s": 12.90449833869934, "time_total_s": 690.8319854736328, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415fa30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 690.8319854736328, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.366666666666664, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 287.33775552511213, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.514142442991337, "policy_loss": -0.005848147588161131, "vf_loss": 4.529242222756148, "vf_explained_var": 0.9853029156724612, "kl": 0.015384401290490738, "entropy": 1.9636111656824748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -35.63983813636462, "episode_reward_min": -1393.158661804875, "episode_reward_mean": -691.6409327011457, "episode_len_mean": 134.85, "episode_media": {}, "episodes_timesteps_total": 13485, "policy_reward_min": {"policy_0": -1393.158661804875}, "policy_reward_max": {"policy_0": -35.63983813636462}, "policy_reward_mean": {"policy_0": -691.6409327011457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661], "episode_lengths": [150, 147, 150, 140, 150, 136, 150, 150, 150, 150, 123, 150, 136, 150, 150, 54, 123, 150, 150, 150, 64, 150, 56, 150, 150, 150, 101, 150, 137, 117, 150, 150, 150, 150, 150, 150, 92, 150, 100, 67, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 85, 110, 102, 150, 83, 103, 150, 139, 150, 86, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 56, 150, 77, 150, 150, 150, 150, 150, 127, 117, 150, 150], "policy_policy_0_reward": [-781.6926803547819, -731.8427687384914, -910.4328010337595, -575.6140929572871, -954.6554417035233, -511.43798271661234, -357.92121959083534, -680.7109824749531, -911.1551809217839, -1211.4244396117172, -564.4095543008228, -887.4873745445535, -407.40678626534213, -908.3838227227747, -351.7290244474921, -35.63983813636462, -435.8132074255288, -1217.5089448022509, -657.1099524304728, -913.0122783077857, -178.97803517721505, -921.5582263443308, -38.454975305407615, -829.5963761718893, -1228.3480560751252, -732.0059730222786, -192.91765360990024, -1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552611703817924, "mean_inference_ms": 1.7158460612857482, "mean_action_processing_ms": 0.27636134129506773, "mean_env_wait_ms": 3.049821545280741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012287378311157227, "StateBufferConnector_ms": 0.007859945297241211, "ViewRequirementAgentConnector_ms": 0.19090843200683594}, "num_episodes": 32, "episode_return_max": -35.63983813636462, "episode_return_min": -1393.158661804875, "episode_return_mean": -691.6409327011457, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.6018053293159, "num_env_steps_trained_throughput_per_sec": 534.6018053293159, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12253.463, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12253.384, "sample_time_ms": 1050.985, "learn_time_ms": 11140.789, "learn_throughput": 359.041, "synch_weights_time_ms": 60.845}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "3541f_00001", "date": "2024-08-03_03-18-14", "timestamp": 1722635294, "time_this_iter_s": 7.496110439300537, "time_total_s": 698.3280959129333, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 698.3280959129333, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 21.89090909090909, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 310.90135610898335, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.769094916929801, "policy_loss": -0.006081096753284025, "vf_loss": 4.781689703961214, "vf_explained_var": 0.9666997961079081, "kl": 0.014903234815706885, "entropy": 1.6573381325850884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -39.16472643519485, "episode_reward_min": -1393.158661804875, "episode_reward_mean": -696.7625738419176, "episode_len_mean": 136.35, "episode_media": {}, "episodes_timesteps_total": 13635, "policy_reward_min": {"policy_0": -1393.158661804875}, "policy_reward_max": {"policy_0": -39.16472643519485}, "policy_reward_mean": {"policy_0": -696.7625738419176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625], "episode_lengths": [150, 137, 117, 150, 150, 150, 150, 150, 150, 92, 150, 100, 67, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 85, 110, 102, 150, 83, 103, 150, 139, 150, 86, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 56, 150, 77, 150, 150, 150, 150, 150, 127, 117, 150, 150, 58, 100, 150, 150, 150, 150, 95, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 114, 150], "policy_policy_0_reward": [-1054.060218622177, -512.3578485192813, -284.47367069323525, -1085.946663825256, -988.7895170190733, -1118.8719914616204, -387.33536760396566, -667.1191823975727, -804.0804235204748, -152.5489022595024, -798.243271047854, -260.9510328921967, -96.78641062363148, -1002.2317375036436, -994.3540060806222, -623.6190334226714, -827.8797619674216, -54.22720657522102, -1139.697133090264, -1160.7452181326553, -641.1138511130125, -609.61755723121, -816.820697790964, -916.2159128325933, -983.1417311321999, -669.5834713069668, -355.2690225425777, -507.26674491343516, -588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523625555232655, "mean_inference_ms": 1.71402573037648, "mean_action_processing_ms": 0.2761706753846118, "mean_env_wait_ms": 3.048900160600641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011874198913574219, "StateBufferConnector_ms": 0.0077972412109375, "ViewRequirementAgentConnector_ms": 0.18876314163208008}, "num_episodes": 27, "episode_return_max": -39.16472643519485, "episode_return_min": -1393.158661804875, "episode_return_mean": -696.7625738419176, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.72947238779125, "num_env_steps_trained_throughput_per_sec": 304.72947238779125, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 12292.193, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12292.116, "sample_time_ms": 1066.441, "learn_time_ms": 11163.581, "learn_throughput": 358.308, "synch_weights_time_ms": 61.329}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "3541f_00001", "date": "2024-08-03_03-18-27", "timestamp": 1722635307, "time_this_iter_s": 13.138991832733154, "time_total_s": 711.4670877456665, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 711.4670877456665, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.157894736842106, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 298.2648847222328, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.771073187639316, "policy_loss": -0.005924931335418175, "vf_loss": 4.785480789343516, "vf_explained_var": 0.9668502919375896, "kl": 0.0136946375626394, "entropy": 1.7726556049038966, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -32.97495747606367, "episode_reward_min": -1393.158661804875, "episode_reward_mean": -716.8117015574593, "episode_len_mean": 135.58, "episode_media": {}, "episodes_timesteps_total": 13558, "policy_reward_min": {"policy_0": -1393.158661804875}, "policy_reward_max": {"policy_0": -32.97495747606367}, "policy_reward_mean": {"policy_0": -716.8117015574593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145], "episode_lengths": [150, 150, 150, 150, 150, 85, 110, 102, 150, 83, 103, 150, 139, 150, 86, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 56, 150, 77, 150, 150, 150, 150, 150, 127, 117, 150, 150, 58, 100, 150, 150, 150, 150, 95, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 114, 150, 138, 150, 64, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 59, 150, 150, 150, 150, 120, 150, 66, 150, 114, 138, 75, 150, 150, 150], "policy_policy_0_reward": [-588.1354889469261, -725.035433418143, -981.321717268445, -809.964508065327, -762.121267610563, -131.2649835384014, -403.6146642046342, -387.44527369723494, -820.9889729044245, -110.29135509617502, -261.2030175332653, -742.819613566476, -798.8585842960686, -765.2666735532038, -241.52338083450366, -906.1991490763, -130.3902461742404, -1100.3451662566022, -1147.8923016115712, -561.2206688786663, -750.1264678322278, -775.9326807393427, -770.7582519957313, -1272.979221507077, -403.73057954432204, -1084.246188098838, -1184.9584909769655, -553.0798212446397, -1323.2718458012976, -772.2286367237009, -1157.8205723303233, -175.3378673717241, -815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522427579772412, "mean_inference_ms": 1.7129504519285, "mean_action_processing_ms": 0.27622095179865347, "mean_env_wait_ms": 3.0500522749515877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011756658554077148, "StateBufferConnector_ms": 0.007662057876586914, "ViewRequirementAgentConnector_ms": 0.18806028366088867}, "num_episodes": 28, "episode_return_max": -32.97495747606367, "episode_return_min": -1393.158661804875, "episode_return_mean": -716.8117015574593, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.3438527125232, "num_env_steps_trained_throughput_per_sec": 414.3438527125232, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 11952.584, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11952.508, "sample_time_ms": 1061.676, "learn_time_ms": 10829.622, "learn_throughput": 369.357, "synch_weights_time_ms": 60.455}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "3541f_00001", "date": "2024-08-03_03-18-37", "timestamp": 1722635317, "time_this_iter_s": 9.663798332214355, "time_total_s": 721.1308860778809, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 721.1308860778809, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.807142857142853, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.04361595710117, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.5198926088710625, "policy_loss": -0.010583463526078656, "vf_loss": 4.541055649767319, "vf_explained_var": 0.9771393962825338, "kl": 0.01084957334084422, "entropy": 1.7903038716564577, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": 6.777877159127551, "episode_reward_min": -1393.158661804875, "episode_reward_mean": -710.6323552660277, "episode_len_mean": 134.39, "episode_media": {}, "episodes_timesteps_total": 13439, "policy_reward_min": {"policy_0": -1393.158661804875}, "policy_reward_max": {"policy_0": 6.777877159127551}, "policy_reward_mean": {"policy_0": -710.6323552660277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346], "episode_lengths": [150, 56, 150, 77, 150, 150, 150, 150, 150, 127, 117, 150, 150, 58, 100, 150, 150, 150, 150, 95, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 114, 150, 138, 150, 64, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 59, 150, 150, 150, 150, 120, 150, 66, 150, 114, 138, 75, 150, 150, 150, 99, 150, 68, 150, 150, 150, 39, 150, 150, 150, 114, 150, 101, 150, 150, 150, 150, 48, 150, 150, 51, 150, 150, 98, 109, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-815.6007074546786, -105.11820978487265, -948.4225300503529, -211.19162575963563, -595.0855563868095, -868.217755145813, -1393.158661804875, -890.0937183810768, -766.0492683477339, -369.052297579845, -336.56546398516366, -749.9316584362111, -874.6374709855661, -39.16472643519485, -380.2217853804704, -755.2549984428757, -836.1266894145588, -396.34535332532295, -804.5667704471562, -182.96946672695722, -448.6264939429554, -816.2191192761212, -472.75012264486, -583.4151830003252, -760.1930353883969, -793.0275934194116, -859.2963000954579, -1162.8099728556115, -1031.5553800057617, -1027.0373723114092, -1061.9930719222564, -929.2751362173798, -1080.036826408146, -317.8654344616409, -819.9706956541205, -625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522593991392409, "mean_inference_ms": 1.7128948782391646, "mean_action_processing_ms": 0.27650058873997363, "mean_env_wait_ms": 3.0507775610555927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011427640914916992, "StateBufferConnector_ms": 0.007870674133300781, "ViewRequirementAgentConnector_ms": 0.18953156471252441}, "num_episodes": 32, "episode_return_max": 6.777877159127551, "episode_return_min": -1393.158661804875, "episode_return_mean": -710.6323552660277, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4349185797292, "num_env_steps_trained_throughput_per_sec": 300.4349185797292, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 11977.54, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11977.464, "sample_time_ms": 1063.701, "learn_time_ms": 10851.815, "learn_throughput": 368.602, "synch_weights_time_ms": 61.191}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "3541f_00001", "date": "2024-08-03_03-18-50", "timestamp": 1722635330, "time_this_iter_s": 13.326144218444824, "time_total_s": 734.4570302963257, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 734.4570302963257, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.921052631578945, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 294.1094049970309, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.051538318395615, "policy_loss": -0.0008230546329286881, "vf_loss": 5.059875651945671, "vf_explained_var": 0.9290581084166963, "kl": 0.0134132151317924, "entropy": 1.656820072233677, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 6.777877159127551, "episode_reward_min": -1401.3111561583544, "episode_reward_mean": -721.7484537559162, "episode_len_mean": 132.58, "episode_media": {}, "episodes_timesteps_total": 13258, "policy_reward_min": {"policy_0": -1401.3111561583544}, "policy_reward_max": {"policy_0": 6.777877159127551}, "policy_reward_mean": {"policy_0": -721.7484537559162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211], "episode_lengths": [150, 131, 150, 114, 150, 138, 150, 64, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 59, 150, 150, 150, 150, 120, 150, 66, 150, 114, 138, 75, 150, 150, 150, 99, 150, 68, 150, 150, 150, 39, 150, 150, 150, 114, 150, 101, 150, 150, 150, 150, 48, 150, 150, 51, 150, 150, 98, 109, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 120, 139, 150, 150, 150, 150, 150, 75, 148, 150, 150, 150, 37, 64, 150, 77, 150, 150, 150, 148, 150, 150, 150, 150, 55, 139, 150, 77, 110, 150], "policy_policy_0_reward": [-625.3516211094301, -334.552760581384, -983.0798635607143, -334.3627069969131, -803.343303245625, -562.877014735894, -1020.3430268588714, -43.64543486679041, -1181.443665527515, -768.6189391411197, -1182.3399141933583, -1099.1020577070772, -928.711706748995, -828.1029092399015, -922.3116366214184, -371.06854896815037, -698.8274484266805, -859.4866763992457, -32.97495747606367, -1018.252256329259, -910.9193609652459, -1265.125312219804, -1235.1429297370948, -513.4566205042547, -896.16294554797, -214.2123610963273, -681.4574859712719, -382.7218499842249, -719.8654520693021, -203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524313013735269, "mean_inference_ms": 1.7125240794686512, "mean_action_processing_ms": 0.2764891820211263, "mean_env_wait_ms": 3.050285643118154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011716842651367188, "StateBufferConnector_ms": 0.007974624633789062, "ViewRequirementAgentConnector_ms": 0.19269394874572754}, "num_episodes": 35, "episode_return_max": 6.777877159127551, "episode_return_min": -1401.3111561583544, "episode_return_mean": -721.7484537559162, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1665876945531, "num_env_steps_trained_throughput_per_sec": 301.1665876945531, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 12034.716, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12034.64, "sample_time_ms": 1066.459, "learn_time_ms": 10907.196, "learn_throughput": 366.73, "synch_weights_time_ms": 60.234}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "3541f_00001", "date": "2024-08-03_03-19-04", "timestamp": 1722635344, "time_this_iter_s": 13.295648336410522, "time_total_s": 747.7526786327362, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 747.7526786327362, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.900000000000002, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 274.7068550487359, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.592748903731505, "policy_loss": -0.006901782115649743, "vf_loss": 4.605319840957721, "vf_explained_var": 0.9810323248927791, "kl": 0.014136276813224009, "entropy": 1.5211143525938193, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": 6.777877159127551, "episode_reward_min": -1401.3111561583544, "episode_reward_mean": -683.3070201353025, "episode_len_mean": 129.3, "episode_media": {}, "episodes_timesteps_total": 12930, "policy_reward_min": {"policy_0": -1401.3111561583544}, "policy_reward_max": {"policy_0": 6.777877159127551}, "policy_reward_mean": {"policy_0": -683.3070201353025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795], "episode_lengths": [75, 150, 150, 150, 99, 150, 68, 150, 150, 150, 39, 150, 150, 150, 114, 150, 101, 150, 150, 150, 150, 48, 150, 150, 51, 150, 150, 98, 109, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 120, 139, 150, 150, 150, 150, 150, 75, 148, 150, 150, 150, 37, 64, 150, 77, 150, 150, 150, 148, 150, 150, 150, 150, 55, 139, 150, 77, 110, 150, 38, 150, 150, 150, 114, 150, 81, 150, 150, 46, 111, 150, 150, 51, 61, 150, 150, 150, 150, 150, 150, 150, 90, 150, 61, 150, 150, 150, 94], "policy_policy_0_reward": [-203.34593225504494, -1333.7370822926048, -972.8180979505297, -671.18873384145, -236.22258892921442, -847.1337787966653, -203.53575612614296, -1147.054813884866, -1077.5823000777766, -714.9483317563429, 6.777877159127551, -909.7735001728819, -1121.8215315487146, -1007.3618499244327, -435.5303793170704, -1188.8090485245568, -410.8394123304629, -713.9352525024215, -699.9935771816903, -1047.064359165722, -838.4281799120072, -30.381331015680924, -1121.4409545604508, -333.9618375753672, -17.57163516952662, -808.2835148715211, -344.79278426253927, -151.5604717120778, -362.6667000850063, -1059.545494092927, -1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526597148106207, "mean_inference_ms": 1.7124076577444318, "mean_action_processing_ms": 0.27644586599712984, "mean_env_wait_ms": 3.052408775126702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011630535125732422, "StateBufferConnector_ms": 0.007973194122314453, "ViewRequirementAgentConnector_ms": 0.19197607040405273}, "num_episodes": 29, "episode_return_max": 6.777877159127551, "episode_return_min": -1401.3111561583544, "episode_return_mean": -683.3070201353025, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4218188918286, "num_env_steps_trained_throughput_per_sec": 300.4218188918286, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12028.25, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12028.175, "sample_time_ms": 1066.687, "learn_time_ms": 10900.718, "learn_throughput": 366.948, "synch_weights_time_ms": 60.034}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "3541f_00001", "date": "2024-08-03_03-19-17", "timestamp": 1722635357, "time_this_iter_s": 13.32639193534851, "time_total_s": 761.0790705680847, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07ba680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 761.0790705680847, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.152631578947368, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 243.9377116560936, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.52810104812185, "policy_loss": -0.004617010124396377, "vf_loss": 5.536719972391923, "vf_explained_var": 0.9488449371109406, "kl": 0.014140871289024949, "entropy": 1.3546996670464675, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 2.843408151128121, "episode_reward_min": -1466.0771315921238, "episode_reward_mean": -693.2434493151163, "episode_len_mean": 132.34, "episode_media": {}, "episodes_timesteps_total": 13234, "policy_reward_min": {"policy_0": -1466.0771315921238}, "policy_reward_max": {"policy_0": 2.843408151128121}, "policy_reward_mean": {"policy_0": -693.2434493151163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 120, 139, 150, 150, 150, 150, 150, 75, 148, 150, 150, 150, 37, 64, 150, 77, 150, 150, 150, 148, 150, 150, 150, 150, 55, 139, 150, 77, 110, 150, 38, 150, 150, 150, 114, 150, 81, 150, 150, 46, 111, 150, 150, 51, 61, 150, 150, 150, 150, 150, 150, 150, 90, 150, 61, 150, 150, 150, 94, 54, 150, 150, 150, 150, 112, 150, 138, 74, 101, 116, 150, 150, 150, 87, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150], "policy_policy_0_reward": [-1032.0652822969357, -812.9987085764163, -805.172912283068, -932.090880182313, -819.1081018791041, -757.5410699994346, -884.9430206096263, -705.561670941907, -821.5194774655861, -951.6544173626645, -751.6838363073891, -494.2951402965215, -717.9314284410507, -841.8816034252978, -1132.1133863812995, -819.149499543518, -853.6678092908264, -996.7866149621774, -255.64442536873304, -901.0943814332406, -847.4169678757364, -953.7166415285441, -1401.3111561583544, 2.843408151128121, -64.89883755097678, -1056.3661386161066, -150.32502795905623, -754.896986198336, -1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527812193245901, "mean_inference_ms": 1.7115937707578075, "mean_action_processing_ms": 0.2763897882193508, "mean_env_wait_ms": 3.0512314718115543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011524438858032227, "StateBufferConnector_ms": 0.007888317108154297, "ViewRequirementAgentConnector_ms": 0.19060587882995605}, "num_episodes": 30, "episode_return_max": 2.843408151128121, "episode_return_min": -1466.0771315921238, "episode_return_mean": -693.2434493151163, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.21849903624496, "num_env_steps_trained_throughput_per_sec": 303.21849903624496, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12045.229, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12045.154, "sample_time_ms": 1066.562, "learn_time_ms": 10916.793, "learn_throughput": 366.408, "synch_weights_time_ms": 61.049}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "3541f_00001", "date": "2024-08-03_03-19-30", "timestamp": 1722635370, "time_this_iter_s": 13.204371213912964, "time_total_s": 774.2834417819977, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 774.2834417819977, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.216666666666665, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 274.29678026835126, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.079592293004195, "policy_loss": -0.0007160274074218857, "vf_loss": 5.084957314034303, "vf_explained_var": 0.9499456666409969, "kl": 0.014320323593680465, "entropy": 1.431521911546588, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -8.435149561514041, "episode_reward_min": -1466.0771315921238, "episode_reward_mean": -686.836319133589, "episode_len_mean": 133.97, "episode_media": {}, "episodes_timesteps_total": 13397, "policy_reward_min": {"policy_0": -1466.0771315921238}, "policy_reward_max": {"policy_0": -8.435149561514041}, "policy_reward_mean": {"policy_0": -686.836319133589}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664], "episode_lengths": [150, 150, 148, 150, 150, 150, 150, 55, 139, 150, 77, 110, 150, 38, 150, 150, 150, 114, 150, 81, 150, 150, 46, 111, 150, 150, 51, 61, 150, 150, 150, 150, 150, 150, 150, 90, 150, 61, 150, 150, 150, 94, 54, 150, 150, 150, 150, 112, 150, 138, 74, 101, 116, 150, 150, 150, 87, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 88, 121, 150, 150, 112, 136, 150, 150, 150, 72, 150, 150, 150, 138, 150, 150, 150, 150], "policy_policy_0_reward": [-1094.4758610696867, -1060.179300510155, -668.4114793904439, -657.7782134035425, -764.7902526919102, -813.0723207922874, -937.2326239572026, -75.85645795086282, -628.837930436835, -1050.3445636081062, -56.938171442091694, -378.7935678047292, -1052.730498244211, -8.435149561514041, -719.3242722201586, -856.1596680276845, -847.1319608859427, -474.6496289334961, -692.4364369821952, -125.71246508390642, -1003.322538774509, -853.417946211281, -33.27845139310454, -275.2225088299068, -907.4060268282573, -783.398208079675, -22.55475740991661, -66.87886472249572, -1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527929844522972, "mean_inference_ms": 1.710592077767179, "mean_action_processing_ms": 0.27655317292146836, "mean_env_wait_ms": 3.0532306850549866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011518001556396484, "StateBufferConnector_ms": 0.007858991622924805, "ViewRequirementAgentConnector_ms": 0.19253158569335938}, "num_episodes": 28, "episode_return_max": -8.435149561514041, "episode_return_min": -1466.0771315921238, "episode_return_mean": -686.836319133589, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.8075455829713, "num_env_steps_trained_throughput_per_sec": 291.8075455829713, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12153.121, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12153.045, "sample_time_ms": 1066.175, "learn_time_ms": 11022.79, "learn_throughput": 362.885, "synch_weights_time_ms": 63.292}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "3541f_00001", "date": "2024-08-03_03-19-44", "timestamp": 1722635384, "time_this_iter_s": 13.719363927841187, "time_total_s": 788.0028057098389, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 788.0028057098389, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 16.84, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.17527725696564, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.137925934046507, "policy_loss": -0.011742272361395105, "vf_loss": 5.152935930838187, "vf_explained_var": 0.9791429614648223, "kl": 0.013627917375864248, "entropy": 1.2466574686268965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -23.505539156408418, "episode_reward_min": -1466.0771315921238, "episode_reward_mean": -692.6101248023369, "episode_len_mean": 135.9, "episode_media": {}, "episodes_timesteps_total": 13590, "policy_reward_min": {"policy_0": -1466.0771315921238}, "policy_reward_max": {"policy_0": -23.505539156408418}, "policy_reward_mean": {"policy_0": -692.6101248023369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 90, 150, 61, 150, 150, 150, 94, 54, 150, 150, 150, 150, 112, 150, 138, 74, 101, 116, 150, 150, 150, 87, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 88, 121, 150, 150, 112, 136, 150, 150, 150, 72, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 50, 150, 150, 149, 82, 60, 150, 150, 66, 150, 150, 62, 150, 150, 150, 104], "policy_policy_0_reward": [-1055.0441159949885, -1045.4494941372743, -1074.6138433146998, -852.4942913187117, -841.4370888290596, -523.7078649167796, -779.835620354791, -257.14975659145273, -939.7119600300954, -117.84825151545606, -701.2173122388443, -826.1536953243541, -701.970512923999, -187.75471333398795, -23.505539156408418, -788.5692758086146, -816.0937625931463, -700.8262675524127, -816.6089906620825, -309.7541365123656, -590.482942689943, -691.1287846742053, -119.00225673439611, -243.80626999670451, -467.9682788123823, -883.658045689487, -928.0099492847291, -720.6352854737029, -262.4034167388883, -955.2707627224828, -812.5184768881672, -470.49309842533563, -314.80935303463787, -721.3052443145302, -1087.0781563294183, -847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525821746838043, "mean_inference_ms": 1.7107504420490605, "mean_action_processing_ms": 0.2767758472005641, "mean_env_wait_ms": 3.053616911770661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011749505996704102, "StateBufferConnector_ms": 0.007881402969360352, "ViewRequirementAgentConnector_ms": 0.19313836097717285}, "num_episodes": 28, "episode_return_max": -23.505539156408418, "episode_return_min": -1466.0771315921238, "episode_return_mean": -692.6101248023369, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.9547121130324, "num_env_steps_trained_throughput_per_sec": 302.9547121130324, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12316.591, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12316.517, "sample_time_ms": 1068.057, "learn_time_ms": 11183.856, "learn_throughput": 357.658, "synch_weights_time_ms": 63.816}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "3541f_00001", "date": "2024-08-03_03-19-57", "timestamp": 1722635397, "time_this_iter_s": 13.215462684631348, "time_total_s": 801.2182683944702, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07ba680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.2182683944702, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.18333333333333, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.6532225628694, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.150876996666193, "policy_loss": -0.00627210543025285, "vf_loss": 5.157692718257507, "vf_explained_var": 0.9487583533550302, "kl": 0.015093499646415456, "entropy": 1.0731710460657875, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -29.052184326143642, "episode_reward_min": -1466.0771315921238, "episode_reward_mean": -663.9685389128732, "episode_len_mean": 133.12, "episode_media": {}, "episodes_timesteps_total": 13312, "policy_reward_min": {"policy_0": -1466.0771315921238}, "policy_reward_max": {"policy_0": -29.052184326143642}, "policy_reward_mean": {"policy_0": -663.9685389128732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571], "episode_lengths": [150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 88, 121, 150, 150, 112, 136, 150, 150, 150, 72, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 50, 150, 150, 149, 82, 60, 150, 150, 66, 150, 150, 62, 150, 150, 150, 104, 150, 150, 150, 93, 150, 109, 150, 150, 121, 89, 150, 138, 61, 150, 125, 150, 150, 150, 57, 150, 51, 131, 105, 150, 91, 150, 150, 150, 150, 150, 88, 150, 76, 150, 50], "policy_policy_0_reward": [-847.8111409257218, -883.4723058698236, -721.2513473691929, -1466.0771315921238, -998.8153752787, -473.4874806990197, -770.6001758711607, -1181.2280844788304, -931.5229344793134, -542.687305169956, -864.652819745492, -734.9879260102408, -875.5659630299114, -1010.6942894696939, -906.5483933863765, -421.0715314129252, -759.6094289080106, -1179.9261471855652, -899.2298077565185, -250.10172761403064, -558.0720265819357, -1172.610145780965, -855.1941331816844, -313.42503943447844, -429.9841256819926, -846.3502629527857, -1153.2547526360224, -832.693069606275, -70.09996857102502, -947.3650669213566, -581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523316965744334, "mean_inference_ms": 1.7088827091968841, "mean_action_processing_ms": 0.27671471587751223, "mean_env_wait_ms": 3.0527631699058237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01216578483581543, "StateBufferConnector_ms": 0.008042335510253906, "ViewRequirementAgentConnector_ms": 0.19678997993469238}, "num_episodes": 35, "episode_return_max": -29.052184326143642, "episode_return_min": -1466.0771315921238, "episode_return_mean": -663.9685389128732, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.2082008207798, "num_env_steps_trained_throughput_per_sec": 299.2082008207798, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 12364.425, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12364.355, "sample_time_ms": 1068.41, "learn_time_ms": 11231.38, "learn_throughput": 356.145, "synch_weights_time_ms": 63.784}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "3541f_00001", "date": "2024-08-03_03-20-11", "timestamp": 1722635411, "time_this_iter_s": 13.38078761100769, "time_total_s": 814.5990560054779, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 814.5990560054779, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.040000000000003, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 288.3601129134496, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.585136641810338, "policy_loss": -0.011836355245516945, "vf_loss": 4.601710938910643, "vf_explained_var": 0.9788368578379353, "kl": 0.013765466713751569, "entropy": 1.4029625083009403, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -5.087145482503407, "episode_reward_min": -1313.2336193017459, "episode_reward_mean": -613.2461659536601, "episode_len_mean": 129.24, "episode_media": {}, "episodes_timesteps_total": 12924, "policy_reward_min": {"policy_0": -1313.2336193017459}, "policy_reward_max": {"policy_0": -5.087145482503407}, "policy_reward_mean": {"policy_0": -613.2461659536601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809], "episode_lengths": [150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 50, 150, 150, 149, 82, 60, 150, 150, 66, 150, 150, 62, 150, 150, 150, 104, 150, 150, 150, 93, 150, 109, 150, 150, 121, 89, 150, 138, 61, 150, 125, 150, 150, 150, 57, 150, 51, 131, 105, 150, 91, 150, 150, 150, 150, 150, 88, 150, 76, 150, 50, 84, 150, 88, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 72, 150, 38, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 72, 150, 84, 92], "policy_policy_0_reward": [-581.9123720566383, -822.4578879921347, -712.2726687692409, -1117.4843152661463, -529.4578679093878, -678.8756533316242, -805.6943002679664, -614.0034853704295, -582.0608275359775, -1262.0799462560476, -1126.0474691732882, -1128.2985044580482, -478.2458397940604, -29.052184326143642, -703.6426217890643, -741.1637978215273, -476.68491864281356, -846.6216058483894, -701.3234472087685, -65.24359881085661, -1083.0921257959963, -652.3685441727833, -375.60639048538576, -142.25520001865928, -109.52410695287362, -589.5214321415522, -489.4078684207754, -69.87870705172028, -800.5432498963828, -780.713307342609, -154.45150997011385, -1052.8158477212676, -1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522335122035458, "mean_inference_ms": 1.7088630968552097, "mean_action_processing_ms": 0.2767165924571849, "mean_env_wait_ms": 3.0533654953693747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012253999710083008, "StateBufferConnector_ms": 0.008097171783447266, "ViewRequirementAgentConnector_ms": 0.1970071792602539}, "num_episodes": 30, "episode_return_max": -5.087145482503407, "episode_return_min": -1313.2336193017459, "episode_return_mean": -613.2461659536601, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.14780280223096, "num_env_steps_trained_throughput_per_sec": 305.14780280223096, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 12927.044, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12926.976, "sample_time_ms": 1067.958, "learn_time_ms": 11790.878, "learn_throughput": 339.245, "synch_weights_time_ms": 67.358}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "3541f_00001", "date": "2024-08-03_03-20-24", "timestamp": 1722635424, "time_this_iter_s": 13.120125770568848, "time_total_s": 827.7191817760468, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6d900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.7191817760468, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.177777777777777, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 251.03651595314344, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.795077141125997, "policy_loss": -0.010004267016969, "vf_loss": 4.809625016897916, "vf_explained_var": 0.9797306951756278, "kl": 0.015554947559318558, "entropy": 1.5043195872878035, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -5.087145482503407, "episode_reward_min": -1313.2336193017459, "episode_reward_mean": -604.3925108111013, "episode_len_mean": 126.99, "episode_media": {}, "episodes_timesteps_total": 12699, "policy_reward_min": {"policy_0": -1313.2336193017459}, "policy_reward_max": {"policy_0": -5.087145482503407}, "policy_reward_mean": {"policy_0": -604.3925108111013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529], "episode_lengths": [150, 150, 104, 150, 150, 150, 93, 150, 109, 150, 150, 121, 89, 150, 138, 61, 150, 125, 150, 150, 150, 57, 150, 51, 131, 105, 150, 91, 150, 150, 150, 150, 150, 88, 150, 76, 150, 50, 84, 150, 88, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 72, 150, 38, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 72, 150, 84, 92, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 137, 150, 74, 79, 150, 150, 150, 94, 65, 132, 66, 107, 150, 61, 150, 150, 150, 150, 69, 150, 63], "policy_policy_0_reward": [-1229.0548638124485, -754.4226270272151, -448.0266642756968, -743.1164966557723, -1313.2336193017459, -928.1412359543302, -258.1164548577921, -726.6664683803822, -381.6034744196405, -423.15469598954127, -896.2158683790037, -464.0071602763858, -299.0933493864854, -786.585470595246, -516.5754989183436, -173.19639875294686, -858.3597764248698, -629.0269595066507, -468.9054582478815, -1169.1388757521288, -409.6758845331145, -79.86876210385407, -807.3031249075714, -86.60974810499494, -648.7868652432539, -348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522575139820681, "mean_inference_ms": 1.7080059567724595, "mean_action_processing_ms": 0.27670158956587376, "mean_env_wait_ms": 3.0526773626292028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01192927360534668, "StateBufferConnector_ms": 0.008066415786743164, "ViewRequirementAgentConnector_ms": 0.19811749458312988}, "num_episodes": 32, "episode_return_max": -5.087145482503407, "episode_return_min": -1313.2336193017459, "episode_return_mean": -604.3925108111013, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.89810030590706, "num_env_steps_trained_throughput_per_sec": 300.89810030590706, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 12943.758, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12943.69, "sample_time_ms": 1055.309, "learn_time_ms": 11820.7, "learn_throughput": 338.389, "synch_weights_time_ms": 66.897}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "3541f_00001", "date": "2024-08-03_03-20-37", "timestamp": 1722635437, "time_this_iter_s": 13.307409048080444, "time_total_s": 841.0265908241272, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07ba680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.0265908241272, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.026315789473685, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 262.21832918723425, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.383607394248247, "policy_loss": -0.01383441552752629, "vf_loss": 4.404583959157268, "vf_explained_var": 0.9809877385074893, "kl": 0.014149595531944278, "entropy": 1.6693123189111552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -5.087145482503407, "episode_reward_min": -1495.4317731082708, "episode_reward_mean": -649.7592989146569, "episode_len_mean": 131.28, "episode_media": {}, "episodes_timesteps_total": 13128, "policy_reward_min": {"policy_0": -1495.4317731082708}, "policy_reward_max": {"policy_0": -5.087145482503407}, "policy_reward_mean": {"policy_0": -649.7592989146569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733], "episode_lengths": [105, 150, 91, 150, 150, 150, 150, 150, 88, 150, 76, 150, 50, 84, 150, 88, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 72, 150, 38, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 72, 150, 84, 92, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 137, 150, 74, 79, 150, 150, 150, 94, 65, 132, 66, 107, 150, 61, 150, 150, 150, 150, 69, 150, 63, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 140, 130, 150, 150, 116], "policy_policy_0_reward": [-348.0492572955941, -811.4352703492741, -145.80942573734342, -778.930713873797, -871.6914710363199, -506.47067816162644, -730.9901009186426, -532.7340773307674, -190.127592860859, -818.6043708170868, -235.50975016295524, -644.3845313594207, -82.03933937654571, -253.96091041144484, -913.7991703505496, -224.09732617366885, -903.3506012685513, -964.8247999992326, -660.8759598101757, -153.24103973522105, -674.9717771359731, -675.089297066788, -622.8168280310897, -995.3057351601539, -774.7702865193856, -863.6920578334683, -117.97806283421575, -822.5055103065874, -5.087145482503407, -623.894482561671, -1049.0353947265332, -865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519751907575049, "mean_inference_ms": 1.7065846877624387, "mean_action_processing_ms": 0.27657635105181355, "mean_env_wait_ms": 3.0507814381067027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011629104614257812, "StateBufferConnector_ms": 0.007973432540893555, "ViewRequirementAgentConnector_ms": 0.1951291561126709}, "num_episodes": 25, "episode_return_max": -5.087145482503407, "episode_return_min": -1495.4317731082708, "episode_return_mean": -649.7592989146569, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.5937495773076, "num_env_steps_trained_throughput_per_sec": 298.5937495773076, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 13317.991, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13317.919, "sample_time_ms": 1063.187, "learn_time_ms": 12187.545, "learn_throughput": 328.204, "synch_weights_time_ms": 66.401}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "3541f_00001", "date": "2024-08-03_03-20-51", "timestamp": 1722635451, "time_this_iter_s": 13.40906286239624, "time_total_s": 854.4356536865234, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 854.4356536865234, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.099999999999998, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 323.5300877094269, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.4006661163022125, "policy_loss": -0.013770334006888636, "vf_loss": 4.421246547748646, "vf_explained_var": 0.987933853889505, "kl": 0.013945461538423912, "entropy": 1.6223281409591437, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -23.311912963800424, "episode_reward_min": -1495.4317731082708, "episode_reward_mean": -660.6802975583254, "episode_len_mean": 131.6, "episode_media": {}, "episodes_timesteps_total": 13160, "policy_reward_min": {"policy_0": -1495.4317731082708}, "policy_reward_max": {"policy_0": -23.311912963800424}, "policy_reward_mean": {"policy_0": -660.6802975583254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084], "episode_lengths": [150, 150, 150, 150, 131, 150, 150, 150, 72, 150, 84, 92, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 137, 150, 74, 79, 150, 150, 150, 94, 65, 132, 66, 107, 150, 61, 150, 150, 150, 150, 69, 150, 63, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 140, 130, 150, 150, 116, 134, 69, 150, 150, 150, 150, 71, 150, 91, 150, 63, 85, 150, 150, 150, 150, 150, 77, 46, 150, 150, 150, 150, 70, 150, 150, 84, 150, 150, 150, 150], "policy_policy_0_reward": [-865.8788271851083, -597.2111041446575, -713.9517309010412, -870.4295388422586, -684.3301755507838, -956.1624169957528, -537.5801609878932, -1153.9191665401845, -64.96150975485477, -788.6486589152098, -135.3055351462724, -158.4774013085809, -1103.0478292554997, -398.42852344317936, -1092.0478460651802, -620.7514392207997, -859.8589796061417, -185.0091209676952, -941.8297462306109, -843.7950317163674, -832.6720305333378, -953.548287451734, -565.4338933605048, -597.1043489485771, -1082.664948265537, -187.5863698691366, -98.00977491727791, -860.7314873365956, -1101.803521487004, -844.0434803101867, -321.4058615694196, -68.30026384495376, -484.7483175159384, -99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519781704255651, "mean_inference_ms": 1.706776568736476, "mean_action_processing_ms": 0.2766327768249503, "mean_env_wait_ms": 3.05217533220677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011424064636230469, "StateBufferConnector_ms": 0.007835865020751953, "ViewRequirementAgentConnector_ms": 0.19332456588745117}, "num_episodes": 31, "episode_return_max": -23.311912963800424, "episode_return_min": -1495.4317731082708, "episode_return_mean": -660.6802975583254, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.62610537589404, "num_env_steps_trained_throughput_per_sec": 306.62610537589404, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 13291.108, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13291.036, "sample_time_ms": 1060.836, "learn_time_ms": 12163.192, "learn_throughput": 328.861, "synch_weights_time_ms": 66.212}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "3541f_00001", "date": "2024-08-03_03-21-04", "timestamp": 1722635464, "time_this_iter_s": 13.058048486709595, "time_total_s": 867.493702173233, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 867.493702173233, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.05263157894737, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 257.98779435753823, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.744801319887241, "policy_loss": -0.005583343265849787, "vf_loss": 4.756530696650346, "vf_explained_var": 0.9658813246836265, "kl": 0.014363380945875784, "entropy": 1.584131224701802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -22.765426971434458, "episode_reward_min": -1495.4317731082708, "episode_reward_mean": -677.3856147636898, "episode_len_mean": 132.13, "episode_media": {}, "episodes_timesteps_total": 13213, "policy_reward_min": {"policy_0": -1495.4317731082708}, "policy_reward_max": {"policy_0": -22.765426971434458}, "policy_reward_mean": {"policy_0": -677.3856147636898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957], "episode_lengths": [66, 107, 150, 61, 150, 150, 150, 150, 69, 150, 63, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 140, 130, 150, 150, 116, 134, 69, 150, 150, 150, 150, 71, 150, 91, 150, 63, 85, 150, 150, 150, 150, 150, 77, 46, 150, 150, 150, 150, 70, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 120, 117, 150, 150, 150, 150, 83, 150, 127, 150, 138, 150, 112, 143, 148, 150, 89, 150, 42, 150, 58, 150, 72, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-99.09023972837268, -176.21174556628046, -578.3338730445616, -167.79135823187218, -1274.4992926451598, -1144.3387823133264, -644.1296123563591, -526.2199786186183, -109.58265083090471, -487.873777287706, -166.5436758039529, -532.0338381701922, -1178.5088207269216, -433.3778517837224, -1019.1336888794438, -595.8613708179568, -862.6668605712628, -943.235707541802, -1133.7630442198943, -757.9574470615487, -721.0239665023204, -959.5196317526882, -1495.4317731082708, -843.8514249527068, -1042.2807387508392, -913.3768368974344, -771.573484495971, -702.9268080605492, -388.42789126516607, -735.1282825748314, -860.2739941555533, -581.9151400369382, -547.8551670229309, -1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552150402410586, "mean_inference_ms": 1.7069499190178112, "mean_action_processing_ms": 0.27666448468735927, "mean_env_wait_ms": 3.053948001301334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011881589889526367, "StateBufferConnector_ms": 0.007858037948608398, "ViewRequirementAgentConnector_ms": 0.1940922737121582}, "num_episodes": 33, "episode_return_max": -22.765426971434458, "episode_return_min": -1495.4317731082708, "episode_return_mean": -677.3856147636898, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.31879580087735, "num_env_steps_trained_throughput_per_sec": 299.31879580087735, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 13299.307, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13299.234, "sample_time_ms": 1066.731, "learn_time_ms": 12165.51, "learn_throughput": 328.798, "synch_weights_time_ms": 66.196}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "3541f_00001", "date": "2024-08-03_03-21-17", "timestamp": 1722635477, "time_this_iter_s": 13.377082824707031, "time_total_s": 880.8707849979401, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.8707849979401, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.252631578947373, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.09059488773346, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.955857787777981, "policy_loss": -0.011852221132236688, "vf_loss": 4.97623207817475, "vf_explained_var": 0.9603976638366779, "kl": 0.012160091775755747, "entropy": 1.6730130093793074, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -22.765426971434458, "episode_reward_min": -1268.3764077008957, "episode_reward_mean": -664.0683744699577, "episode_len_mean": 130.37, "episode_media": {}, "episodes_timesteps_total": 13037, "policy_reward_min": {"policy_0": -1268.3764077008957}, "policy_reward_max": {"policy_0": -22.765426971434458}, "policy_reward_mean": {"policy_0": -664.0683744699577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549], "episode_lengths": [150, 150, 116, 134, 69, 150, 150, 150, 150, 71, 150, 91, 150, 63, 85, 150, 150, 150, 150, 150, 77, 46, 150, 150, 150, 150, 70, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 120, 117, 150, 150, 150, 150, 83, 150, 127, 150, 138, 150, 112, 143, 148, 150, 89, 150, 42, 150, 58, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 104, 55, 49, 150, 98, 118, 106, 108, 103, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150], "policy_policy_0_reward": [-1186.7748947632178, -459.35325651710514, -369.31269153359733, -386.5330030401993, -132.30636539251276, -756.1913868148552, -973.017361683402, -832.1386361291095, -889.8337979445957, -83.3441977244824, -826.7139611866409, -238.38614339790144, -811.615152751304, -72.22905278907547, -218.57237529389994, -874.963286769684, -1146.1793072975283, -1164.6847440344159, -916.9383589398255, -552.8239480111449, -173.42425993889816, -23.311912963800424, -898.4914667485293, -931.4124957779245, -694.8085296270592, -915.4155878221846, -86.27055957582793, -753.7690504807391, -687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526694390632639, "mean_inference_ms": 1.7082028620163408, "mean_action_processing_ms": 0.27690442618233513, "mean_env_wait_ms": 3.058264683855411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01235198974609375, "StateBufferConnector_ms": 0.007953166961669922, "ViewRequirementAgentConnector_ms": 0.19677066802978516}, "num_episodes": 33, "episode_return_max": -22.765426971434458, "episode_return_min": -1268.3764077008957, "episode_return_mean": -664.0683744699577, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.3105335067111, "num_env_steps_trained_throughput_per_sec": 307.3105335067111, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 13269.461, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13269.387, "sample_time_ms": 1059.58, "learn_time_ms": 12143.558, "learn_throughput": 329.393, "synch_weights_time_ms": 65.443}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "3541f_00001", "date": "2024-08-03_03-21-30", "timestamp": 1722635490, "time_this_iter_s": 13.029454708099365, "time_total_s": 893.9002397060394, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6c550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 893.9002397060394, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.00526315789473, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 264.05204111735026, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.2049643668035666, "policy_loss": -0.0074262677027339425, "vf_loss": 4.219901833931605, "vf_explained_var": 0.9841032035648822, "kl": 0.013950604337272514, "entropy": 1.6927847716957332, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -22.765426971434458, "episode_reward_min": -1268.3764077008957, "episode_reward_mean": -696.2372327200803, "episode_len_mean": 134.64, "episode_media": {}, "episodes_timesteps_total": 13464, "policy_reward_min": {"policy_0": -1268.3764077008957}, "policy_reward_max": {"policy_0": -22.765426971434458}, "policy_reward_mean": {"policy_0": -696.2372327200803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592], "episode_lengths": [150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 120, 117, 150, 150, 150, 150, 83, 150, 127, 150, 138, 150, 112, 143, 148, 150, 89, 150, 42, 150, 58, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 104, 55, 49, 150, 98, 118, 106, 108, 103, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 125, 150, 110, 105, 150, 150, 150, 150, 150, 150, 143, 57, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-687.6100555886896, -167.84596791836904, -819.6189980239719, -586.2097419432404, -736.4051703253898, -737.107953119084, -764.4174801973109, -835.2265230864987, -1202.23865159388, -619.4181048086363, -325.67755177189895, -508.89890193160113, -950.3071839934338, -413.4004461198855, -990.2876984026356, -794.870777951129, -125.09944458672032, -779.0235833034591, -602.7917491223544, -850.217536685877, -764.2508676852519, -910.6873422354273, -237.29908553744676, -767.3317449248736, -378.40165792368657, -771.6395565766923, -333.3071971299608, -843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523172840456281, "mean_inference_ms": 1.7061277220721478, "mean_action_processing_ms": 0.27667012585572953, "mean_env_wait_ms": 3.055493605940279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012555599212646484, "StateBufferConnector_ms": 0.008025169372558594, "ViewRequirementAgentConnector_ms": 0.19867897033691406}, "num_episodes": 28, "episode_return_max": -22.765426971434458, "episode_return_min": -1268.3764077008957, "episode_return_mean": -696.2372327200803, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.584600158628, "num_env_steps_trained_throughput_per_sec": 316.584600158628, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13213.766, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13213.692, "sample_time_ms": 1062.002, "learn_time_ms": 12085.4, "learn_throughput": 330.978, "synch_weights_time_ms": 65.499}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "3541f_00001", "date": "2024-08-03_03-21-43", "timestamp": 1722635503, "time_this_iter_s": 12.648460626602173, "time_total_s": 906.5487003326416, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 906.5487003326416, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.28333333333333, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 341.2014160593351, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.547277216613293, "policy_loss": -0.008669486322711842, "vf_loss": 4.564786524325609, "vf_explained_var": 0.9703620345642169, "kl": 0.014359489562260326, "entropy": 1.8532489575445652, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -22.765426971434458, "episode_reward_min": -1371.9926458876982, "episode_reward_mean": -728.8912645828656, "episode_len_mean": 134.99, "episode_media": {}, "episodes_timesteps_total": 13499, "policy_reward_min": {"policy_0": -1371.9926458876982}, "policy_reward_max": {"policy_0": -22.765426971434458}, "policy_reward_mean": {"policy_0": -728.8912645828656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355], "episode_lengths": [150, 42, 150, 58, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 104, 55, 49, 150, 98, 118, 106, 108, 103, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 125, 150, 110, 105, 150, 150, 150, 150, 150, 150, 143, 57, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 72], "policy_policy_0_reward": [-843.6838665618044, -22.765426971434458, -1102.4814875926816, -51.160813497988094, -1163.3290948437211, -98.13236902978053, -1143.4138992034395, -946.5279982614855, -930.6640530954585, -676.7102198234822, -1068.1703265738888, -1268.3764077008957, -1021.0013717655122, -732.1449547045246, -64.64924433073496, -1009.362900064909, -364.89891720181686, -24.202491439550542, -43.73448095204814, -974.2357709722263, -339.2327839704992, -388.181527586471, -466.24306262059247, -440.11872882934387, -325.7719787342906, -1248.8711894006813, -94.40247958835866, -892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521862900795412, "mean_inference_ms": 1.7054179527659756, "mean_action_processing_ms": 0.2767323003488294, "mean_env_wait_ms": 3.0558324027523667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01197361946105957, "StateBufferConnector_ms": 0.007899999618530273, "ViewRequirementAgentConnector_ms": 0.1954631805419922}, "num_episodes": 27, "episode_return_max": -22.765426971434458, "episode_return_min": -1371.9926458876982, "episode_return_mean": -728.8912645828656, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.1126133155598, "num_env_steps_trained_throughput_per_sec": 297.1126133155598, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 13189.29, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13189.215, "sample_time_ms": 1072.761, "learn_time_ms": 12051.694, "learn_throughput": 331.904, "synch_weights_time_ms": 64.009}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "3541f_00001", "date": "2024-08-03_03-21-57", "timestamp": 1722635517, "time_this_iter_s": 13.475542068481445, "time_total_s": 920.024242401123, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 920.024242401123, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.078947368421055, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 292.6994747082392, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.667862737427155, "policy_loss": -0.013637107304142167, "vf_loss": 4.6892893629769485, "vf_explained_var": 0.9712372196217378, "kl": 0.011304688769087145, "entropy": 1.5420176494866609, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 2.7931494887955157, "episode_reward_min": -1371.9926458876982, "episode_reward_mean": -760.1543201701861, "episode_len_mean": 141.0, "episode_media": {}, "episodes_timesteps_total": 14100, "policy_reward_min": {"policy_0": -1371.9926458876982}, "policy_reward_max": {"policy_0": 2.7931494887955157}, "policy_reward_mean": {"policy_0": -760.1543201701861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 125, 150, 110, 105, 150, 150, 150, 150, 150, 150, 143, 57, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 72, 150, 150, 97, 121, 150, 147, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 42, 150, 150, 150, 150], "policy_policy_0_reward": [-892.6653833375182, -551.694991368263, -1001.1446456366731, -513.467368677292, -871.7825968360735, -590.2021919265311, -1249.825417977291, -979.7454878397109, -869.2843596938376, -750.2171488468815, -1076.83612462665, -810.2798383809376, -1022.7866184593149, -517.3673378899433, -620.1369070095315, -786.5713905628238, -639.9729599142617, -781.9820752577549, -809.7755249230768, -956.029101277813, -391.1531035726408, -308.19081577077196, -322.33354035671704, -219.48451392676105, -919.513293798519, -900.7954196435173, -1089.435448902401, -738.0351775087856, -629.9776978595416, -780.9327269184089, -587.9744489565, -143.58662217669007, -197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520553669568239, "mean_inference_ms": 1.7048516655765276, "mean_action_processing_ms": 0.2767950026185188, "mean_env_wait_ms": 3.0536690541492226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012107610702514648, "StateBufferConnector_ms": 0.007858514785766602, "ViewRequirementAgentConnector_ms": 0.1940140724182129}, "num_episodes": 27, "episode_return_max": 2.7931494887955157, "episode_return_min": -1371.9926458876982, "episode_return_mean": -760.1543201701861, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.51383853366184, "num_env_steps_trained_throughput_per_sec": 322.51383853366184, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 13109.218, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13109.14, "sample_time_ms": 1072.592, "learn_time_ms": 11970.6, "learn_throughput": 334.152, "synch_weights_time_ms": 65.187}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "3541f_00001", "date": "2024-08-03_03-22-09", "timestamp": 1722635529, "time_this_iter_s": 12.416073083877563, "time_total_s": 932.4403154850006, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 932.4403154850006, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.544444444444444, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.60831284920374, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.585733598222335, "policy_loss": -0.011814601829488918, "vf_loss": 5.600324112921953, "vf_explained_var": 0.95201916800191, "kl": 0.016379416196468898, "entropy": 1.3832040893534818, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 2.7931494887955157, "episode_reward_min": -1371.9926458876982, "episode_reward_mean": -717.4735169038603, "episode_len_mean": 135.55, "episode_media": {}, "episodes_timesteps_total": 13555, "policy_reward_min": {"policy_0": -1371.9926458876982}, "policy_reward_max": {"policy_0": 2.7931494887955157}, "policy_reward_mean": {"policy_0": -717.4735169038603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828], "episode_lengths": [109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 72, 150, 150, 97, 121, 150, 147, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 78, 66, 150, 150, 102, 150, 150, 87, 68, 95, 150, 150, 150, 150, 150, 68, 150, 64, 66, 131, 150, 90, 150, 150], "policy_policy_0_reward": [-197.8562870218716, -528.4725668340288, -497.9965261150635, -1171.2659500703685, -1174.4228398670775, -1140.9841733365113, -942.9258219432418, -734.5048735798398, -718.0837929211403, -644.7671108103892, -1029.6390783214977, -897.860701460206, -1215.559502772271, -894.1449493160592, -1096.1462857177369, -755.4113496122304, -466.2318002169026, -794.1523234681492, -1371.9926458876982, -830.6417151859084, -689.7443926886856, -691.2965085918065, -1049.7992651911852, -672.7964082961702, -407.1592601518049, -730.806486810845, -778.4556963762592, -801.5518420364167, -1027.4962055641759, -159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522329056943062, "mean_inference_ms": 1.7044388772712284, "mean_action_processing_ms": 0.2767242204243371, "mean_env_wait_ms": 3.054911277070027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000322341918945, "StateBufferConnector_ms": 0.007875204086303711, "ViewRequirementAgentConnector_ms": 0.1957712173461914}, "num_episodes": 32, "episode_return_max": 2.7931494887955157, "episode_return_min": -1371.9926458876982, "episode_return_mean": -717.4735169038603, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.63434901462676, "num_env_steps_trained_throughput_per_sec": 328.63434901462676, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 12989.515, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12989.437, "sample_time_ms": 1073.605, "learn_time_ms": 11850.506, "learn_throughput": 337.538, "synch_weights_time_ms": 64.566}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "3541f_00001", "date": "2024-08-03_03-22-21", "timestamp": 1722635541, "time_this_iter_s": 12.184757709503174, "time_total_s": 944.6250731945038, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 944.6250731945038, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.564705882352943, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 272.45725762844086, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.433328785995642, "policy_loss": -0.01152294262695553, "vf_loss": 5.453417818496624, "vf_explained_var": 0.9736557765553395, "kl": 0.013058028619555746, "entropy": 1.7380247530837853, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 2.7931494887955157, "episode_reward_min": -1408.8799263319988, "episode_reward_mean": -696.1434668416878, "episode_len_mean": 132.95, "episode_media": {}, "episodes_timesteps_total": 13295, "policy_reward_min": {"policy_0": -1408.8799263319988}, "policy_reward_max": {"policy_0": 2.7931494887955157}, "policy_reward_mean": {"policy_0": -696.1434668416878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463], "episode_lengths": [73, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 72, 150, 150, 97, 121, 150, 147, 80, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 78, 66, 150, 150, 102, 150, 150, 87, 68, 95, 150, 150, 150, 150, 150, 68, 150, 64, 66, 131, 150, 90, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 94, 150, 150, 103, 147, 150, 104, 150, 122, 150, 150, 150, 150, 150, 126, 101, 150, 150, 80, 135, 150], "policy_policy_0_reward": [-159.46073135672037, -609.6085907026005, -1021.9436837189271, -1043.6394722265518, -1132.1327791929523, -1159.6247983102837, -321.2920486998446, -445.66605978810173, -1271.24948739266, -897.839048260103, -547.1477411073286, -151.70753221387355, -1262.0115138439407, -952.9072394003159, -321.98958022930833, -392.1764147585095, -828.0426591308266, -558.1561418333131, -97.27976067086503, -747.0346806146742, -721.3428962912388, -1032.5178081465199, -1108.0029857558109, -564.4527701600848, -816.5265939455142, -780.4451897490852, -1357.25047322442, -704.4893541164777, -882.500089472602, -482.2851926622652, -1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523647060910932, "mean_inference_ms": 1.7045605046900534, "mean_action_processing_ms": 0.27674012356209954, "mean_env_wait_ms": 3.0546652003019608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011902809143066406, "StateBufferConnector_ms": 0.007850408554077148, "ViewRequirementAgentConnector_ms": 0.19556832313537598}, "num_episodes": 29, "episode_return_max": 2.7931494887955157, "episode_return_min": -1408.8799263319988, "episode_return_mean": -696.1434668416878, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8166425982935, "num_env_steps_trained_throughput_per_sec": 305.8166425982935, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 12986.648, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12986.57, "sample_time_ms": 1086.905, "learn_time_ms": 11835.928, "learn_throughput": 337.954, "synch_weights_time_ms": 62.974}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "3541f_00001", "date": "2024-08-03_03-22-34", "timestamp": 1722635554, "time_this_iter_s": 13.093227624893188, "time_total_s": 957.718300819397, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 957.718300819397, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.263157894736842, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 294.7657330354055, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.7653350256383415, "policy_loss": -0.010775528894737364, "vf_loss": 4.780163199702899, "vf_explained_var": 0.9874561414743463, "kl": 0.014318474287574707, "entropy": 1.371760653766493, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": 2.7931494887955157, "episode_reward_min": -1408.8799263319988, "episode_reward_mean": -681.5410229661192, "episode_len_mean": 133.85, "episode_media": {}, "episodes_timesteps_total": 13385, "policy_reward_min": {"policy_0": -1408.8799263319988}, "policy_reward_max": {"policy_0": 2.7931494887955157}, "policy_reward_mean": {"policy_0": -681.5410229661192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014], "episode_lengths": [150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 78, 66, 150, 150, 102, 150, 150, 87, 68, 95, 150, 150, 150, 150, 150, 68, 150, 64, 66, 131, 150, 90, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 94, 150, 150, 103, 147, 150, 104, 150, 122, 150, 150, 150, 150, 150, 126, 101, 150, 150, 80, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 140, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 62, 150, 74, 122], "policy_policy_0_reward": [-1148.343332726036, -655.4005173602134, -1058.6051339600458, -821.1994395501068, 2.7931494887955157, -716.2766100677757, -732.5073090658004, -876.9721787348867, -362.85068806785597, -679.4195803058923, -1288.8811546691063, -265.66790610348806, -1277.485459299176, -865.9221204035422, -778.4483298105174, -390.6544890825176, -674.8754918157351, -250.75690097601156, -145.70346170187034, -1142.1609733689666, -738.7310656525583, -277.1836020296113, -634.3984896204058, -644.8638520717361, -265.71585691582715, -141.22277280455253, -353.93269397017, -685.6254233863639, -675.5955484896222, -780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524014472671623, "mean_inference_ms": 1.7037182971470808, "mean_action_processing_ms": 0.27668123729136046, "mean_env_wait_ms": 3.0554051335172323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011518478393554688, "StateBufferConnector_ms": 0.007711172103881836, "ViewRequirementAgentConnector_ms": 0.19318318367004395}, "num_episodes": 30, "episode_return_max": 2.7931494887955157, "episode_return_min": -1408.8799263319988, "episode_return_mean": -681.5410229661192, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0822778700307, "num_env_steps_trained_throughput_per_sec": 309.0822778700307, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 12951.448, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12951.369, "sample_time_ms": 1083.306, "learn_time_ms": 11804.55, "learn_throughput": 338.852, "synch_weights_time_ms": 62.749}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "3541f_00001", "date": "2024-08-03_03-22-47", "timestamp": 1722635567, "time_this_iter_s": 12.953566789627075, "time_total_s": 970.671867609024, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 970.671867609024, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.205555555555556, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 295.66495364109676, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.663229092334707, "policy_loss": -0.013448994055215735, "vf_loss": 4.686298271516959, "vf_explained_var": 0.9900694369648894, "kl": 0.013055968093366725, "entropy": 1.8432974506169557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -20.213543251768538, "episode_reward_min": -1440.194887702092, "episode_reward_mean": -719.3986624742614, "episode_len_mean": 136.13, "episode_media": {}, "episodes_timesteps_total": 13613, "policy_reward_min": {"policy_0": -1440.194887702092}, "policy_reward_max": {"policy_0": -20.213543251768538}, "policy_reward_mean": {"policy_0": -719.3986624742614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095], "episode_lengths": [150, 150, 150, 68, 150, 64, 66, 131, 150, 90, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 94, 150, 150, 103, 147, 150, 104, 150, 122, 150, 150, 150, 150, 150, 126, 101, 150, 150, 80, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 140, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 62, 150, 74, 122, 150, 108, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 44, 150, 150, 150, 150, 150, 150, 97], "policy_policy_0_reward": [-780.6386904788765, -742.3956320480495, -488.6229629522431, -117.10175653725297, -858.5573220553711, -157.17550179401016, -54.726193654540886, -665.3613499250187, -862.5335964215681, -348.7648258175739, -1088.0354028567813, -713.9415461818828, -755.4140983896654, -1103.6093166651715, -258.4600462560138, -757.5562294495445, -1183.9201426914985, -807.1811370597716, -891.7557425716994, -1358.648600396675, -359.6453836247114, -816.7075184950068, -1408.8799263319988, -350.97816597556033, -646.3596197732119, -840.5023715627134, -192.87973418569993, -1155.8766368955885, -186.77444745630524, -1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521054219029152, "mean_inference_ms": 1.7030349410597305, "mean_action_processing_ms": 0.27661144713915103, "mean_env_wait_ms": 3.055658712627913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01177835464477539, "StateBufferConnector_ms": 0.007784366607666016, "ViewRequirementAgentConnector_ms": 0.19467592239379883}, "num_episodes": 29, "episode_return_max": -20.213543251768538, "episode_return_min": -1440.194887702092, "episode_return_mean": -719.3986624742614, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.04195721523274, "num_env_steps_trained_throughput_per_sec": 309.04195721523274, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 12906.156, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12906.082, "sample_time_ms": 1075.673, "learn_time_ms": 11766.978, "learn_throughput": 339.934, "synch_weights_time_ms": 62.662}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "3541f_00001", "date": "2024-08-03_03-23-00", "timestamp": 1722635580, "time_this_iter_s": 12.956537961959839, "time_total_s": 983.6284055709839, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 983.6284055709839, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.438888888888886, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 281.5966194033623, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.06695528998971, "policy_loss": -0.015911680953771188, "vf_loss": 4.0902860455214975, "vf_explained_var": 0.9868268981575966, "kl": 0.014551658393490168, "entropy": 1.7241451083372037, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": -18.255640148887828, "episode_reward_min": -1440.194887702092, "episode_reward_mean": -738.4313980365108, "episode_len_mean": 139.2, "episode_media": {}, "episodes_timesteps_total": 13920, "policy_reward_min": {"policy_0": -1440.194887702092}, "policy_reward_max": {"policy_0": -18.255640148887828}, "policy_reward_mean": {"policy_0": -738.4313980365108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151], "episode_lengths": [150, 150, 150, 150, 150, 126, 101, 150, 150, 80, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 140, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 62, 150, 74, 122, 150, 108, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 44, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 67, 92, 150, 150, 150, 43, 150, 150, 150, 147, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1368.8824848864588, -999.281994811774, -757.2913535699163, -603.0119893655569, -853.7395988373045, -521.1775778833733, -304.30911977673895, -698.4048492444142, -782.0705362196293, -269.4498678948588, -584.7957487128822, -1001.5971149645463, -883.6730398905983, -810.5001997020861, -1097.850087310995, -559.8661399675982, -683.3702906312874, -215.3507312473342, -325.5770333439906, -972.2163827574827, -724.5414112135658, -1140.4637571691808, -881.2775690666654, -359.8312158984898, -887.9466123254774, -702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522342331610818, "mean_inference_ms": 1.7027256275884597, "mean_action_processing_ms": 0.27660257793310256, "mean_env_wait_ms": 3.0554955288670307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011860847473144531, "StateBufferConnector_ms": 0.007767915725708008, "ViewRequirementAgentConnector_ms": 0.19095730781555176}, "num_episodes": 29, "episode_return_max": -18.255640148887828, "episode_return_min": -1440.194887702092, "episode_return_mean": -738.4313980365108, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.6366449474939, "num_env_steps_trained_throughput_per_sec": 303.6366449474939, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 12919.0, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12918.925, "sample_time_ms": 1078.815, "learn_time_ms": 11775.887, "learn_throughput": 339.677, "synch_weights_time_ms": 63.457}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "3541f_00001", "date": "2024-08-03_03-23-14", "timestamp": 1722635594, "time_this_iter_s": 13.185713291168213, "time_total_s": 996.8141188621521, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6c790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 996.8141188621521, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.02105263157895, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 336.0280460953712, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.124214772631725, "policy_loss": -0.013815965844939153, "vf_loss": 4.146921907365322, "vf_explained_var": 0.9882940581068397, "kl": 0.01390566406767, "entropy": 1.8277510785808166, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -18.255640148887828, "episode_reward_min": -1473.6428310804065, "episode_reward_mean": -762.4918685904933, "episode_len_mean": 139.95, "episode_media": {}, "episodes_timesteps_total": 13995, "policy_reward_min": {"policy_0": -1473.6428310804065}, "policy_reward_max": {"policy_0": -18.255640148887828}, "policy_reward_mean": {"policy_0": -762.4918685904933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168], "episode_lengths": [150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 62, 150, 74, 122, 150, 108, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 44, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 67, 92, 150, 150, 150, 43, 150, 150, 150, 147, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150], "policy_policy_0_reward": [-702.3561478052404, -472.05392966212503, -467.44659081654186, -911.0948698739012, -950.305181172988, -881.1589421268648, -830.0967533497839, -851.4397408670725, -524.070226754646, -992.4467788129035, -1084.5301418387794, -1051.591423468344, -373.9336815948347, -151.82323834429778, -521.4071286813743, -127.5239554903215, -474.7357282341014, -640.7128436652837, -413.8392860477456, -717.2700222831742, -1125.894811732504, -662.8930760604997, -1070.664860400533, -194.29007592372642, -764.8847021734807, -1118.2490896434842, -1157.395306786096, -435.052902948329, -758.6220040565744, -588.2702786392389, -1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521298672358753, "mean_inference_ms": 1.7021118966219249, "mean_action_processing_ms": 0.27651581146836773, "mean_env_wait_ms": 3.0538526199905727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028694152832031, "StateBufferConnector_ms": 0.007853269577026367, "ViewRequirementAgentConnector_ms": 0.1909801959991455}, "num_episodes": 25, "episode_return_max": -18.255640148887828, "episode_return_min": -1473.6428310804065, "episode_return_mean": -762.4918685904933, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0557528530663, "num_env_steps_trained_throughput_per_sec": 304.0557528530663, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 12898.18, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12898.107, "sample_time_ms": 1076.067, "learn_time_ms": 11756.849, "learn_throughput": 340.227, "synch_weights_time_ms": 64.423}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "3541f_00001", "date": "2024-08-03_03-23-27", "timestamp": 1722635607, "time_this_iter_s": 13.168083429336548, "time_total_s": 1009.9822022914886, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1009.9822022914886, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.089473684210525, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.60306411186855, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.9228104166686535, "policy_loss": -0.008519141689369765, "vf_loss": 4.936361111203829, "vf_explained_var": 0.9718635448565086, "kl": 0.016618880463890245, "entropy": 1.6249294097224871, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -18.255640148887828, "episode_reward_min": -1473.6428310804065, "episode_reward_mean": -775.46923359016, "episode_len_mean": 142.21, "episode_media": {}, "episodes_timesteps_total": 14221, "policy_reward_min": {"policy_0": -1473.6428310804065}, "policy_reward_max": {"policy_0": -18.255640148887828}, "policy_reward_mean": {"policy_0": -775.46923359016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 87, 44, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 67, 92, 150, 150, 150, 43, 150, 150, 150, 147, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 127, 150, 148, 68, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1100.741561561656, -1301.0555916505398, -1291.9537600911817, -709.3804163070249, -644.067486964125, -1440.194887702092, -739.1537866907959, -129.12159584847987, -20.213543251768538, -656.0133238117905, -807.9129213900768, -1160.3156142265925, -623.5717484512567, -919.3863113085348, -1031.0334951889931, -110.21587853022095, -911.5727179084547, -729.6741222696398, -354.6777964612094, -1161.5095715487091, -67.60717290226566, -315.47649686719916, -566.7486665389076, -362.93588250012334, -587.9883158831495, -18.255640148887828, -1241.781860339848, -1260.756308799382, -1177.1261995306775, -544.2203422787017, -830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523661132372869, "mean_inference_ms": 1.7025573897649502, "mean_action_processing_ms": 0.27654125532870766, "mean_env_wait_ms": 3.056375078379995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012225151062011719, "StateBufferConnector_ms": 0.007834434509277344, "ViewRequirementAgentConnector_ms": 0.19153165817260742}, "num_episodes": 30, "episode_return_max": -18.255640148887828, "episode_return_min": -1473.6428310804065, "episode_return_mean": -775.46923359016, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.7402893397756, "num_env_steps_trained_throughput_per_sec": 416.7402893397756, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 12556.396, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12556.322, "sample_time_ms": 1074.211, "learn_time_ms": 11418.306, "learn_throughput": 350.315, "synch_weights_time_ms": 63.051}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "3541f_00001", "date": "2024-08-03_03-23-37", "timestamp": 1722635617, "time_this_iter_s": 9.60950779914856, "time_total_s": 1019.5917100906372, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6c670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.5917100906372, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 19.58571428571429, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 288.33502494295436, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.4555177139739195, "policy_loss": -0.012022106882553393, "vf_loss": 4.472914187610149, "vf_explained_var": 0.9673945579677821, "kl": 0.014749551917339053, "entropy": 1.5330299540112415, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": -80.0244093388257, "episode_reward_min": -1473.6428310804065, "episode_reward_mean": -773.7752876426874, "episode_len_mean": 143.12, "episode_media": {}, "episodes_timesteps_total": 14312, "policy_reward_min": {"policy_0": -1473.6428310804065}, "policy_reward_max": {"policy_0": -80.0244093388257}, "policy_reward_mean": {"policy_0": -773.7752876426874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541], "episode_lengths": [150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 127, 150, 148, 68, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 100, 103, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 47, 150, 150, 99, 150], "policy_policy_0_reward": [-830.3572545932709, -1150.6489393559527, -507.3987502003754, -931.9217190889615, -701.7234998177132, -843.8083640606095, -739.9413420877336, -1169.4387631243733, -1086.8536298076635, -856.1823202380065, -848.1362575318877, -723.3464565263916, -867.9757743738977, -768.5802743890522, -529.6330155559151, -1177.825760682002, -805.2241523664492, -630.8800641412765, -994.3317353105803, -1100.7567476729407, -868.6438606662022, -1258.5822322341985, -80.0244093388257, -1124.7479157493522, -549.670997982111, -893.3620894683447, -504.6124612420758, -689.4723745580509, -1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520249309972198, "mean_inference_ms": 1.7020107400913078, "mean_action_processing_ms": 0.27658228609558655, "mean_env_wait_ms": 3.0568891949372645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011919975280761719, "StateBufferConnector_ms": 0.007768392562866211, "ViewRequirementAgentConnector_ms": 0.1897587776184082}, "num_episodes": 30, "episode_return_max": -80.0244093388257, "episode_return_min": -1473.6428310804065, "episode_return_mean": -773.7752876426874, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.4338991247361, "num_env_steps_trained_throughput_per_sec": 334.4338991247361, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 12488.962, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12488.89, "sample_time_ms": 1070.951, "learn_time_ms": 11354.31, "learn_throughput": 352.289, "synch_weights_time_ms": 62.834}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "3541f_00001", "date": "2024-08-03_03-23-49", "timestamp": 1722635629, "time_this_iter_s": 11.971472024917603, "time_total_s": 1031.5631821155548, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1031.5631821155548, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.68823529411765, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 270.71792616844175, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.738073564817508, "policy_loss": -0.011964568442393405, "vf_loss": 4.755413652708133, "vf_explained_var": 0.9708681666602691, "kl": 0.01350402380527771, "entropy": 1.4490742539986967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": -81.21192349836522, "episode_reward_min": -1473.6428310804065, "episode_reward_mean": -744.5345109884613, "episode_len_mean": 141.64, "episode_media": {}, "episodes_timesteps_total": 14164, "policy_reward_min": {"policy_0": -1473.6428310804065}, "policy_reward_max": {"policy_0": -81.21192349836522}, "policy_reward_mean": {"policy_0": -744.5345109884613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 127, 150, 148, 68, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 100, 103, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 47, 150, 150, 99, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 82, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1072.6290632258556, -731.8322727617561, -1034.7188050530508, -850.0005062250019, -1026.8194350103286, -941.5301639781587, -869.5087159972618, -290.96491173175593, -489.86035898996516, -1473.6428310804065, -256.4020760612815, -976.4798205632168, -822.0799421340611, -846.9165807081148, -820.1274685291993, -531.5184909688468, -334.2069606661527, -978.9676806750051, -683.76030677578, -113.5581729484257, -154.4884227382381, -1165.6695092177683, -830.5563773109907, -1143.424773334441, -661.3793746916687, -864.2650535991168, -830.0300302945814, -934.4567443685846, -897.5699022245059, -1108.3885124188075, -600.7557162282095, -570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519787639180013, "mean_inference_ms": 1.7016136576529064, "mean_action_processing_ms": 0.2765200457372188, "mean_env_wait_ms": 3.057417688341015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011792659759521484, "StateBufferConnector_ms": 0.007784366607666016, "ViewRequirementAgentConnector_ms": 0.18979978561401367}, "num_episodes": 28, "episode_return_max": -81.21192349836522, "episode_return_min": -1473.6428310804065, "episode_return_mean": -744.5345109884613, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7139275599281, "num_env_steps_trained_throughput_per_sec": 314.7139275599281, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 12413.667, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12413.596, "sample_time_ms": 1059.044, "learn_time_ms": 11291.575, "learn_throughput": 354.246, "synch_weights_time_ms": 62.181}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "3541f_00001", "date": "2024-08-03_03-24-01", "timestamp": 1722635641, "time_this_iter_s": 12.721309661865234, "time_total_s": 1044.28449177742, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1044.28449177742, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.41111111111111, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 266.267164738973, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.933993897835413, "policy_loss": -0.013644344272324815, "vf_loss": 4.956080583234628, "vf_explained_var": 0.9790371450905998, "kl": 0.01370767353467582, "entropy": 1.7695028038074574, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -23.315879862752308, "episode_reward_min": -1353.405900991844, "episode_reward_mean": -710.9690782749791, "episode_len_mean": 136.33, "episode_media": {}, "episodes_timesteps_total": 13633, "policy_reward_min": {"policy_0": -1353.405900991844}, "policy_reward_max": {"policy_0": -23.315879862752308}, "policy_reward_mean": {"policy_0": -710.9690782749791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517], "episode_lengths": [150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 100, 103, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 47, 150, 150, 99, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 82, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 113, 60, 150, 150, 114, 73, 150, 150, 150, 150, 150, 81, 80, 150, 87, 150, 99, 150, 80, 150, 150, 150, 150, 150, 150, 85, 48, 150], "policy_policy_0_reward": [-570.7927384207755, -694.3102824283906, -531.7614252831871, -608.3939700647585, -718.3337096392797, -662.6380962370965, -1042.9860805882931, -851.620091399112, -939.5043768648372, -1021.2126705821911, -350.11675788107584, -953.3767530184743, -649.7225729691822, -906.173750741448, -411.40036925232795, -134.66405206232895, -570.1432202958036, -737.3177119883, -1269.480307622522, -703.2359185579663, -885.8896647597833, -887.3526172437092, -1137.0028904678713, -234.889736283165, -460.9830747875846, -1065.6429585440717, -965.0371411524492, -531.8737067822528, -966.9567921935577, -1140.1911949574649, -1015.3228429388056, -462.5828691669028, -324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519384036444788, "mean_inference_ms": 1.7011645070339627, "mean_action_processing_ms": 0.2765373846211513, "mean_env_wait_ms": 3.056309309753672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011654138565063477, "StateBufferConnector_ms": 0.007679462432861328, "ViewRequirementAgentConnector_ms": 0.18858695030212402}, "num_episodes": 31, "episode_return_max": -23.315879862752308, "episode_return_min": -1353.405900991844, "episode_return_mean": -710.9690782749791, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1474651546173, "num_env_steps_trained_throughput_per_sec": 302.1474651546173, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 12497.267, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12497.197, "sample_time_ms": 1059.613, "learn_time_ms": 11374.218, "learn_throughput": 351.673, "synch_weights_time_ms": 62.571}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "3541f_00001", "date": "2024-08-03_03-24-15", "timestamp": 1722635655, "time_this_iter_s": 13.25098180770874, "time_total_s": 1057.5354735851288, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415e9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1057.5354735851288, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 16.952631578947365, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 312.0203423698743, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.11988617827495, "policy_loss": -0.006050972192800448, "vf_loss": 4.136847310761611, "vf_explained_var": 0.9829939368491372, "kl": 0.014973337884657748, "entropy": 2.1017174078772465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -23.315879862752308, "episode_reward_min": -1383.0046958236383, "episode_reward_mean": -712.5848210649893, "episode_len_mean": 133.18, "episode_media": {}, "episodes_timesteps_total": 13318, "policy_reward_min": {"policy_0": -1383.0046958236383}, "policy_reward_max": {"policy_0": -23.315879862752308}, "policy_reward_mean": {"policy_0": -712.5848210649893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628], "episode_lengths": [150, 150, 150, 150, 47, 150, 150, 99, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 82, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 113, 60, 150, 150, 114, 73, 150, 150, 150, 150, 150, 81, 80, 150, 87, 150, 99, 150, 80, 150, 150, 150, 150, 150, 150, 85, 48, 150, 150, 72, 81, 58, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 90, 99, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 100, 81, 150], "policy_policy_0_reward": [-324.1310824593098, -937.4540491432319, -737.4332569306202, -744.3499319472647, -85.87753252774824, -949.3458736984811, -908.5734096938494, -217.85742157115612, -821.0057184473541, -775.7508006478075, -544.2817432880396, -990.8574400330795, -555.0934994732187, -1059.2834562802052, -881.9766212638843, -737.0320387607491, -680.9340071350196, -1105.4494683769617, -632.7655522057504, -716.1740446470303, -734.7570894513968, -771.2996120401654, -662.486933293723, -124.81705159576106, -1141.945167705671, -565.3061762386616, -791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518375041383631, "mean_inference_ms": 1.700486972192115, "mean_action_processing_ms": 0.2763810429592079, "mean_env_wait_ms": 3.055951218035534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011607885360717773, "StateBufferConnector_ms": 0.007848739624023438, "ViewRequirementAgentConnector_ms": 0.19173455238342285}, "num_episodes": 32, "episode_return_max": -23.315879862752308, "episode_return_min": -1383.0046958236383, "episode_return_mean": -712.5848210649893, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.8383489741532, "num_env_steps_trained_throughput_per_sec": 518.8383489741532, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 12051.062, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12050.99, "sample_time_ms": 1059.725, "learn_time_ms": 10927.743, "learn_throughput": 366.041, "synch_weights_time_ms": 62.709}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "3541f_00001", "date": "2024-08-03_03-24-22", "timestamp": 1722635662, "time_this_iter_s": 7.721162796020508, "time_total_s": 1065.2566363811493, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1065.2566363811493, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.90909090909091, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 291.193484210968, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.212052852412065, "policy_loss": -0.005162583691223214, "vf_loss": 4.226091538866361, "vf_explained_var": 0.9823401452352604, "kl": 0.014827453541026223, "entropy": 1.8884645763784647, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": -23.315879862752308, "episode_reward_min": -1383.0046958236383, "episode_reward_mean": -726.4239648642974, "episode_len_mean": 132.94, "episode_media": {}, "episodes_timesteps_total": 13294, "policy_reward_min": {"policy_0": -1383.0046958236383}, "policy_reward_max": {"policy_0": -23.315879862752308}, "policy_reward_mean": {"policy_0": -726.4239648642974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991], "episode_lengths": [150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 113, 60, 150, 150, 114, 73, 150, 150, 150, 150, 150, 81, 80, 150, 87, 150, 99, 150, 80, 150, 150, 150, 150, 150, 150, 85, 48, 150, 150, 72, 81, 58, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 90, 99, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 100, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 106, 88, 150, 150, 150, 76, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-791.607183172355, -868.5808539368246, -764.8885779112966, -232.71513224358714, -869.6556898338781, -81.21192349836522, -711.959158242837, -1178.896987212336, -734.2075175934805, -728.5882399225895, -667.4815307369192, -1082.0573275613579, -892.740614362203, -703.0092008564004, -476.7783772760011, -143.24646006559357, -461.47066968935985, -1027.2755100497807, -393.3903660612374, -234.45906203484103, -711.2644924559406, -1276.048265129778, -745.8484811406634, -745.5543107729844, -1180.9091142533057, -305.35901158347946, -120.1508946198736, -664.0376131340286, -324.65421506540474, -542.6467809807001, -337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516206902779327, "mean_inference_ms": 1.6996294014459261, "mean_action_processing_ms": 0.2761963226122466, "mean_env_wait_ms": 3.0565299349388875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011525869369506836, "StateBufferConnector_ms": 0.007752656936645508, "ViewRequirementAgentConnector_ms": 0.19516587257385254}, "num_episodes": 26, "episode_return_max": -23.315879862752308, "episode_return_min": -1383.0046958236383, "episode_return_mean": -726.4239648642974, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.94655202696, "num_env_steps_trained_throughput_per_sec": 301.94655202696, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 12067.826, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12067.754, "sample_time_ms": 1055.011, "learn_time_ms": 10949.24, "learn_throughput": 365.322, "synch_weights_time_ms": 62.694}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "3541f_00001", "date": "2024-08-03_03-24-36", "timestamp": 1722635676, "time_this_iter_s": 13.260230302810669, "time_total_s": 1078.51686668396, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6e8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1078.51686668396, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.315789473684212, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.93077516555786, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.927126603325208, "policy_loss": -0.002029717584567455, "vf_loss": 4.9365112235148745, "vf_explained_var": 0.9747948339829843, "kl": 0.014182301154263244, "entropy": 1.6927944677571456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -23.315879862752308, "episode_reward_min": -1383.0046958236383, "episode_reward_mean": -735.0345450041555, "episode_len_mean": 134.35, "episode_media": {}, "episodes_timesteps_total": 13435, "policy_reward_min": {"policy_0": -1383.0046958236383}, "policy_reward_max": {"policy_0": -23.315879862752308}, "policy_reward_mean": {"policy_0": -735.0345450041555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122], "episode_lengths": [99, 150, 80, 150, 150, 150, 150, 150, 150, 85, 48, 150, 150, 72, 81, 58, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 90, 99, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 100, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 106, 88, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 139, 150, 150, 99, 150, 150, 66, 150, 150, 114, 71, 150, 150, 150, 150, 104, 150, 150, 150, 84], "policy_policy_0_reward": [-337.8156842192192, -951.7681143494135, -199.49243781121902, -847.2730421254466, -1171.7913775474606, -758.070625968996, -1353.405900991844, -1108.9519450969808, -965.017622081453, -151.60923518035108, -23.315879862752308, -1080.5530768342517, -950.3584717370817, -95.89724506616518, -317.13541198009625, -114.55525111163689, -1053.1249287693913, -1206.9999668726514, -984.8664640903663, -1062.613690130408, -999.1770290283405, -539.8076821304657, -627.3349682172799, -1159.5482189706638, -800.9619559490524, -981.1310076021351, -1060.9010491561075, -846.095255819604, -1109.8804093559509, -181.718755475463, -305.87460697437086, -569.9691730211574, -269.4625009037386, -864.47482822399, -1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513980663578216, "mean_inference_ms": 1.6990264536407396, "mean_action_processing_ms": 0.2761757464952309, "mean_env_wait_ms": 3.0575921793039504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011639595031738281, "StateBufferConnector_ms": 0.007990837097167969, "ViewRequirementAgentConnector_ms": 0.19776248931884766}, "num_episodes": 30, "episode_return_max": -23.315879862752308, "episode_return_min": -1383.0046958236383, "episode_return_mean": -735.0345450041555, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6585440654382, "num_env_steps_trained_throughput_per_sec": 309.6585440654382, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 12065.418, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12065.346, "sample_time_ms": 1056.653, "learn_time_ms": 10942.703, "learn_throughput": 365.54, "synch_weights_time_ms": 65.175}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "3541f_00001", "date": "2024-08-03_03-24-49", "timestamp": 1722635689, "time_this_iter_s": 12.930325031280518, "time_total_s": 1091.4471917152405, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1091.4471917152405, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.261111111111113, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.78414279222488, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.036235753198465, "policy_loss": -0.01128131701067711, "vf_loss": 5.054918834070365, "vf_explained_var": 0.9715707631160816, "kl": 0.013090177002929219, "entropy": 1.6237636735041936, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -24.461722172737637, "episode_reward_min": -1383.0046958236383, "episode_reward_mean": -674.131678387671, "episode_len_mean": 132.65, "episode_media": {}, "episodes_timesteps_total": 13265, "policy_reward_min": {"policy_0": -1383.0046958236383}, "policy_reward_max": {"policy_0": -24.461722172737637}, "policy_reward_mean": {"policy_0": -674.131678387671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 100, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 106, 88, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 139, 150, 150, 99, 150, 150, 66, 150, 150, 114, 71, 150, 150, 150, 150, 104, 150, 150, 150, 84, 91, 127, 113, 90, 150, 76, 117, 99, 150, 150, 90, 105, 150, 46, 73, 150, 150, 150, 150, 150, 150, 150, 75, 150, 92, 150, 70, 150, 150, 150, 150, 100, 150, 150], "policy_policy_0_reward": [-1383.0046958236383, -1097.9332792629348, -804.7589859313326, -802.2974160827893, -963.2851202412014, -1156.3506161556772, -568.3057138779841, -151.8167993028869, -273.7234354656676, -939.1196914457628, -1112.0583908255235, -899.9348034329969, -872.3975801685541, -741.7932671948638, -1161.2693868070344, -577.2343035982854, -401.1659245846039, -952.1077156690922, -969.8246212456712, -1309.7051520151415, -791.4997539986392, -1234.898764735628, -24.461722172737637, -467.1270006378017, -650.0068055747379, -453.31753390202164, -161.0981042382155, -741.3373699541592, -1065.3272405961293, -500.2845510747124, -204.60325262312796, -1151.025703452321, -1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552058310873158, "mean_inference_ms": 1.699307515337646, "mean_action_processing_ms": 0.27633643536116653, "mean_env_wait_ms": 3.05997638313389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01163482666015625, "StateBufferConnector_ms": 0.007929086685180664, "ViewRequirementAgentConnector_ms": 0.1959221363067627}, "num_episodes": 34, "episode_return_max": -24.461722172737637, "episode_return_min": -1383.0046958236383, "episode_return_mean": -674.131678387671, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4764408585565, "num_env_steps_trained_throughput_per_sec": 315.4764408585565, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 12039.019, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12038.946, "sample_time_ms": 1058.547, "learn_time_ms": 10912.824, "learn_throughput": 366.541, "synch_weights_time_ms": 66.752}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "3541f_00001", "date": "2024-08-03_03-25-01", "timestamp": 1722635701, "time_this_iter_s": 12.69167423248291, "time_total_s": 1104.1388659477234, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1104.1388659477234, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.36111111111111, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 268.0764874060949, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.633038735389709, "policy_loss": -0.005144061312603298, "vf_loss": 4.645901512851318, "vf_explained_var": 0.9783653103436033, "kl": 0.013400568301191693, "entropy": 1.6764112864931424, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": -33.70204339184286, "episode_reward_min": -1380.3212133150644, "episode_reward_mean": -625.9085955802525, "episode_len_mean": 129.33, "episode_media": {}, "episodes_timesteps_total": 12933, "policy_reward_min": {"policy_0": -1380.3212133150644}, "policy_reward_max": {"policy_0": -33.70204339184286}, "policy_reward_mean": {"policy_0": -625.9085955802525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 139, 150, 150, 99, 150, 150, 66, 150, 150, 114, 71, 150, 150, 150, 150, 104, 150, 150, 150, 84, 91, 127, 113, 90, 150, 76, 117, 99, 150, 150, 90, 105, 150, 46, 73, 150, 150, 150, 150, 150, 150, 150, 75, 150, 92, 150, 70, 150, 150, 150, 150, 100, 150, 150, 150, 83, 129, 150, 150, 150, 71, 150, 150, 150, 53, 150, 70, 150, 137, 150, 67, 150, 150, 150, 72, 150, 150, 150, 66, 137, 119, 150, 80, 134, 146, 150], "policy_policy_0_reward": [-1181.1125514347073, -734.7944939014869, -505.05910127949136, -926.7082636692991, -1133.5482194462074, -879.9244501395923, -833.6308161894951, -1063.1712096175756, -883.680285273766, -620.8768473801119, -761.9623829818811, -279.75751217748945, -1111.925849444749, -1314.284332393509, -388.8747775137841, -878.2963781225475, -850.1782230017352, -401.7890465399411, -518.6367400710111, -1118.4603847397843, -188.91409709617224, -666.4983336795711, -786.5398054674436, -365.6272976103123, -59.68906933207405, -610.3519099277687, -598.8713234464458, -678.0918660708154, -759.4167154004864, -389.7744393368944, -1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521290307283215, "mean_inference_ms": 1.6998725509975159, "mean_action_processing_ms": 0.27650889045541666, "mean_env_wait_ms": 3.0626413096465734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011735200881958008, "StateBufferConnector_ms": 0.007862329483032227, "ViewRequirementAgentConnector_ms": 0.19077348709106445}, "num_episodes": 32, "episode_return_max": -33.70204339184286, "episode_return_min": -1380.3212133150644, "episode_return_mean": -625.9085955802525, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5058659719805, "num_env_steps_trained_throughput_per_sec": 310.5058659719805, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 12009.875, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12009.803, "sample_time_ms": 1062.491, "learn_time_ms": 10881.74, "learn_throughput": 367.588, "synch_weights_time_ms": 64.759}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "3541f_00001", "date": "2024-08-03_03-25-14", "timestamp": 1722635714, "time_this_iter_s": 12.893663883209229, "time_total_s": 1117.0325298309326, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1117.0325298309326, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.455555555555556, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 239.57374392350513, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.042492036769787, "policy_loss": -0.015182484776111475, "vf_loss": 5.064705041795969, "vf_explained_var": 0.9605935843040546, "kl": 0.013298967352799762, "entropy": 1.6007324988643328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -20.679755047782898, "episode_reward_min": -1380.3212133150644, "episode_reward_mean": -601.6030726736882, "episode_len_mean": 127.27, "episode_media": {}, "episodes_timesteps_total": 12727, "policy_reward_min": {"policy_0": -1380.3212133150644}, "policy_reward_max": {"policy_0": -20.679755047782898}, "policy_reward_mean": {"policy_0": -601.6030726736882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554], "episode_lengths": [150, 150, 150, 84, 91, 127, 113, 90, 150, 76, 117, 99, 150, 150, 90, 105, 150, 46, 73, 150, 150, 150, 150, 150, 150, 150, 75, 150, 92, 150, 70, 150, 150, 150, 150, 100, 150, 150, 150, 83, 129, 150, 150, 150, 71, 150, 150, 150, 53, 150, 70, 150, 137, 150, 67, 150, 150, 150, 72, 150, 150, 150, 66, 137, 119, 150, 80, 134, 146, 150, 150, 150, 128, 94, 93, 150, 150, 150, 84, 150, 150, 150, 150, 128, 104, 150, 150, 150, 150, 150, 46, 150, 145, 101, 150, 90, 148, 150, 85, 119], "policy_policy_0_reward": [-1082.9921990110256, -361.0469721673561, -806.9551912436445, -127.98490055999122, -79.01565455809812, -631.7224076564347, -324.4676207322015, -190.93711241393433, -1050.1798412069245, -161.67795172619782, -418.47173272241184, -230.01041841428057, -411.0654747030171, -606.7507892538868, -117.71862486261736, -449.4534712945384, -689.886240143202, -33.70204339184286, -209.82112775929127, -799.8936369825749, -708.8032012451564, -873.6894152384855, -716.4606150306734, -729.1972287181911, -911.0525894094716, -696.2508722453327, -70.99953097868345, -712.752259703737, -154.28817910265556, -838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552038973325019, "mean_inference_ms": 1.6993487671463936, "mean_action_processing_ms": 0.27649940266256506, "mean_env_wait_ms": 3.061557962499046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011574029922485352, "StateBufferConnector_ms": 0.0076007843017578125, "ViewRequirementAgentConnector_ms": 0.1879866123199463}, "num_episodes": 30, "episode_return_max": -20.679755047782898, "episode_return_min": -1380.3212133150644, "episode_return_mean": -601.6030726736882, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.0269089389143, "num_env_steps_trained_throughput_per_sec": 316.0269089389143, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 11960.042, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11959.969, "sample_time_ms": 1058.374, "learn_time_ms": 10836.299, "learn_throughput": 369.13, "synch_weights_time_ms": 64.478}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "3541f_00001", "date": "2024-08-03_03-25-27", "timestamp": 1722635727, "time_this_iter_s": 12.669220924377441, "time_total_s": 1129.70175075531, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467f07bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1129.70175075531, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.005263157894735, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.97975603938102, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.318647348384062, "policy_loss": -0.016825247939656642, "vf_loss": 5.3414060264825824, "vf_explained_var": 0.9641849306722482, "kl": 0.016010120747644883, "entropy": 1.674024978776773, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": -20.679755047782898, "episode_reward_min": -1437.4187122644832, "episode_reward_mean": -637.8846053698611, "episode_len_mean": 128.59, "episode_media": {}, "episodes_timesteps_total": 12859, "policy_reward_min": {"policy_0": -1437.4187122644832}, "policy_reward_max": {"policy_0": -20.679755047782898}, "policy_reward_mean": {"policy_0": -637.8846053698611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297], "episode_lengths": [150, 70, 150, 150, 150, 150, 100, 150, 150, 150, 83, 129, 150, 150, 150, 71, 150, 150, 150, 53, 150, 70, 150, 137, 150, 67, 150, 150, 150, 72, 150, 150, 150, 66, 137, 119, 150, 80, 134, 146, 150, 150, 150, 128, 94, 93, 150, 150, 150, 84, 150, 150, 150, 150, 128, 104, 150, 150, 150, 150, 150, 46, 150, 145, 101, 150, 90, 148, 150, 85, 119, 150, 52, 96, 150, 150, 81, 63, 130, 150, 150, 150, 150, 141, 150, 150, 150, 64, 150, 109, 150, 67, 95, 150, 150, 150, 62, 150, 150, 150], "policy_policy_0_reward": [-838.9665171737759, -135.0128275848434, -1011.9628123686145, -1105.295758700716, -824.3779575957475, -971.6955249441409, -329.65286465098274, -774.407573307861, -991.0272751865426, -973.1818419883712, -135.0329989993158, -380.35307310557187, -1139.161064556479, -718.7596768757619, -800.6268683591886, -238.0745178403793, -1235.5365066700215, -707.1286808188787, -690.0942720394625, -109.4595560588234, -1036.6272854881665, -95.89529846844339, -707.3947914735107, -541.1155451457079, -516.7547789811675, -192.86095737742963, -748.6943326590846, -765.735336359685, -1052.9786098555603, -96.61624230417907, -1152.1832789536606, -862.4607268880021, -1380.3212133150644, -37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517586571672789, "mean_inference_ms": 1.69834723090339, "mean_action_processing_ms": 0.27617827725631033, "mean_env_wait_ms": 3.059657112959974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011745452880859375, "StateBufferConnector_ms": 0.00782465934753418, "ViewRequirementAgentConnector_ms": 0.1903986930847168}, "num_episodes": 29, "episode_return_max": -20.679755047782898, "episode_return_min": -1437.4187122644832, "episode_return_mean": -637.8846053698611, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.3001820350527, "num_env_steps_trained_throughput_per_sec": 307.3001820350527, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 12301.871, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12301.792, "sample_time_ms": 1055.061, "learn_time_ms": 11180.237, "learn_throughput": 357.774, "synch_weights_time_ms": 65.669}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "3541f_00001", "date": "2024-08-03_03-25-40", "timestamp": 1722635740, "time_this_iter_s": 13.029745101928711, "time_total_s": 1142.7314958572388, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1142.7314958572388, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.46666666666667, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.2812040189902, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.751461728910605, "policy_loss": -0.011991771085498234, "vf_loss": 4.773827402045329, "vf_explained_var": 0.9869905351971586, "kl": 0.01226879600344546, "entropy": 1.8655336676786343, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": -20.679755047782898, "episode_reward_min": -1437.4187122644832, "episode_reward_mean": -611.9646518642362, "episode_len_mean": 128.53, "episode_media": {}, "episodes_timesteps_total": 12853, "policy_reward_min": {"policy_0": -1437.4187122644832}, "policy_reward_max": {"policy_0": -20.679755047782898}, "policy_reward_mean": {"policy_0": -611.9646518642362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936], "episode_lengths": [66, 137, 119, 150, 80, 134, 146, 150, 150, 150, 128, 94, 93, 150, 150, 150, 84, 150, 150, 150, 150, 128, 104, 150, 150, 150, 150, 150, 46, 150, 145, 101, 150, 90, 148, 150, 85, 119, 150, 52, 96, 150, 150, 81, 63, 130, 150, 150, 150, 150, 141, 150, 150, 150, 64, 150, 109, 150, 67, 95, 150, 150, 150, 62, 150, 150, 150, 150, 60, 68, 150, 150, 81, 91, 150, 89, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 56, 75, 127, 150, 150, 150, 126], "policy_policy_0_reward": [-37.787781207809665, -429.95018902511146, -311.33520389379987, -635.7705611109262, -196.72474762682134, -781.4711655629984, -470.24329943635337, -620.4360189042703, -1009.5008826987087, -1354.8001895082107, -276.0726172071231, -256.2649602089075, -233.33698048268178, -1288.2592907032115, -1090.4521921307662, -367.7479328908283, -180.5072612707358, -457.44468012485396, -1120.225856776145, -914.0671789221624, -1148.6034910442386, -549.3479461363632, -351.0577293129169, -562.3026810285796, -811.7471865467439, -677.0123089788265, -1172.6642940539723, -782.3314173306383, -20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519753215206623, "mean_inference_ms": 1.6983125477218939, "mean_action_processing_ms": 0.27624521117093537, "mean_env_wait_ms": 3.05997740450454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011878728866577148, "StateBufferConnector_ms": 0.007979393005371094, "ViewRequirementAgentConnector_ms": 0.19379210472106934}, "num_episodes": 33, "episode_return_max": -20.679755047782898, "episode_return_min": -1437.4187122644832, "episode_return_mean": -611.9646518642362, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.7279612996758, "num_env_steps_trained_throughput_per_sec": 300.7279612996758, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 12435.925, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12435.844, "sample_time_ms": 1055.997, "learn_time_ms": 11314.414, "learn_throughput": 353.531, "synch_weights_time_ms": 64.644}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "3541f_00001", "date": "2024-08-03_03-25-54", "timestamp": 1722635754, "time_this_iter_s": 13.313366413116455, "time_total_s": 1156.0448622703552, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415f7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1156.0448622703552, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 17.01578947368421, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.5894056558609, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.159938221424818, "policy_loss": -0.007042107308613292, "vf_loss": 5.171137396246195, "vf_explained_var": 0.9601514651129643, "kl": 0.016964285803866695, "entropy": 1.5607970443243782, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -20.679755047782898, "episode_reward_min": -1437.4187122644832, "episode_reward_mean": -599.7263202401778, "episode_len_mean": 128.66, "episode_media": {}, "episodes_timesteps_total": 12866, "policy_reward_min": {"policy_0": -1437.4187122644832}, "policy_reward_max": {"policy_0": -20.679755047782898}, "policy_reward_mean": {"policy_0": -599.7263202401778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558], "episode_lengths": [46, 150, 145, 101, 150, 90, 148, 150, 85, 119, 150, 52, 96, 150, 150, 81, 63, 130, 150, 150, 150, 150, 141, 150, 150, 150, 64, 150, 109, 150, 67, 95, 150, 150, 150, 62, 150, 150, 150, 150, 60, 68, 150, 150, 81, 91, 150, 89, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 56, 75, 127, 150, 150, 150, 126, 150, 49, 150, 150, 150, 150, 84, 111, 144, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 139, 150, 150, 92, 150, 85, 77, 107, 150], "policy_policy_0_reward": [-20.679755047782898, -750.9342697257124, -585.4010554962152, -206.68762013842294, -528.2643158920497, -118.62571358050832, -855.3362661616642, -816.2141735316213, -110.91620803745975, -463.08797706168554, -894.0226385290836, -32.24774737151469, -270.65816796593003, -657.1044977920828, -1156.206515223934, -172.3698161333205, -99.96763177023239, -596.172174878676, -766.9952311182195, -732.8728879273115, -611.0729820750528, -557.7934861294245, -823.4448907384243, -1005.2683493234996, -1001.4662727382276, -1255.9477201081256, -171.03978320925782, -1437.4187122644832, -215.75793441964166, -652.8550111442145, -179.87686686385993, -179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517967884471027, "mean_inference_ms": 1.6975707393775425, "mean_action_processing_ms": 0.2762316306704787, "mean_env_wait_ms": 3.0591735994749034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012076854705810547, "StateBufferConnector_ms": 0.008115768432617188, "ViewRequirementAgentConnector_ms": 0.20175790786743164}, "num_episodes": 28, "episode_return_max": -20.679755047782898, "episode_return_min": -1437.4187122644832, "episode_return_mean": -599.7263202401778, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.5643544283077, "num_env_steps_trained_throughput_per_sec": 327.5643544283077, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 12386.064, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12385.982, "sample_time_ms": 1055.792, "learn_time_ms": 11264.447, "learn_throughput": 355.1, "synch_weights_time_ms": 64.957}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "3541f_00001", "date": "2024-08-03_03-26-06", "timestamp": 1722635766, "time_this_iter_s": 12.223428010940552, "time_total_s": 1168.2682902812958, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d412b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1168.2682902812958, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.43333333333333, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 300.63418987194694, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.814080456644296, "policy_loss": -0.0068971175380283965, "vf_loss": 4.829148258765539, "vf_explained_var": 0.9759978905941049, "kl": 0.014741364278173326, "entropy": 1.8121101666241883, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": -48.935142636302075, "episode_reward_min": -1271.9009109826766, "episode_reward_mean": -622.2122468675647, "episode_len_mean": 132.64, "episode_media": {}, "episodes_timesteps_total": 13264, "policy_reward_min": {"policy_0": -1271.9009109826766}, "policy_reward_max": {"policy_0": -48.935142636302075}, "policy_reward_mean": {"policy_0": -622.2122468675647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767], "episode_lengths": [95, 150, 150, 150, 62, 150, 150, 150, 150, 60, 68, 150, 150, 81, 91, 150, 89, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 56, 75, 127, 150, 150, 150, 126, 150, 49, 150, 150, 150, 150, 84, 111, 144, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 139, 150, 150, 92, 150, 85, 77, 107, 150, 150, 60, 150, 150, 150, 86, 150, 150, 150, 119, 150, 107, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 139, 108, 119, 80, 150, 150, 150], "policy_policy_0_reward": [-179.98478120846508, -926.1486996612873, -798.2569880018098, -393.6638829060533, -143.39025605388554, -708.4811423199538, -552.4151078086414, -992.5003964085297, -820.0670441003599, -119.87610837664245, -121.44396996742084, -1203.0751127804492, -1188.6358308360916, -165.80413158104986, -135.5507899847688, -1084.1967873445292, -194.11195254492785, -291.73212020910046, -674.8505295710963, -1067.8854687336586, -829.2302032579323, -760.0651674506354, -1011.3400408599056, -600.3128940410469, -534.0892720851157, -364.27096753876623, -489.4268362113391, -682.3406532652998, -786.5196652942816, -365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519400571636909, "mean_inference_ms": 1.697529697254285, "mean_action_processing_ms": 0.2761469767973751, "mean_env_wait_ms": 3.059865373256497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012095451354980469, "StateBufferConnector_ms": 0.008144378662109375, "ViewRequirementAgentConnector_ms": 0.20415568351745605}, "num_episodes": 31, "episode_return_max": -48.935142636302075, "episode_return_min": -1271.9009109826766, "episode_return_mean": -622.2122468675647, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.29747886433455, "num_env_steps_trained_throughput_per_sec": 480.29747886433455, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 11895.024, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11894.944, "sample_time_ms": 1054.251, "learn_time_ms": 10777.228, "learn_throughput": 371.153, "synch_weights_time_ms": 62.687}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "3541f_00001", "date": "2024-08-03_03-26-14", "timestamp": 1722635774, "time_this_iter_s": 8.341018915176392, "time_total_s": 1176.6093091964722, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415dfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1176.6093091964722, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 21.745454545454546, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 323.91197949647903, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.757577816148599, "policy_loss": -0.004341121967687892, "vf_loss": 4.768151875336965, "vf_explained_var": 0.975494690798223, "kl": 0.016611329867494924, "entropy": 1.7445591998596985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": -48.935142636302075, "episode_reward_min": -1332.9928680953542, "episode_reward_mean": -652.6755988035254, "episode_len_mean": 134.16, "episode_media": {}, "episodes_timesteps_total": 13416, "policy_reward_min": {"policy_0": -1332.9928680953542}, "policy_reward_max": {"policy_0": -48.935142636302075}, "policy_reward_mean": {"policy_0": -652.6755988035254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143], "episode_lengths": [136, 150, 150, 150, 150, 56, 75, 127, 150, 150, 150, 126, 150, 49, 150, 150, 150, 150, 84, 111, 144, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 139, 150, 150, 92, 150, 85, 77, 107, 150, 150, 60, 150, 150, 150, 86, 150, 150, 150, 119, 150, 107, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 139, 108, 119, 80, 150, 150, 150, 150, 150, 150, 150, 119, 141, 150, 150, 142, 150, 150, 150, 61, 150, 150, 150, 114, 79, 150, 83, 150, 150, 150, 150, 150, 150, 150, 46, 150], "policy_policy_0_reward": [-365.130779135492, -851.5328598980882, -798.0447383380875, -1085.9615450071503, -376.69224295022116, -122.19246079944294, -159.52579964224725, -448.4363302209829, -871.7005791993819, -1079.101817829585, -972.4183762185062, -411.88814025905936, -1147.1738050353981, -48.935142636302075, -653.2571139529526, -831.0821666783846, -539.2916598088158, -771.2430714382838, -104.57725108357342, -295.19009831414763, -451.23129587447903, -871.124879161092, -368.189800708834, -617.4875998062267, -745.0935703764856, -847.1899579948623, -583.7160920373068, -665.808171462962, -1228.6577789592102, -1211.7525939118198, -790.7013050965664, -687.1786887438614, -406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515262171000296, "mean_inference_ms": 1.6964421154794433, "mean_action_processing_ms": 0.2760536001392067, "mean_env_wait_ms": 3.057560806098034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012237548828125, "StateBufferConnector_ms": 0.008125782012939453, "ViewRequirementAgentConnector_ms": 0.20159697532653809}, "num_episodes": 29, "episode_return_max": -48.935142636302075, "episode_return_min": -1332.9928680953542, "episode_return_mean": -652.6755988035254, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.09415061267447, "num_env_steps_trained_throughput_per_sec": 309.09415061267447, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 12418.175, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12418.097, "sample_time_ms": 1054.055, "learn_time_ms": 11300.987, "learn_throughput": 353.951, "synch_weights_time_ms": 62.296}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "3541f_00001", "date": "2024-08-03_03-26-27", "timestamp": 1722635787, "time_this_iter_s": 12.954027891159058, "time_total_s": 1189.5633370876312, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415f7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1189.5633370876312, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 16.99473684210526, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.25749947230022, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.187503867099682, "policy_loss": -0.013753071862932604, "vf_loss": 5.207691998531421, "vf_explained_var": 0.9709157465025783, "kl": 0.01444651390135429, "entropy": 1.6186462004979452, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -70.46589564054838, "episode_reward_min": -1375.6137653633066, "episode_reward_mean": -639.7655027001717, "episode_len_mean": 133.46, "episode_media": {}, "episodes_timesteps_total": 13346, "policy_reward_min": {"policy_0": -1375.6137653633066}, "policy_reward_max": {"policy_0": -70.46589564054838}, "policy_reward_mean": {"policy_0": -639.7655027001717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307], "episode_lengths": [150, 150, 92, 150, 85, 77, 107, 150, 150, 60, 150, 150, 150, 86, 150, 150, 150, 119, 150, 107, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 139, 108, 119, 80, 150, 150, 150, 150, 150, 150, 150, 119, 141, 150, 150, 142, 150, 150, 150, 61, 150, 150, 150, 114, 79, 150, 83, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 70, 68, 100, 150, 150, 150, 150, 150, 150, 101, 150, 101, 150, 150, 47, 150, 150, 150, 122, 150, 150, 96, 150, 150, 150, 110, 150, 150], "policy_policy_0_reward": [-406.2590664905942, -684.823810191716, -309.54659311443254, -809.7717923464097, -145.05705242527125, -207.90095471207232, -349.9455570636401, -491.4460122931558, -965.2645596260963, -176.84770889794197, -739.9163928971279, -474.5940296079232, -467.2374961232958, -254.0340194243403, -724.8525662449447, -651.2466637069011, -650.0054377725553, -318.2501943737151, -936.7337240186174, -382.5219550943262, -515.1224657515778, -993.6366139266678, -730.8178550614316, -939.640532590352, -1271.9009109826766, -438.71094100329714, -143.53524586433196, -1045.5658188700447, -466.00814773174017, -1092.6766498510087, -575.1513340967485, -759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518278754106897, "mean_inference_ms": 1.6970312831020202, "mean_action_processing_ms": 0.27622534576606317, "mean_env_wait_ms": 3.058125842258698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012204647064208984, "StateBufferConnector_ms": 0.008056640625, "ViewRequirementAgentConnector_ms": 0.196563720703125}, "num_episodes": 32, "episode_return_max": -70.46589564054838, "episode_return_min": -1375.6137653633066, "episode_return_mean": -639.7655027001717, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.19381141268894, "num_env_steps_trained_throughput_per_sec": 310.19381141268894, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 12382.954, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12382.876, "sample_time_ms": 1043.352, "learn_time_ms": 11277.173, "learn_throughput": 354.699, "synch_weights_time_ms": 61.59}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "3541f_00001", "date": "2024-08-03_03-26-40", "timestamp": 1722635800, "time_this_iter_s": 12.906872272491455, "time_total_s": 1202.4702093601227, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1202.4702093601227, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.416666666666668, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 298.9122982700666, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.888693497081598, "policy_loss": -0.012665829043544363, "vf_loss": 4.907762337227663, "vf_explained_var": 0.9751419181625048, "kl": 0.015043240954946753, "entropy": 1.6557216972112656, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": -16.360686236368, "episode_reward_min": -1375.6137653633066, "episode_reward_mean": -663.0302228614612, "episode_len_mean": 132.27, "episode_media": {}, "episodes_timesteps_total": 13227, "policy_reward_min": {"policy_0": -1375.6137653633066}, "policy_reward_max": {"policy_0": -16.360686236368}, "policy_reward_mean": {"policy_0": -663.0302228614612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718], "episode_lengths": [150, 139, 108, 119, 80, 150, 150, 150, 150, 150, 150, 150, 119, 141, 150, 150, 142, 150, 150, 150, 61, 150, 150, 150, 114, 79, 150, 83, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 70, 68, 100, 150, 150, 150, 150, 150, 150, 101, 150, 101, 150, 150, 47, 150, 150, 150, 122, 150, 150, 96, 150, 150, 150, 110, 150, 150, 150, 74, 106, 150, 150, 150, 150, 150, 150, 56, 94, 150, 67, 150, 150, 150, 150, 150, 52, 150, 91, 114, 150, 150, 94, 83, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-759.3206030895616, -439.5824740595314, -539.0395798999459, -538.6195143993142, -226.0366527098426, -436.9409545073157, -839.0913201005649, -1262.3969728525767, -1144.7496117478045, -805.0196317572284, -703.4392561985849, -1119.5894666408458, -191.76296354556393, -738.8571493444082, -620.7596165301873, -904.3849458709475, -578.3797818252227, -918.4503465260493, -1312.9947670776482, -888.2943974788553, -75.67704828738185, -898.7587709980241, -884.3121151829201, -631.5917214081876, -510.368762335818, -258.7772253674501, -1332.9928680953542, -147.91382949677043, -396.2736899369477, -1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519713640273705, "mean_inference_ms": 1.6969335213403451, "mean_action_processing_ms": 0.2761600096812491, "mean_env_wait_ms": 3.0585932993631504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012370824813842773, "StateBufferConnector_ms": 0.008154630661010742, "ViewRequirementAgentConnector_ms": 0.1977863311767578}, "num_episodes": 31, "episode_return_max": -16.360686236368, "episode_return_min": -1375.6137653633066, "episode_return_mean": -663.0302228614612, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.65889556105026, "num_env_steps_trained_throughput_per_sec": 308.65889556105026, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 12387.138, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12387.059, "sample_time_ms": 1043.489, "learn_time_ms": 11283.588, "learn_throughput": 354.497, "synch_weights_time_ms": 59.228}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "3541f_00001", "date": "2024-08-03_03-26-53", "timestamp": 1722635813, "time_this_iter_s": 12.971515655517578, "time_total_s": 1215.4417250156403, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aafad1b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1215.4417250156403, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.057894736842105, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 266.07482703328134, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.846757808079322, "policy_loss": -0.015812594110805853, "vf_loss": 4.870155938963095, "vf_explained_var": 0.9805120299259822, "kl": 0.014661992762133579, "entropy": 1.748238801335295, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": -16.360686236368, "episode_reward_min": -1494.4084109923963, "episode_reward_mean": -640.9654177504675, "episode_len_mean": 130.81, "episode_media": {}, "episodes_timesteps_total": 13081, "policy_reward_min": {"policy_0": -1494.4084109923963}, "policy_reward_max": {"policy_0": -16.360686236368}, "policy_reward_mean": {"policy_0": -640.9654177504675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752], "episode_lengths": [150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 70, 68, 100, 150, 150, 150, 150, 150, 150, 101, 150, 101, 150, 150, 47, 150, 150, 150, 122, 150, 150, 96, 150, 150, 150, 110, 150, 150, 150, 74, 106, 150, 150, 150, 150, 150, 150, 56, 94, 150, 67, 150, 150, 150, 150, 150, 52, 150, 91, 114, 150, 150, 94, 83, 150, 150, 150, 150, 150, 150, 85, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 145, 50, 150, 150, 150, 150, 150, 150, 87, 150, 77, 69, 83, 150, 69, 150, 150], "policy_policy_0_reward": [-1062.3998239425414, -1013.0179186174668, -689.3356069217493, -505.8941291740454, -1057.4745270681544, -669.38428244194, -72.28998371212522, -732.8577564689143, -1375.6137653633066, -526.8856894544921, -780.2933174652815, -908.1832791675972, -195.3876438171642, -70.46589564054838, -186.12747891970852, -598.9537837502221, -464.98406108110834, -810.0061901879086, -586.3761630789195, -853.6095638199048, -1063.0359369759074, -498.5333861713475, -778.093147371551, -302.10928322220155, -896.4524458828325, -1014.4757565169944, -108.81725406879795, -746.7496626880247, -378.3395964322974, -813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552161796640211, "mean_inference_ms": 1.6970504709355578, "mean_action_processing_ms": 0.27617248360389957, "mean_env_wait_ms": 3.0604204794457512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012475728988647461, "StateBufferConnector_ms": 0.008099079132080078, "ViewRequirementAgentConnector_ms": 0.1989421844482422}, "num_episodes": 29, "episode_return_max": -16.360686236368, "episode_return_min": -1494.4084109923963, "episode_return_mean": -640.9654177504675, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.55882540166016, "num_env_steps_trained_throughput_per_sec": 309.55882540166016, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 12411.375, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12411.297, "sample_time_ms": 1042.44, "learn_time_ms": 11310.289, "learn_throughput": 353.66, "synch_weights_time_ms": 57.832}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "3541f_00001", "date": "2024-08-03_03-27-06", "timestamp": 1722635826, "time_this_iter_s": 12.935009241104126, "time_total_s": 1228.3767342567444, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6c700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1228.3767342567444, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.444444444444443, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 285.7356690188249, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.650534381965796, "policy_loss": -0.007812925628483451, "vf_loss": 4.663177755723397, "vf_explained_var": 0.9847925293569764, "kl": 0.018369948236977508, "entropy": 1.7230169673760731, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": -16.360686236368, "episode_reward_min": -1494.4084109923963, "episode_reward_mean": -646.0078114127481, "episode_len_mean": 131.02, "episode_media": {}, "episodes_timesteps_total": 13102, "policy_reward_min": {"policy_0": -1494.4084109923963}, "policy_reward_max": {"policy_0": -16.360686236368}, "policy_reward_mean": {"policy_0": -646.0078114127481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752, -1113.3241419234548, -413.51325846113645, -649.0853630527089, -1192.779282878758, -643.9503631024395, -734.3947218912332, -17.06843077240044, -854.7837296528405, -926.9169117957573, -424.791443908049, -99.95423132679637, -527.2990362280889, -616.0414545441721, -675.6516883832226, -1260.2846298487416, -590.4995499167804, -742.6586780220427, -191.45550854620723, -608.6320330192427, -88.32728418194408, -484.8506225844304, -733.5938254739108, -115.33094712886034, -1037.174044330078, -1246.906729350644, -1262.150310920415, -1128.891192914274, -254.37789400964394, -815.6993874828395], "episode_lengths": [150, 122, 150, 150, 96, 150, 150, 150, 110, 150, 150, 150, 74, 106, 150, 150, 150, 150, 150, 150, 56, 94, 150, 67, 150, 150, 150, 150, 150, 52, 150, 91, 114, 150, 150, 94, 83, 150, 150, 150, 150, 150, 150, 85, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 145, 50, 150, 150, 150, 150, 150, 150, 87, 150, 77, 69, 83, 150, 69, 150, 150, 150, 150, 150, 150, 131, 150, 49, 150, 150, 150, 61, 120, 150, 150, 150, 150, 150, 107, 150, 67, 150, 150, 77, 150, 150, 150, 150, 92, 150], "policy_policy_0_reward": [-813.4899927874009, -258.8713536395466, -1218.5978137878892, -690.2247035911242, -347.63280861669995, -763.1577693231668, -606.1860139782784, -516.3466443520692, -269.1018341395806, -573.2681777947184, -510.12768915784307, -663.5057416072648, -36.44336775618839, -483.024532308931, -824.0348135184456, -712.3712420397392, -909.9684912068724, -1064.4412595999634, -1066.2771801939118, -1209.8337107141326, -91.40779827988649, -234.57503953753903, -635.3771541593604, -89.91546349899782, -795.655923708588, -620.7263538918869, -868.1073325083547, -779.1445311110529, -769.1765127199933, -16.360686236368, -1143.4563924593772, -141.36080246775256, -212.51477891409942, -975.3838887011048, -1150.7024695482432, -304.43044799100153, -155.47803243517288, -1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752, -1113.3241419234548, -413.51325846113645, -649.0853630527089, -1192.779282878758, -643.9503631024395, -734.3947218912332, -17.06843077240044, -854.7837296528405, -926.9169117957573, -424.791443908049, -99.95423132679637, -527.2990362280889, -616.0414545441721, -675.6516883832226, -1260.2846298487416, -590.4995499167804, -742.6586780220427, -191.45550854620723, -608.6320330192427, -88.32728418194408, -484.8506225844304, -733.5938254739108, -115.33094712886034, -1037.174044330078, -1246.906729350644, -1262.150310920415, -1128.891192914274, -254.37789400964394, -815.6993874828395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520534627640789, "mean_inference_ms": 1.696101082790548, "mean_action_processing_ms": 0.27597933005032393, "mean_env_wait_ms": 3.0606645055335093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012224912643432617, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1959850788116455}, "num_episodes": 29, "episode_return_max": -16.360686236368, "episode_return_min": -1494.4084109923963, "episode_return_mean": -646.0078114127481, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.22514359021665, "num_env_steps_trained_throughput_per_sec": 300.22514359021665, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 12455.488, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12455.41, "sample_time_ms": 1040.267, "learn_time_ms": 11356.096, "learn_throughput": 352.234, "synch_weights_time_ms": 58.303}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "3541f_00001", "date": "2024-08-03_03-27-19", "timestamp": 1722635839, "time_this_iter_s": 13.33552622795105, "time_total_s": 1241.7122604846954, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467aaf6f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.7122604846954, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.178947368421053, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.74266090393067, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.3601740809778375, "policy_loss": -0.0011321365760522894, "vf_loss": 5.3653654972712195, "vf_explained_var": 0.9597402038052678, "kl": 0.013862135602194788, "entropy": 1.341622021732231, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": -17.06843077240044, "episode_reward_min": -1494.4084109923963, "episode_reward_mean": -616.9028125024422, "episode_len_mean": 126.34, "episode_media": {}, "episodes_timesteps_total": 12634, "policy_reward_min": {"policy_0": -1494.4084109923963}, "policy_reward_max": {"policy_0": -17.06843077240044}, "policy_reward_mean": {"policy_0": -616.9028125024422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752, -1113.3241419234548, -413.51325846113645, -649.0853630527089, -1192.779282878758, -643.9503631024395, -734.3947218912332, -17.06843077240044, -854.7837296528405, -926.9169117957573, -424.791443908049, -99.95423132679637, -527.2990362280889, -616.0414545441721, -675.6516883832226, -1260.2846298487416, -590.4995499167804, -742.6586780220427, -191.45550854620723, -608.6320330192427, -88.32728418194408, -484.8506225844304, -733.5938254739108, -115.33094712886034, -1037.174044330078, -1246.906729350644, -1262.150310920415, -1128.891192914274, -254.37789400964394, -815.6993874828395, -803.2138596705678, -85.85009289260861, -19.47817375774505, -926.7026522690294, -283.2154893765266, -613.3610679711023, -594.443497210576, -319.86843448772544, -917.9969781688603, -139.2111690605663, -874.3656740796888, -754.8304601763466, -1164.3103314538773, -22.9999422434812, -211.02919024726597, -203.55025471898074, -27.086131692181, -401.5619132211656, -517.1633929056013, -433.2056880383851, -230.9065467170487, -190.85900490956007, -974.7842993860642, -481.04969771335, -770.5243149770841, -420.0649386085615, -744.2671855170164, -78.1004860932513, -1156.8246227544937, -137.98742409489154, -122.87441782445447, -793.1558010590347, -732.5407296790631, -1119.042517804015, -495.79518824768195, -446.77635920400405, -1401.1809290200988], "episode_lengths": [150, 150, 150, 150, 150, 150, 85, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 145, 50, 150, 150, 150, 150, 150, 150, 87, 150, 77, 69, 83, 150, 69, 150, 150, 150, 150, 150, 150, 131, 150, 49, 150, 150, 150, 61, 120, 150, 150, 150, 150, 150, 107, 150, 67, 150, 150, 77, 150, 150, 150, 150, 92, 150, 150, 49, 53, 150, 133, 150, 150, 92, 150, 55, 150, 150, 150, 44, 80, 76, 44, 95, 123, 123, 74, 63, 150, 150, 150, 124, 146, 73, 150, 90, 54, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1059.435928591704, -638.412261078165, -997.3184456170343, -771.8281603733006, -1264.8253755094718, -695.1729434212446, -235.45955981457678, -806.9450233004709, -236.90146807769437, -850.0946846506994, -564.6468468265689, -801.7600052850684, -865.9917658555572, -459.3170711919677, -559.5235806015476, -355.41356517183215, -1206.0949350778199, -489.3157472710744, -96.26071331165998, -752.463692181188, -627.3868034969868, -731.0521357213233, -832.4026410671931, -727.2635928060168, -1013.7506426288991, -237.8206016616542, -1166.505424961333, -123.09876423299485, -123.01451980052414, -60.593818552271294, -1094.4682019202837, -43.15722622015626, -1494.4084109923963, -647.6111400704752, -1113.3241419234548, -413.51325846113645, -649.0853630527089, -1192.779282878758, -643.9503631024395, -734.3947218912332, -17.06843077240044, -854.7837296528405, -926.9169117957573, -424.791443908049, -99.95423132679637, -527.2990362280889, -616.0414545441721, -675.6516883832226, -1260.2846298487416, -590.4995499167804, -742.6586780220427, -191.45550854620723, -608.6320330192427, -88.32728418194408, -484.8506225844304, -733.5938254739108, -115.33094712886034, -1037.174044330078, -1246.906729350644, -1262.150310920415, -1128.891192914274, -254.37789400964394, -815.6993874828395, -803.2138596705678, -85.85009289260861, -19.47817375774505, -926.7026522690294, -283.2154893765266, -613.3610679711023, -594.443497210576, -319.86843448772544, -917.9969781688603, -139.2111690605663, -874.3656740796888, -754.8304601763466, -1164.3103314538773, -22.9999422434812, -211.02919024726597, -203.55025471898074, -27.086131692181, -401.5619132211656, -517.1633929056013, -433.2056880383851, -230.9065467170487, -190.85900490956007, -974.7842993860642, -481.04969771335, -770.5243149770841, -420.0649386085615, -744.2671855170164, -78.1004860932513, -1156.8246227544937, -137.98742409489154, -122.87441782445447, -793.1558010590347, -732.5407296790631, -1119.042517804015, -495.79518824768195, -446.77635920400405, -1401.1809290200988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520247686305209, "mean_inference_ms": 1.695887227437893, "mean_action_processing_ms": 0.27588421339201924, "mean_env_wait_ms": 3.0617364618185086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012269735336303711, "StateBufferConnector_ms": 0.007951498031616211, "ViewRequirementAgentConnector_ms": 0.1935579776763916}, "num_episodes": 37, "episode_return_max": -17.06843077240044, "episode_return_min": -1494.4084109923963, "episode_return_mean": -616.9028125024422, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0697099208466, "num_env_steps_trained_throughput_per_sec": 302.0697099208466, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 12513.971, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12513.894, "sample_time_ms": 1042.306, "learn_time_ms": 11413.262, "learn_throughput": 350.469, "synch_weights_time_ms": 57.59}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "3541f_00001", "date": "2024-08-03_03-27-33", "timestamp": 1722635853, "time_this_iter_s": 13.255611181259155, "time_total_s": 1254.9678716659546, "pid": 445487, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7467d415f760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1254.9678716659546, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.921052631578945, "ram_util_percent": 27.399999999999995}}
