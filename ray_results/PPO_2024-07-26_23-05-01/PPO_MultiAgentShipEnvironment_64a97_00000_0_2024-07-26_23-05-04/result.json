{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8657065755377213, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.652024629712106, "policy_loss": -0.005446694483301447, "vf_loss": 9.66979575753212, "vf_explained_var": 0.014657509016493956, "kl": 0.008938931373525824, "entropy": 1.4112245274086794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -34.76871866571267, "episode_reward_min": -1313.5990187743366, "episode_reward_mean": -796.8733826016905, "episode_len_mean": 134.21428571428572, "episode_media": {}, "episodes_timesteps_total": 3758, "policy_reward_min": {"policy_0": -1313.5990187743366}, "policy_reward_max": {"policy_0": -34.76871866571267}, "policy_reward_mean": {"policy_0": -796.8733826016905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117], "episode_lengths": [112, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 70, 150, 150, 35, 150, 88, 150], "policy_policy_0_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922248729775886, "mean_inference_ms": 0.9058061419099711, "mean_action_processing_ms": 0.1653033887211048, "mean_env_wait_ms": 2.087127966784699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360667092459542, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.09851625987461635}, "num_episodes": 28, "episode_return_max": -34.76871866571267, "episode_return_min": -1313.5990187743366, "episode_return_mean": -796.8733826016905, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.29630592166853, "num_env_steps_trained_throughput_per_sec": 297.29630592166853, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13454.602, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13454.539, "sample_time_ms": 2843.265, "learn_time_ms": 10592.898, "learn_throughput": 377.611, "synch_weights_time_ms": 17.632}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "64a97_00000", "date": "2024-07-26_23-05-30", "timestamp": 1722015330, "time_this_iter_s": 13.459088802337646, "time_total_s": 13.459088802337646, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0751d40dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.459088802337646, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.049999999999999, "ram_util_percent": 28.595000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.660639746238788, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.16578455666701, "policy_loss": -0.005087172704710004, "vf_loss": 9.183782458305359, "vf_explained_var": 0.01047639101743698, "kl": 0.009265463965493836, "entropy": 1.476383680353562, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -34.76871866571267, "episode_reward_min": -1313.5990187743366, "episode_reward_mean": -776.6398031742601, "episode_len_mean": 136.33928571428572, "episode_media": {}, "episodes_timesteps_total": 7635, "policy_reward_min": {"policy_0": -1313.5990187743366}, "policy_reward_max": {"policy_0": -34.76871866571267}, "policy_reward_mean": {"policy_0": -776.6398031742601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462], "episode_lengths": [112, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 70, 150, 150, 35, 150, 88, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 86, 150, 150, 94, 126, 150], "policy_policy_0_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2898016014918236, "mean_inference_ms": 0.8986537981740723, "mean_action_processing_ms": 0.1639930872542785, "mean_env_wait_ms": 2.0624506875168476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006261893681117466, "StateBufferConnector_ms": 0.004271524293082101, "ViewRequirementAgentConnector_ms": 0.09818204811641149}, "num_episodes": 28, "episode_return_max": -34.76871866571267, "episode_return_min": -1313.5990187743366, "episode_return_mean": -776.6398031742601, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.05455012357226, "num_env_steps_trained_throughput_per_sec": 306.05455012357226, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13262.09, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13262.022, "sample_time_ms": 2787.345, "learn_time_ms": 10456.737, "learn_throughput": 382.529, "synch_weights_time_ms": 17.156}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "64a97_00000", "date": "2024-07-26_23-05-43", "timestamp": 1722015343, "time_this_iter_s": 13.07600736618042, "time_total_s": 26.535096168518066, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087384c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.535096168518066, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.705555555555556, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5502491197859247, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.126541405419509, "policy_loss": -0.008150725572098358, "vf_loss": 9.14725800951322, "vf_explained_var": 0.06178381995608409, "kl": 0.013255536315925083, "entropy": 1.5216991648077964, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -34.76871866571267, "episode_reward_min": -1371.6458577646392, "episode_reward_mean": -750.7732697395136, "episode_len_mean": 137.23529411764707, "episode_media": {}, "episodes_timesteps_total": 11665, "policy_reward_min": {"policy_0": -1371.6458577646392}, "policy_reward_max": {"policy_0": -34.76871866571267}, "policy_reward_mean": {"policy_0": -750.7732697395136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752], "episode_lengths": [112, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 70, 150, 150, 35, 150, 88, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 86, 150, 150, 94, 126, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150], "policy_policy_0_reward": [-417.42590266696675, -1271.3621921916385, -766.8884804406665, -220.29321356772786, -1313.5990187743366, -867.4270609147896, -1128.1881814200274, -1069.2536395409597, -945.6276673165556, -592.7378316497922, -1013.1088403871706, -985.0610923509647, -853.7951424602917, -1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2889717554173879, "mean_inference_ms": 0.8984040125573584, "mean_action_processing_ms": 0.1637892309832705, "mean_env_wait_ms": 2.0542369276471244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005872670341940487, "StateBufferConnector_ms": 0.004167837255141314, "ViewRequirementAgentConnector_ms": 0.09862927829518038}, "num_episodes": 29, "episode_return_max": -34.76871866571267, "episode_return_min": -1371.6458577646392, "episode_return_mean": -750.7732697395136, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.6046647131608, "num_env_steps_trained_throughput_per_sec": 286.6046647131608, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13493.567, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13493.499, "sample_time_ms": 2780.863, "learn_time_ms": 10695.736, "learn_throughput": 373.981, "synch_weights_time_ms": 16.098}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "64a97_00000", "date": "2024-07-26_23-05-57", "timestamp": 1722015357, "time_this_iter_s": 13.963016271591187, "time_total_s": 40.49811244010925, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.49811244010925, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.635, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0917007944857082, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.329270857572556, "policy_loss": -0.008073883497854695, "vf_loss": 9.350525640447934, "vf_explained_var": 0.037458528267840546, "kl": 0.01367578968339937, "entropy": 1.5916076657672724, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -34.76871866571267, "episode_reward_min": -1371.6458577646392, "episode_reward_mean": -735.2997111661715, "episode_len_mean": 138.17, "episode_media": {}, "episodes_timesteps_total": 13817, "policy_reward_min": {"policy_0": -1371.6458577646392}, "policy_reward_max": {"policy_0": -34.76871866571267}, "policy_reward_mean": {"policy_0": -735.2997111661715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 84, 70, 150, 150, 35, 150, 88, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 86, 150, 150, 94, 126, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 72, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1038.0625947318053, -1100.1066848812752, -991.6843439328746, -724.7088996543056, -577.9986502938913, -524.0129199593285, -1291.5955373681948, -291.87363242872914, -97.3597898846884, -1282.8679348494493, -1188.3290724098072, -34.76871866571267, -727.9898917610151, -231.59489323885768, -764.7328851055117, -512.6805220742136, -981.4458870289798, -984.8402779957314, -1280.528679874839, -1109.2672118033292, -561.4109396867533, -891.5389254261502, -429.6125108746076, -822.9763925779728, -533.4167811478635, -1111.6071734443094, -283.97541430763124, -555.6569323844103, -464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28747921264242116, "mean_inference_ms": 0.897886832607919, "mean_action_processing_ms": 0.1632682849838703, "mean_env_wait_ms": 2.046058410364422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005679130554199219, "StateBufferConnector_ms": 0.004109859466552734, "ViewRequirementAgentConnector_ms": 0.09899783134460449}, "num_episodes": 28, "episode_return_max": -34.76871866571267, "episode_return_min": -1371.6458577646392, "episode_return_mean": -735.2997111661715, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.2708554821672, "num_env_steps_trained_throughput_per_sec": 328.2708554821672, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13166.444, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13166.377, "sample_time_ms": 2783.497, "learn_time_ms": 10365.923, "learn_throughput": 385.88, "synch_weights_time_ms": 16.174}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "64a97_00000", "date": "2024-07-26_23-06-09", "timestamp": 1722015369, "time_this_iter_s": 12.193294525146484, "time_total_s": 52.69140696525574, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.69140696525574, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 10.594444444444443, "ram_util_percent": 28.627777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.107912631953756, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.266257795194784, "policy_loss": -0.008252387853281107, "vf_loss": 8.28602174570163, "vf_explained_var": 0.18664347088585298, "kl": 0.015034947509138873, "entropy": 1.4518534695108731, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -118.36829023556633, "episode_reward_min": -1371.6458577646392, "episode_reward_mean": -721.8446051378232, "episode_len_mean": 140.06, "episode_media": {}, "episodes_timesteps_total": 14006, "policy_reward_min": {"policy_0": -1371.6458577646392}, "policy_reward_max": {"policy_0": -118.36829023556633}, "policy_reward_mean": {"policy_0": -721.8446051378232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 61, 86, 150, 150, 94, 126, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 72, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 125, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 124, 150, 150, 150, 150, 150, 68], "policy_policy_0_reward": [-464.3447530028815, -1072.172029913782, -1080.647638830953, -1304.299811728385, -754.6188425316387, -860.634067052256, -509.98718038511504, -967.5930566190501, -118.36829023556633, -331.77374750505084, -1166.0344660975488, -422.0130957250957, -446.3554555288164, -665.6601739779549, -955.9140071503462, -1218.7774044673693, -441.9885753293443, -852.6310243902781, -135.23627073767005, -893.5856138880866, -1079.0870460383728, -669.8344343284052, -1039.6854144774575, -573.2136819829379, -815.3296411749018, -283.3353188523434, -672.6316426135512, -1371.6458577646392, -514.5407332769398, -644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868739945585414, "mean_inference_ms": 0.8972539326666191, "mean_action_processing_ms": 0.16291241764031064, "mean_env_wait_ms": 2.039794712849973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005463600158691406, "StateBufferConnector_ms": 0.004067420959472656, "ViewRequirementAgentConnector_ms": 0.10015988349914551}, "num_episodes": 28, "episode_return_max": -118.36829023556633, "episode_return_min": -1371.6458577646392, "episode_return_mean": -721.8446051378232, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.07884243969505, "num_env_steps_trained_throughput_per_sec": 288.07884243969505, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13310.175, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13310.11, "sample_time_ms": 2787.689, "learn_time_ms": 10505.808, "learn_throughput": 380.742, "synch_weights_time_ms": 15.837}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "64a97_00000", "date": "2024-07-26_23-06-23", "timestamp": 1722015383, "time_this_iter_s": 13.891924142837524, "time_total_s": 66.58333110809326, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.58333110809326, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.878947368421052, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.99530506854256, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.076083354155223, "policy_loss": -0.009767287833771359, "vf_loss": 8.097562119364738, "vf_explained_var": 0.3247201269492507, "kl": 0.015661067012236653, "entropy": 1.4843704345325628, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -41.023072866331766, "episode_reward_min": -1299.994968369532, "episode_reward_mean": -718.8532004615856, "episode_len_mean": 139.52, "episode_media": {}, "episodes_timesteps_total": 13952, "policy_reward_min": {"policy_0": -1299.994968369532}, "policy_reward_max": {"policy_0": -41.023072866331766}, "policy_reward_mean": {"policy_0": -718.8532004615856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334], "episode_lengths": [150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 72, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 125, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 124, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 50, 137, 150, 65, 150, 150, 150, 150, 39, 102, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-644.1514432590479, -772.8075729806496, -363.1319836339851, -159.24228906034853, -636.9617509714766, -836.1211328252232, -697.7527440764484, -434.7936027058929, -829.2560537531896, -354.6366120655908, -1156.5483273759426, -846.0703724170138, -371.4247030303204, -717.3411292168813, -942.1365734057752, -868.8916302257454, -766.7715952618722, -345.6261187192148, -1104.2965202394823, -684.1788444139308, -454.1640874384721, -624.4906491033183, -1281.852141105555, -672.542101611323, -663.4768638739251, -345.5013902422681, -724.1590614049426, -739.799077878639, -1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868426268819919, "mean_inference_ms": 0.8979180161788292, "mean_action_processing_ms": 0.16279098481613943, "mean_env_wait_ms": 2.041080342356512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005643129348754883, "StateBufferConnector_ms": 0.004057168960571289, "ViewRequirementAgentConnector_ms": 0.10099291801452637}, "num_episodes": 29, "episode_return_max": -41.023072866331766, "episode_return_min": -1299.994968369532, "episode_return_mean": -718.8532004615856, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.23023722849007, "num_env_steps_trained_throughput_per_sec": 371.23023722849007, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12887.645, "restore_workers_time_ms": 0.022, "training_step_time_ms": 12887.581, "sample_time_ms": 2789.219, "learn_time_ms": 10081.886, "learn_throughput": 396.751, "synch_weights_time_ms": 15.688}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "64a97_00000", "date": "2024-07-26_23-06-34", "timestamp": 1722015394, "time_this_iter_s": 10.781083345413208, "time_total_s": 77.36441445350647, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873a050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.36441445350647, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.125, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.667386619001626, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.622943236927191, "policy_loss": -0.0077667365670398185, "vf_loss": 6.642140672107538, "vf_explained_var": 0.6139404912168781, "kl": 0.01542919813625001, "entropy": 1.4516535576432943, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -41.023072866331766, "episode_reward_min": -1299.994968369532, "episode_reward_mean": -721.8699140936922, "episode_len_mean": 141.31, "episode_media": {}, "episodes_timesteps_total": 14131, "policy_reward_min": {"policy_0": -1299.994968369532}, "policy_reward_max": {"policy_0": -41.023072866331766}, "policy_reward_mean": {"policy_0": -721.8699140936922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896], "episode_lengths": [150, 125, 150, 72, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 125, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 102, 150, 150, 124, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 50, 137, 150, 65, 150, 150, 150, 150, 39, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1060.7410315783936, -492.73657523056914, -596.1907248774446, -231.53019857841488, -431.2390419588309, -1148.7784322496307, -518.3938321777921, -1041.8344294261865, -971.1949224890685, -809.7573074856143, -740.7157823414583, -1184.7447685086736, -914.5891598990644, -958.026576846586, -782.788587273955, -776.6934282630012, -911.7637523853888, -935.8840970899043, -444.5925853708548, -739.8244298392283, -277.6298328609057, -308.5455438877017, -883.4618445366332, -1085.289161574012, -481.0020660622849, -929.4846070104908, -402.0918862154821, -282.2705384752381, -316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28702493575488086, "mean_inference_ms": 0.8997365117941136, "mean_action_processing_ms": 0.16264822624849662, "mean_env_wait_ms": 2.0436830348854893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059051513671875, "StateBufferConnector_ms": 0.004100799560546875, "ViewRequirementAgentConnector_ms": 0.10176706314086914}, "num_episodes": 28, "episode_return_max": -41.023072866331766, "episode_return_min": -1299.994968369532, "episode_return_mean": -721.8699140936922, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.7659966813159, "num_env_steps_trained_throughput_per_sec": 381.7659966813159, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12543.358, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12543.294, "sample_time_ms": 2809.26, "learn_time_ms": 9717.739, "learn_throughput": 411.618, "synch_weights_time_ms": 15.513}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "64a97_00000", "date": "2024-07-26_23-06-45", "timestamp": 1722015405, "time_this_iter_s": 10.486164569854736, "time_total_s": 87.8505790233612, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.8505790233612, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.520000000000001, "ram_util_percent": 28.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.145850301285584, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.706508266925812, "policy_loss": -0.014269583945618555, "vf_loss": 5.732203930616379, "vf_explained_var": 0.804625114488105, "kl": 0.017114919852580603, "entropy": 1.4849078928430874, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -41.023072866331766, "episode_reward_min": -1299.994968369532, "episode_reward_mean": -699.1654687913887, "episode_len_mean": 140.9, "episode_media": {}, "episodes_timesteps_total": 14090, "policy_reward_min": {"policy_0": -1299.994968369532}, "policy_reward_max": {"policy_0": -41.023072866331766}, "policy_reward_mean": {"policy_0": -699.1654687913887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522], "episode_lengths": [150, 150, 150, 150, 150, 102, 150, 150, 124, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 50, 137, 150, 65, 150, 150, 150, 150, 39, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 112, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150], "policy_policy_0_reward": [-316.986842785603, -1299.994968369532, -857.9681537434861, -357.3650963271337, -621.2155603769581, -364.3956493189462, -1078.903888405176, -1161.954299559116, -510.19224038129875, -1023.0961959339919, -908.3295579745242, -1068.0856907430534, -1105.8682187305335, -270.24458142153867, -177.9987773154106, -843.2356489772175, -770.1163205603023, -1229.372003038956, -720.7932298519013, -130.8190429839694, -547.6513753677466, -626.0502404625614, -1040.5276517759344, -558.345873913061, -730.4967676323489, -1097.9838577476346, -535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28700979324536696, "mean_inference_ms": 0.9085377604519955, "mean_action_processing_ms": 0.1626114971200761, "mean_env_wait_ms": 2.044761402055906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006037235260009766, "StateBufferConnector_ms": 0.004044771194458008, "ViewRequirementAgentConnector_ms": 0.10079741477966309}, "num_episodes": 28, "episode_return_max": -41.023072866331766, "episode_return_min": -1299.994968369532, "episode_return_mean": -699.1654687913887, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.8205047921465, "num_env_steps_trained_throughput_per_sec": 319.8205047921465, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12538.817, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12538.753, "sample_time_ms": 2833.318, "learn_time_ms": 9689.108, "learn_throughput": 412.835, "synch_weights_time_ms": 15.539}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "64a97_00000", "date": "2024-07-26_23-06-57", "timestamp": 1722015417, "time_this_iter_s": 12.5148446559906, "time_total_s": 100.3654236793518, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.3654236793518, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.91764705882353, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88.97582018176715, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.753257297600309, "policy_loss": -0.013075393789525455, "vf_loss": 4.778584881375234, "vf_explained_var": 0.8889391320447128, "kl": 0.016014445879409332, "entropy": 1.5455070164054632, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -41.023072866331766, "episode_reward_min": -1267.0331410410383, "episode_reward_mean": -684.8699564908258, "episode_len_mean": 142.97, "episode_media": {}, "episodes_timesteps_total": 14297, "policy_reward_min": {"policy_0": -1267.0331410410383}, "policy_reward_max": {"policy_0": -41.023072866331766}, "policy_reward_mean": {"policy_0": -684.8699564908258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659], "episode_lengths": [150, 50, 137, 150, 65, 150, 150, 150, 150, 39, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 112, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-535.5201619089275, -110.69215921500269, -267.0484784484017, -543.5460110273939, -236.25334034521313, -1267.0331410410383, -745.627940550273, -1118.2044168041268, -658.3434182304846, -41.023072866331766, -507.14061421299425, -421.7874600775227, -997.566734367044, -1110.4264212455062, -1149.7212916639817, -1014.5825102586492, -1201.6273345154168, -1161.2622888930334, -777.2618185019452, -1236.717642560309, -678.8338580584292, -810.8134754031909, -486.2453690267256, -625.0616182869444, -644.7942756238443, -628.8278855329426, -1054.299139926025, -1206.06718428748, -1124.051816241316, -500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2870199660857058, "mean_inference_ms": 0.9155998981009962, "mean_action_processing_ms": 0.1625150406557859, "mean_env_wait_ms": 2.0449372923929956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005837678909301758, "StateBufferConnector_ms": 0.003991365432739258, "ViewRequirementAgentConnector_ms": 0.10027146339416504}, "num_episodes": 26, "episode_return_max": -41.023072866331766, "episode_return_min": -1267.0331410410383, "episode_return_mean": -684.8699564908258, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.9100260722863, "num_env_steps_trained_throughput_per_sec": 322.9100260722863, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12521.989, "restore_workers_time_ms": 0.022, "training_step_time_ms": 12521.924, "sample_time_ms": 2827.972, "learn_time_ms": 9677.493, "learn_throughput": 413.33, "synch_weights_time_ms": 15.663}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "64a97_00000", "date": "2024-07-26_23-07-10", "timestamp": 1722015430, "time_this_iter_s": 12.392559051513672, "time_total_s": 112.75798273086548, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.75798273086548, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.005555555555555, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.83624258240064, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.9842536203563212, "policy_loss": -0.014413559212698601, "vf_loss": 4.0099130195875965, "vf_explained_var": 0.9453215194245179, "kl": 0.017740649755614877, "entropy": 1.47939763640364, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -52.52629420512387, "episode_reward_min": -1245.5044630442596, "episode_reward_mean": -633.822578247282, "episode_len_mean": 144.38, "episode_media": {}, "episodes_timesteps_total": 14438, "policy_reward_min": {"policy_0": -1245.5044630442596}, "policy_reward_max": {"policy_0": -52.52629420512387}, "policy_reward_mean": {"policy_0": -633.822578247282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484], "episode_lengths": [150, 150, 144, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 112, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-500.3857023653493, -1014.8516413237512, -264.7550026075218, -543.2454732045786, -914.2032107018917, -597.0567364790896, -449.4633513092228, -694.005056654861, -402.6911280792772, -704.3187494957666, -394.46848365434664, -401.8733699447394, -681.471147133385, -801.7903306078061, -636.1860627915826, -430.95082690672086, -635.1073787980896, -579.1016469191067, -1068.9836755485005, -1122.418749840124, -997.1092141774609, -849.4184796431701, -249.84491698634966, -653.155300174636, -511.39201192820354, -911.5047574943467, -89.84745009680036, -442.050231367596, -942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28696449871160423, "mean_inference_ms": 0.9206470765966369, "mean_action_processing_ms": 0.16243739105415492, "mean_env_wait_ms": 2.043336936512531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005685567855834961, "StateBufferConnector_ms": 0.0039899349212646484, "ViewRequirementAgentConnector_ms": 0.09980463981628418}, "num_episodes": 29, "episode_return_max": -52.52629420512387, "episode_return_min": -1245.5044630442596, "episode_return_mean": -633.822578247282, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.26247079919295, "num_env_steps_trained_throughput_per_sec": 300.26247079919295, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12601.959, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12601.895, "sample_time_ms": 2823.804, "learn_time_ms": 9761.682, "learn_throughput": 409.765, "synch_weights_time_ms": 15.612}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "64a97_00000", "date": "2024-07-26_23-07-23", "timestamp": 1722015443, "time_this_iter_s": 13.32914924621582, "time_total_s": 126.0871319770813, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.0871319770813, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 10.594736842105263, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.43547730843225, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.7214188183347385, "policy_loss": -0.011958328792631315, "vf_loss": 3.7430057036379973, "vf_explained_var": 0.9440333627164363, "kl": 0.022097768854609973, "entropy": 1.4048107178260882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -52.52629420512387, "episode_reward_min": -1272.061142485414, "episode_reward_mean": -619.2078016217133, "episode_len_mean": 145.54, "episode_media": {}, "episodes_timesteps_total": 14554, "policy_reward_min": {"policy_0": -1272.061142485414}, "policy_reward_max": {"policy_0": -52.52629420512387}, "policy_reward_mean": {"policy_0": -619.2078016217133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 110, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-942.586670730949, -692.5419590203314, -760.9879186641958, -597.3150347294215, -643.8927868610571, -942.1639481533889, -675.6681976062716, -562.8588499638514, -489.9475320741195, -356.0661410565523, -841.584076968688, -214.53121737219723, -408.5346659239411, -886.5213279624056, -304.1045142878352, -653.78324064362, -623.4360980673522, -673.4612385399844, -681.4885971904431, -684.2175148855257, -872.8935441070006, -1083.063197567141, -1245.5044630442596, -1048.6009531158077, -965.6005312758646, -700.6793845317524, -682.3340594526312, -623.4677353758992, -402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28700905633753737, "mean_inference_ms": 0.9239189215751241, "mean_action_processing_ms": 0.1624552341734699, "mean_env_wait_ms": 2.0429365055619964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005676746368408203, "StateBufferConnector_ms": 0.004026651382446289, "ViewRequirementAgentConnector_ms": 0.10067629814147949}, "num_episodes": 28, "episode_return_max": -52.52629420512387, "episode_return_min": -1272.061142485414, "episode_return_mean": -619.2078016217133, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.118074690815, "num_env_steps_trained_throughput_per_sec": 405.118074690815, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12243.866, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12243.803, "sample_time_ms": 2821.87, "learn_time_ms": 9405.624, "learn_throughput": 425.277, "synch_weights_time_ms": 15.505}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "64a97_00000", "date": "2024-07-26_23-07-33", "timestamp": 1722015453, "time_this_iter_s": 9.880601167678833, "time_total_s": 135.96773314476013, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873b400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.96773314476013, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.935714285714285, "ram_util_percent": 28.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.61758884191514, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.199304673075676, "policy_loss": -0.021294787330649947, "vf_loss": 3.228534149254362, "vf_explained_var": 0.9486720072105527, "kl": 0.014776738281337513, "entropy": 1.2367695977290472, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -52.52629420512387, "episode_reward_min": -1287.594761299116, "episode_reward_mean": -544.031562321393, "episode_len_mean": 143.19, "episode_media": {}, "episodes_timesteps_total": 14319, "policy_reward_min": {"policy_0": -1287.594761299116}, "policy_reward_max": {"policy_0": -52.52629420512387}, "policy_reward_mean": {"policy_0": -544.031562321393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926], "episode_lengths": [150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 110, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 59, 150, 127, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-402.99012849921553, -913.2156081190351, -792.6885878490115, -615.558186388575, -492.9658553010508, -560.6214327415478, -487.37440898835314, -619.5617264134709, -468.8118428723836, -327.3803066299701, -850.1769605146984, -741.254294752432, -804.5276671722899, -230.00549798850406, -419.9967803247659, -424.6879643664539, -414.72523311222767, -52.52629420512387, -309.6217447955518, -646.2035276951077, -628.8640208100867, -808.096438624679, -683.3768342744596, -394.61539207037583, -766.9970755535347, -488.13433379936043, -664.5371710069122, -635.9316556250326, -146.33092869092343, -671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28711233627142474, "mean_inference_ms": 0.9209124970780589, "mean_action_processing_ms": 0.16236352722038955, "mean_env_wait_ms": 2.0434819119927043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005411863327026367, "StateBufferConnector_ms": 0.004074811935424805, "ViewRequirementAgentConnector_ms": 0.10118389129638672}, "num_episodes": 28, "episode_return_max": -52.52629420512387, "episode_return_min": -1287.594761299116, "episode_return_mean": -544.031562321393, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.66556159885306, "num_env_steps_trained_throughput_per_sec": 347.66556159885306, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12087.441, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12087.378, "sample_time_ms": 2828.272, "learn_time_ms": 9242.698, "learn_throughput": 432.774, "synch_weights_time_ms": 15.606}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "64a97_00000", "date": "2024-07-26_23-07-45", "timestamp": 1722015465, "time_this_iter_s": 11.513474225997925, "time_total_s": 147.48120737075806, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.48120737075806, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.935294117647059, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.63046733041604, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6174476106961566, "policy_loss": -0.02231908824032871, "vf_loss": 2.6444400700430077, "vf_explained_var": 0.9887807900086045, "kl": 0.024274431010659715, "entropy": 1.1955705894778172, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -52.78249935214884, "episode_reward_min": -1287.594761299116, "episode_reward_mean": -500.43523456151155, "episode_len_mean": 142.48, "episode_media": {}, "episodes_timesteps_total": 14248, "policy_reward_min": {"policy_0": -1287.594761299116}, "policy_reward_max": {"policy_0": -52.78249935214884}, "policy_reward_mean": {"policy_0": -500.43523456151155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 110, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 59, 150, 127, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-671.6575137826661, -286.5851216198904, -844.19550083115, -607.5910300801612, -648.827752277286, -982.904639829812, -706.1604625724395, -862.6784154680362, -1074.1157793135135, -517.6854972109295, -783.8757605899382, -751.1592595315922, -457.593001444446, -567.1185306905494, -428.84617489389484, -524.6041412905603, -725.5689485952246, -666.3085662155535, -767.2447929956718, -438.5926160427015, -1048.5428776932283, -614.8587176574204, -690.408101600948, -475.5914568776284, -607.5649803467778, -645.2760963272086, -375.5899910697015, -421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28722506106113227, "mean_inference_ms": 0.9189004892225696, "mean_action_processing_ms": 0.16233657706520568, "mean_env_wait_ms": 2.044919421160234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005525827407836914, "StateBufferConnector_ms": 0.004104137420654297, "ViewRequirementAgentConnector_ms": 0.10192060470581055}, "num_episodes": 29, "episode_return_max": -52.78249935214884, "episode_return_min": -1287.594761299116, "episode_return_mean": -500.43523456151155, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.14909801701265, "num_env_steps_trained_throughput_per_sec": 303.14909801701265, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12011.273, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12011.211, "sample_time_ms": 2832.507, "learn_time_ms": 9162.109, "learn_throughput": 436.581, "synch_weights_time_ms": 15.803}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "64a97_00000", "date": "2024-07-26_23-07-58", "timestamp": 1722015478, "time_this_iter_s": 13.199631214141846, "time_total_s": 160.6808385848999, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.6808385848999, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 11.083333333333334, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.57904142836729, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.3231032747775315, "policy_loss": -0.018775075849650116, "vf_loss": 2.3461236813416084, "vf_explained_var": 0.9926338008915384, "kl": 0.014662346526210979, "entropy": 1.0843376983578006, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -52.78249935214884, "episode_reward_min": -1287.594761299116, "episode_reward_mean": -424.59560520778746, "episode_len_mean": 140.49, "episode_media": {}, "episodes_timesteps_total": 14049, "policy_reward_min": {"policy_0": -1287.594761299116}, "policy_reward_max": {"policy_0": -52.78249935214884}, "policy_reward_mean": {"policy_0": -424.59560520778746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966], "episode_lengths": [150, 110, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 59, 150, 127, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 102, 150, 150, 150, 55], "policy_policy_0_reward": [-421.46612256836977, -149.7807337451635, -333.8797745776623, -467.55816002003536, -323.34486357546047, -552.0842380967547, -640.6761549656744, -264.6786743489288, -378.8258968999462, -1272.061142485414, -660.3023838563695, -525.1854127515088, -605.7810622351727, -567.2236157568499, -852.2965447830577, -484.87635629841907, -395.31993196256485, -604.3238376729624, -331.4553181001269, -179.3033892916458, -640.7792025615674, -529.7534763942678, -190.37567320312635, -382.22627607434976, -285.15751870118885, -925.8736514350992, -508.6840911802057, -444.23614955729346, -310.400066811277, -254.78856975280925, -433.2619096165115, -486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28730613350812445, "mean_inference_ms": 0.9175600273658955, "mean_action_processing_ms": 0.16232197599433854, "mean_env_wait_ms": 2.0463511793340885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056231021881103516, "StateBufferConnector_ms": 0.004085540771484375, "ViewRequirementAgentConnector_ms": 0.10225582122802734}, "num_episodes": 27, "episode_return_max": -52.78249935214884, "episode_return_min": -1287.594761299116, "episode_return_mean": -424.59560520778746, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.88179315588974, "num_env_steps_trained_throughput_per_sec": 313.88179315588974, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12067.131, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12067.068, "sample_time_ms": 2834.837, "learn_time_ms": 9216.02, "learn_throughput": 434.027, "synch_weights_time_ms": 15.426}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "64a97_00000", "date": "2024-07-26_23-08-11", "timestamp": 1722015491, "time_this_iter_s": 12.748269319534302, "time_total_s": 173.4291079044342, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.4291079044342, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 10.515789473684212, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.14639489253362, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.3771912820637224, "policy_loss": -0.018015857190281773, "vf_loss": 2.4001767564564944, "vf_explained_var": 0.9741569605966409, "kl": 0.013278481835550344, "entropy": 1.0944921211029093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -48.746627321965285, "episode_reward_min": -1287.594761299116, "episode_reward_mean": -364.77293851722624, "episode_len_mean": 135.92, "episode_media": {}, "episodes_timesteps_total": 13592, "policy_reward_min": {"policy_0": -1287.594761299116}, "policy_reward_max": {"policy_0": -48.746627321965285}, "policy_reward_mean": {"policy_0": -364.77293851722624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812], "episode_lengths": [150, 42, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 102, 150, 150, 150, 55, 150, 112, 134, 122, 96, 150, 150, 80, 34, 77, 150, 150, 144, 150, 104, 105, 150, 150, 150, 150, 150, 116, 150, 122, 150, 150, 84, 150, 73, 149, 142], "policy_policy_0_reward": [-486.92770453549974, -98.38568840644153, -305.6970411984479, -578.9919234412295, -410.4729463956858, -354.239524143124, -1287.594761299116, -185.80581784396938, -549.5708827489109, -284.07832662679334, -401.02758956661006, -594.5514973994829, -386.92870322014926, -473.9954649983509, -531.955625576553, -294.93840530287036, -463.98000588246754, -341.32117949607346, -468.8858955960595, -457.4048807773398, -66.35230116255542, -363.21237096070143, -291.7852419146906, -321.3253996590076, -335.851478846325, -52.78249935214884, -656.3410674466439, -700.8787836598102, -464.46675405340545, -447.57186187015395, -208.07785589507412, -408.0972386664893, -476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875630102006422, "mean_inference_ms": 0.9163472705090466, "mean_action_processing_ms": 0.16242068944182, "mean_env_wait_ms": 2.04836020376153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005671501159667969, "StateBufferConnector_ms": 0.004079580307006836, "ViewRequirementAgentConnector_ms": 0.10239958763122559}, "num_episodes": 31, "episode_return_max": -48.746627321965285, "episode_return_min": -1287.594761299116, "episode_return_mean": -364.77293851722624, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.68709360866376, "num_env_steps_trained_throughput_per_sec": 307.68709360866376, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11978.645, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11978.582, "sample_time_ms": 2839.851, "learn_time_ms": 9122.741, "learn_throughput": 438.465, "synch_weights_time_ms": 15.2}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "64a97_00000", "date": "2024-07-26_23-08-24", "timestamp": 1722015504, "time_this_iter_s": 13.008779048919678, "time_total_s": 186.43788695335388, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.43788695335388, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.966666666666667, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.54287037352721, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.8839104608322184, "policy_loss": -0.021925310414129248, "vf_loss": 1.9091599762439728, "vf_explained_var": 0.9907638814300299, "kl": 0.015127694604416327, "entropy": 1.0131669379770756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -48.746627321965285, "episode_reward_min": -938.4162057902761, "episode_reward_mean": -311.1443017194657, "episode_len_mean": 134.93, "episode_media": {}, "episodes_timesteps_total": 13493, "policy_reward_min": {"policy_0": -938.4162057902761}, "policy_reward_max": {"policy_0": -48.746627321965285}, "policy_reward_mean": {"policy_0": -311.1443017194657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812, -364.48304108017044, -79.40255034385216, -470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714], "episode_lengths": [150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 102, 150, 150, 150, 55, 150, 112, 134, 122, 96, 150, 150, 80, 34, 77, 150, 150, 144, 150, 104, 105, 150, 150, 150, 150, 150, 116, 150, 122, 150, 150, 84, 150, 73, 149, 142, 150, 56, 150, 125, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 93, 150, 150, 150, 150, 100, 142, 150, 150, 101, 147, 150, 80, 150], "policy_policy_0_reward": [-476.5014885938948, -379.23968696767986, -98.81230710256601, -322.188456500457, -432.708436153111, -842.7680796059625, -231.01740170348063, -531.7794728628627, -319.6071537277889, -448.29832886244947, -445.9737652012236, -274.24694531421164, -238.28681965093136, -231.56161430504048, -442.9732000717509, -238.7244254234577, -244.60531291959634, -380.75945512375586, -340.08775737655674, -404.42454613733037, -808.0088154747833, -174.2416084092903, -401.1365708336097, -283.8819483284627, -257.99557959797403, -560.4188538368828, -444.2552189149936, -341.02731880781084, -770.5027437709152, -171.93090871098434, -938.4162057902761, -81.75766277817925, -87.36940887582168, -341.27415050347565, -739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812, -364.48304108017044, -79.40255034385216, -470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2876524851062665, "mean_inference_ms": 0.9157373976860108, "mean_action_processing_ms": 0.16261022101671835, "mean_env_wait_ms": 2.0498932100316263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058176517486572266, "StateBufferConnector_ms": 0.004131317138671875, "ViewRequirementAgentConnector_ms": 0.10393714904785156}, "num_episodes": 32, "episode_return_max": -48.746627321965285, "episode_return_min": -938.4162057902761, "episode_return_mean": -311.1443017194657, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7973316075865, "num_env_steps_trained_throughput_per_sec": 299.7973316075865, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12235.381, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12235.318, "sample_time_ms": 2846.083, "learn_time_ms": 9372.93, "learn_throughput": 426.761, "synch_weights_time_ms": 15.471}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "64a97_00000", "date": "2024-07-26_23-08-37", "timestamp": 1722015517, "time_this_iter_s": 13.349104404449463, "time_total_s": 199.78699135780334, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.78699135780334, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 10.41578947368421, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.92920610706011, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.222172569607695, "policy_loss": -0.015936210166546515, "vf_loss": 2.241668829942743, "vf_explained_var": 0.9828714086984595, "kl": 0.014026076518560634, "entropy": 0.987177875203391, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -14.954212793066993, "episode_reward_min": -881.9656631767015, "episode_reward_mean": -254.17805904396042, "episode_len_mean": 125.66, "episode_media": {}, "episodes_timesteps_total": 12566, "policy_reward_min": {"policy_0": -881.9656631767015}, "policy_reward_max": {"policy_0": -14.954212793066993}, "policy_reward_mean": {"policy_0": -254.17805904396042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812, -364.48304108017044, -79.40255034385216, -470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714, -318.29825959584554, -157.64151869743506, -106.97565674193478, -389.4330579887074, -350.76471349669816, -290.8019869128519, -276.60010637255493, -183.81823159398823, -140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423], "episode_lengths": [150, 150, 55, 150, 112, 134, 122, 96, 150, 150, 80, 34, 77, 150, 150, 144, 150, 104, 105, 150, 150, 150, 150, 150, 116, 150, 122, 150, 150, 84, 150, 73, 149, 142, 150, 56, 150, 125, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 93, 150, 150, 150, 150, 100, 142, 150, 150, 101, 147, 150, 80, 150, 150, 118, 65, 150, 150, 150, 150, 83, 89, 150, 150, 93, 150, 108, 101, 108, 111, 150, 150, 121, 150, 115, 86, 40, 90, 67, 150, 124, 43, 129, 52, 150, 85, 150], "policy_policy_0_reward": [-739.2846628407214, -417.46070278777745, -126.57658969071966, -316.1713190427775, -139.28300026858213, -214.20395030630002, -141.31878959195095, -199.83107497129168, -449.3328098087455, -314.8001134949855, -216.7301465082734, -48.746627321965285, -230.7956725450577, -404.8241767135106, -245.4277121293128, -881.9656631767015, -325.0779125770846, -224.5733299414569, -74.77406798512104, -173.3325587580656, -545.246359720619, -789.0806637086665, -246.02623616164806, -329.1690559377411, -121.19944476086704, -267.2879202791315, -167.44794586349914, -452.25135995511107, -177.55871155805298, -228.0155829239621, -365.7186819124325, -149.32483978248152, -260.9744810554842, -233.20332146277812, -364.48304108017044, -79.40255034385216, -470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714, -318.29825959584554, -157.64151869743506, -106.97565674193478, -389.4330579887074, -350.76471349669816, -290.8019869128519, -276.60010637255493, -183.81823159398823, -140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2878995311736901, "mean_inference_ms": 0.9146607335557121, "mean_action_processing_ms": 0.1626767794990522, "mean_env_wait_ms": 2.0524848542997245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00571131706237793, "StateBufferConnector_ms": 0.004122018814086914, "ViewRequirementAgentConnector_ms": 0.10429930686950684}, "num_episodes": 34, "episode_return_max": -14.954212793066993, "episode_return_min": -881.9656631767015, "episode_return_mean": -254.17805904396042, "episodes_this_iter": 34}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.00311881862206, "num_env_steps_trained_throughput_per_sec": 336.00311881862206, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12378.084, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12378.02, "sample_time_ms": 2846.627, "learn_time_ms": 9514.877, "learn_throughput": 420.394, "synch_weights_time_ms": 15.66}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "64a97_00000", "date": "2024-07-26_23-08-49", "timestamp": 1722015529, "time_this_iter_s": 11.911646604537964, "time_total_s": 211.6986379623413, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873b490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 211.6986379623413, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 11.16470588235294, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.5394090771675, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.2643769254287083, "policy_loss": -0.014969780929095577, "vf_loss": 2.2826757367700337, "vf_explained_var": 0.9909856188421448, "kl": 0.014413797106559894, "entropy": 0.9815243491282065, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -14.954212793066993, "episode_reward_min": -554.3021155995829, "episode_reward_mean": -213.14199751842614, "episode_len_mean": 119.84, "episode_media": {}, "episodes_timesteps_total": 11984, "policy_reward_min": {"policy_0": -554.3021155995829}, "policy_reward_max": {"policy_0": -14.954212793066993}, "policy_reward_mean": {"policy_0": -213.14199751842614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714, -318.29825959584554, -157.64151869743506, -106.97565674193478, -389.4330579887074, -350.76471349669816, -290.8019869128519, -276.60010637255493, -183.81823159398823, -140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423, -165.806431337172, -95.91093660478482, -69.52998200375978, -198.43766720197058, -471.83672700576403, -448.937212192535, -229.86738030378353, -286.4497879711549, -158.07049111681803, -64.21850438409973, -167.30868389568374, -22.15707326981309, -288.7004001385121, -233.9066737161968, -19.26559646159529, -99.12338678588786, -181.27859286808695, -72.07626230580506, -177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244], "episode_lengths": [150, 125, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 93, 150, 150, 150, 150, 100, 142, 150, 150, 101, 147, 150, 80, 150, 150, 118, 65, 150, 150, 150, 150, 83, 89, 150, 150, 93, 150, 108, 101, 108, 111, 150, 150, 121, 150, 115, 86, 40, 90, 67, 150, 124, 43, 129, 52, 150, 85, 150, 124, 63, 97, 139, 150, 150, 150, 150, 107, 50, 124, 43, 150, 97, 44, 108, 95, 65, 125, 140, 73, 99, 84, 145, 150, 132, 150, 103, 138, 93, 98, 104, 50, 104, 150, 79], "policy_policy_0_reward": [-470.9537984930583, -179.32267198828123, -212.36215716805805, -341.4152121943509, -206.20461939496462, -184.2389018621939, -454.1033623041726, -200.61120369161324, -205.8103546751989, -306.6540368103013, -409.16200284071965, -314.1179689040177, -278.3223578616471, -248.3584330072828, -97.23573027025084, -211.58550970742914, -55.3707235856977, -343.54857851380086, -240.0900546125495, -442.5823274030682, -197.7457877473302, -211.28927102356596, -160.6800046778382, -312.29545249743813, -178.8052933559533, -94.93534602490293, -277.2151958124954, -194.841838222364, -187.26457813419043, -249.6246739573714, -318.29825959584554, -157.64151869743506, -106.97565674193478, -389.4330579887074, -350.76471349669816, -290.8019869128519, -276.60010637255493, -183.81823159398823, -140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423, -165.806431337172, -95.91093660478482, -69.52998200375978, -198.43766720197058, -471.83672700576403, -448.937212192535, -229.86738030378353, -286.4497879711549, -158.07049111681803, -64.21850438409973, -167.30868389568374, -22.15707326981309, -288.7004001385121, -233.9066737161968, -19.26559646159529, -99.12338678588786, -181.27859286808695, -72.07626230580506, -177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880404953056683, "mean_inference_ms": 0.9134714511240822, "mean_action_processing_ms": 0.16256571115500262, "mean_env_wait_ms": 2.0546280128950247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005391359329223633, "StateBufferConnector_ms": 0.004063606262207031, "ViewRequirementAgentConnector_ms": 0.10245990753173828}, "num_episodes": 36, "episode_return_max": -14.954212793066993, "episode_return_min": -554.3021155995829, "episode_return_mean": -213.14199751842614, "episodes_this_iter": 36}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.379102336834, "num_env_steps_trained_throughput_per_sec": 297.379102336834, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12472.467, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12472.404, "sample_time_ms": 2833.375, "learn_time_ms": 9622.421, "learn_throughput": 415.696, "synch_weights_time_ms": 15.746}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "64a97_00000", "date": "2024-07-26_23-09-03", "timestamp": 1722015543, "time_this_iter_s": 13.457518100738525, "time_total_s": 225.15615606307983, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.15615606307983, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.631578947368421, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82.22046847889821, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.5705335163821776, "policy_loss": -0.01627820633924178, "vf_loss": 2.5910639422635238, "vf_explained_var": 0.9816175481304527, "kl": 0.01370146739797445, "entropy": 1.0417877396568656, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -14.954212793066993, "episode_reward_min": -1073.9458744907458, "episode_reward_mean": -203.99880139883217, "episode_len_mean": 109.83, "episode_media": {}, "episodes_timesteps_total": 10983, "policy_reward_min": {"policy_0": -1073.9458744907458}, "policy_reward_max": {"policy_0": -14.954212793066993}, "policy_reward_mean": {"policy_0": -203.99880139883217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423, -165.806431337172, -95.91093660478482, -69.52998200375978, -198.43766720197058, -471.83672700576403, -448.937212192535, -229.86738030378353, -286.4497879711549, -158.07049111681803, -64.21850438409973, -167.30868389568374, -22.15707326981309, -288.7004001385121, -233.9066737161968, -19.26559646159529, -99.12338678588786, -181.27859286808695, -72.07626230580506, -177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244, -423.611829201309, -172.9063131776375, -702.313246292081, -174.0539723999924, -163.9383342105914, -326.9966851379316, -39.24156435694363, -159.12474755915665, -347.484952249653, -1073.9458744907458, -140.10857957702524, -156.2138575273659, -201.05048948387184, -352.5562127920481, -274.391445908586, -97.87041530869881, -114.88084004224625, -191.39107983200492, -568.3266850403077, -156.0286182038708, -233.59687210571167, -103.55165002043361, -85.25286320488667, -118.50947943994738, -240.70779345114414, -142.50911018927943, -189.20056787103445, -255.30748012944323, -16.74731330011976, -142.18229081182375, -141.3685627507413, -103.89340419861702, -138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982], "episode_lengths": [89, 150, 150, 93, 150, 108, 101, 108, 111, 150, 150, 121, 150, 115, 86, 40, 90, 67, 150, 124, 43, 129, 52, 150, 85, 150, 124, 63, 97, 139, 150, 150, 150, 150, 107, 50, 124, 43, 150, 97, 44, 108, 95, 65, 125, 140, 73, 99, 84, 145, 150, 132, 150, 103, 138, 93, 98, 104, 50, 104, 150, 79, 150, 135, 150, 138, 128, 114, 50, 122, 150, 150, 148, 74, 148, 150, 150, 111, 68, 95, 150, 130, 109, 73, 67, 68, 95, 77, 97, 106, 41, 88, 124, 119, 75, 94, 68, 63, 123, 150], "policy_policy_0_reward": [-140.89474579483579, -345.00709277692005, -554.3021155995829, -209.85503500047315, -492.5726570958144, -96.43997917225425, -104.62442585899124, -81.15663047192129, -217.8984268637688, -190.95686581835793, -279.9832846136201, -129.61354768705507, -363.6443961708059, -135.07259661858086, -196.34767701372698, -14.954212793066993, -47.14368348095775, -86.82798501439756, -306.26888936013677, -167.19749217821152, -39.01558706291316, -208.7730685661274, -71.25556516222407, -309.9752572742958, -203.3461878526808, -222.69644398530423, -165.806431337172, -95.91093660478482, -69.52998200375978, -198.43766720197058, -471.83672700576403, -448.937212192535, -229.86738030378353, -286.4497879711549, -158.07049111681803, -64.21850438409973, -167.30868389568374, -22.15707326981309, -288.7004001385121, -233.9066737161968, -19.26559646159529, -99.12338678588786, -181.27859286808695, -72.07626230580506, -177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244, -423.611829201309, -172.9063131776375, -702.313246292081, -174.0539723999924, -163.9383342105914, -326.9966851379316, -39.24156435694363, -159.12474755915665, -347.484952249653, -1073.9458744907458, -140.10857957702524, -156.2138575273659, -201.05048948387184, -352.5562127920481, -274.391445908586, -97.87041530869881, -114.88084004224625, -191.39107983200492, -568.3266850403077, -156.0286182038708, -233.59687210571167, -103.55165002043361, -85.25286320488667, -118.50947943994738, -240.70779345114414, -142.50911018927943, -189.20056787103445, -255.30748012944323, -16.74731330011976, -142.18229081182375, -141.3685627507413, -103.89340419861702, -138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28799517128757807, "mean_inference_ms": 0.9122410925795993, "mean_action_processing_ms": 0.16235275143647576, "mean_env_wait_ms": 2.057722616625936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005440473556518555, "StateBufferConnector_ms": 0.004032135009765625, "ViewRequirementAgentConnector_ms": 0.10162091255187988}, "num_episodes": 38, "episode_return_max": -14.954212793066993, "episode_return_min": -1073.9458744907458, "episode_return_mean": -203.99880139883217, "episodes_this_iter": 38}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.5675169356795, "num_env_steps_trained_throughput_per_sec": 279.5675169356795, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12664.513, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12664.449, "sample_time_ms": 2842.022, "learn_time_ms": 9806.152, "learn_throughput": 407.907, "synch_weights_time_ms": 15.428}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "64a97_00000", "date": "2024-07-26_23-09-17", "timestamp": 1722015557, "time_this_iter_s": 14.313943862915039, "time_total_s": 239.47009992599487, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.47009992599487, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.638095238095238, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.1174198081096, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.6156072437142333, "policy_loss": -0.018872142459925575, "vf_loss": 1.635411929897964, "vf_explained_var": 0.9953126547858119, "kl": 0.017821831628013277, "entropy": 0.8952367436140776, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -7.131540948874954, "episode_reward_min": -1073.9458744907458, "episode_reward_mean": -188.4604879464115, "episode_len_mean": 102.81, "episode_media": {}, "episodes_timesteps_total": 10281, "policy_reward_min": {"policy_0": -1073.9458744907458}, "policy_reward_max": {"policy_0": -7.131540948874954}, "policy_reward_mean": {"policy_0": -188.4604879464115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244, -423.611829201309, -172.9063131776375, -702.313246292081, -174.0539723999924, -163.9383342105914, -326.9966851379316, -39.24156435694363, -159.12474755915665, -347.484952249653, -1073.9458744907458, -140.10857957702524, -156.2138575273659, -201.05048948387184, -352.5562127920481, -274.391445908586, -97.87041530869881, -114.88084004224625, -191.39107983200492, -568.3266850403077, -156.0286182038708, -233.59687210571167, -103.55165002043361, -85.25286320488667, -118.50947943994738, -240.70779345114414, -142.50911018927943, -189.20056787103445, -255.30748012944323, -16.74731330011976, -142.18229081182375, -141.3685627507413, -103.89340419861702, -138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982, -148.09482934863865, -119.2234512216825, -179.48280924670547, -168.295305071258, -25.11089401779861, -188.72239196196585, -51.8725050161329, -90.35250365165697, -121.56181381547177, -190.6537196208499, -7.131540948874954, -206.56376693284503, -199.14334858947433, -136.50396248825368, -183.8310335101928, -120.61919870721368, -340.616294957845, -188.8345626851868, -18.83466276328865, -155.40791936409698, -263.5177456743779, -259.66558120346946, -96.62668124095407, -154.82172504899583, -266.3306763956074, -125.07060775805631, -165.25803659117057, -167.08675027391752, -107.65992636371342, -52.005018661896976, -152.30275508420354, -229.61731544187404, -124.91047297312781, -192.3697821670524, -187.97418070335303, -81.55676693238524, -269.36698999335755, -348.1193215054663, -151.21458029274433, -64.54855199356602, -126.05994932131468, -78.45128170447344, -266.037604213733, -163.44547815013325], "episode_lengths": [125, 140, 73, 99, 84, 145, 150, 132, 150, 103, 138, 93, 98, 104, 50, 104, 150, 79, 150, 135, 150, 138, 128, 114, 50, 122, 150, 150, 148, 74, 148, 150, 150, 111, 68, 95, 150, 130, 109, 73, 67, 68, 95, 77, 97, 106, 41, 88, 124, 119, 75, 94, 68, 63, 123, 150, 88, 71, 95, 92, 43, 132, 92, 65, 85, 96, 31, 102, 103, 75, 94, 67, 123, 89, 41, 76, 150, 108, 63, 92, 112, 82, 90, 87, 67, 95, 138, 105, 120, 150, 98, 109, 135, 150, 78, 59, 68, 58, 150, 92], "policy_policy_0_reward": [-177.21266950323727, -223.1425236179554, -142.73390713266252, -201.65493911725895, -182.55032856554132, -220.47389200198742, -237.65235869991204, -193.8335786556528, -213.81823397821344, -91.88140848286803, -246.26381000210688, -63.139566123410795, -198.2774967726137, -203.97744247922927, -30.532709573622075, -243.7017618202175, -247.04247557682146, -166.52403274673244, -423.611829201309, -172.9063131776375, -702.313246292081, -174.0539723999924, -163.9383342105914, -326.9966851379316, -39.24156435694363, -159.12474755915665, -347.484952249653, -1073.9458744907458, -140.10857957702524, -156.2138575273659, -201.05048948387184, -352.5562127920481, -274.391445908586, -97.87041530869881, -114.88084004224625, -191.39107983200492, -568.3266850403077, -156.0286182038708, -233.59687210571167, -103.55165002043361, -85.25286320488667, -118.50947943994738, -240.70779345114414, -142.50911018927943, -189.20056787103445, -255.30748012944323, -16.74731330011976, -142.18229081182375, -141.3685627507413, -103.89340419861702, -138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982, -148.09482934863865, -119.2234512216825, -179.48280924670547, -168.295305071258, -25.11089401779861, -188.72239196196585, -51.8725050161329, -90.35250365165697, -121.56181381547177, -190.6537196208499, -7.131540948874954, -206.56376693284503, -199.14334858947433, -136.50396248825368, -183.8310335101928, -120.61919870721368, -340.616294957845, -188.8345626851868, -18.83466276328865, -155.40791936409698, -263.5177456743779, -259.66558120346946, -96.62668124095407, -154.82172504899583, -266.3306763956074, -125.07060775805631, -165.25803659117057, -167.08675027391752, -107.65992636371342, -52.005018661896976, -152.30275508420354, -229.61731544187404, -124.91047297312781, -192.3697821670524, -187.97418070335303, -81.55676693238524, -269.36698999335755, -348.1193215054663, -151.21458029274433, -64.54855199356602, -126.05994932131468, -78.45128170447344, -266.037604213733, -163.44547815013325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880590661679828, "mean_inference_ms": 0.9123684250200534, "mean_action_processing_ms": 0.16267230743395633, "mean_env_wait_ms": 2.059748832220315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056040287017822266, "StateBufferConnector_ms": 0.004039764404296875, "ViewRequirementAgentConnector_ms": 0.10142135620117188}, "num_episodes": 44, "episode_return_max": -7.131540948874954, "episode_return_min": -1073.9458744907458, "episode_return_mean": -188.4604879464115, "episodes_this_iter": 44}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.1810144352963, "num_env_steps_trained_throughput_per_sec": 268.1810144352963, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12823.875, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12823.811, "sample_time_ms": 2847.394, "learn_time_ms": 9959.928, "learn_throughput": 401.609, "synch_weights_time_ms": 15.637}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "64a97_00000", "date": "2024-07-26_23-09-32", "timestamp": 1722015572, "time_this_iter_s": 14.922393560409546, "time_total_s": 254.39249348640442, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.39249348640442, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 10.295238095238094, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.2938344101111, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.4702858331302802, "policy_loss": -0.016288770621758885, "vf_loss": 1.488701349000136, "vf_explained_var": 0.9918790206313133, "kl": 0.013922229586629946, "entropy": 0.8391748934363326, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 0.14890444930026042, "episode_reward_min": -348.1193215054663, "episode_reward_mean": -143.51845030120637, "episode_len_mean": 86.21, "episode_media": {}, "episodes_timesteps_total": 8621, "policy_reward_min": {"policy_0": -348.1193215054663}, "policy_reward_max": {"policy_0": 0.14890444930026042}, "policy_reward_mean": {"policy_0": -143.51845030120637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982, -148.09482934863865, -119.2234512216825, -179.48280924670547, -168.295305071258, -25.11089401779861, -188.72239196196585, -51.8725050161329, -90.35250365165697, -121.56181381547177, -190.6537196208499, -7.131540948874954, -206.56376693284503, -199.14334858947433, -136.50396248825368, -183.8310335101928, -120.61919870721368, -340.616294957845, -188.8345626851868, -18.83466276328865, -155.40791936409698, -263.5177456743779, -259.66558120346946, -96.62668124095407, -154.82172504899583, -266.3306763956074, -125.07060775805631, -165.25803659117057, -167.08675027391752, -107.65992636371342, -52.005018661896976, -152.30275508420354, -229.61731544187404, -124.91047297312781, -192.3697821670524, -187.97418070335303, -81.55676693238524, -269.36698999335755, -348.1193215054663, -151.21458029274433, -64.54855199356602, -126.05994932131468, -78.45128170447344, -266.037604213733, -163.44547815013325, -168.94059584084295, 0.14890444930026042, -193.35979437212225, -57.632589861158465, -188.04551176577078, -243.91176150150318, -102.95364210517023, -127.67907353542432, -54.30585778623689, -171.08824604306872, -206.38703766862793, -148.12791978567495, -123.2656667993263, -117.34365783776961, -121.33005119419153, -28.479642217620395, -27.519805375860702, -114.61416091935645, -250.37650997514544, -140.87305266977225, -35.04901571825425, -307.80477881738784, -174.18801010011506, -214.19928048897987, -72.46561981005486, -119.46971611178121, -158.62506962592227, -135.48101690008139, -100.85613012528876, -7.183084979512096, -147.05125628118088, -271.03693763752585, -122.244557070665, -161.9814005534746, -138.48933508029103, -119.25284487906546, -167.71699435729252, -88.76856529242787, -11.889060615451559, -115.21327895416441, -40.886813353410204, -156.1236145541856, -21.051925521504344, -153.03442826162652, -128.2009530032883, -20.529591306213042, -195.3982780245208, -167.9980309039687, -99.08864461270475, -162.1085948490981], "episode_lengths": [75, 94, 68, 63, 123, 150, 88, 71, 95, 92, 43, 132, 92, 65, 85, 96, 31, 102, 103, 75, 94, 67, 123, 89, 41, 76, 150, 108, 63, 92, 112, 82, 90, 87, 67, 95, 138, 105, 120, 150, 98, 109, 135, 150, 78, 59, 68, 58, 150, 92, 80, 37, 140, 59, 88, 105, 70, 75, 64, 85, 95, 91, 123, 69, 80, 48, 46, 71, 108, 91, 54, 118, 86, 100, 59, 67, 90, 85, 68, 37, 80, 113, 85, 95, 77, 100, 81, 61, 36, 88, 46, 84, 50, 81, 87, 43, 93, 94, 68, 81], "policy_policy_0_reward": [-138.2263537438728, -219.24254926186148, -111.05209499391593, -87.69264345490035, -182.77135454053104, -278.5132399223982, -148.09482934863865, -119.2234512216825, -179.48280924670547, -168.295305071258, -25.11089401779861, -188.72239196196585, -51.8725050161329, -90.35250365165697, -121.56181381547177, -190.6537196208499, -7.131540948874954, -206.56376693284503, -199.14334858947433, -136.50396248825368, -183.8310335101928, -120.61919870721368, -340.616294957845, -188.8345626851868, -18.83466276328865, -155.40791936409698, -263.5177456743779, -259.66558120346946, -96.62668124095407, -154.82172504899583, -266.3306763956074, -125.07060775805631, -165.25803659117057, -167.08675027391752, -107.65992636371342, -52.005018661896976, -152.30275508420354, -229.61731544187404, -124.91047297312781, -192.3697821670524, -187.97418070335303, -81.55676693238524, -269.36698999335755, -348.1193215054663, -151.21458029274433, -64.54855199356602, -126.05994932131468, -78.45128170447344, -266.037604213733, -163.44547815013325, -168.94059584084295, 0.14890444930026042, -193.35979437212225, -57.632589861158465, -188.04551176577078, -243.91176150150318, -102.95364210517023, -127.67907353542432, -54.30585778623689, -171.08824604306872, -206.38703766862793, -148.12791978567495, -123.2656667993263, -117.34365783776961, -121.33005119419153, -28.479642217620395, -27.519805375860702, -114.61416091935645, -250.37650997514544, -140.87305266977225, -35.04901571825425, -307.80477881738784, -174.18801010011506, -214.19928048897987, -72.46561981005486, -119.46971611178121, -158.62506962592227, -135.48101690008139, -100.85613012528876, -7.183084979512096, -147.05125628118088, -271.03693763752585, -122.244557070665, -161.9814005534746, -138.48933508029103, -119.25284487906546, -167.71699435729252, -88.76856529242787, -11.889060615451559, -115.21327895416441, -40.886813353410204, -156.1236145541856, -21.051925521504344, -153.03442826162652, -128.2009530032883, -20.529591306213042, -195.3982780245208, -167.9980309039687, -99.08864461270475, -162.1085948490981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28869292589464624, "mean_inference_ms": 0.9139914563067137, "mean_action_processing_ms": 0.16304619112958843, "mean_env_wait_ms": 2.0633895693304445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005676746368408203, "StateBufferConnector_ms": 0.00409698486328125, "ViewRequirementAgentConnector_ms": 0.10271668434143066}, "num_episodes": 50, "episode_return_max": 0.14890444930026042, "episode_return_min": -348.1193215054663, "episode_return_mean": -143.51845030120637, "episodes_this_iter": 50}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.059299668932, "num_env_steps_trained_throughput_per_sec": 311.059299668932, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13122.438, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13122.372, "sample_time_ms": 2858.718, "learn_time_ms": 10247.704, "learn_throughput": 390.331, "synch_weights_time_ms": 15.108}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "64a97_00000", "date": "2024-07-26_23-09-45", "timestamp": 1722015585, "time_this_iter_s": 12.866336107254028, "time_total_s": 267.25882959365845, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087badd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.25882959365845, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 14.511111111111111, "ram_util_percent": 28.811111111111114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.97986630896727, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.4760743727286656, "policy_loss": -0.017030674969040167, "vf_loss": 1.4940965386728446, "vf_explained_var": 0.9957299440478286, "kl": 0.01657257534910363, "entropy": 0.8449149309967955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -5.8003811763569075, "episode_reward_min": -403.73332080271314, "episode_reward_mean": -125.33293226673419, "episode_len_mean": 77.14, "episode_media": {}, "episodes_timesteps_total": 7714, "policy_reward_min": {"policy_0": -403.73332080271314}, "policy_reward_max": {"policy_0": -5.8003811763569075}, "policy_reward_mean": {"policy_0": -125.33293226673419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.632589861158465, -188.04551176577078, -243.91176150150318, -102.95364210517023, -127.67907353542432, -54.30585778623689, -171.08824604306872, -206.38703766862793, -148.12791978567495, -123.2656667993263, -117.34365783776961, -121.33005119419153, -28.479642217620395, -27.519805375860702, -114.61416091935645, -250.37650997514544, -140.87305266977225, -35.04901571825425, -307.80477881738784, -174.18801010011506, -214.19928048897987, -72.46561981005486, -119.46971611178121, -158.62506962592227, -135.48101690008139, -100.85613012528876, -7.183084979512096, -147.05125628118088, -271.03693763752585, -122.244557070665, -161.9814005534746, -138.48933508029103, -119.25284487906546, -167.71699435729252, -88.76856529242787, -11.889060615451559, -115.21327895416441, -40.886813353410204, -156.1236145541856, -21.051925521504344, -153.03442826162652, -128.2009530032883, -20.529591306213042, -195.3982780245208, -167.9980309039687, -99.08864461270475, -162.1085948490981, -201.05037154192945, -118.4149507864785, -39.551423219205276, -94.2242719783823, -15.420372639308114, -136.54193965491723, -18.14215248089452, -259.59229859703646, -117.3406473316434, -163.266381041009, -71.87383503866943, -40.72107988611777, -126.62015940409016, -47.61475263171809, -147.95299254997502, -403.73332080271314, -121.90216759722063, -106.57948859297815, -308.0233339869265, -286.58133389358386, -5.8003811763569075, -236.59846263098763, -129.85253710163653, -25.15614765257423, -47.60266718022461, -12.189767565939821, -116.79956416370503, -171.81284029179454, -56.43409032006783, -132.57238963386993, -29.73424771989655, -311.2197554435407, -121.18799716820114, -41.609014541854535, -162.00382636860695, -60.609182962377616, -118.75868320114166, -131.47482767080123, -16.681764247192014, -51.24988317140714, -187.5679915037162, -125.0636693645058, -35.63672617879475, -60.9127240821824, -164.80152073417494, -155.36709920103073, -128.41066025229168, -133.01346509093858, -109.83259459233308, -24.29625505579183, -165.28672154605243, -176.0857368538817, -225.20174351963814], "episode_lengths": [59, 88, 105, 70, 75, 64, 85, 95, 91, 123, 69, 80, 48, 46, 71, 108, 91, 54, 118, 86, 100, 59, 67, 90, 85, 68, 37, 80, 113, 85, 95, 77, 100, 81, 61, 36, 88, 46, 84, 50, 81, 87, 43, 93, 94, 68, 81, 103, 75, 46, 77, 38, 87, 46, 110, 84, 95, 60, 54, 73, 60, 92, 130, 73, 70, 116, 113, 36, 97, 88, 46, 55, 35, 78, 86, 56, 90, 55, 119, 75, 55, 94, 57, 68, 87, 43, 94, 89, 84, 55, 61, 82, 79, 86, 75, 81, 45, 94, 94, 98], "policy_policy_0_reward": [-57.632589861158465, -188.04551176577078, -243.91176150150318, -102.95364210517023, -127.67907353542432, -54.30585778623689, -171.08824604306872, -206.38703766862793, -148.12791978567495, -123.2656667993263, -117.34365783776961, -121.33005119419153, -28.479642217620395, -27.519805375860702, -114.61416091935645, -250.37650997514544, -140.87305266977225, -35.04901571825425, -307.80477881738784, -174.18801010011506, -214.19928048897987, -72.46561981005486, -119.46971611178121, -158.62506962592227, -135.48101690008139, -100.85613012528876, -7.183084979512096, -147.05125628118088, -271.03693763752585, -122.244557070665, -161.9814005534746, -138.48933508029103, -119.25284487906546, -167.71699435729252, -88.76856529242787, -11.889060615451559, -115.21327895416441, -40.886813353410204, -156.1236145541856, -21.051925521504344, -153.03442826162652, -128.2009530032883, -20.529591306213042, -195.3982780245208, -167.9980309039687, -99.08864461270475, -162.1085948490981, -201.05037154192945, -118.4149507864785, -39.551423219205276, -94.2242719783823, -15.420372639308114, -136.54193965491723, -18.14215248089452, -259.59229859703646, -117.3406473316434, -163.266381041009, -71.87383503866943, -40.72107988611777, -126.62015940409016, -47.61475263171809, -147.95299254997502, -403.73332080271314, -121.90216759722063, -106.57948859297815, -308.0233339869265, -286.58133389358386, -5.8003811763569075, -236.59846263098763, -129.85253710163653, -25.15614765257423, -47.60266718022461, -12.189767565939821, -116.79956416370503, -171.81284029179454, -56.43409032006783, -132.57238963386993, -29.73424771989655, -311.2197554435407, -121.18799716820114, -41.609014541854535, -162.00382636860695, -60.609182962377616, -118.75868320114166, -131.47482767080123, -16.681764247192014, -51.24988317140714, -187.5679915037162, -125.0636693645058, -35.63672617879475, -60.9127240821824, -164.80152073417494, -155.36709920103073, -128.41066025229168, -133.01346509093858, -109.83259459233308, -24.29625505579183, -165.28672154605243, -176.0857368538817, -225.20174351963814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28907646692057304, "mean_inference_ms": 0.912596262425104, "mean_action_processing_ms": 0.1628571901640167, "mean_env_wait_ms": 2.0674070940406817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005814790725708008, "StateBufferConnector_ms": 0.004203319549560547, "ViewRequirementAgentConnector_ms": 0.10527777671813965}, "num_episodes": 53, "episode_return_max": -5.8003811763569075, "episode_return_min": -403.73332080271314, "episode_return_mean": -125.33293226673419, "episodes_this_iter": 53}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.34190001558426, "num_env_steps_trained_throughput_per_sec": 350.34190001558426, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13113.648, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13113.583, "sample_time_ms": 2880.187, "learn_time_ms": 10217.736, "learn_throughput": 391.476, "synch_weights_time_ms": 14.815}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "64a97_00000", "date": "2024-07-26_23-09-56", "timestamp": 1722015596, "time_this_iter_s": 11.422958135604858, "time_total_s": 278.6817877292633, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.6817877292633, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 15.870588235294118, "ram_util_percent": 28.817647058823532}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.03240115741889, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.3864879774550596, "policy_loss": -0.01719183828633201, "vf_loss": 1.405432200493912, "vf_explained_var": 0.9946933772414923, "kl": 0.014550062993657789, "entropy": 0.8299910166611274, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -1.9633306143532048, "episode_reward_min": -403.73332080271314, "episode_reward_mean": -114.4263468130372, "episode_len_mean": 74.55, "episode_media": {}, "episodes_timesteps_total": 7455, "policy_reward_min": {"policy_0": -403.73332080271314}, "policy_reward_max": {"policy_0": -1.9633306143532048}, "policy_reward_mean": {"policy_0": -114.4263468130372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.59229859703646, -117.3406473316434, -163.266381041009, -71.87383503866943, -40.72107988611777, -126.62015940409016, -47.61475263171809, -147.95299254997502, -403.73332080271314, -121.90216759722063, -106.57948859297815, -308.0233339869265, -286.58133389358386, -5.8003811763569075, -236.59846263098763, -129.85253710163653, -25.15614765257423, -47.60266718022461, -12.189767565939821, -116.79956416370503, -171.81284029179454, -56.43409032006783, -132.57238963386993, -29.73424771989655, -311.2197554435407, -121.18799716820114, -41.609014541854535, -162.00382636860695, -60.609182962377616, -118.75868320114166, -131.47482767080123, -16.681764247192014, -51.24988317140714, -187.5679915037162, -125.0636693645058, -35.63672617879475, -60.9127240821824, -164.80152073417494, -155.36709920103073, -128.41066025229168, -133.01346509093858, -109.83259459233308, -24.29625505579183, -165.28672154605243, -176.0857368538817, -225.20174351963814, -7.344693717215267, -144.66719231392833, -60.086799490653306, -97.58831630904015, -156.17842694653532, -223.62496778502677, -139.58982757870803, -135.58770486604783, -30.89594630016683, -222.62919276753286, -18.017431985815268, -199.52861323213003, -264.95237534029553, -191.88659054191623, -251.94399687341573, -204.49233862562335, -102.72397402318367, -116.23973290931471, -8.221158219913875, -267.5284052966139, -56.41859904643221, -163.90523844749677, -178.79462077987316, -52.90714308985161, -3.283890129537903, -22.849747602923145, -43.55622992702764, -1.9633306143532048, -3.612713114359337, -34.67095616935428, -38.7440531897151, -157.25250301047487, -8.906302193860899, -135.38612609718234, -6.86780937786112, -72.52840394142439, -49.15652130301692, -185.43129541786567, -103.56355672446124, -219.7253386732604, -144.3013137562364, -176.39063344111537, -110.43226008922154, -22.636297427613112, -29.001526232327635, -147.513503454555, -133.64312065432608, -21.087991546084965, -41.384525808684536, -9.496693284019935, -193.23439325405576, -47.7807413744477, -7.538802862398495, -102.3140846040359], "episode_lengths": [110, 84, 95, 60, 54, 73, 60, 92, 130, 73, 70, 116, 113, 36, 97, 88, 46, 55, 35, 78, 86, 56, 90, 55, 119, 75, 55, 94, 57, 68, 87, 43, 94, 89, 84, 55, 61, 82, 79, 86, 75, 81, 45, 94, 94, 98, 35, 92, 106, 70, 90, 105, 99, 92, 46, 99, 41, 102, 110, 89, 105, 97, 66, 81, 34, 112, 58, 80, 144, 63, 37, 42, 53, 36, 34, 53, 51, 83, 35, 86, 34, 58, 59, 88, 65, 141, 78, 112, 69, 42, 52, 80, 86, 44, 52, 38, 97, 57, 40, 70], "policy_policy_0_reward": [-259.59229859703646, -117.3406473316434, -163.266381041009, -71.87383503866943, -40.72107988611777, -126.62015940409016, -47.61475263171809, -147.95299254997502, -403.73332080271314, -121.90216759722063, -106.57948859297815, -308.0233339869265, -286.58133389358386, -5.8003811763569075, -236.59846263098763, -129.85253710163653, -25.15614765257423, -47.60266718022461, -12.189767565939821, -116.79956416370503, -171.81284029179454, -56.43409032006783, -132.57238963386993, -29.73424771989655, -311.2197554435407, -121.18799716820114, -41.609014541854535, -162.00382636860695, -60.609182962377616, -118.75868320114166, -131.47482767080123, -16.681764247192014, -51.24988317140714, -187.5679915037162, -125.0636693645058, -35.63672617879475, -60.9127240821824, -164.80152073417494, -155.36709920103073, -128.41066025229168, -133.01346509093858, -109.83259459233308, -24.29625505579183, -165.28672154605243, -176.0857368538817, -225.20174351963814, -7.344693717215267, -144.66719231392833, -60.086799490653306, -97.58831630904015, -156.17842694653532, -223.62496778502677, -139.58982757870803, -135.58770486604783, -30.89594630016683, -222.62919276753286, -18.017431985815268, -199.52861323213003, -264.95237534029553, -191.88659054191623, -251.94399687341573, -204.49233862562335, -102.72397402318367, -116.23973290931471, -8.221158219913875, -267.5284052966139, -56.41859904643221, -163.90523844749677, -178.79462077987316, -52.90714308985161, -3.283890129537903, -22.849747602923145, -43.55622992702764, -1.9633306143532048, -3.612713114359337, -34.67095616935428, -38.7440531897151, -157.25250301047487, -8.906302193860899, -135.38612609718234, -6.86780937786112, -72.52840394142439, -49.15652130301692, -185.43129541786567, -103.56355672446124, -219.7253386732604, -144.3013137562364, -176.39063344111537, -110.43226008922154, -22.636297427613112, -29.001526232327635, -147.513503454555, -133.64312065432608, -21.087991546084965, -41.384525808684536, -9.496693284019935, -193.23439325405576, -47.7807413744477, -7.538802862398495, -102.3140846040359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891288489068687, "mean_inference_ms": 0.9122955995616395, "mean_action_processing_ms": 0.16268677531006417, "mean_env_wait_ms": 2.0692475361370923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00581049919128418, "StateBufferConnector_ms": 0.0040912628173828125, "ViewRequirementAgentConnector_ms": 0.10272502899169922}, "num_episodes": 54, "episode_return_max": -1.9633306143532048, "episode_return_min": -403.73332080271314, "episode_return_mean": -114.4263468130372, "episodes_this_iter": 54}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.0103199345183, "num_env_steps_trained_throughput_per_sec": 283.0103199345183, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13207.542, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13207.475, "sample_time_ms": 2885.67, "learn_time_ms": 10305.807, "learn_throughput": 388.131, "synch_weights_time_ms": 15.118}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "64a97_00000", "date": "2024-07-26_23-10-11", "timestamp": 1722015611, "time_this_iter_s": 14.139970779418945, "time_total_s": 292.82175850868225, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608738430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.82175850868225, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.925, "ram_util_percent": 28.784999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.66432610054811, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.3467622416093945, "policy_loss": -0.015002357860309228, "vf_loss": 1.3632729734604558, "vf_explained_var": 0.9949407329161962, "kl": 0.014873856577711812, "entropy": 0.8201609643176198, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 8.473446823078934, "episode_reward_min": -411.801508866374, "episode_reward_mean": -108.40780032028937, "episode_len_mean": 71.49, "episode_media": {}, "episodes_timesteps_total": 7149, "policy_reward_min": {"policy_0": -411.801508866374}, "policy_reward_max": {"policy_0": 8.473446823078934}, "policy_reward_mean": {"policy_0": -108.40780032028937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.017431985815268, -199.52861323213003, -264.95237534029553, -191.88659054191623, -251.94399687341573, -204.49233862562335, -102.72397402318367, -116.23973290931471, -8.221158219913875, -267.5284052966139, -56.41859904643221, -163.90523844749677, -178.79462077987316, -52.90714308985161, -3.283890129537903, -22.849747602923145, -43.55622992702764, -1.9633306143532048, -3.612713114359337, -34.67095616935428, -38.7440531897151, -157.25250301047487, -8.906302193860899, -135.38612609718234, -6.86780937786112, -72.52840394142439, -49.15652130301692, -185.43129541786567, -103.56355672446124, -219.7253386732604, -144.3013137562364, -176.39063344111537, -110.43226008922154, -22.636297427613112, -29.001526232327635, -147.513503454555, -133.64312065432608, -21.087991546084965, -41.384525808684536, -9.496693284019935, -193.23439325405576, -47.7807413744477, -7.538802862398495, -102.3140846040359, -127.00123656365713, -204.52470066776647, -411.801508866374, -38.608677563446115, -200.25517602490967, -384.2644494015451, -77.27030759130116, -17.137460855837634, -111.1052648783245, -84.7728593951951, -211.01246534661234, -230.1237877080051, 8.473446823078934, -66.1169353867443, -235.8379326050449, -93.808288833713, -122.82541128770234, -63.75785967059815, -11.438763677942454, -130.11528536931473, -122.83261550763832, -232.6261104823322, -59.26790641816545, -340.0242420604409, -258.3062510195912, -227.41402991113702, -108.08009214960815, -104.31588568202632, -82.96292306653457, -40.67834535754416, -109.533986082427, -63.751454764523594, -222.49889853873273, -45.531582545188996, 0.5682565868587339, -45.47156650718423, -133.77573236998015, -114.86909844843039, -156.73817815367394, -23.26381077567427, -102.8417585673824, -43.570403593696106, -23.650638996237312, -108.47940140698665, -139.4502302682261, -33.36062254985694, -23.751163145298364, -145.31219779639588, -59.583927704277464, -58.47711081840234, -74.72065648855738, -41.8582058952398, -5.094685946646566, -81.81635447123232, -239.64670104018552, -2.671711527710732], "episode_lengths": [41, 102, 110, 89, 105, 97, 66, 81, 34, 112, 58, 80, 144, 63, 37, 42, 53, 36, 34, 53, 51, 83, 35, 86, 34, 58, 59, 88, 65, 141, 78, 112, 69, 42, 52, 80, 86, 44, 52, 38, 97, 57, 40, 70, 88, 99, 133, 53, 100, 128, 62, 41, 82, 64, 96, 96, 29, 56, 105, 68, 76, 60, 44, 80, 74, 107, 56, 124, 108, 103, 83, 63, 63, 55, 86, 55, 97, 58, 31, 57, 89, 73, 79, 45, 70, 60, 46, 70, 91, 50, 46, 76, 58, 60, 62, 54, 36, 68, 150, 32], "policy_policy_0_reward": [-18.017431985815268, -199.52861323213003, -264.95237534029553, -191.88659054191623, -251.94399687341573, -204.49233862562335, -102.72397402318367, -116.23973290931471, -8.221158219913875, -267.5284052966139, -56.41859904643221, -163.90523844749677, -178.79462077987316, -52.90714308985161, -3.283890129537903, -22.849747602923145, -43.55622992702764, -1.9633306143532048, -3.612713114359337, -34.67095616935428, -38.7440531897151, -157.25250301047487, -8.906302193860899, -135.38612609718234, -6.86780937786112, -72.52840394142439, -49.15652130301692, -185.43129541786567, -103.56355672446124, -219.7253386732604, -144.3013137562364, -176.39063344111537, -110.43226008922154, -22.636297427613112, -29.001526232327635, -147.513503454555, -133.64312065432608, -21.087991546084965, -41.384525808684536, -9.496693284019935, -193.23439325405576, -47.7807413744477, -7.538802862398495, -102.3140846040359, -127.00123656365713, -204.52470066776647, -411.801508866374, -38.608677563446115, -200.25517602490967, -384.2644494015451, -77.27030759130116, -17.137460855837634, -111.1052648783245, -84.7728593951951, -211.01246534661234, -230.1237877080051, 8.473446823078934, -66.1169353867443, -235.8379326050449, -93.808288833713, -122.82541128770234, -63.75785967059815, -11.438763677942454, -130.11528536931473, -122.83261550763832, -232.6261104823322, -59.26790641816545, -340.0242420604409, -258.3062510195912, -227.41402991113702, -108.08009214960815, -104.31588568202632, -82.96292306653457, -40.67834535754416, -109.533986082427, -63.751454764523594, -222.49889853873273, -45.531582545188996, 0.5682565868587339, -45.47156650718423, -133.77573236998015, -114.86909844843039, -156.73817815367394, -23.26381077567427, -102.8417585673824, -43.570403593696106, -23.650638996237312, -108.47940140698665, -139.4502302682261, -33.36062254985694, -23.751163145298364, -145.31219779639588, -59.583927704277464, -58.47711081840234, -74.72065648855738, -41.8582058952398, -5.094685946646566, -81.81635447123232, -239.64670104018552, -2.671711527710732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891587870841263, "mean_inference_ms": 0.9121948108536877, "mean_action_processing_ms": 0.16255395078019738, "mean_env_wait_ms": 2.070934546710834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005719900131225586, "StateBufferConnector_ms": 0.004128217697143555, "ViewRequirementAgentConnector_ms": 0.10122060775756836}, "num_episodes": 56, "episode_return_max": 8.473446823078934, "episode_return_min": -411.801508866374, "episode_return_mean": -108.40780032028937, "episodes_this_iter": 56}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.22599168226924, "num_env_steps_trained_throughput_per_sec": 319.22599168226924, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13186.208, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13186.14, "sample_time_ms": 2892.26, "learn_time_ms": 10277.643, "learn_throughput": 389.194, "synch_weights_time_ms": 15.325}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "64a97_00000", "date": "2024-07-26_23-10-23", "timestamp": 1722015623, "time_this_iter_s": 12.537704467773438, "time_total_s": 305.3594629764557, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.3594629764557, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.7, "ram_util_percent": 28.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.45359222690264, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.068724086585765, "policy_loss": -0.01696272075884432, "vf_loss": 1.0876213346918424, "vf_explained_var": 0.9974636398876707, "kl": 0.01382955310367229, "entropy": 0.8157826097061237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 8.473446823078934, "episode_reward_min": -340.0242420604409, "episode_reward_mean": -103.58289635882242, "episode_len_mean": 71.29, "episode_media": {}, "episodes_timesteps_total": 7129, "policy_reward_min": {"policy_0": -340.0242420604409}, "policy_reward_max": {"policy_0": 8.473446823078934}, "policy_reward_mean": {"policy_0": -103.58289635882242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-230.1237877080051, 8.473446823078934, -66.1169353867443, -235.8379326050449, -93.808288833713, -122.82541128770234, -63.75785967059815, -11.438763677942454, -130.11528536931473, -122.83261550763832, -232.6261104823322, -59.26790641816545, -340.0242420604409, -258.3062510195912, -227.41402991113702, -108.08009214960815, -104.31588568202632, -82.96292306653457, -40.67834535754416, -109.533986082427, -63.751454764523594, -222.49889853873273, -45.531582545188996, 0.5682565868587339, -45.47156650718423, -133.77573236998015, -114.86909844843039, -156.73817815367394, -23.26381077567427, -102.8417585673824, -43.570403593696106, -23.650638996237312, -108.47940140698665, -139.4502302682261, -33.36062254985694, -23.751163145298364, -145.31219779639588, -59.583927704277464, -58.47711081840234, -74.72065648855738, -41.8582058952398, -5.094685946646566, -81.81635447123232, -239.64670104018552, -2.671711527710732, -218.3961623554202, -77.18687123271236, -93.91752553894165, -212.75415456188355, -17.03581204877709, -116.62978566791239, -32.93133670841266, -104.09442635942216, -117.56980230918987, -5.482954360225774, -2.195419780270919, -126.76581601853233, -204.3985273112022, -169.8609187123312, -102.29917424731246, -75.7915677029071, -149.81682299676004, -82.16723263738088, -93.97171051544585, -91.94341839060928, -124.65014492112871, -149.8752842509988, -166.91171353047568, -187.11224453504127, -64.40629076474526, -34.45334313426645, -138.28544969369742, -265.63481546302324, -143.52613308394206, -93.63812594697812, -156.09581998891153, -38.97212471287796, -182.4963064828568, -216.0539097647965, -0.244421409318754, -50.19422322543534, -110.15518269260424, -25.735419799308268, 1.3693274877030825, -3.0381286784135795, -158.3585995739503, -20.273948285920603, -221.0086547846802, -57.809437573919794, -63.910155249791785, -196.13688194486306, -61.05396891208974, -116.4514216339628, -21.84121414179182, -77.59881155285923, -123.06376368186825, -263.621025337775, -46.15726245938094, 2.5460714202719235, -67.02032693659966], "episode_lengths": [96, 29, 56, 105, 68, 76, 60, 44, 80, 74, 107, 56, 124, 108, 103, 83, 63, 63, 55, 86, 55, 97, 58, 31, 57, 89, 73, 79, 45, 70, 60, 46, 70, 91, 50, 46, 76, 58, 60, 62, 54, 36, 68, 150, 32, 100, 58, 81, 99, 50, 70, 56, 67, 85, 39, 28, 82, 88, 97, 71, 60, 92, 62, 64, 73, 88, 92, 80, 86, 55, 53, 91, 113, 88, 70, 92, 57, 84, 108, 40, 60, 73, 43, 34, 38, 87, 48, 106, 61, 108, 99, 54, 79, 44, 62, 88, 112, 62, 38, 65], "policy_policy_0_reward": [-230.1237877080051, 8.473446823078934, -66.1169353867443, -235.8379326050449, -93.808288833713, -122.82541128770234, -63.75785967059815, -11.438763677942454, -130.11528536931473, -122.83261550763832, -232.6261104823322, -59.26790641816545, -340.0242420604409, -258.3062510195912, -227.41402991113702, -108.08009214960815, -104.31588568202632, -82.96292306653457, -40.67834535754416, -109.533986082427, -63.751454764523594, -222.49889853873273, -45.531582545188996, 0.5682565868587339, -45.47156650718423, -133.77573236998015, -114.86909844843039, -156.73817815367394, -23.26381077567427, -102.8417585673824, -43.570403593696106, -23.650638996237312, -108.47940140698665, -139.4502302682261, -33.36062254985694, -23.751163145298364, -145.31219779639588, -59.583927704277464, -58.47711081840234, -74.72065648855738, -41.8582058952398, -5.094685946646566, -81.81635447123232, -239.64670104018552, -2.671711527710732, -218.3961623554202, -77.18687123271236, -93.91752553894165, -212.75415456188355, -17.03581204877709, -116.62978566791239, -32.93133670841266, -104.09442635942216, -117.56980230918987, -5.482954360225774, -2.195419780270919, -126.76581601853233, -204.3985273112022, -169.8609187123312, -102.29917424731246, -75.7915677029071, -149.81682299676004, -82.16723263738088, -93.97171051544585, -91.94341839060928, -124.65014492112871, -149.8752842509988, -166.91171353047568, -187.11224453504127, -64.40629076474526, -34.45334313426645, -138.28544969369742, -265.63481546302324, -143.52613308394206, -93.63812594697812, -156.09581998891153, -38.97212471287796, -182.4963064828568, -216.0539097647965, -0.244421409318754, -50.19422322543534, -110.15518269260424, -25.735419799308268, 1.3693274877030825, -3.0381286784135795, -158.3585995739503, -20.273948285920603, -221.0086547846802, -57.809437573919794, -63.910155249791785, -196.13688194486306, -61.05396891208974, -116.4514216339628, -21.84121414179182, -77.59881155285923, -123.06376368186825, -263.621025337775, -46.15726245938094, 2.5460714202719235, -67.02032693659966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897771327533669, "mean_inference_ms": 0.9127432706938056, "mean_action_processing_ms": 0.1627391635333185, "mean_env_wait_ms": 2.0758466095867387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005650997161865234, "StateBufferConnector_ms": 0.004159688949584961, "ViewRequirementAgentConnector_ms": 0.10239052772521973}, "num_episodes": 55, "episode_return_max": 8.473446823078934, "episode_return_min": -340.0242420604409, "episode_return_mean": -103.58289635882242, "episodes_this_iter": 55}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.40711693486026, "num_env_steps_trained_throughput_per_sec": 278.40711693486026, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13322.931, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13322.861, "sample_time_ms": 2948.805, "learn_time_ms": 10356.673, "learn_throughput": 386.224, "synch_weights_time_ms": 16.424}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "64a97_00000", "date": "2024-07-26_23-10-38", "timestamp": 1722015638, "time_this_iter_s": 14.374157905578613, "time_total_s": 319.7336208820343, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.7336208820343, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.150000000000002, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.48260178963343, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.1537113562226295, "policy_loss": -0.01887202211849702, "vf_loss": 1.1746151762083172, "vf_explained_var": 0.996789516756932, "kl": 0.01376791241909815, "entropy": 0.822736315180858, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 9.616133104681252, "episode_reward_min": -638.1841974698004, "episode_reward_mean": -111.25111578015785, "episode_len_mean": 72.93, "episode_media": {}, "episodes_timesteps_total": 7293, "policy_reward_min": {"policy_0": -638.1841974698004}, "policy_reward_max": {"policy_0": 9.616133104681252}, "policy_reward_mean": {"policy_0": -111.25111578015785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.195419780270919, -126.76581601853233, -204.3985273112022, -169.8609187123312, -102.29917424731246, -75.7915677029071, -149.81682299676004, -82.16723263738088, -93.97171051544585, -91.94341839060928, -124.65014492112871, -149.8752842509988, -166.91171353047568, -187.11224453504127, -64.40629076474526, -34.45334313426645, -138.28544969369742, -265.63481546302324, -143.52613308394206, -93.63812594697812, -156.09581998891153, -38.97212471287796, -182.4963064828568, -216.0539097647965, -0.244421409318754, -50.19422322543534, -110.15518269260424, -25.735419799308268, 1.3693274877030825, -3.0381286784135795, -158.3585995739503, -20.273948285920603, -221.0086547846802, -57.809437573919794, -63.910155249791785, -196.13688194486306, -61.05396891208974, -116.4514216339628, -21.84121414179182, -77.59881155285923, -123.06376368186825, -263.621025337775, -46.15726245938094, 2.5460714202719235, -67.02032693659966, -16.125704556218132, -78.53514835107624, -40.81717517402723, -638.1841974698004, -140.36374511900618, -47.8976597095137, -157.63359147346927, -215.06280986597844, -191.8260748574235, 3.167558504181397, -211.65173284511008, -215.91627604473445, -124.62002321792458, -143.1076633153962, -180.2661132620159, -212.9820945268382, -64.13450406154071, -58.3717835396487, -49.44905070018742, -57.833455624056356, -2.7602288961413084, -8.669246638530876, -156.52428900246426, -110.13575349076606, -65.38215407427026, 9.616133104681252, -38.40848893507847, -127.57228994579135, -82.20391307425682, -161.71485534216524, -8.088532717721655, -16.221213825101618, -89.0940789002662, -86.41963968987064, -163.7295399701694, -120.03241614130826, -21.21206878520601, -59.89823396494449, -149.5855360621496, -34.531616978535475, -15.90907322513599, -91.37342452257948, -524.9086526456977, -27.040590138217315, 2.9182589058397133, -270.739088262395, -128.76979782715694, -249.77031469435005, -82.28580138714213, -110.93109483176848, -166.86206491017265, -0.024184780581933185, -49.795983972816316, -133.51667472425333, -200.84411890646652], "episode_lengths": [28, 82, 88, 97, 71, 60, 92, 62, 64, 73, 88, 92, 80, 86, 55, 53, 91, 113, 88, 70, 92, 57, 84, 108, 40, 60, 73, 43, 34, 38, 87, 48, 106, 61, 108, 99, 54, 79, 44, 62, 88, 112, 62, 38, 65, 50, 61, 62, 150, 92, 57, 92, 92, 88, 31, 103, 101, 85, 92, 99, 100, 56, 53, 57, 56, 30, 41, 89, 72, 60, 39, 98, 77, 60, 87, 41, 39, 63, 65, 93, 78, 49, 55, 83, 53, 45, 70, 145, 46, 34, 113, 75, 110, 65, 83, 92, 42, 62, 90, 97], "policy_policy_0_reward": [-2.195419780270919, -126.76581601853233, -204.3985273112022, -169.8609187123312, -102.29917424731246, -75.7915677029071, -149.81682299676004, -82.16723263738088, -93.97171051544585, -91.94341839060928, -124.65014492112871, -149.8752842509988, -166.91171353047568, -187.11224453504127, -64.40629076474526, -34.45334313426645, -138.28544969369742, -265.63481546302324, -143.52613308394206, -93.63812594697812, -156.09581998891153, -38.97212471287796, -182.4963064828568, -216.0539097647965, -0.244421409318754, -50.19422322543534, -110.15518269260424, -25.735419799308268, 1.3693274877030825, -3.0381286784135795, -158.3585995739503, -20.273948285920603, -221.0086547846802, -57.809437573919794, -63.910155249791785, -196.13688194486306, -61.05396891208974, -116.4514216339628, -21.84121414179182, -77.59881155285923, -123.06376368186825, -263.621025337775, -46.15726245938094, 2.5460714202719235, -67.02032693659966, -16.125704556218132, -78.53514835107624, -40.81717517402723, -638.1841974698004, -140.36374511900618, -47.8976597095137, -157.63359147346927, -215.06280986597844, -191.8260748574235, 3.167558504181397, -211.65173284511008, -215.91627604473445, -124.62002321792458, -143.1076633153962, -180.2661132620159, -212.9820945268382, -64.13450406154071, -58.3717835396487, -49.44905070018742, -57.833455624056356, -2.7602288961413084, -8.669246638530876, -156.52428900246426, -110.13575349076606, -65.38215407427026, 9.616133104681252, -38.40848893507847, -127.57228994579135, -82.20391307425682, -161.71485534216524, -8.088532717721655, -16.221213825101618, -89.0940789002662, -86.41963968987064, -163.7295399701694, -120.03241614130826, -21.21206878520601, -59.89823396494449, -149.5855360621496, -34.531616978535475, -15.90907322513599, -91.37342452257948, -524.9086526456977, -27.040590138217315, 2.9182589058397133, -270.739088262395, -128.76979782715694, -249.77031469435005, -82.28580138714213, -110.93109483176848, -166.86206491017265, -0.024184780581933185, -49.795983972816316, -133.51667472425333, -200.84411890646652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2907620985557472, "mean_inference_ms": 0.9135166425044139, "mean_action_processing_ms": 0.16286213292643828, "mean_env_wait_ms": 2.0820173625055416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005923748016357422, "StateBufferConnector_ms": 0.0041887760162353516, "ViewRequirementAgentConnector_ms": 0.10617756843566895}, "num_episodes": 55, "episode_return_max": 9.616133104681252, "episode_return_min": -638.1841974698004, "episode_return_mean": -111.25111578015785, "episodes_this_iter": 55}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.83277139980584, "num_env_steps_trained_throughput_per_sec": 274.83277139980584, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 13444.127, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13444.056, "sample_time_ms": 2987.791, "learn_time_ms": 10439.002, "learn_throughput": 383.178, "synch_weights_time_ms": 16.342}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "64a97_00000", "date": "2024-07-26_23-10-52", "timestamp": 1722015652, "time_this_iter_s": 14.560122728347778, "time_total_s": 334.2937436103821, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bbe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.2937436103821, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.9, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.97485849559307, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9542320799392958, "policy_loss": -0.017961225906522788, "vf_loss": 0.9723844864095251, "vf_explained_var": 0.9972116306424141, "kl": 0.01731588504165606, "entropy": 0.7983332086354494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 9.927527067401012, "episode_reward_min": -524.9086526456977, "episode_reward_mean": -98.81991905852605, "episode_len_mean": 70.07, "episode_media": {}, "episodes_timesteps_total": 7007, "policy_reward_min": {"policy_0": -524.9086526456977}, "policy_reward_max": {"policy_0": 9.927527067401012}, "policy_reward_mean": {"policy_0": -98.81991905852605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.1076633153962, -180.2661132620159, -212.9820945268382, -64.13450406154071, -58.3717835396487, -49.44905070018742, -57.833455624056356, -2.7602288961413084, -8.669246638530876, -156.52428900246426, -110.13575349076606, -65.38215407427026, 9.616133104681252, -38.40848893507847, -127.57228994579135, -82.20391307425682, -161.71485534216524, -8.088532717721655, -16.221213825101618, -89.0940789002662, -86.41963968987064, -163.7295399701694, -120.03241614130826, -21.21206878520601, -59.89823396494449, -149.5855360621496, -34.531616978535475, -15.90907322513599, -91.37342452257948, -524.9086526456977, -27.040590138217315, 2.9182589058397133, -270.739088262395, -128.76979782715694, -249.77031469435005, -82.28580138714213, -110.93109483176848, -166.86206491017265, -0.024184780581933185, -49.795983972816316, -133.51667472425333, -200.84411890646652, -254.32511659855194, -73.63349489807511, -0.015574414000470327, -55.62093315744622, -196.99944278676153, -45.463230734041446, -1.760680353575498, -185.18342900495216, -29.482955962193916, -54.59328696884287, -70.44953102726673, -37.13108999573307, -114.2682060300936, 9.927527067401012, -209.80907916091405, -18.49599298608102, -6.691785915504887, -11.365466441042365, -132.72722891410075, -43.43234734070363, -36.48583505910455, -26.1943449916239, -12.706112240857344, -113.83371905680376, -24.52867771744409, -64.23230988512593, -19.284833020836658, -69.32450577454432, -30.88332030202644, -57.7898068491117, -6.163257778339686, -117.314188503574, -123.13137697875153, -144.5238371547901, -45.79800623725209, -167.8902488470672, -20.94055086517765, -15.792171019317488, -190.28450240023025, -121.86570016202975, -194.47108317845883, -79.04535745046789, 0.3714407181088152, -278.79528202300304, -203.39200538118254, -105.69835476045388, -119.24472265656644, -249.14352975289424, -27.82635030114903, -113.16081847417732, -222.70751512884118, -274.1576776777825, -80.96327636491468, -199.27556647500438, 9.160389733787254, -92.48242655129529, -246.2896556313658, -155.8162297478194], "episode_lengths": [92, 99, 100, 56, 53, 57, 56, 30, 41, 89, 72, 60, 39, 98, 77, 60, 87, 41, 39, 63, 65, 93, 78, 49, 55, 83, 53, 45, 70, 145, 46, 34, 113, 75, 110, 65, 83, 92, 42, 62, 90, 97, 103, 64, 35, 58, 102, 61, 40, 101, 55, 55, 66, 58, 87, 30, 94, 50, 37, 40, 80, 59, 55, 57, 51, 73, 45, 57, 50, 60, 48, 55, 44, 85, 81, 89, 46, 98, 52, 39, 93, 78, 88, 75, 41, 117, 103, 74, 88, 110, 49, 85, 112, 115, 79, 101, 31, 64, 109, 81], "policy_policy_0_reward": [-143.1076633153962, -180.2661132620159, -212.9820945268382, -64.13450406154071, -58.3717835396487, -49.44905070018742, -57.833455624056356, -2.7602288961413084, -8.669246638530876, -156.52428900246426, -110.13575349076606, -65.38215407427026, 9.616133104681252, -38.40848893507847, -127.57228994579135, -82.20391307425682, -161.71485534216524, -8.088532717721655, -16.221213825101618, -89.0940789002662, -86.41963968987064, -163.7295399701694, -120.03241614130826, -21.21206878520601, -59.89823396494449, -149.5855360621496, -34.531616978535475, -15.90907322513599, -91.37342452257948, -524.9086526456977, -27.040590138217315, 2.9182589058397133, -270.739088262395, -128.76979782715694, -249.77031469435005, -82.28580138714213, -110.93109483176848, -166.86206491017265, -0.024184780581933185, -49.795983972816316, -133.51667472425333, -200.84411890646652, -254.32511659855194, -73.63349489807511, -0.015574414000470327, -55.62093315744622, -196.99944278676153, -45.463230734041446, -1.760680353575498, -185.18342900495216, -29.482955962193916, -54.59328696884287, -70.44953102726673, -37.13108999573307, -114.2682060300936, 9.927527067401012, -209.80907916091405, -18.49599298608102, -6.691785915504887, -11.365466441042365, -132.72722891410075, -43.43234734070363, -36.48583505910455, -26.1943449916239, -12.706112240857344, -113.83371905680376, -24.52867771744409, -64.23230988512593, -19.284833020836658, -69.32450577454432, -30.88332030202644, -57.7898068491117, -6.163257778339686, -117.314188503574, -123.13137697875153, -144.5238371547901, -45.79800623725209, -167.8902488470672, -20.94055086517765, -15.792171019317488, -190.28450240023025, -121.86570016202975, -194.47108317845883, -79.04535745046789, 0.3714407181088152, -278.79528202300304, -203.39200538118254, -105.69835476045388, -119.24472265656644, -249.14352975289424, -27.82635030114903, -113.16081847417732, -222.70751512884118, -274.1576776777825, -80.96327636491468, -199.27556647500438, 9.160389733787254, -92.48242655129529, -246.2896556313658, -155.8162297478194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915872855624493, "mean_inference_ms": 0.9142706785685566, "mean_action_processing_ms": 0.1629790916459117, "mean_env_wait_ms": 2.08759575270202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00642704963684082, "StateBufferConnector_ms": 0.004256248474121094, "ViewRequirementAgentConnector_ms": 0.10721206665039062}, "num_episodes": 58, "episode_return_max": 9.927527067401012, "episode_return_min": -524.9086526456977, "episode_return_mean": -98.81991905852605, "episodes_this_iter": 58}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.5280204248008, "num_env_steps_trained_throughput_per_sec": 287.5280204248008, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 13644.831, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13644.76, "sample_time_ms": 3019.543, "learn_time_ms": 10608.099, "learn_throughput": 377.07, "synch_weights_time_ms": 16.219}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "64a97_00000", "date": "2024-07-26_23-11-06", "timestamp": 1722015666, "time_this_iter_s": 13.918224096298218, "time_total_s": 348.2119677066803, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087ba7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 348.2119677066803, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.23, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.95940247227749, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.6846973286165545, "policy_loss": -0.017906817601275785, "vf_loss": 0.7031165657720219, "vf_explained_var": 0.9976698992153009, "kl": 0.015219899258227098, "entropy": 0.7361374738936622, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 9.160389733787254, "episode_reward_min": -278.79528202300304, "episode_reward_mean": -96.62484139767838, "episode_len_mean": 70.41, "episode_media": {}, "episodes_timesteps_total": 7041, "policy_reward_min": {"policy_0": -278.79528202300304}, "policy_reward_max": {"policy_0": 9.160389733787254}, "policy_reward_mean": {"policy_0": -96.62484139767838}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.49599298608102, -6.691785915504887, -11.365466441042365, -132.72722891410075, -43.43234734070363, -36.48583505910455, -26.1943449916239, -12.706112240857344, -113.83371905680376, -24.52867771744409, -64.23230988512593, -19.284833020836658, -69.32450577454432, -30.88332030202644, -57.7898068491117, -6.163257778339686, -117.314188503574, -123.13137697875153, -144.5238371547901, -45.79800623725209, -167.8902488470672, -20.94055086517765, -15.792171019317488, -190.28450240023025, -121.86570016202975, -194.47108317845883, -79.04535745046789, 0.3714407181088152, -278.79528202300304, -203.39200538118254, -105.69835476045388, -119.24472265656644, -249.14352975289424, -27.82635030114903, -113.16081847417732, -222.70751512884118, -274.1576776777825, -80.96327636491468, -199.27556647500438, 9.160389733787254, -92.48242655129529, -246.2896556313658, -155.8162297478194, -27.027710345621877, -75.41234652158867, -130.513148094245, -86.48488828896991, -235.92306698582075, -72.06791503091347, -151.683939313148, -175.36924430779197, -222.1679662371338, -91.95039670404199, -40.32813950424414, -33.17789366033167, 1.1358414531961352, -68.87378815645293, -214.51620472710874, -158.18594337785032, -47.016021221210224, -119.45845752398182, 0.8659746508115247, -130.03694146808442, -133.2974980880552, -6.711512715995709, -23.743077443255846, -92.2452472236889, -213.74530991903407, -230.58722426829618, -27.852469903960863, -14.648529772176422, -123.26796800975494, -36.50184286709432, -189.04760561411373, -95.0175668425887, -51.70975005523537, -50.06316399521245, -142.71787451020117, 8.247616703185686, -94.79346720750233, -21.267984350116617, -196.80358037333298, -81.78355359239383, -24.95473055770783, -233.29193172774205, -59.4662471545779, -94.07512496714156, -222.43263074072235, -29.867969983324368, -38.87601004283409, -101.4725135822138, -82.70477724050893, -82.96278597093533, -2.3263486354717706, -73.26131445537288, -94.8717122208606, -39.96702187303518, -189.8102878733905, -80.83849275109668, -60.93628703262498], "episode_lengths": [50, 37, 40, 80, 59, 55, 57, 51, 73, 45, 57, 50, 60, 48, 55, 44, 85, 81, 89, 46, 98, 52, 39, 93, 78, 88, 75, 41, 117, 103, 74, 88, 110, 49, 85, 112, 115, 79, 101, 31, 64, 109, 81, 51, 67, 91, 64, 110, 59, 87, 88, 104, 68, 56, 59, 43, 67, 95, 92, 58, 86, 35, 76, 93, 42, 47, 67, 104, 105, 53, 50, 74, 58, 95, 82, 52, 61, 80, 33, 68, 53, 95, 65, 52, 107, 60, 82, 102, 50, 55, 85, 80, 61, 33, 66, 66, 56, 88, 63, 58], "policy_policy_0_reward": [-18.49599298608102, -6.691785915504887, -11.365466441042365, -132.72722891410075, -43.43234734070363, -36.48583505910455, -26.1943449916239, -12.706112240857344, -113.83371905680376, -24.52867771744409, -64.23230988512593, -19.284833020836658, -69.32450577454432, -30.88332030202644, -57.7898068491117, -6.163257778339686, -117.314188503574, -123.13137697875153, -144.5238371547901, -45.79800623725209, -167.8902488470672, -20.94055086517765, -15.792171019317488, -190.28450240023025, -121.86570016202975, -194.47108317845883, -79.04535745046789, 0.3714407181088152, -278.79528202300304, -203.39200538118254, -105.69835476045388, -119.24472265656644, -249.14352975289424, -27.82635030114903, -113.16081847417732, -222.70751512884118, -274.1576776777825, -80.96327636491468, -199.27556647500438, 9.160389733787254, -92.48242655129529, -246.2896556313658, -155.8162297478194, -27.027710345621877, -75.41234652158867, -130.513148094245, -86.48488828896991, -235.92306698582075, -72.06791503091347, -151.683939313148, -175.36924430779197, -222.1679662371338, -91.95039670404199, -40.32813950424414, -33.17789366033167, 1.1358414531961352, -68.87378815645293, -214.51620472710874, -158.18594337785032, -47.016021221210224, -119.45845752398182, 0.8659746508115247, -130.03694146808442, -133.2974980880552, -6.711512715995709, -23.743077443255846, -92.2452472236889, -213.74530991903407, -230.58722426829618, -27.852469903960863, -14.648529772176422, -123.26796800975494, -36.50184286709432, -189.04760561411373, -95.0175668425887, -51.70975005523537, -50.06316399521245, -142.71787451020117, 8.247616703185686, -94.79346720750233, -21.267984350116617, -196.80358037333298, -81.78355359239383, -24.95473055770783, -233.29193172774205, -59.4662471545779, -94.07512496714156, -222.43263074072235, -29.867969983324368, -38.87601004283409, -101.4725135822138, -82.70477724050893, -82.96278597093533, -2.3263486354717706, -73.26131445537288, -94.8717122208606, -39.96702187303518, -189.8102878733905, -80.83849275109668, -60.93628703262498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919298256923095, "mean_inference_ms": 0.9152085833644047, "mean_action_processing_ms": 0.16311407964758626, "mean_env_wait_ms": 2.0911385573080477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006018161773681641, "StateBufferConnector_ms": 0.004189968109130859, "ViewRequirementAgentConnector_ms": 0.1056671142578125}, "num_episodes": 57, "episode_return_max": 9.160389733787254, "episode_return_min": -278.79528202300304, "episode_return_mean": -96.62484139767838, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.30248072273645, "num_env_steps_trained_throughput_per_sec": 269.30248072273645, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13785.066, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13784.992, "sample_time_ms": 3024.067, "learn_time_ms": 10743.745, "learn_throughput": 372.31, "synch_weights_time_ms": 16.273}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "64a97_00000", "date": "2024-07-26_23-11-21", "timestamp": 1722015681, "time_this_iter_s": 14.863855838775635, "time_total_s": 363.07582354545593, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.07582354545593, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.733333333333334, "ram_util_percent": 28.84761904761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.34825946738322, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7490973942292233, "policy_loss": -0.010554093956307043, "vf_loss": 0.7605941557635864, "vf_explained_var": 0.9975067570184668, "kl": 0.014060619355223038, "entropy": 0.726994785045584, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": 8.247616703185686, "episode_reward_min": -250.74859866140918, "episode_reward_mean": -90.02473475566063, "episode_len_mean": 68.88, "episode_media": {}, "episodes_timesteps_total": 6888, "policy_reward_min": {"policy_0": -250.74859866140918}, "policy_reward_max": {"policy_0": 8.247616703185686}, "policy_reward_mean": {"policy_0": -90.02473475566063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.18594337785032, -47.016021221210224, -119.45845752398182, 0.8659746508115247, -130.03694146808442, -133.2974980880552, -6.711512715995709, -23.743077443255846, -92.2452472236889, -213.74530991903407, -230.58722426829618, -27.852469903960863, -14.648529772176422, -123.26796800975494, -36.50184286709432, -189.04760561411373, -95.0175668425887, -51.70975005523537, -50.06316399521245, -142.71787451020117, 8.247616703185686, -94.79346720750233, -21.267984350116617, -196.80358037333298, -81.78355359239383, -24.95473055770783, -233.29193172774205, -59.4662471545779, -94.07512496714156, -222.43263074072235, -29.867969983324368, -38.87601004283409, -101.4725135822138, -82.70477724050893, -82.96278597093533, -2.3263486354717706, -73.26131445537288, -94.8717122208606, -39.96702187303518, -189.8102878733905, -80.83849275109668, -60.93628703262498, -32.9692728176285, -118.91087801683855, -51.7280925727603, -225.9115055242567, -196.9255213735915, -26.722072515164704, -158.79655438171918, -10.363526996430258, -85.64076545683763, -112.45164698356595, -103.24128549107057, -84.40972722548153, -70.1012929495535, -99.74955874908353, -97.73767571353203, 4.594447600144172, -23.480276509550034, 5.186548590106417, -130.15394786124648, -250.74859866140918, -40.87209850777637, -69.26188622093784, -93.23419313674736, -81.70942127122164, -21.561947943528, -130.48396326379788, -66.58731393226613, -210.07069216217334, -42.339226582579585, -10.2564113117499, -189.3978160289874, -180.51765267964157, -153.48984944560527, 6.781919069753849, -15.900676984031648, -67.94209958151927, -82.76801252731502, -151.01060980228155, -118.76739648010495, -136.49245066806367, -16.837647154297738, -104.83150065356526, -95.31979994779624, -168.55340347432477, -83.36551584331474, -22.059579585845643, -2.430324628357462, -10.587022487951105, -103.14006156436152, -185.5782720202276, -29.945505479321323, -99.27449198133309, -157.50859340961523, -63.72819419946026, -124.94196366219839, -116.0803303581392, -93.36593382973278, -15.277146417475072], "episode_lengths": [92, 58, 86, 35, 76, 93, 42, 47, 67, 104, 105, 53, 50, 74, 58, 95, 82, 52, 61, 80, 33, 68, 53, 95, 65, 52, 107, 60, 82, 102, 50, 55, 85, 80, 61, 33, 66, 66, 56, 88, 63, 58, 50, 81, 52, 99, 96, 44, 83, 43, 80, 84, 70, 80, 60, 69, 70, 33, 50, 33, 69, 110, 60, 57, 81, 65, 55, 88, 61, 105, 57, 43, 100, 89, 84, 38, 46, 65, 64, 80, 81, 85, 41, 83, 82, 97, 62, 44, 40, 43, 78, 89, 53, 82, 96, 63, 86, 84, 77, 40], "policy_policy_0_reward": [-158.18594337785032, -47.016021221210224, -119.45845752398182, 0.8659746508115247, -130.03694146808442, -133.2974980880552, -6.711512715995709, -23.743077443255846, -92.2452472236889, -213.74530991903407, -230.58722426829618, -27.852469903960863, -14.648529772176422, -123.26796800975494, -36.50184286709432, -189.04760561411373, -95.0175668425887, -51.70975005523537, -50.06316399521245, -142.71787451020117, 8.247616703185686, -94.79346720750233, -21.267984350116617, -196.80358037333298, -81.78355359239383, -24.95473055770783, -233.29193172774205, -59.4662471545779, -94.07512496714156, -222.43263074072235, -29.867969983324368, -38.87601004283409, -101.4725135822138, -82.70477724050893, -82.96278597093533, -2.3263486354717706, -73.26131445537288, -94.8717122208606, -39.96702187303518, -189.8102878733905, -80.83849275109668, -60.93628703262498, -32.9692728176285, -118.91087801683855, -51.7280925727603, -225.9115055242567, -196.9255213735915, -26.722072515164704, -158.79655438171918, -10.363526996430258, -85.64076545683763, -112.45164698356595, -103.24128549107057, -84.40972722548153, -70.1012929495535, -99.74955874908353, -97.73767571353203, 4.594447600144172, -23.480276509550034, 5.186548590106417, -130.15394786124648, -250.74859866140918, -40.87209850777637, -69.26188622093784, -93.23419313674736, -81.70942127122164, -21.561947943528, -130.48396326379788, -66.58731393226613, -210.07069216217334, -42.339226582579585, -10.2564113117499, -189.3978160289874, -180.51765267964157, -153.48984944560527, 6.781919069753849, -15.900676984031648, -67.94209958151927, -82.76801252731502, -151.01060980228155, -118.76739648010495, -136.49245066806367, -16.837647154297738, -104.83150065356526, -95.31979994779624, -168.55340347432477, -83.36551584331474, -22.059579585845643, -2.430324628357462, -10.587022487951105, -103.14006156436152, -185.5782720202276, -29.945505479321323, -99.27449198133309, -157.50859340961523, -63.72819419946026, -124.94196366219839, -116.0803303581392, -93.36593382973278, -15.277146417475072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918816843549468, "mean_inference_ms": 0.9143890461305395, "mean_action_processing_ms": 0.16308550363917168, "mean_env_wait_ms": 2.0916721694634264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005628824234008789, "StateBufferConnector_ms": 0.004032135009765625, "ViewRequirementAgentConnector_ms": 0.10126972198486328}, "num_episodes": 58, "episode_return_max": 8.247616703185686, "episode_return_min": -250.74859866140918, "episode_return_mean": -90.02473475566063, "episodes_this_iter": 58}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.546355137906, "num_env_steps_trained_throughput_per_sec": 275.546355137906, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 13805.946, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13805.873, "sample_time_ms": 3021.257, "learn_time_ms": 10767.095, "learn_throughput": 371.502, "synch_weights_time_ms": 16.612}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "64a97_00000", "date": "2024-07-26_23-11-36", "timestamp": 1722015696, "time_this_iter_s": 14.524460554122925, "time_total_s": 377.60028409957886, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bad40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.60028409957886, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.242857142857142, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.42786747217178, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7018840076867491, "policy_loss": -0.01561142240583043, "vf_loss": 0.7184774143000444, "vf_explained_var": 0.9988555851702888, "kl": 0.014116851961565176, "entropy": 0.7334566963836551, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 10.903179634587444, "episode_reward_min": -250.74859866140918, "episode_reward_mean": -93.40848377210008, "episode_len_mean": 68.98, "episode_media": {}, "episodes_timesteps_total": 6898, "policy_reward_min": {"policy_0": -250.74859866140918}, "policy_reward_max": {"policy_0": 10.903179634587444}, "policy_reward_mean": {"policy_0": -93.40848377210008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.594447600144172, -23.480276509550034, 5.186548590106417, -130.15394786124648, -250.74859866140918, -40.87209850777637, -69.26188622093784, -93.23419313674736, -81.70942127122164, -21.561947943528, -130.48396326379788, -66.58731393226613, -210.07069216217334, -42.339226582579585, -10.2564113117499, -189.3978160289874, -180.51765267964157, -153.48984944560527, 6.781919069753849, -15.900676984031648, -67.94209958151927, -82.76801252731502, -151.01060980228155, -118.76739648010495, -136.49245066806367, -16.837647154297738, -104.83150065356526, -95.31979994779624, -168.55340347432477, -83.36551584331474, -22.059579585845643, -2.430324628357462, -10.587022487951105, -103.14006156436152, -185.5782720202276, -29.945505479321323, -99.27449198133309, -157.50859340961523, -63.72819419946026, -124.94196366219839, -116.0803303581392, -93.36593382973278, -15.277146417475072, -104.54647164106616, -200.40529476129825, -185.9369331261506, -148.43799475830963, -193.32756205318822, -42.87842532437902, -246.01127643267338, -49.90161887277569, -97.14854232090671, -172.4530118208094, -152.0932956863741, -167.92802915068057, -63.955142264784385, -188.19181031884767, -78.86077449085931, 8.101138593532283, -67.43588327920794, 10.903179634587444, 2.7552037451934166, -103.70996956322132, -235.99060268170936, -100.52444325822383, -14.547316252200957, -5.332958980380444, 7.688840675840843, 6.072994520620916, -207.83288019297902, -149.33925989346727, -129.96265224745423, -129.65197919782105, -104.62319980381031, -67.98123357414113, -106.04378854872897, 0.9800240217060057, -25.13947757297978, -156.04978969428157, -118.2728305407673, -194.2007907707858, -197.07198970067233, -210.47003459026882, 2.3169625422823197, -87.31677274613449, -17.82470999412759, -221.13750448569968, -74.93389222981854, -93.32523609549418, -129.7745289840647, -43.14489425983702, -37.59579575330889, -87.54901807223074, -61.75608521067636, -89.14739731169641, -215.15985577865197, 4.468127377181083, -16.813823028226636, -26.531495469329784, -22.557662535602482], "episode_lengths": [33, 50, 33, 69, 110, 60, 57, 81, 65, 55, 88, 61, 105, 57, 43, 100, 89, 84, 38, 46, 65, 64, 80, 81, 85, 41, 83, 82, 97, 62, 44, 40, 43, 78, 89, 53, 82, 96, 63, 86, 84, 77, 40, 73, 96, 96, 85, 82, 58, 107, 60, 77, 98, 82, 97, 63, 101, 68, 32, 60, 35, 37, 71, 108, 70, 48, 32, 32, 32, 96, 81, 89, 79, 78, 60, 83, 33, 54, 94, 86, 84, 94, 104, 39, 67, 52, 102, 58, 72, 77, 49, 60, 67, 57, 66, 105, 30, 51, 48, 44], "policy_policy_0_reward": [4.594447600144172, -23.480276509550034, 5.186548590106417, -130.15394786124648, -250.74859866140918, -40.87209850777637, -69.26188622093784, -93.23419313674736, -81.70942127122164, -21.561947943528, -130.48396326379788, -66.58731393226613, -210.07069216217334, -42.339226582579585, -10.2564113117499, -189.3978160289874, -180.51765267964157, -153.48984944560527, 6.781919069753849, -15.900676984031648, -67.94209958151927, -82.76801252731502, -151.01060980228155, -118.76739648010495, -136.49245066806367, -16.837647154297738, -104.83150065356526, -95.31979994779624, -168.55340347432477, -83.36551584331474, -22.059579585845643, -2.430324628357462, -10.587022487951105, -103.14006156436152, -185.5782720202276, -29.945505479321323, -99.27449198133309, -157.50859340961523, -63.72819419946026, -124.94196366219839, -116.0803303581392, -93.36593382973278, -15.277146417475072, -104.54647164106616, -200.40529476129825, -185.9369331261506, -148.43799475830963, -193.32756205318822, -42.87842532437902, -246.01127643267338, -49.90161887277569, -97.14854232090671, -172.4530118208094, -152.0932956863741, -167.92802915068057, -63.955142264784385, -188.19181031884767, -78.86077449085931, 8.101138593532283, -67.43588327920794, 10.903179634587444, 2.7552037451934166, -103.70996956322132, -235.99060268170936, -100.52444325822383, -14.547316252200957, -5.332958980380444, 7.688840675840843, 6.072994520620916, -207.83288019297902, -149.33925989346727, -129.96265224745423, -129.65197919782105, -104.62319980381031, -67.98123357414113, -106.04378854872897, 0.9800240217060057, -25.13947757297978, -156.04978969428157, -118.2728305407673, -194.2007907707858, -197.07198970067233, -210.47003459026882, 2.3169625422823197, -87.31677274613449, -17.82470999412759, -221.13750448569968, -74.93389222981854, -93.32523609549418, -129.7745289840647, -43.14489425983702, -37.59579575330889, -87.54901807223074, -61.75608521067636, -89.14739731169641, -215.15985577865197, 4.468127377181083, -16.813823028226636, -26.531495469329784, -22.557662535602482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917755989824184, "mean_inference_ms": 0.9137747754713098, "mean_action_processing_ms": 0.16297932260896184, "mean_env_wait_ms": 2.0915474307573207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005544185638427734, "StateBufferConnector_ms": 0.003965139389038086, "ViewRequirementAgentConnector_ms": 0.0996863842010498}, "num_episodes": 57, "episode_return_max": 10.903179634587444, "episode_return_min": -250.74859866140918, "episode_return_mean": -93.40848377210008, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.66102827391563, "num_env_steps_trained_throughput_per_sec": 289.66102827391563, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 13695.34, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13695.266, "sample_time_ms": 3018.242, "learn_time_ms": 10659.685, "learn_throughput": 375.246, "synch_weights_time_ms": 16.384}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "64a97_00000", "date": "2024-07-26_23-11-49", "timestamp": 1722015709, "time_this_iter_s": 13.816091299057007, "time_total_s": 391.41637539863586, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 391.41637539863586, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.205, "ram_util_percent": 28.794999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.0995583469669, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.5544919095312556, "policy_loss": -0.0170018677332943, "vf_loss": 0.5702820349174241, "vf_explained_var": 0.9990250281989574, "kl": 0.017909755830502656, "entropy": 0.6847647956262032, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": 13.133381552461932, "episode_reward_min": -235.99060268170936, "episode_reward_mean": -88.22465818421657, "episode_len_mean": 67.28, "episode_media": {}, "episodes_timesteps_total": 6728, "policy_reward_min": {"policy_0": -235.99060268170936}, "policy_reward_max": {"policy_0": 13.133381552461932}, "policy_reward_mean": {"policy_0": -88.22465818421657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.86077449085931, 8.101138593532283, -67.43588327920794, 10.903179634587444, 2.7552037451934166, -103.70996956322132, -235.99060268170936, -100.52444325822383, -14.547316252200957, -5.332958980380444, 7.688840675840843, 6.072994520620916, -207.83288019297902, -149.33925989346727, -129.96265224745423, -129.65197919782105, -104.62319980381031, -67.98123357414113, -106.04378854872897, 0.9800240217060057, -25.13947757297978, -156.04978969428157, -118.2728305407673, -194.2007907707858, -197.07198970067233, -210.47003459026882, 2.3169625422823197, -87.31677274613449, -17.82470999412759, -221.13750448569968, -74.93389222981854, -93.32523609549418, -129.7745289840647, -43.14489425983702, -37.59579575330889, -87.54901807223074, -61.75608521067636, -89.14739731169641, -215.15985577865197, 4.468127377181083, -16.813823028226636, -26.531495469329784, -22.557662535602482, -224.17330295855334, -27.98795901992353, -100.20902276537707, -91.94483698092239, -168.25837230369922, -165.65194535290328, -54.401156139581275, 13.133381552461932, -185.03857950821921, -35.14291974842345, -152.2727022547603, -10.368065626874575, -211.18086845499815, -102.96856790492791, -65.55700647508151, -191.1412078631019, -183.25598920793922, -130.6817135381572, -125.57888763818794, 4.903576475323926, -149.22586119949793, -80.85861743843355, -15.21395242952764, -78.76557425285156, -57.48542812672241, -140.91031215073326, -75.48881621070655, -187.49449494295186, 6.766829316988867, -228.617848498729, 9.457928271154309, -3.3151895475579765, -193.90452242640393, -88.75203499419518, -139.37808041992076, -6.523893429384872, -89.90816821193118, -6.732663609158843, -91.02526856089031, -73.90765758060296, -41.93615358825825, -69.46099144703805, -64.79794105370178, 10.228873809721902, -118.34353042258678, 0.8502860539848365, -120.511634694168, 0.34320649881075493, -50.382709849022966, -51.87878857320582, -31.05140625510655, -98.75275627339022, -185.31600582930133, -40.78846599945688, -103.51132198477536, -205.34368091123665, -168.42897006910775], "episode_lengths": [68, 32, 60, 35, 37, 71, 108, 70, 48, 32, 32, 32, 96, 81, 89, 79, 78, 60, 83, 33, 54, 94, 86, 84, 94, 104, 39, 67, 52, 102, 58, 72, 77, 49, 60, 67, 57, 66, 105, 30, 51, 48, 44, 108, 55, 71, 83, 92, 95, 56, 29, 93, 60, 92, 38, 106, 85, 65, 80, 87, 90, 76, 42, 93, 63, 49, 64, 58, 80, 75, 92, 30, 104, 34, 42, 96, 81, 93, 42, 75, 40, 66, 59, 51, 62, 58, 33, 73, 37, 86, 42, 51, 60, 46, 69, 101, 56, 82, 99, 99], "policy_policy_0_reward": [-78.86077449085931, 8.101138593532283, -67.43588327920794, 10.903179634587444, 2.7552037451934166, -103.70996956322132, -235.99060268170936, -100.52444325822383, -14.547316252200957, -5.332958980380444, 7.688840675840843, 6.072994520620916, -207.83288019297902, -149.33925989346727, -129.96265224745423, -129.65197919782105, -104.62319980381031, -67.98123357414113, -106.04378854872897, 0.9800240217060057, -25.13947757297978, -156.04978969428157, -118.2728305407673, -194.2007907707858, -197.07198970067233, -210.47003459026882, 2.3169625422823197, -87.31677274613449, -17.82470999412759, -221.13750448569968, -74.93389222981854, -93.32523609549418, -129.7745289840647, -43.14489425983702, -37.59579575330889, -87.54901807223074, -61.75608521067636, -89.14739731169641, -215.15985577865197, 4.468127377181083, -16.813823028226636, -26.531495469329784, -22.557662535602482, -224.17330295855334, -27.98795901992353, -100.20902276537707, -91.94483698092239, -168.25837230369922, -165.65194535290328, -54.401156139581275, 13.133381552461932, -185.03857950821921, -35.14291974842345, -152.2727022547603, -10.368065626874575, -211.18086845499815, -102.96856790492791, -65.55700647508151, -191.1412078631019, -183.25598920793922, -130.6817135381572, -125.57888763818794, 4.903576475323926, -149.22586119949793, -80.85861743843355, -15.21395242952764, -78.76557425285156, -57.48542812672241, -140.91031215073326, -75.48881621070655, -187.49449494295186, 6.766829316988867, -228.617848498729, 9.457928271154309, -3.3151895475579765, -193.90452242640393, -88.75203499419518, -139.37808041992076, -6.523893429384872, -89.90816821193118, -6.732663609158843, -91.02526856089031, -73.90765758060296, -41.93615358825825, -69.46099144703805, -64.79794105370178, 10.228873809721902, -118.34353042258678, 0.8502860539848365, -120.511634694168, 0.34320649881075493, -50.382709849022966, -51.87878857320582, -31.05140625510655, -98.75275627339022, -185.31600582930133, -40.78846599945688, -103.51132198477536, -205.34368091123665, -168.42897006910775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915854868847282, "mean_inference_ms": 0.9135429589406675, "mean_action_processing_ms": 0.16318247181038303, "mean_env_wait_ms": 2.091544984908126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005533933639526367, "StateBufferConnector_ms": 0.003950834274291992, "ViewRequirementAgentConnector_ms": 0.09961223602294922}, "num_episodes": 57, "episode_return_max": 13.133381552461932, "episode_return_min": -235.99060268170936, "episode_return_mean": -88.22465818421657, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.2479085787664, "num_env_steps_trained_throughput_per_sec": 368.2479085787664, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 13495.637, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13495.563, "sample_time_ms": 3013.512, "learn_time_ms": 10464.713, "learn_throughput": 382.237, "synch_weights_time_ms": 16.384}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "64a97_00000", "date": "2024-07-26_23-12-00", "timestamp": 1722015720, "time_this_iter_s": 10.868204832077026, "time_total_s": 402.2845802307129, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.2845802307129, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 11.293333333333333, "ram_util_percent": 28.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.74940377324819, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.48838636339254055, "policy_loss": -0.0204612946351214, "vf_loss": 0.5073370388088126, "vf_explained_var": 0.9990461823220055, "kl": 0.017688560197469404, "entropy": 0.6449233528226614, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 11.18082302067714, "episode_reward_min": -230.15375083352882, "episode_reward_mean": -91.2159570001404, "episode_len_mean": 69.3, "episode_media": {}, "episodes_timesteps_total": 6930, "policy_reward_min": {"policy_0": -230.15375083352882}, "policy_reward_max": {"policy_0": 11.18082302067714}, "policy_reward_mean": {"policy_0": -91.2159570001404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.55700647508151, -191.1412078631019, -183.25598920793922, -130.6817135381572, -125.57888763818794, 4.903576475323926, -149.22586119949793, -80.85861743843355, -15.21395242952764, -78.76557425285156, -57.48542812672241, -140.91031215073326, -75.48881621070655, -187.49449494295186, 6.766829316988867, -228.617848498729, 9.457928271154309, -3.3151895475579765, -193.90452242640393, -88.75203499419518, -139.37808041992076, -6.523893429384872, -89.90816821193118, -6.732663609158843, -91.02526856089031, -73.90765758060296, -41.93615358825825, -69.46099144703805, -64.79794105370178, 10.228873809721902, -118.34353042258678, 0.8502860539848365, -120.511634694168, 0.34320649881075493, -50.382709849022966, -51.87878857320582, -31.05140625510655, -98.75275627339022, -185.31600582930133, -40.78846599945688, -103.51132198477536, -205.34368091123665, -168.42897006910775, -62.301855497545645, -125.80941328007798, -135.74398859077195, -133.99860346456077, -206.200952858801, -97.44574151766274, -132.89010333851846, -33.94761244122297, -92.39390135255721, -86.20744613884813, -195.613203803838, -191.26608057449047, -81.48600975744682, -74.53059573318507, 3.3149884269251975, -105.46313213055049, 0.5354078404862943, -5.83034630387821, -137.63710913200492, -75.04277863744062, -6.059311166355016, -90.67313990389782, -38.21618270968637, -167.6780395194604, -44.17701277522302, -18.385510630840933, -145.6490851089077, -45.685808711058144, -192.02524876727756, -146.36022387191943, -160.43939830174733, -230.15375083352882, -124.40255646833097, -200.66533263623472, -88.73966703249226, -158.42589044249516, -67.49209104764977, -43.068522294503914, -21.23857532124988, 11.18082302067714, -192.5703165691387, -90.36286842791155, -30.527927825243086, -89.58944399912563, -155.17267810030083, -147.19759607181345, -143.85660276238275, 2.8403570882280764, -24.372883414387587, -111.55119581089765, -20.220050639251944, -41.14311200389275, -100.84670765677129, -96.2855772911634, -82.73051429268608, -93.09191948037618, -34.9268146717169], "episode_lengths": [65, 80, 87, 90, 76, 42, 93, 63, 49, 64, 58, 80, 75, 92, 30, 104, 34, 42, 96, 81, 93, 42, 75, 40, 66, 59, 51, 62, 58, 33, 73, 37, 86, 42, 51, 60, 46, 69, 101, 56, 82, 99, 99, 61, 76, 91, 92, 99, 68, 79, 59, 69, 80, 102, 90, 78, 78, 38, 71, 33, 40, 92, 63, 48, 66, 52, 98, 52, 49, 87, 63, 102, 81, 96, 109, 75, 104, 81, 82, 58, 49, 42, 34, 102, 70, 44, 66, 86, 81, 81, 35, 56, 84, 46, 61, 83, 68, 65, 74, 60], "policy_policy_0_reward": [-65.55700647508151, -191.1412078631019, -183.25598920793922, -130.6817135381572, -125.57888763818794, 4.903576475323926, -149.22586119949793, -80.85861743843355, -15.21395242952764, -78.76557425285156, -57.48542812672241, -140.91031215073326, -75.48881621070655, -187.49449494295186, 6.766829316988867, -228.617848498729, 9.457928271154309, -3.3151895475579765, -193.90452242640393, -88.75203499419518, -139.37808041992076, -6.523893429384872, -89.90816821193118, -6.732663609158843, -91.02526856089031, -73.90765758060296, -41.93615358825825, -69.46099144703805, -64.79794105370178, 10.228873809721902, -118.34353042258678, 0.8502860539848365, -120.511634694168, 0.34320649881075493, -50.382709849022966, -51.87878857320582, -31.05140625510655, -98.75275627339022, -185.31600582930133, -40.78846599945688, -103.51132198477536, -205.34368091123665, -168.42897006910775, -62.301855497545645, -125.80941328007798, -135.74398859077195, -133.99860346456077, -206.200952858801, -97.44574151766274, -132.89010333851846, -33.94761244122297, -92.39390135255721, -86.20744613884813, -195.613203803838, -191.26608057449047, -81.48600975744682, -74.53059573318507, 3.3149884269251975, -105.46313213055049, 0.5354078404862943, -5.83034630387821, -137.63710913200492, -75.04277863744062, -6.059311166355016, -90.67313990389782, -38.21618270968637, -167.6780395194604, -44.17701277522302, -18.385510630840933, -145.6490851089077, -45.685808711058144, -192.02524876727756, -146.36022387191943, -160.43939830174733, -230.15375083352882, -124.40255646833097, -200.66533263623472, -88.73966703249226, -158.42589044249516, -67.49209104764977, -43.068522294503914, -21.23857532124988, 11.18082302067714, -192.5703165691387, -90.36286842791155, -30.527927825243086, -89.58944399912563, -155.17267810030083, -147.19759607181345, -143.85660276238275, 2.8403570882280764, -24.372883414387587, -111.55119581089765, -20.220050639251944, -41.14311200389275, -100.84670765677129, -96.2855772911634, -82.73051429268608, -93.09191948037618, -34.9268146717169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918214423325401, "mean_inference_ms": 0.9126566550200309, "mean_action_processing_ms": 0.1629721456440459, "mean_env_wait_ms": 2.0913343351344214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005636930465698242, "StateBufferConnector_ms": 0.003990650177001953, "ViewRequirementAgentConnector_ms": 0.10023045539855957}, "num_episodes": 57, "episode_return_max": 11.18082302067714, "episode_return_min": -230.15375083352882, "episode_return_mean": -91.2159570001404, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.34518373566385, "num_env_steps_trained_throughput_per_sec": 344.34518373566385, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13515.52, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13515.446, "sample_time_ms": 3007.809, "learn_time_ms": 10490.298, "learn_throughput": 381.305, "synch_weights_time_ms": 16.38}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "64a97_00000", "date": "2024-07-26_23-12-12", "timestamp": 1722015732, "time_this_iter_s": 11.622525453567505, "time_total_s": 413.9071056842804, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7051b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 413.9071056842804, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 12.035294117647059, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.828227239350475, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.4666302677166338, "policy_loss": -0.014006594082457014, "vf_loss": 0.4805766026178996, "vf_explained_var": 0.9991215930630764, "kl": 0.014948505049263395, "entropy": 0.6666569476015866, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 11.18082302067714, "episode_reward_min": -234.7484042682154, "episode_reward_mean": -92.23146297754828, "episode_len_mean": 69.95, "episode_media": {}, "episodes_timesteps_total": 6995, "policy_reward_min": {"policy_0": -234.7484042682154}, "policy_reward_max": {"policy_0": 11.18082302067714}, "policy_reward_mean": {"policy_0": -92.23146297754828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3149884269251975, -105.46313213055049, 0.5354078404862943, -5.83034630387821, -137.63710913200492, -75.04277863744062, -6.059311166355016, -90.67313990389782, -38.21618270968637, -167.6780395194604, -44.17701277522302, -18.385510630840933, -145.6490851089077, -45.685808711058144, -192.02524876727756, -146.36022387191943, -160.43939830174733, -230.15375083352882, -124.40255646833097, -200.66533263623472, -88.73966703249226, -158.42589044249516, -67.49209104764977, -43.068522294503914, -21.23857532124988, 11.18082302067714, -192.5703165691387, -90.36286842791155, -30.527927825243086, -89.58944399912563, -155.17267810030083, -147.19759607181345, -143.85660276238275, 2.8403570882280764, -24.372883414387587, -111.55119581089765, -20.220050639251944, -41.14311200389275, -100.84670765677129, -96.2855772911634, -82.73051429268608, -93.09191948037618, -34.9268146717169, -25.730016470940473, -121.66216933965825, -16.895747883712538, -84.28503226215719, -142.57827807710223, -23.340460107423475, -41.78132300431931, -195.91380956200027, -98.8224844337366, -67.04003166660385, -121.67093333016605, 0.0833375206501713, -223.0574099969095, -135.0404041611275, -234.7484042682154, -25.39921231098377, -102.50408192566803, -79.70637575745651, -146.9964625020615, -209.7792989841068, -208.2289438511714, -125.48774177738126, -85.89714401848549, 0.6132611800556749, -122.73860070102614, -18.15776555770477, 5.989458851935823, -138.69765455493388, 10.482890731026, -86.87620421741214, -21.44811975663527, -115.32704694308693, -149.97409824739194, -228.25075159349456, -132.10857453883833, -0.43911347177569215, -128.50692331743144, -170.7448507634268, -116.70880646550746, -12.762988889285209, -166.45565636067857, 0.8159156125083586, -204.10537350148434, -24.20776127792864, -38.76987083178939, 8.679820986716303, -10.247922175291533, -82.05269892095691, -163.8154062042305, -118.89012258324432, -31.837776044108352, -96.35262552740595, -134.58286977473082, -103.7749484846311, -157.60271147558936, -66.89000190211934, -140.8346264767169], "episode_lengths": [38, 71, 33, 40, 92, 63, 48, 66, 52, 98, 52, 49, 87, 63, 102, 81, 96, 109, 75, 104, 81, 82, 58, 49, 42, 34, 102, 70, 44, 66, 86, 81, 81, 35, 56, 84, 46, 61, 83, 68, 65, 74, 60, 55, 89, 42, 80, 81, 57, 57, 91, 69, 66, 86, 41, 104, 87, 106, 47, 84, 64, 90, 104, 104, 89, 67, 37, 78, 44, 32, 88, 32, 75, 51, 73, 95, 107, 77, 38, 85, 97, 74, 46, 95, 45, 100, 51, 54, 29, 47, 79, 96, 76, 45, 78, 79, 73, 92, 58, 82], "policy_policy_0_reward": [3.3149884269251975, -105.46313213055049, 0.5354078404862943, -5.83034630387821, -137.63710913200492, -75.04277863744062, -6.059311166355016, -90.67313990389782, -38.21618270968637, -167.6780395194604, -44.17701277522302, -18.385510630840933, -145.6490851089077, -45.685808711058144, -192.02524876727756, -146.36022387191943, -160.43939830174733, -230.15375083352882, -124.40255646833097, -200.66533263623472, -88.73966703249226, -158.42589044249516, -67.49209104764977, -43.068522294503914, -21.23857532124988, 11.18082302067714, -192.5703165691387, -90.36286842791155, -30.527927825243086, -89.58944399912563, -155.17267810030083, -147.19759607181345, -143.85660276238275, 2.8403570882280764, -24.372883414387587, -111.55119581089765, -20.220050639251944, -41.14311200389275, -100.84670765677129, -96.2855772911634, -82.73051429268608, -93.09191948037618, -34.9268146717169, -25.730016470940473, -121.66216933965825, -16.895747883712538, -84.28503226215719, -142.57827807710223, -23.340460107423475, -41.78132300431931, -195.91380956200027, -98.8224844337366, -67.04003166660385, -121.67093333016605, 0.0833375206501713, -223.0574099969095, -135.0404041611275, -234.7484042682154, -25.39921231098377, -102.50408192566803, -79.70637575745651, -146.9964625020615, -209.7792989841068, -208.2289438511714, -125.48774177738126, -85.89714401848549, 0.6132611800556749, -122.73860070102614, -18.15776555770477, 5.989458851935823, -138.69765455493388, 10.482890731026, -86.87620421741214, -21.44811975663527, -115.32704694308693, -149.97409824739194, -228.25075159349456, -132.10857453883833, -0.43911347177569215, -128.50692331743144, -170.7448507634268, -116.70880646550746, -12.762988889285209, -166.45565636067857, 0.8159156125083586, -204.10537350148434, -24.20776127792864, -38.76987083178939, 8.679820986716303, -10.247922175291533, -82.05269892095691, -163.8154062042305, -118.89012258324432, -31.837776044108352, -96.35262552740595, -134.58286977473082, -103.7749484846311, -157.60271147558936, -66.89000190211934, -140.8346264767169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919620703391264, "mean_inference_ms": 0.912726527406262, "mean_action_processing_ms": 0.16311352240814514, "mean_env_wait_ms": 2.091838047580906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005663394927978516, "StateBufferConnector_ms": 0.004119873046875, "ViewRequirementAgentConnector_ms": 0.10378289222717285}, "num_episodes": 57, "episode_return_max": 11.18082302067714, "episode_return_min": -234.7484042682154, "episode_return_mean": -92.23146297754828, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.9995898143256, "num_env_steps_trained_throughput_per_sec": 272.9995898143256, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 13567.348, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13567.274, "sample_time_ms": 3005.377, "learn_time_ms": 10545.026, "learn_throughput": 379.326, "synch_weights_time_ms": 15.915}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "64a97_00000", "date": "2024-07-26_23-12-27", "timestamp": 1722015747, "time_this_iter_s": 14.658275127410889, "time_total_s": 428.5653808116913, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 428.5653808116913, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.823809523809524, "ram_util_percent": 28.719047619047615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.89600405047337, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.45902901629451665, "policy_loss": -0.014424031198723241, "vf_loss": 0.4723981552291662, "vf_explained_var": 0.9991840163245798, "kl": 0.015189987266542948, "entropy": 0.5780604469279448, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 10.482890731026, "episode_reward_min": -241.5205116401159, "episode_reward_mean": -86.99124928977265, "episode_len_mean": 68.64, "episode_media": {}, "episodes_timesteps_total": 6864, "policy_reward_min": {"policy_0": -241.5205116401159}, "policy_reward_max": {"policy_0": 10.482890731026}, "policy_reward_mean": {"policy_0": -86.99124928977265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.50408192566803, -79.70637575745651, -146.9964625020615, -209.7792989841068, -208.2289438511714, -125.48774177738126, -85.89714401848549, 0.6132611800556749, -122.73860070102614, -18.15776555770477, 5.989458851935823, -138.69765455493388, 10.482890731026, -86.87620421741214, -21.44811975663527, -115.32704694308693, -149.97409824739194, -228.25075159349456, -132.10857453883833, -0.43911347177569215, -128.50692331743144, -170.7448507634268, -116.70880646550746, -12.762988889285209, -166.45565636067857, 0.8159156125083586, -204.10537350148434, -24.20776127792864, -38.76987083178939, 8.679820986716303, -10.247922175291533, -82.05269892095691, -163.8154062042305, -118.89012258324432, -31.837776044108352, -96.35262552740595, -134.58286977473082, -103.7749484846311, -157.60271147558936, -66.89000190211934, -140.8346264767169, -80.79561313851009, -130.2722584604821, -153.509443980226, -107.28574464312901, -152.25953199857628, -146.6395362849414, -52.72993858383371, -77.18250575184302, -71.04679112881799, -27.466012364968908, -1.2025686183009614, -90.58599104967132, -30.765415366149572, -110.67572329852813, 7.697275105994736, -16.24299032735664, -171.08333762820547, -71.65140682357872, -202.2762017850115, -151.82738468051147, -147.90202073726635, -58.977545215900136, -71.05755398527052, -21.855700331911052, -62.6958379440405, -7.580785238877871, -41.35974722563962, -102.45949640872257, -42.5910129463099, -17.36289435326753, -82.99571497300498, -30.37892152802394, -201.08386083634298, -147.18836560961157, -79.97082403799172, -73.01431656753914, -119.26195479229044, -128.94700470173706, -170.7170279478522, -55.25616410061318, -50.44533479563896, -72.43584351469741, -36.67837101566204, -101.0014862793935, -4.010047654143941, -85.14418691991098, -185.7497905682081, 8.623348426454006, -59.89932458576956, 0.2202664147532063, -27.289106501360628, -168.20883807014403, -50.33140790850521, -9.8994655857933, -241.5205116401159, -25.1506586875854, -71.14224453334798, -107.75479290220133, 4.331309645812338], "episode_lengths": [84, 64, 90, 104, 104, 89, 67, 37, 78, 44, 32, 88, 32, 75, 51, 73, 95, 107, 77, 38, 85, 97, 74, 46, 95, 45, 100, 51, 54, 29, 47, 79, 96, 76, 45, 78, 79, 73, 92, 58, 82, 76, 91, 82, 82, 93, 81, 52, 65, 67, 59, 35, 82, 52, 87, 33, 49, 96, 77, 93, 82, 94, 61, 61, 53, 58, 44, 50, 86, 54, 48, 66, 55, 93, 92, 64, 66, 71, 77, 100, 55, 57, 65, 59, 84, 40, 67, 93, 30, 55, 40, 48, 90, 62, 41, 110, 47, 62, 86, 36], "policy_policy_0_reward": [-102.50408192566803, -79.70637575745651, -146.9964625020615, -209.7792989841068, -208.2289438511714, -125.48774177738126, -85.89714401848549, 0.6132611800556749, -122.73860070102614, -18.15776555770477, 5.989458851935823, -138.69765455493388, 10.482890731026, -86.87620421741214, -21.44811975663527, -115.32704694308693, -149.97409824739194, -228.25075159349456, -132.10857453883833, -0.43911347177569215, -128.50692331743144, -170.7448507634268, -116.70880646550746, -12.762988889285209, -166.45565636067857, 0.8159156125083586, -204.10537350148434, -24.20776127792864, -38.76987083178939, 8.679820986716303, -10.247922175291533, -82.05269892095691, -163.8154062042305, -118.89012258324432, -31.837776044108352, -96.35262552740595, -134.58286977473082, -103.7749484846311, -157.60271147558936, -66.89000190211934, -140.8346264767169, -80.79561313851009, -130.2722584604821, -153.509443980226, -107.28574464312901, -152.25953199857628, -146.6395362849414, -52.72993858383371, -77.18250575184302, -71.04679112881799, -27.466012364968908, -1.2025686183009614, -90.58599104967132, -30.765415366149572, -110.67572329852813, 7.697275105994736, -16.24299032735664, -171.08333762820547, -71.65140682357872, -202.2762017850115, -151.82738468051147, -147.90202073726635, -58.977545215900136, -71.05755398527052, -21.855700331911052, -62.6958379440405, -7.580785238877871, -41.35974722563962, -102.45949640872257, -42.5910129463099, -17.36289435326753, -82.99571497300498, -30.37892152802394, -201.08386083634298, -147.18836560961157, -79.97082403799172, -73.01431656753914, -119.26195479229044, -128.94700470173706, -170.7170279478522, -55.25616410061318, -50.44533479563896, -72.43584351469741, -36.67837101566204, -101.0014862793935, -4.010047654143941, -85.14418691991098, -185.7497905682081, 8.623348426454006, -59.89932458576956, 0.2202664147532063, -27.289106501360628, -168.20883807014403, -50.33140790850521, -9.8994655857933, -241.5205116401159, -25.1506586875854, -71.14224453334798, -107.75479290220133, 4.331309645812338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921722016786278, "mean_inference_ms": 0.9131330615053538, "mean_action_processing_ms": 0.16315440504617487, "mean_env_wait_ms": 2.0929549714043048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005807399749755859, "StateBufferConnector_ms": 0.004207134246826172, "ViewRequirementAgentConnector_ms": 0.1060338020324707}, "num_episodes": 59, "episode_return_max": 10.482890731026, "episode_return_min": -241.5205116401159, "episode_return_mean": -86.99124928977265, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.97847847006585, "num_env_steps_trained_throughput_per_sec": 294.97847847006585, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 13670.348, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13670.275, "sample_time_ms": 3016.134, "learn_time_ms": 10637.161, "learn_throughput": 376.04, "synch_weights_time_ms": 16.019}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "64a97_00000", "date": "2024-07-26_23-12-40", "timestamp": 1722015760, "time_this_iter_s": 13.565483570098877, "time_total_s": 442.13086438179016, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0751c6dbd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 442.13086438179016, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 14.810526315789476, "ram_util_percent": 28.78947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.37687662740548, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.517665479828914, "policy_loss": -0.0157409422895095, "vf_loss": 0.5331528159789741, "vf_explained_var": 0.996405412008365, "kl": 0.012886170939676367, "entropy": 0.5545170113754769, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": 9.821037560067605, "episode_reward_min": -487.94091179350227, "episode_reward_mean": -86.78252796139508, "episode_len_mean": 67.86, "episode_media": {}, "episodes_timesteps_total": 6786, "policy_reward_min": {"policy_0": -487.94091179350227}, "policy_reward_max": {"policy_0": 9.821037560067605}, "policy_reward_mean": {"policy_0": -86.78252796139508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.08333762820547, -71.65140682357872, -202.2762017850115, -151.82738468051147, -147.90202073726635, -58.977545215900136, -71.05755398527052, -21.855700331911052, -62.6958379440405, -7.580785238877871, -41.35974722563962, -102.45949640872257, -42.5910129463099, -17.36289435326753, -82.99571497300498, -30.37892152802394, -201.08386083634298, -147.18836560961157, -79.97082403799172, -73.01431656753914, -119.26195479229044, -128.94700470173706, -170.7170279478522, -55.25616410061318, -50.44533479563896, -72.43584351469741, -36.67837101566204, -101.0014862793935, -4.010047654143941, -85.14418691991098, -185.7497905682081, 8.623348426454006, -59.89932458576956, 0.2202664147532063, -27.289106501360628, -168.20883807014403, -50.33140790850521, -9.8994655857933, -241.5205116401159, -25.1506586875854, -71.14224453334798, -107.75479290220133, 4.331309645812338, -74.18381709913997, -107.6587529954603, -68.15586255236973, -168.6080923712721, -105.41302306180546, -4.342679037621111, -151.5189591910113, -75.22980385612811, -50.52343406725623, -91.91915962088603, -63.15738828448057, -15.097319549110749, -50.511410314690806, 9.821037560067605, -16.9141860721473, -64.7563309378704, -80.39780630934945, -227.9678185571403, -98.08200239671054, -51.74970636370571, -5.067028256428834, 6.630927264409291, -26.744012073980816, -487.94091179350227, -201.90514662636838, -87.24958996971067, -56.03562526510788, -117.95790336208228, -20.7829833822194, -126.12464723887776, -26.581541810351432, -144.08806157864424, -85.75761678562318, -33.122639896893205, -51.39823720864241, -197.3322064227383, 6.114739821202687, -228.02780119396942, 4.88462338722136, -102.81907535303539, -72.70069862490813, -32.03783884996851, -77.77834225899183, 7.721785787299358, 0.7624417622402685, -214.5711585127248, -118.2699899730248, -60.26088998736042, -137.13288569895383, -147.74425082089775, -173.31869808700839, -6.513159053107743, -90.17551918888752, -113.17668630070355, -95.0011845363911, -148.9950828747867, -118.40781902292093], "episode_lengths": [96, 77, 93, 82, 94, 61, 61, 53, 58, 44, 50, 86, 54, 48, 66, 55, 93, 92, 64, 66, 71, 77, 100, 55, 57, 65, 59, 84, 40, 67, 93, 30, 55, 40, 48, 90, 62, 41, 110, 47, 62, 86, 36, 79, 83, 56, 89, 81, 47, 87, 71, 59, 68, 61, 41, 55, 38, 51, 58, 70, 107, 69, 65, 36, 31, 46, 134, 94, 80, 58, 77, 50, 82, 41, 85, 81, 58, 51, 91, 34, 109, 39, 74, 70, 53, 68, 31, 40, 105, 89, 60, 94, 81, 88, 44, 81, 79, 83, 82, 84], "policy_policy_0_reward": [-171.08333762820547, -71.65140682357872, -202.2762017850115, -151.82738468051147, -147.90202073726635, -58.977545215900136, -71.05755398527052, -21.855700331911052, -62.6958379440405, -7.580785238877871, -41.35974722563962, -102.45949640872257, -42.5910129463099, -17.36289435326753, -82.99571497300498, -30.37892152802394, -201.08386083634298, -147.18836560961157, -79.97082403799172, -73.01431656753914, -119.26195479229044, -128.94700470173706, -170.7170279478522, -55.25616410061318, -50.44533479563896, -72.43584351469741, -36.67837101566204, -101.0014862793935, -4.010047654143941, -85.14418691991098, -185.7497905682081, 8.623348426454006, -59.89932458576956, 0.2202664147532063, -27.289106501360628, -168.20883807014403, -50.33140790850521, -9.8994655857933, -241.5205116401159, -25.1506586875854, -71.14224453334798, -107.75479290220133, 4.331309645812338, -74.18381709913997, -107.6587529954603, -68.15586255236973, -168.6080923712721, -105.41302306180546, -4.342679037621111, -151.5189591910113, -75.22980385612811, -50.52343406725623, -91.91915962088603, -63.15738828448057, -15.097319549110749, -50.511410314690806, 9.821037560067605, -16.9141860721473, -64.7563309378704, -80.39780630934945, -227.9678185571403, -98.08200239671054, -51.74970636370571, -5.067028256428834, 6.630927264409291, -26.744012073980816, -487.94091179350227, -201.90514662636838, -87.24958996971067, -56.03562526510788, -117.95790336208228, -20.7829833822194, -126.12464723887776, -26.581541810351432, -144.08806157864424, -85.75761678562318, -33.122639896893205, -51.39823720864241, -197.3322064227383, 6.114739821202687, -228.02780119396942, 4.88462338722136, -102.81907535303539, -72.70069862490813, -32.03783884996851, -77.77834225899183, 7.721785787299358, 0.7624417622402685, -214.5711585127248, -118.2699899730248, -60.26088998736042, -137.13288569895383, -147.74425082089775, -173.31869808700839, -6.513159053107743, -90.17551918888752, -113.17668630070355, -95.0011845363911, -148.9950828747867, -118.40781902292093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29250264377545143, "mean_inference_ms": 0.9135541726616557, "mean_action_processing_ms": 0.1632460078269748, "mean_env_wait_ms": 2.094460351917144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005837202072143555, "StateBufferConnector_ms": 0.004119396209716797, "ViewRequirementAgentConnector_ms": 0.10395407676696777}, "num_episodes": 57, "episode_return_max": 9.821037560067605, "episode_return_min": -487.94091179350227, "episode_return_mean": -86.78252796139508, "episodes_this_iter": 57}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.7066618610676, "num_env_steps_trained_throughput_per_sec": 274.7066618610676, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 13689.702, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13689.629, "sample_time_ms": 2961.542, "learn_time_ms": 10711.949, "learn_throughput": 373.415, "synch_weights_time_ms": 15.197}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "64a97_00000", "date": "2024-07-26_23-12-55", "timestamp": 1722015775, "time_this_iter_s": 14.567344188690186, "time_total_s": 456.69820857048035, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 456.69820857048035, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.057142857142857, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.04988899230958, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.44111394041683527, "policy_loss": -0.012597074855390626, "vf_loss": 0.4524414473368476, "vf_explained_var": 0.9991944239164392, "kl": 0.014637605689858916, "entropy": 0.531735509665062, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 15.164502273618849, "episode_reward_min": -487.94091179350227, "episode_reward_mean": -98.21335480294398, "episode_len_mean": 70.87, "episode_media": {}, "episodes_timesteps_total": 7087, "policy_reward_min": {"policy_0": -487.94091179350227}, "policy_reward_max": {"policy_0": 15.164502273618849}, "policy_reward_mean": {"policy_0": -98.21335480294398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.7563309378704, -80.39780630934945, -227.9678185571403, -98.08200239671054, -51.74970636370571, -5.067028256428834, 6.630927264409291, -26.744012073980816, -487.94091179350227, -201.90514662636838, -87.24958996971067, -56.03562526510788, -117.95790336208228, -20.7829833822194, -126.12464723887776, -26.581541810351432, -144.08806157864424, -85.75761678562318, -33.122639896893205, -51.39823720864241, -197.3322064227383, 6.114739821202687, -228.02780119396942, 4.88462338722136, -102.81907535303539, -72.70069862490813, -32.03783884996851, -77.77834225899183, 7.721785787299358, 0.7624417622402685, -214.5711585127248, -118.2699899730248, -60.26088998736042, -137.13288569895383, -147.74425082089775, -173.31869808700839, -6.513159053107743, -90.17551918888752, -113.17668630070355, -95.0011845363911, -148.9950828747867, -118.40781902292093, -6.572843768121419, -28.741101745469436, -102.90451879326693, -64.28770180223552, -129.11742503594073, -190.82488305954396, -194.88896818876069, -71.12733045458147, 3.4386116936993876, -37.87950313759294, -2.5923503198466227, -26.58974369893795, -125.45360663858908, -119.82419088006014, -152.0338084677139, -85.14122596453217, 8.696689183773628, -185.33433971651638, -80.02910159353667, -79.48428019447904, -158.47513519853652, -213.4030666755757, 2.5847871984353183, -242.43167256511884, -99.68361778494275, -200.81350765419592, -208.16476433932456, -209.68601864157776, -121.93707066754581, -88.0223860352145, -168.38766964444025, 15.164502273618849, -78.82216003268402, -70.29185271018868, -103.82895062231029, -195.58157872039794, -1.796663404625248, -71.48978833821776, -77.10608575386259, -160.6204796295939, -166.1478561673843, -45.60433964838288, -115.79257225482446, -4.101658464863714, -154.46685593772838, -97.7336520988766, -39.857834769304446, -111.80639013976999, -35.714107591200886, -109.74133035515915, 6.161815302374354, -25.824971024838813, 1.587259738466821, -223.17602986378557, -67.79165677605214, -27.60371825210191, -159.31212334344596, -219.06627856775424], "episode_lengths": [58, 70, 107, 69, 65, 36, 31, 46, 134, 94, 80, 58, 77, 50, 82, 41, 85, 81, 58, 51, 91, 34, 109, 39, 74, 70, 53, 68, 31, 40, 105, 89, 60, 94, 81, 88, 44, 81, 79, 83, 82, 84, 44, 50, 76, 61, 91, 90, 99, 75, 37, 54, 38, 50, 79, 75, 93, 66, 31, 101, 72, 69, 88, 100, 42, 106, 72, 92, 95, 102, 84, 82, 85, 29, 65, 68, 71, 95, 42, 62, 68, 88, 91, 59, 69, 33, 95, 70, 58, 87, 58, 71, 31, 59, 41, 109, 73, 56, 83, 105], "policy_policy_0_reward": [-64.7563309378704, -80.39780630934945, -227.9678185571403, -98.08200239671054, -51.74970636370571, -5.067028256428834, 6.630927264409291, -26.744012073980816, -487.94091179350227, -201.90514662636838, -87.24958996971067, -56.03562526510788, -117.95790336208228, -20.7829833822194, -126.12464723887776, -26.581541810351432, -144.08806157864424, -85.75761678562318, -33.122639896893205, -51.39823720864241, -197.3322064227383, 6.114739821202687, -228.02780119396942, 4.88462338722136, -102.81907535303539, -72.70069862490813, -32.03783884996851, -77.77834225899183, 7.721785787299358, 0.7624417622402685, -214.5711585127248, -118.2699899730248, -60.26088998736042, -137.13288569895383, -147.74425082089775, -173.31869808700839, -6.513159053107743, -90.17551918888752, -113.17668630070355, -95.0011845363911, -148.9950828747867, -118.40781902292093, -6.572843768121419, -28.741101745469436, -102.90451879326693, -64.28770180223552, -129.11742503594073, -190.82488305954396, -194.88896818876069, -71.12733045458147, 3.4386116936993876, -37.87950313759294, -2.5923503198466227, -26.58974369893795, -125.45360663858908, -119.82419088006014, -152.0338084677139, -85.14122596453217, 8.696689183773628, -185.33433971651638, -80.02910159353667, -79.48428019447904, -158.47513519853652, -213.4030666755757, 2.5847871984353183, -242.43167256511884, -99.68361778494275, -200.81350765419592, -208.16476433932456, -209.68601864157776, -121.93707066754581, -88.0223860352145, -168.38766964444025, 15.164502273618849, -78.82216003268402, -70.29185271018868, -103.82895062231029, -195.58157872039794, -1.796663404625248, -71.48978833821776, -77.10608575386259, -160.6204796295939, -166.1478561673843, -45.60433964838288, -115.79257225482446, -4.101658464863714, -154.46685593772838, -97.7336520988766, -39.857834769304446, -111.80639013976999, -35.714107591200886, -109.74133035515915, 6.161815302374354, -25.824971024838813, 1.587259738466821, -223.17602986378557, -67.79165677605214, -27.60371825210191, -159.31212334344596, -219.06627856775424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29269304924125383, "mean_inference_ms": 0.9132667084721063, "mean_action_processing_ms": 0.16319791190827676, "mean_env_wait_ms": 2.0952508367288476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058782100677490234, "StateBufferConnector_ms": 0.004113435745239258, "ViewRequirementAgentConnector_ms": 0.10326051712036133}, "num_episodes": 58, "episode_return_max": 15.164502273618849, "episode_return_min": -487.94091179350227, "episode_return_mean": -98.21335480294398, "episodes_this_iter": 58}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.88039437279633, "num_env_steps_trained_throughput_per_sec": 326.88039437279633, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 13457.961, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13457.885, "sample_time_ms": 2925.7, "learn_time_ms": 10516.31, "learn_throughput": 380.362, "synch_weights_time_ms": 14.92}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "64a97_00000", "date": "2024-07-26_23-13-07", "timestamp": 1722015787, "time_this_iter_s": 12.244080066680908, "time_total_s": 468.94228863716125, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.94228863716125, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.42941176470588, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.390767740209895, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.3984151580972442, "policy_loss": -0.011626070021399452, "vf_loss": 0.4081639374606311, "vf_explained_var": 0.9991976079220574, "kl": 0.014461007345623026, "entropy": 0.46301615055029594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": 17.05613140996073, "episode_reward_min": -242.43167256511884, "episode_reward_mean": -86.89530078951691, "episode_len_mean": 68.05, "episode_media": {}, "episodes_timesteps_total": 6805, "policy_reward_min": {"policy_0": -242.43167256511884}, "policy_reward_max": {"policy_0": 17.05613140996073}, "policy_reward_mean": {"policy_0": -86.89530078951691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.47513519853652, -213.4030666755757, 2.5847871984353183, -242.43167256511884, -99.68361778494275, -200.81350765419592, -208.16476433932456, -209.68601864157776, -121.93707066754581, -88.0223860352145, -168.38766964444025, 15.164502273618849, -78.82216003268402, -70.29185271018868, -103.82895062231029, -195.58157872039794, -1.796663404625248, -71.48978833821776, -77.10608575386259, -160.6204796295939, -166.1478561673843, -45.60433964838288, -115.79257225482446, -4.101658464863714, -154.46685593772838, -97.7336520988766, -39.857834769304446, -111.80639013976999, -35.714107591200886, -109.74133035515915, 6.161815302374354, -25.824971024838813, 1.587259738466821, -223.17602986378557, -67.79165677605214, -27.60371825210191, -159.31212334344596, -219.06627856775424, -72.6556040417634, 5.869864764789645, -51.3063684953674, -157.5549830925601, -115.23852610030761, -96.55608866159797, -79.19644910250095, -65.28176475641877, -4.337495199853216, -1.9378055345800695, -12.689028502855077, -85.69443216704249, -79.43682887848252, -15.345243271126018, -51.3589934524464, -102.37833448826383, -92.17167391222361, -157.9739767454719, -114.71344908250767, 5.866616178078675, -107.50037889279061, 6.169596053232878, 1.538386519806503, -96.22326131844767, -133.53070160136994, -3.565732764583184, -56.778093323557655, -191.688280551547, -96.48898944677886, 12.516102939020703, -71.19764406679751, 17.05613140996073, -203.8454204094735, -84.8342494665005, -78.12312718124011, -34.842256013295184, -108.7545674972821, -85.92921039892231, -7.106047880879333, -53.53828956952937, -232.58894631620848, -113.02173913332076, -86.66456594290295, -116.22998248968308, -91.73328459390733, -142.13107140304285, -156.9424717124708, -148.21394829479132, 7.658452138066451, -22.04518598150437, -77.44427303381079, 10.702195322281913, -191.3973670950888, -1.626707208989396, -104.2033050236855, 7.451856901469993, -82.58970588019714, -78.65247806468732, -103.41051906752683, -187.8439126698086, -14.757719631277714, 5.69667739379997], "episode_lengths": [88, 100, 42, 106, 72, 92, 95, 102, 84, 82, 85, 29, 65, 68, 71, 95, 42, 62, 68, 88, 91, 59, 69, 33, 95, 70, 58, 87, 58, 71, 31, 59, 41, 109, 73, 56, 83, 105, 64, 36, 56, 96, 87, 69, 65, 72, 36, 41, 53, 82, 67, 51, 58, 86, 75, 93, 74, 37, 77, 37, 30, 69, 79, 37, 62, 92, 71, 29, 67, 31, 104, 69, 74, 53, 79, 65, 41, 50, 101, 76, 82, 83, 76, 87, 83, 88, 33, 45, 65, 32, 94, 40, 82, 39, 77, 75, 69, 96, 48, 36], "policy_policy_0_reward": [-158.47513519853652, -213.4030666755757, 2.5847871984353183, -242.43167256511884, -99.68361778494275, -200.81350765419592, -208.16476433932456, -209.68601864157776, -121.93707066754581, -88.0223860352145, -168.38766964444025, 15.164502273618849, -78.82216003268402, -70.29185271018868, -103.82895062231029, -195.58157872039794, -1.796663404625248, -71.48978833821776, -77.10608575386259, -160.6204796295939, -166.1478561673843, -45.60433964838288, -115.79257225482446, -4.101658464863714, -154.46685593772838, -97.7336520988766, -39.857834769304446, -111.80639013976999, -35.714107591200886, -109.74133035515915, 6.161815302374354, -25.824971024838813, 1.587259738466821, -223.17602986378557, -67.79165677605214, -27.60371825210191, -159.31212334344596, -219.06627856775424, -72.6556040417634, 5.869864764789645, -51.3063684953674, -157.5549830925601, -115.23852610030761, -96.55608866159797, -79.19644910250095, -65.28176475641877, -4.337495199853216, -1.9378055345800695, -12.689028502855077, -85.69443216704249, -79.43682887848252, -15.345243271126018, -51.3589934524464, -102.37833448826383, -92.17167391222361, -157.9739767454719, -114.71344908250767, 5.866616178078675, -107.50037889279061, 6.169596053232878, 1.538386519806503, -96.22326131844767, -133.53070160136994, -3.565732764583184, -56.778093323557655, -191.688280551547, -96.48898944677886, 12.516102939020703, -71.19764406679751, 17.05613140996073, -203.8454204094735, -84.8342494665005, -78.12312718124011, -34.842256013295184, -108.7545674972821, -85.92921039892231, -7.106047880879333, -53.53828956952937, -232.58894631620848, -113.02173913332076, -86.66456594290295, -116.22998248968308, -91.73328459390733, -142.13107140304285, -156.9424717124708, -148.21394829479132, 7.658452138066451, -22.04518598150437, -77.44427303381079, 10.702195322281913, -191.3973670950888, -1.626707208989396, -104.2033050236855, 7.451856901469993, -82.58970588019714, -78.65247806468732, -103.41051906752683, -187.8439126698086, -14.757719631277714, 5.69667739379997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2926653378282344, "mean_inference_ms": 0.913837490234005, "mean_action_processing_ms": 0.16338594616208188, "mean_env_wait_ms": 2.0965683492612994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005929231643676758, "StateBufferConnector_ms": 0.0041964054107666016, "ViewRequirementAgentConnector_ms": 0.10391736030578613}, "num_episodes": 62, "episode_return_max": 17.05613140996073, "episode_return_min": -242.43167256511884, "episode_return_mean": -86.89530078951691, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.4883830869152, "num_env_steps_trained_throughput_per_sec": 281.4883830869152, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 13487.81, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13487.733, "sample_time_ms": 2893.653, "learn_time_ms": 10578.095, "learn_throughput": 378.14, "synch_weights_time_ms": 14.947}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "64a97_00000", "date": "2024-07-26_23-13-22", "timestamp": 1722015802, "time_this_iter_s": 14.216972589492798, "time_total_s": 483.15926122665405, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 483.15926122665405, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.99, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.380654302736126, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.43177225571416783, "policy_loss": -0.010731024795677512, "vf_loss": 0.44031500718556343, "vf_explained_var": 0.9983191674575209, "kl": 0.013858322012811206, "entropy": 0.40479706634456913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 19.16358083332684, "episode_reward_min": -232.58894631620848, "episode_reward_mean": -71.69085096171523, "episode_len_mean": 63.87, "episode_media": {}, "episodes_timesteps_total": 6387, "policy_reward_min": {"policy_0": -232.58894631620848}, "policy_reward_max": {"policy_0": 19.16358083332684}, "policy_reward_mean": {"policy_0": -71.69085096171523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.565732764583184, -56.778093323557655, -191.688280551547, -96.48898944677886, 12.516102939020703, -71.19764406679751, 17.05613140996073, -203.8454204094735, -84.8342494665005, -78.12312718124011, -34.842256013295184, -108.7545674972821, -85.92921039892231, -7.106047880879333, -53.53828956952937, -232.58894631620848, -113.02173913332076, -86.66456594290295, -116.22998248968308, -91.73328459390733, -142.13107140304285, -156.9424717124708, -148.21394829479132, 7.658452138066451, -22.04518598150437, -77.44427303381079, 10.702195322281913, -191.3973670950888, -1.626707208989396, -104.2033050236855, 7.451856901469993, -82.58970588019714, -78.65247806468732, -103.41051906752683, -187.8439126698086, -14.757719631277714, 5.69667739379997, -89.32444198077262, 19.16358083332684, -109.38991530317846, -90.05152451042021, -93.73602554761445, -91.46874201342793, -2.0509515858352283, -9.35150611500443, -7.7196152676986705, -184.48544771088834, -71.38848660205024, -10.042609335519288, 5.689830245692818, -25.141760827867877, -136.33853415884914, -180.3807839031142, -25.556104941958516, -114.2164643044716, -84.38651100289322, -80.65176176649227, -33.23708676478598, -117.27456956754848, -64.01999039108544, -28.40110360067472, -66.74199532412395, -9.816140319259299, -147.8473745782729, -119.39108143791353, -22.008851687032195, -12.938776822497415, -108.9026074074812, -14.331881495955525, -111.1335184346105, -70.22224191329657, -39.15845987191655, -23.505820107278154, -75.87045617869602, -122.87192604184092, -95.24399735886668, -23.906255215195518, -35.32106674766061, -2.526526768143015, 7.8545186271497585, 0.09374670087707426, -25.614752458745148, -52.880827875002026, -147.7757432406221, -22.898954513898566, -98.69157044883207, -108.85950650367924, 6.294673604499643, -64.63469220353399, -24.222347109362765, -30.28310649388006, -120.9570138271729, -228.20748650343774, 10.052937409266224, 8.39016702102385, -142.35390450946258, -67.54105245167966, -155.8628543560459, -86.29483133708192, -132.08531586003824], "episode_lengths": [37, 62, 92, 71, 29, 67, 31, 104, 69, 74, 53, 79, 65, 41, 50, 101, 76, 82, 83, 76, 87, 83, 88, 33, 45, 65, 32, 94, 40, 82, 39, 77, 75, 69, 96, 48, 36, 67, 28, 74, 70, 71, 68, 44, 46, 50, 88, 61, 45, 31, 54, 86, 101, 49, 74, 71, 72, 54, 78, 62, 43, 60, 49, 95, 90, 44, 49, 73, 49, 80, 65, 55, 55, 64, 71, 70, 56, 51, 49, 40, 47, 54, 64, 86, 50, 85, 68, 42, 59, 58, 48, 89, 106, 35, 37, 81, 62, 84, 67, 82], "policy_policy_0_reward": [-3.565732764583184, -56.778093323557655, -191.688280551547, -96.48898944677886, 12.516102939020703, -71.19764406679751, 17.05613140996073, -203.8454204094735, -84.8342494665005, -78.12312718124011, -34.842256013295184, -108.7545674972821, -85.92921039892231, -7.106047880879333, -53.53828956952937, -232.58894631620848, -113.02173913332076, -86.66456594290295, -116.22998248968308, -91.73328459390733, -142.13107140304285, -156.9424717124708, -148.21394829479132, 7.658452138066451, -22.04518598150437, -77.44427303381079, 10.702195322281913, -191.3973670950888, -1.626707208989396, -104.2033050236855, 7.451856901469993, -82.58970588019714, -78.65247806468732, -103.41051906752683, -187.8439126698086, -14.757719631277714, 5.69667739379997, -89.32444198077262, 19.16358083332684, -109.38991530317846, -90.05152451042021, -93.73602554761445, -91.46874201342793, -2.0509515858352283, -9.35150611500443, -7.7196152676986705, -184.48544771088834, -71.38848660205024, -10.042609335519288, 5.689830245692818, -25.141760827867877, -136.33853415884914, -180.3807839031142, -25.556104941958516, -114.2164643044716, -84.38651100289322, -80.65176176649227, -33.23708676478598, -117.27456956754848, -64.01999039108544, -28.40110360067472, -66.74199532412395, -9.816140319259299, -147.8473745782729, -119.39108143791353, -22.008851687032195, -12.938776822497415, -108.9026074074812, -14.331881495955525, -111.1335184346105, -70.22224191329657, -39.15845987191655, -23.505820107278154, -75.87045617869602, -122.87192604184092, -95.24399735886668, -23.906255215195518, -35.32106674766061, -2.526526768143015, 7.8545186271497585, 0.09374670087707426, -25.614752458745148, -52.880827875002026, -147.7757432406221, -22.898954513898566, -98.69157044883207, -108.85950650367924, 6.294673604499643, -64.63469220353399, -24.222347109362765, -30.28310649388006, -120.9570138271729, -228.20748650343774, 10.052937409266224, 8.39016702102385, -142.35390450946258, -67.54105245167966, -155.8628543560459, -86.29483133708192, -132.08531586003824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927277210769768, "mean_inference_ms": 0.913800979212383, "mean_action_processing_ms": 0.16347985277705404, "mean_env_wait_ms": 2.098869067145089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00547337532043457, "StateBufferConnector_ms": 0.0040607452392578125, "ViewRequirementAgentConnector_ms": 0.10110712051391602}, "num_episodes": 63, "episode_return_max": 19.16358083332684, "episode_return_min": -232.58894631620848, "episode_return_mean": -71.69085096171523, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.8610206087245, "num_env_steps_trained_throughput_per_sec": 274.8610206087245, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 13457.773, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13457.694, "sample_time_ms": 2899.128, "learn_time_ms": 10542.799, "learn_throughput": 379.406, "synch_weights_time_ms": 14.717}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "64a97_00000", "date": "2024-07-26_23-13-36", "timestamp": 1722015816, "time_this_iter_s": 14.559679746627808, "time_total_s": 497.71894097328186, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7045e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 497.71894097328186, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.104761904761906, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.970340586205324, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.34780212266826616, "policy_loss": -0.011686754200491123, "vf_loss": 0.35543230168210965, "vf_explained_var": 0.9993793938308955, "kl": 0.017038032017838607, "entropy": 0.3610539116120587, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 10.491745436640405, "episode_reward_min": -228.20748650343774, "episode_reward_mean": -67.8228511371305, "episode_len_mean": 63.72, "episode_media": {}, "episodes_timesteps_total": 6372, "policy_reward_min": {"policy_0": -228.20748650343774}, "policy_reward_max": {"policy_0": 10.491745436640405}, "policy_reward_mean": {"policy_0": -67.8228511371305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-147.8473745782729, -119.39108143791353, -22.008851687032195, -12.938776822497415, -108.9026074074812, -14.331881495955525, -111.1335184346105, -70.22224191329657, -39.15845987191655, -23.505820107278154, -75.87045617869602, -122.87192604184092, -95.24399735886668, -23.906255215195518, -35.32106674766061, -2.526526768143015, 7.8545186271497585, 0.09374670087707426, -25.614752458745148, -52.880827875002026, -147.7757432406221, -22.898954513898566, -98.69157044883207, -108.85950650367924, 6.294673604499643, -64.63469220353399, -24.222347109362765, -30.28310649388006, -120.9570138271729, -228.20748650343774, 10.052937409266224, 8.39016702102385, -142.35390450946258, -67.54105245167966, -155.8628543560459, -86.29483133708192, -132.08531586003824, 6.936243232659299, -71.76725132943902, -118.78565988098684, -39.92862522771747, -36.272004274403656, -94.32620839890333, -121.34637559914152, -102.06975731709036, -58.533495872634106, -14.939019145970189, -6.919182134032825, -32.623064984336715, -116.48695636245931, -100.65462405137491, -77.05616415925655, -226.56997083243044, -119.1785551418679, -127.82863442983754, 10.491745436640405, -132.52093653630754, -6.676753658540635, -0.6648996173315957, -28.544234089226023, -91.27266444168771, -16.891223406885384, -102.3854496602904, -69.66369219541495, -5.200867563233138, -32.896649971849946, -8.998789849909752, -146.99517810241582, -64.35805374794296, -22.538928514031877, -68.08124298134554, -25.71127660221432, -22.796767576203166, -152.09981512599884, -157.94527243113598, -30.76162548338584, -127.09698521150561, -37.68086791066978, -7.3814358335282835, -25.756130767308957, -89.48177324490109, -222.0188858083827, -58.86254338096655, 6.024531788683868, 4.070874993527729, -111.99904073967049, -216.23801424044723, -178.49413764921098, -58.72572628599682, -13.805098561722195, -60.282944795786484, -86.07030173200314, -109.21808227853484, -75.60267668627013, -10.62975477531802, -36.34562930601632, -32.94577358258207, -6.606327746772876, 1.8654304831605129, -92.48318001657789], "episode_lengths": [95, 90, 44, 49, 73, 49, 80, 65, 55, 55, 64, 71, 70, 56, 51, 49, 40, 47, 54, 64, 86, 50, 85, 68, 42, 59, 58, 48, 89, 106, 35, 37, 81, 62, 84, 67, 82, 39, 64, 75, 58, 55, 83, 77, 77, 63, 50, 42, 50, 89, 73, 80, 105, 89, 77, 35, 83, 40, 45, 56, 69, 52, 72, 74, 48, 56, 45, 95, 62, 54, 61, 54, 40, 79, 84, 45, 80, 56, 41, 45, 68, 98, 62, 38, 39, 77, 104, 88, 60, 50, 65, 68, 87, 65, 46, 59, 59, 47, 31, 84], "policy_policy_0_reward": [-147.8473745782729, -119.39108143791353, -22.008851687032195, -12.938776822497415, -108.9026074074812, -14.331881495955525, -111.1335184346105, -70.22224191329657, -39.15845987191655, -23.505820107278154, -75.87045617869602, -122.87192604184092, -95.24399735886668, -23.906255215195518, -35.32106674766061, -2.526526768143015, 7.8545186271497585, 0.09374670087707426, -25.614752458745148, -52.880827875002026, -147.7757432406221, -22.898954513898566, -98.69157044883207, -108.85950650367924, 6.294673604499643, -64.63469220353399, -24.222347109362765, -30.28310649388006, -120.9570138271729, -228.20748650343774, 10.052937409266224, 8.39016702102385, -142.35390450946258, -67.54105245167966, -155.8628543560459, -86.29483133708192, -132.08531586003824, 6.936243232659299, -71.76725132943902, -118.78565988098684, -39.92862522771747, -36.272004274403656, -94.32620839890333, -121.34637559914152, -102.06975731709036, -58.533495872634106, -14.939019145970189, -6.919182134032825, -32.623064984336715, -116.48695636245931, -100.65462405137491, -77.05616415925655, -226.56997083243044, -119.1785551418679, -127.82863442983754, 10.491745436640405, -132.52093653630754, -6.676753658540635, -0.6648996173315957, -28.544234089226023, -91.27266444168771, -16.891223406885384, -102.3854496602904, -69.66369219541495, -5.200867563233138, -32.896649971849946, -8.998789849909752, -146.99517810241582, -64.35805374794296, -22.538928514031877, -68.08124298134554, -25.71127660221432, -22.796767576203166, -152.09981512599884, -157.94527243113598, -30.76162548338584, -127.09698521150561, -37.68086791066978, -7.3814358335282835, -25.756130767308957, -89.48177324490109, -222.0188858083827, -58.86254338096655, 6.024531788683868, 4.070874993527729, -111.99904073967049, -216.23801424044723, -178.49413764921098, -58.72572628599682, -13.805098561722195, -60.282944795786484, -86.07030173200314, -109.21808227853484, -75.60267668627013, -10.62975477531802, -36.34562930601632, -32.94577358258207, -6.606327746772876, 1.8654304831605129, -92.48318001657789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927403839454447, "mean_inference_ms": 0.9130244649196035, "mean_action_processing_ms": 0.16337099332928917, "mean_env_wait_ms": 2.1003631962998814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005239248275756836, "StateBufferConnector_ms": 0.004022359848022461, "ViewRequirementAgentConnector_ms": 0.10085415840148926}, "num_episodes": 63, "episode_return_max": 10.491745436640405, "episode_return_min": -228.20748650343774, "episode_return_mean": -67.8228511371305, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.1664667172313, "num_env_steps_trained_throughput_per_sec": 278.1664667172313, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 13444.099, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13444.019, "sample_time_ms": 2901.228, "learn_time_ms": 10527.276, "learn_throughput": 379.965, "synch_weights_time_ms": 14.438}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "64a97_00000", "date": "2024-07-26_23-13-51", "timestamp": 1722015831, "time_this_iter_s": 14.388747215270996, "time_total_s": 512.1076881885529, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7070a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 512.1076881885529, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 10.280952380952382, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.02400067845981, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.32815678268962073, "policy_loss": -0.006197362877234506, "vf_loss": 0.3286234724102542, "vf_explained_var": 0.9986577084908883, "kl": 0.020704904850087306, "entropy": 0.3586532237784316, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 19.958084306749903, "episode_reward_min": -232.30059537183607, "episode_reward_mean": -72.54999680988935, "episode_len_mean": 64.32, "episode_media": {}, "episodes_timesteps_total": 6432, "policy_reward_min": {"policy_0": -232.30059537183607}, "policy_reward_max": {"policy_0": 19.958084306749903}, "policy_reward_mean": {"policy_0": -72.54999680988935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.891223406885384, -102.3854496602904, -69.66369219541495, -5.200867563233138, -32.896649971849946, -8.998789849909752, -146.99517810241582, -64.35805374794296, -22.538928514031877, -68.08124298134554, -25.71127660221432, -22.796767576203166, -152.09981512599884, -157.94527243113598, -30.76162548338584, -127.09698521150561, -37.68086791066978, -7.3814358335282835, -25.756130767308957, -89.48177324490109, -222.0188858083827, -58.86254338096655, 6.024531788683868, 4.070874993527729, -111.99904073967049, -216.23801424044723, -178.49413764921098, -58.72572628599682, -13.805098561722195, -60.282944795786484, -86.07030173200314, -109.21808227853484, -75.60267668627013, -10.62975477531802, -36.34562930601632, -32.94577358258207, -6.606327746772876, 1.8654304831605129, -92.48318001657789, -31.150348249436604, -67.99769777441146, -73.66549743891927, -106.18835951422999, -216.28267847274324, -163.95293869348814, -232.30059537183607, -79.01453566049831, -131.7773473653255, -194.7021253057614, -86.06597466943589, -32.09626811294781, -98.38300258273351, 13.491269272272346, -29.63724959194264, 1.815088098499766, -19.809685284843365, -77.60168926343857, -48.264612854588464, 8.289405759958493, -217.33329257597728, -183.2520152418523, -90.67999063692616, -72.00712683455133, -127.50690069411452, 11.32865552717167, 8.952710334265268, 19.958084306749903, -59.24882747264844, -142.7295419292782, -100.6361086477685, -8.327721674645474, -119.75499163498027, -35.53344936440287, -20.54278226446059, -10.047876515371346, -89.307762402164, -31.05127834175299, -93.1412547114453, -47.77077390710333, -90.15987658974562, -21.129578969332133, -172.1506827256648, -104.11713771922905, -91.24619164946232, 13.500737203656385, -18.318862877472277, 12.300352470432772, -68.8784948090984, -175.41495351180825, -231.85773863321015, -127.71221299101782, -50.40770988934909, -84.91402504762615, -109.52794551226648, -82.643722718128, -7.32148784490359, -24.666478085503094, -44.2457603719601, 8.08612332655109, -137.15763978563342], "episode_lengths": [52, 72, 74, 48, 56, 45, 95, 62, 54, 61, 54, 40, 79, 84, 45, 80, 56, 41, 45, 68, 98, 62, 38, 39, 77, 104, 88, 60, 50, 65, 68, 87, 65, 46, 59, 59, 47, 31, 84, 58, 62, 63, 73, 104, 87, 106, 68, 80, 93, 71, 61, 75, 31, 60, 44, 54, 51, 53, 43, 106, 99, 71, 79, 87, 36, 38, 29, 64, 85, 71, 50, 74, 61, 44, 51, 69, 48, 68, 58, 65, 50, 87, 72, 75, 28, 48, 29, 63, 97, 110, 79, 58, 69, 77, 66, 50, 59, 56, 38, 93], "policy_policy_0_reward": [-16.891223406885384, -102.3854496602904, -69.66369219541495, -5.200867563233138, -32.896649971849946, -8.998789849909752, -146.99517810241582, -64.35805374794296, -22.538928514031877, -68.08124298134554, -25.71127660221432, -22.796767576203166, -152.09981512599884, -157.94527243113598, -30.76162548338584, -127.09698521150561, -37.68086791066978, -7.3814358335282835, -25.756130767308957, -89.48177324490109, -222.0188858083827, -58.86254338096655, 6.024531788683868, 4.070874993527729, -111.99904073967049, -216.23801424044723, -178.49413764921098, -58.72572628599682, -13.805098561722195, -60.282944795786484, -86.07030173200314, -109.21808227853484, -75.60267668627013, -10.62975477531802, -36.34562930601632, -32.94577358258207, -6.606327746772876, 1.8654304831605129, -92.48318001657789, -31.150348249436604, -67.99769777441146, -73.66549743891927, -106.18835951422999, -216.28267847274324, -163.95293869348814, -232.30059537183607, -79.01453566049831, -131.7773473653255, -194.7021253057614, -86.06597466943589, -32.09626811294781, -98.38300258273351, 13.491269272272346, -29.63724959194264, 1.815088098499766, -19.809685284843365, -77.60168926343857, -48.264612854588464, 8.289405759958493, -217.33329257597728, -183.2520152418523, -90.67999063692616, -72.00712683455133, -127.50690069411452, 11.32865552717167, 8.952710334265268, 19.958084306749903, -59.24882747264844, -142.7295419292782, -100.6361086477685, -8.327721674645474, -119.75499163498027, -35.53344936440287, -20.54278226446059, -10.047876515371346, -89.307762402164, -31.05127834175299, -93.1412547114453, -47.77077390710333, -90.15987658974562, -21.129578969332133, -172.1506827256648, -104.11713771922905, -91.24619164946232, 13.500737203656385, -18.318862877472277, 12.300352470432772, -68.8784948090984, -175.41495351180825, -231.85773863321015, -127.71221299101782, -50.40770988934909, -84.91402504762615, -109.52794551226648, -82.643722718128, -7.32148784490359, -24.666478085503094, -44.2457603719601, 8.08612332655109, -137.15763978563342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29282771095978377, "mean_inference_ms": 0.9123008473786721, "mean_action_processing_ms": 0.16313468914183565, "mean_env_wait_ms": 2.1015657570994297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054209232330322266, "StateBufferConnector_ms": 0.004137277603149414, "ViewRequirementAgentConnector_ms": 0.10246849060058594}, "num_episodes": 61, "episode_return_max": 19.958084306749903, "episode_return_min": -232.30059537183607, "episode_return_mean": -72.54999680988935, "episodes_this_iter": 61}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.4972418913905, "num_env_steps_trained_throughput_per_sec": 289.4972418913905, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 13444.88, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13444.802, "sample_time_ms": 2911.259, "learn_time_ms": 10517.762, "learn_throughput": 380.309, "synch_weights_time_ms": 14.684}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "64a97_00000", "date": "2024-07-26_23-14-05", "timestamp": 1722015845, "time_this_iter_s": 13.825260877609253, "time_total_s": 525.9329490661621, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bb490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 525.9329490661621, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.663157894736843, "ram_util_percent": 28.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.36262265990177, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.33994705215009163, "policy_loss": -0.009660877573575513, "vf_loss": 0.3455613347856949, "vf_explained_var": 0.9992244942113757, "kl": 0.010750834678765404, "entropy": 0.32102201036177574, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": 19.958084306749903, "episode_reward_min": -231.85773863321015, "episode_reward_mean": -77.52445524206654, "episode_len_mean": 65.85, "episode_media": {}, "episodes_timesteps_total": 6585, "policy_reward_min": {"policy_0": -231.85773863321015}, "policy_reward_max": {"policy_0": 19.958084306749903}, "policy_reward_mean": {"policy_0": -77.52445524206654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217.33329257597728, -183.2520152418523, -90.67999063692616, -72.00712683455133, -127.50690069411452, 11.32865552717167, 8.952710334265268, 19.958084306749903, -59.24882747264844, -142.7295419292782, -100.6361086477685, -8.327721674645474, -119.75499163498027, -35.53344936440287, -20.54278226446059, -10.047876515371346, -89.307762402164, -31.05127834175299, -93.1412547114453, -47.77077390710333, -90.15987658974562, -21.129578969332133, -172.1506827256648, -104.11713771922905, -91.24619164946232, 13.500737203656385, -18.318862877472277, 12.300352470432772, -68.8784948090984, -175.41495351180825, -231.85773863321015, -127.71221299101782, -50.40770988934909, -84.91402504762615, -109.52794551226648, -82.643722718128, -7.32148784490359, -24.666478085503094, -44.2457603719601, 8.08612332655109, -137.15763978563342, -70.8887194802281, -124.09675749229655, -23.359484160989556, -20.280579414923537, -132.4363497281089, -71.12443738017757, -103.5551525925746, -15.170931900926528, 4.106393673698502, 2.961936472788449, -174.67519190545255, -85.43084822954958, 3.507927702872493, -105.25711870591634, -115.5910328386334, -106.96896259701514, -5.357744268711951, -112.20424972573753, -96.27672145829887, -58.63001510740387, -143.73023003284143, -59.26652590428666, -13.49480669704382, 9.552168220976174, -3.424256911306345, -12.18010143098942, -193.5691318549521, -89.38227972434528, -133.82306334903524, -63.43215018049152, -224.27286885193377, -61.64771676736572, -17.80075783785731, 0.12967819102328182, 6.56792550068052, -95.75404669207535, -199.317473137258, -121.04425669849499, -94.2467850561106, -193.6291917626269, -207.26168257232516, -106.90953413379032, 9.276763308664478, -174.57961119014786, -114.97336066883949, -40.3317724924906, -164.54497377711004, -176.94544801871797, -54.40927396144503, -203.5006499908266, -11.161839852919691, -88.54218287581858, -81.04533281907165, -49.714140246663334, 18.13301581515687, -90.93831659308117, -81.11490875723035, 4.404050271540909, -7.176884125590324], "episode_lengths": [106, 99, 71, 79, 87, 36, 38, 29, 64, 85, 71, 50, 74, 61, 44, 51, 69, 48, 68, 58, 65, 50, 87, 72, 75, 28, 48, 29, 63, 97, 110, 79, 58, 69, 77, 66, 50, 59, 56, 38, 93, 63, 90, 54, 55, 78, 65, 84, 52, 35, 38, 89, 70, 35, 75, 74, 72, 39, 73, 84, 59, 89, 56, 51, 42, 50, 54, 91, 68, 79, 63, 102, 59, 45, 40, 40, 73, 99, 90, 77, 93, 100, 78, 34, 93, 77, 62, 98, 97, 61, 80, 52, 70, 80, 52, 26, 67, 69, 40, 47], "policy_policy_0_reward": [-217.33329257597728, -183.2520152418523, -90.67999063692616, -72.00712683455133, -127.50690069411452, 11.32865552717167, 8.952710334265268, 19.958084306749903, -59.24882747264844, -142.7295419292782, -100.6361086477685, -8.327721674645474, -119.75499163498027, -35.53344936440287, -20.54278226446059, -10.047876515371346, -89.307762402164, -31.05127834175299, -93.1412547114453, -47.77077390710333, -90.15987658974562, -21.129578969332133, -172.1506827256648, -104.11713771922905, -91.24619164946232, 13.500737203656385, -18.318862877472277, 12.300352470432772, -68.8784948090984, -175.41495351180825, -231.85773863321015, -127.71221299101782, -50.40770988934909, -84.91402504762615, -109.52794551226648, -82.643722718128, -7.32148784490359, -24.666478085503094, -44.2457603719601, 8.08612332655109, -137.15763978563342, -70.8887194802281, -124.09675749229655, -23.359484160989556, -20.280579414923537, -132.4363497281089, -71.12443738017757, -103.5551525925746, -15.170931900926528, 4.106393673698502, 2.961936472788449, -174.67519190545255, -85.43084822954958, 3.507927702872493, -105.25711870591634, -115.5910328386334, -106.96896259701514, -5.357744268711951, -112.20424972573753, -96.27672145829887, -58.63001510740387, -143.73023003284143, -59.26652590428666, -13.49480669704382, 9.552168220976174, -3.424256911306345, -12.18010143098942, -193.5691318549521, -89.38227972434528, -133.82306334903524, -63.43215018049152, -224.27286885193377, -61.64771676736572, -17.80075783785731, 0.12967819102328182, 6.56792550068052, -95.75404669207535, -199.317473137258, -121.04425669849499, -94.2467850561106, -193.6291917626269, -207.26168257232516, -106.90953413379032, 9.276763308664478, -174.57961119014786, -114.97336066883949, -40.3317724924906, -164.54497377711004, -176.94544801871797, -54.40927396144503, -203.5006499908266, -11.161839852919691, -88.54218287581858, -81.04533281907165, -49.714140246663334, 18.13301581515687, -90.93831659308117, -81.11490875723035, 4.404050271540909, -7.176884125590324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929971841891448, "mean_inference_ms": 0.9128148729325565, "mean_action_processing_ms": 0.16333958400673532, "mean_env_wait_ms": 2.102815273150632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005507946014404297, "StateBufferConnector_ms": 0.004068851470947266, "ViewRequirementAgentConnector_ms": 0.10166621208190918}, "num_episodes": 59, "episode_return_max": 19.958084306749903, "episode_return_min": -231.85773863321015, "episode_return_mean": -77.52445524206654, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.7876272712816, "num_env_steps_trained_throughput_per_sec": 269.7876272712816, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 13841.303, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13841.224, "sample_time_ms": 2912.441, "learn_time_ms": 10912.333, "learn_throughput": 366.558, "synch_weights_time_ms": 15.32}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "64a97_00000", "date": "2024-07-26_23-14-20", "timestamp": 1722015860, "time_this_iter_s": 14.834211826324463, "time_total_s": 540.7671608924866, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7070a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 540.7671608924866, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 9.94090909090909, "ram_util_percent": 28.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.81901033272346, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.4014531355826572, "policy_loss": -0.010714425645710434, "vf_loss": 0.41013056416995824, "vf_explained_var": 0.9985541333754857, "kl": 0.008617776463309686, "entropy": 0.3780002167293181, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 18.13301581515687, "episode_reward_min": -365.4759240672547, "episode_reward_mean": -86.22586380321744, "episode_len_mean": 67.86, "episode_media": {}, "episodes_timesteps_total": 6786, "policy_reward_min": {"policy_0": -365.4759240672547}, "policy_reward_max": {"policy_0": 18.13301581515687}, "policy_reward_mean": {"policy_0": -86.22586380321744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.27672145829887, -58.63001510740387, -143.73023003284143, -59.26652590428666, -13.49480669704382, 9.552168220976174, -3.424256911306345, -12.18010143098942, -193.5691318549521, -89.38227972434528, -133.82306334903524, -63.43215018049152, -224.27286885193377, -61.64771676736572, -17.80075783785731, 0.12967819102328182, 6.56792550068052, -95.75404669207535, -199.317473137258, -121.04425669849499, -94.2467850561106, -193.6291917626269, -207.26168257232516, -106.90953413379032, 9.276763308664478, -174.57961119014786, -114.97336066883949, -40.3317724924906, -164.54497377711004, -176.94544801871797, -54.40927396144503, -203.5006499908266, -11.161839852919691, -88.54218287581858, -81.04533281907165, -49.714140246663334, 18.13301581515687, -90.93831659308117, -81.11490875723035, 4.404050271540909, -7.176884125590324, -96.63001951055789, -60.46687864204481, -78.25001003608374, -6.6215231577013425, -207.1425080193982, -6.131051987476374, -96.71449384234018, -33.70918324045478, -159.42720502153685, -232.6415740816744, -108.94394117349295, -8.685119121256397, -45.165869496407836, -72.46861144013641, -228.47196756703343, -172.52074316223602, -25.99877497542215, -9.401372709843672, -6.776629297887345, -158.72908011426728, -11.692753721666552, -18.430374783955415, -16.706609203126344, -14.09748275209558, -137.89615659115762, -82.38995294277305, -84.94440723723764, -66.97540590515565, 10.39281117734686, -118.09543150670335, -97.86711640646584, -83.71858469160344, -42.14295505309081, -205.31332859065768, -118.63364026314827, -7.790817091185472, -47.846647707568984, 13.56103874115523, -92.81134238647189, -5.378980054773341, 4.953951155539315, -365.4759240672547, -74.27582271265477, -92.40013784853254, -24.210971594853447, -80.59560945960851, 6.43597834989974, -114.48837730759732, 9.573853227189145, -212.22732194021748, -125.84192549257966, -140.64925455050297, -114.83405386528344, -103.10572958825891, -16.29617496151361, -167.67231757352263, -182.3555001439868, -70.42533636452842, -235.01232179314658], "episode_lengths": [84, 59, 89, 56, 51, 42, 50, 54, 91, 68, 79, 63, 102, 59, 45, 40, 40, 73, 99, 90, 77, 93, 100, 78, 34, 93, 77, 62, 98, 97, 61, 80, 52, 70, 80, 52, 26, 67, 69, 40, 47, 70, 59, 65, 46, 99, 47, 79, 55, 94, 108, 73, 38, 60, 66, 104, 90, 55, 45, 48, 85, 44, 48, 53, 38, 81, 78, 67, 53, 36, 80, 77, 66, 59, 105, 89, 42, 54, 33, 82, 43, 35, 108, 64, 69, 55, 76, 36, 70, 41, 101, 79, 94, 75, 83, 50, 87, 90, 64, 108], "policy_policy_0_reward": [-96.27672145829887, -58.63001510740387, -143.73023003284143, -59.26652590428666, -13.49480669704382, 9.552168220976174, -3.424256911306345, -12.18010143098942, -193.5691318549521, -89.38227972434528, -133.82306334903524, -63.43215018049152, -224.27286885193377, -61.64771676736572, -17.80075783785731, 0.12967819102328182, 6.56792550068052, -95.75404669207535, -199.317473137258, -121.04425669849499, -94.2467850561106, -193.6291917626269, -207.26168257232516, -106.90953413379032, 9.276763308664478, -174.57961119014786, -114.97336066883949, -40.3317724924906, -164.54497377711004, -176.94544801871797, -54.40927396144503, -203.5006499908266, -11.161839852919691, -88.54218287581858, -81.04533281907165, -49.714140246663334, 18.13301581515687, -90.93831659308117, -81.11490875723035, 4.404050271540909, -7.176884125590324, -96.63001951055789, -60.46687864204481, -78.25001003608374, -6.6215231577013425, -207.1425080193982, -6.131051987476374, -96.71449384234018, -33.70918324045478, -159.42720502153685, -232.6415740816744, -108.94394117349295, -8.685119121256397, -45.165869496407836, -72.46861144013641, -228.47196756703343, -172.52074316223602, -25.99877497542215, -9.401372709843672, -6.776629297887345, -158.72908011426728, -11.692753721666552, -18.430374783955415, -16.706609203126344, -14.09748275209558, -137.89615659115762, -82.38995294277305, -84.94440723723764, -66.97540590515565, 10.39281117734686, -118.09543150670335, -97.86711640646584, -83.71858469160344, -42.14295505309081, -205.31332859065768, -118.63364026314827, -7.790817091185472, -47.846647707568984, 13.56103874115523, -92.81134238647189, -5.378980054773341, 4.953951155539315, -365.4759240672547, -74.27582271265477, -92.40013784853254, -24.210971594853447, -80.59560945960851, 6.43597834989974, -114.48837730759732, 9.573853227189145, -212.22732194021748, -125.84192549257966, -140.64925455050297, -114.83405386528344, -103.10572958825891, -16.29617496151361, -167.67231757352263, -182.3555001439868, -70.42533636452842, -235.01232179314658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29319459746003357, "mean_inference_ms": 0.9119564544086495, "mean_action_processing_ms": 0.16309793399627234, "mean_env_wait_ms": 2.102905523241164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005738258361816406, "StateBufferConnector_ms": 0.00405120849609375, "ViewRequirementAgentConnector_ms": 0.10158467292785645}, "num_episodes": 59, "episode_return_max": 18.13301581515687, "episode_return_min": -365.4759240672547, "episode_return_mean": -86.22586380321744, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.18566320153633, "num_env_steps_trained_throughput_per_sec": 278.18566320153633, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 14117.568, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14117.485, "sample_time_ms": 2906.283, "learn_time_ms": 11194.641, "learn_throughput": 357.314, "synch_weights_time_ms": 15.419}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "64a97_00000", "date": "2024-07-26_23-14-34", "timestamp": 1722015874, "time_this_iter_s": 14.38790249824524, "time_total_s": 555.1550633907318, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb706710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 555.1550633907318, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.44, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.3605092595021, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3541632749605924, "policy_loss": -0.013779572850520101, "vf_loss": 0.3619325594355663, "vf_explained_var": 0.9993355981384714, "kl": 0.01376696942952551, "entropy": 0.3282415188771362, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": 13.56103874115523, "episode_reward_min": -365.4759240672547, "episode_reward_mean": -91.2682021553273, "episode_len_mean": 69.53, "episode_media": {}, "episodes_timesteps_total": 6953, "policy_reward_min": {"policy_0": -365.4759240672547}, "policy_reward_max": {"policy_0": 13.56103874115523}, "policy_reward_mean": {"policy_0": -91.2682021553273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.52074316223602, -25.99877497542215, -9.401372709843672, -6.776629297887345, -158.72908011426728, -11.692753721666552, -18.430374783955415, -16.706609203126344, -14.09748275209558, -137.89615659115762, -82.38995294277305, -84.94440723723764, -66.97540590515565, 10.39281117734686, -118.09543150670335, -97.86711640646584, -83.71858469160344, -42.14295505309081, -205.31332859065768, -118.63364026314827, -7.790817091185472, -47.846647707568984, 13.56103874115523, -92.81134238647189, -5.378980054773341, 4.953951155539315, -365.4759240672547, -74.27582271265477, -92.40013784853254, -24.210971594853447, -80.59560945960851, 6.43597834989974, -114.48837730759732, 9.573853227189145, -212.22732194021748, -125.84192549257966, -140.64925455050297, -114.83405386528344, -103.10572958825891, -16.29617496151361, -167.67231757352263, -182.3555001439868, -70.42533636452842, -235.01232179314658, 7.293405927903085, 12.568451528703694, -131.22919537786018, -26.78977268619177, -154.46782691494812, -11.55513016617413, -137.77588442436755, -15.918673641196369, -6.565744005534304, -72.91864034967038, 8.742554162866483, -60.91235314090944, -159.12241880906646, -88.99244068534722, -208.65123974833045, -103.59129146387063, -213.20526692665055, -160.79590120193177, -7.348373486448035, -173.05228982669757, -109.54348822657514, -228.9115608962838, -171.06620959178292, -72.20065025748613, -213.7893629949957, -8.655595277361613, -116.37366793883955, -8.264910770354156, -16.569705807734188, -44.48257546146247, -166.65642821939295, -10.374245184256633, -190.63563170216517, -7.627799902882439, -180.59270166679957, -112.35483574291784, 1.5807060326080102, -160.8830478303847, -203.08087341403424, -190.53711448069805, -77.74432608285433, -251.97656984759092, -0.27767629993659493, -193.01317134016517, -102.19065018815984, -47.02886130054448, -53.2561768167004, -112.01570449503234, -65.89759435080396, -90.61798837527448, -20.140068810772785, -44.28890230060928, -181.3522643878833, -101.87837843565015, -109.7559836529715, -58.970434516853935], "episode_lengths": [90, 55, 45, 48, 85, 44, 48, 53, 38, 81, 78, 67, 53, 36, 80, 77, 66, 59, 105, 89, 42, 54, 33, 82, 43, 35, 108, 64, 69, 55, 76, 36, 70, 41, 101, 79, 94, 75, 83, 50, 87, 90, 64, 108, 40, 36, 78, 58, 91, 52, 92, 45, 50, 64, 31, 58, 89, 67, 96, 74, 103, 96, 46, 93, 86, 108, 101, 62, 102, 42, 89, 50, 51, 55, 85, 54, 96, 45, 89, 83, 48, 89, 103, 93, 70, 110, 39, 103, 73, 55, 63, 74, 59, 67, 49, 62, 93, 71, 73, 66], "policy_policy_0_reward": [-172.52074316223602, -25.99877497542215, -9.401372709843672, -6.776629297887345, -158.72908011426728, -11.692753721666552, -18.430374783955415, -16.706609203126344, -14.09748275209558, -137.89615659115762, -82.38995294277305, -84.94440723723764, -66.97540590515565, 10.39281117734686, -118.09543150670335, -97.86711640646584, -83.71858469160344, -42.14295505309081, -205.31332859065768, -118.63364026314827, -7.790817091185472, -47.846647707568984, 13.56103874115523, -92.81134238647189, -5.378980054773341, 4.953951155539315, -365.4759240672547, -74.27582271265477, -92.40013784853254, -24.210971594853447, -80.59560945960851, 6.43597834989974, -114.48837730759732, 9.573853227189145, -212.22732194021748, -125.84192549257966, -140.64925455050297, -114.83405386528344, -103.10572958825891, -16.29617496151361, -167.67231757352263, -182.3555001439868, -70.42533636452842, -235.01232179314658, 7.293405927903085, 12.568451528703694, -131.22919537786018, -26.78977268619177, -154.46782691494812, -11.55513016617413, -137.77588442436755, -15.918673641196369, -6.565744005534304, -72.91864034967038, 8.742554162866483, -60.91235314090944, -159.12241880906646, -88.99244068534722, -208.65123974833045, -103.59129146387063, -213.20526692665055, -160.79590120193177, -7.348373486448035, -173.05228982669757, -109.54348822657514, -228.9115608962838, -171.06620959178292, -72.20065025748613, -213.7893629949957, -8.655595277361613, -116.37366793883955, -8.264910770354156, -16.569705807734188, -44.48257546146247, -166.65642821939295, -10.374245184256633, -190.63563170216517, -7.627799902882439, -180.59270166679957, -112.35483574291784, 1.5807060326080102, -160.8830478303847, -203.08087341403424, -190.53711448069805, -77.74432608285433, -251.97656984759092, -0.27767629993659493, -193.01317134016517, -102.19065018815984, -47.02886130054448, -53.2561768167004, -112.01570449503234, -65.89759435080396, -90.61798837527448, -20.140068810772785, -44.28890230060928, -181.3522643878833, -101.87837843565015, -109.7559836529715, -58.970434516853935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930885098235079, "mean_inference_ms": 0.9115818237797658, "mean_action_processing_ms": 0.16318191775662055, "mean_env_wait_ms": 2.103784142693753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005983114242553711, "StateBufferConnector_ms": 0.0040891170501708984, "ViewRequirementAgentConnector_ms": 0.10262608528137207}, "num_episodes": 56, "episode_return_max": 13.56103874115523, "episode_return_min": -365.4759240672547, "episode_return_mean": -91.2682021553273, "episodes_this_iter": 56}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.76192497026943, "num_env_steps_trained_throughput_per_sec": 281.76192497026943, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 14072.003, "restore_workers_time_ms": 0.031, "training_step_time_ms": 14071.918, "sample_time_ms": 2911.758, "learn_time_ms": 11143.558, "learn_throughput": 358.952, "synch_weights_time_ms": 15.442}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "64a97_00000", "date": "2024-07-26_23-14-48", "timestamp": 1722015888, "time_this_iter_s": 14.202974081039429, "time_total_s": 569.3580374717712, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bb490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.3580374717712, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.774999999999999, "ram_util_percent": 28.720000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.55778533915678, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.36603653291822413, "policy_loss": -0.010039348055336935, "vf_loss": 0.3713988453305016, "vf_explained_var": 0.9992894393081466, "kl": 0.012162984135617711, "entropy": 0.3532978311491509, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 18.571810731318887, "episode_reward_min": -251.97656984759092, "episode_reward_mean": -90.61119145258985, "episode_len_mean": 69.63, "episode_media": {}, "episodes_timesteps_total": 6963, "policy_reward_min": {"policy_0": -251.97656984759092}, "policy_reward_max": {"policy_0": 18.571810731318887}, "policy_reward_mean": {"policy_0": -90.61119145258985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.79590120193177, -7.348373486448035, -173.05228982669757, -109.54348822657514, -228.9115608962838, -171.06620959178292, -72.20065025748613, -213.7893629949957, -8.655595277361613, -116.37366793883955, -8.264910770354156, -16.569705807734188, -44.48257546146247, -166.65642821939295, -10.374245184256633, -190.63563170216517, -7.627799902882439, -180.59270166679957, -112.35483574291784, 1.5807060326080102, -160.8830478303847, -203.08087341403424, -190.53711448069805, -77.74432608285433, -251.97656984759092, -0.27767629993659493, -193.01317134016517, -102.19065018815984, -47.02886130054448, -53.2561768167004, -112.01570449503234, -65.89759435080396, -90.61798837527448, -20.140068810772785, -44.28890230060928, -181.3522643878833, -101.87837843565015, -109.7559836529715, -58.970434516853935, -12.557171252340371, -125.9064473222134, -89.86772338324548, -1.2839393317220247, -13.99660601919442, -74.84441999536585, -69.55273726047903, -71.13674751171594, 9.974328471014928, 9.710444276546804, -15.128927702977041, -164.3026898703714, -134.29242902886315, -114.08564510195038, -85.25577174869471, -214.50822424587213, -8.722511354866027, -142.55224041717378, -113.9683281326622, -107.01503942273068, 3.185642724724972, -155.9673894200267, -52.151438990022804, -82.10678504017642, -161.81925874249686, -80.96170919355899, -68.95809264199573, -38.68710599882256, -168.95303236448268, -61.03945871593243, -115.40540555574121, -95.62036708655725, -5.974050059458685, -126.58694304172886, -150.58379241804695, -167.96721875100343, -9.442477956138196, -27.949709433378096, -52.068687753115405, -100.71804896826622, -106.49319640103481, -194.4128231878973, -60.15505069507424, 10.446506393198339, -146.6062820841694, -120.4870688547714, 7.044231157447096, -122.93852449135461, -163.5678901521849, 5.196652970595531, -166.52331265164517, -24.625489332662404, -171.63248931300512, 18.571810731318887, -154.05131948733737, -33.58120058357092, -23.75071400956314, -66.09661394062805, -26.64968779438174, -175.3299182261681, -23.78759449431499], "episode_lengths": [96, 46, 93, 86, 108, 101, 62, 102, 42, 89, 50, 51, 55, 85, 54, 96, 45, 89, 83, 48, 89, 103, 93, 70, 110, 39, 103, 73, 55, 63, 74, 59, 67, 49, 62, 93, 71, 73, 66, 54, 86, 80, 36, 49, 67, 62, 64, 35, 28, 45, 88, 80, 83, 80, 99, 51, 82, 74, 72, 34, 82, 55, 68, 78, 71, 69, 62, 87, 63, 89, 69, 43, 83, 83, 86, 49, 53, 51, 78, 80, 98, 63, 30, 77, 75, 40, 88, 90, 36, 87, 46, 98, 33, 83, 55, 48, 60, 57, 101, 57], "policy_policy_0_reward": [-160.79590120193177, -7.348373486448035, -173.05228982669757, -109.54348822657514, -228.9115608962838, -171.06620959178292, -72.20065025748613, -213.7893629949957, -8.655595277361613, -116.37366793883955, -8.264910770354156, -16.569705807734188, -44.48257546146247, -166.65642821939295, -10.374245184256633, -190.63563170216517, -7.627799902882439, -180.59270166679957, -112.35483574291784, 1.5807060326080102, -160.8830478303847, -203.08087341403424, -190.53711448069805, -77.74432608285433, -251.97656984759092, -0.27767629993659493, -193.01317134016517, -102.19065018815984, -47.02886130054448, -53.2561768167004, -112.01570449503234, -65.89759435080396, -90.61798837527448, -20.140068810772785, -44.28890230060928, -181.3522643878833, -101.87837843565015, -109.7559836529715, -58.970434516853935, -12.557171252340371, -125.9064473222134, -89.86772338324548, -1.2839393317220247, -13.99660601919442, -74.84441999536585, -69.55273726047903, -71.13674751171594, 9.974328471014928, 9.710444276546804, -15.128927702977041, -164.3026898703714, -134.29242902886315, -114.08564510195038, -85.25577174869471, -214.50822424587213, -8.722511354866027, -142.55224041717378, -113.9683281326622, -107.01503942273068, 3.185642724724972, -155.9673894200267, -52.151438990022804, -82.10678504017642, -161.81925874249686, -80.96170919355899, -68.95809264199573, -38.68710599882256, -168.95303236448268, -61.03945871593243, -115.40540555574121, -95.62036708655725, -5.974050059458685, -126.58694304172886, -150.58379241804695, -167.96721875100343, -9.442477956138196, -27.949709433378096, -52.068687753115405, -100.71804896826622, -106.49319640103481, -194.4128231878973, -60.15505069507424, 10.446506393198339, -146.6062820841694, -120.4870688547714, 7.044231157447096, -122.93852449135461, -163.5678901521849, 5.196652970595531, -166.52331265164517, -24.625489332662404, -171.63248931300512, 18.571810731318887, -154.05131948733737, -33.58120058357092, -23.75071400956314, -66.09661394062805, -26.64968779438174, -175.3299182261681, -23.78759449431499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29304033816340547, "mean_inference_ms": 0.9121271938914759, "mean_action_processing_ms": 0.16330273745472904, "mean_env_wait_ms": 2.104780730024548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005920886993408203, "StateBufferConnector_ms": 0.0041294097900390625, "ViewRequirementAgentConnector_ms": 0.10363483428955078}, "num_episodes": 61, "episode_return_max": 18.571810731318887, "episode_return_min": -251.97656984759092, "episode_return_mean": -90.61119145258985, "episodes_this_iter": 61}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.23906699256827, "num_env_steps_trained_throughput_per_sec": 272.23906699256827, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14185.269, "restore_workers_time_ms": 0.031, "training_step_time_ms": 14185.183, "sample_time_ms": 2901.206, "learn_time_ms": 11267.041, "learn_throughput": 355.018, "synch_weights_time_ms": 15.721}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "64a97_00000", "date": "2024-07-26_23-15-03", "timestamp": 1722015903, "time_this_iter_s": 14.698824644088745, "time_total_s": 584.05686211586, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb707520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 584.05686211586, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.30952380952381, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.3173100138704, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.26559143741615115, "policy_loss": -0.013286519882482632, "vf_loss": 0.2712442699043701, "vf_explained_var": 0.9994893661389749, "kl": 0.014644455299518714, "entropy": 0.22513188809001197, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 18.571810731318887, "episode_reward_min": -222.80735661660196, "episode_reward_mean": -66.89069528470847, "episode_len_mean": 63.26, "episode_media": {}, "episodes_timesteps_total": 6326, "policy_reward_min": {"policy_0": -222.80735661660196}, "policy_reward_max": {"policy_0": 18.571810731318887}, "policy_reward_mean": {"policy_0": -66.89069528470847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-161.81925874249686, -80.96170919355899, -68.95809264199573, -38.68710599882256, -168.95303236448268, -61.03945871593243, -115.40540555574121, -95.62036708655725, -5.974050059458685, -126.58694304172886, -150.58379241804695, -167.96721875100343, -9.442477956138196, -27.949709433378096, -52.068687753115405, -100.71804896826622, -106.49319640103481, -194.4128231878973, -60.15505069507424, 10.446506393198339, -146.6062820841694, -120.4870688547714, 7.044231157447096, -122.93852449135461, -163.5678901521849, 5.196652970595531, -166.52331265164517, -24.625489332662404, -171.63248931300512, 18.571810731318887, -154.05131948733737, -33.58120058357092, -23.75071400956314, -66.09661394062805, -26.64968779438174, -175.3299182261681, -23.78759449431499, -111.08090622371114, -32.608823795116265, 10.29277494214069, -84.65212618688948, -11.136808540785262, 12.989432897238714, -112.15672564442693, -19.191033463585736, -27.99937154887742, -10.874308885989407, -3.0261899730715, -22.467133677767055, -41.47259157944311, -70.40704062194152, -5.791296921505907, -5.403553801457835, -28.26496913639056, -221.57403203132208, 1.6244569394485395, -52.097746426030405, 18.42163424828675, -117.58633743332386, -97.98911210183759, -37.89902188160247, -154.05114656615314, -41.9847908699541, -32.84774139192684, -60.94835417978744, -133.40746116305561, -8.997119173855896, -23.490600241245467, -5.545872181776772, -20.15622067447524, -7.5552228670480135, 0.2793531073638771, -53.623153673870206, -154.61916627647867, -18.63737109521663, -168.43065513192684, -73.8020990929306, 1.0209257219760521, -72.54656594029298, -122.09213516521396, -63.16538684781715, -222.80735661660196, -99.9427883870952, -30.791611795110793, -64.76029083980157, -16.71034901832771, -30.247366278961994, -119.54224517475257, -35.686437558721806, -98.25056618620238, -24.134541992446213, -140.40991900968007, 9.96397112486468, -19.591970922661343, -1.6544259071044902, -57.25238125844926, -25.412344900454123, -35.72510138103686, -71.89674013971187, -147.10011454901928], "episode_lengths": [78, 71, 69, 62, 87, 63, 89, 69, 43, 83, 83, 86, 49, 53, 51, 78, 80, 98, 63, 30, 77, 75, 40, 88, 90, 36, 87, 46, 98, 33, 83, 55, 48, 60, 57, 101, 57, 73, 52, 37, 82, 43, 35, 80, 49, 48, 42, 46, 53, 54, 63, 48, 49, 56, 101, 39, 56, 31, 75, 82, 52, 97, 58, 58, 59, 76, 45, 50, 38, 48, 48, 42, 60, 88, 50, 87, 73, 37, 64, 84, 60, 106, 84, 55, 60, 45, 48, 89, 59, 84, 57, 81, 39, 46, 49, 66, 58, 60, 60, 96], "policy_policy_0_reward": [-161.81925874249686, -80.96170919355899, -68.95809264199573, -38.68710599882256, -168.95303236448268, -61.03945871593243, -115.40540555574121, -95.62036708655725, -5.974050059458685, -126.58694304172886, -150.58379241804695, -167.96721875100343, -9.442477956138196, -27.949709433378096, -52.068687753115405, -100.71804896826622, -106.49319640103481, -194.4128231878973, -60.15505069507424, 10.446506393198339, -146.6062820841694, -120.4870688547714, 7.044231157447096, -122.93852449135461, -163.5678901521849, 5.196652970595531, -166.52331265164517, -24.625489332662404, -171.63248931300512, 18.571810731318887, -154.05131948733737, -33.58120058357092, -23.75071400956314, -66.09661394062805, -26.64968779438174, -175.3299182261681, -23.78759449431499, -111.08090622371114, -32.608823795116265, 10.29277494214069, -84.65212618688948, -11.136808540785262, 12.989432897238714, -112.15672564442693, -19.191033463585736, -27.99937154887742, -10.874308885989407, -3.0261899730715, -22.467133677767055, -41.47259157944311, -70.40704062194152, -5.791296921505907, -5.403553801457835, -28.26496913639056, -221.57403203132208, 1.6244569394485395, -52.097746426030405, 18.42163424828675, -117.58633743332386, -97.98911210183759, -37.89902188160247, -154.05114656615314, -41.9847908699541, -32.84774139192684, -60.94835417978744, -133.40746116305561, -8.997119173855896, -23.490600241245467, -5.545872181776772, -20.15622067447524, -7.5552228670480135, 0.2793531073638771, -53.623153673870206, -154.61916627647867, -18.63737109521663, -168.43065513192684, -73.8020990929306, 1.0209257219760521, -72.54656594029298, -122.09213516521396, -63.16538684781715, -222.80735661660196, -99.9427883870952, -30.791611795110793, -64.76029083980157, -16.71034901832771, -30.247366278961994, -119.54224517475257, -35.686437558721806, -98.25056618620238, -24.134541992446213, -140.40991900968007, 9.96397112486468, -19.591970922661343, -1.6544259071044902, -57.25238125844926, -25.412344900454123, -35.72510138103686, -71.89674013971187, -147.10011454901928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929285560910251, "mean_inference_ms": 0.9116675977196977, "mean_action_processing_ms": 0.16334194196874896, "mean_env_wait_ms": 2.106625243015125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005628347396850586, "StateBufferConnector_ms": 0.00412440299987793, "ViewRequirementAgentConnector_ms": 0.10306334495544434}, "num_episodes": 63, "episode_return_max": 18.571810731318887, "episode_return_min": -222.80735661660196, "episode_return_mean": -66.89069528470847, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.9050034646789, "num_env_steps_trained_throughput_per_sec": 275.9050034646789, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 14178.944, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14178.86, "sample_time_ms": 2902.017, "learn_time_ms": 11259.61, "learn_throughput": 355.252, "synch_weights_time_ms": 15.954}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "64a97_00000", "date": "2024-07-26_23-15-18", "timestamp": 1722015918, "time_this_iter_s": 14.50472903251648, "time_total_s": 598.5615911483765, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb706710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.5615911483765, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 11.066666666666666, "ram_util_percent": 28.70952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.54055277307828, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.24629853937755494, "policy_loss": -0.009351347527990583, "vf_loss": 0.24692687748465686, "vf_explained_var": 0.9995370587334037, "kl": 0.015557334990262461, "entropy": 0.177819167492756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 17.359299122049325, "episode_reward_min": -222.80735661660196, "episode_reward_mean": -68.7998445735284, "episode_len_mean": 64.51, "episode_media": {}, "episodes_timesteps_total": 6451, "policy_reward_min": {"policy_0": -222.80735661660196}, "policy_reward_max": {"policy_0": 17.359299122049325}, "policy_reward_mean": {"policy_0": -68.7998445735284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.9847908699541, -32.84774139192684, -60.94835417978744, -133.40746116305561, -8.997119173855896, -23.490600241245467, -5.545872181776772, -20.15622067447524, -7.5552228670480135, 0.2793531073638771, -53.623153673870206, -154.61916627647867, -18.63737109521663, -168.43065513192684, -73.8020990929306, 1.0209257219760521, -72.54656594029298, -122.09213516521396, -63.16538684781715, -222.80735661660196, -99.9427883870952, -30.791611795110793, -64.76029083980157, -16.71034901832771, -30.247366278961994, -119.54224517475257, -35.686437558721806, -98.25056618620238, -24.134541992446213, -140.40991900968007, 9.96397112486468, -19.591970922661343, -1.6544259071044902, -57.25238125844926, -25.412344900454123, -35.72510138103686, -71.89674013971187, -147.10011454901928, -192.0424877429719, -6.655454340059177, -87.24825220988656, -12.602222093115964, -30.396603853909184, -90.33114424090711, -131.32030666654327, -21.381888749351596, -54.01051732855103, -213.11687364364394, -26.133226537186093, -113.40375808112061, -100.2035850994426, -19.88349270429576, -35.98773301253914, 17.359299122049325, -34.00335326820713, -70.06070645157175, -1.8290387907558712, -200.47316293389085, -98.6063185503884, -14.930867193220928, 0.23894229309518433, -58.61801472770556, -51.86261835128165, -56.06739231717854, -65.19466936886803, -17.87881938105729, -103.81336850630554, -114.74011719686008, -63.80825238102151, -50.69064389437556, -84.94235778852577, -39.51329118190244, 7.631559186908473, -110.32313893471316, -126.49475038047919, -128.68898698358393, -159.75701163249934, -22.654554906346448, -85.73244463538354, -13.685547146380953, -11.57054509421917, -69.28846084571305, -71.77602041175392, -88.4858227668562, -77.65819430313749, -8.160762533733898, -185.65781883234885, -122.0004487866291, -36.276856863285204, -62.21825359779121, -108.02821778188856, -144.64418207580238, -72.21623278300184, -59.30857016388861, -143.6741382472478, -159.55640177653174, -22.499185131123237, -111.98802332027863, -100.80693840442551, -47.80999310040177], "episode_lengths": [58, 58, 59, 76, 45, 50, 38, 48, 48, 42, 60, 88, 50, 87, 73, 37, 64, 84, 60, 106, 84, 55, 60, 45, 48, 89, 59, 84, 57, 81, 39, 46, 49, 66, 58, 60, 60, 96, 101, 50, 70, 44, 59, 74, 79, 48, 56, 98, 47, 74, 71, 50, 61, 28, 61, 61, 40, 94, 84, 50, 34, 63, 55, 58, 67, 57, 73, 89, 67, 63, 68, 51, 44, 73, 92, 90, 87, 51, 67, 55, 49, 61, 68, 68, 68, 46, 103, 79, 60, 66, 69, 81, 64, 64, 83, 87, 45, 74, 86, 59], "policy_policy_0_reward": [-41.9847908699541, -32.84774139192684, -60.94835417978744, -133.40746116305561, -8.997119173855896, -23.490600241245467, -5.545872181776772, -20.15622067447524, -7.5552228670480135, 0.2793531073638771, -53.623153673870206, -154.61916627647867, -18.63737109521663, -168.43065513192684, -73.8020990929306, 1.0209257219760521, -72.54656594029298, -122.09213516521396, -63.16538684781715, -222.80735661660196, -99.9427883870952, -30.791611795110793, -64.76029083980157, -16.71034901832771, -30.247366278961994, -119.54224517475257, -35.686437558721806, -98.25056618620238, -24.134541992446213, -140.40991900968007, 9.96397112486468, -19.591970922661343, -1.6544259071044902, -57.25238125844926, -25.412344900454123, -35.72510138103686, -71.89674013971187, -147.10011454901928, -192.0424877429719, -6.655454340059177, -87.24825220988656, -12.602222093115964, -30.396603853909184, -90.33114424090711, -131.32030666654327, -21.381888749351596, -54.01051732855103, -213.11687364364394, -26.133226537186093, -113.40375808112061, -100.2035850994426, -19.88349270429576, -35.98773301253914, 17.359299122049325, -34.00335326820713, -70.06070645157175, -1.8290387907558712, -200.47316293389085, -98.6063185503884, -14.930867193220928, 0.23894229309518433, -58.61801472770556, -51.86261835128165, -56.06739231717854, -65.19466936886803, -17.87881938105729, -103.81336850630554, -114.74011719686008, -63.80825238102151, -50.69064389437556, -84.94235778852577, -39.51329118190244, 7.631559186908473, -110.32313893471316, -126.49475038047919, -128.68898698358393, -159.75701163249934, -22.654554906346448, -85.73244463538354, -13.685547146380953, -11.57054509421917, -69.28846084571305, -71.77602041175392, -88.4858227668562, -77.65819430313749, -8.160762533733898, -185.65781883234885, -122.0004487866291, -36.276856863285204, -62.21825359779121, -108.02821778188856, -144.64418207580238, -72.21623278300184, -59.30857016388861, -143.6741382472478, -159.55640177653174, -22.499185131123237, -111.98802332027863, -100.80693840442551, -47.80999310040177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29299683331643694, "mean_inference_ms": 0.9108766010297064, "mean_action_processing_ms": 0.16314086525304788, "mean_env_wait_ms": 2.1079169822074855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005803585052490234, "StateBufferConnector_ms": 0.004194498062133789, "ViewRequirementAgentConnector_ms": 0.10480213165283203}, "num_episodes": 62, "episode_return_max": 17.359299122049325, "episode_return_min": -222.80735661660196, "episode_return_mean": -68.7998445735284, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.17965604322836, "num_env_steps_trained_throughput_per_sec": 267.17965604322836, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 14452.374, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14452.293, "sample_time_ms": 2908.635, "learn_time_ms": 11525.935, "learn_throughput": 347.043, "synch_weights_time_ms": 16.376}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "64a97_00000", "date": "2024-07-26_23-15-33", "timestamp": 1722015933, "time_this_iter_s": 14.978285551071167, "time_total_s": 613.5398766994476, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b8c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.5398766994476, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.676190476190477, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.94812128345171, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.29872027353121666, "policy_loss": -0.009752561427497615, "vf_loss": 0.3009221661525468, "vf_explained_var": 0.99938954350849, "kl": 0.014098285133180373, "entropy": 0.19656749718512098, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": 14.657692687123815, "episode_reward_min": -243.72571531856505, "episode_reward_mean": -80.6149347821907, "episode_len_mean": 67.43, "episode_media": {}, "episodes_timesteps_total": 6743, "policy_reward_min": {"policy_0": -243.72571531856505}, "policy_reward_max": {"policy_0": 14.657692687123815}, "policy_reward_mean": {"policy_0": -80.6149347821907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.61801472770556, -51.86261835128165, -56.06739231717854, -65.19466936886803, -17.87881938105729, -103.81336850630554, -114.74011719686008, -63.80825238102151, -50.69064389437556, -84.94235778852577, -39.51329118190244, 7.631559186908473, -110.32313893471316, -126.49475038047919, -128.68898698358393, -159.75701163249934, -22.654554906346448, -85.73244463538354, -13.685547146380953, -11.57054509421917, -69.28846084571305, -71.77602041175392, -88.4858227668562, -77.65819430313749, -8.160762533733898, -185.65781883234885, -122.0004487866291, -36.276856863285204, -62.21825359779121, -108.02821778188856, -144.64418207580238, -72.21623278300184, -59.30857016388861, -143.6741382472478, -159.55640177653174, -22.499185131123237, -111.98802332027863, -100.80693840442551, -47.80999310040177, -219.42880642839634, -110.25149957186886, -192.94434061683654, -6.36692654106999, -100.97556896532603, -118.91075345939667, -155.2987884682971, -140.60213799655378, -82.73970457610463, -74.84053124473218, -235.5246895729939, -40.71903211567574, -169.2436316321868, -31.396439986995958, -30.684765908316948, -110.70922691767902, 10.364623743635873, 1.3935888639575162, -5.381241297952027, -205.0777026108827, -63.82910098120517, -243.72571531856505, -64.90822936508941, -43.96042210762648, -143.3231857274598, -85.49503575858348, -7.207582464142831, 14.657692687123815, -207.22230115158285, 4.120214141306932, -105.29842177691172, -8.339135254429099, -4.630400466552301, -29.829550924233942, -84.80905649752049, -67.6476645404668, -157.02016531902115, -52.123372873478395, -141.91801601311596, -54.71068381832691, 8.681267660048585, -102.59457254137885, -83.23236220867022, -5.836293875950208, -32.37000946015173, -109.68803449390884, -148.72113851948305, -54.524001536788994, -25.11622593642319, -94.37345593447618, -71.18080731561346, -81.64872273790026, -140.3581694556612, -120.89878620185591, -24.174691237643415, -96.04659135668877, -118.9354142838742, -14.444594027637597, 14.189299575353118, -135.44049382436125, -7.762484324832838], "episode_lengths": [63, 55, 58, 67, 57, 73, 89, 67, 63, 68, 51, 44, 73, 92, 90, 87, 51, 67, 55, 49, 61, 68, 68, 68, 46, 103, 79, 60, 66, 69, 81, 64, 64, 83, 87, 45, 74, 86, 59, 107, 73, 102, 43, 73, 76, 84, 82, 78, 68, 107, 59, 83, 52, 59, 80, 35, 40, 45, 94, 60, 110, 60, 54, 87, 66, 51, 34, 96, 37, 86, 45, 38, 51, 81, 67, 79, 59, 94, 58, 39, 72, 66, 43, 50, 84, 82, 56, 49, 70, 69, 66, 76, 90, 51, 70, 77, 48, 37, 93, 52], "policy_policy_0_reward": [-58.61801472770556, -51.86261835128165, -56.06739231717854, -65.19466936886803, -17.87881938105729, -103.81336850630554, -114.74011719686008, -63.80825238102151, -50.69064389437556, -84.94235778852577, -39.51329118190244, 7.631559186908473, -110.32313893471316, -126.49475038047919, -128.68898698358393, -159.75701163249934, -22.654554906346448, -85.73244463538354, -13.685547146380953, -11.57054509421917, -69.28846084571305, -71.77602041175392, -88.4858227668562, -77.65819430313749, -8.160762533733898, -185.65781883234885, -122.0004487866291, -36.276856863285204, -62.21825359779121, -108.02821778188856, -144.64418207580238, -72.21623278300184, -59.30857016388861, -143.6741382472478, -159.55640177653174, -22.499185131123237, -111.98802332027863, -100.80693840442551, -47.80999310040177, -219.42880642839634, -110.25149957186886, -192.94434061683654, -6.36692654106999, -100.97556896532603, -118.91075345939667, -155.2987884682971, -140.60213799655378, -82.73970457610463, -74.84053124473218, -235.5246895729939, -40.71903211567574, -169.2436316321868, -31.396439986995958, -30.684765908316948, -110.70922691767902, 10.364623743635873, 1.3935888639575162, -5.381241297952027, -205.0777026108827, -63.82910098120517, -243.72571531856505, -64.90822936508941, -43.96042210762648, -143.3231857274598, -85.49503575858348, -7.207582464142831, 14.657692687123815, -207.22230115158285, 4.120214141306932, -105.29842177691172, -8.339135254429099, -4.630400466552301, -29.829550924233942, -84.80905649752049, -67.6476645404668, -157.02016531902115, -52.123372873478395, -141.91801601311596, -54.71068381832691, 8.681267660048585, -102.59457254137885, -83.23236220867022, -5.836293875950208, -32.37000946015173, -109.68803449390884, -148.72113851948305, -54.524001536788994, -25.11622593642319, -94.37345593447618, -71.18080731561346, -81.64872273790026, -140.3581694556612, -120.89878620185591, -24.174691237643415, -96.04659135668877, -118.9354142838742, -14.444594027637597, 14.189299575353118, -135.44049382436125, -7.762484324832838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930629481685579, "mean_inference_ms": 0.9102379494364599, "mean_action_processing_ms": 0.16300977926200566, "mean_env_wait_ms": 2.109238878285732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005957841873168945, "StateBufferConnector_ms": 0.0041201114654541016, "ViewRequirementAgentConnector_ms": 0.10261106491088867}, "num_episodes": 61, "episode_return_max": 14.657692687123815, "episode_return_min": -243.72571531856505, "episode_return_mean": -80.6149347821907, "episodes_this_iter": 61}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.19601442276456, "num_env_steps_trained_throughput_per_sec": 269.19601442276456, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 14517.262, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14517.18, "sample_time_ms": 2915.386, "learn_time_ms": 11583.861, "learn_throughput": 345.308, "synch_weights_time_ms": 16.624}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "64a97_00000", "date": "2024-07-26_23-15-48", "timestamp": 1722015948, "time_this_iter_s": 14.866588592529297, "time_total_s": 628.4064652919769, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f060873bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.4064652919769, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.304545454545453, "ram_util_percent": 28.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.55798731992643, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.4280509613842393, "policy_loss": -0.021432710601463137, "vf_loss": 0.4456745422910899, "vf_explained_var": 0.9990062198291222, "kl": 0.00991873734844075, "entropy": 0.28860175649945935, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 17.22072887354285, "episode_reward_min": -375.608754093718, "episode_reward_mean": -82.32054828738512, "episode_len_mean": 66.78, "episode_media": {}, "episodes_timesteps_total": 6678, "policy_reward_min": {"policy_0": -375.608754093718}, "policy_reward_max": {"policy_0": 17.22072887354285}, "policy_reward_mean": {"policy_0": -82.32054828738512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-243.72571531856505, -64.90822936508941, -43.96042210762648, -143.3231857274598, -85.49503575858348, -7.207582464142831, 14.657692687123815, -207.22230115158285, 4.120214141306932, -105.29842177691172, -8.339135254429099, -4.630400466552301, -29.829550924233942, -84.80905649752049, -67.6476645404668, -157.02016531902115, -52.123372873478395, -141.91801601311596, -54.71068381832691, 8.681267660048585, -102.59457254137885, -83.23236220867022, -5.836293875950208, -32.37000946015173, -109.68803449390884, -148.72113851948305, -54.524001536788994, -25.11622593642319, -94.37345593447618, -71.18080731561346, -81.64872273790026, -140.3581694556612, -120.89878620185591, -24.174691237643415, -96.04659135668877, -118.9354142838742, -14.444594027637597, 14.189299575353118, -135.44049382436125, -7.762484324832838, -23.289951835547363, -72.87826785010031, -21.536504320502036, -50.886680519913895, -156.48083019516014, -143.45735732302393, 2.3941254922354522, -132.57669294251755, -84.98315187998827, 8.287463781762202, -59.47717084391781, -375.608754093718, -28.96144737644653, -140.78915597499224, -88.02070792292996, -122.29599376259479, -17.4218652600964, -49.2463264482232, 1.054599681284482, 12.12338464177311, -36.496834090661075, -1.9175661986460146, -55.40480781444717, -11.728820796836768, 17.22072887354285, -224.90910507009946, -128.72372791923945, -149.1712666759723, -123.04809404233104, -108.70694716965988, -55.3009468970446, -224.55161639256073, -32.69002158338261, -208.6038513409743, -205.06315695084794, -52.358523362485656, 7.293486400552417, -103.45539634261335, -8.752526200509772, -72.03622373243826, -212.2199178433431, -128.17842584066884, -2.483450997907892, -1.5998534828751059, -105.01676448604452, -28.999703564769206, -72.26806714131637, -159.04692733873947, -200.11229486693867, -38.38928512326804, -166.61414773055654, -75.07217080935264, -16.08403759160918, -223.9495533887458, 6.206293979722559, -30.392436824603447, -29.31513214749396, -259.0690564166494, -144.8036887361317, -94.32239154137226], "episode_lengths": [110, 60, 54, 87, 66, 51, 34, 96, 37, 86, 45, 38, 51, 81, 67, 79, 59, 94, 58, 39, 72, 66, 43, 50, 84, 82, 56, 49, 70, 69, 66, 76, 90, 51, 70, 77, 48, 37, 93, 52, 44, 78, 46, 59, 83, 93, 40, 76, 69, 42, 58, 112, 58, 92, 83, 78, 49, 54, 42, 34, 53, 40, 58, 47, 27, 102, 91, 88, 76, 76, 60, 105, 50, 97, 106, 56, 37, 87, 42, 73, 96, 91, 39, 47, 73, 50, 65, 90, 96, 59, 96, 63, 56, 91, 43, 60, 48, 96, 82, 83], "policy_policy_0_reward": [-243.72571531856505, -64.90822936508941, -43.96042210762648, -143.3231857274598, -85.49503575858348, -7.207582464142831, 14.657692687123815, -207.22230115158285, 4.120214141306932, -105.29842177691172, -8.339135254429099, -4.630400466552301, -29.829550924233942, -84.80905649752049, -67.6476645404668, -157.02016531902115, -52.123372873478395, -141.91801601311596, -54.71068381832691, 8.681267660048585, -102.59457254137885, -83.23236220867022, -5.836293875950208, -32.37000946015173, -109.68803449390884, -148.72113851948305, -54.524001536788994, -25.11622593642319, -94.37345593447618, -71.18080731561346, -81.64872273790026, -140.3581694556612, -120.89878620185591, -24.174691237643415, -96.04659135668877, -118.9354142838742, -14.444594027637597, 14.189299575353118, -135.44049382436125, -7.762484324832838, -23.289951835547363, -72.87826785010031, -21.536504320502036, -50.886680519913895, -156.48083019516014, -143.45735732302393, 2.3941254922354522, -132.57669294251755, -84.98315187998827, 8.287463781762202, -59.47717084391781, -375.608754093718, -28.96144737644653, -140.78915597499224, -88.02070792292996, -122.29599376259479, -17.4218652600964, -49.2463264482232, 1.054599681284482, 12.12338464177311, -36.496834090661075, -1.9175661986460146, -55.40480781444717, -11.728820796836768, 17.22072887354285, -224.90910507009946, -128.72372791923945, -149.1712666759723, -123.04809404233104, -108.70694716965988, -55.3009468970446, -224.55161639256073, -32.69002158338261, -208.6038513409743, -205.06315695084794, -52.358523362485656, 7.293486400552417, -103.45539634261335, -8.752526200509772, -72.03622373243826, -212.2199178433431, -128.17842584066884, -2.483450997907892, -1.5998534828751059, -105.01676448604452, -28.999703564769206, -72.26806714131637, -159.04692733873947, -200.11229486693867, -38.38928512326804, -166.61414773055654, -75.07217080935264, -16.08403759160918, -223.9495533887458, 6.206293979722559, -30.392436824603447, -29.31513214749396, -259.0690564166494, -144.8036887361317, -94.32239154137226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930967770775301, "mean_inference_ms": 0.9100380601679621, "mean_action_processing_ms": 0.16301999108437226, "mean_env_wait_ms": 2.1102032772333223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005562782287597656, "StateBufferConnector_ms": 0.003953456878662109, "ViewRequirementAgentConnector_ms": 0.09863066673278809}, "num_episodes": 60, "episode_return_max": 17.22072887354285, "episode_return_min": -375.608754093718, "episode_return_mean": -82.32054828738512, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.23641528220134, "num_env_steps_trained_throughput_per_sec": 360.23641528220134, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14172.363, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14172.283, "sample_time_ms": 2899.97, "learn_time_ms": 11254.332, "learn_throughput": 355.419, "synch_weights_time_ms": 16.666}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "64a97_00000", "date": "2024-07-26_23-15-59", "timestamp": 1722015959, "time_this_iter_s": 11.111246109008789, "time_total_s": 639.5177114009857, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bbeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 639.5177114009857, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 11.486666666666666, "ram_util_percent": 28.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.643238781392576, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.39995472842031937, "policy_loss": -0.017613343180467686, "vf_loss": 0.41120100738092635, "vf_explained_var": 0.9985126862302423, "kl": 0.012795234645697444, "entropy": 0.22697170638712122, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": 17.22072887354285, "episode_reward_min": -259.0690564166494, "episode_reward_mean": -83.44444820909726, "episode_len_mean": 66.75, "episode_media": {}, "episodes_timesteps_total": 6675, "policy_reward_min": {"policy_0": -259.0690564166494}, "policy_reward_max": {"policy_0": 17.22072887354285}, "policy_reward_mean": {"policy_0": -83.44444820909726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.40480781444717, -11.728820796836768, 17.22072887354285, -224.90910507009946, -128.72372791923945, -149.1712666759723, -123.04809404233104, -108.70694716965988, -55.3009468970446, -224.55161639256073, -32.69002158338261, -208.6038513409743, -205.06315695084794, -52.358523362485656, 7.293486400552417, -103.45539634261335, -8.752526200509772, -72.03622373243826, -212.2199178433431, -128.17842584066884, -2.483450997907892, -1.5998534828751059, -105.01676448604452, -28.999703564769206, -72.26806714131637, -159.04692733873947, -200.11229486693867, -38.38928512326804, -166.61414773055654, -75.07217080935264, -16.08403759160918, -223.9495533887458, 6.206293979722559, -30.392436824603447, -29.31513214749396, -259.0690564166494, -144.8036887361317, -94.32239154137226, -36.232522782394064, -125.99594121692229, 9.291350290863297, -75.20629227369636, -40.67706828386886, -110.164762073221, -54.21468336469193, -118.15980301705345, -193.5520917352152, -139.56577812859828, 1.3136690731972283, 16.308771958965874, -16.894823558882432, -215.77590608679128, 2.9122223387836588, -89.50059461458206, -33.36059890692044, -127.75345767741986, -13.529631111840134, -47.028446721047985, -13.14004368879742, -118.64495342818306, -199.02330304928373, 10.868175231768983, -56.07915146230213, -100.46222011655904, -211.38361789636932, -48.080686868078146, -11.155768694983758, -60.13041208284471, -41.631554172214216, -95.23136623728256, 5.313617905258977, 8.267668638436733, -101.49521194751455, -4.547433524917139, -72.99560775170987, -145.5961486335793, -129.99837619150102, -86.21407732720202, -113.89349444278375, -117.68548612361539, -19.50718712520299, -23.839279810678004, -161.490874608654, -3.6299487252344376, -2.2938328475921863, -89.94022064496623, -90.10036875487374, -13.247445899489318, -43.31532531036057, -98.5372947853989, -98.39644986822921, 15.57477285483774, -125.66830188627362, -233.03465343585216, -85.32068131663803, -59.31963855135518, -78.013916184406, -40.21679918705496, -168.8202582842766, -92.87944787242233], "episode_lengths": [58, 47, 27, 102, 91, 88, 76, 76, 60, 105, 50, 97, 106, 56, 37, 87, 42, 73, 96, 91, 39, 47, 73, 50, 65, 90, 96, 59, 96, 63, 56, 91, 43, 60, 48, 96, 82, 83, 51, 77, 31, 61, 60, 80, 61, 75, 98, 83, 42, 33, 44, 103, 41, 75, 49, 80, 54, 53, 43, 75, 105, 42, 52, 71, 106, 56, 47, 61, 55, 72, 32, 34, 72, 50, 65, 81, 76, 72, 86, 74, 52, 48, 95, 47, 45, 74, 72, 48, 54, 72, 70, 36, 91, 94, 68, 63, 64, 56, 74, 72], "policy_policy_0_reward": [-55.40480781444717, -11.728820796836768, 17.22072887354285, -224.90910507009946, -128.72372791923945, -149.1712666759723, -123.04809404233104, -108.70694716965988, -55.3009468970446, -224.55161639256073, -32.69002158338261, -208.6038513409743, -205.06315695084794, -52.358523362485656, 7.293486400552417, -103.45539634261335, -8.752526200509772, -72.03622373243826, -212.2199178433431, -128.17842584066884, -2.483450997907892, -1.5998534828751059, -105.01676448604452, -28.999703564769206, -72.26806714131637, -159.04692733873947, -200.11229486693867, -38.38928512326804, -166.61414773055654, -75.07217080935264, -16.08403759160918, -223.9495533887458, 6.206293979722559, -30.392436824603447, -29.31513214749396, -259.0690564166494, -144.8036887361317, -94.32239154137226, -36.232522782394064, -125.99594121692229, 9.291350290863297, -75.20629227369636, -40.67706828386886, -110.164762073221, -54.21468336469193, -118.15980301705345, -193.5520917352152, -139.56577812859828, 1.3136690731972283, 16.308771958965874, -16.894823558882432, -215.77590608679128, 2.9122223387836588, -89.50059461458206, -33.36059890692044, -127.75345767741986, -13.529631111840134, -47.028446721047985, -13.14004368879742, -118.64495342818306, -199.02330304928373, 10.868175231768983, -56.07915146230213, -100.46222011655904, -211.38361789636932, -48.080686868078146, -11.155768694983758, -60.13041208284471, -41.631554172214216, -95.23136623728256, 5.313617905258977, 8.267668638436733, -101.49521194751455, -4.547433524917139, -72.99560775170987, -145.5961486335793, -129.99837619150102, -86.21407732720202, -113.89349444278375, -117.68548612361539, -19.50718712520299, -23.839279810678004, -161.490874608654, -3.6299487252344376, -2.2938328475921863, -89.94022064496623, -90.10036875487374, -13.247445899489318, -43.31532531036057, -98.5372947853989, -98.39644986822921, 15.57477285483774, -125.66830188627362, -233.03465343585216, -85.32068131663803, -59.31963855135518, -78.013916184406, -40.21679918705496, -168.8202582842766, -92.87944787242233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930708748563634, "mean_inference_ms": 0.910005693242573, "mean_action_processing_ms": 0.163089163458774, "mean_env_wait_ms": 2.1112342966620963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005398988723754883, "StateBufferConnector_ms": 0.0039539337158203125, "ViewRequirementAgentConnector_ms": 0.09894847869873047}, "num_episodes": 62, "episode_return_max": 17.22072887354285, "episode_return_min": -259.0690564166494, "episode_return_mean": -83.44444820909726, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.66055238064683, "num_env_steps_trained_throughput_per_sec": 290.66055238064683, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 14110.551, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14110.471, "sample_time_ms": 2902.485, "learn_time_ms": 11189.794, "learn_throughput": 357.469, "synch_weights_time_ms": 16.857}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "64a97_00000", "date": "2024-07-26_23-16-13", "timestamp": 1722015973, "time_this_iter_s": 13.769121885299683, "time_total_s": 653.2868332862854, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb706440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 653.2868332862854, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.794999999999998, "ram_util_percent": 28.734999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.00149801373482, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.26531281762048214, "policy_loss": -0.009772087555999558, "vf_loss": 0.26570212775841356, "vf_explained_var": 0.999524534245332, "kl": 0.016293491715805457, "entropy": 0.16153302802461741, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 22.510747904738782, "episode_reward_min": -243.04555276168992, "episode_reward_mean": -70.36134904654612, "episode_len_mean": 63.79, "episode_media": {}, "episodes_timesteps_total": 6379, "policy_reward_min": {"policy_0": -243.04555276168992}, "policy_reward_max": {"policy_0": 22.510747904738782}, "policy_reward_mean": {"policy_0": -70.36134904654612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.868175231768983, -56.07915146230213, -100.46222011655904, -211.38361789636932, -48.080686868078146, -11.155768694983758, -60.13041208284471, -41.631554172214216, -95.23136623728256, 5.313617905258977, 8.267668638436733, -101.49521194751455, -4.547433524917139, -72.99560775170987, -145.5961486335793, -129.99837619150102, -86.21407732720202, -113.89349444278375, -117.68548612361539, -19.50718712520299, -23.839279810678004, -161.490874608654, -3.6299487252344376, -2.2938328475921863, -89.94022064496623, -90.10036875487374, -13.247445899489318, -43.31532531036057, -98.5372947853989, -98.39644986822921, 15.57477285483774, -125.66830188627362, -233.03465343585216, -85.32068131663803, -59.31963855135518, -78.013916184406, -40.21679918705496, -168.8202582842766, -92.87944787242233, -100.18572542777427, -148.0032594971063, -10.577948266087725, -156.75099425753095, -116.59639530943946, -60.731704914700174, -40.745211087784135, -8.567122257928574, -21.27695541567153, -94.8734367905752, -15.258797600260507, -243.04555276168992, -31.689447811758075, 4.864762619469282, -83.21833763204528, -71.6819611501205, 1.1116698872199862, -201.18897190307786, -112.94949576797998, -110.97312069302384, -10.81672121014716, -110.9989391715258, -62.76504251019649, -107.00114860000973, -140.37278322677727, -72.31115125566043, -0.13117630474032416, -14.116110175957012, -141.55839517365607, 17.66681697701168, -36.8582005819517, -48.19124280438802, 3.7174078047622983, -86.24439184651354, -39.62393014990125, -108.5576560013018, 2.6014965073438763, -54.53963404147648, -97.4804231001828, -47.530886012286985, -112.3193755263179, -44.233843296561105, -107.49987439165277, 4.99901407903835, -118.54564821170754, -122.65124689834323, -180.10661396420772, 17.03385869969716, -71.43700462910928, -16.81073751549567, -72.85562288713369, -182.46195166327686, -67.21269906454528, 22.510747904738782, -19.511893833939276, -73.14691813501528, -51.52870624981855, 5.425073901269731, -28.876970735668724, -138.51130080791484, -16.81477057111478], "episode_lengths": [42, 52, 71, 106, 56, 47, 61, 55, 72, 32, 34, 72, 50, 65, 81, 76, 72, 86, 74, 52, 48, 95, 47, 45, 74, 72, 48, 54, 72, 70, 36, 91, 94, 68, 63, 64, 56, 74, 72, 73, 91, 48, 95, 83, 64, 59, 45, 53, 82, 51, 105, 60, 40, 67, 62, 42, 95, 74, 74, 43, 83, 66, 79, 82, 64, 43, 45, 81, 34, 61, 60, 36, 83, 54, 74, 41, 57, 72, 54, 78, 61, 87, 41, 76, 75, 90, 29, 63, 55, 65, 98, 62, 30, 52, 64, 55, 41, 53, 87, 43], "policy_policy_0_reward": [10.868175231768983, -56.07915146230213, -100.46222011655904, -211.38361789636932, -48.080686868078146, -11.155768694983758, -60.13041208284471, -41.631554172214216, -95.23136623728256, 5.313617905258977, 8.267668638436733, -101.49521194751455, -4.547433524917139, -72.99560775170987, -145.5961486335793, -129.99837619150102, -86.21407732720202, -113.89349444278375, -117.68548612361539, -19.50718712520299, -23.839279810678004, -161.490874608654, -3.6299487252344376, -2.2938328475921863, -89.94022064496623, -90.10036875487374, -13.247445899489318, -43.31532531036057, -98.5372947853989, -98.39644986822921, 15.57477285483774, -125.66830188627362, -233.03465343585216, -85.32068131663803, -59.31963855135518, -78.013916184406, -40.21679918705496, -168.8202582842766, -92.87944787242233, -100.18572542777427, -148.0032594971063, -10.577948266087725, -156.75099425753095, -116.59639530943946, -60.731704914700174, -40.745211087784135, -8.567122257928574, -21.27695541567153, -94.8734367905752, -15.258797600260507, -243.04555276168992, -31.689447811758075, 4.864762619469282, -83.21833763204528, -71.6819611501205, 1.1116698872199862, -201.18897190307786, -112.94949576797998, -110.97312069302384, -10.81672121014716, -110.9989391715258, -62.76504251019649, -107.00114860000973, -140.37278322677727, -72.31115125566043, -0.13117630474032416, -14.116110175957012, -141.55839517365607, 17.66681697701168, -36.8582005819517, -48.19124280438802, 3.7174078047622983, -86.24439184651354, -39.62393014990125, -108.5576560013018, 2.6014965073438763, -54.53963404147648, -97.4804231001828, -47.530886012286985, -112.3193755263179, -44.233843296561105, -107.49987439165277, 4.99901407903835, -118.54564821170754, -122.65124689834323, -180.10661396420772, 17.03385869969716, -71.43700462910928, -16.81073751549567, -72.85562288713369, -182.46195166327686, -67.21269906454528, 22.510747904738782, -19.511893833939276, -73.14691813501528, -51.52870624981855, 5.425073901269731, -28.876970735668724, -138.51130080791484, -16.81477057111478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2928759368716557, "mean_inference_ms": 0.9092193061016911, "mean_action_processing_ms": 0.16293268318841023, "mean_env_wait_ms": 2.1121350149197777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00536346435546875, "StateBufferConnector_ms": 0.0039768218994140625, "ViewRequirementAgentConnector_ms": 0.09919977188110352}, "num_episodes": 61, "episode_return_max": 22.510747904738782, "episode_return_min": -243.04555276168992, "episode_return_mean": -70.36134904654612, "episodes_this_iter": 61}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.80137223870594, "num_env_steps_trained_throughput_per_sec": 276.80137223870594, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 14173.925, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14173.844, "sample_time_ms": 2922.375, "learn_time_ms": 11233.562, "learn_throughput": 356.076, "synch_weights_time_ms": 16.609}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "64a97_00000", "date": "2024-07-26_23-16-27", "timestamp": 1722015987, "time_this_iter_s": 14.458948373794556, "time_total_s": 667.74578166008, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb707010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 667.74578166008, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.176190476190477, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.087452389796574, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3002330928953597, "policy_loss": -0.01185364036403674, "vf_loss": 0.3052912707440555, "vf_explained_var": 0.9987481944262981, "kl": 0.012026007999035481, "entropy": 0.13220926692447393, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 22.510747904738782, "episode_reward_min": -271.7272588287459, "episode_reward_mean": -70.20692407469014, "episode_len_mean": 64.67, "episode_media": {}, "episodes_timesteps_total": 6467, "policy_reward_min": {"policy_0": -271.7272588287459}, "policy_reward_max": {"policy_0": 22.510747904738782}, "policy_reward_mean": {"policy_0": -70.20692407469014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.81672121014716, -110.9989391715258, -62.76504251019649, -107.00114860000973, -140.37278322677727, -72.31115125566043, -0.13117630474032416, -14.116110175957012, -141.55839517365607, 17.66681697701168, -36.8582005819517, -48.19124280438802, 3.7174078047622983, -86.24439184651354, -39.62393014990125, -108.5576560013018, 2.6014965073438763, -54.53963404147648, -97.4804231001828, -47.530886012286985, -112.3193755263179, -44.233843296561105, -107.49987439165277, 4.99901407903835, -118.54564821170754, -122.65124689834323, -180.10661396420772, 17.03385869969716, -71.43700462910928, -16.81073751549567, -72.85562288713369, -182.46195166327686, -67.21269906454528, 22.510747904738782, -19.511893833939276, -73.14691813501528, -51.52870624981855, 5.425073901269731, -28.876970735668724, -138.51130080791484, -16.81477057111478, -113.25860141851471, -18.289223979986076, -21.752664487814357, -54.00794429090029, -30.55003269718306, -128.3256809991151, -38.10177565889396, -105.25845152575754, -152.1269677113984, -118.02516026449617, 3.277837082621103, -42.764175340175434, -33.91589550351825, 6.779690050164981, -55.85457756314159, -70.91779741918096, -22.16185427313386, -144.2735354736393, -69.98648455942572, -42.444767957602835, -36.54185118134484, -52.831453025717515, -70.52777508311405, 12.320306338730028, -115.93858860166928, -142.81628462594063, -6.145046399329287, -146.38464917950574, -10.297311000893739, -1.4081863742835563, -189.29112909506682, -135.7045314186017, -208.56026365563886, -77.36696950650285, -125.75162429210846, -117.78070698024925, 4.006092955938988, -108.92975657235061, -9.311375058890233, -49.78049802974294, -0.8085388901679142, -106.40082389875063, 9.608799277451777, -138.5468626443789, -96.22037073535981, -27.879909448773734, -177.3998817487054, -179.53978189692552, -49.39414949371941, -24.108207745752768, 15.574934251361, -15.204526263974063, -271.7272588287459, -209.4398776638858, 10.378029447342717, -49.03323397146442, -86.79178896567426, -150.1160584682922, -102.97464032859243], "episode_lengths": [43, 83, 66, 79, 82, 64, 43, 45, 81, 34, 61, 60, 36, 83, 54, 74, 41, 57, 72, 54, 78, 61, 87, 41, 76, 75, 90, 29, 63, 55, 65, 98, 62, 30, 52, 64, 55, 41, 53, 87, 43, 78, 58, 50, 56, 57, 78, 60, 86, 83, 75, 43, 49, 52, 38, 63, 69, 54, 87, 66, 56, 57, 65, 63, 33, 80, 90, 51, 95, 44, 44, 91, 80, 100, 67, 77, 76, 38, 86, 50, 59, 41, 73, 42, 88, 84, 57, 101, 97, 61, 58, 33, 53, 112, 103, 32, 62, 78, 85, 86], "policy_policy_0_reward": [-10.81672121014716, -110.9989391715258, -62.76504251019649, -107.00114860000973, -140.37278322677727, -72.31115125566043, -0.13117630474032416, -14.116110175957012, -141.55839517365607, 17.66681697701168, -36.8582005819517, -48.19124280438802, 3.7174078047622983, -86.24439184651354, -39.62393014990125, -108.5576560013018, 2.6014965073438763, -54.53963404147648, -97.4804231001828, -47.530886012286985, -112.3193755263179, -44.233843296561105, -107.49987439165277, 4.99901407903835, -118.54564821170754, -122.65124689834323, -180.10661396420772, 17.03385869969716, -71.43700462910928, -16.81073751549567, -72.85562288713369, -182.46195166327686, -67.21269906454528, 22.510747904738782, -19.511893833939276, -73.14691813501528, -51.52870624981855, 5.425073901269731, -28.876970735668724, -138.51130080791484, -16.81477057111478, -113.25860141851471, -18.289223979986076, -21.752664487814357, -54.00794429090029, -30.55003269718306, -128.3256809991151, -38.10177565889396, -105.25845152575754, -152.1269677113984, -118.02516026449617, 3.277837082621103, -42.764175340175434, -33.91589550351825, 6.779690050164981, -55.85457756314159, -70.91779741918096, -22.16185427313386, -144.2735354736393, -69.98648455942572, -42.444767957602835, -36.54185118134484, -52.831453025717515, -70.52777508311405, 12.320306338730028, -115.93858860166928, -142.81628462594063, -6.145046399329287, -146.38464917950574, -10.297311000893739, -1.4081863742835563, -189.29112909506682, -135.7045314186017, -208.56026365563886, -77.36696950650285, -125.75162429210846, -117.78070698024925, 4.006092955938988, -108.92975657235061, -9.311375058890233, -49.78049802974294, -0.8085388901679142, -106.40082389875063, 9.608799277451777, -138.5468626443789, -96.22037073535981, -27.879909448773734, -177.3998817487054, -179.53978189692552, -49.39414949371941, -24.108207745752768, 15.574934251361, -15.204526263974063, -271.7272588287459, -209.4398776638858, 10.378029447342717, -49.03323397146442, -86.79178896567426, -150.1160584682922, -102.97464032859243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929828205403011, "mean_inference_ms": 0.9092199164370243, "mean_action_processing_ms": 0.16301526877573136, "mean_env_wait_ms": 2.1138558441496706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005416393280029297, "StateBufferConnector_ms": 0.0041425228118896484, "ViewRequirementAgentConnector_ms": 0.10248160362243652}, "num_episodes": 59, "episode_return_max": 22.510747904738782, "episode_return_min": -271.7272588287459, "episode_return_mean": -70.20692407469014, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.4557787346105, "num_env_steps_trained_throughput_per_sec": 276.4557787346105, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 14138.164, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14138.082, "sample_time_ms": 2922.43, "learn_time_ms": 11197.381, "learn_throughput": 357.226, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "64a97_00000", "date": "2024-07-26_23-16-42", "timestamp": 1722016002, "time_this_iter_s": 14.476655721664429, "time_total_s": 682.2224373817444, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb735510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 682.2224373817444, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 10.569999999999999, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.23154135545095, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2586858704870489, "policy_loss": -0.015618639711950285, "vf_loss": 0.2656180597376078, "vf_explained_var": 0.9994805896654725, "kl": 0.014778828381167865, "entropy": 0.12892593772655042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 18.660429820812524, "episode_reward_min": -271.7272588287459, "episode_reward_mean": -76.222527498921, "episode_len_mean": 65.86, "episode_media": {}, "episodes_timesteps_total": 6586, "policy_reward_min": {"policy_0": -271.7272588287459}, "policy_reward_max": {"policy_0": 18.660429820812524}, "policy_reward_mean": {"policy_0": -76.222527498921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.320306338730028, -115.93858860166928, -142.81628462594063, -6.145046399329287, -146.38464917950574, -10.297311000893739, -1.4081863742835563, -189.29112909506682, -135.7045314186017, -208.56026365563886, -77.36696950650285, -125.75162429210846, -117.78070698024925, 4.006092955938988, -108.92975657235061, -9.311375058890233, -49.78049802974294, -0.8085388901679142, -106.40082389875063, 9.608799277451777, -138.5468626443789, -96.22037073535981, -27.879909448773734, -177.3998817487054, -179.53978189692552, -49.39414949371941, -24.108207745752768, 15.574934251361, -15.204526263974063, -271.7272588287459, -209.4398776638858, 10.378029447342717, -49.03323397146442, -86.79178896567426, -150.1160584682922, -102.97464032859243, -40.26540552634159, -185.3652037006905, -185.35965816206445, -92.0640122447164, 4.370470718883816, 4.63109067603974, -31.2005869454943, -54.34514693848777, -82.41484711857873, -20.13757535786992, -72.45930047227105, -123.71101677965599, 17.665932895780415, -200.40346793244686, -38.29163124290495, -64.75456748159715, -119.72359185127806, -120.57908558278311, 18.660429820812524, -143.3495052206998, -34.60088427325141, -206.36626450674785, -196.4764599036366, -29.353906701712333, -116.89566539372, 2.58199267486268, -176.33604420686927, -8.011383011199218, -40.45016996353181, -131.76602469901766, -74.61306246532318, 8.55975837548917, -4.522977158253945, -66.50644990508451, -148.03193173553893, -112.13155450330821, -145.99878755631545, -0.3332903410874024, -101.07050479864664, -42.12829171146805, -99.79325527165756, -72.22202455734546, -10.559861960229412, -8.58132585923305, -117.527627943688, -50.2534269959476, -66.48604768601955, -26.697711149180975, -52.17071565930928, -92.84706678497918, 12.38601230602239, -147.8258659927997, -144.88652476838902, -46.42906018237833, -11.722106453696359, -142.5890129959755, -22.365509266630518, -94.0750064559092, -89.60011882533578, 7.280330095204971, -126.62213223622182, -2.058640502467198, 8.007962218503138, 8.099236779400561], "episode_lengths": [33, 80, 90, 51, 95, 44, 44, 91, 80, 100, 67, 77, 76, 38, 86, 50, 59, 41, 73, 42, 88, 84, 57, 101, 97, 61, 58, 33, 53, 112, 103, 32, 62, 78, 85, 86, 60, 90, 99, 67, 35, 45, 57, 61, 81, 43, 79, 75, 35, 104, 50, 67, 77, 76, 27, 88, 54, 98, 92, 57, 89, 40, 87, 47, 57, 82, 64, 44, 43, 64, 91, 75, 76, 36, 73, 61, 71, 67, 54, 46, 90, 60, 64, 46, 57, 69, 28, 77, 81, 60, 52, 94, 52, 72, 68, 32, 78, 51, 32, 32], "policy_policy_0_reward": [12.320306338730028, -115.93858860166928, -142.81628462594063, -6.145046399329287, -146.38464917950574, -10.297311000893739, -1.4081863742835563, -189.29112909506682, -135.7045314186017, -208.56026365563886, -77.36696950650285, -125.75162429210846, -117.78070698024925, 4.006092955938988, -108.92975657235061, -9.311375058890233, -49.78049802974294, -0.8085388901679142, -106.40082389875063, 9.608799277451777, -138.5468626443789, -96.22037073535981, -27.879909448773734, -177.3998817487054, -179.53978189692552, -49.39414949371941, -24.108207745752768, 15.574934251361, -15.204526263974063, -271.7272588287459, -209.4398776638858, 10.378029447342717, -49.03323397146442, -86.79178896567426, -150.1160584682922, -102.97464032859243, -40.26540552634159, -185.3652037006905, -185.35965816206445, -92.0640122447164, 4.370470718883816, 4.63109067603974, -31.2005869454943, -54.34514693848777, -82.41484711857873, -20.13757535786992, -72.45930047227105, -123.71101677965599, 17.665932895780415, -200.40346793244686, -38.29163124290495, -64.75456748159715, -119.72359185127806, -120.57908558278311, 18.660429820812524, -143.3495052206998, -34.60088427325141, -206.36626450674785, -196.4764599036366, -29.353906701712333, -116.89566539372, 2.58199267486268, -176.33604420686927, -8.011383011199218, -40.45016996353181, -131.76602469901766, -74.61306246532318, 8.55975837548917, -4.522977158253945, -66.50644990508451, -148.03193173553893, -112.13155450330821, -145.99878755631545, -0.3332903410874024, -101.07050479864664, -42.12829171146805, -99.79325527165756, -72.22202455734546, -10.559861960229412, -8.58132585923305, -117.527627943688, -50.2534269959476, -66.48604768601955, -26.697711149180975, -52.17071565930928, -92.84706678497918, 12.38601230602239, -147.8258659927997, -144.88652476838902, -46.42906018237833, -11.722106453696359, -142.5890129959755, -22.365509266630518, -94.0750064559092, -89.60011882533578, 7.280330095204971, -126.62213223622182, -2.058640502467198, 8.007962218503138, 8.099236779400561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.292920414900317, "mean_inference_ms": 0.9087469411300694, "mean_action_processing_ms": 0.16296700143686219, "mean_env_wait_ms": 2.1153411168011345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005402565002441406, "StateBufferConnector_ms": 0.0040585994720458984, "ViewRequirementAgentConnector_ms": 0.10213017463684082}, "num_episodes": 64, "episode_return_max": 18.660429820812524, "episode_return_min": -271.7272588287459, "episode_return_mean": -76.222527498921, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.2372020921665, "num_env_steps_trained_throughput_per_sec": 298.2372020921665, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14041.489, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14041.409, "sample_time_ms": 2925.428, "learn_time_ms": 11097.603, "learn_throughput": 360.438, "synch_weights_time_ms": 16.991}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "64a97_00000", "date": "2024-07-26_23-16-55", "timestamp": 1722016015, "time_this_iter_s": 13.422987699508667, "time_total_s": 695.645425081253, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb705000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 695.645425081253, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 10.768421052631581, "ram_util_percent": 28.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.85714909831683, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3102440457519454, "policy_loss": -0.011715984231947611, "vf_loss": 0.3157109964173287, "vf_explained_var": 0.999122240456442, "kl": 0.011211746393625354, "entropy": 0.1318895748894041, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": 19.257856396985325, "episode_reward_min": -209.38125250772984, "episode_reward_mean": -70.84723313189052, "episode_len_mean": 64.12, "episode_media": {}, "episodes_timesteps_total": 6412, "policy_reward_min": {"policy_0": -209.38125250772984}, "policy_reward_max": {"policy_0": 19.257856396985325}, "policy_reward_mean": {"policy_0": -70.84723313189052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.89566539372, 2.58199267486268, -176.33604420686927, -8.011383011199218, -40.45016996353181, -131.76602469901766, -74.61306246532318, 8.55975837548917, -4.522977158253945, -66.50644990508451, -148.03193173553893, -112.13155450330821, -145.99878755631545, -0.3332903410874024, -101.07050479864664, -42.12829171146805, -99.79325527165756, -72.22202455734546, -10.559861960229412, -8.58132585923305, -117.527627943688, -50.2534269959476, -66.48604768601955, -26.697711149180975, -52.17071565930928, -92.84706678497918, 12.38601230602239, -147.8258659927997, -144.88652476838902, -46.42906018237833, -11.722106453696359, -142.5890129959755, -22.365509266630518, -94.0750064559092, -89.60011882533578, 7.280330095204971, -126.62213223622182, -2.058640502467198, 8.007962218503138, 8.099236779400561, -33.748526158462504, -53.627558282549366, -101.07091529748037, -75.70954679496208, -5.319793782334595, -106.61898233071682, -173.90472933282805, -91.70381524593992, -125.88532042794675, -113.25921232653384, -85.7730236204273, -23.577397556241134, -84.30005417703086, -25.63956459549231, -139.440983069475, -94.03284145425272, -187.56612462340541, -72.36474460834808, 15.127611997652847, -5.69027571927406, -116.91211835951911, -12.032154117959253, 6.02678886663066, -57.65523950348291, -63.33356460318979, -23.522982480850306, -66.21831006296857, -91.90240390022785, -93.69103780110862, 19.257856396985325, -5.934133619706309, -147.83743792859747, -146.80127811463552, -163.35489423792978, -136.31758598496913, -113.45121669094509, -113.45541401172868, -185.0000988066737, -17.535467371438756, -71.48759456992026, -10.446899075037331, 2.125296530874981, -9.526132637883038, -96.96346937839814, -209.38125250772984, -158.69596941360376, -162.75460066423375, -0.23608380502176107, -7.855102501723642, -78.58211110943459, -29.013176742431597, -68.88124806022539, -76.89551451845283, -95.2047093428929, -163.16910927753253, -16.53155913856766, -54.44495025327364, -74.29817719715436, -3.1097339189238724, -38.4008393218493], "episode_lengths": [89, 40, 87, 47, 57, 82, 64, 44, 43, 64, 91, 75, 76, 36, 73, 61, 71, 67, 54, 46, 90, 60, 64, 46, 57, 69, 28, 77, 81, 60, 52, 94, 52, 72, 68, 32, 78, 51, 32, 32, 53, 54, 72, 65, 49, 67, 94, 71, 86, 75, 67, 59, 70, 47, 80, 70, 87, 66, 29, 45, 87, 49, 31, 64, 60, 58, 62, 83, 71, 27, 49, 82, 95, 85, 79, 74, 75, 99, 54, 66, 47, 44, 53, 72, 100, 97, 93, 43, 49, 81, 51, 64, 64, 69, 85, 53, 59, 66, 50, 54], "policy_policy_0_reward": [-116.89566539372, 2.58199267486268, -176.33604420686927, -8.011383011199218, -40.45016996353181, -131.76602469901766, -74.61306246532318, 8.55975837548917, -4.522977158253945, -66.50644990508451, -148.03193173553893, -112.13155450330821, -145.99878755631545, -0.3332903410874024, -101.07050479864664, -42.12829171146805, -99.79325527165756, -72.22202455734546, -10.559861960229412, -8.58132585923305, -117.527627943688, -50.2534269959476, -66.48604768601955, -26.697711149180975, -52.17071565930928, -92.84706678497918, 12.38601230602239, -147.8258659927997, -144.88652476838902, -46.42906018237833, -11.722106453696359, -142.5890129959755, -22.365509266630518, -94.0750064559092, -89.60011882533578, 7.280330095204971, -126.62213223622182, -2.058640502467198, 8.007962218503138, 8.099236779400561, -33.748526158462504, -53.627558282549366, -101.07091529748037, -75.70954679496208, -5.319793782334595, -106.61898233071682, -173.90472933282805, -91.70381524593992, -125.88532042794675, -113.25921232653384, -85.7730236204273, -23.577397556241134, -84.30005417703086, -25.63956459549231, -139.440983069475, -94.03284145425272, -187.56612462340541, -72.36474460834808, 15.127611997652847, -5.69027571927406, -116.91211835951911, -12.032154117959253, 6.02678886663066, -57.65523950348291, -63.33356460318979, -23.522982480850306, -66.21831006296857, -91.90240390022785, -93.69103780110862, 19.257856396985325, -5.934133619706309, -147.83743792859747, -146.80127811463552, -163.35489423792978, -136.31758598496913, -113.45121669094509, -113.45541401172868, -185.0000988066737, -17.535467371438756, -71.48759456992026, -10.446899075037331, 2.125296530874981, -9.526132637883038, -96.96346937839814, -209.38125250772984, -158.69596941360376, -162.75460066423375, -0.23608380502176107, -7.855102501723642, -78.58211110943459, -29.013176742431597, -68.88124806022539, -76.89551451845283, -95.2047093428929, -163.16910927753253, -16.53155913856766, -54.44495025327364, -74.29817719715436, -3.1097339189238724, -38.4008393218493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2928371610715371, "mean_inference_ms": 0.9090807640037599, "mean_action_processing_ms": 0.16301161352360477, "mean_env_wait_ms": 2.1171766055860513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055408477783203125, "StateBufferConnector_ms": 0.0040874481201171875, "ViewRequirementAgentConnector_ms": 0.10304665565490723}, "num_episodes": 60, "episode_return_max": 19.257856396985325, "episode_return_min": -209.38125250772984, "episode_return_mean": -70.84723313189052, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.9333746012714, "num_env_steps_trained_throughput_per_sec": 269.9333746012714, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 14103.698, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14103.617, "sample_time_ms": 2938.095, "learn_time_ms": 11146.677, "learn_throughput": 358.851, "synch_weights_time_ms": 17.424}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "64a97_00000", "date": "2024-07-26_23-17-10", "timestamp": 1722016030, "time_this_iter_s": 14.824595928192139, "time_total_s": 710.4700210094452, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 710.4700210094452, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 10.199999999999998, "ram_util_percent": 28.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.0153380215168, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.34934547324179827, "policy_loss": -0.011238191988619898, "vf_loss": 0.3538677766143034, "vf_explained_var": 0.9985693674534559, "kl": 0.011667895855255997, "entropy": 0.11599410472457142, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 19.257856396985325, "episode_reward_min": -416.49831608273803, "episode_reward_mean": -70.58041538810446, "episode_len_mean": 64.08, "episode_media": {}, "episodes_timesteps_total": 6408, "policy_reward_min": {"policy_0": -416.49831608273803}, "policy_reward_max": {"policy_0": 19.257856396985325}, "policy_reward_mean": {"policy_0": -70.58041538810446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.522982480850306, -66.21831006296857, -91.90240390022785, -93.69103780110862, 19.257856396985325, -5.934133619706309, -147.83743792859747, -146.80127811463552, -163.35489423792978, -136.31758598496913, -113.45121669094509, -113.45541401172868, -185.0000988066737, -17.535467371438756, -71.48759456992026, -10.446899075037331, 2.125296530874981, -9.526132637883038, -96.96346937839814, -209.38125250772984, -158.69596941360376, -162.75460066423375, -0.23608380502176107, -7.855102501723642, -78.58211110943459, -29.013176742431597, -68.88124806022539, -76.89551451845283, -95.2047093428929, -163.16910927753253, -16.53155913856766, -54.44495025327364, -74.29817719715436, -3.1097339189238724, -38.4008393218493, -85.79538533638478, -27.162770539685106, -103.05885120501812, -26.35351122305864, -174.53322570333586, 12.485345767221453, 18.56702060716746, -105.33982758389536, -14.991260626885802, -39.393013068408436, 6.985213646921399, -209.15020088939642, 5.3426257256255365, -234.08634846495363, 5.758527660742405, -14.998049942015308, -6.734231757872643, -416.49831608273803, -2.149052929967078, -50.725755404142156, -3.3040498146635695, -29.804811365974647, -109.92000659839448, -67.72552163487346, -65.37977146886547, -52.33717719552697, -92.98901807327093, -122.63930016080496, -63.523748529149, -87.75950943832005, -130.14687172871533, -27.373263576380694, -168.88983982426794, -217.00355840101432, -48.134099639851506, -170.38138659024366, 4.810996659829506, -72.24520184805465, -85.53493377203202, -97.9857191539765, 2.5620671492437292, -204.25881071882284, 16.32317781651936, 0.9474958899130064, -91.26736287525802, -80.21434544157768, -22.45011626112673, -134.0083438241993, -21.775040895289468, 16.59242261485974, -7.14252667926935, -37.75787818775524, -59.22868899511224, -132.9446039895459, -40.75813112712369, 12.126601028583513, 5.679671960280839, 1.4301652444941537, -92.7241987381925, -57.90590977455862, -89.94168293668696, -58.72875840947566, -67.78057397265312, -36.88328249822088, 1.6823158333671557], "episode_lengths": [58, 62, 83, 71, 27, 49, 82, 95, 85, 79, 74, 75, 99, 54, 66, 47, 44, 53, 72, 100, 97, 93, 43, 49, 81, 51, 64, 64, 69, 85, 53, 59, 66, 50, 54, 71, 59, 82, 48, 90, 37, 37, 87, 52, 57, 37, 99, 35, 91, 46, 44, 40, 119, 42, 56, 39, 47, 75, 62, 64, 57, 68, 82, 64, 69, 90, 57, 88, 92, 55, 88, 34, 64, 69, 84, 43, 100, 33, 48, 74, 79, 49, 93, 57, 30, 52, 61, 56, 80, 57, 33, 37, 47, 84, 58, 83, 60, 66, 52, 46], "policy_policy_0_reward": [-23.522982480850306, -66.21831006296857, -91.90240390022785, -93.69103780110862, 19.257856396985325, -5.934133619706309, -147.83743792859747, -146.80127811463552, -163.35489423792978, -136.31758598496913, -113.45121669094509, -113.45541401172868, -185.0000988066737, -17.535467371438756, -71.48759456992026, -10.446899075037331, 2.125296530874981, -9.526132637883038, -96.96346937839814, -209.38125250772984, -158.69596941360376, -162.75460066423375, -0.23608380502176107, -7.855102501723642, -78.58211110943459, -29.013176742431597, -68.88124806022539, -76.89551451845283, -95.2047093428929, -163.16910927753253, -16.53155913856766, -54.44495025327364, -74.29817719715436, -3.1097339189238724, -38.4008393218493, -85.79538533638478, -27.162770539685106, -103.05885120501812, -26.35351122305864, -174.53322570333586, 12.485345767221453, 18.56702060716746, -105.33982758389536, -14.991260626885802, -39.393013068408436, 6.985213646921399, -209.15020088939642, 5.3426257256255365, -234.08634846495363, 5.758527660742405, -14.998049942015308, -6.734231757872643, -416.49831608273803, -2.149052929967078, -50.725755404142156, -3.3040498146635695, -29.804811365974647, -109.92000659839448, -67.72552163487346, -65.37977146886547, -52.33717719552697, -92.98901807327093, -122.63930016080496, -63.523748529149, -87.75950943832005, -130.14687172871533, -27.373263576380694, -168.88983982426794, -217.00355840101432, -48.134099639851506, -170.38138659024366, 4.810996659829506, -72.24520184805465, -85.53493377203202, -97.9857191539765, 2.5620671492437292, -204.25881071882284, 16.32317781651936, 0.9474958899130064, -91.26736287525802, -80.21434544157768, -22.45011626112673, -134.0083438241993, -21.775040895289468, 16.59242261485974, -7.14252667926935, -37.75787818775524, -59.22868899511224, -132.9446039895459, -40.75813112712369, 12.126601028583513, 5.679671960280839, 1.4301652444941537, -92.7241987381925, -57.90590977455862, -89.94168293668696, -58.72875840947566, -67.78057397265312, -36.88328249822088, 1.6823158333671557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930225141731314, "mean_inference_ms": 0.909567893277076, "mean_action_processing_ms": 0.16312926002702027, "mean_env_wait_ms": 2.1197896080672485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006098270416259766, "StateBufferConnector_ms": 0.004266500473022461, "ViewRequirementAgentConnector_ms": 0.10712909698486328}, "num_episodes": 65, "episode_return_max": 19.257856396985325, "episode_return_min": -416.49831608273803, "episode_return_mean": -70.58041538810446, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.7939462821924, "num_env_steps_trained_throughput_per_sec": 297.7939462821924, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 13977.611, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13977.531, "sample_time_ms": 2958.274, "learn_time_ms": 11000.878, "learn_throughput": 363.607, "synch_weights_time_ms": 17.003}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "64a97_00000", "date": "2024-07-26_23-17-23", "timestamp": 1722016043, "time_this_iter_s": 13.440983533859253, "time_total_s": 723.9110045433044, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b8c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.9110045433044, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 10.805263157894737, "ram_util_percent": 28.726315789473688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.46517220487198, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.33715732021761746, "policy_loss": -0.012714764491829556, "vf_loss": 0.3427078214085971, "vf_explained_var": 0.998238633448879, "kl": 0.011882874531875162, "entropy": 0.08566777447267668, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": 19.70104562922145, "episode_reward_min": -475.104566313415, "episode_reward_mean": -73.88293692862861, "episode_len_mean": 64.88, "episode_media": {}, "episodes_timesteps_total": 6488, "policy_reward_min": {"policy_0": -475.104566313415}, "policy_reward_max": {"policy_0": 19.70104562922145}, "policy_reward_mean": {"policy_0": -73.88293692862861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.98901807327093, -122.63930016080496, -63.523748529149, -87.75950943832005, -130.14687172871533, -27.373263576380694, -168.88983982426794, -217.00355840101432, -48.134099639851506, -170.38138659024366, 4.810996659829506, -72.24520184805465, -85.53493377203202, -97.9857191539765, 2.5620671492437292, -204.25881071882284, 16.32317781651936, 0.9474958899130064, -91.26736287525802, -80.21434544157768, -22.45011626112673, -134.0083438241993, -21.775040895289468, 16.59242261485974, -7.14252667926935, -37.75787818775524, -59.22868899511224, -132.9446039895459, -40.75813112712369, 12.126601028583513, 5.679671960280839, 1.4301652444941537, -92.7241987381925, -57.90590977455862, -89.94168293668696, -58.72875840947566, -67.78057397265312, -36.88328249822088, 1.6823158333671557, -42.570905322960144, -187.59558164380184, -78.02972331743426, -28.513556630094108, 8.277549244485874, -80.97397860226765, -119.24371910667276, -8.694989840825697, -208.12128422469073, -104.92737130052757, -32.02414791310502, -64.38297788076503, -4.06436983115175, -20.62455655206038, -104.11734770044751, -75.56660393390537, -173.95805597377486, 1.2354105911217492, -94.74748563645502, 10.574869559786134, -31.57601554073559, -2.785424241882736, -19.342350345398444, -108.32604389570902, -4.098849841724047, -9.201901658381107, -151.00480351599495, 5.094078447076122, -48.11449366253806, -155.14429090525365, 4.4325981878326814, -57.836556630890776, -16.993570850839202, -108.79618757477225, 8.57413105626815, -133.2667808385282, -8.364187067416339, -20.584496621221362, -78.58401532078463, 19.70104562922145, -199.05966197086119, -60.128105830001005, -27.3507517258814, -113.70411249640475, -73.57118821474873, -137.12776546913653, -80.95534619155808, -115.6407540720418, -2.3980625333493495, -40.2891886502477, -69.92221343522343, 15.69159246566148, -109.11403777070377, -145.64641986347962, -203.92434776062848, -88.78703290227973, -475.104566313415, -173.83215620899492, -137.0771977997895, -231.35158988260903, -36.492053166092276], "episode_lengths": [68, 82, 64, 69, 90, 57, 88, 92, 55, 88, 34, 64, 69, 84, 43, 100, 33, 48, 74, 79, 49, 93, 57, 30, 52, 61, 56, 80, 57, 33, 37, 47, 84, 58, 83, 60, 66, 52, 46, 56, 99, 72, 52, 43, 69, 84, 45, 101, 73, 52, 61, 45, 53, 70, 65, 94, 46, 71, 33, 60, 50, 47, 85, 39, 48, 85, 40, 57, 86, 42, 59, 47, 77, 34, 93, 49, 50, 66, 29, 91, 65, 58, 82, 65, 82, 66, 80, 39, 60, 64, 36, 74, 83, 95, 80, 128, 87, 77, 105, 62], "policy_policy_0_reward": [-92.98901807327093, -122.63930016080496, -63.523748529149, -87.75950943832005, -130.14687172871533, -27.373263576380694, -168.88983982426794, -217.00355840101432, -48.134099639851506, -170.38138659024366, 4.810996659829506, -72.24520184805465, -85.53493377203202, -97.9857191539765, 2.5620671492437292, -204.25881071882284, 16.32317781651936, 0.9474958899130064, -91.26736287525802, -80.21434544157768, -22.45011626112673, -134.0083438241993, -21.775040895289468, 16.59242261485974, -7.14252667926935, -37.75787818775524, -59.22868899511224, -132.9446039895459, -40.75813112712369, 12.126601028583513, 5.679671960280839, 1.4301652444941537, -92.7241987381925, -57.90590977455862, -89.94168293668696, -58.72875840947566, -67.78057397265312, -36.88328249822088, 1.6823158333671557, -42.570905322960144, -187.59558164380184, -78.02972331743426, -28.513556630094108, 8.277549244485874, -80.97397860226765, -119.24371910667276, -8.694989840825697, -208.12128422469073, -104.92737130052757, -32.02414791310502, -64.38297788076503, -4.06436983115175, -20.62455655206038, -104.11734770044751, -75.56660393390537, -173.95805597377486, 1.2354105911217492, -94.74748563645502, 10.574869559786134, -31.57601554073559, -2.785424241882736, -19.342350345398444, -108.32604389570902, -4.098849841724047, -9.201901658381107, -151.00480351599495, 5.094078447076122, -48.11449366253806, -155.14429090525365, 4.4325981878326814, -57.836556630890776, -16.993570850839202, -108.79618757477225, 8.57413105626815, -133.2667808385282, -8.364187067416339, -20.584496621221362, -78.58401532078463, 19.70104562922145, -199.05966197086119, -60.128105830001005, -27.3507517258814, -113.70411249640475, -73.57118821474873, -137.12776546913653, -80.95534619155808, -115.6407540720418, -2.3980625333493495, -40.2891886502477, -69.92221343522343, 15.69159246566148, -109.11403777070377, -145.64641986347962, -203.92434776062848, -88.78703290227973, -475.104566313415, -173.83215620899492, -137.0771977997895, -231.35158988260903, -36.492053166092276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931535033841076, "mean_inference_ms": 0.9080406515596045, "mean_action_processing_ms": 0.16285236688234292, "mean_env_wait_ms": 2.1214455755096533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005976676940917969, "StateBufferConnector_ms": 0.004141807556152344, "ViewRequirementAgentConnector_ms": 0.10418915748596191}, "num_episodes": 61, "episode_return_max": 19.70104562922145, "episode_return_min": -475.104566313415, "episode_return_mean": -73.88293692862861, "episodes_this_iter": 61}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.43805368741954, "num_env_steps_trained_throughput_per_sec": 289.43805368741954, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 13909.825, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13909.746, "sample_time_ms": 2956.732, "learn_time_ms": 10934.836, "learn_throughput": 365.803, "synch_weights_time_ms": 16.846}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "64a97_00000", "date": "2024-07-26_23-17-37", "timestamp": 1722016057, "time_this_iter_s": 13.827609062194824, "time_total_s": 737.7386136054993, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 737.7386136054993, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 11.389473684210527, "ram_util_percent": 28.736842105263165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.7414514914155, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2202334769317531, "policy_loss": -0.00678997968401139, "vf_loss": 0.215848113456741, "vf_explained_var": 0.9996263031537335, "kl": 0.01696770866413623, "entropy": 0.02778604746660373, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 20.346920793701898, "episode_reward_min": -475.104566313415, "episode_reward_mean": -71.31759563725736, "episode_len_mean": 64.32, "episode_media": {}, "episodes_timesteps_total": 6432, "policy_reward_min": {"policy_0": -475.104566313415}, "policy_reward_max": {"policy_0": 20.346920793701898}, "policy_reward_mean": {"policy_0": -71.31759563725736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.00480351599495, 5.094078447076122, -48.11449366253806, -155.14429090525365, 4.4325981878326814, -57.836556630890776, -16.993570850839202, -108.79618757477225, 8.57413105626815, -133.2667808385282, -8.364187067416339, -20.584496621221362, -78.58401532078463, 19.70104562922145, -199.05966197086119, -60.128105830001005, -27.3507517258814, -113.70411249640475, -73.57118821474873, -137.12776546913653, -80.95534619155808, -115.6407540720418, -2.3980625333493495, -40.2891886502477, -69.92221343522343, 15.69159246566148, -109.11403777070377, -145.64641986347962, -203.92434776062848, -88.78703290227973, -475.104566313415, -173.83215620899492, -137.0771977997895, -231.35158988260903, -36.492053166092276, 17.00478673832256, -10.237634944879225, -46.06652120691663, 7.8493283121845465, -68.82335849835339, -82.87475471901269, -19.137706969272763, 8.909457726276266, -36.88281059620518, -202.09299400231927, -22.93591977441317, -56.58818049874087, -190.32634836766832, -84.23643159680584, -97.52341922985967, 7.143636186143424, -55.37282327667906, -132.84791799292984, -73.87076212766898, 3.565744414931049, -128.152777493145, -205.7134090450692, -64.39968679286828, -81.98639140435769, -2.78294201514099, -4.597913384161634, -83.70405834576252, -57.86324902398326, -99.27741736978004, -133.37990362856624, -161.36875158660843, -86.88300519476644, -43.9446262730534, -221.20815138010948, 17.43677091136552, -142.8772773025658, -26.11000399173061, 20.346920793701898, 18.500003949011298, -11.745625331552127, -72.21156177231124, 7.936749763665195, -12.023506516468123, 8.850769545531444, -66.0815217229266, -61.75058199152187, -63.76075759145316, -152.803789672581, -10.238749544101754, -18.63343941671058, -2.0363302550060864, -120.81031265227797, -24.372339141986227, -7.965004014566218, -74.49155140141026, -213.53819681110633, -17.78841515817724, -25.297939903454353, -9.84324307482919, -85.84252292580088, 1.8555138503853914, -21.647928176982926, -123.09971439569668, -71.68875459336803, -12.747822359945996], "episode_lengths": [85, 40, 57, 86, 42, 59, 47, 77, 34, 93, 49, 50, 66, 29, 91, 65, 58, 82, 65, 82, 66, 80, 39, 60, 64, 36, 74, 83, 95, 80, 128, 87, 77, 105, 62, 29, 50, 60, 40, 75, 70, 56, 41, 56, 97, 54, 62, 93, 81, 85, 41, 58, 85, 63, 41, 82, 96, 61, 78, 49, 47, 80, 63, 83, 78, 91, 71, 55, 101, 37, 93, 59, 27, 35, 49, 67, 32, 48, 37, 67, 66, 63, 85, 49, 57, 42, 76, 56, 47, 67, 98, 46, 52, 46, 82, 39, 50, 78, 63, 54], "policy_policy_0_reward": [-151.00480351599495, 5.094078447076122, -48.11449366253806, -155.14429090525365, 4.4325981878326814, -57.836556630890776, -16.993570850839202, -108.79618757477225, 8.57413105626815, -133.2667808385282, -8.364187067416339, -20.584496621221362, -78.58401532078463, 19.70104562922145, -199.05966197086119, -60.128105830001005, -27.3507517258814, -113.70411249640475, -73.57118821474873, -137.12776546913653, -80.95534619155808, -115.6407540720418, -2.3980625333493495, -40.2891886502477, -69.92221343522343, 15.69159246566148, -109.11403777070377, -145.64641986347962, -203.92434776062848, -88.78703290227973, -475.104566313415, -173.83215620899492, -137.0771977997895, -231.35158988260903, -36.492053166092276, 17.00478673832256, -10.237634944879225, -46.06652120691663, 7.8493283121845465, -68.82335849835339, -82.87475471901269, -19.137706969272763, 8.909457726276266, -36.88281059620518, -202.09299400231927, -22.93591977441317, -56.58818049874087, -190.32634836766832, -84.23643159680584, -97.52341922985967, 7.143636186143424, -55.37282327667906, -132.84791799292984, -73.87076212766898, 3.565744414931049, -128.152777493145, -205.7134090450692, -64.39968679286828, -81.98639140435769, -2.78294201514099, -4.597913384161634, -83.70405834576252, -57.86324902398326, -99.27741736978004, -133.37990362856624, -161.36875158660843, -86.88300519476644, -43.9446262730534, -221.20815138010948, 17.43677091136552, -142.8772773025658, -26.11000399173061, 20.346920793701898, 18.500003949011298, -11.745625331552127, -72.21156177231124, 7.936749763665195, -12.023506516468123, 8.850769545531444, -66.0815217229266, -61.75058199152187, -63.76075759145316, -152.803789672581, -10.238749544101754, -18.63343941671058, -2.0363302550060864, -120.81031265227797, -24.372339141986227, -7.965004014566218, -74.49155140141026, -213.53819681110633, -17.78841515817724, -25.297939903454353, -9.84324307482919, -85.84252292580088, 1.8555138503853914, -21.647928176982926, -123.09971439569668, -71.68875459336803, -12.747822359945996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930909173083699, "mean_inference_ms": 0.9080302169574318, "mean_action_processing_ms": 0.1629797145797491, "mean_env_wait_ms": 2.1240183020186927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005944490432739258, "StateBufferConnector_ms": 0.00409698486328125, "ViewRequirementAgentConnector_ms": 0.10277748107910156}, "num_episodes": 65, "episode_return_max": 20.346920793701898, "episode_return_min": -475.104566313415, "episode_return_mean": -71.31759563725736, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.94114997013924, "num_env_steps_trained_throughput_per_sec": 336.94114997013924, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 13599.856, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13599.777, "sample_time_ms": 2962.771, "learn_time_ms": 10619.305, "learn_throughput": 376.672, "synch_weights_time_ms": 16.438}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "64a97_00000", "date": "2024-07-26_23-17-49", "timestamp": 1722016069, "time_this_iter_s": 11.878981113433838, "time_total_s": 749.6175947189331, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 749.6175947189331, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 11.952941176470588, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.64630498240391, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3007395188799516, "policy_loss": 0.02507694555048753, "vf_loss": 0.24328397357215484, "vf_explained_var": 0.9988926391427716, "kl": 0.05013920260632103, "entropy": 0.14653640945228594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 20.346920793701898, "episode_reward_min": -243.48801898751344, "episode_reward_mean": -68.03679998448612, "episode_len_mean": 64.89, "episode_media": {}, "episodes_timesteps_total": 6489, "policy_reward_min": {"policy_0": -243.48801898751344}, "policy_reward_max": {"policy_0": 20.346920793701898}, "policy_reward_mean": {"policy_0": -68.03679998448612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.78294201514099, -4.597913384161634, -83.70405834576252, -57.86324902398326, -99.27741736978004, -133.37990362856624, -161.36875158660843, -86.88300519476644, -43.9446262730534, -221.20815138010948, 17.43677091136552, -142.8772773025658, -26.11000399173061, 20.346920793701898, 18.500003949011298, -11.745625331552127, -72.21156177231124, 7.936749763665195, -12.023506516468123, 8.850769545531444, -66.0815217229266, -61.75058199152187, -63.76075759145316, -152.803789672581, -10.238749544101754, -18.63343941671058, -2.0363302550060864, -120.81031265227797, -24.372339141986227, -7.965004014566218, -74.49155140141026, -213.53819681110633, -17.78841515817724, -25.297939903454353, -9.84324307482919, -85.84252292580088, 1.8555138503853914, -21.647928176982926, -123.09971439569668, -71.68875459336803, -12.747822359945996, -54.82738310245407, -68.93905576368564, -237.5432174363722, 10.348656794042219, -12.9611275072719, -94.39058322026047, -6.017694340895424, -83.92623003941236, -129.20958445630964, 4.019295062313996, -225.0415891675331, -124.48858655382747, -144.0724991818375, -52.63253032393312, -91.33875960183309, -169.12504089716944, -6.1564037224719526, -3.6989402775328055, -94.75194859505665, -72.07247505646606, -22.562177780291574, -14.411673041003144, -207.57057847690305, -88.47308486543923, -22.628797294003604, 2.5638249598859546, -77.19048437119072, -84.39044140427953, -46.60281510968482, -61.42972969169393, -50.879617317958356, -28.462454008443938, -151.95182938403158, -77.56793258972762, -67.32531166547308, -26.809387224924492, -51.15290023782042, -243.48801898751344, -89.22323655802407, -15.290809760590607, -2.644084095037065, -31.05304090707748, -72.98498401430334, -145.07556433227242, -177.5495016962019, 3.8112778915565197, -112.2126849525263, -61.0655144086372, 2.348440211826084, -126.4825925578207, -69.8063976813008, -45.32593422891988, -57.46305903341522, -133.23384404129172, -42.580936678219004, -190.76550622899876, -93.97729729613718, -93.63203643102622, -2.8234066649288554], "episode_lengths": [49, 47, 80, 63, 83, 78, 91, 71, 55, 101, 37, 93, 59, 27, 35, 49, 67, 32, 48, 37, 67, 66, 63, 85, 49, 57, 42, 76, 56, 47, 67, 98, 46, 52, 46, 82, 39, 50, 78, 63, 54, 58, 63, 105, 32, 55, 69, 44, 67, 92, 37, 109, 90, 82, 58, 81, 99, 44, 48, 71, 70, 57, 54, 104, 73, 49, 42, 65, 78, 55, 63, 63, 47, 95, 68, 62, 50, 60, 111, 82, 43, 50, 57, 65, 95, 92, 40, 76, 65, 44, 92, 71, 56, 65, 79, 60, 99, 71, 84, 48], "policy_policy_0_reward": [-2.78294201514099, -4.597913384161634, -83.70405834576252, -57.86324902398326, -99.27741736978004, -133.37990362856624, -161.36875158660843, -86.88300519476644, -43.9446262730534, -221.20815138010948, 17.43677091136552, -142.8772773025658, -26.11000399173061, 20.346920793701898, 18.500003949011298, -11.745625331552127, -72.21156177231124, 7.936749763665195, -12.023506516468123, 8.850769545531444, -66.0815217229266, -61.75058199152187, -63.76075759145316, -152.803789672581, -10.238749544101754, -18.63343941671058, -2.0363302550060864, -120.81031265227797, -24.372339141986227, -7.965004014566218, -74.49155140141026, -213.53819681110633, -17.78841515817724, -25.297939903454353, -9.84324307482919, -85.84252292580088, 1.8555138503853914, -21.647928176982926, -123.09971439569668, -71.68875459336803, -12.747822359945996, -54.82738310245407, -68.93905576368564, -237.5432174363722, 10.348656794042219, -12.9611275072719, -94.39058322026047, -6.017694340895424, -83.92623003941236, -129.20958445630964, 4.019295062313996, -225.0415891675331, -124.48858655382747, -144.0724991818375, -52.63253032393312, -91.33875960183309, -169.12504089716944, -6.1564037224719526, -3.6989402775328055, -94.75194859505665, -72.07247505646606, -22.562177780291574, -14.411673041003144, -207.57057847690305, -88.47308486543923, -22.628797294003604, 2.5638249598859546, -77.19048437119072, -84.39044140427953, -46.60281510968482, -61.42972969169393, -50.879617317958356, -28.462454008443938, -151.95182938403158, -77.56793258972762, -67.32531166547308, -26.809387224924492, -51.15290023782042, -243.48801898751344, -89.22323655802407, -15.290809760590607, -2.644084095037065, -31.05304090707748, -72.98498401430334, -145.07556433227242, -177.5495016962019, 3.8112778915565197, -112.2126849525263, -61.0655144086372, 2.348440211826084, -126.4825925578207, -69.8063976813008, -45.32593422891988, -57.46305903341522, -133.23384404129172, -42.580936678219004, -190.76550622899876, -93.97729729613718, -93.63203643102622, -2.8234066649288554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29318208936960577, "mean_inference_ms": 0.9084830276901044, "mean_action_processing_ms": 0.16301419510905216, "mean_env_wait_ms": 2.125614349394052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00581812858581543, "StateBufferConnector_ms": 0.004100322723388672, "ViewRequirementAgentConnector_ms": 0.1026463508605957}, "num_episodes": 59, "episode_return_max": 20.346920793701898, "episode_return_min": -243.48801898751344, "episode_return_mean": -68.03679998448612, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.93472068772064, "num_env_steps_trained_throughput_per_sec": 271.93472068772064, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 13584.891, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13584.812, "sample_time_ms": 2957.077, "learn_time_ms": 10610.32, "learn_throughput": 376.991, "synch_weights_time_ms": 16.159}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "64a97_00000", "date": "2024-07-26_23-18-04", "timestamp": 1722016084, "time_this_iter_s": 14.718226432800293, "time_total_s": 764.3358211517334, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7365f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.3358211517334, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.547619047619047, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.73776019116243, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.27815704982737466, "policy_loss": -0.013467503074692407, "vf_loss": 0.2820531621032084, "vf_explained_var": 0.9992205375805497, "kl": 0.01073131476960043, "entropy": 0.12940660239837598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 19.942887096707427, "episode_reward_min": -243.48801898751344, "episode_reward_mean": -74.30187116893364, "episode_len_mean": 66.95, "episode_media": {}, "episodes_timesteps_total": 6695, "policy_reward_min": {"policy_0": -243.48801898751344}, "policy_reward_max": {"policy_0": 19.942887096707427}, "policy_reward_mean": {"policy_0": -74.30187116893364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.75194859505665, -72.07247505646606, -22.562177780291574, -14.411673041003144, -207.57057847690305, -88.47308486543923, -22.628797294003604, 2.5638249598859546, -77.19048437119072, -84.39044140427953, -46.60281510968482, -61.42972969169393, -50.879617317958356, -28.462454008443938, -151.95182938403158, -77.56793258972762, -67.32531166547308, -26.809387224924492, -51.15290023782042, -243.48801898751344, -89.22323655802407, -15.290809760590607, -2.644084095037065, -31.05304090707748, -72.98498401430334, -145.07556433227242, -177.5495016962019, 3.8112778915565197, -112.2126849525263, -61.0655144086372, 2.348440211826084, -126.4825925578207, -69.8063976813008, -45.32593422891988, -57.46305903341522, -133.23384404129172, -42.580936678219004, -190.76550622899876, -93.97729729613718, -93.63203643102622, -2.8234066649288554, -84.5129326124403, -111.91009746945554, -14.89183330019912, -28.06936746128406, 19.942887096707427, 0.8930932163183671, -157.4875825857228, -48.71593471195869, -24.651661657642254, -8.28647826470321, -88.16350201890509, -126.41482615567331, -94.51240973681922, 10.00112834155193, -169.98168241788403, -22.564492283566125, -170.11841973193907, -178.519580999918, 4.653158694910199, -9.267501842150974, -128.62209392502365, -3.9777644854530725, -66.39045384366125, -139.6294184563484, -104.62864620216301, -143.40151210864056, -179.33218591969887, 5.272546136392125, -129.43052437113633, -9.266040133255839, -4.750942525358582, -9.649618460663305, -110.04702191677777, -166.89293929487386, -110.37567840450113, -72.44395249029171, -81.81226741166932, -6.35437529580382, -92.72499193615393, -52.2980899724216, -24.65876669111252, 13.297813238113108, -81.38215235928702, -81.85999473689239, -60.5056053295904, -18.693597855920615, -50.49134705481079, -71.38875364467506, 10.008619926794804, -84.78502600259728, -197.65199474799073, -125.95096356865663, -18.62158225586514, -84.62220882894341, -6.56630991082346, -70.17295037637673, -109.39185059185974, -200.0095071596879, -213.2183864195402], "episode_lengths": [71, 70, 57, 54, 104, 73, 49, 42, 65, 78, 55, 63, 63, 47, 95, 68, 62, 50, 60, 111, 82, 43, 50, 57, 65, 95, 92, 40, 76, 65, 44, 92, 71, 56, 65, 79, 60, 99, 71, 84, 48, 77, 77, 51, 56, 32, 39, 98, 60, 55, 44, 78, 77, 72, 39, 90, 54, 88, 101, 39, 55, 84, 44, 61, 81, 86, 94, 102, 38, 79, 47, 52, 49, 74, 99, 88, 65, 61, 44, 70, 58, 60, 36, 74, 71, 60, 45, 56, 70, 42, 70, 90, 88, 53, 67, 43, 63, 73, 106, 99], "policy_policy_0_reward": [-94.75194859505665, -72.07247505646606, -22.562177780291574, -14.411673041003144, -207.57057847690305, -88.47308486543923, -22.628797294003604, 2.5638249598859546, -77.19048437119072, -84.39044140427953, -46.60281510968482, -61.42972969169393, -50.879617317958356, -28.462454008443938, -151.95182938403158, -77.56793258972762, -67.32531166547308, -26.809387224924492, -51.15290023782042, -243.48801898751344, -89.22323655802407, -15.290809760590607, -2.644084095037065, -31.05304090707748, -72.98498401430334, -145.07556433227242, -177.5495016962019, 3.8112778915565197, -112.2126849525263, -61.0655144086372, 2.348440211826084, -126.4825925578207, -69.8063976813008, -45.32593422891988, -57.46305903341522, -133.23384404129172, -42.580936678219004, -190.76550622899876, -93.97729729613718, -93.63203643102622, -2.8234066649288554, -84.5129326124403, -111.91009746945554, -14.89183330019912, -28.06936746128406, 19.942887096707427, 0.8930932163183671, -157.4875825857228, -48.71593471195869, -24.651661657642254, -8.28647826470321, -88.16350201890509, -126.41482615567331, -94.51240973681922, 10.00112834155193, -169.98168241788403, -22.564492283566125, -170.11841973193907, -178.519580999918, 4.653158694910199, -9.267501842150974, -128.62209392502365, -3.9777644854530725, -66.39045384366125, -139.6294184563484, -104.62864620216301, -143.40151210864056, -179.33218591969887, 5.272546136392125, -129.43052437113633, -9.266040133255839, -4.750942525358582, -9.649618460663305, -110.04702191677777, -166.89293929487386, -110.37567840450113, -72.44395249029171, -81.81226741166932, -6.35437529580382, -92.72499193615393, -52.2980899724216, -24.65876669111252, 13.297813238113108, -81.38215235928702, -81.85999473689239, -60.5056053295904, -18.693597855920615, -50.49134705481079, -71.38875364467506, 10.008619926794804, -84.78502600259728, -197.65199474799073, -125.95096356865663, -18.62158225586514, -84.62220882894341, -6.56630991082346, -70.17295037637673, -109.39185059185974, -200.0095071596879, -213.2183864195402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29357073351744467, "mean_inference_ms": 0.907962656828841, "mean_action_processing_ms": 0.16286489610576205, "mean_env_wait_ms": 2.1264581228122337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005553245544433594, "StateBufferConnector_ms": 0.0040283203125, "ViewRequirementAgentConnector_ms": 0.10131716728210449}, "num_episodes": 59, "episode_return_max": 19.942887096707427, "episode_return_min": -243.48801898751344, "episode_return_mean": -74.30187116893364, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.8027906419053, "num_env_steps_trained_throughput_per_sec": 269.8027906419053, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 13957.073, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13956.996, "sample_time_ms": 2974.543, "learn_time_ms": 10965.066, "learn_throughput": 364.795, "synch_weights_time_ms": 16.129}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "64a97_00000", "date": "2024-07-26_23-18-19", "timestamp": 1722016099, "time_this_iter_s": 14.834448099136353, "time_total_s": 779.1702692508698, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0608739990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 779.1702692508698, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.240909090909092, "ram_util_percent": 28.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.63631450881561, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1964515603617959, "policy_loss": -0.010840172781414973, "vf_loss": 0.19570344088909528, "vf_explained_var": 0.9995356518154342, "kl": 0.012206228771052981, "entropy": 0.07705152644678795, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": 15.472244818242146, "episode_reward_min": -542.4729798306512, "episode_reward_mean": -79.42932002444752, "episode_len_mean": 67.64, "episode_media": {}, "episodes_timesteps_total": 6764, "policy_reward_min": {"policy_0": -542.4729798306512}, "policy_reward_max": {"policy_0": 15.472244818242146}, "policy_reward_mean": {"policy_0": -79.42932002444752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.267501842150974, -128.62209392502365, -3.9777644854530725, -66.39045384366125, -139.6294184563484, -104.62864620216301, -143.40151210864056, -179.33218591969887, 5.272546136392125, -129.43052437113633, -9.266040133255839, -4.750942525358582, -9.649618460663305, -110.04702191677777, -166.89293929487386, -110.37567840450113, -72.44395249029171, -81.81226741166932, -6.35437529580382, -92.72499193615393, -52.2980899724216, -24.65876669111252, 13.297813238113108, -81.38215235928702, -81.85999473689239, -60.5056053295904, -18.693597855920615, -50.49134705481079, -71.38875364467506, 10.008619926794804, -84.78502600259728, -197.65199474799073, -125.95096356865663, -18.62158225586514, -84.62220882894341, -6.56630991082346, -70.17295037637673, -109.39185059185974, -200.0095071596879, -213.2183864195402, -120.1997059813767, -169.95928288077877, -177.83359935178268, -89.34271818270996, -62.539774953612635, -16.354801641081593, -107.5499766601787, -71.263075723243, -18.466921460499872, -86.07385138352694, -31.96180976091256, -114.6848722567461, -10.74625348399547, 15.472244818242146, 10.8829444244673, -117.8872056361747, -194.9511179328145, -3.857581105313283, -107.53480387755816, -59.46669160425439, -2.125684151016765, 1.1532395346128093, -74.53133651395758, -112.09410242493945, -12.828256403299603, -31.041052869822757, 0.6629460504658204, -139.0302666496703, -225.5920204171741, -23.628327487405752, -71.06371291397748, -46.56274227027173, -179.21482408577788, -36.768743019668186, -126.85055437855739, -84.82685095743952, -29.29598516032467, -16.312054541130223, -5.2372257429173015, -28.05482670165595, -61.64913225389982, -3.1207174100601085, -14.411209444612005, -57.54612586782577, -130.73248537757232, -80.84688598445571, -11.69836625980363, -49.47725169806453, -54.551999603664186, -123.8413624789315, -542.4729798306512, -19.45501493169548, -189.9913306163329, -156.12152227353712, -44.37524094854198, -89.8812240076853, -121.18732325204883, -5.921782311921109, -159.05326596198927, -156.34750896430455], "episode_lengths": [55, 84, 44, 61, 81, 86, 94, 102, 38, 79, 47, 52, 49, 74, 99, 88, 65, 61, 44, 70, 58, 60, 36, 74, 71, 60, 45, 56, 70, 42, 70, 90, 88, 53, 67, 43, 63, 73, 106, 99, 78, 86, 89, 72, 61, 44, 82, 68, 45, 73, 56, 75, 49, 37, 30, 89, 99, 39, 73, 59, 49, 49, 65, 88, 46, 53, 37, 94, 108, 53, 67, 56, 94, 61, 92, 68, 57, 47, 44, 57, 60, 44, 45, 62, 84, 81, 45, 62, 63, 91, 150, 57, 95, 87, 63, 69, 90, 51, 95, 84], "policy_policy_0_reward": [-9.267501842150974, -128.62209392502365, -3.9777644854530725, -66.39045384366125, -139.6294184563484, -104.62864620216301, -143.40151210864056, -179.33218591969887, 5.272546136392125, -129.43052437113633, -9.266040133255839, -4.750942525358582, -9.649618460663305, -110.04702191677777, -166.89293929487386, -110.37567840450113, -72.44395249029171, -81.81226741166932, -6.35437529580382, -92.72499193615393, -52.2980899724216, -24.65876669111252, 13.297813238113108, -81.38215235928702, -81.85999473689239, -60.5056053295904, -18.693597855920615, -50.49134705481079, -71.38875364467506, 10.008619926794804, -84.78502600259728, -197.65199474799073, -125.95096356865663, -18.62158225586514, -84.62220882894341, -6.56630991082346, -70.17295037637673, -109.39185059185974, -200.0095071596879, -213.2183864195402, -120.1997059813767, -169.95928288077877, -177.83359935178268, -89.34271818270996, -62.539774953612635, -16.354801641081593, -107.5499766601787, -71.263075723243, -18.466921460499872, -86.07385138352694, -31.96180976091256, -114.6848722567461, -10.74625348399547, 15.472244818242146, 10.8829444244673, -117.8872056361747, -194.9511179328145, -3.857581105313283, -107.53480387755816, -59.46669160425439, -2.125684151016765, 1.1532395346128093, -74.53133651395758, -112.09410242493945, -12.828256403299603, -31.041052869822757, 0.6629460504658204, -139.0302666496703, -225.5920204171741, -23.628327487405752, -71.06371291397748, -46.56274227027173, -179.21482408577788, -36.768743019668186, -126.85055437855739, -84.82685095743952, -29.29598516032467, -16.312054541130223, -5.2372257429173015, -28.05482670165595, -61.64913225389982, -3.1207174100601085, -14.411209444612005, -57.54612586782577, -130.73248537757232, -80.84688598445571, -11.69836625980363, -49.47725169806453, -54.551999603664186, -123.8413624789315, -542.4729798306512, -19.45501493169548, -189.9913306163329, -156.12152227353712, -44.37524094854198, -89.8812240076853, -121.18732325204883, -5.921782311921109, -159.05326596198927, -156.34750896430455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937199716610516, "mean_inference_ms": 0.9076707756096073, "mean_action_processing_ms": 0.16284644428246758, "mean_env_wait_ms": 2.1283578833663457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005743741989135742, "StateBufferConnector_ms": 0.004087924957275391, "ViewRequirementAgentConnector_ms": 0.1020505428314209}, "num_episodes": 60, "episode_return_max": 15.472244818242146, "episode_return_min": -542.4729798306512, "episode_return_mean": -79.42932002444752, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.2313048838824, "num_env_steps_trained_throughput_per_sec": 281.2313048838824, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 14003.214, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14003.136, "sample_time_ms": 2980.13, "learn_time_ms": 11005.817, "learn_throughput": 363.444, "synch_weights_time_ms": 15.942}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "64a97_00000", "date": "2024-07-26_23-18-33", "timestamp": 1722016113, "time_this_iter_s": 14.22969102859497, "time_total_s": 793.3999602794647, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7064d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 793.3999602794647, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.425, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.87199496676524, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.29589210700942203, "policy_loss": -0.005706725858908612, "vf_loss": 0.29418580286437646, "vf_explained_var": 0.9989030425747235, "kl": 0.008356368727678917, "entropy": 0.10477932352805511, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 16.440341157939084, "episode_reward_min": -542.4729798306512, "episode_reward_mean": -76.21651939998266, "episode_len_mean": 67.13, "episode_media": {}, "episodes_timesteps_total": 6713, "policy_reward_min": {"policy_0": -542.4729798306512}, "policy_reward_max": {"policy_0": 16.440341157939084}, "policy_reward_mean": {"policy_0": -76.21651939998266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.46669160425439, -2.125684151016765, 1.1532395346128093, -74.53133651395758, -112.09410242493945, -12.828256403299603, -31.041052869822757, 0.6629460504658204, -139.0302666496703, -225.5920204171741, -23.628327487405752, -71.06371291397748, -46.56274227027173, -179.21482408577788, -36.768743019668186, -126.85055437855739, -84.82685095743952, -29.29598516032467, -16.312054541130223, -5.2372257429173015, -28.05482670165595, -61.64913225389982, -3.1207174100601085, -14.411209444612005, -57.54612586782577, -130.73248537757232, -80.84688598445571, -11.69836625980363, -49.47725169806453, -54.551999603664186, -123.8413624789315, -542.4729798306512, -19.45501493169548, -189.9913306163329, -156.12152227353712, -44.37524094854198, -89.8812240076853, -121.18732325204883, -5.921782311921109, -159.05326596198927, -156.34750896430455, -3.4015568870256905, 3.4329940850643537, -48.84615169064229, 16.440341157939084, -133.52577887461615, -113.92366746564376, -91.9377638635205, -0.4870705118911727, -192.19443830688397, -94.5574853547773, -26.234009415622268, -205.0918014160197, -44.02447014288228, -40.007697913902014, -146.53745986617946, -9.465465549194787, -23.18786735002204, -161.5082350100705, -126.94745850065695, -82.61198514701303, -108.78942125539518, -20.636289185591835, -89.019655108047, -2.7996556090154217, -138.22335062318433, -95.79456317756483, 15.995124035838856, -132.49937817910984, -273.60037964924334, -6.303513469759059, -110.032196188979, 10.65152260555074, -3.7147349561249023, 12.945710737933707, -88.06447210492092, -137.1332022376762, -55.692891751387215, -131.7150176359915, -201.175557179454, -129.9927260786663, -5.100316149281373, -8.164243471155196, 9.241492719124546, -80.41767314372797, -2.1580459067905995, 10.8924921110484, -24.733375517288277, -23.458071642948866, -44.52368689415466, -106.03134439582888, 9.346814668598856, -75.66432347867104, -109.68659921704283, -40.582777703807395, -89.26661830059702, -62.23113607920749, -202.78689297201362, -173.69500088148604, -17.02915652290918], "episode_lengths": [59, 49, 49, 65, 88, 46, 53, 37, 94, 108, 53, 67, 56, 94, 61, 92, 68, 57, 47, 44, 57, 60, 44, 45, 62, 84, 81, 45, 62, 63, 91, 150, 57, 95, 87, 63, 69, 90, 51, 95, 84, 41, 42, 56, 34, 79, 75, 84, 47, 93, 85, 59, 105, 60, 54, 82, 49, 48, 92, 73, 71, 88, 52, 84, 48, 84, 61, 28, 82, 100, 44, 86, 38, 46, 33, 83, 94, 63, 88, 99, 78, 46, 47, 36, 81, 43, 32, 58, 56, 63, 76, 40, 65, 88, 60, 83, 61, 96, 97, 55], "policy_policy_0_reward": [-59.46669160425439, -2.125684151016765, 1.1532395346128093, -74.53133651395758, -112.09410242493945, -12.828256403299603, -31.041052869822757, 0.6629460504658204, -139.0302666496703, -225.5920204171741, -23.628327487405752, -71.06371291397748, -46.56274227027173, -179.21482408577788, -36.768743019668186, -126.85055437855739, -84.82685095743952, -29.29598516032467, -16.312054541130223, -5.2372257429173015, -28.05482670165595, -61.64913225389982, -3.1207174100601085, -14.411209444612005, -57.54612586782577, -130.73248537757232, -80.84688598445571, -11.69836625980363, -49.47725169806453, -54.551999603664186, -123.8413624789315, -542.4729798306512, -19.45501493169548, -189.9913306163329, -156.12152227353712, -44.37524094854198, -89.8812240076853, -121.18732325204883, -5.921782311921109, -159.05326596198927, -156.34750896430455, -3.4015568870256905, 3.4329940850643537, -48.84615169064229, 16.440341157939084, -133.52577887461615, -113.92366746564376, -91.9377638635205, -0.4870705118911727, -192.19443830688397, -94.5574853547773, -26.234009415622268, -205.0918014160197, -44.02447014288228, -40.007697913902014, -146.53745986617946, -9.465465549194787, -23.18786735002204, -161.5082350100705, -126.94745850065695, -82.61198514701303, -108.78942125539518, -20.636289185591835, -89.019655108047, -2.7996556090154217, -138.22335062318433, -95.79456317756483, 15.995124035838856, -132.49937817910984, -273.60037964924334, -6.303513469759059, -110.032196188979, 10.65152260555074, -3.7147349561249023, 12.945710737933707, -88.06447210492092, -137.1332022376762, -55.692891751387215, -131.7150176359915, -201.175557179454, -129.9927260786663, -5.100316149281373, -8.164243471155196, 9.241492719124546, -80.41767314372797, -2.1580459067905995, 10.8924921110484, -24.733375517288277, -23.458071642948866, -44.52368689415466, -106.03134439582888, 9.346814668598856, -75.66432347867104, -109.68659921704283, -40.582777703807395, -89.26661830059702, -62.23113607920749, -202.78689297201362, -173.69500088148604, -17.02915652290918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29368056893498257, "mean_inference_ms": 0.9079899750049298, "mean_action_processing_ms": 0.16291806027645722, "mean_env_wait_ms": 2.129533214453981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005877017974853516, "StateBufferConnector_ms": 0.004076719284057617, "ViewRequirementAgentConnector_ms": 0.10272407531738281}, "num_episodes": 59, "episode_return_max": 16.440341157939084, "episode_return_min": -542.4729798306512, "episode_return_mean": -76.21651939998266, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.1656407679154, "num_env_steps_trained_throughput_per_sec": 279.1656407679154, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 13990.975, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13990.899, "sample_time_ms": 2959.833, "learn_time_ms": 11014.003, "learn_throughput": 363.174, "synch_weights_time_ms": 15.811}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "64a97_00000", "date": "2024-07-26_23-18-48", "timestamp": 1722016128, "time_this_iter_s": 14.336287021636963, "time_total_s": 807.7362473011017, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7063b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 807.7362473011017, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 10.555, "ram_util_percent": 28.705000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.605966338018575, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.2592086249758722, "policy_loss": -0.006474406007328071, "vf_loss": 0.2553994756968071, "vf_explained_var": 0.9992263104766608, "kl": 0.010805108924735914, "entropy": 0.06566175331536214, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": 15.995124035838856, "episode_reward_min": -273.60037964924334, "episode_reward_mean": -68.20759456732436, "episode_len_mean": 64.49, "episode_media": {}, "episodes_timesteps_total": 6449, "policy_reward_min": {"policy_0": -273.60037964924334}, "policy_reward_max": {"policy_0": 15.995124035838856}, "policy_reward_mean": {"policy_0": -68.20759456732436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7996556090154217, -138.22335062318433, -95.79456317756483, 15.995124035838856, -132.49937817910984, -273.60037964924334, -6.303513469759059, -110.032196188979, 10.65152260555074, -3.7147349561249023, 12.945710737933707, -88.06447210492092, -137.1332022376762, -55.692891751387215, -131.7150176359915, -201.175557179454, -129.9927260786663, -5.100316149281373, -8.164243471155196, 9.241492719124546, -80.41767314372797, -2.1580459067905995, 10.8924921110484, -24.733375517288277, -23.458071642948866, -44.52368689415466, -106.03134439582888, 9.346814668598856, -75.66432347867104, -109.68659921704283, -40.582777703807395, -89.26661830059702, -62.23113607920749, -202.78689297201362, -173.69500088148604, -17.02915652290918, -91.40519628915517, -11.990049855569305, -65.56580235236967, 6.375573875489743, -25.59757005271298, -208.24492806809798, 3.4002319478108096, -98.85180317324537, -67.8134290629239, -25.158499183877222, -93.92425926228997, -96.14119772563043, -7.753049982076716, -148.10818160166625, 1.5755187480063182, -68.57695573740763, -88.51620645279988, -18.137548615457607, -68.47945340074195, -61.27045686384801, -142.3950632130159, 5.809797309948976, -82.36991315858405, -86.80983306837982, -92.50940753042477, 15.616664355511235, -26.639128084680127, -108.1363318311688, -21.043027311128586, -94.49189099422796, -155.6040795768134, 3.8648320178699547, -7.262808769762756, -146.67666071458638, -82.54947158766356, -124.87106574573153, -22.0591667759285, -16.33166083440053, -30.654542434532964, -34.61765067023897, -157.83720572615803, 15.468073905448279, 4.576250435610602, -103.57480285311539, -9.062510924443064, -186.28411346862651, -71.64212308295767, -16.509740597453554, -0.796890676082409, -91.36578902087089, -20.266265321238002, -39.24160135286857, -68.63204725269232, -154.76680728334807, 4.001260730795489, -26.07824854658385, -17.2073514452457, -98.47048880312222, 3.0420107392623494, -249.1712662321158, -182.77615288764733, -59.31621227407528, -141.920248961096, -165.81576986741933], "episode_lengths": [48, 84, 61, 28, 82, 100, 44, 86, 38, 46, 33, 83, 94, 63, 88, 99, 78, 46, 47, 36, 81, 43, 32, 58, 56, 63, 76, 40, 65, 88, 60, 83, 61, 96, 97, 55, 67, 52, 75, 40, 46, 97, 46, 70, 64, 51, 69, 78, 48, 97, 44, 65, 68, 51, 66, 60, 88, 43, 67, 70, 78, 37, 50, 73, 58, 84, 91, 43, 53, 82, 67, 79, 50, 47, 58, 52, 86, 30, 37, 73, 45, 92, 63, 58, 41, 69, 46, 57, 71, 96, 45, 57, 51, 83, 34, 113, 102, 60, 84, 94], "policy_policy_0_reward": [-2.7996556090154217, -138.22335062318433, -95.79456317756483, 15.995124035838856, -132.49937817910984, -273.60037964924334, -6.303513469759059, -110.032196188979, 10.65152260555074, -3.7147349561249023, 12.945710737933707, -88.06447210492092, -137.1332022376762, -55.692891751387215, -131.7150176359915, -201.175557179454, -129.9927260786663, -5.100316149281373, -8.164243471155196, 9.241492719124546, -80.41767314372797, -2.1580459067905995, 10.8924921110484, -24.733375517288277, -23.458071642948866, -44.52368689415466, -106.03134439582888, 9.346814668598856, -75.66432347867104, -109.68659921704283, -40.582777703807395, -89.26661830059702, -62.23113607920749, -202.78689297201362, -173.69500088148604, -17.02915652290918, -91.40519628915517, -11.990049855569305, -65.56580235236967, 6.375573875489743, -25.59757005271298, -208.24492806809798, 3.4002319478108096, -98.85180317324537, -67.8134290629239, -25.158499183877222, -93.92425926228997, -96.14119772563043, -7.753049982076716, -148.10818160166625, 1.5755187480063182, -68.57695573740763, -88.51620645279988, -18.137548615457607, -68.47945340074195, -61.27045686384801, -142.3950632130159, 5.809797309948976, -82.36991315858405, -86.80983306837982, -92.50940753042477, 15.616664355511235, -26.639128084680127, -108.1363318311688, -21.043027311128586, -94.49189099422796, -155.6040795768134, 3.8648320178699547, -7.262808769762756, -146.67666071458638, -82.54947158766356, -124.87106574573153, -22.0591667759285, -16.33166083440053, -30.654542434532964, -34.61765067023897, -157.83720572615803, 15.468073905448279, 4.576250435610602, -103.57480285311539, -9.062510924443064, -186.28411346862651, -71.64212308295767, -16.509740597453554, -0.796890676082409, -91.36578902087089, -20.266265321238002, -39.24160135286857, -68.63204725269232, -154.76680728334807, 4.001260730795489, -26.07824854658385, -17.2073514452457, -98.47048880312222, 3.0420107392623494, -249.1712662321158, -182.77615288764733, -59.31621227407528, -141.920248961096, -165.81576986741933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936170440553491, "mean_inference_ms": 0.9077283513258874, "mean_action_processing_ms": 0.16297261925563095, "mean_env_wait_ms": 2.1309216187314086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005826234817504883, "StateBufferConnector_ms": 0.004134178161621094, "ViewRequirementAgentConnector_ms": 0.10320186614990234}, "num_episodes": 64, "episode_return_max": 15.995124035838856, "episode_return_min": -273.60037964924334, "episode_return_mean": -68.20759456732436, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.0842013560153, "num_env_steps_trained_throughput_per_sec": 268.0842013560153, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 14036.158, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14036.08, "sample_time_ms": 2962.529, "learn_time_ms": 11056.652, "learn_throughput": 361.773, "synch_weights_time_ms": 15.636}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "64a97_00000", "date": "2024-07-26_23-19-03", "timestamp": 1722016143, "time_this_iter_s": 14.929730415344238, "time_total_s": 822.6659777164459, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7349d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 822.6659777164459, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 10.259090909090908, "ram_util_percent": 28.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.02335204233726, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.2515251556915852, "policy_loss": -0.0024261765696185953, "vf_loss": 0.23342003552243112, "vf_explained_var": 0.9994035956760248, "kl": 0.02070266503463551, "entropy": 0.04301518689947746, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 20.069104364649686, "episode_reward_min": -249.1712662321158, "episode_reward_mean": -70.83703126019205, "episode_len_mean": 64.91, "episode_media": {}, "episodes_timesteps_total": 6491, "policy_reward_min": {"policy_0": -249.1712662321158}, "policy_reward_max": {"policy_0": 20.069104364649686}, "policy_reward_mean": {"policy_0": -70.83703126019205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.639128084680127, -108.1363318311688, -21.043027311128586, -94.49189099422796, -155.6040795768134, 3.8648320178699547, -7.262808769762756, -146.67666071458638, -82.54947158766356, -124.87106574573153, -22.0591667759285, -16.33166083440053, -30.654542434532964, -34.61765067023897, -157.83720572615803, 15.468073905448279, 4.576250435610602, -103.57480285311539, -9.062510924443064, -186.28411346862651, -71.64212308295767, -16.509740597453554, -0.796890676082409, -91.36578902087089, -20.266265321238002, -39.24160135286857, -68.63204725269232, -154.76680728334807, 4.001260730795489, -26.07824854658385, -17.2073514452457, -98.47048880312222, 3.0420107392623494, -249.1712662321158, -182.77615288764733, -59.31621227407528, -141.920248961096, -165.81576986741933, -19.491922739159243, -94.43214466577967, -185.92465486946475, -59.91708716602455, -20.65260434311508, 5.6755146387060345, -71.67768507239116, -39.98997879725073, -1.5559706659863568, -125.48837757866603, 1.7252433956131643, -162.21876872653246, 3.1102443334426075, -158.80604950543474, -121.45066640536868, -146.13897935416836, -123.30146883163252, -181.43903766923728, -13.633192725026612, -19.604526197829173, -10.608519780463318, -117.95638071514634, -134.26364883644518, -106.94324181835752, -67.39122773410904, -116.19109027967815, -119.39990561610162, -65.97014721858321, -74.00214856140133, -41.471637838084916, -93.9173749666489, -89.44185998520153, -35.42562191591075, -182.9528188711034, 8.326192200896656, -66.22015612614494, -0.4353087357759484, 0.6302062612575372, -80.55818762902126, -13.349931984953473, -160.05569487824476, -49.24319827620522, -83.9096605494433, -217.78181154546016, -98.48363525892499, -36.79257139284754, -30.35788195967902, -106.87759001158872, -48.28001870559673, 6.7215271808792565, -44.032073486835394, -59.28005248310861, -89.2666499783326, -1.858389605684697, 20.069104364649686, -82.56911905000113, -146.01398305079752, -29.534161013661603, -66.13143278465309, -112.22677455636524, -14.832057002037654, 10.508615200054724], "episode_lengths": [50, 73, 58, 84, 91, 43, 53, 82, 67, 79, 50, 47, 58, 52, 86, 30, 37, 73, 45, 92, 63, 58, 41, 69, 46, 57, 71, 96, 45, 57, 51, 83, 34, 113, 102, 60, 84, 94, 47, 78, 90, 62, 48, 43, 65, 52, 46, 76, 35, 85, 42, 98, 89, 83, 77, 97, 46, 58, 52, 87, 88, 73, 67, 75, 76, 62, 69, 53, 77, 71, 55, 99, 43, 75, 40, 40, 67, 45, 85, 60, 67, 102, 86, 62, 51, 87, 59, 34, 55, 59, 66, 43, 31, 69, 89, 52, 66, 88, 42, 33], "policy_policy_0_reward": [-26.639128084680127, -108.1363318311688, -21.043027311128586, -94.49189099422796, -155.6040795768134, 3.8648320178699547, -7.262808769762756, -146.67666071458638, -82.54947158766356, -124.87106574573153, -22.0591667759285, -16.33166083440053, -30.654542434532964, -34.61765067023897, -157.83720572615803, 15.468073905448279, 4.576250435610602, -103.57480285311539, -9.062510924443064, -186.28411346862651, -71.64212308295767, -16.509740597453554, -0.796890676082409, -91.36578902087089, -20.266265321238002, -39.24160135286857, -68.63204725269232, -154.76680728334807, 4.001260730795489, -26.07824854658385, -17.2073514452457, -98.47048880312222, 3.0420107392623494, -249.1712662321158, -182.77615288764733, -59.31621227407528, -141.920248961096, -165.81576986741933, -19.491922739159243, -94.43214466577967, -185.92465486946475, -59.91708716602455, -20.65260434311508, 5.6755146387060345, -71.67768507239116, -39.98997879725073, -1.5559706659863568, -125.48837757866603, 1.7252433956131643, -162.21876872653246, 3.1102443334426075, -158.80604950543474, -121.45066640536868, -146.13897935416836, -123.30146883163252, -181.43903766923728, -13.633192725026612, -19.604526197829173, -10.608519780463318, -117.95638071514634, -134.26364883644518, -106.94324181835752, -67.39122773410904, -116.19109027967815, -119.39990561610162, -65.97014721858321, -74.00214856140133, -41.471637838084916, -93.9173749666489, -89.44185998520153, -35.42562191591075, -182.9528188711034, 8.326192200896656, -66.22015612614494, -0.4353087357759484, 0.6302062612575372, -80.55818762902126, -13.349931984953473, -160.05569487824476, -49.24319827620522, -83.9096605494433, -217.78181154546016, -98.48363525892499, -36.79257139284754, -30.35788195967902, -106.87759001158872, -48.28001870559673, 6.7215271808792565, -44.032073486835394, -59.28005248310861, -89.2666499783326, -1.858389605684697, 20.069104364649686, -82.56911905000113, -146.01398305079752, -29.534161013661603, -66.13143278465309, -112.22677455636524, -14.832057002037654, 10.508615200054724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29341642120794353, "mean_inference_ms": 0.9079409602378967, "mean_action_processing_ms": 0.16305067551776609, "mean_env_wait_ms": 2.131857860497744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005923271179199219, "StateBufferConnector_ms": 0.004031181335449219, "ViewRequirementAgentConnector_ms": 0.10098052024841309}, "num_episodes": 62, "episode_return_max": 20.069104364649686, "episode_return_min": -249.1712662321158, "episode_return_mean": -70.83703126019205, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.58143083399005, "num_env_steps_trained_throughput_per_sec": 270.58143083399005, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 14173.242, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14173.163, "sample_time_ms": 2964.282, "learn_time_ms": 11191.954, "learn_throughput": 357.4, "synch_weights_time_ms": 15.653}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "64a97_00000", "date": "2024-07-26_23-19-18", "timestamp": 1722016158, "time_this_iter_s": 14.789923191070557, "time_total_s": 837.4559009075165, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb734820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.4559009075165, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 10.290476190476191, "ram_util_percent": 28.742857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.093249097963174, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.20768580066699846, "policy_loss": -0.01143547395428565, "vf_loss": 0.20726272493290404, "vf_explained_var": 0.9995883809402585, "kl": 0.008189126246361441, "entropy": 0.057868516645976344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 20.069104364649686, "episode_reward_min": -223.84721268922505, "episode_reward_mean": -70.70565833980412, "episode_len_mean": 64.91, "episode_media": {}, "episodes_timesteps_total": 6491, "policy_reward_min": {"policy_0": -223.84721268922505}, "policy_reward_max": {"policy_0": 20.069104364649686}, "policy_reward_mean": {"policy_0": -70.70565833980412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.26364883644518, -106.94324181835752, -67.39122773410904, -116.19109027967815, -119.39990561610162, -65.97014721858321, -74.00214856140133, -41.471637838084916, -93.9173749666489, -89.44185998520153, -35.42562191591075, -182.9528188711034, 8.326192200896656, -66.22015612614494, -0.4353087357759484, 0.6302062612575372, -80.55818762902126, -13.349931984953473, -160.05569487824476, -49.24319827620522, -83.9096605494433, -217.78181154546016, -98.48363525892499, -36.79257139284754, -30.35788195967902, -106.87759001158872, -48.28001870559673, 6.7215271808792565, -44.032073486835394, -59.28005248310861, -89.2666499783326, -1.858389605684697, 20.069104364649686, -82.56911905000113, -146.01398305079752, -29.534161013661603, -66.13143278465309, -112.22677455636524, -14.832057002037654, 10.508615200054724, -97.9696556267329, -28.167198951228173, -128.64292946686206, -160.5074947792134, -8.96098801041728, -101.1028575782004, -77.80186573874992, -44.29818463524927, -27.57278392319816, -100.1493767010278, -34.513668569439616, -103.50931064263908, -140.3285742122861, -78.65761529915143, -17.211603185162495, -129.25092280175514, -140.6903573755975, -82.85150305169348, -82.05245967966772, -45.99125710338463, -70.44104671773385, -59.181333053474745, -110.56516120231743, 5.796077364122995, -19.536550993711323, -47.88371539974169, -49.72651937443779, -4.882101221600103, -62.193548282528226, -90.3797432870686, -10.020105242804199, -113.67896012569925, -197.80139187788131, -17.539907962901477, -79.6053170298483, -51.46094158015924, -11.375760347876314, -74.43798996313174, -32.15427047043956, 0.703441732206695, 3.3526784526485875, -181.08778583468495, -60.523622730712965, -117.72425187777672, -83.61846149071742, -70.4259539748617, -97.97709253454217, -136.08773444678963, 2.2817237669318846, -33.33462574317949, -58.978444039370025, 12.230246034922262, -173.45176542079207, -142.54217963839795, -74.5897069350825, -223.84721268922505, -45.860825369041144, -36.53263879198416, -40.87755212817198, -65.16975772165061], "episode_lengths": [88, 73, 67, 75, 76, 62, 69, 53, 77, 71, 55, 99, 43, 75, 40, 40, 67, 45, 85, 60, 67, 102, 86, 62, 51, 87, 59, 34, 55, 59, 66, 43, 31, 69, 89, 52, 66, 88, 42, 33, 72, 55, 79, 94, 50, 86, 65, 58, 48, 73, 57, 84, 82, 68, 48, 74, 95, 68, 67, 63, 78, 55, 74, 32, 57, 61, 63, 40, 63, 68, 39, 82, 95, 50, 65, 56, 43, 63, 59, 46, 38, 97, 60, 76, 67, 67, 74, 80, 38, 58, 59, 31, 89, 91, 80, 105, 56, 60, 63, 66], "policy_policy_0_reward": [-134.26364883644518, -106.94324181835752, -67.39122773410904, -116.19109027967815, -119.39990561610162, -65.97014721858321, -74.00214856140133, -41.471637838084916, -93.9173749666489, -89.44185998520153, -35.42562191591075, -182.9528188711034, 8.326192200896656, -66.22015612614494, -0.4353087357759484, 0.6302062612575372, -80.55818762902126, -13.349931984953473, -160.05569487824476, -49.24319827620522, -83.9096605494433, -217.78181154546016, -98.48363525892499, -36.79257139284754, -30.35788195967902, -106.87759001158872, -48.28001870559673, 6.7215271808792565, -44.032073486835394, -59.28005248310861, -89.2666499783326, -1.858389605684697, 20.069104364649686, -82.56911905000113, -146.01398305079752, -29.534161013661603, -66.13143278465309, -112.22677455636524, -14.832057002037654, 10.508615200054724, -97.9696556267329, -28.167198951228173, -128.64292946686206, -160.5074947792134, -8.96098801041728, -101.1028575782004, -77.80186573874992, -44.29818463524927, -27.57278392319816, -100.1493767010278, -34.513668569439616, -103.50931064263908, -140.3285742122861, -78.65761529915143, -17.211603185162495, -129.25092280175514, -140.6903573755975, -82.85150305169348, -82.05245967966772, -45.99125710338463, -70.44104671773385, -59.181333053474745, -110.56516120231743, 5.796077364122995, -19.536550993711323, -47.88371539974169, -49.72651937443779, -4.882101221600103, -62.193548282528226, -90.3797432870686, -10.020105242804199, -113.67896012569925, -197.80139187788131, -17.539907962901477, -79.6053170298483, -51.46094158015924, -11.375760347876314, -74.43798996313174, -32.15427047043956, 0.703441732206695, 3.3526784526485875, -181.08778583468495, -60.523622730712965, -117.72425187777672, -83.61846149071742, -70.4259539748617, -97.97709253454217, -136.08773444678963, 2.2817237669318846, -33.33462574317949, -58.978444039370025, 12.230246034922262, -173.45176542079207, -142.54217963839795, -74.5897069350825, -223.84721268922505, -45.860825369041144, -36.53263879198416, -40.87755212817198, -65.16975772165061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934539190629384, "mean_inference_ms": 0.9082296836291849, "mean_action_processing_ms": 0.163054978556952, "mean_env_wait_ms": 2.1326398460397344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005835056304931641, "StateBufferConnector_ms": 0.0040166378021240234, "ViewRequirementAgentConnector_ms": 0.10127735137939453}, "num_episodes": 60, "episode_return_max": 20.069104364649686, "episode_return_min": -223.84721268922505, "episode_return_mean": -70.70565833980412, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.7918499823727, "num_env_steps_trained_throughput_per_sec": 263.7918499823727, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 14207.741, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14207.666, "sample_time_ms": 2956.833, "learn_time_ms": 11234.212, "learn_throughput": 356.055, "synch_weights_time_ms": 15.363}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "64a97_00000", "date": "2024-07-26_23-19-33", "timestamp": 1722016173, "time_this_iter_s": 15.170895338058472, "time_total_s": 852.626796245575, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 852.626796245575, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.447619047619048, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.8277714724342, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.20896669947057187, "policy_loss": -0.006270545277705726, "vf_loss": 0.20084505428094418, "vf_explained_var": 0.9995932085439563, "kl": 0.009595027072403657, "entropy": 0.0180254783675385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 15.842813243313564, "episode_reward_min": -237.70463617872835, "episode_reward_mean": -61.398416482383446, "episode_len_mean": 61.81, "episode_media": {}, "episodes_timesteps_total": 6181, "policy_reward_min": {"policy_0": -237.70463617872835}, "policy_reward_max": {"policy_0": 15.842813243313564}, "policy_reward_mean": {"policy_0": -61.398416482383446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.193548282528226, -90.3797432870686, -10.020105242804199, -113.67896012569925, -197.80139187788131, -17.539907962901477, -79.6053170298483, -51.46094158015924, -11.375760347876314, -74.43798996313174, -32.15427047043956, 0.703441732206695, 3.3526784526485875, -181.08778583468495, -60.523622730712965, -117.72425187777672, -83.61846149071742, -70.4259539748617, -97.97709253454217, -136.08773444678963, 2.2817237669318846, -33.33462574317949, -58.978444039370025, 12.230246034922262, -173.45176542079207, -142.54217963839795, -74.5897069350825, -223.84721268922505, -45.860825369041144, -36.53263879198416, -40.87755212817198, -65.16975772165061, -237.70463617872835, -97.36562014431308, -38.013133029667465, -77.34011580331881, -37.86624602382678, -70.32939963891849, -101.5655807798286, -72.22928449019177, -177.91354731700952, 4.535295075895084, -71.70247847534932, -7.3891568707551265, -89.36364758937405, -107.9519994417045, -18.909575897254115, 4.42835421720393, 6.966069996396698, -12.22891669357459, -22.7043190962865, -10.74026336791046, -79.78983248222133, -2.8099595307084906, -27.50873036862748, -168.296749064001, -165.39398597372113, -57.09351661259477, -15.22479060429749, -25.187547585603987, 10.67434483389571, -157.86989816790114, -17.770881386201847, -104.43456632610001, -11.165212747936444, -189.32750813095973, -8.901977595648605, -4.755786260801582, -75.30334155899075, -33.82094174090283, 12.971336357914826, -23.01779472596598, -82.42605380065139, -53.576460929508244, 15.842813243313564, -15.554538541011658, -75.73118563431017, -6.86360542324382, -115.54304980657778, -40.48566720747535, -53.937371083044866, -29.22034632066475, -94.38883865266564, -32.84091236753304, -66.66789114561978, -33.070630196445926, -49.816307204167835, 11.696230356455294, -3.5889359195640047, -6.857179020978147, -88.6539073919969, -18.060221830682877, -25.397852345392618, 3.489560088864657, -120.04033808289756, -216.7544068829861, -133.0032950258215, -60.26694701019612, 11.354687109463525, -15.353998442506118], "episode_lengths": [63, 68, 39, 82, 95, 50, 65, 56, 43, 63, 59, 46, 38, 97, 60, 76, 67, 67, 74, 80, 38, 58, 59, 31, 89, 91, 80, 105, 56, 60, 63, 66, 109, 71, 51, 67, 57, 65, 68, 79, 101, 33, 79, 43, 69, 85, 51, 39, 39, 45, 56, 46, 67, 45, 60, 90, 86, 59, 54, 52, 35, 93, 56, 87, 45, 92, 50, 43, 69, 56, 30, 55, 69, 58, 34, 57, 67, 38, 75, 61, 60, 56, 70, 56, 63, 54, 55, 32, 47, 48, 66, 46, 59, 38, 76, 100, 92, 62, 37, 44], "policy_policy_0_reward": [-62.193548282528226, -90.3797432870686, -10.020105242804199, -113.67896012569925, -197.80139187788131, -17.539907962901477, -79.6053170298483, -51.46094158015924, -11.375760347876314, -74.43798996313174, -32.15427047043956, 0.703441732206695, 3.3526784526485875, -181.08778583468495, -60.523622730712965, -117.72425187777672, -83.61846149071742, -70.4259539748617, -97.97709253454217, -136.08773444678963, 2.2817237669318846, -33.33462574317949, -58.978444039370025, 12.230246034922262, -173.45176542079207, -142.54217963839795, -74.5897069350825, -223.84721268922505, -45.860825369041144, -36.53263879198416, -40.87755212817198, -65.16975772165061, -237.70463617872835, -97.36562014431308, -38.013133029667465, -77.34011580331881, -37.86624602382678, -70.32939963891849, -101.5655807798286, -72.22928449019177, -177.91354731700952, 4.535295075895084, -71.70247847534932, -7.3891568707551265, -89.36364758937405, -107.9519994417045, -18.909575897254115, 4.42835421720393, 6.966069996396698, -12.22891669357459, -22.7043190962865, -10.74026336791046, -79.78983248222133, -2.8099595307084906, -27.50873036862748, -168.296749064001, -165.39398597372113, -57.09351661259477, -15.22479060429749, -25.187547585603987, 10.67434483389571, -157.86989816790114, -17.770881386201847, -104.43456632610001, -11.165212747936444, -189.32750813095973, -8.901977595648605, -4.755786260801582, -75.30334155899075, -33.82094174090283, 12.971336357914826, -23.01779472596598, -82.42605380065139, -53.576460929508244, 15.842813243313564, -15.554538541011658, -75.73118563431017, -6.86360542324382, -115.54304980657778, -40.48566720747535, -53.937371083044866, -29.22034632066475, -94.38883865266564, -32.84091236753304, -66.66789114561978, -33.070630196445926, -49.816307204167835, 11.696230356455294, -3.5889359195640047, -6.857179020978147, -88.6539073919969, -18.060221830682877, -25.397852345392618, 3.489560088864657, -120.04033808289756, -216.7544068829861, -133.0032950258215, -60.26694701019612, 11.354687109463525, -15.353998442506118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29355934249217214, "mean_inference_ms": 0.9080570673020745, "mean_action_processing_ms": 0.16302593347211938, "mean_env_wait_ms": 2.134112663779356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005811452865600586, "StateBufferConnector_ms": 0.0041408538818359375, "ViewRequirementAgentConnector_ms": 0.10304689407348633}, "num_episodes": 68, "episode_return_max": 15.842813243313564, "episode_return_min": -237.70463617872835, "episode_return_mean": -61.398416482383446, "episodes_this_iter": 68}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.21786532958566, "num_env_steps_trained_throughput_per_sec": 361.21786532958566, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 13971.895, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13971.821, "sample_time_ms": 2940.438, "learn_time_ms": 11014.713, "learn_throughput": 363.151, "synch_weights_time_ms": 15.407}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "64a97_00000", "date": "2024-07-26_23-19-44", "timestamp": 1722016184, "time_this_iter_s": 11.081458568572998, "time_total_s": 863.708254814148, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 863.708254814148, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 11.325, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.91241604735454, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.2222539823531406, "policy_loss": -0.007671308523276821, "vf_loss": 0.2121872556473439, "vf_explained_var": 0.9995964483047525, "kl": 0.011166964804457814, "entropy": -0.0778207747338456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": 15.842813243313564, "episode_reward_min": -216.7544068829861, "episode_reward_mean": -60.37844254896365, "episode_len_mean": 62.23, "episode_media": {}, "episodes_timesteps_total": 6223, "policy_reward_min": {"policy_0": -216.7544068829861}, "policy_reward_max": {"policy_0": 15.842813243313564}, "policy_reward_mean": {"policy_0": -60.37844254896365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.67434483389571, -157.86989816790114, -17.770881386201847, -104.43456632610001, -11.165212747936444, -189.32750813095973, -8.901977595648605, -4.755786260801582, -75.30334155899075, -33.82094174090283, 12.971336357914826, -23.01779472596598, -82.42605380065139, -53.576460929508244, 15.842813243313564, -15.554538541011658, -75.73118563431017, -6.86360542324382, -115.54304980657778, -40.48566720747535, -53.937371083044866, -29.22034632066475, -94.38883865266564, -32.84091236753304, -66.66789114561978, -33.070630196445926, -49.816307204167835, 11.696230356455294, -3.5889359195640047, -6.857179020978147, -88.6539073919969, -18.060221830682877, -25.397852345392618, 3.489560088864657, -120.04033808289756, -216.7544068829861, -133.0032950258215, -60.26694701019612, 11.354687109463525, -15.353998442506118, -137.50887776900063, -178.52730922615848, -13.603232932024113, 2.526234179298435, -183.71276012582857, -66.28956842266221, -101.61014584680316, -79.85114005699525, -50.70392473146973, 13.234727441034526, -96.16223446532392, -103.53040176873883, 3.154637052235074, -45.2002488786869, -3.575021604363744, -38.56762571447231, -67.7846043265084, -159.589946243867, 5.879204270239239, -14.673383315020919, -27.40850632614692, -15.789241994112128, 1.0061582656542465, -152.4763069042761, -99.6193045832933, 8.050583721862143, -67.72270650507379, -36.09026116980501, -48.857520398481256, -49.881160422239134, -56.81567421868248, -130.49978958688513, -171.4044114898962, -83.35827694540917, -40.02301117362295, -119.24892834166596, -25.369516825854966, -15.70427268775074, -128.94488379837355, 12.242769727618363, -198.99494122020496, -199.34547672728021, -157.60148906110868, -100.52440488467813, -31.854085629880984, -38.98939548853779, 13.617208713998949, -19.01312426375803, -74.75115683160963, -75.03359993258556, -101.51192781127196, -103.36328239808854, -0.07126506870163052, -50.43917005896213, -79.9202117438887, -43.89612492100449, -4.8606916328452865, -80.77383914149537, -10.306115594498296, -117.76240014096881], "episode_lengths": [35, 93, 56, 87, 45, 92, 50, 43, 69, 56, 30, 55, 69, 58, 34, 57, 67, 38, 75, 61, 60, 56, 70, 56, 63, 54, 55, 32, 47, 48, 66, 46, 59, 38, 76, 100, 92, 62, 37, 44, 81, 88, 47, 48, 92, 66, 66, 70, 63, 33, 74, 82, 34, 62, 46, 63, 64, 85, 40, 56, 57, 44, 49, 88, 72, 36, 68, 58, 63, 57, 61, 84, 100, 69, 61, 90, 58, 46, 89, 38, 102, 95, 84, 86, 59, 61, 32, 49, 73, 68, 75, 86, 44, 58, 69, 63, 43, 65, 44, 88], "policy_policy_0_reward": [10.67434483389571, -157.86989816790114, -17.770881386201847, -104.43456632610001, -11.165212747936444, -189.32750813095973, -8.901977595648605, -4.755786260801582, -75.30334155899075, -33.82094174090283, 12.971336357914826, -23.01779472596598, -82.42605380065139, -53.576460929508244, 15.842813243313564, -15.554538541011658, -75.73118563431017, -6.86360542324382, -115.54304980657778, -40.48566720747535, -53.937371083044866, -29.22034632066475, -94.38883865266564, -32.84091236753304, -66.66789114561978, -33.070630196445926, -49.816307204167835, 11.696230356455294, -3.5889359195640047, -6.857179020978147, -88.6539073919969, -18.060221830682877, -25.397852345392618, 3.489560088864657, -120.04033808289756, -216.7544068829861, -133.0032950258215, -60.26694701019612, 11.354687109463525, -15.353998442506118, -137.50887776900063, -178.52730922615848, -13.603232932024113, 2.526234179298435, -183.71276012582857, -66.28956842266221, -101.61014584680316, -79.85114005699525, -50.70392473146973, 13.234727441034526, -96.16223446532392, -103.53040176873883, 3.154637052235074, -45.2002488786869, -3.575021604363744, -38.56762571447231, -67.7846043265084, -159.589946243867, 5.879204270239239, -14.673383315020919, -27.40850632614692, -15.789241994112128, 1.0061582656542465, -152.4763069042761, -99.6193045832933, 8.050583721862143, -67.72270650507379, -36.09026116980501, -48.857520398481256, -49.881160422239134, -56.81567421868248, -130.49978958688513, -171.4044114898962, -83.35827694540917, -40.02301117362295, -119.24892834166596, -25.369516825854966, -15.70427268775074, -128.94488379837355, 12.242769727618363, -198.99494122020496, -199.34547672728021, -157.60148906110868, -100.52440488467813, -31.854085629880984, -38.98939548853779, 13.617208713998949, -19.01312426375803, -74.75115683160963, -75.03359993258556, -101.51192781127196, -103.36328239808854, -0.07126506870163052, -50.43917005896213, -79.9202117438887, -43.89612492100449, -4.8606916328452865, -80.77383914149537, -10.306115594498296, -117.76240014096881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293552429567549, "mean_inference_ms": 0.9077785305111783, "mean_action_processing_ms": 0.16299306644715605, "mean_env_wait_ms": 2.1349530166380517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005568981170654297, "StateBufferConnector_ms": 0.004051923751831055, "ViewRequirementAgentConnector_ms": 0.10172033309936523}, "num_episodes": 60, "episode_return_max": 15.842813243313564, "episode_return_min": -216.7544068829861, "episode_return_mean": -60.37844254896365, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.2281958930265, "num_env_steps_trained_throughput_per_sec": 423.2281958930265, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 13535.025, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13534.947, "sample_time_ms": 2946.161, "learn_time_ms": 10572.592, "learn_throughput": 378.337, "synch_weights_time_ms": 14.95}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "64a97_00000", "date": "2024-07-26_23-19-53", "timestamp": 1722016193, "time_this_iter_s": 9.457143783569336, "time_total_s": 873.1653985977173, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 873.1653985977173, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 12.164285714285713, "ram_util_percent": 28.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.382002615431944, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1927939624870002, "policy_loss": -0.008033404664699144, "vf_loss": 0.186116290356343, "vf_explained_var": 0.9996607072651387, "kl": 0.009552211108772746, "entropy": -0.020365624057497676, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 22.323091064133617, "episode_reward_min": -214.48534491072394, "episode_reward_mean": -70.41507028506048, "episode_len_mean": 65.16, "episode_media": {}, "episodes_timesteps_total": 6516, "policy_reward_min": {"policy_0": -214.48534491072394}, "policy_reward_max": {"policy_0": 22.323091064133617}, "policy_reward_mean": {"policy_0": -70.41507028506048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0061582656542465, -152.4763069042761, -99.6193045832933, 8.050583721862143, -67.72270650507379, -36.09026116980501, -48.857520398481256, -49.881160422239134, -56.81567421868248, -130.49978958688513, -171.4044114898962, -83.35827694540917, -40.02301117362295, -119.24892834166596, -25.369516825854966, -15.70427268775074, -128.94488379837355, 12.242769727618363, -198.99494122020496, -199.34547672728021, -157.60148906110868, -100.52440488467813, -31.854085629880984, -38.98939548853779, 13.617208713998949, -19.01312426375803, -74.75115683160963, -75.03359993258556, -101.51192781127196, -103.36328239808854, -0.07126506870163052, -50.43917005896213, -79.9202117438887, -43.89612492100449, -4.8606916328452865, -80.77383914149537, -10.306115594498296, -117.76240014096881, -17.3517556201981, -83.19394352567369, 14.223684654095047, -26.832931642502512, -50.19534657250712, 22.323091064133617, -109.80862426728265, -6.01831814502134, -36.29521835248417, 14.599124864953872, -63.02220047092094, -107.19534183831402, -81.5103666822482, -54.946878804080434, -153.0758816797724, 13.27899664514395, -61.80670304307758, -65.74988581537409, -144.94539222248073, 3.8803739740465497, -54.645635270411596, -82.76764988134869, -48.45042612914327, -176.44909682259322, -106.48994449004313, -117.50129872799786, -109.04617229971417, -17.342600133263172, -90.683431871967, -65.92645390980981, -194.09076983562386, -64.14631922275092, -11.7480419457715, -196.5955370679373, -102.31386387184297, -135.89381375179153, -190.60848448833912, 3.259224811447694, -84.01039211736015, -62.22940043924198, -125.81073379980162, -141.66977915863504, 7.886340643807527, -176.02502755375906, 9.41435102122312, -5.645586280433617, -9.660633427215824, -85.03739987161619, -64.98991314747049, -56.26063879741625, 2.304267108483338, -118.13708627178102, 7.692069796717117, -96.59487633559594, 10.203403826953394, -214.48534491072394, -42.22792789039576, -2.7446314458959336, -120.72444593534644, 7.139812746205347, -52.36107946015278, -192.33653724458463], "episode_lengths": [49, 88, 72, 36, 68, 58, 63, 57, 61, 84, 100, 69, 61, 90, 58, 46, 89, 38, 102, 95, 84, 86, 59, 61, 32, 49, 73, 68, 75, 86, 44, 58, 69, 63, 43, 65, 44, 88, 53, 67, 31, 58, 55, 28, 76, 38, 52, 32, 61, 73, 69, 63, 84, 31, 60, 75, 84, 36, 58, 67, 55, 96, 74, 78, 75, 53, 70, 65, 97, 73, 54, 102, 86, 91, 102, 39, 82, 73, 81, 84, 35, 95, 37, 45, 41, 83, 77, 58, 37, 75, 44, 80, 35, 89, 50, 43, 77, 37, 63, 103], "policy_policy_0_reward": [1.0061582656542465, -152.4763069042761, -99.6193045832933, 8.050583721862143, -67.72270650507379, -36.09026116980501, -48.857520398481256, -49.881160422239134, -56.81567421868248, -130.49978958688513, -171.4044114898962, -83.35827694540917, -40.02301117362295, -119.24892834166596, -25.369516825854966, -15.70427268775074, -128.94488379837355, 12.242769727618363, -198.99494122020496, -199.34547672728021, -157.60148906110868, -100.52440488467813, -31.854085629880984, -38.98939548853779, 13.617208713998949, -19.01312426375803, -74.75115683160963, -75.03359993258556, -101.51192781127196, -103.36328239808854, -0.07126506870163052, -50.43917005896213, -79.9202117438887, -43.89612492100449, -4.8606916328452865, -80.77383914149537, -10.306115594498296, -117.76240014096881, -17.3517556201981, -83.19394352567369, 14.223684654095047, -26.832931642502512, -50.19534657250712, 22.323091064133617, -109.80862426728265, -6.01831814502134, -36.29521835248417, 14.599124864953872, -63.02220047092094, -107.19534183831402, -81.5103666822482, -54.946878804080434, -153.0758816797724, 13.27899664514395, -61.80670304307758, -65.74988581537409, -144.94539222248073, 3.8803739740465497, -54.645635270411596, -82.76764988134869, -48.45042612914327, -176.44909682259322, -106.48994449004313, -117.50129872799786, -109.04617229971417, -17.342600133263172, -90.683431871967, -65.92645390980981, -194.09076983562386, -64.14631922275092, -11.7480419457715, -196.5955370679373, -102.31386387184297, -135.89381375179153, -190.60848448833912, 3.259224811447694, -84.01039211736015, -62.22940043924198, -125.81073379980162, -141.66977915863504, 7.886340643807527, -176.02502755375906, 9.41435102122312, -5.645586280433617, -9.660633427215824, -85.03739987161619, -64.98991314747049, -56.26063879741625, 2.304267108483338, -118.13708627178102, 7.692069796717117, -96.59487633559594, 10.203403826953394, -214.48534491072394, -42.22792789039576, -2.7446314458959336, -120.72444593534644, 7.139812746205347, -52.36107946015278, -192.33653724458463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293656539513547, "mean_inference_ms": 0.9078337541255772, "mean_action_processing_ms": 0.1630699483719075, "mean_env_wait_ms": 2.1354576516259787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056285858154296875, "StateBufferConnector_ms": 0.004084587097167969, "ViewRequirementAgentConnector_ms": 0.1022193431854248}, "num_episodes": 62, "episode_return_max": 22.323091064133617, "episode_return_min": -214.48534491072394, "episode_return_mean": -70.41507028506048, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.10360787929665, "num_env_steps_trained_throughput_per_sec": 363.10360787929665, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 13449.487, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13449.411, "sample_time_ms": 2932.471, "learn_time_ms": 10500.708, "learn_throughput": 380.927, "synch_weights_time_ms": 14.969}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "64a97_00000", "date": "2024-07-26_23-20-04", "timestamp": 1722016204, "time_this_iter_s": 11.023689031600952, "time_total_s": 884.1890876293182, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 884.1890876293182, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 11.406666666666666, "ram_util_percent": 28.713333333333328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.40055156350136, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1706634523899993, "policy_loss": -0.006991410843329504, "vf_loss": 0.16033535851165653, "vf_explained_var": 0.999717248417437, "kl": 0.010677907248706745, "entropy": -0.1102434354800304, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": 17.373996016899397, "episode_reward_min": -214.48534491072394, "episode_reward_mean": -68.34160965784424, "episode_len_mean": 63.96, "episode_media": {}, "episodes_timesteps_total": 6396, "policy_reward_min": {"policy_0": -214.48534491072394}, "policy_reward_max": {"policy_0": 17.373996016899397}, "policy_reward_mean": {"policy_0": -68.34160965784424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.04617229971417, -17.342600133263172, -90.683431871967, -65.92645390980981, -194.09076983562386, -64.14631922275092, -11.7480419457715, -196.5955370679373, -102.31386387184297, -135.89381375179153, -190.60848448833912, 3.259224811447694, -84.01039211736015, -62.22940043924198, -125.81073379980162, -141.66977915863504, 7.886340643807527, -176.02502755375906, 9.41435102122312, -5.645586280433617, -9.660633427215824, -85.03739987161619, -64.98991314747049, -56.26063879741625, 2.304267108483338, -118.13708627178102, 7.692069796717117, -96.59487633559594, 10.203403826953394, -214.48534491072394, -42.22792789039576, -2.7446314458959336, -120.72444593534644, 7.139812746205347, -52.36107946015278, -192.33653724458463, -63.273066428884384, -80.74756816521604, -12.762268976037447, -14.716391106306885, -9.337057932174744, -22.38349631522874, 0.8397134738204353, -34.618733772382335, -13.148526042971087, 15.581248802054438, -117.81676478888097, -136.43693193090687, -162.5128703971585, 8.417912370073948, -143.3724689019257, -74.21685029818246, -63.13851902671131, 9.248250339740016, 17.373996016899397, -145.92934539222725, -155.6370928296526, -133.87904300604944, -132.75218456009492, -0.05937661726904975, -102.34475113505539, -22.75024438823525, -164.90371998121515, -65.19507949431838, -56.51366349965745, 2.7175280990555573, -34.62596517488697, -100.38741851018725, -131.13655772631222, -101.0044848331546, -10.644722543196384, 11.927066592296486, -11.388994077696557, -103.1979882396236, -5.402905505309082, 7.9638840462046625, -32.02487553071089, -12.013438904538772, -64.16983251344661, -68.85980050829855, -114.75472319215729, -31.900823895600915, -5.521302064503277, -93.24501925417272, -87.1309214608552, -58.102030217966856, -49.685540965570105, -168.91446948312444, 0.8287196030849604, -109.78867872529584, -61.86111017001884, -144.2983527105835, -56.73454169919933, -33.221839601740434, 2.110935261976941, -154.6230675850419, -158.53866995759847, -80.29175211492546, -106.04851616245904, -11.758409543314018], "episode_lengths": [75, 53, 70, 65, 97, 73, 54, 102, 86, 91, 102, 39, 82, 73, 81, 84, 35, 95, 37, 45, 41, 83, 77, 58, 37, 75, 44, 80, 35, 89, 50, 43, 77, 37, 63, 103, 66, 65, 49, 49, 45, 58, 36, 55, 45, 36, 75, 94, 91, 34, 82, 80, 62, 30, 33, 82, 84, 78, 80, 44, 72, 55, 90, 61, 60, 42, 51, 78, 79, 73, 45, 30, 42, 83, 41, 43, 59, 44, 61, 62, 77, 50, 45, 82, 69, 58, 62, 99, 43, 74, 60, 81, 62, 54, 43, 92, 96, 69, 75, 50], "policy_policy_0_reward": [-109.04617229971417, -17.342600133263172, -90.683431871967, -65.92645390980981, -194.09076983562386, -64.14631922275092, -11.7480419457715, -196.5955370679373, -102.31386387184297, -135.89381375179153, -190.60848448833912, 3.259224811447694, -84.01039211736015, -62.22940043924198, -125.81073379980162, -141.66977915863504, 7.886340643807527, -176.02502755375906, 9.41435102122312, -5.645586280433617, -9.660633427215824, -85.03739987161619, -64.98991314747049, -56.26063879741625, 2.304267108483338, -118.13708627178102, 7.692069796717117, -96.59487633559594, 10.203403826953394, -214.48534491072394, -42.22792789039576, -2.7446314458959336, -120.72444593534644, 7.139812746205347, -52.36107946015278, -192.33653724458463, -63.273066428884384, -80.74756816521604, -12.762268976037447, -14.716391106306885, -9.337057932174744, -22.38349631522874, 0.8397134738204353, -34.618733772382335, -13.148526042971087, 15.581248802054438, -117.81676478888097, -136.43693193090687, -162.5128703971585, 8.417912370073948, -143.3724689019257, -74.21685029818246, -63.13851902671131, 9.248250339740016, 17.373996016899397, -145.92934539222725, -155.6370928296526, -133.87904300604944, -132.75218456009492, -0.05937661726904975, -102.34475113505539, -22.75024438823525, -164.90371998121515, -65.19507949431838, -56.51366349965745, 2.7175280990555573, -34.62596517488697, -100.38741851018725, -131.13655772631222, -101.0044848331546, -10.644722543196384, 11.927066592296486, -11.388994077696557, -103.1979882396236, -5.402905505309082, 7.9638840462046625, -32.02487553071089, -12.013438904538772, -64.16983251344661, -68.85980050829855, -114.75472319215729, -31.900823895600915, -5.521302064503277, -93.24501925417272, -87.1309214608552, -58.102030217966856, -49.685540965570105, -168.91446948312444, 0.8287196030849604, -109.78867872529584, -61.86111017001884, -144.2983527105835, -56.73454169919933, -33.221839601740434, 2.110935261976941, -154.6230675850419, -158.53866995759847, -80.29175211492546, -106.04851616245904, -11.758409543314018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29362461656852623, "mean_inference_ms": 0.9075031344445977, "mean_action_processing_ms": 0.1630604043530749, "mean_env_wait_ms": 2.136570174677296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005911588668823242, "StateBufferConnector_ms": 0.004151582717895508, "ViewRequirementAgentConnector_ms": 0.1035928726196289}, "num_episodes": 64, "episode_return_max": 17.373996016899397, "episode_return_min": -214.48534491072394, "episode_return_mean": -68.34160965784424, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.7382865564478, "num_env_steps_trained_throughput_per_sec": 270.7382865564478, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 13455.988, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13455.91, "sample_time_ms": 2939.26, "learn_time_ms": 10500.494, "learn_throughput": 380.934, "synch_weights_time_ms": 14.89}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "64a97_00000", "date": "2024-07-26_23-20-19", "timestamp": 1722016219, "time_this_iter_s": 14.781144857406616, "time_total_s": 898.9702324867249, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb704ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.9702324867249, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 10.476190476190474, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.860121784110866, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1958257645596556, "policy_loss": -0.006235800131980796, "vf_loss": 0.18312725491511325, "vf_explained_var": 0.9997112678984801, "kl": 0.011482374419574658, "entropy": -0.1495454473105686, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 16.6416785177394, "episode_reward_min": -211.437600734583, "episode_reward_mean": -64.34841810020998, "episode_len_mean": 62.58, "episode_media": {}, "episodes_timesteps_total": 6258, "policy_reward_min": {"policy_0": -211.437600734583}, "policy_reward_max": {"policy_0": 16.6416785177394}, "policy_reward_mean": {"policy_0": -64.34841810020998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.7175280990555573, -34.62596517488697, -100.38741851018725, -131.13655772631222, -101.0044848331546, -10.644722543196384, 11.927066592296486, -11.388994077696557, -103.1979882396236, -5.402905505309082, 7.9638840462046625, -32.02487553071089, -12.013438904538772, -64.16983251344661, -68.85980050829855, -114.75472319215729, -31.900823895600915, -5.521302064503277, -93.24501925417272, -87.1309214608552, -58.102030217966856, -49.685540965570105, -168.91446948312444, 0.8287196030849604, -109.78867872529584, -61.86111017001884, -144.2983527105835, -56.73454169919933, -33.221839601740434, 2.110935261976941, -154.6230675850419, -158.53866995759847, -80.29175211492546, -106.04851616245904, -11.758409543314018, -146.16957900542886, 7.122435289806904, -160.350919644263, -85.60490203741894, -75.97389626029316, 8.160037807873378, -138.03229466527085, -85.97381256535945, 15.35478637969198, -9.56643296540856, -54.994501776720725, -89.90918554761636, -45.72835621965254, -132.53151791027327, -73.3724007049232, -211.437600734583, 16.6416785177394, -43.75856469088834, 3.143714480337559, -76.92526771847268, -91.51224255164973, -0.06729030384950452, -198.3114748172173, 7.332221293809623, -33.0061366089954, -24.92533959372965, 7.041376849535851, -123.88136170105055, -106.59104272773101, -14.861890070905876, 7.876249762838043, -130.7556975694834, 11.64157177896147, -92.23454154953632, -1.3033583435996758, -28.447285844076895, -174.83441169415053, -117.58768350888528, -129.36026776473625, -99.05918126430143, -51.318248057779336, 9.842229134562356, 6.793070229158087, -162.00997453363675, -47.98831634471509, -122.17100097562312, -29.976745657322148, 8.035598882443708, -28.215413460823914, -9.825162438726947, -93.21478923703569, -157.9659773271826, -15.72012123565273, -40.79970042291628, -30.98017227841966, -110.45485101523573, -106.19283338030759, -29.286321234235412, 14.068827363957434, -136.14011481197332, -18.610988798205387, -51.0265564859285, -192.07964029417928, -158.0058515710289, 6.88422939855646], "episode_lengths": [42, 51, 78, 79, 73, 45, 30, 42, 83, 41, 43, 59, 44, 61, 62, 77, 50, 45, 82, 69, 58, 62, 99, 43, 74, 60, 81, 62, 54, 43, 92, 96, 69, 75, 50, 82, 41, 86, 69, 65, 34, 87, 68, 29, 49, 66, 81, 63, 79, 74, 97, 35, 62, 33, 74, 69, 41, 93, 33, 61, 57, 37, 77, 75, 47, 44, 79, 34, 70, 43, 58, 88, 84, 87, 70, 61, 42, 39, 88, 63, 78, 52, 46, 54, 49, 85, 84, 53, 51, 60, 88, 74, 50, 34, 89, 48, 59, 93, 83, 40], "policy_policy_0_reward": [2.7175280990555573, -34.62596517488697, -100.38741851018725, -131.13655772631222, -101.0044848331546, -10.644722543196384, 11.927066592296486, -11.388994077696557, -103.1979882396236, -5.402905505309082, 7.9638840462046625, -32.02487553071089, -12.013438904538772, -64.16983251344661, -68.85980050829855, -114.75472319215729, -31.900823895600915, -5.521302064503277, -93.24501925417272, -87.1309214608552, -58.102030217966856, -49.685540965570105, -168.91446948312444, 0.8287196030849604, -109.78867872529584, -61.86111017001884, -144.2983527105835, -56.73454169919933, -33.221839601740434, 2.110935261976941, -154.6230675850419, -158.53866995759847, -80.29175211492546, -106.04851616245904, -11.758409543314018, -146.16957900542886, 7.122435289806904, -160.350919644263, -85.60490203741894, -75.97389626029316, 8.160037807873378, -138.03229466527085, -85.97381256535945, 15.35478637969198, -9.56643296540856, -54.994501776720725, -89.90918554761636, -45.72835621965254, -132.53151791027327, -73.3724007049232, -211.437600734583, 16.6416785177394, -43.75856469088834, 3.143714480337559, -76.92526771847268, -91.51224255164973, -0.06729030384950452, -198.3114748172173, 7.332221293809623, -33.0061366089954, -24.92533959372965, 7.041376849535851, -123.88136170105055, -106.59104272773101, -14.861890070905876, 7.876249762838043, -130.7556975694834, 11.64157177896147, -92.23454154953632, -1.3033583435996758, -28.447285844076895, -174.83441169415053, -117.58768350888528, -129.36026776473625, -99.05918126430143, -51.318248057779336, 9.842229134562356, 6.793070229158087, -162.00997453363675, -47.98831634471509, -122.17100097562312, -29.976745657322148, 8.035598882443708, -28.215413460823914, -9.825162438726947, -93.21478923703569, -157.9659773271826, -15.72012123565273, -40.79970042291628, -30.98017227841966, -110.45485101523573, -106.19283338030759, -29.286321234235412, 14.068827363957434, -136.14011481197332, -18.610988798205387, -51.0265564859285, -192.07964029417928, -158.0058515710289, 6.88422939855646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937187675565064, "mean_inference_ms": 0.9075202967326979, "mean_action_processing_ms": 0.16302409980095947, "mean_env_wait_ms": 2.1382133506967165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005902528762817383, "StateBufferConnector_ms": 0.004080057144165039, "ViewRequirementAgentConnector_ms": 0.10300111770629883}, "num_episodes": 65, "episode_return_max": 16.6416785177394, "episode_return_min": -211.437600734583, "episode_return_mean": -64.34841810020998, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.610399041518, "num_env_steps_trained_throughput_per_sec": 266.610399041518, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 13473.741, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13473.661, "sample_time_ms": 2937.44, "learn_time_ms": 10519.871, "learn_throughput": 380.233, "synch_weights_time_ms": 15.023}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "64a97_00000", "date": "2024-07-26_23-20-34", "timestamp": 1722016234, "time_this_iter_s": 15.011610507965088, "time_total_s": 913.9818429946899, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 913.9818429946899, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 10.304545454545455, "ram_util_percent": 28.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.478601307670274, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1762124394333417, "policy_loss": -0.007276536808543218, "vf_loss": 0.16664986985269933, "vf_explained_var": 0.9997128764167428, "kl": 0.010221001129442239, "entropy": -0.13159610903821886, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 20.203735186280188, "episode_reward_min": -192.07964029417928, "episode_reward_mean": -63.7054703485292, "episode_len_mean": 61.89, "episode_media": {}, "episodes_timesteps_total": 6189, "policy_reward_min": {"policy_0": -192.07964029417928}, "policy_reward_max": {"policy_0": 20.203735186280188}, "policy_reward_mean": {"policy_0": -63.7054703485292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.7556975694834, 11.64157177896147, -92.23454154953632, -1.3033583435996758, -28.447285844076895, -174.83441169415053, -117.58768350888528, -129.36026776473625, -99.05918126430143, -51.318248057779336, 9.842229134562356, 6.793070229158087, -162.00997453363675, -47.98831634471509, -122.17100097562312, -29.976745657322148, 8.035598882443708, -28.215413460823914, -9.825162438726947, -93.21478923703569, -157.9659773271826, -15.72012123565273, -40.79970042291628, -30.98017227841966, -110.45485101523573, -106.19283338030759, -29.286321234235412, 14.068827363957434, -136.14011481197332, -18.610988798205387, -51.0265564859285, -192.07964029417928, -158.0058515710289, 6.88422939855646, -27.199556988447142, -158.97038525080924, -5.117868913085383, -39.54518674720751, -62.55951190821346, 12.28591883164751, 12.391570823169957, -89.58146507190239, -64.47877016012323, 10.534346239106798, -89.74900745493228, -66.3714872400593, -13.862480294490094, -7.266560545081449, -154.92490297781038, -120.429905679955, -159.89013855152234, -179.11895745951287, -11.804091495232225, 13.633469151371054, 11.26207984810185, 11.656960192727889, -124.28097017013228, 3.5145595538321084, -32.01255374719187, -37.24231019361738, -32.718628134595825, -78.19463466189833, -5.6162600963377365, -4.2830239670217924, -118.16530162951145, -188.54912234027148, 7.463231168643755, -162.65294914972026, -51.8687084587271, 6.903237345391015, -11.570148649704459, -123.51571295858709, -20.97227828064515, -23.35282202917851, 10.776781215289802, -3.3882019304424302, -102.39040313901029, -89.65802898159926, -89.13828095335991, -38.8089524321701, -6.595451314957254, -85.29587886105747, -122.97367169287924, -171.07723277847305, 0.144956303553627, 13.786730436464532, 7.696414624080011, -32.2165769482063, -68.43032824740828, -158.5215874721382, -164.06841661843117, -131.37100721849103, -92.73243073040732, -35.52320641157438, -117.08209049652778, -44.65393077395025, -126.19436643037808, 20.203735186280188, -156.1478695754744, -102.36773124806051], "episode_lengths": [79, 34, 70, 43, 58, 88, 84, 87, 70, 61, 42, 39, 88, 63, 78, 52, 46, 54, 49, 85, 84, 53, 51, 60, 88, 74, 50, 34, 89, 48, 59, 93, 83, 40, 57, 86, 41, 53, 65, 32, 32, 71, 62, 31, 68, 62, 56, 42, 83, 75, 91, 91, 49, 39, 42, 29, 81, 36, 59, 56, 50, 71, 36, 46, 75, 93, 40, 95, 56, 36, 51, 77, 47, 57, 31, 45, 75, 83, 71, 56, 52, 80, 86, 89, 45, 29, 45, 60, 72, 85, 94, 76, 70, 55, 76, 58, 78, 28, 84, 71], "policy_policy_0_reward": [-130.7556975694834, 11.64157177896147, -92.23454154953632, -1.3033583435996758, -28.447285844076895, -174.83441169415053, -117.58768350888528, -129.36026776473625, -99.05918126430143, -51.318248057779336, 9.842229134562356, 6.793070229158087, -162.00997453363675, -47.98831634471509, -122.17100097562312, -29.976745657322148, 8.035598882443708, -28.215413460823914, -9.825162438726947, -93.21478923703569, -157.9659773271826, -15.72012123565273, -40.79970042291628, -30.98017227841966, -110.45485101523573, -106.19283338030759, -29.286321234235412, 14.068827363957434, -136.14011481197332, -18.610988798205387, -51.0265564859285, -192.07964029417928, -158.0058515710289, 6.88422939855646, -27.199556988447142, -158.97038525080924, -5.117868913085383, -39.54518674720751, -62.55951190821346, 12.28591883164751, 12.391570823169957, -89.58146507190239, -64.47877016012323, 10.534346239106798, -89.74900745493228, -66.3714872400593, -13.862480294490094, -7.266560545081449, -154.92490297781038, -120.429905679955, -159.89013855152234, -179.11895745951287, -11.804091495232225, 13.633469151371054, 11.26207984810185, 11.656960192727889, -124.28097017013228, 3.5145595538321084, -32.01255374719187, -37.24231019361738, -32.718628134595825, -78.19463466189833, -5.6162600963377365, -4.2830239670217924, -118.16530162951145, -188.54912234027148, 7.463231168643755, -162.65294914972026, -51.8687084587271, 6.903237345391015, -11.570148649704459, -123.51571295858709, -20.97227828064515, -23.35282202917851, 10.776781215289802, -3.3882019304424302, -102.39040313901029, -89.65802898159926, -89.13828095335991, -38.8089524321701, -6.595451314957254, -85.29587886105747, -122.97367169287924, -171.07723277847305, 0.144956303553627, 13.786730436464532, 7.696414624080011, -32.2165769482063, -68.43032824740828, -158.5215874721382, -164.06841661843117, -131.37100721849103, -92.73243073040732, -35.52320641157438, -117.08209049652778, -44.65393077395025, -126.19436643037808, 20.203735186280188, -156.1478695754744, -102.36773124806051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293845911670614, "mean_inference_ms": 0.9075528995969521, "mean_action_processing_ms": 0.1630744042911705, "mean_env_wait_ms": 2.1399902609104724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005892038345336914, "StateBufferConnector_ms": 0.004075288772583008, "ViewRequirementAgentConnector_ms": 0.1020669937133789}, "num_episodes": 66, "episode_return_max": 20.203735186280188, "episode_return_min": -192.07964029417928, "episode_return_mean": -63.7054703485292, "episodes_this_iter": 66}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.25036678082745, "num_env_steps_trained_throughput_per_sec": 274.25036678082745, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 13509.946, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13509.866, "sample_time_ms": 2940.523, "learn_time_ms": 10552.599, "learn_throughput": 379.054, "synch_weights_time_ms": 15.401}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "64a97_00000", "date": "2024-07-26_23-20-49", "timestamp": 1722016249, "time_this_iter_s": 14.595223665237427, "time_total_s": 928.5770666599274, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb734160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 928.5770666599274, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 10.64761904761905, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.65755292673906, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.20059484050289028, "policy_loss": -0.010189011619756154, "vf_loss": 0.19365770584748437, "vf_explained_var": 0.9996657053008675, "kl": 0.010652386391590577, "entropy": -0.09478357315286606, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 20.203735186280188, "episode_reward_min": -212.70333240900254, "episode_reward_mean": -66.47255699117711, "episode_len_mean": 62.75, "episode_media": {}, "episodes_timesteps_total": 6275, "policy_reward_min": {"policy_0": -212.70333240900254}, "policy_reward_max": {"policy_0": 20.203735186280188}, "policy_reward_mean": {"policy_0": -66.47255699117711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.54912234027148, 7.463231168643755, -162.65294914972026, -51.8687084587271, 6.903237345391015, -11.570148649704459, -123.51571295858709, -20.97227828064515, -23.35282202917851, 10.776781215289802, -3.3882019304424302, -102.39040313901029, -89.65802898159926, -89.13828095335991, -38.8089524321701, -6.595451314957254, -85.29587886105747, -122.97367169287924, -171.07723277847305, 0.144956303553627, 13.786730436464532, 7.696414624080011, -32.2165769482063, -68.43032824740828, -158.5215874721382, -164.06841661843117, -131.37100721849103, -92.73243073040732, -35.52320641157438, -117.08209049652778, -44.65393077395025, -126.19436643037808, 20.203735186280188, -156.1478695754744, -102.36773124806051, -75.2743244405177, 4.849967690093418, -166.71068749953824, -40.595997304780575, 4.51262458698551, 8.294128404201501, -178.9543564457411, -30.825439663570474, -48.675789608413226, -2.5936499334201937, -212.70333240900254, -38.258205776618865, 2.2030242214224893, -76.83423865484376, -182.69879473755984, -95.06437496481531, -25.368968318484075, -57.985222353118964, -1.673600162136359, 10.546172105300307, -16.65748729713359, -11.061766249652223, -6.15733812587037, -177.2029332175985, -93.35006628481027, -30.42120571974217, -85.49906665296186, 2.216043448674978, -47.40144749910057, -93.7227852731805, -129.39182782094673, -30.080004839451053, -60.53989854638382, -90.76983681260472, -22.927924868246617, -16.966910381929704, -51.876005234151684, -1.4114117801382349, -138.37340603969977, -4.444621256168995, -5.67342673063064, -87.37535856139438, -160.08898373062917, -9.879464422098522, -82.94896909919524, -87.8482387964979, -74.4932219935252, -145.18530501810676, -30.32132198042147, -132.78285350632282, -167.7436341310743, 2.4021327245847757, -73.15087650223109, -136.22860003269705, -164.81214887875146, -98.34058229172011, 2.395013246147318, -1.8285879072234992, -79.93813215135522, 6.803627597809391, 8.200200635845853, -92.65873150699375, -129.32179093748408, -30.09503121092358, -112.34814837504148], "episode_lengths": [93, 40, 95, 56, 36, 51, 77, 47, 57, 31, 45, 75, 83, 71, 56, 52, 80, 86, 89, 45, 29, 45, 60, 72, 85, 94, 76, 70, 55, 76, 58, 78, 28, 84, 71, 75, 43, 85, 52, 42, 36, 97, 57, 55, 41, 100, 61, 44, 67, 95, 71, 53, 58, 47, 30, 43, 45, 45, 89, 68, 58, 78, 40, 54, 72, 89, 54, 59, 67, 43, 55, 55, 48, 84, 42, 47, 70, 83, 49, 82, 69, 62, 82, 57, 78, 88, 39, 63, 81, 86, 70, 37, 42, 67, 34, 37, 83, 81, 61, 84], "policy_policy_0_reward": [-188.54912234027148, 7.463231168643755, -162.65294914972026, -51.8687084587271, 6.903237345391015, -11.570148649704459, -123.51571295858709, -20.97227828064515, -23.35282202917851, 10.776781215289802, -3.3882019304424302, -102.39040313901029, -89.65802898159926, -89.13828095335991, -38.8089524321701, -6.595451314957254, -85.29587886105747, -122.97367169287924, -171.07723277847305, 0.144956303553627, 13.786730436464532, 7.696414624080011, -32.2165769482063, -68.43032824740828, -158.5215874721382, -164.06841661843117, -131.37100721849103, -92.73243073040732, -35.52320641157438, -117.08209049652778, -44.65393077395025, -126.19436643037808, 20.203735186280188, -156.1478695754744, -102.36773124806051, -75.2743244405177, 4.849967690093418, -166.71068749953824, -40.595997304780575, 4.51262458698551, 8.294128404201501, -178.9543564457411, -30.825439663570474, -48.675789608413226, -2.5936499334201937, -212.70333240900254, -38.258205776618865, 2.2030242214224893, -76.83423865484376, -182.69879473755984, -95.06437496481531, -25.368968318484075, -57.985222353118964, -1.673600162136359, 10.546172105300307, -16.65748729713359, -11.061766249652223, -6.15733812587037, -177.2029332175985, -93.35006628481027, -30.42120571974217, -85.49906665296186, 2.216043448674978, -47.40144749910057, -93.7227852731805, -129.39182782094673, -30.080004839451053, -60.53989854638382, -90.76983681260472, -22.927924868246617, -16.966910381929704, -51.876005234151684, -1.4114117801382349, -138.37340603969977, -4.444621256168995, -5.67342673063064, -87.37535856139438, -160.08898373062917, -9.879464422098522, -82.94896909919524, -87.8482387964979, -74.4932219935252, -145.18530501810676, -30.32132198042147, -132.78285350632282, -167.7436341310743, 2.4021327245847757, -73.15087650223109, -136.22860003269705, -164.81214887875146, -98.34058229172011, 2.395013246147318, -1.8285879072234992, -79.93813215135522, 6.803627597809391, 8.200200635845853, -92.65873150699375, -129.32179093748408, -30.09503121092358, -112.34814837504148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29390264430686175, "mean_inference_ms": 0.9075415608926705, "mean_action_processing_ms": 0.1630752838063488, "mean_env_wait_ms": 2.1412772082290923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056896209716796875, "StateBufferConnector_ms": 0.004091978073120117, "ViewRequirementAgentConnector_ms": 0.10247087478637695}, "num_episodes": 65, "episode_return_max": 20.203735186280188, "episode_return_min": -212.70333240900254, "episode_return_mean": -66.47255699117711, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.7573056789358, "num_env_steps_trained_throughput_per_sec": 280.7573056789358, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 13501.823, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13501.743, "sample_time_ms": 2948.334, "learn_time_ms": 10536.45, "learn_throughput": 379.634, "synch_weights_time_ms": 15.617}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "64a97_00000", "date": "2024-07-26_23-21-03", "timestamp": 1722016263, "time_this_iter_s": 14.254772186279297, "time_total_s": 942.8318388462067, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb736b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 942.8318388462067, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.62, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.16053243229786, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.2103455245679167, "policy_loss": -0.010524215089875118, "vf_loss": 0.20180019744051, "vf_explained_var": 0.9996325037752588, "kl": 0.011936799036629999, "entropy": -0.094052906788905, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": 21.394519507229127, "episode_reward_min": -173.2268105496935, "episode_reward_mean": -63.30152617534614, "episode_len_mean": 63.0, "episode_media": {}, "episodes_timesteps_total": 6300, "policy_reward_min": {"policy_0": -173.2268105496935}, "policy_reward_max": {"policy_0": 21.394519507229127}, "policy_reward_mean": {"policy_0": -63.30152617534614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.40144749910057, -93.7227852731805, -129.39182782094673, -30.080004839451053, -60.53989854638382, -90.76983681260472, -22.927924868246617, -16.966910381929704, -51.876005234151684, -1.4114117801382349, -138.37340603969977, -4.444621256168995, -5.67342673063064, -87.37535856139438, -160.08898373062917, -9.879464422098522, -82.94896909919524, -87.8482387964979, -74.4932219935252, -145.18530501810676, -30.32132198042147, -132.78285350632282, -167.7436341310743, 2.4021327245847757, -73.15087650223109, -136.22860003269705, -164.81214887875146, -98.34058229172011, 2.395013246147318, -1.8285879072234992, -79.93813215135522, 6.803627597809391, 8.200200635845853, -92.65873150699375, -129.32179093748408, -30.09503121092358, -112.34814837504148, 9.330612015063027, 15.494848191906181, -100.21565480622937, -140.6843975949366, -46.607312533117884, -67.06553753240833, -74.24089684350403, 7.101757404593741, -77.15854293648135, -118.55937557886348, 8.45634544529861, 11.001680605206678, -82.77830496768172, -21.78578166423177, -121.74994551878746, -81.7320627714418, 16.78465423210804, -138.70241962824224, -25.714493366837548, -10.729859827894074, -2.7191839991364612, -22.613134479662328, -125.57631233608183, -173.2268105496935, -0.970768788836305, -21.955050370739652, -74.23411709523272, -101.44172467455122, -60.05685473226513, -13.246962965297113, 4.914924481343005, -114.25205690716733, -14.555929223313246, -113.2804805027867, -110.28344347197928, -28.10424392549497, -13.889074408372023, -112.50513182523801, -63.821628291025924, -21.356625542060666, 17.22610434486837, -4.596836936752976, -2.759033241611351, -89.54745302280023, -30.712038528646445, -108.28823369740552, -115.57284999216613, -81.18151931423844, -4.856164627315792, -109.83005365754504, -129.44326704531923, -58.06586002181703, 10.8966115374818, -100.85837350270529, -123.62950306720283, -76.73625249278093, -24.550982253961635, -119.43135524489885, -120.58845598730908, -166.46690994891898, -100.74887460038074, -17.908024544410637, 21.394519507229127], "episode_lengths": [54, 72, 89, 54, 59, 67, 43, 55, 55, 48, 84, 42, 47, 70, 83, 49, 82, 69, 62, 82, 57, 78, 88, 39, 63, 81, 86, 70, 37, 42, 67, 34, 37, 83, 81, 61, 84, 38, 31, 80, 78, 56, 67, 77, 37, 67, 90, 44, 36, 72, 58, 89, 70, 29, 85, 60, 47, 50, 57, 75, 85, 47, 53, 69, 74, 76, 54, 43, 75, 53, 74, 87, 49, 52, 75, 61, 54, 28, 46, 41, 81, 48, 75, 89, 82, 49, 83, 79, 65, 44, 71, 77, 64, 48, 83, 80, 84, 74, 48, 33], "policy_policy_0_reward": [-47.40144749910057, -93.7227852731805, -129.39182782094673, -30.080004839451053, -60.53989854638382, -90.76983681260472, -22.927924868246617, -16.966910381929704, -51.876005234151684, -1.4114117801382349, -138.37340603969977, -4.444621256168995, -5.67342673063064, -87.37535856139438, -160.08898373062917, -9.879464422098522, -82.94896909919524, -87.8482387964979, -74.4932219935252, -145.18530501810676, -30.32132198042147, -132.78285350632282, -167.7436341310743, 2.4021327245847757, -73.15087650223109, -136.22860003269705, -164.81214887875146, -98.34058229172011, 2.395013246147318, -1.8285879072234992, -79.93813215135522, 6.803627597809391, 8.200200635845853, -92.65873150699375, -129.32179093748408, -30.09503121092358, -112.34814837504148, 9.330612015063027, 15.494848191906181, -100.21565480622937, -140.6843975949366, -46.607312533117884, -67.06553753240833, -74.24089684350403, 7.101757404593741, -77.15854293648135, -118.55937557886348, 8.45634544529861, 11.001680605206678, -82.77830496768172, -21.78578166423177, -121.74994551878746, -81.7320627714418, 16.78465423210804, -138.70241962824224, -25.714493366837548, -10.729859827894074, -2.7191839991364612, -22.613134479662328, -125.57631233608183, -173.2268105496935, -0.970768788836305, -21.955050370739652, -74.23411709523272, -101.44172467455122, -60.05685473226513, -13.246962965297113, 4.914924481343005, -114.25205690716733, -14.555929223313246, -113.2804805027867, -110.28344347197928, -28.10424392549497, -13.889074408372023, -112.50513182523801, -63.821628291025924, -21.356625542060666, 17.22610434486837, -4.596836936752976, -2.759033241611351, -89.54745302280023, -30.712038528646445, -108.28823369740552, -115.57284999216613, -81.18151931423844, -4.856164627315792, -109.83005365754504, -129.44326704531923, -58.06586002181703, 10.8966115374818, -100.85837350270529, -123.62950306720283, -76.73625249278093, -24.550982253961635, -119.43135524489885, -120.58845598730908, -166.46690994891898, -100.74887460038074, -17.908024544410637, 21.394519507229127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2939102461627056, "mean_inference_ms": 0.9077195997403344, "mean_action_processing_ms": 0.1630742722493865, "mean_env_wait_ms": 2.14255794840148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00567626953125, "StateBufferConnector_ms": 0.004116535186767578, "ViewRequirementAgentConnector_ms": 0.10196328163146973}, "num_episodes": 63, "episode_return_max": 21.394519507229127, "episode_return_min": -173.2268105496935, "episode_return_mean": -63.30152617534614, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.0386624924449, "num_env_steps_trained_throughput_per_sec": 272.0386624924449, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 13480.133, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13480.054, "sample_time_ms": 2956.676, "learn_time_ms": 10506.812, "learn_throughput": 380.705, "synch_weights_time_ms": 15.276}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "64a97_00000", "date": "2024-07-26_23-21-18", "timestamp": 1722016278, "time_this_iter_s": 14.711978912353516, "time_total_s": 957.5438177585602, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb736ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 957.5438177585602, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.842857142857143, "ram_util_percent": 28.752380952380946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.259122576316194, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.18364510458389607, "policy_loss": -0.009706346845875184, "vf_loss": 0.17913694334371635, "vf_explained_var": 0.9996773207560181, "kl": 0.008895909685088587, "entropy": -0.07038453801602979, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 21.394519507229127, "episode_reward_min": -212.45751136661744, "episode_reward_mean": -69.71047122911929, "episode_len_mean": 64.62, "episode_media": {}, "episodes_timesteps_total": 6462, "policy_reward_min": {"policy_0": -212.45751136661744}, "policy_reward_max": {"policy_0": 21.394519507229127}, "policy_reward_mean": {"policy_0": -69.71047122911929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.23411709523272, -101.44172467455122, -60.05685473226513, -13.246962965297113, 4.914924481343005, -114.25205690716733, -14.555929223313246, -113.2804805027867, -110.28344347197928, -28.10424392549497, -13.889074408372023, -112.50513182523801, -63.821628291025924, -21.356625542060666, 17.22610434486837, -4.596836936752976, -2.759033241611351, -89.54745302280023, -30.712038528646445, -108.28823369740552, -115.57284999216613, -81.18151931423844, -4.856164627315792, -109.83005365754504, -129.44326704531923, -58.06586002181703, 10.8966115374818, -100.85837350270529, -123.62950306720283, -76.73625249278093, -24.550982253961635, -119.43135524489885, -120.58845598730908, -166.46690994891898, -100.74887460038074, -17.908024544410637, 21.394519507229127, 0.3824577239637361, -8.655505675213407, -35.782879852266916, -149.07398309777219, -111.57576329877756, -93.36324433977865, 0.48457835838447405, -25.37849256918034, -52.54154001331068, 3.5283006401296326, -212.45751136661744, -116.31531133596924, -7.364485306605419, -55.61948270971563, -75.70318461333198, -87.64437100812897, -112.60794325281036, -114.98598712033282, -3.533352568581829, -86.66295138025744, -108.31454982051656, -163.83934731917498, -8.94019645907198, -17.962375541717307, -136.89650247679145, 5.926160785870913, -165.26838504529974, -78.36099923218129, 3.273841293515821, -125.99707234806465, -86.9555791635936, -3.375357959613735, -147.36298212108952, -2.6374385358685517, -10.664623384428609, -176.55414998128956, -173.59097186911177, -66.15505677996826, -2.02558353260825, -102.67469714286644, -75.20803424911287, -177.2464002952248, -56.326668393520464, 0.413545865952738, -159.77588879238178, -61.106907628684475, -106.93623397635834, -73.33053179906126, -147.72484864044148, -68.02465011509533, -22.09091306235944, -99.12263179192573, -83.46027011442722, -22.583424813144855, -0.1855277673304352, -121.97737792062834, -73.90790501681822, -75.75852218323571, -7.10291145818027, -72.73595165152382, -93.73955006420047, -99.01774271934619, 11.516898517210336], "episode_lengths": [69, 74, 76, 54, 43, 75, 53, 74, 87, 49, 52, 75, 61, 54, 28, 46, 41, 81, 48, 75, 89, 82, 49, 83, 79, 65, 44, 71, 77, 64, 48, 83, 80, 84, 74, 48, 33, 45, 42, 53, 78, 73, 70, 38, 60, 64, 39, 103, 76, 43, 57, 67, 73, 74, 75, 43, 73, 88, 95, 46, 47, 94, 37, 86, 69, 39, 92, 67, 49, 83, 46, 48, 92, 87, 63, 44, 72, 76, 87, 62, 44, 91, 59, 78, 64, 82, 62, 58, 71, 68, 50, 50, 77, 64, 78, 44, 65, 70, 72, 32], "policy_policy_0_reward": [-74.23411709523272, -101.44172467455122, -60.05685473226513, -13.246962965297113, 4.914924481343005, -114.25205690716733, -14.555929223313246, -113.2804805027867, -110.28344347197928, -28.10424392549497, -13.889074408372023, -112.50513182523801, -63.821628291025924, -21.356625542060666, 17.22610434486837, -4.596836936752976, -2.759033241611351, -89.54745302280023, -30.712038528646445, -108.28823369740552, -115.57284999216613, -81.18151931423844, -4.856164627315792, -109.83005365754504, -129.44326704531923, -58.06586002181703, 10.8966115374818, -100.85837350270529, -123.62950306720283, -76.73625249278093, -24.550982253961635, -119.43135524489885, -120.58845598730908, -166.46690994891898, -100.74887460038074, -17.908024544410637, 21.394519507229127, 0.3824577239637361, -8.655505675213407, -35.782879852266916, -149.07398309777219, -111.57576329877756, -93.36324433977865, 0.48457835838447405, -25.37849256918034, -52.54154001331068, 3.5283006401296326, -212.45751136661744, -116.31531133596924, -7.364485306605419, -55.61948270971563, -75.70318461333198, -87.64437100812897, -112.60794325281036, -114.98598712033282, -3.533352568581829, -86.66295138025744, -108.31454982051656, -163.83934731917498, -8.94019645907198, -17.962375541717307, -136.89650247679145, 5.926160785870913, -165.26838504529974, -78.36099923218129, 3.273841293515821, -125.99707234806465, -86.9555791635936, -3.375357959613735, -147.36298212108952, -2.6374385358685517, -10.664623384428609, -176.55414998128956, -173.59097186911177, -66.15505677996826, -2.02558353260825, -102.67469714286644, -75.20803424911287, -177.2464002952248, -56.326668393520464, 0.413545865952738, -159.77588879238178, -61.106907628684475, -106.93623397635834, -73.33053179906126, -147.72484864044148, -68.02465011509533, -22.09091306235944, -99.12263179192573, -83.46027011442722, -22.583424813144855, -0.1855277673304352, -121.97737792062834, -73.90790501681822, -75.75852218323571, -7.10291145818027, -72.73595165152382, -93.73955006420047, -99.01774271934619, 11.516898517210336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2939212112566242, "mean_inference_ms": 0.9078361674457721, "mean_action_processing_ms": 0.16315820216931118, "mean_env_wait_ms": 2.143938862179202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005903720855712891, "StateBufferConnector_ms": 0.00418400764465332, "ViewRequirementAgentConnector_ms": 0.10420632362365723}, "num_episodes": 63, "episode_return_max": 21.394519507229127, "episode_return_min": -212.45751136661744, "episode_return_mean": -69.71047122911929, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.1667385022185, "num_env_steps_trained_throughput_per_sec": 271.1667385022185, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13476.943, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13476.863, "sample_time_ms": 2960.553, "learn_time_ms": 10499.962, "learn_throughput": 380.954, "synch_weights_time_ms": 15.08}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "64a97_00000", "date": "2024-07-26_23-21-33", "timestamp": 1722016293, "time_this_iter_s": 14.758795976638794, "time_total_s": 972.302613735199, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7067a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 972.302613735199, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 10.595238095238097, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.13513560146093, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.261664296646389, "policy_loss": -0.005740499093371909, "vf_loss": 0.2534454728787144, "vf_explained_var": 0.9993614468102654, "kl": 0.008465011755106422, "entropy": -0.11030855306404798, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": 19.250982754410295, "episode_reward_min": -325.5606160145977, "episode_reward_mean": -74.71980187586864, "episode_len_mean": 65.47, "episode_media": {}, "episodes_timesteps_total": 6547, "policy_reward_min": {"policy_0": -325.5606160145977}, "policy_reward_max": {"policy_0": 19.250982754410295}, "policy_reward_mean": {"policy_0": -74.71980187586864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.94019645907198, -17.962375541717307, -136.89650247679145, 5.926160785870913, -165.26838504529974, -78.36099923218129, 3.273841293515821, -125.99707234806465, -86.9555791635936, -3.375357959613735, -147.36298212108952, -2.6374385358685517, -10.664623384428609, -176.55414998128956, -173.59097186911177, -66.15505677996826, -2.02558353260825, -102.67469714286644, -75.20803424911287, -177.2464002952248, -56.326668393520464, 0.413545865952738, -159.77588879238178, -61.106907628684475, -106.93623397635834, -73.33053179906126, -147.72484864044148, -68.02465011509533, -22.09091306235944, -99.12263179192573, -83.46027011442722, -22.583424813144855, -0.1855277673304352, -121.97737792062834, -73.90790501681822, -75.75852218323571, -7.10291145818027, -72.73595165152382, -93.73955006420047, -99.01774271934619, 11.516898517210336, -103.63049621856496, -1.970826597749927, -123.74467755090996, -42.77460611476486, -40.05927442508562, 19.250982754410295, -64.61251480559723, -325.5606160145977, -87.96548518296264, -130.5461566680851, -79.27826144721561, -20.676093802471236, 9.018147896553508, -157.0253862667495, 3.7560604275198055, 9.794143375413732, -178.15622505332578, -73.94609153942977, -95.82375019567152, -130.41469453115727, -47.198548361142876, 15.29526968590768, 1.106425673684879, -154.052274010222, -110.03316469657122, -63.106187149081585, -247.21091715413783, -27.511083561543252, -99.47666210811413, -15.428703113459736, -52.896350130178334, -77.1955073061996, -22.981170003979457, -24.097690082335717, -83.68827861904566, -117.3939023367615, -18.36775763685626, -19.89740631919552, -165.26616392328359, -49.7196746775888, -20.179994416567297, -165.14822231395365, -136.28669563782225, -156.3763800777171, -39.94668243479632, -45.921896467341746, -125.01570635779076, -99.87458419087623, -100.5916404319628, -101.16185953575643, -89.58345101295637, -53.11924884658216, -179.93900400470883, -48.97546611390801, -60.10626852606694, 14.212174348288745, -23.6657311412919, -45.50644372920024, -19.653101341290718], "episode_lengths": [46, 47, 94, 37, 86, 69, 39, 92, 67, 49, 83, 46, 48, 92, 87, 63, 44, 72, 76, 87, 62, 44, 91, 59, 78, 64, 82, 62, 58, 71, 68, 50, 50, 77, 64, 78, 44, 65, 70, 72, 32, 72, 41, 84, 62, 50, 36, 63, 112, 65, 81, 66, 57, 31, 84, 42, 36, 94, 80, 70, 75, 64, 34, 49, 82, 71, 73, 115, 49, 86, 52, 63, 67, 53, 58, 69, 82, 55, 57, 85, 62, 47, 88, 81, 93, 53, 58, 77, 73, 71, 73, 69, 56, 95, 56, 64, 30, 57, 61, 53], "policy_policy_0_reward": [-8.94019645907198, -17.962375541717307, -136.89650247679145, 5.926160785870913, -165.26838504529974, -78.36099923218129, 3.273841293515821, -125.99707234806465, -86.9555791635936, -3.375357959613735, -147.36298212108952, -2.6374385358685517, -10.664623384428609, -176.55414998128956, -173.59097186911177, -66.15505677996826, -2.02558353260825, -102.67469714286644, -75.20803424911287, -177.2464002952248, -56.326668393520464, 0.413545865952738, -159.77588879238178, -61.106907628684475, -106.93623397635834, -73.33053179906126, -147.72484864044148, -68.02465011509533, -22.09091306235944, -99.12263179192573, -83.46027011442722, -22.583424813144855, -0.1855277673304352, -121.97737792062834, -73.90790501681822, -75.75852218323571, -7.10291145818027, -72.73595165152382, -93.73955006420047, -99.01774271934619, 11.516898517210336, -103.63049621856496, -1.970826597749927, -123.74467755090996, -42.77460611476486, -40.05927442508562, 19.250982754410295, -64.61251480559723, -325.5606160145977, -87.96548518296264, -130.5461566680851, -79.27826144721561, -20.676093802471236, 9.018147896553508, -157.0253862667495, 3.7560604275198055, 9.794143375413732, -178.15622505332578, -73.94609153942977, -95.82375019567152, -130.41469453115727, -47.198548361142876, 15.29526968590768, 1.106425673684879, -154.052274010222, -110.03316469657122, -63.106187149081585, -247.21091715413783, -27.511083561543252, -99.47666210811413, -15.428703113459736, -52.896350130178334, -77.1955073061996, -22.981170003979457, -24.097690082335717, -83.68827861904566, -117.3939023367615, -18.36775763685626, -19.89740631919552, -165.26616392328359, -49.7196746775888, -20.179994416567297, -165.14822231395365, -136.28669563782225, -156.3763800777171, -39.94668243479632, -45.921896467341746, -125.01570635779076, -99.87458419087623, -100.5916404319628, -101.16185953575643, -89.58345101295637, -53.11924884658216, -179.93900400470883, -48.97546611390801, -60.10626852606694, 14.212174348288745, -23.6657311412919, -45.50644372920024, -19.653101341290718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2941335770792155, "mean_inference_ms": 0.9081892088463644, "mean_action_processing_ms": 0.16304204362814798, "mean_env_wait_ms": 2.14488166119264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005867719650268555, "StateBufferConnector_ms": 0.004111528396606445, "ViewRequirementAgentConnector_ms": 0.1026754379272461}, "num_episodes": 59, "episode_return_max": 19.250982754410295, "episode_return_min": -325.5606160145977, "episode_return_mean": -74.71980187586864, "episodes_this_iter": 59}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.4626129895015, "num_env_steps_trained_throughput_per_sec": 269.4626129895015, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 13445.032, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13444.948, "sample_time_ms": 2960.187, "learn_time_ms": 10468.369, "learn_throughput": 382.103, "synch_weights_time_ms": 15.075}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "64a97_00000", "date": "2024-07-26_23-21-48", "timestamp": 1722016308, "time_this_iter_s": 14.852111577987671, "time_total_s": 987.1547253131866, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb706170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 987.1547253131866, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 10.652380952380954, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.04633807092905, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.18874188160795408, "policy_loss": -0.010971046433163186, "vf_loss": 0.1840743635315448, "vf_explained_var": 0.9996798056488235, "kl": 0.00974010406865394, "entropy": -0.08457823903930452, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 15.29526968590768, "episode_reward_min": -247.21091715413783, "episode_reward_mean": -68.48922609541734, "episode_len_mean": 64.85, "episode_media": {}, "episodes_timesteps_total": 6485, "policy_reward_min": {"policy_0": -247.21091715413783}, "policy_reward_max": {"policy_0": 15.29526968590768}, "policy_reward_mean": {"policy_0": -68.48922609541734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.29526968590768, 1.106425673684879, -154.052274010222, -110.03316469657122, -63.106187149081585, -247.21091715413783, -27.511083561543252, -99.47666210811413, -15.428703113459736, -52.896350130178334, -77.1955073061996, -22.981170003979457, -24.097690082335717, -83.68827861904566, -117.3939023367615, -18.36775763685626, -19.89740631919552, -165.26616392328359, -49.7196746775888, -20.179994416567297, -165.14822231395365, -136.28669563782225, -156.3763800777171, -39.94668243479632, -45.921896467341746, -125.01570635779076, -99.87458419087623, -100.5916404319628, -101.16185953575643, -89.58345101295637, -53.11924884658216, -179.93900400470883, -48.97546611390801, -60.10626852606694, 14.212174348288745, -23.6657311412919, -45.50644372920024, -19.653101341290718, -155.24461379640138, -54.041246112415706, -166.4741697500648, -11.80836572795624, -1.11798060129616, -0.17363057629817646, -41.5172888775596, -3.68274260775556, -103.5309394839042, -42.10076843749004, -19.396471161079994, -159.875795958454, -95.67686799783593, -8.419161911527553, -97.32230016696465, -54.915933234308646, -60.16856630827164, -113.35945378696228, -174.64521678503996, -62.873374864490955, 8.631159026074737, -88.69458115998088, -21.645461975809248, -2.281077968046273, -120.83687886819285, -120.62277960277119, -79.32216556213416, -59.73471422840575, -67.87621222094597, -169.7074483103425, -50.41073532129712, -3.2258739029694006, -30.789585422267464, -215.3679734076285, -41.9406606783838, 8.761448393488001, -141.12603326421396, -48.71724434218707, 11.386132857607809, -73.24343476082008, -127.62618119766633, -73.22191722053806, -35.70222180968041, 9.366696261063993, -118.37593061273124, -27.740469506086555, 6.839635383114011, -132.2158463703443, -7.0581061237719105, -102.5605478540707, -23.756102899699243, -120.08242694036282, -201.4189949150983, -23.02289305359509, -76.19240424305423, -14.496798079547208, -37.81208016926182, 11.747592678677062, 3.960763507735611, -84.035485284854, -70.45531240051994, -43.193170124877106], "episode_lengths": [34, 49, 82, 71, 73, 115, 49, 86, 52, 63, 67, 53, 58, 69, 82, 55, 57, 85, 62, 47, 88, 81, 93, 53, 58, 77, 73, 71, 73, 69, 56, 95, 56, 64, 30, 57, 61, 53, 84, 62, 97, 48, 37, 45, 53, 45, 86, 62, 58, 93, 70, 52, 81, 58, 59, 87, 97, 60, 44, 69, 54, 41, 77, 77, 75, 59, 66, 85, 57, 39, 54, 106, 62, 38, 93, 63, 36, 69, 82, 61, 58, 38, 76, 56, 43, 84, 45, 86, 56, 83, 91, 56, 64, 53, 56, 41, 43, 67, 72, 59], "policy_policy_0_reward": [15.29526968590768, 1.106425673684879, -154.052274010222, -110.03316469657122, -63.106187149081585, -247.21091715413783, -27.511083561543252, -99.47666210811413, -15.428703113459736, -52.896350130178334, -77.1955073061996, -22.981170003979457, -24.097690082335717, -83.68827861904566, -117.3939023367615, -18.36775763685626, -19.89740631919552, -165.26616392328359, -49.7196746775888, -20.179994416567297, -165.14822231395365, -136.28669563782225, -156.3763800777171, -39.94668243479632, -45.921896467341746, -125.01570635779076, -99.87458419087623, -100.5916404319628, -101.16185953575643, -89.58345101295637, -53.11924884658216, -179.93900400470883, -48.97546611390801, -60.10626852606694, 14.212174348288745, -23.6657311412919, -45.50644372920024, -19.653101341290718, -155.24461379640138, -54.041246112415706, -166.4741697500648, -11.80836572795624, -1.11798060129616, -0.17363057629817646, -41.5172888775596, -3.68274260775556, -103.5309394839042, -42.10076843749004, -19.396471161079994, -159.875795958454, -95.67686799783593, -8.419161911527553, -97.32230016696465, -54.915933234308646, -60.16856630827164, -113.35945378696228, -174.64521678503996, -62.873374864490955, 8.631159026074737, -88.69458115998088, -21.645461975809248, -2.281077968046273, -120.83687886819285, -120.62277960277119, -79.32216556213416, -59.73471422840575, -67.87621222094597, -169.7074483103425, -50.41073532129712, -3.2258739029694006, -30.789585422267464, -215.3679734076285, -41.9406606783838, 8.761448393488001, -141.12603326421396, -48.71724434218707, 11.386132857607809, -73.24343476082008, -127.62618119766633, -73.22191722053806, -35.70222180968041, 9.366696261063993, -118.37593061273124, -27.740469506086555, 6.839635383114011, -132.2158463703443, -7.0581061237719105, -102.5605478540707, -23.756102899699243, -120.08242694036282, -201.4189949150983, -23.02289305359509, -76.19240424305423, -14.496798079547208, -37.81208016926182, 11.747592678677062, 3.960763507735611, -84.035485284854, -70.45531240051994, -43.193170124877106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940733995042408, "mean_inference_ms": 0.9079973059871042, "mean_action_processing_ms": 0.1631309841562563, "mean_env_wait_ms": 2.1462801643545952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005484819412231445, "StateBufferConnector_ms": 0.0040318965911865234, "ViewRequirementAgentConnector_ms": 0.10120558738708496}, "num_episodes": 62, "episode_return_max": 15.29526968590768, "episode_return_min": -247.21091715413783, "episode_return_mean": -68.48922609541734, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.4216444477384, "num_env_steps_trained_throughput_per_sec": 279.4216444477384, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 13769.195, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13769.113, "sample_time_ms": 2964.483, "learn_time_ms": 10788.333, "learn_throughput": 370.771, "synch_weights_time_ms": 14.988}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "64a97_00000", "date": "2024-07-26_23-22-02", "timestamp": 1722016322, "time_this_iter_s": 14.324043989181519, "time_total_s": 1001.4787693023682, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1001.4787693023682, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 10.385714285714286, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.47784810215235, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19012295145754857, "policy_loss": -0.00971599946982072, "vf_loss": 0.18342141154377412, "vf_explained_var": 0.9997021342938145, "kl": 0.009845760372869983, "entropy": -0.14642908813936326, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 15.734463545768843, "episode_reward_min": -215.3679734076285, "episode_reward_mean": -67.08416516256555, "episode_len_mean": 63.65, "episode_media": {}, "episodes_timesteps_total": 6365, "policy_reward_min": {"policy_0": -215.3679734076285}, "policy_reward_max": {"policy_0": 15.734463545768843}, "policy_reward_mean": {"policy_0": -67.08416516256555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.32216556213416, -59.73471422840575, -67.87621222094597, -169.7074483103425, -50.41073532129712, -3.2258739029694006, -30.789585422267464, -215.3679734076285, -41.9406606783838, 8.761448393488001, -141.12603326421396, -48.71724434218707, 11.386132857607809, -73.24343476082008, -127.62618119766633, -73.22191722053806, -35.70222180968041, 9.366696261063993, -118.37593061273124, -27.740469506086555, 6.839635383114011, -132.2158463703443, -7.0581061237719105, -102.5605478540707, -23.756102899699243, -120.08242694036282, -201.4189949150983, -23.02289305359509, -76.19240424305423, -14.496798079547208, -37.81208016926182, 11.747592678677062, 3.960763507735611, -84.035485284854, -70.45531240051994, -43.193170124877106, -155.055126556807, 4.838354233301723, -57.00585098337185, -67.37048950415158, 3.4418986149888458, -103.82908183211178, -2.764545312906871, -6.229410789126077, -3.3488355981660236, -92.30013326165209, -140.17980246092975, -105.82958205262614, -24.347128096804564, -80.49142660479302, -102.92491909139059, -21.940967533915487, -179.23077029394267, -83.6319905901493, -201.0662693216287, -176.2232353591214, -120.05918539326046, -18.980161900533897, -23.469507936328455, -38.41821069871626, -52.942984972723934, -204.75784277299027, -2.428103562022252, -43.57163780285498, 15.176324539749054, -65.53128258961077, -90.62056872957518, -24.30263529070223, -131.93142088650373, -147.8428733824051, -107.973077801448, -38.57589766222238, -65.87714181678416, -95.84800398532785, -40.17913855383161, -114.7027560168433, 14.153440102131757, -45.86852832964651, 15.734463545768843, -79.5943596807243, 5.972107409144948, -23.793433324216217, -172.82112158573182, 9.804073117436012, -104.69974648510735, -203.60211813981155, -114.53188200905271, 3.1057301896677276, -54.089391545649114, -9.51110725643483, -106.17376627554457, -33.72392329078125, -4.868979660433227, -3.3869575410766286, -93.87368511955195, -110.85085991721776, -3.1212067346064787, -18.209977993758457, -171.38295468229313, -146.39021029315649], "episode_lengths": [75, 59, 66, 85, 57, 39, 54, 106, 62, 38, 93, 63, 36, 69, 82, 61, 58, 38, 76, 56, 43, 84, 45, 86, 56, 83, 91, 56, 64, 53, 56, 41, 43, 67, 72, 59, 81, 45, 59, 69, 44, 73, 50, 46, 42, 80, 76, 73, 58, 65, 72, 49, 90, 83, 96, 88, 86, 52, 50, 54, 60, 91, 41, 53, 33, 60, 84, 55, 79, 86, 83, 50, 64, 77, 60, 89, 34, 62, 30, 68, 38, 58, 88, 36, 72, 100, 76, 43, 58, 49, 75, 50, 51, 51, 70, 73, 46, 48, 88, 83], "policy_policy_0_reward": [-79.32216556213416, -59.73471422840575, -67.87621222094597, -169.7074483103425, -50.41073532129712, -3.2258739029694006, -30.789585422267464, -215.3679734076285, -41.9406606783838, 8.761448393488001, -141.12603326421396, -48.71724434218707, 11.386132857607809, -73.24343476082008, -127.62618119766633, -73.22191722053806, -35.70222180968041, 9.366696261063993, -118.37593061273124, -27.740469506086555, 6.839635383114011, -132.2158463703443, -7.0581061237719105, -102.5605478540707, -23.756102899699243, -120.08242694036282, -201.4189949150983, -23.02289305359509, -76.19240424305423, -14.496798079547208, -37.81208016926182, 11.747592678677062, 3.960763507735611, -84.035485284854, -70.45531240051994, -43.193170124877106, -155.055126556807, 4.838354233301723, -57.00585098337185, -67.37048950415158, 3.4418986149888458, -103.82908183211178, -2.764545312906871, -6.229410789126077, -3.3488355981660236, -92.30013326165209, -140.17980246092975, -105.82958205262614, -24.347128096804564, -80.49142660479302, -102.92491909139059, -21.940967533915487, -179.23077029394267, -83.6319905901493, -201.0662693216287, -176.2232353591214, -120.05918539326046, -18.980161900533897, -23.469507936328455, -38.41821069871626, -52.942984972723934, -204.75784277299027, -2.428103562022252, -43.57163780285498, 15.176324539749054, -65.53128258961077, -90.62056872957518, -24.30263529070223, -131.93142088650373, -147.8428733824051, -107.973077801448, -38.57589766222238, -65.87714181678416, -95.84800398532785, -40.17913855383161, -114.7027560168433, 14.153440102131757, -45.86852832964651, 15.734463545768843, -79.5943596807243, 5.972107409144948, -23.793433324216217, -172.82112158573182, 9.804073117436012, -104.69974648510735, -203.60211813981155, -114.53188200905271, 3.1057301896677276, -54.089391545649114, -9.51110725643483, -106.17376627554457, -33.72392329078125, -4.868979660433227, -3.3869575410766286, -93.87368511955195, -110.85085991721776, -3.1212067346064787, -18.209977993758457, -171.38295468229313, -146.39021029315649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2938482234281882, "mean_inference_ms": 0.9076984595588391, "mean_action_processing_ms": 0.16315265335000195, "mean_env_wait_ms": 2.1477159492959124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005568981170654297, "StateBufferConnector_ms": 0.0040912628173828125, "ViewRequirementAgentConnector_ms": 0.10218691825866699}, "num_episodes": 64, "episode_return_max": 15.734463545768843, "episode_return_min": -215.3679734076285, "episode_return_mean": -67.08416516256555, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.7935551172017, "num_env_steps_trained_throughput_per_sec": 285.7935551172017, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 14223.689, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14223.609, "sample_time_ms": 2982.029, "learn_time_ms": 11224.598, "learn_throughput": 356.36, "synch_weights_time_ms": 15.629}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "64a97_00000", "date": "2024-07-26_23-22-16", "timestamp": 1722016336, "time_this_iter_s": 14.00088095664978, "time_total_s": 1015.479650259018, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1015.479650259018, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 10.609999999999998, "ram_util_percent": 28.794999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.07746340483427, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.2265319870003926, "policy_loss": -0.011917973015806637, "vf_loss": 0.22563732504689446, "vf_explained_var": 0.9993515227610866, "kl": 0.0072732332000668976, "entropy": -0.176641243416816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 18.682609057562885, "episode_reward_min": -272.08579113628247, "episode_reward_mean": -71.29697075673658, "episode_len_mean": 64.34, "episode_media": {}, "episodes_timesteps_total": 6434, "policy_reward_min": {"policy_0": -272.08579113628247}, "policy_reward_max": {"policy_0": 18.682609057562885}, "policy_reward_mean": {"policy_0": -71.29697075673658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.942984972723934, -204.75784277299027, -2.428103562022252, -43.57163780285498, 15.176324539749054, -65.53128258961077, -90.62056872957518, -24.30263529070223, -131.93142088650373, -147.8428733824051, -107.973077801448, -38.57589766222238, -65.87714181678416, -95.84800398532785, -40.17913855383161, -114.7027560168433, 14.153440102131757, -45.86852832964651, 15.734463545768843, -79.5943596807243, 5.972107409144948, -23.793433324216217, -172.82112158573182, 9.804073117436012, -104.69974648510735, -203.60211813981155, -114.53188200905271, 3.1057301896677276, -54.089391545649114, -9.51110725643483, -106.17376627554457, -33.72392329078125, -4.868979660433227, -3.3869575410766286, -93.87368511955195, -110.85085991721776, -3.1212067346064787, -18.209977993758457, -171.38295468229313, -146.39021029315649, -129.57492878392105, -159.99002450232268, -85.56682811724235, -97.75686702262627, -139.32171409141355, -6.950965860489259, -138.6054839092421, -109.65170423736129, -210.31549486794012, -32.53183973934058, -52.36943916600503, -66.87651147629703, -16.42255532640845, -67.39713793681811, -17.77536088220772, -182.0870200891583, -155.81366643335878, -84.08228542885884, -5.269093647564754, -95.3474667843543, -13.91897055454967, -172.87111773962593, -65.23147341705771, -211.78665243369653, -26.774536336375693, 10.250358842517345, 14.142756066674545, -160.4751535558237, -272.08579113628247, -93.12801276034475, -49.17928483716404, -18.30705982388263, 18.682609057562885, 6.72149957786112, -0.6592561399836145, -15.951333352465838, -114.70539932422622, -26.66606292458654, -51.12568348114569, 17.526282875150493, -124.2013266923094, 11.626596937324567, -31.516106210085336, -66.8752417557526, -144.03450637131147, -102.94811944613615, -34.712499162727994, -39.873960598067384, -73.42093429930938, -155.97983940696116, 5.092983572759451, -77.59469614044802, -95.11591030299014, -7.188337713046935, -21.040357449127427, -106.2238658395706, -116.18474463019022, -85.99974636682853, -36.94317943851753, -83.68117787324762], "episode_lengths": [60, 91, 41, 53, 33, 60, 84, 55, 79, 86, 83, 50, 64, 77, 60, 89, 34, 62, 30, 68, 38, 58, 88, 36, 72, 100, 76, 43, 58, 49, 75, 50, 51, 51, 70, 73, 46, 48, 88, 83, 82, 97, 69, 70, 81, 46, 89, 73, 105, 54, 61, 65, 55, 61, 47, 88, 84, 67, 49, 72, 45, 86, 64, 104, 54, 37, 30, 96, 117, 84, 60, 56, 28, 35, 40, 46, 80, 48, 61, 35, 82, 29, 61, 62, 92, 78, 56, 56, 64, 94, 39, 64, 70, 46, 55, 73, 87, 68, 58, 67], "policy_policy_0_reward": [-52.942984972723934, -204.75784277299027, -2.428103562022252, -43.57163780285498, 15.176324539749054, -65.53128258961077, -90.62056872957518, -24.30263529070223, -131.93142088650373, -147.8428733824051, -107.973077801448, -38.57589766222238, -65.87714181678416, -95.84800398532785, -40.17913855383161, -114.7027560168433, 14.153440102131757, -45.86852832964651, 15.734463545768843, -79.5943596807243, 5.972107409144948, -23.793433324216217, -172.82112158573182, 9.804073117436012, -104.69974648510735, -203.60211813981155, -114.53188200905271, 3.1057301896677276, -54.089391545649114, -9.51110725643483, -106.17376627554457, -33.72392329078125, -4.868979660433227, -3.3869575410766286, -93.87368511955195, -110.85085991721776, -3.1212067346064787, -18.209977993758457, -171.38295468229313, -146.39021029315649, -129.57492878392105, -159.99002450232268, -85.56682811724235, -97.75686702262627, -139.32171409141355, -6.950965860489259, -138.6054839092421, -109.65170423736129, -210.31549486794012, -32.53183973934058, -52.36943916600503, -66.87651147629703, -16.42255532640845, -67.39713793681811, -17.77536088220772, -182.0870200891583, -155.81366643335878, -84.08228542885884, -5.269093647564754, -95.3474667843543, -13.91897055454967, -172.87111773962593, -65.23147341705771, -211.78665243369653, -26.774536336375693, 10.250358842517345, 14.142756066674545, -160.4751535558237, -272.08579113628247, -93.12801276034475, -49.17928483716404, -18.30705982388263, 18.682609057562885, 6.72149957786112, -0.6592561399836145, -15.951333352465838, -114.70539932422622, -26.66606292458654, -51.12568348114569, 17.526282875150493, -124.2013266923094, 11.626596937324567, -31.516106210085336, -66.8752417557526, -144.03450637131147, -102.94811944613615, -34.712499162727994, -39.873960598067384, -73.42093429930938, -155.97983940696116, 5.092983572759451, -77.59469614044802, -95.11591030299014, -7.188337713046935, -21.040357449127427, -106.2238658395706, -116.18474463019022, -85.99974636682853, -36.94317943851753, -83.68117787324762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29392688398412986, "mean_inference_ms": 0.9073431530257621, "mean_action_processing_ms": 0.16296696858441856, "mean_env_wait_ms": 2.1487124527838497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005949735641479492, "StateBufferConnector_ms": 0.0041005611419677734, "ViewRequirementAgentConnector_ms": 0.1034092903137207}, "num_episodes": 60, "episode_return_max": 18.682609057562885, "episode_return_min": -272.08579113628247, "episode_return_mean": -71.29697075673658, "episodes_this_iter": 60}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.7386213910034, "num_env_steps_trained_throughput_per_sec": 323.7386213910034, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 14357.64, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14357.56, "sample_time_ms": 2984.296, "learn_time_ms": 11356.555, "learn_throughput": 352.219, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "64a97_00000", "date": "2024-07-26_23-22-29", "timestamp": 1722016349, "time_this_iter_s": 12.364173650741577, "time_total_s": 1027.8438239097595, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1027.8438239097595, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 11.117647058823529, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.69517497917016, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.21901890498847934, "policy_loss": -0.01187594236592607, "vf_loss": 0.213913651703236, "vf_explained_var": 0.9996098902697365, "kl": 0.010248257558093164, "entropy": -0.14166555591412663, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": 18.682609057562885, "episode_reward_min": -272.08579113628247, "episode_reward_mean": -72.26695933720029, "episode_len_mean": 64.81, "episode_media": {}, "episodes_timesteps_total": 6481, "policy_reward_min": {"policy_0": -272.08579113628247}, "policy_reward_max": {"policy_0": 18.682609057562885}, "policy_reward_mean": {"policy_0": -72.26695933720029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.23147341705771, -211.78665243369653, -26.774536336375693, 10.250358842517345, 14.142756066674545, -160.4751535558237, -272.08579113628247, -93.12801276034475, -49.17928483716404, -18.30705982388263, 18.682609057562885, 6.72149957786112, -0.6592561399836145, -15.951333352465838, -114.70539932422622, -26.66606292458654, -51.12568348114569, 17.526282875150493, -124.2013266923094, 11.626596937324567, -31.516106210085336, -66.8752417557526, -144.03450637131147, -102.94811944613615, -34.712499162727994, -39.873960598067384, -73.42093429930938, -155.97983940696116, 5.092983572759451, -77.59469614044802, -95.11591030299014, -7.188337713046935, -21.040357449127427, -106.2238658395706, -116.18474463019022, -85.99974636682853, -36.94317943851753, -83.68117787324762, -111.93580932228988, -13.969048208305182, -28.553845811389827, -56.39508097869067, 2.3121057206594995, -160.2139502477644, -132.75480687329866, -73.83351041983227, -97.87268048312326, -10.47790448764217, -72.29998721217764, -114.41412046038441, -87.04293633054785, 10.885696071999925, -166.84837127472744, -87.53429677456509, -71.34983580165643, -27.16634396229859, -45.06612175320559, -148.453363033159, -88.43919228248713, -183.262695259114, -157.87600914977835, -181.91452865817902, -49.408859919297555, -17.345461025375982, -104.90440101409575, -46.723273466059425, -118.34256443072631, 17.30168692282571, -98.22996304821874, 7.768326825952503, -0.2808650278852729, -113.887550510262, -196.99945152153416, -156.05609251657012, -147.55520189310224, -179.7867091043928, -131.97735903380712, -77.26455345928308, -98.29247846480025, -67.12808976980058, -60.17694674663757, 12.28698257434428, -23.513919296836693, -117.48178095892463, -71.13405365586482, -170.08748556764223, -8.596863442268562, 2.0907223989067543, -19.82819616789022, -31.197461262430544, -167.4253278792355, -15.029302160058409, 11.798350033578663, -25.993131279235513, -18.412496906839447, -18.05384028937521, 12.319870379562506, -137.84563641315373, -119.18695551036556, -152.07180183145903], "episode_lengths": [64, 104, 54, 37, 30, 96, 117, 84, 60, 56, 28, 35, 40, 46, 80, 48, 61, 35, 82, 29, 61, 62, 92, 78, 56, 56, 64, 94, 39, 64, 70, 46, 55, 73, 87, 68, 58, 67, 89, 46, 49, 60, 36, 82, 81, 61, 73, 55, 75, 75, 71, 43, 99, 69, 66, 59, 63, 91, 80, 102, 82, 90, 54, 44, 78, 56, 84, 34, 73, 32, 38, 87, 99, 82, 92, 89, 80, 65, 72, 65, 65, 29, 46, 77, 63, 90, 42, 47, 54, 54, 80, 56, 33, 48, 52, 48, 32, 89, 90, 89], "policy_policy_0_reward": [-65.23147341705771, -211.78665243369653, -26.774536336375693, 10.250358842517345, 14.142756066674545, -160.4751535558237, -272.08579113628247, -93.12801276034475, -49.17928483716404, -18.30705982388263, 18.682609057562885, 6.72149957786112, -0.6592561399836145, -15.951333352465838, -114.70539932422622, -26.66606292458654, -51.12568348114569, 17.526282875150493, -124.2013266923094, 11.626596937324567, -31.516106210085336, -66.8752417557526, -144.03450637131147, -102.94811944613615, -34.712499162727994, -39.873960598067384, -73.42093429930938, -155.97983940696116, 5.092983572759451, -77.59469614044802, -95.11591030299014, -7.188337713046935, -21.040357449127427, -106.2238658395706, -116.18474463019022, -85.99974636682853, -36.94317943851753, -83.68117787324762, -111.93580932228988, -13.969048208305182, -28.553845811389827, -56.39508097869067, 2.3121057206594995, -160.2139502477644, -132.75480687329866, -73.83351041983227, -97.87268048312326, -10.47790448764217, -72.29998721217764, -114.41412046038441, -87.04293633054785, 10.885696071999925, -166.84837127472744, -87.53429677456509, -71.34983580165643, -27.16634396229859, -45.06612175320559, -148.453363033159, -88.43919228248713, -183.262695259114, -157.87600914977835, -181.91452865817902, -49.408859919297555, -17.345461025375982, -104.90440101409575, -46.723273466059425, -118.34256443072631, 17.30168692282571, -98.22996304821874, 7.768326825952503, -0.2808650278852729, -113.887550510262, -196.99945152153416, -156.05609251657012, -147.55520189310224, -179.7867091043928, -131.97735903380712, -77.26455345928308, -98.29247846480025, -67.12808976980058, -60.17694674663757, 12.28698257434428, -23.513919296836693, -117.48178095892463, -71.13405365586482, -170.08748556764223, -8.596863442268562, 2.0907223989067543, -19.82819616789022, -31.197461262430544, -167.4253278792355, -15.029302160058409, 11.798350033578663, -25.993131279235513, -18.412496906839447, -18.05384028937521, 12.319870379562506, -137.84563641315373, -119.18695551036556, -152.07180183145903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29389319202704667, "mean_inference_ms": 0.907521733781569, "mean_action_processing_ms": 0.1631510314706761, "mean_env_wait_ms": 2.1495181253368547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005704164505004883, "StateBufferConnector_ms": 0.004024982452392578, "ViewRequirementAgentConnector_ms": 0.1015479564666748}, "num_episodes": 62, "episode_return_max": 18.682609057562885, "episode_return_min": -272.08579113628247, "episode_return_mean": -72.26695933720029, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.63049033215685, "num_env_steps_trained_throughput_per_sec": 268.63049033215685, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 14369.232, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14369.155, "sample_time_ms": 2983.286, "learn_time_ms": 11369.118, "learn_throughput": 351.83, "synch_weights_time_ms": 15.418}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "64a97_00000", "date": "2024-07-26_23-22-44", "timestamp": 1722016364, "time_this_iter_s": 14.898271083831787, "time_total_s": 1042.7420949935913, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1042.7420949935913, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.322727272727272, "ram_util_percent": 28.70454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.17021078964074, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.16715966321450348, "policy_loss": -0.00784767858616154, "vf_loss": 0.1572886691506331, "vf_explained_var": 0.9996964917207758, "kl": 0.010372966724389747, "entropy": -0.19647306910386153, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 19.236498629639343, "episode_reward_min": -214.13810019115073, "episode_reward_mean": -61.351299335032564, "episode_len_mean": 61.35, "episode_media": {}, "episodes_timesteps_total": 6135, "policy_reward_min": {"policy_0": -214.13810019115073}, "policy_reward_max": {"policy_0": 19.236498629639343}, "policy_reward_mean": {"policy_0": -61.351299335032564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.22996304821874, 7.768326825952503, -0.2808650278852729, -113.887550510262, -196.99945152153416, -156.05609251657012, -147.55520189310224, -179.7867091043928, -131.97735903380712, -77.26455345928308, -98.29247846480025, -67.12808976980058, -60.17694674663757, 12.28698257434428, -23.513919296836693, -117.48178095892463, -71.13405365586482, -170.08748556764223, -8.596863442268562, 2.0907223989067543, -19.82819616789022, -31.197461262430544, -167.4253278792355, -15.029302160058409, 11.798350033578663, -25.993131279235513, -18.412496906839447, -18.05384028937521, 12.319870379562506, -137.84563641315373, -119.18695551036556, -152.07180183145903, 17.435388604817227, -147.27619666880017, -24.148569422928972, -48.58394696586436, -80.8760051566527, 2.5700823859157778, -110.3061350743091, -104.13909045854341, -86.33139968817785, -66.91466721650826, -83.58117871972448, -14.021003888192748, 15.9170946655838, -73.87815882261404, 11.791039064191903, 1.6544087556913636, -168.85498365969403, -110.50558465993417, 2.9813921885422214, 3.0986035660405715, 3.8762083470409396, -68.51349874058837, 19.236498629639343, -93.99661784470442, -56.933658140453055, -19.845768340249226, -79.36637116445141, -55.85319893039443, -16.762589579837343, 6.006141912388982, -50.69216305037431, -11.393981884988106, -123.57245151140661, -96.72687645337834, -49.098341855781634, -21.974527811060288, -11.02703812065561, -168.9540213731175, -59.054505120670875, 18.896662974632275, -23.412564343910404, -39.1743963077899, -57.714061443052906, -70.51085686292218, -39.63508803632724, 3.610236479485054, 15.141286563564453, -9.821448712602189, -111.60438330134662, -28.669533906816312, -26.809868869068456, -141.11306423811155, -139.8399184824186, 18.65544493842643, -22.39682451947457, -89.35714770756213, -104.34605857640547, -8.62663007946132, -142.89129797982378, 12.980674350597969, -145.8693857009259, -88.17564706457539, 17.0597222160197, -33.75227720530056, -97.9324904628961, -38.88991324750215, -214.13810019115073, -150.94807007680413], "episode_lengths": [73, 32, 38, 87, 99, 82, 92, 89, 80, 65, 72, 65, 65, 29, 46, 77, 63, 90, 42, 47, 54, 54, 80, 56, 33, 48, 52, 48, 32, 89, 90, 89, 35, 92, 47, 55, 65, 43, 73, 72, 83, 65, 82, 45, 29, 73, 31, 44, 84, 87, 42, 36, 42, 68, 29, 78, 59, 56, 66, 61, 47, 41, 63, 42, 78, 71, 65, 49, 51, 96, 62, 37, 54, 59, 59, 74, 53, 37, 27, 47, 89, 48, 57, 82, 81, 29, 57, 68, 74, 51, 88, 29, 83, 69, 40, 57, 84, 61, 93, 83], "policy_policy_0_reward": [-98.22996304821874, 7.768326825952503, -0.2808650278852729, -113.887550510262, -196.99945152153416, -156.05609251657012, -147.55520189310224, -179.7867091043928, -131.97735903380712, -77.26455345928308, -98.29247846480025, -67.12808976980058, -60.17694674663757, 12.28698257434428, -23.513919296836693, -117.48178095892463, -71.13405365586482, -170.08748556764223, -8.596863442268562, 2.0907223989067543, -19.82819616789022, -31.197461262430544, -167.4253278792355, -15.029302160058409, 11.798350033578663, -25.993131279235513, -18.412496906839447, -18.05384028937521, 12.319870379562506, -137.84563641315373, -119.18695551036556, -152.07180183145903, 17.435388604817227, -147.27619666880017, -24.148569422928972, -48.58394696586436, -80.8760051566527, 2.5700823859157778, -110.3061350743091, -104.13909045854341, -86.33139968817785, -66.91466721650826, -83.58117871972448, -14.021003888192748, 15.9170946655838, -73.87815882261404, 11.791039064191903, 1.6544087556913636, -168.85498365969403, -110.50558465993417, 2.9813921885422214, 3.0986035660405715, 3.8762083470409396, -68.51349874058837, 19.236498629639343, -93.99661784470442, -56.933658140453055, -19.845768340249226, -79.36637116445141, -55.85319893039443, -16.762589579837343, 6.006141912388982, -50.69216305037431, -11.393981884988106, -123.57245151140661, -96.72687645337834, -49.098341855781634, -21.974527811060288, -11.02703812065561, -168.9540213731175, -59.054505120670875, 18.896662974632275, -23.412564343910404, -39.1743963077899, -57.714061443052906, -70.51085686292218, -39.63508803632724, 3.610236479485054, 15.141286563564453, -9.821448712602189, -111.60438330134662, -28.669533906816312, -26.809868869068456, -141.11306423811155, -139.8399184824186, 18.65544493842643, -22.39682451947457, -89.35714770756213, -104.34605857640547, -8.62663007946132, -142.89129797982378, 12.980674350597969, -145.8693857009259, -88.17564706457539, 17.0597222160197, -33.75227720530056, -97.9324904628961, -38.88991324750215, -214.13810019115073, -150.94807007680413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29408884815781594, "mean_inference_ms": 0.907884733863339, "mean_action_processing_ms": 0.16318288833230746, "mean_env_wait_ms": 2.150709274488664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00577998161315918, "StateBufferConnector_ms": 0.004029512405395508, "ViewRequirementAgentConnector_ms": 0.10214734077453613}, "num_episodes": 68, "episode_return_max": 19.236498629639343, "episode_return_min": -214.13810019115073, "episode_return_mean": -61.351299335032564, "episodes_this_iter": 68}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.58413621490445, "num_env_steps_trained_throughput_per_sec": 265.58413621490445, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 14375.029, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14374.952, "sample_time_ms": 2984.694, "learn_time_ms": 11373.84, "learn_throughput": 351.684, "synch_weights_time_ms": 15.151}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "64a97_00000", "date": "2024-07-26_23-22-59", "timestamp": 1722016379, "time_this_iter_s": 15.066952228546143, "time_total_s": 1057.8090472221375, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb734280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1057.8090472221375, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 10.59047619047619, "ram_util_percent": 28.738095238095234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.64237287342549, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.16126080807637966, "policy_loss": -0.007225233002585204, "vf_loss": 0.1495119721473505, "vf_explained_var": 0.9997282713030775, "kl": 0.011097635694553295, "entropy": -0.2119535458633133, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": 23.432825299444634, "episode_reward_min": -214.13810019115073, "episode_reward_mean": -57.328565609779844, "episode_len_mean": 60.54, "episode_media": {}, "episodes_timesteps_total": 6054, "policy_reward_min": {"policy_0": -214.13810019115073}, "policy_reward_max": {"policy_0": 23.432825299444634}, "policy_reward_mean": {"policy_0": -57.328565609779844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.72687645337834, -49.098341855781634, -21.974527811060288, -11.02703812065561, -168.9540213731175, -59.054505120670875, 18.896662974632275, -23.412564343910404, -39.1743963077899, -57.714061443052906, -70.51085686292218, -39.63508803632724, 3.610236479485054, 15.141286563564453, -9.821448712602189, -111.60438330134662, -28.669533906816312, -26.809868869068456, -141.11306423811155, -139.8399184824186, 18.65544493842643, -22.39682451947457, -89.35714770756213, -104.34605857640547, -8.62663007946132, -142.89129797982378, 12.980674350597969, -145.8693857009259, -88.17564706457539, 17.0597222160197, -33.75227720530056, -97.9324904628961, -38.88991324750215, -214.13810019115073, -150.94807007680413, -69.01810371539875, 18.16321335066657, -0.08051421030166672, -201.03304158801473, -167.29343655838252, -5.417101061472846, -97.20602254866812, -8.780511545666126, -112.5179313170217, 15.81577216180747, -13.877310750077092, 21.51639609465081, -133.79332562059338, -19.36365508633673, -23.681527880903865, -61.99600902196457, -118.32286666266666, -118.3202223370438, -175.07043111510413, -106.39647197834785, -100.24263082897298, 0.09478947912871072, 21.265232927393836, -18.61912198550467, -68.67683901028113, -14.023116098709904, -5.299184022943941, -7.115288044399685, -80.0215854815426, -91.93907952740975, -96.28211057860332, -48.880723700821434, 3.644585593801163, -138.3711678071811, -101.91063789023788, 23.432825299444634, -165.1118422825975, -111.6082285244151, -100.70421849755576, -67.2583874681733, -61.65058995065037, -3.3243177638600865, 16.870400616384416, 14.414745391813018, 10.350028977237322, -137.92516381389078, -23.01633614074613, 19.719829361429557, -87.80157634545559, -118.1465297383808, -16.319231177327815, -4.739065542148392, -5.849028486637919, -61.49701128237915, -139.81889507027464, -17.55791167404157, -125.4671657427149, -140.29152383542757, -18.138525059461603, -9.064643470692026, 4.700952155149417, 1.2603497231430785, -132.40179211756558, 9.81198901060723, -16.555408633485357], "episode_lengths": [71, 65, 49, 51, 96, 62, 37, 54, 59, 59, 74, 53, 37, 27, 47, 89, 48, 57, 82, 81, 29, 57, 68, 74, 51, 88, 29, 83, 69, 40, 57, 84, 61, 93, 83, 74, 29, 42, 97, 85, 40, 71, 47, 76, 38, 48, 33, 86, 51, 59, 63, 74, 76, 100, 76, 85, 42, 31, 54, 63, 51, 46, 47, 65, 74, 83, 57, 41, 80, 73, 28, 84, 74, 82, 78, 60, 43, 31, 31, 30, 81, 58, 31, 80, 76, 55, 52, 41, 61, 81, 59, 78, 92, 53, 41, 44, 37, 89, 33, 50], "policy_policy_0_reward": [-96.72687645337834, -49.098341855781634, -21.974527811060288, -11.02703812065561, -168.9540213731175, -59.054505120670875, 18.896662974632275, -23.412564343910404, -39.1743963077899, -57.714061443052906, -70.51085686292218, -39.63508803632724, 3.610236479485054, 15.141286563564453, -9.821448712602189, -111.60438330134662, -28.669533906816312, -26.809868869068456, -141.11306423811155, -139.8399184824186, 18.65544493842643, -22.39682451947457, -89.35714770756213, -104.34605857640547, -8.62663007946132, -142.89129797982378, 12.980674350597969, -145.8693857009259, -88.17564706457539, 17.0597222160197, -33.75227720530056, -97.9324904628961, -38.88991324750215, -214.13810019115073, -150.94807007680413, -69.01810371539875, 18.16321335066657, -0.08051421030166672, -201.03304158801473, -167.29343655838252, -5.417101061472846, -97.20602254866812, -8.780511545666126, -112.5179313170217, 15.81577216180747, -13.877310750077092, 21.51639609465081, -133.79332562059338, -19.36365508633673, -23.681527880903865, -61.99600902196457, -118.32286666266666, -118.3202223370438, -175.07043111510413, -106.39647197834785, -100.24263082897298, 0.09478947912871072, 21.265232927393836, -18.61912198550467, -68.67683901028113, -14.023116098709904, -5.299184022943941, -7.115288044399685, -80.0215854815426, -91.93907952740975, -96.28211057860332, -48.880723700821434, 3.644585593801163, -138.3711678071811, -101.91063789023788, 23.432825299444634, -165.1118422825975, -111.6082285244151, -100.70421849755576, -67.2583874681733, -61.65058995065037, -3.3243177638600865, 16.870400616384416, 14.414745391813018, 10.350028977237322, -137.92516381389078, -23.01633614074613, 19.719829361429557, -87.80157634545559, -118.1465297383808, -16.319231177327815, -4.739065542148392, -5.849028486637919, -61.49701128237915, -139.81889507027464, -17.55791167404157, -125.4671657427149, -140.29152383542757, -18.138525059461603, -9.064643470692026, 4.700952155149417, 1.2603497231430785, -132.40179211756558, 9.81198901060723, -16.555408633485357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940297781993582, "mean_inference_ms": 0.9074678370231726, "mean_action_processing_ms": 0.16320232902172369, "mean_env_wait_ms": 2.1519626056780576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005672931671142578, "StateBufferConnector_ms": 0.004015922546386719, "ViewRequirementAgentConnector_ms": 0.10071706771850586}, "num_episodes": 65, "episode_return_max": 23.432825299444634, "episode_return_min": -214.13810019115073, "episode_return_mean": -57.328565609779844, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.73087983864326, "num_env_steps_trained_throughput_per_sec": 264.73087983864326, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 14427.476, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14427.398, "sample_time_ms": 2987.545, "learn_time_ms": 11423.38, "learn_throughput": 350.159, "synch_weights_time_ms": 15.202}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "64a97_00000", "date": "2024-07-26_23-23-14", "timestamp": 1722016394, "time_this_iter_s": 15.117105960845947, "time_total_s": 1072.9261531829834, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b88b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1072.9261531829834, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 10.181818181818182, "ram_util_percent": 28.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.16131013135115, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.16819386803448044, "policy_loss": -0.0009481754580823084, "vf_loss": 0.14722631112672388, "vf_explained_var": 0.9996963125964006, "kl": 0.012788064653432267, "entropy": -0.24938602331870546, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 23.432825299444634, "episode_reward_min": -174.83356449291057, "episode_reward_mean": -57.949003093475206, "episode_len_mean": 61.3, "episode_media": {}, "episodes_timesteps_total": 6130, "policy_reward_min": {"policy_0": -174.83356449291057}, "policy_reward_max": {"policy_0": 23.432825299444634}, "policy_reward_mean": {"policy_0": -57.949003093475206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.0215854815426, -91.93907952740975, -96.28211057860332, -48.880723700821434, 3.644585593801163, -138.3711678071811, -101.91063789023788, 23.432825299444634, -165.1118422825975, -111.6082285244151, -100.70421849755576, -67.2583874681733, -61.65058995065037, -3.3243177638600865, 16.870400616384416, 14.414745391813018, 10.350028977237322, -137.92516381389078, -23.01633614074613, 19.719829361429557, -87.80157634545559, -118.1465297383808, -16.319231177327815, -4.739065542148392, -5.849028486637919, -61.49701128237915, -139.81889507027464, -17.55791167404157, -125.4671657427149, -140.29152383542757, -18.138525059461603, -9.064643470692026, 4.700952155149417, 1.2603497231430785, -132.40179211756558, 9.81198901060723, -16.555408633485357, -74.27260560095208, -113.20533680238582, -113.95619399541938, -59.42487236263601, -18.575337364796326, -75.26557631200524, -103.48400823219896, -5.330134132349249, -33.396246154495955, -123.80736075414636, -48.01434008144979, 5.708117555541139, -21.746690564252898, -47.64481042778025, -37.95652246512588, -65.43550181921385, -7.75656098219216, -70.37538188838838, -128.35435671360455, 5.753943304919629, 17.550569599079534, -69.79762616376965, -66.55490226380819, -168.59688573370764, 2.9268453837940536, -138.29147847208142, -99.66726385590115, -64.29456425186547, -80.77182599072405, -24.727191410729638, -60.34088636781712, 15.986885192073819, -107.1779962228405, -77.95547518357266, -33.38544653979808, 3.4349867387277815, -7.368027474574236, -39.6426187635832, -174.83356449291057, -36.845504339082744, -151.0735842964962, 3.1523723579441825, -46.578112721542894, 11.833955904906546, -91.49498682982775, -154.13591775259854, -79.83088098954798, -74.22098433069871, -139.8994814752942, -129.53110103455293, -152.76425719922725, 10.844989043792472, -35.925840830073035, -5.139367026970765, -57.6069875380263, -50.36112329474807, 11.391738935126892, -67.2341663816516, -46.77079655159731, -4.979623812935154, -65.19291332028239, -0.3244130698758434, -114.72008925265284], "episode_lengths": [65, 74, 83, 57, 41, 80, 73, 28, 84, 74, 82, 78, 60, 43, 31, 31, 30, 81, 58, 31, 80, 76, 55, 52, 41, 61, 81, 59, 78, 92, 53, 41, 44, 37, 89, 33, 50, 67, 88, 75, 59, 49, 79, 74, 49, 56, 80, 57, 38, 52, 65, 58, 61, 48, 63, 79, 45, 30, 71, 74, 93, 48, 81, 75, 68, 73, 47, 61, 37, 81, 69, 58, 42, 47, 54, 90, 55, 83, 45, 58, 33, 77, 83, 67, 65, 95, 79, 83, 36, 52, 49, 61, 56, 35, 67, 63, 41, 77, 47, 76], "policy_policy_0_reward": [-80.0215854815426, -91.93907952740975, -96.28211057860332, -48.880723700821434, 3.644585593801163, -138.3711678071811, -101.91063789023788, 23.432825299444634, -165.1118422825975, -111.6082285244151, -100.70421849755576, -67.2583874681733, -61.65058995065037, -3.3243177638600865, 16.870400616384416, 14.414745391813018, 10.350028977237322, -137.92516381389078, -23.01633614074613, 19.719829361429557, -87.80157634545559, -118.1465297383808, -16.319231177327815, -4.739065542148392, -5.849028486637919, -61.49701128237915, -139.81889507027464, -17.55791167404157, -125.4671657427149, -140.29152383542757, -18.138525059461603, -9.064643470692026, 4.700952155149417, 1.2603497231430785, -132.40179211756558, 9.81198901060723, -16.555408633485357, -74.27260560095208, -113.20533680238582, -113.95619399541938, -59.42487236263601, -18.575337364796326, -75.26557631200524, -103.48400823219896, -5.330134132349249, -33.396246154495955, -123.80736075414636, -48.01434008144979, 5.708117555541139, -21.746690564252898, -47.64481042778025, -37.95652246512588, -65.43550181921385, -7.75656098219216, -70.37538188838838, -128.35435671360455, 5.753943304919629, 17.550569599079534, -69.79762616376965, -66.55490226380819, -168.59688573370764, 2.9268453837940536, -138.29147847208142, -99.66726385590115, -64.29456425186547, -80.77182599072405, -24.727191410729638, -60.34088636781712, 15.986885192073819, -107.1779962228405, -77.95547518357266, -33.38544653979808, 3.4349867387277815, -7.368027474574236, -39.6426187635832, -174.83356449291057, -36.845504339082744, -151.0735842964962, 3.1523723579441825, -46.578112721542894, 11.833955904906546, -91.49498682982775, -154.13591775259854, -79.83088098954798, -74.22098433069871, -139.8994814752942, -129.53110103455293, -152.76425719922725, 10.844989043792472, -35.925840830073035, -5.139367026970765, -57.6069875380263, -50.36112329474807, 11.391738935126892, -67.2341663816516, -46.77079655159731, -4.979623812935154, -65.19291332028239, -0.3244130698758434, -114.72008925265284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940806099695121, "mean_inference_ms": 0.9077761480758505, "mean_action_processing_ms": 0.16315396203656882, "mean_env_wait_ms": 2.152488963279051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005528926849365234, "StateBufferConnector_ms": 0.004057645797729492, "ViewRequirementAgentConnector_ms": 0.10094952583312988}, "num_episodes": 63, "episode_return_max": 23.432825299444634, "episode_return_min": -174.83356449291057, "episode_return_mean": -57.949003093475206, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.1643772271423, "num_env_steps_trained_throughput_per_sec": 325.1643772271423, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 14232.906, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14232.825, "sample_time_ms": 2982.277, "learn_time_ms": 11233.542, "learn_throughput": 356.076, "synch_weights_time_ms": 15.749}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "64a97_00000", "date": "2024-07-26_23-23-26", "timestamp": 1722016406, "time_this_iter_s": 12.311640739440918, "time_total_s": 1085.2377939224243, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a8550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1085.2377939224243, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.129411764705882, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.33152043571075, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.2069108604870659, "policy_loss": -0.00914338752675879, "vf_loss": 0.20029858152071636, "vf_explained_var": 0.9995108593255282, "kl": 0.00901639339269124, "entropy": -0.206201877068573, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 16.71783062955231, "episode_reward_min": -211.0962309290528, "episode_reward_mean": -64.30751138902586, "episode_len_mean": 63.14, "episode_media": {}, "episodes_timesteps_total": 6314, "policy_reward_min": {"policy_0": -211.0962309290528}, "policy_reward_max": {"policy_0": 16.71783062955231}, "policy_reward_mean": {"policy_0": -64.30751138902586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.66726385590115, -64.29456425186547, -80.77182599072405, -24.727191410729638, -60.34088636781712, 15.986885192073819, -107.1779962228405, -77.95547518357266, -33.38544653979808, 3.4349867387277815, -7.368027474574236, -39.6426187635832, -174.83356449291057, -36.845504339082744, -151.0735842964962, 3.1523723579441825, -46.578112721542894, 11.833955904906546, -91.49498682982775, -154.13591775259854, -79.83088098954798, -74.22098433069871, -139.8994814752942, -129.53110103455293, -152.76425719922725, 10.844989043792472, -35.925840830073035, -5.139367026970765, -57.6069875380263, -50.36112329474807, 11.391738935126892, -67.2341663816516, -46.77079655159731, -4.979623812935154, -65.19291332028239, -0.3244130698758434, -114.72008925265284, -83.66755681517368, -76.47599532673917, -81.34228062719441, -28.815404303143943, -1.0518768596191543, -98.37222719270922, -5.6938403289694515, -3.6477616602330647, -112.24637689799205, -5.766230034564978, -41.32363829228828, -51.051927034774444, -84.01255820729058, -9.623612409188565, -9.450163080206352, -28.553886989764624, -174.93432601265351, -121.64632152511976, -116.7953482148165, 6.155239801340492, -9.939073083272305, -5.284254633544439, 11.09621222521559, -117.8082278755915, -20.084460093265953, -58.44164576628613, 10.78862847794717, -49.86497529678421, -15.091814309484864, -34.1307520131046, -137.98030633437622, -172.4066291709501, -104.97790776614531, -83.82350321720526, -148.07412526719335, -95.47609310983296, -44.62319314754044, -187.65213083807524, -96.34633652061314, -61.99013151852453, -49.00035267856443, -211.0962309290528, -56.81666767246872, -67.31516431709416, 7.7204472884328865, 16.71783062955231, -176.3844035679083, 9.023990091668535, -15.14234582009426, -125.61611161957178, -138.82599306338105, -72.48530048861626, -106.60813127450618, -23.07141602239464, -167.83066662410178, -112.33511404383594, -65.27714381877216, 11.964065578896854, 3.05231295550296, -42.2444631101786, -140.10461448416282, -112.981818393862, -27.51697181891712], "episode_lengths": [75, 68, 73, 47, 61, 37, 81, 69, 58, 42, 47, 54, 90, 55, 83, 45, 58, 33, 77, 83, 67, 65, 95, 79, 83, 36, 52, 49, 61, 56, 35, 67, 63, 41, 77, 47, 76, 66, 65, 69, 58, 44, 79, 50, 46, 76, 44, 56, 56, 83, 55, 49, 48, 91, 77, 76, 43, 50, 42, 33, 90, 52, 62, 37, 60, 50, 55, 94, 87, 87, 69, 92, 76, 57, 93, 71, 76, 60, 99, 63, 71, 34, 28, 88, 39, 43, 77, 81, 68, 72, 49, 91, 74, 76, 30, 47, 59, 81, 75, 60], "policy_policy_0_reward": [-99.66726385590115, -64.29456425186547, -80.77182599072405, -24.727191410729638, -60.34088636781712, 15.986885192073819, -107.1779962228405, -77.95547518357266, -33.38544653979808, 3.4349867387277815, -7.368027474574236, -39.6426187635832, -174.83356449291057, -36.845504339082744, -151.0735842964962, 3.1523723579441825, -46.578112721542894, 11.833955904906546, -91.49498682982775, -154.13591775259854, -79.83088098954798, -74.22098433069871, -139.8994814752942, -129.53110103455293, -152.76425719922725, 10.844989043792472, -35.925840830073035, -5.139367026970765, -57.6069875380263, -50.36112329474807, 11.391738935126892, -67.2341663816516, -46.77079655159731, -4.979623812935154, -65.19291332028239, -0.3244130698758434, -114.72008925265284, -83.66755681517368, -76.47599532673917, -81.34228062719441, -28.815404303143943, -1.0518768596191543, -98.37222719270922, -5.6938403289694515, -3.6477616602330647, -112.24637689799205, -5.766230034564978, -41.32363829228828, -51.051927034774444, -84.01255820729058, -9.623612409188565, -9.450163080206352, -28.553886989764624, -174.93432601265351, -121.64632152511976, -116.7953482148165, 6.155239801340492, -9.939073083272305, -5.284254633544439, 11.09621222521559, -117.8082278755915, -20.084460093265953, -58.44164576628613, 10.78862847794717, -49.86497529678421, -15.091814309484864, -34.1307520131046, -137.98030633437622, -172.4066291709501, -104.97790776614531, -83.82350321720526, -148.07412526719335, -95.47609310983296, -44.62319314754044, -187.65213083807524, -96.34633652061314, -61.99013151852453, -49.00035267856443, -211.0962309290528, -56.81666767246872, -67.31516431709416, 7.7204472884328865, 16.71783062955231, -176.3844035679083, 9.023990091668535, -15.14234582009426, -125.61611161957178, -138.82599306338105, -72.48530048861626, -106.60813127450618, -23.07141602239464, -167.83066662410178, -112.33511404383594, -65.27714381877216, 11.964065578896854, 3.05231295550296, -42.2444631101786, -140.10461448416282, -112.981818393862, -27.51697181891712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2941774399079156, "mean_inference_ms": 0.9077754028282812, "mean_action_processing_ms": 0.1631854695157512, "mean_env_wait_ms": 2.1530311631764207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053789615631103516, "StateBufferConnector_ms": 0.004051923751831055, "ViewRequirementAgentConnector_ms": 0.10188436508178711}, "num_episodes": 63, "episode_return_max": 16.71783062955231, "episode_return_min": -211.0962309290528, "episode_return_mean": -64.30751138902586, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.7044445449745, "num_env_steps_trained_throughput_per_sec": 359.7044445449745, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 13874.551, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13874.469, "sample_time_ms": 2973.367, "learn_time_ms": 10884.233, "learn_throughput": 367.504, "synch_weights_time_ms": 15.611}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "64a97_00000", "date": "2024-07-26_23-23-38", "timestamp": 1722016418, "time_this_iter_s": 11.129580974578857, "time_total_s": 1096.3673748970032, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.3673748970032, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.30625, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.19630864908298, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1833679213450523, "policy_loss": -0.007854609638161491, "vf_loss": 0.1692419286739702, "vf_explained_var": 0.9997030774131417, "kl": 0.01258624235524625, "entropy": -0.286524728530397, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 21.517904175388836, "episode_reward_min": -211.0962309290528, "episode_reward_mean": -66.07798076677568, "episode_len_mean": 63.29, "episode_media": {}, "episodes_timesteps_total": 6329, "policy_reward_min": {"policy_0": -211.0962309290528}, "policy_reward_max": {"policy_0": 21.517904175388836}, "policy_reward_mean": {"policy_0": -66.07798076677568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.1307520131046, -137.98030633437622, -172.4066291709501, -104.97790776614531, -83.82350321720526, -148.07412526719335, -95.47609310983296, -44.62319314754044, -187.65213083807524, -96.34633652061314, -61.99013151852453, -49.00035267856443, -211.0962309290528, -56.81666767246872, -67.31516431709416, 7.7204472884328865, 16.71783062955231, -176.3844035679083, 9.023990091668535, -15.14234582009426, -125.61611161957178, -138.82599306338105, -72.48530048861626, -106.60813127450618, -23.07141602239464, -167.83066662410178, -112.33511404383594, -65.27714381877216, 11.964065578896854, 3.05231295550296, -42.2444631101786, -140.10461448416282, -112.981818393862, -27.51697181891712, -123.1633374806081, -66.83047904896064, -23.04234519889006, -121.06166850361944, -5.301612909702358, -116.99060601276048, -10.932172937794142, -111.13218095546078, -71.6382561671032, -69.99043149280872, 12.85033898776402, -4.229829127448836, -17.954772938635454, -83.57087224764683, -162.56363217195187, -83.50508383024555, -44.20390049963949, -96.05596201394106, -6.839358521068829, -22.755338973949698, -163.05345935810107, -4.297697082319823, -22.43475011288916, -206.361713100921, 6.5075843754194675, 9.20726396330773, -1.814850988327895, -70.17158813011307, 11.31281209605363, -0.4828239179365217, 14.585610465822272, -5.454709324424831, -6.6721797528050955, 13.083420648466777, -21.52592551532848, -158.0778289781604, -26.72338854430285, -177.936159836496, -190.64090062572845, 8.278901750180026, -59.09102863888504, -11.591269265224822, -16.762180585670144, -178.8665970976912, -117.33177854697232, -1.047551852116283, -27.718695693671, -78.38177850146295, -63.6519893254039, -38.07972745668529, 5.355143785370486, 21.517904175388836, -4.915463232992854, -120.29675561226023, 5.176187315794678, -158.60107353649218, -164.12320120208804, -19.204845264206543, -95.1952862478011, -93.1343721182414, -47.1188961802802, -44.55452447351047, -29.89062948508048, -18.00783495785517, -85.4537563042438, -115.58882025522065], "episode_lengths": [55, 94, 87, 87, 69, 92, 76, 57, 93, 71, 76, 60, 99, 63, 71, 34, 28, 88, 39, 43, 77, 81, 68, 72, 49, 91, 74, 76, 30, 47, 59, 81, 75, 60, 77, 65, 54, 89, 49, 76, 54, 76, 64, 78, 30, 43, 57, 68, 83, 72, 60, 76, 47, 52, 91, 47, 47, 98, 39, 39, 46, 68, 41, 47, 29, 44, 49, 38, 51, 82, 48, 90, 88, 41, 62, 42, 42, 96, 76, 42, 58, 68, 62, 59, 40, 30, 48, 89, 40, 94, 84, 54, 82, 83, 57, 53, 56, 54, 67, 76], "policy_policy_0_reward": [-34.1307520131046, -137.98030633437622, -172.4066291709501, -104.97790776614531, -83.82350321720526, -148.07412526719335, -95.47609310983296, -44.62319314754044, -187.65213083807524, -96.34633652061314, -61.99013151852453, -49.00035267856443, -211.0962309290528, -56.81666767246872, -67.31516431709416, 7.7204472884328865, 16.71783062955231, -176.3844035679083, 9.023990091668535, -15.14234582009426, -125.61611161957178, -138.82599306338105, -72.48530048861626, -106.60813127450618, -23.07141602239464, -167.83066662410178, -112.33511404383594, -65.27714381877216, 11.964065578896854, 3.05231295550296, -42.2444631101786, -140.10461448416282, -112.981818393862, -27.51697181891712, -123.1633374806081, -66.83047904896064, -23.04234519889006, -121.06166850361944, -5.301612909702358, -116.99060601276048, -10.932172937794142, -111.13218095546078, -71.6382561671032, -69.99043149280872, 12.85033898776402, -4.229829127448836, -17.954772938635454, -83.57087224764683, -162.56363217195187, -83.50508383024555, -44.20390049963949, -96.05596201394106, -6.839358521068829, -22.755338973949698, -163.05345935810107, -4.297697082319823, -22.43475011288916, -206.361713100921, 6.5075843754194675, 9.20726396330773, -1.814850988327895, -70.17158813011307, 11.31281209605363, -0.4828239179365217, 14.585610465822272, -5.454709324424831, -6.6721797528050955, 13.083420648466777, -21.52592551532848, -158.0778289781604, -26.72338854430285, -177.936159836496, -190.64090062572845, 8.278901750180026, -59.09102863888504, -11.591269265224822, -16.762180585670144, -178.8665970976912, -117.33177854697232, -1.047551852116283, -27.718695693671, -78.38177850146295, -63.6519893254039, -38.07972745668529, 5.355143785370486, 21.517904175388836, -4.915463232992854, -120.29675561226023, 5.176187315794678, -158.60107353649218, -164.12320120208804, -19.204845264206543, -95.1952862478011, -93.1343721182414, -47.1188961802802, -44.55452447351047, -29.89062948508048, -18.00783495785517, -85.4537563042438, -115.58882025522065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29420128517664385, "mean_inference_ms": 0.9068538609078307, "mean_action_processing_ms": 0.1630638597153883, "mean_env_wait_ms": 2.1539109321042087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054607391357421875, "StateBufferConnector_ms": 0.004071712493896484, "ViewRequirementAgentConnector_ms": 0.10211896896362305}, "num_episodes": 66, "episode_return_max": 21.517904175388836, "episode_return_min": -211.0962309290528, "episode_return_mean": -66.07798076677568, "episodes_this_iter": 66}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.70249086325623, "num_env_steps_trained_throughput_per_sec": 267.70249086325623, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 13893.64, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13893.558, "sample_time_ms": 2969.729, "learn_time_ms": 10906.905, "learn_throughput": 366.74, "synch_weights_time_ms": 15.638}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "64a97_00000", "date": "2024-07-26_23-23-53", "timestamp": 1722016433, "time_this_iter_s": 14.95041298866272, "time_total_s": 1111.317787885666, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bb7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1111.317787885666, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 10.885714285714284, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.8984000975887, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19521728351634618, "policy_loss": -0.005700007175134184, "vf_loss": 0.18306913340929895, "vf_explained_var": 0.999669927979509, "kl": 0.010152803838233691, "entropy": -0.24285857741488143, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": 21.517904175388836, "episode_reward_min": -207.45539449756745, "episode_reward_mean": -64.29446377822372, "episode_len_mean": 61.89, "episode_media": {}, "episodes_timesteps_total": 6189, "policy_reward_min": {"policy_0": -207.45539449756745}, "policy_reward_max": {"policy_0": 21.517904175388836}, "policy_reward_mean": {"policy_0": -64.29446377822372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.585610465822272, -5.454709324424831, -6.6721797528050955, 13.083420648466777, -21.52592551532848, -158.0778289781604, -26.72338854430285, -177.936159836496, -190.64090062572845, 8.278901750180026, -59.09102863888504, -11.591269265224822, -16.762180585670144, -178.8665970976912, -117.33177854697232, -1.047551852116283, -27.718695693671, -78.38177850146295, -63.6519893254039, -38.07972745668529, 5.355143785370486, 21.517904175388836, -4.915463232992854, -120.29675561226023, 5.176187315794678, -158.60107353649218, -164.12320120208804, -19.204845264206543, -95.1952862478011, -93.1343721182414, -47.1188961802802, -44.55452447351047, -29.89062948508048, -18.00783495785517, -85.4537563042438, -115.58882025522065, -72.71016074586838, -161.01623493962938, -24.140852885648467, -78.2383673045176, -188.1538593383086, -31.72875882723806, -4.621001664275044, 19.459950236293125, 5.254322634583438, -207.45539449756745, -6.590867587973792, -120.49505874881946, -98.44721375450759, -3.543026195274418, -75.46430229516807, -13.603875237026603, -50.51929428838561, -59.9285599656057, -47.00559841347579, -111.06519944839171, -91.41123128401681, -59.822115797669504, -99.2706822859748, -138.09070881832614, -150.3530252437522, -101.8744076085667, -18.724878533814103, -67.80264082759678, -175.23578251526334, -1.5751729625920312, -67.17645673057295, -61.884315625666794, -59.955711159136285, 13.658322424845245, -79.54127076569209, 8.328061161933832, -17.138308848905282, -101.98567830039939, -83.42746828331235, -3.414529092859338, -14.952951614064265, -104.17626515825636, -31.404104027072183, -39.349282421736206, -12.900531367080108, 4.940341597127398, -122.14329589407612, -104.89216757164192, -172.63821853744017, 9.453076640809726, -12.842426986724387, -132.8682138487412, -74.76416644750111, -151.28982864238006, -84.56199000547358, -135.24817165841205, -54.97976561921016, 1.5447237174614947, -76.05485996864437, -133.67400227935093, -54.78746589281086, -72.8228596505431, 6.349803287280364, -71.03042083946953], "episode_lengths": [29, 44, 49, 38, 51, 82, 48, 90, 88, 41, 62, 42, 42, 96, 76, 42, 58, 68, 62, 59, 40, 30, 48, 89, 40, 94, 84, 54, 82, 83, 57, 53, 56, 54, 67, 76, 63, 93, 48, 65, 92, 53, 45, 30, 40, 97, 49, 76, 73, 42, 73, 50, 58, 59, 53, 73, 82, 60, 67, 80, 83, 72, 53, 72, 90, 38, 62, 74, 63, 35, 64, 42, 53, 73, 69, 41, 47, 73, 52, 54, 53, 41, 76, 75, 87, 41, 44, 80, 65, 81, 66, 82, 58, 37, 80, 76, 60, 76, 37, 69], "policy_policy_0_reward": [14.585610465822272, -5.454709324424831, -6.6721797528050955, 13.083420648466777, -21.52592551532848, -158.0778289781604, -26.72338854430285, -177.936159836496, -190.64090062572845, 8.278901750180026, -59.09102863888504, -11.591269265224822, -16.762180585670144, -178.8665970976912, -117.33177854697232, -1.047551852116283, -27.718695693671, -78.38177850146295, -63.6519893254039, -38.07972745668529, 5.355143785370486, 21.517904175388836, -4.915463232992854, -120.29675561226023, 5.176187315794678, -158.60107353649218, -164.12320120208804, -19.204845264206543, -95.1952862478011, -93.1343721182414, -47.1188961802802, -44.55452447351047, -29.89062948508048, -18.00783495785517, -85.4537563042438, -115.58882025522065, -72.71016074586838, -161.01623493962938, -24.140852885648467, -78.2383673045176, -188.1538593383086, -31.72875882723806, -4.621001664275044, 19.459950236293125, 5.254322634583438, -207.45539449756745, -6.590867587973792, -120.49505874881946, -98.44721375450759, -3.543026195274418, -75.46430229516807, -13.603875237026603, -50.51929428838561, -59.9285599656057, -47.00559841347579, -111.06519944839171, -91.41123128401681, -59.822115797669504, -99.2706822859748, -138.09070881832614, -150.3530252437522, -101.8744076085667, -18.724878533814103, -67.80264082759678, -175.23578251526334, -1.5751729625920312, -67.17645673057295, -61.884315625666794, -59.955711159136285, 13.658322424845245, -79.54127076569209, 8.328061161933832, -17.138308848905282, -101.98567830039939, -83.42746828331235, -3.414529092859338, -14.952951614064265, -104.17626515825636, -31.404104027072183, -39.349282421736206, -12.900531367080108, 4.940341597127398, -122.14329589407612, -104.89216757164192, -172.63821853744017, 9.453076640809726, -12.842426986724387, -132.8682138487412, -74.76416644750111, -151.28982864238006, -84.56199000547358, -135.24817165841205, -54.97976561921016, 1.5447237174614947, -76.05485996864437, -133.67400227935093, -54.78746589281086, -72.8228596505431, 6.349803287280364, -71.03042083946953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29415007216453193, "mean_inference_ms": 0.9067746232690728, "mean_action_processing_ms": 0.16304259654815298, "mean_env_wait_ms": 2.1547402755791794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005596637725830078, "StateBufferConnector_ms": 0.004084348678588867, "ViewRequirementAgentConnector_ms": 0.10150885581970215}, "num_episodes": 64, "episode_return_max": 21.517904175388836, "episode_return_min": -207.45539449756745, "episode_return_mean": -64.29446377822372, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.5097628662557, "num_env_steps_trained_throughput_per_sec": 263.5097628662557, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 13927.175, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13927.093, "sample_time_ms": 2970.87, "learn_time_ms": 10939.34, "learn_throughput": 365.653, "synch_weights_time_ms": 15.645}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "64a97_00000", "date": "2024-07-26_23-24-08", "timestamp": 1722016448, "time_this_iter_s": 15.186431884765625, "time_total_s": 1126.5042197704315, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1126.5042197704315, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 10.286363636363635, "ram_util_percent": 28.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.7608563075463, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19944863217194023, "policy_loss": -0.013702883433628207, "vf_loss": 0.1987982307638352, "vf_explained_var": 0.999527666841944, "kl": 0.008490467516882486, "entropy": -0.1458386727240092, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 17.43563615585068, "episode_reward_min": -206.68426930224842, "episode_reward_mean": -59.1622923639325, "episode_len_mean": 60.77, "episode_media": {}, "episodes_timesteps_total": 6077, "policy_reward_min": {"policy_0": -206.68426930224842}, "policy_reward_max": {"policy_0": 17.43563615585068}, "policy_reward_mean": {"policy_0": -59.1622923639325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.884315625666794, -59.955711159136285, 13.658322424845245, -79.54127076569209, 8.328061161933832, -17.138308848905282, -101.98567830039939, -83.42746828331235, -3.414529092859338, -14.952951614064265, -104.17626515825636, -31.404104027072183, -39.349282421736206, -12.900531367080108, 4.940341597127398, -122.14329589407612, -104.89216757164192, -172.63821853744017, 9.453076640809726, -12.842426986724387, -132.8682138487412, -74.76416644750111, -151.28982864238006, -84.56199000547358, -135.24817165841205, -54.97976561921016, 1.5447237174614947, -76.05485996864437, -133.67400227935093, -54.78746589281086, -72.8228596505431, 6.349803287280364, -71.03042083946953, -206.68426930224842, -50.086039871616116, -71.8566735796542, -69.05837396712371, 17.43563615585068, -7.621442584587674, -131.7737560008731, -56.392358171482044, -40.23631831678889, -173.03519808618242, -145.04553297640948, -83.8782286965945, -78.73090803983646, -87.84030231816617, -13.487632881900753, -71.33494349290368, -0.18404091988413085, -13.534012602421864, -16.373043820411766, -99.36192866791767, 15.71006994762566, -73.5788287606864, 1.7085246060441093, -123.50899913437472, -2.400528236492006, 10.226986188779469, 4.590736925856071, -63.89186911717101, -99.14393336604964, -33.43261201840566, -68.60998427546518, 15.321642981972866, -83.70599570120943, -181.87084963941518, -15.268090156756594, -6.724617387740667, -67.30251341154666, -78.1069099514093, -62.22073733824041, -185.18471798505797, -31.15694819069982, -80.93114488458144, -18.77343557719548, -73.53119044440142, -6.025526214360761, 6.217246498512339, -55.45305988437476, -83.40797386100115, -21.476260017337417, 3.3611224207135946, -59.93078985218753, 0.8821327186273229, -151.60312922971025, -4.710755038665963, -89.88477372461372, -79.2720095680285, -29.589065170969462, -0.6338117127273852, -68.57649246040798, 12.407820211597397, -27.954823931244533, -100.19245167843155, 6.917277465430577, -100.58051566932951, -95.97674606894601, -123.82404630954255, -125.60335057133673], "episode_lengths": [74, 63, 35, 64, 42, 53, 73, 69, 41, 47, 73, 52, 54, 53, 41, 76, 75, 87, 41, 44, 80, 65, 81, 66, 82, 58, 37, 80, 76, 60, 76, 37, 69, 96, 58, 64, 63, 30, 41, 77, 63, 52, 96, 92, 67, 66, 70, 45, 66, 49, 46, 51, 75, 28, 65, 37, 77, 50, 31, 47, 78, 68, 53, 65, 38, 73, 86, 54, 48, 63, 67, 59, 84, 49, 82, 50, 61, 48, 41, 61, 78, 46, 40, 59, 40, 81, 45, 82, 64, 50, 49, 78, 41, 48, 74, 43, 78, 69, 81, 77], "policy_policy_0_reward": [-61.884315625666794, -59.955711159136285, 13.658322424845245, -79.54127076569209, 8.328061161933832, -17.138308848905282, -101.98567830039939, -83.42746828331235, -3.414529092859338, -14.952951614064265, -104.17626515825636, -31.404104027072183, -39.349282421736206, -12.900531367080108, 4.940341597127398, -122.14329589407612, -104.89216757164192, -172.63821853744017, 9.453076640809726, -12.842426986724387, -132.8682138487412, -74.76416644750111, -151.28982864238006, -84.56199000547358, -135.24817165841205, -54.97976561921016, 1.5447237174614947, -76.05485996864437, -133.67400227935093, -54.78746589281086, -72.8228596505431, 6.349803287280364, -71.03042083946953, -206.68426930224842, -50.086039871616116, -71.8566735796542, -69.05837396712371, 17.43563615585068, -7.621442584587674, -131.7737560008731, -56.392358171482044, -40.23631831678889, -173.03519808618242, -145.04553297640948, -83.8782286965945, -78.73090803983646, -87.84030231816617, -13.487632881900753, -71.33494349290368, -0.18404091988413085, -13.534012602421864, -16.373043820411766, -99.36192866791767, 15.71006994762566, -73.5788287606864, 1.7085246060441093, -123.50899913437472, -2.400528236492006, 10.226986188779469, 4.590736925856071, -63.89186911717101, -99.14393336604964, -33.43261201840566, -68.60998427546518, 15.321642981972866, -83.70599570120943, -181.87084963941518, -15.268090156756594, -6.724617387740667, -67.30251341154666, -78.1069099514093, -62.22073733824041, -185.18471798505797, -31.15694819069982, -80.93114488458144, -18.77343557719548, -73.53119044440142, -6.025526214360761, 6.217246498512339, -55.45305988437476, -83.40797386100115, -21.476260017337417, 3.3611224207135946, -59.93078985218753, 0.8821327186273229, -151.60312922971025, -4.710755038665963, -89.88477372461372, -79.2720095680285, -29.589065170969462, -0.6338117127273852, -68.57649246040798, 12.407820211597397, -27.954823931244533, -100.19245167843155, 6.917277465430577, -100.58051566932951, -95.97674606894601, -123.82404630954255, -125.60335057133673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29432885969647976, "mean_inference_ms": 0.9075051653201056, "mean_action_processing_ms": 0.16318720556515884, "mean_env_wait_ms": 2.155719441950361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059239864349365234, "StateBufferConnector_ms": 0.004111289978027344, "ViewRequirementAgentConnector_ms": 0.10358595848083496}, "num_episodes": 67, "episode_return_max": 17.43563615585068, "episode_return_min": -206.68426930224842, "episode_return_mean": -59.1622923639325, "episodes_this_iter": 67}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.2708941236031, "num_env_steps_trained_throughput_per_sec": 279.2708941236031, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 13927.948, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13927.865, "sample_time_ms": 2970.039, "learn_time_ms": 10940.822, "learn_throughput": 365.603, "synch_weights_time_ms": 15.754}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "64a97_00000", "date": "2024-07-26_23-24-22", "timestamp": 1722016462, "time_this_iter_s": 14.330569982528687, "time_total_s": 1140.8347897529602, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1140.8347897529602, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 10.528571428571428, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.65138943245014, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.23419332901054682, "policy_loss": -0.008091903928046425, "vf_loss": 0.2242214230587706, "vf_explained_var": 0.9995943357547125, "kl": 0.010690562292923807, "entropy": -0.18275182516275285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": 14.891510623644372, "episode_reward_min": -275.3652261086035, "episode_reward_mean": -62.16314852714247, "episode_len_mean": 61.09, "episode_media": {}, "episodes_timesteps_total": 6109, "policy_reward_min": {"policy_0": -275.3652261086035}, "policy_reward_max": {"policy_0": 14.891510623644372}, "policy_reward_mean": {"policy_0": -62.16314852714247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.87084963941518, -15.268090156756594, -6.724617387740667, -67.30251341154666, -78.1069099514093, -62.22073733824041, -185.18471798505797, -31.15694819069982, -80.93114488458144, -18.77343557719548, -73.53119044440142, -6.025526214360761, 6.217246498512339, -55.45305988437476, -83.40797386100115, -21.476260017337417, 3.3611224207135946, -59.93078985218753, 0.8821327186273229, -151.60312922971025, -4.710755038665963, -89.88477372461372, -79.2720095680285, -29.589065170969462, -0.6338117127273852, -68.57649246040798, 12.407820211597397, -27.954823931244533, -100.19245167843155, 6.917277465430577, -100.58051566932951, -95.97674606894601, -123.82404630954255, -125.60335057133673, -85.9309975016317, -163.08843145949973, -39.739785309992826, -0.9075544194889709, -207.982156704485, -6.907131669303176, -31.2550140108632, -103.36413983593901, -19.316739173418693, -160.8133264471047, -10.007212171024763, -125.88862303568737, -71.42503148238724, 1.2522717209309195, 5.57086538334243, -16.643858956309064, -78.79461470681424, 1.1457395767957912, -81.69748402305046, -7.494704352907285, 10.577295824669097, -83.9602945608761, -180.99049251520236, -21.34942948708868, -21.623221464428237, -67.23485081725144, -133.12588506886314, 0.3177725059613965, 8.657532792497078, -94.46710598847604, -97.46282304443832, -41.71716272418256, -117.20550191994074, -158.47116150973528, -39.866144712359635, -26.27139302564568, 12.022612315692921, -127.1883478404006, -57.92087885769285, 14.660288856716534, 14.891510623644372, 10.49729612179575, -53.56449428305697, -22.91965876336307, -15.368772363296747, -7.847199246952297, -275.3652261086035, -41.1957234167936, -2.22121910192906, -72.4488669330697, -223.5311049349428, -133.95412866024833, 7.234089721581958, -55.65932774226599, -61.11130033566222, -127.50310856532138, -120.96563437329434, -60.54444129963912, -48.6731201214688, -61.081668728080366, -8.597455400546453, -127.29757654182002, -26.09484632148444, -98.8344242626042, -156.01665671102603, -26.253538530535458], "episode_lengths": [86, 54, 48, 63, 67, 59, 84, 49, 82, 50, 61, 48, 41, 61, 78, 46, 40, 59, 40, 81, 45, 82, 64, 50, 49, 78, 41, 48, 74, 43, 78, 69, 81, 77, 67, 87, 61, 44, 102, 46, 49, 87, 51, 85, 40, 78, 79, 36, 37, 53, 65, 43, 68, 47, 42, 67, 94, 53, 48, 64, 93, 39, 37, 69, 69, 55, 76, 84, 63, 47, 31, 79, 61, 34, 32, 32, 65, 45, 57, 48, 105, 53, 47, 63, 97, 75, 33, 59, 60, 76, 91, 58, 55, 71, 43, 76, 50, 71, 92, 49], "policy_policy_0_reward": [-181.87084963941518, -15.268090156756594, -6.724617387740667, -67.30251341154666, -78.1069099514093, -62.22073733824041, -185.18471798505797, -31.15694819069982, -80.93114488458144, -18.77343557719548, -73.53119044440142, -6.025526214360761, 6.217246498512339, -55.45305988437476, -83.40797386100115, -21.476260017337417, 3.3611224207135946, -59.93078985218753, 0.8821327186273229, -151.60312922971025, -4.710755038665963, -89.88477372461372, -79.2720095680285, -29.589065170969462, -0.6338117127273852, -68.57649246040798, 12.407820211597397, -27.954823931244533, -100.19245167843155, 6.917277465430577, -100.58051566932951, -95.97674606894601, -123.82404630954255, -125.60335057133673, -85.9309975016317, -163.08843145949973, -39.739785309992826, -0.9075544194889709, -207.982156704485, -6.907131669303176, -31.2550140108632, -103.36413983593901, -19.316739173418693, -160.8133264471047, -10.007212171024763, -125.88862303568737, -71.42503148238724, 1.2522717209309195, 5.57086538334243, -16.643858956309064, -78.79461470681424, 1.1457395767957912, -81.69748402305046, -7.494704352907285, 10.577295824669097, -83.9602945608761, -180.99049251520236, -21.34942948708868, -21.623221464428237, -67.23485081725144, -133.12588506886314, 0.3177725059613965, 8.657532792497078, -94.46710598847604, -97.46282304443832, -41.71716272418256, -117.20550191994074, -158.47116150973528, -39.866144712359635, -26.27139302564568, 12.022612315692921, -127.1883478404006, -57.92087885769285, 14.660288856716534, 14.891510623644372, 10.49729612179575, -53.56449428305697, -22.91965876336307, -15.368772363296747, -7.847199246952297, -275.3652261086035, -41.1957234167936, -2.22121910192906, -72.4488669330697, -223.5311049349428, -133.95412866024833, 7.234089721581958, -55.65932774226599, -61.11130033566222, -127.50310856532138, -120.96563437329434, -60.54444129963912, -48.6731201214688, -61.081668728080366, -8.597455400546453, -127.29757654182002, -26.09484632148444, -98.8344242626042, -156.01665671102603, -26.253538530535458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943675968049561, "mean_inference_ms": 0.9073747885345427, "mean_action_processing_ms": 0.16312906884274841, "mean_env_wait_ms": 2.1564381016209277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005986690521240234, "StateBufferConnector_ms": 0.004066944122314453, "ViewRequirementAgentConnector_ms": 0.10215091705322266}, "num_episodes": 66, "episode_return_max": 14.891510623644372, "episode_return_min": -275.3652261086035, "episode_return_mean": -62.16314852714247, "episodes_this_iter": 66}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.04674710253045, "num_env_steps_trained_throughput_per_sec": 261.04674710253045, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 14060.629, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14060.543, "sample_time_ms": 2960.122, "learn_time_ms": 11083.486, "learn_throughput": 360.897, "synch_weights_time_ms": 15.721}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "64a97_00000", "date": "2024-07-26_23-24-38", "timestamp": 1722016478, "time_this_iter_s": 15.33191204071045, "time_total_s": 1156.1667017936707, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a8a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1156.1667017936707, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 10.42857142857143, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.94985004961491, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1591179861255417, "policy_loss": -0.007787585789143728, "vf_loss": 0.14582195452724894, "vf_explained_var": 0.9997128371149302, "kl": 0.012369972089436543, "entropy": -0.22967227898770942, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 19.63487017074663, "episode_reward_min": -275.3652261086035, "episode_reward_mean": -62.2401757489682, "episode_len_mean": 61.7, "episode_media": {}, "episodes_timesteps_total": 6170, "policy_reward_min": {"policy_0": -275.3652261086035}, "policy_reward_max": {"policy_0": 19.63487017074663}, "policy_reward_mean": {"policy_0": -62.2401757489682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.46710598847604, -97.46282304443832, -41.71716272418256, -117.20550191994074, -158.47116150973528, -39.866144712359635, -26.27139302564568, 12.022612315692921, -127.1883478404006, -57.92087885769285, 14.660288856716534, 14.891510623644372, 10.49729612179575, -53.56449428305697, -22.91965876336307, -15.368772363296747, -7.847199246952297, -275.3652261086035, -41.1957234167936, -2.22121910192906, -72.4488669330697, -223.5311049349428, -133.95412866024833, 7.234089721581958, -55.65932774226599, -61.11130033566222, -127.50310856532138, -120.96563437329434, -60.54444129963912, -48.6731201214688, -61.081668728080366, -8.597455400546453, -127.29757654182002, -26.09484632148444, -98.8344242626042, -156.01665671102603, -26.253538530535458, -48.6538729873608, -171.4794076010143, -109.43539116471597, 8.925036148294613, -69.86017759370405, 19.63487017074663, -81.1381642645823, -47.35462207396135, -170.57429770330916, -66.61758815219846, -125.05781725152158, -173.20509596967617, -136.47276977518177, -32.68004723280823, -4.160187512208328, -53.475229109995446, -31.725336490635076, -83.3263898089209, -20.718768380864077, -128.92009446762344, -79.75010146912804, -33.22028341959039, -57.50850382607713, -88.0743553569867, -100.27590903484288, -71.51823639401384, 7.576181811950304, -121.82374963447256, -70.58797658583632, -48.85886589673821, -34.99727942330118, -55.1523316252524, -13.943140616638965, -14.377857363603285, -19.66812423693028, -58.34087971948276, -7.332489545755591, -92.38827209320507, -8.077794351202222, -60.88054696396892, -61.98978523705353, -138.99447212770252, 1.5146606515041048, 13.078374888170126, -163.12400727542013, -59.30034267408452, -61.73679996052682, -11.98273309343395, -7.78413330576811, 5.7867077558221744, -29.755774703960295, 7.1015167743744865, -61.062332437180004, -37.16659181085182, -148.176829034826, -50.93929677340268, -97.62732580850721, -75.73365331251082, -34.885332337758776, -31.416692733858966, -39.73538306465996, -14.180327195889424, -42.09694038353262], "episode_lengths": [69, 69, 55, 76, 84, 63, 47, 31, 79, 61, 34, 32, 32, 65, 45, 57, 48, 105, 53, 47, 63, 97, 75, 33, 59, 60, 76, 91, 58, 55, 71, 43, 76, 50, 71, 92, 49, 63, 89, 72, 32, 65, 28, 67, 64, 88, 70, 89, 89, 79, 59, 43, 58, 52, 78, 55, 83, 81, 57, 66, 70, 85, 64, 36, 76, 63, 58, 57, 59, 53, 53, 48, 74, 48, 84, 42, 66, 62, 80, 37, 40, 90, 59, 66, 41, 51, 38, 46, 45, 63, 55, 89, 58, 71, 71, 50, 57, 60, 45, 62], "policy_policy_0_reward": [-94.46710598847604, -97.46282304443832, -41.71716272418256, -117.20550191994074, -158.47116150973528, -39.866144712359635, -26.27139302564568, 12.022612315692921, -127.1883478404006, -57.92087885769285, 14.660288856716534, 14.891510623644372, 10.49729612179575, -53.56449428305697, -22.91965876336307, -15.368772363296747, -7.847199246952297, -275.3652261086035, -41.1957234167936, -2.22121910192906, -72.4488669330697, -223.5311049349428, -133.95412866024833, 7.234089721581958, -55.65932774226599, -61.11130033566222, -127.50310856532138, -120.96563437329434, -60.54444129963912, -48.6731201214688, -61.081668728080366, -8.597455400546453, -127.29757654182002, -26.09484632148444, -98.8344242626042, -156.01665671102603, -26.253538530535458, -48.6538729873608, -171.4794076010143, -109.43539116471597, 8.925036148294613, -69.86017759370405, 19.63487017074663, -81.1381642645823, -47.35462207396135, -170.57429770330916, -66.61758815219846, -125.05781725152158, -173.20509596967617, -136.47276977518177, -32.68004723280823, -4.160187512208328, -53.475229109995446, -31.725336490635076, -83.3263898089209, -20.718768380864077, -128.92009446762344, -79.75010146912804, -33.22028341959039, -57.50850382607713, -88.0743553569867, -100.27590903484288, -71.51823639401384, 7.576181811950304, -121.82374963447256, -70.58797658583632, -48.85886589673821, -34.99727942330118, -55.1523316252524, -13.943140616638965, -14.377857363603285, -19.66812423693028, -58.34087971948276, -7.332489545755591, -92.38827209320507, -8.077794351202222, -60.88054696396892, -61.98978523705353, -138.99447212770252, 1.5146606515041048, 13.078374888170126, -163.12400727542013, -59.30034267408452, -61.73679996052682, -11.98273309343395, -7.78413330576811, 5.7867077558221744, -29.755774703960295, 7.1015167743744865, -61.062332437180004, -37.16659181085182, -148.176829034826, -50.93929677340268, -97.62732580850721, -75.73365331251082, -34.885332337758776, -31.416692733858966, -39.73538306465996, -14.180327195889424, -42.09694038353262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943468318680554, "mean_inference_ms": 0.9075723120198532, "mean_action_processing_ms": 0.1631767070803468, "mean_env_wait_ms": 2.1570981621749197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056302547454833984, "StateBufferConnector_ms": 0.004064321517944336, "ViewRequirementAgentConnector_ms": 0.1026620864868164}, "num_episodes": 63, "episode_return_max": 19.63487017074663, "episode_return_min": -275.3652261086035, "episode_return_mean": -62.2401757489682, "episodes_this_iter": 63}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.20053378844403, "num_env_steps_trained_throughput_per_sec": 268.20053378844403, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 14316.486, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14316.399, "sample_time_ms": 2973.571, "learn_time_ms": 11325.612, "learn_throughput": 353.182, "synch_weights_time_ms": 15.982}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "64a97_00000", "date": "2024-07-26_23-24-53", "timestamp": 1722016493, "time_this_iter_s": 14.921558618545532, "time_total_s": 1171.0882604122162, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb737eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1171.0882604122162, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 10.336363636363636, "ram_util_percent": 28.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.81516699989637, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.15679983421287033, "policy_loss": -0.00814676208489497, "vf_loss": 0.14505597087554634, "vf_explained_var": 0.999711128945152, "kl": 0.01138016669744203, "entropy": -0.260699804550192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 20.71839144796794, "episode_reward_min": -163.12400727542013, "episode_reward_mean": -50.20554361920942, "episode_len_mean": 58.78, "episode_media": {}, "episodes_timesteps_total": 5878, "policy_reward_min": {"policy_0": -163.12400727542013}, "policy_reward_max": {"policy_0": 20.71839144796794}, "policy_reward_mean": {"policy_0": -50.20554361920942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.99727942330118, -55.1523316252524, -13.943140616638965, -14.377857363603285, -19.66812423693028, -58.34087971948276, -7.332489545755591, -92.38827209320507, -8.077794351202222, -60.88054696396892, -61.98978523705353, -138.99447212770252, 1.5146606515041048, 13.078374888170126, -163.12400727542013, -59.30034267408452, -61.73679996052682, -11.98273309343395, -7.78413330576811, 5.7867077558221744, -29.755774703960295, 7.1015167743744865, -61.062332437180004, -37.16659181085182, -148.176829034826, -50.93929677340268, -97.62732580850721, -75.73365331251082, -34.885332337758776, -31.416692733858966, -39.73538306465996, -14.180327195889424, -42.09694038353262, -71.72299238210437, -4.593660240075761, -4.281673179592437, -62.24877941793056, -2.7680114941840825, -26.775351729454055, 20.71839144796794, -18.444908639628146, -80.60853777801294, -20.347827094177198, -0.22783411091439976, -153.38797435661502, -112.9068219605797, -108.24257339416278, -75.29691372058478, -9.925487928419633, 17.7617105606636, -4.905742775911267, -73.78499483856275, -36.13585776759024, -15.768111904579817, 14.804505807776557, -41.16143459890861, -10.671197156005178, 5.9717535802367605, -34.129303581437846, -74.97938942218227, -4.4411325808369915, 12.631277892335945, -115.40174004829767, -27.8127826646437, -68.80107504233908, -106.86711946561148, 12.965146795947682, -107.98190446215551, -140.91200195432975, -7.612308413511209, -148.0186609123283, -28.154032844093145, -41.44379622344589, -67.94657839547844, -131.24826660034174, -126.81916035955608, -47.28657988901817, -144.3734240798164, 16.065609355112382, -9.383978946190865, -42.619158255991465, -51.412585899678, -2.148743004694503, -145.81189007549628, -129.54149725759916, -136.7397531929233, -70.1621603570962, -43.4148869570823, -1.5476814518595763, -111.39562778771553, -7.606339959148361, -69.9368405025712, -35.02953921028856, -87.15811273904471, -71.33640874584661, -11.425745785717526, -125.92583476825169, 7.311509994024892, -20.19108838632821, -92.19424152366801], "episode_lengths": [57, 59, 53, 53, 48, 74, 48, 84, 42, 66, 62, 80, 37, 40, 90, 59, 66, 41, 51, 38, 46, 45, 63, 55, 89, 58, 71, 71, 50, 57, 60, 45, 62, 63, 44, 44, 67, 38, 58, 31, 56, 79, 49, 50, 81, 75, 84, 67, 47, 29, 52, 65, 61, 52, 30, 61, 47, 36, 58, 69, 45, 38, 83, 55, 68, 71, 35, 75, 79, 50, 81, 46, 52, 63, 78, 76, 55, 81, 30, 50, 57, 56, 45, 82, 78, 80, 72, 56, 44, 75, 48, 62, 55, 68, 76, 49, 90, 40, 52, 69], "policy_policy_0_reward": [-34.99727942330118, -55.1523316252524, -13.943140616638965, -14.377857363603285, -19.66812423693028, -58.34087971948276, -7.332489545755591, -92.38827209320507, -8.077794351202222, -60.88054696396892, -61.98978523705353, -138.99447212770252, 1.5146606515041048, 13.078374888170126, -163.12400727542013, -59.30034267408452, -61.73679996052682, -11.98273309343395, -7.78413330576811, 5.7867077558221744, -29.755774703960295, 7.1015167743744865, -61.062332437180004, -37.16659181085182, -148.176829034826, -50.93929677340268, -97.62732580850721, -75.73365331251082, -34.885332337758776, -31.416692733858966, -39.73538306465996, -14.180327195889424, -42.09694038353262, -71.72299238210437, -4.593660240075761, -4.281673179592437, -62.24877941793056, -2.7680114941840825, -26.775351729454055, 20.71839144796794, -18.444908639628146, -80.60853777801294, -20.347827094177198, -0.22783411091439976, -153.38797435661502, -112.9068219605797, -108.24257339416278, -75.29691372058478, -9.925487928419633, 17.7617105606636, -4.905742775911267, -73.78499483856275, -36.13585776759024, -15.768111904579817, 14.804505807776557, -41.16143459890861, -10.671197156005178, 5.9717535802367605, -34.129303581437846, -74.97938942218227, -4.4411325808369915, 12.631277892335945, -115.40174004829767, -27.8127826646437, -68.80107504233908, -106.86711946561148, 12.965146795947682, -107.98190446215551, -140.91200195432975, -7.612308413511209, -148.0186609123283, -28.154032844093145, -41.44379622344589, -67.94657839547844, -131.24826660034174, -126.81916035955608, -47.28657988901817, -144.3734240798164, 16.065609355112382, -9.383978946190865, -42.619158255991465, -51.412585899678, -2.148743004694503, -145.81189007549628, -129.54149725759916, -136.7397531929233, -70.1621603570962, -43.4148869570823, -1.5476814518595763, -111.39562778771553, -7.606339959148361, -69.9368405025712, -35.02953921028856, -87.15811273904471, -71.33640874584661, -11.425745785717526, -125.92583476825169, 7.311509994024892, -20.19108838632821, -92.19424152366801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29458444950594187, "mean_inference_ms": 0.9083110424708236, "mean_action_processing_ms": 0.1633071890487112, "mean_env_wait_ms": 2.1584905495353786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005754947662353516, "StateBufferConnector_ms": 0.004106760025024414, "ViewRequirementAgentConnector_ms": 0.10315108299255371}, "num_episodes": 67, "episode_return_max": 20.71839144796794, "episode_return_min": -163.12400727542013, "episode_return_mean": -50.20554361920942, "episodes_this_iter": 67}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.28933153832963, "num_env_steps_trained_throughput_per_sec": 269.28933153832963, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 14312.844, "restore_workers_time_ms": 0.031, "training_step_time_ms": 14312.755, "sample_time_ms": 2979.231, "learn_time_ms": 11316.294, "learn_throughput": 353.473, "synch_weights_time_ms": 15.989}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "64a97_00000", "date": "2024-07-26_23-25-08", "timestamp": 1722016508, "time_this_iter_s": 14.863004207611084, "time_total_s": 1185.9512646198273, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7ab400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1185.9512646198273, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.504761904761907, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.72665101736784, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.18608744361020702, "policy_loss": -0.009822665875253734, "vf_loss": 0.1776480917003937, "vf_explained_var": 0.9995202261954546, "kl": 0.010699635014134451, "entropy": -0.20119477633658486, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 16.065609355112382, "episode_reward_min": -202.39729377929345, "episode_reward_mean": -65.83514676601747, "episode_len_mean": 62.88, "episode_media": {}, "episodes_timesteps_total": 6288, "policy_reward_min": {"policy_0": -202.39729377929345}, "policy_reward_max": {"policy_0": 16.065609355112382}, "policy_reward_mean": {"policy_0": -65.83514676601747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.86711946561148, 12.965146795947682, -107.98190446215551, -140.91200195432975, -7.612308413511209, -148.0186609123283, -28.154032844093145, -41.44379622344589, -67.94657839547844, -131.24826660034174, -126.81916035955608, -47.28657988901817, -144.3734240798164, 16.065609355112382, -9.383978946190865, -42.619158255991465, -51.412585899678, -2.148743004694503, -145.81189007549628, -129.54149725759916, -136.7397531929233, -70.1621603570962, -43.4148869570823, -1.5476814518595763, -111.39562778771553, -7.606339959148361, -69.9368405025712, -35.02953921028856, -87.15811273904471, -71.33640874584661, -11.425745785717526, -125.92583476825169, 7.311509994024892, -20.19108838632821, -92.19424152366801, -77.34142124014404, -5.040704297654811, -90.06777065186165, -20.17377467122927, -76.07013824820952, -164.61406127554127, -4.966338092692329, -202.39729377929345, -41.64003463389374, -5.428678117428792, -139.48110602067982, -53.57210560646912, -85.89159734868258, -100.01694052973326, -10.646403973215957, -5.051565477407935, -136.83756236353355, -88.0851749094346, 12.035309038958397, 2.242586196810769, -81.16320060796173, 0.4390933310483127, -9.001867270050747, -48.05592323645612, -55.057685677551675, -143.9360281223562, 5.8217631221239055, -90.6755678738617, -76.0272967410205, -18.548195194122584, -66.56007620892332, -32.018119535358096, -89.9880374670045, -152.2940906795019, -70.80176980869616, -34.060204742849315, -21.910499769991464, -2.336028444686033, -61.11468754917967, -53.53920354414402, 9.194956148579621, -67.18862041883163, -173.64516533144115, -0.016776948393567137, -56.267492577793504, -20.55161482044396, 10.232980854185543, -117.95912977886034, -81.40763617172871, -96.71887846846388, -63.64034362435743, -113.62274907241907, -10.523167283066423, -195.81125453021798, -81.58586578533932, -90.22052488119073, -76.63648039873661, -41.49075448122152, -31.57164350348077, -189.3510421475434, -177.03716860929495, -14.176275839642727, -29.71588981445962, -60.54753905428407, -92.08051577962846], "episode_lengths": [71, 35, 75, 79, 50, 81, 46, 52, 63, 78, 76, 55, 81, 30, 50, 57, 56, 45, 82, 78, 80, 72, 56, 44, 75, 48, 62, 55, 68, 76, 49, 90, 40, 52, 69, 79, 39, 72, 49, 78, 84, 39, 97, 53, 52, 81, 58, 68, 72, 50, 48, 78, 68, 31, 48, 67, 40, 52, 57, 58, 80, 43, 72, 79, 41, 67, 50, 70, 94, 77, 56, 58, 47, 62, 57, 35, 63, 88, 48, 65, 47, 37, 80, 81, 70, 62, 73, 48, 94, 67, 72, 73, 59, 55, 99, 98, 43, 51, 64, 69], "policy_policy_0_reward": [-106.86711946561148, 12.965146795947682, -107.98190446215551, -140.91200195432975, -7.612308413511209, -148.0186609123283, -28.154032844093145, -41.44379622344589, -67.94657839547844, -131.24826660034174, -126.81916035955608, -47.28657988901817, -144.3734240798164, 16.065609355112382, -9.383978946190865, -42.619158255991465, -51.412585899678, -2.148743004694503, -145.81189007549628, -129.54149725759916, -136.7397531929233, -70.1621603570962, -43.4148869570823, -1.5476814518595763, -111.39562778771553, -7.606339959148361, -69.9368405025712, -35.02953921028856, -87.15811273904471, -71.33640874584661, -11.425745785717526, -125.92583476825169, 7.311509994024892, -20.19108838632821, -92.19424152366801, -77.34142124014404, -5.040704297654811, -90.06777065186165, -20.17377467122927, -76.07013824820952, -164.61406127554127, -4.966338092692329, -202.39729377929345, -41.64003463389374, -5.428678117428792, -139.48110602067982, -53.57210560646912, -85.89159734868258, -100.01694052973326, -10.646403973215957, -5.051565477407935, -136.83756236353355, -88.0851749094346, 12.035309038958397, 2.242586196810769, -81.16320060796173, 0.4390933310483127, -9.001867270050747, -48.05592323645612, -55.057685677551675, -143.9360281223562, 5.8217631221239055, -90.6755678738617, -76.0272967410205, -18.548195194122584, -66.56007620892332, -32.018119535358096, -89.9880374670045, -152.2940906795019, -70.80176980869616, -34.060204742849315, -21.910499769991464, -2.336028444686033, -61.11468754917967, -53.53920354414402, 9.194956148579621, -67.18862041883163, -173.64516533144115, -0.016776948393567137, -56.267492577793504, -20.55161482044396, 10.232980854185543, -117.95912977886034, -81.40763617172871, -96.71887846846388, -63.64034362435743, -113.62274907241907, -10.523167283066423, -195.81125453021798, -81.58586578533932, -90.22052488119073, -76.63648039873661, -41.49075448122152, -31.57164350348077, -189.3510421475434, -177.03716860929495, -14.176275839642727, -29.71588981445962, -60.54753905428407, -92.08051577962846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945534271484934, "mean_inference_ms": 0.907894692988464, "mean_action_processing_ms": 0.1632568154199965, "mean_env_wait_ms": 2.159114762847217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00593113899230957, "StateBufferConnector_ms": 0.0041544437408447266, "ViewRequirementAgentConnector_ms": 0.10493302345275879}, "num_episodes": 65, "episode_return_max": 16.065609355112382, "episode_return_min": -202.39729377929345, "episode_return_mean": -65.83514676601747, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.3224214234615, "num_env_steps_trained_throughput_per_sec": 268.3224214234615, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 14297.474, "restore_workers_time_ms": 0.031, "training_step_time_ms": 14297.385, "sample_time_ms": 2980.559, "learn_time_ms": 11299.357, "learn_throughput": 354.002, "synch_weights_time_ms": 16.214}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "64a97_00000", "date": "2024-07-26_23-25-23", "timestamp": 1722016523, "time_this_iter_s": 14.915401697158813, "time_total_s": 1200.866666316986, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb734310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1200.866666316986, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 10.447619047619048, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.32233145137628, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.15665327435466073, "policy_loss": -0.007763948020874522, "vf_loss": 0.1463348896553119, "vf_explained_var": 0.9997446463132899, "kl": 0.010366196605415745, "entropy": -0.2338671514376377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": 20.04427516104897, "episode_reward_min": -201.31094917626507, "episode_reward_mean": -61.763617991132485, "episode_len_mean": 61.77, "episode_media": {}, "episodes_timesteps_total": 6177, "policy_reward_min": {"policy_0": -201.31094917626507}, "policy_reward_max": {"policy_0": 20.04427516104897}, "policy_reward_mean": {"policy_0": -61.763617991132485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.56007620892332, -32.018119535358096, -89.9880374670045, -152.2940906795019, -70.80176980869616, -34.060204742849315, -21.910499769991464, -2.336028444686033, -61.11468754917967, -53.53920354414402, 9.194956148579621, -67.18862041883163, -173.64516533144115, -0.016776948393567137, -56.267492577793504, -20.55161482044396, 10.232980854185543, -117.95912977886034, -81.40763617172871, -96.71887846846388, -63.64034362435743, -113.62274907241907, -10.523167283066423, -195.81125453021798, -81.58586578533932, -90.22052488119073, -76.63648039873661, -41.49075448122152, -31.57164350348077, -189.3510421475434, -177.03716860929495, -14.176275839642727, -29.71588981445962, -60.54753905428407, -92.08051577962846, -19.284560366040434, -0.36801342921398006, -42.136131420003686, -132.89222258719138, -53.19666018462539, 7.630842513775232, -40.50346845839686, -21.26975035079619, 7.748089106268253, -182.50760070338987, -27.341921737603556, 3.595907350659787, -57.642678815636344, 14.160166966673653, -34.642198417892615, -4.884870010437991, -100.31254007671278, -52.72218578060436, -142.9862043736093, -180.6464106273919, -99.7998989178891, -112.71307647668114, -16.359970878072623, 16.956681753624128, -64.11054237341679, -96.99922127406813, 0.14399074131124956, -95.18030450781937, -90.32261019276426, -40.47582453736983, -46.57894211940104, -115.48151929863472, -132.34196839054928, -152.5468028806859, -173.01862022199748, -62.68820018724898, -30.345655076161897, -65.8396894274711, -14.060916268130322, 20.04427516104897, -15.622463709231234, -58.427324662845685, 9.927058365783607, -201.31094917626507, -8.36640611909007, -56.53447595401249, -108.60621617428987, 8.216567904500398, 16.435488124413915, -89.70498106663362, -69.62450381663945, -11.776607117533969, 1.0725174824945725, -38.90387306035581, -70.22755892087848, -1.2089587781876838, -45.93240963537906, -135.1267593600323, -78.85208819740947, 15.79983000293915, -15.152407700631361, -89.29176492654267, -75.88312077543473, -66.9975746677312, -111.38028033130048], "episode_lengths": [67, 50, 70, 94, 77, 56, 58, 47, 62, 57, 35, 63, 88, 48, 65, 47, 37, 80, 81, 70, 62, 73, 48, 94, 67, 72, 73, 59, 55, 99, 98, 43, 51, 64, 69, 51, 46, 52, 79, 63, 40, 60, 57, 38, 91, 52, 41, 59, 30, 50, 37, 72, 65, 81, 96, 69, 75, 55, 28, 60, 71, 48, 72, 69, 61, 58, 88, 79, 82, 87, 62, 58, 64, 56, 31, 50, 65, 36, 92, 47, 58, 71, 38, 31, 69, 64, 47, 48, 61, 63, 46, 58, 84, 73, 39, 51, 72, 65, 64, 73], "policy_policy_0_reward": [-66.56007620892332, -32.018119535358096, -89.9880374670045, -152.2940906795019, -70.80176980869616, -34.060204742849315, -21.910499769991464, -2.336028444686033, -61.11468754917967, -53.53920354414402, 9.194956148579621, -67.18862041883163, -173.64516533144115, -0.016776948393567137, -56.267492577793504, -20.55161482044396, 10.232980854185543, -117.95912977886034, -81.40763617172871, -96.71887846846388, -63.64034362435743, -113.62274907241907, -10.523167283066423, -195.81125453021798, -81.58586578533932, -90.22052488119073, -76.63648039873661, -41.49075448122152, -31.57164350348077, -189.3510421475434, -177.03716860929495, -14.176275839642727, -29.71588981445962, -60.54753905428407, -92.08051577962846, -19.284560366040434, -0.36801342921398006, -42.136131420003686, -132.89222258719138, -53.19666018462539, 7.630842513775232, -40.50346845839686, -21.26975035079619, 7.748089106268253, -182.50760070338987, -27.341921737603556, 3.595907350659787, -57.642678815636344, 14.160166966673653, -34.642198417892615, -4.884870010437991, -100.31254007671278, -52.72218578060436, -142.9862043736093, -180.6464106273919, -99.7998989178891, -112.71307647668114, -16.359970878072623, 16.956681753624128, -64.11054237341679, -96.99922127406813, 0.14399074131124956, -95.18030450781937, -90.32261019276426, -40.47582453736983, -46.57894211940104, -115.48151929863472, -132.34196839054928, -152.5468028806859, -173.01862022199748, -62.68820018724898, -30.345655076161897, -65.8396894274711, -14.060916268130322, 20.04427516104897, -15.622463709231234, -58.427324662845685, 9.927058365783607, -201.31094917626507, -8.36640611909007, -56.53447595401249, -108.60621617428987, 8.216567904500398, 16.435488124413915, -89.70498106663362, -69.62450381663945, -11.776607117533969, 1.0725174824945725, -38.90387306035581, -70.22755892087848, -1.2089587781876838, -45.93240963537906, -135.1267593600323, -78.85208819740947, 15.79983000293915, -15.152407700631361, -89.29176492654267, -75.88312077543473, -66.9975746677312, -111.38028033130048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945435817870298, "mean_inference_ms": 0.9076760846819107, "mean_action_processing_ms": 0.16328626016097075, "mean_env_wait_ms": 2.1600802163396122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056040287017822266, "StateBufferConnector_ms": 0.004097700119018555, "ViewRequirementAgentConnector_ms": 0.10248708724975586}, "num_episodes": 65, "episode_return_max": 20.04427516104897, "episode_return_min": -201.31094917626507, "episode_return_mean": -61.763617991132485, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.18141152762536, "num_env_steps_trained_throughput_per_sec": 269.18141152762536, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 14272.492, "restore_workers_time_ms": 0.032, "training_step_time_ms": 14272.403, "sample_time_ms": 2976.974, "learn_time_ms": 11278.302, "learn_throughput": 354.663, "synch_weights_time_ms": 15.88}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "64a97_00000", "date": "2024-07-26_23-25-37", "timestamp": 1722016537, "time_this_iter_s": 14.868678569793701, "time_total_s": 1215.7353448867798, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1215.7353448867798, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 10.419047619047618, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.4704454695185, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.20106762525635227, "policy_loss": -0.010746922242105938, "vf_loss": 0.1953936715455105, "vf_explained_var": 0.9995593606183927, "kl": 0.00944713791711062, "entropy": -0.2073035393084865, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 20.04427516104897, "episode_reward_min": -223.6083440191335, "episode_reward_mean": -59.156860145005666, "episode_len_mean": 61.67, "episode_media": {}, "episodes_timesteps_total": 6167, "policy_reward_min": {"policy_0": -223.6083440191335}, "policy_reward_max": {"policy_0": 20.04427516104897}, "policy_reward_mean": {"policy_0": -59.156860145005666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.47582453736983, -46.57894211940104, -115.48151929863472, -132.34196839054928, -152.5468028806859, -173.01862022199748, -62.68820018724898, -30.345655076161897, -65.8396894274711, -14.060916268130322, 20.04427516104897, -15.622463709231234, -58.427324662845685, 9.927058365783607, -201.31094917626507, -8.36640611909007, -56.53447595401249, -108.60621617428987, 8.216567904500398, 16.435488124413915, -89.70498106663362, -69.62450381663945, -11.776607117533969, 1.0725174824945725, -38.90387306035581, -70.22755892087848, -1.2089587781876838, -45.93240963537906, -135.1267593600323, -78.85208819740947, 15.79983000293915, -15.152407700631361, -89.29176492654267, -75.88312077543473, -66.9975746677312, -111.38028033130048, -143.8759765424903, -192.1645601606167, 9.033693584890148, -20.39095516102105, -34.58841613492212, -3.9006163473689437, -116.76278605128283, -8.913989470727408, -9.706967712036931, 18.065568880267755, -24.003093569719194, -201.1907131488135, 3.7473458838814033, -82.34271253051503, -69.03095875066754, -19.719045741597974, -44.23956845163531, -5.307288282670341, -69.59754222448406, -100.62724403527925, -87.63455957176014, -66.75873458664658, -60.5805427287535, -6.44992306061512, -42.45142807437539, -37.764730936064765, -179.70240696352434, 6.205730708566877, 10.147522477929712, -53.71402640752873, -22.125174689068015, -223.6083440191335, 7.969492441990387, -38.39201683877159, -6.175030077644337, -117.16696723394513, -128.70740171836252, -31.563766237091343, -156.5020799898735, -9.39149361863899, -59.520818392577, -73.03139491393591, -103.00025047409866, 7.394250686133237, -7.510815305079153, 3.2207231321453174, -101.44346062450374, -85.8312240273279, -76.45139245271055, -75.45685632044825, -26.512281156517158, -36.85667480484532, -89.4075863892764, -70.25193165092826, -89.13500232902135, -113.69866575149094, -9.113673513091303, -42.93456815400314, -207.59616501360787, -85.49221629636851, -17.489964587075903, -34.013211364402906, -20.350206772532164, -30.507795417989], "episode_lengths": [61, 58, 88, 79, 82, 87, 62, 58, 64, 56, 31, 50, 65, 36, 92, 47, 58, 71, 38, 31, 69, 64, 47, 48, 61, 63, 46, 58, 84, 73, 39, 51, 72, 65, 64, 73, 85, 93, 45, 42, 60, 51, 76, 51, 49, 34, 52, 97, 35, 68, 67, 48, 58, 42, 64, 71, 84, 77, 75, 42, 57, 61, 86, 44, 34, 57, 57, 102, 33, 56, 47, 77, 75, 56, 84, 52, 64, 75, 73, 38, 48, 46, 73, 83, 79, 65, 50, 51, 68, 73, 81, 79, 53, 56, 94, 83, 52, 51, 47, 50], "policy_policy_0_reward": [-40.47582453736983, -46.57894211940104, -115.48151929863472, -132.34196839054928, -152.5468028806859, -173.01862022199748, -62.68820018724898, -30.345655076161897, -65.8396894274711, -14.060916268130322, 20.04427516104897, -15.622463709231234, -58.427324662845685, 9.927058365783607, -201.31094917626507, -8.36640611909007, -56.53447595401249, -108.60621617428987, 8.216567904500398, 16.435488124413915, -89.70498106663362, -69.62450381663945, -11.776607117533969, 1.0725174824945725, -38.90387306035581, -70.22755892087848, -1.2089587781876838, -45.93240963537906, -135.1267593600323, -78.85208819740947, 15.79983000293915, -15.152407700631361, -89.29176492654267, -75.88312077543473, -66.9975746677312, -111.38028033130048, -143.8759765424903, -192.1645601606167, 9.033693584890148, -20.39095516102105, -34.58841613492212, -3.9006163473689437, -116.76278605128283, -8.913989470727408, -9.706967712036931, 18.065568880267755, -24.003093569719194, -201.1907131488135, 3.7473458838814033, -82.34271253051503, -69.03095875066754, -19.719045741597974, -44.23956845163531, -5.307288282670341, -69.59754222448406, -100.62724403527925, -87.63455957176014, -66.75873458664658, -60.5805427287535, -6.44992306061512, -42.45142807437539, -37.764730936064765, -179.70240696352434, 6.205730708566877, 10.147522477929712, -53.71402640752873, -22.125174689068015, -223.6083440191335, 7.969492441990387, -38.39201683877159, -6.175030077644337, -117.16696723394513, -128.70740171836252, -31.563766237091343, -156.5020799898735, -9.39149361863899, -59.520818392577, -73.03139491393591, -103.00025047409866, 7.394250686133237, -7.510815305079153, 3.2207231321453174, -101.44346062450374, -85.8312240273279, -76.45139245271055, -75.45685632044825, -26.512281156517158, -36.85667480484532, -89.4075863892764, -70.25193165092826, -89.13500232902135, -113.69866575149094, -9.113673513091303, -42.93456815400314, -207.59616501360787, -85.49221629636851, -17.489964587075903, -34.013211364402906, -20.350206772532164, -30.507795417989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2944886721409151, "mean_inference_ms": 0.9074953317256836, "mean_action_processing_ms": 0.16328771194513522, "mean_env_wait_ms": 2.160917837170227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005512714385986328, "StateBufferConnector_ms": 0.004099369049072266, "ViewRequirementAgentConnector_ms": 0.10295653343200684}, "num_episodes": 64, "episode_return_max": 20.04427516104897, "episode_return_min": -223.6083440191335, "episode_return_mean": -59.156860145005666, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.5604334090296, "num_env_steps_trained_throughput_per_sec": 283.5604334090296, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 14452.979, "restore_workers_time_ms": 0.032, "training_step_time_ms": 14452.889, "sample_time_ms": 2981.588, "learn_time_ms": 11454.849, "learn_throughput": 349.197, "synch_weights_time_ms": 15.182}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "64a97_00000", "date": "2024-07-26_23-25-52", "timestamp": 1722016552, "time_this_iter_s": 14.114655017852783, "time_total_s": 1229.8499999046326, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7051b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1229.8499999046326, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 10.385714285714286, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.51635881960392, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.18804130005737535, "policy_loss": -0.007408849502098747, "vf_loss": 0.17706554040778427, "vf_explained_var": 0.9996723969777425, "kl": 0.010764284619616168, "entropy": -0.203635248914361, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": 22.179915711240493, "episode_reward_min": -223.6083440191335, "episode_reward_mean": -64.57305052906652, "episode_len_mean": 63.41, "episode_media": {}, "episodes_timesteps_total": 6341, "policy_reward_min": {"policy_0": -223.6083440191335}, "policy_reward_max": {"policy_0": 22.179915711240493}, "policy_reward_mean": {"policy_0": -64.57305052906652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.71402640752873, -22.125174689068015, -223.6083440191335, 7.969492441990387, -38.39201683877159, -6.175030077644337, -117.16696723394513, -128.70740171836252, -31.563766237091343, -156.5020799898735, -9.39149361863899, -59.520818392577, -73.03139491393591, -103.00025047409866, 7.394250686133237, -7.510815305079153, 3.2207231321453174, -101.44346062450374, -85.8312240273279, -76.45139245271055, -75.45685632044825, -26.512281156517158, -36.85667480484532, -89.4075863892764, -70.25193165092826, -89.13500232902135, -113.69866575149094, -9.113673513091303, -42.93456815400314, -207.59616501360787, -85.49221629636851, -17.489964587075903, -34.013211364402906, -20.350206772532164, -30.507795417989, -12.869112268492103, 5.2601754265283045, -55.253411180788746, 9.981298583069925, -12.972503270842447, -214.5221733779666, -91.39623033560339, -93.72200721044985, -71.4772757989634, -92.4285197584704, -82.74863185489362, 11.774525723771179, -64.81318652829283, -132.398006393071, -92.51494599036444, -1.877702375659422, -74.4562074769495, 18.800642219697913, -18.85952666237911, -104.56594112295126, 4.121357219849151, -20.271523011300953, -92.52010149452812, -100.45995595766476, -162.77687943527968, -40.28339393947257, -53.992881852251045, -180.676562156317, -79.38506989550261, -181.64651619924274, -56.65974851422379, -66.45788168664059, -101.14540479778687, -184.09109342756724, -0.7753541322858815, -35.460334663669556, -109.80847104536704, -69.71600759917251, -25.874607666014608, -10.748449021760486, -191.68550099492455, -41.565783750695715, -3.345099817797066, -144.22961840964223, -108.08073642538109, -16.04751566208225, -51.615425688189525, -38.52152436858952, -97.33559131485727, -88.57135811120146, -89.09557130655985, -99.6146578294242, -74.62225793849848, -80.03199947465414, 14.848969174576562, -15.636868566469095, -50.27372265611659, -51.34221282795771, 3.4625020287667403, 17.046693074212733, -107.51006021527331, 16.019406914817818, -127.66298828038782, 22.179915711240493, -90.01843696067527], "episode_lengths": [57, 57, 102, 33, 56, 47, 77, 75, 56, 84, 52, 64, 75, 73, 38, 48, 46, 73, 83, 79, 65, 50, 51, 68, 73, 81, 79, 53, 56, 94, 83, 52, 51, 47, 50, 55, 43, 61, 33, 49, 98, 68, 69, 64, 80, 69, 40, 62, 81, 74, 40, 65, 36, 45, 72, 40, 47, 82, 71, 91, 52, 58, 95, 68, 102, 59, 66, 72, 90, 48, 48, 84, 66, 59, 55, 95, 55, 47, 92, 74, 48, 56, 61, 70, 69, 78, 76, 79, 69, 34, 52, 63, 61, 45, 34, 86, 37, 79, 30, 66], "policy_policy_0_reward": [-53.71402640752873, -22.125174689068015, -223.6083440191335, 7.969492441990387, -38.39201683877159, -6.175030077644337, -117.16696723394513, -128.70740171836252, -31.563766237091343, -156.5020799898735, -9.39149361863899, -59.520818392577, -73.03139491393591, -103.00025047409866, 7.394250686133237, -7.510815305079153, 3.2207231321453174, -101.44346062450374, -85.8312240273279, -76.45139245271055, -75.45685632044825, -26.512281156517158, -36.85667480484532, -89.4075863892764, -70.25193165092826, -89.13500232902135, -113.69866575149094, -9.113673513091303, -42.93456815400314, -207.59616501360787, -85.49221629636851, -17.489964587075903, -34.013211364402906, -20.350206772532164, -30.507795417989, -12.869112268492103, 5.2601754265283045, -55.253411180788746, 9.981298583069925, -12.972503270842447, -214.5221733779666, -91.39623033560339, -93.72200721044985, -71.4772757989634, -92.4285197584704, -82.74863185489362, 11.774525723771179, -64.81318652829283, -132.398006393071, -92.51494599036444, -1.877702375659422, -74.4562074769495, 18.800642219697913, -18.85952666237911, -104.56594112295126, 4.121357219849151, -20.271523011300953, -92.52010149452812, -100.45995595766476, -162.77687943527968, -40.28339393947257, -53.992881852251045, -180.676562156317, -79.38506989550261, -181.64651619924274, -56.65974851422379, -66.45788168664059, -101.14540479778687, -184.09109342756724, -0.7753541322858815, -35.460334663669556, -109.80847104536704, -69.71600759917251, -25.874607666014608, -10.748449021760486, -191.68550099492455, -41.565783750695715, -3.345099817797066, -144.22961840964223, -108.08073642538109, -16.04751566208225, -51.615425688189525, -38.52152436858952, -97.33559131485727, -88.57135811120146, -89.09557130655985, -99.6146578294242, -74.62225793849848, -80.03199947465414, 14.848969174576562, -15.636868566469095, -50.27372265611659, -51.34221282795771, 3.4625020287667403, 17.046693074212733, -107.51006021527331, 16.019406914817818, -127.66298828038782, 22.179915711240493, -90.01843696067527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945122898267665, "mean_inference_ms": 0.9079432272673325, "mean_action_processing_ms": 0.16330449591215349, "mean_env_wait_ms": 2.1611225662173212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005755186080932617, "StateBufferConnector_ms": 0.0041697025299072266, "ViewRequirementAgentConnector_ms": 0.10470724105834961}, "num_episodes": 65, "episode_return_max": 22.179915711240493, "episode_return_min": -223.6083440191335, "episode_return_mean": -64.57305052906652, "episodes_this_iter": 65}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.9634052139774, "num_env_steps_trained_throughput_per_sec": 264.9634052139774, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 14850.597, "restore_workers_time_ms": 0.032, "training_step_time_ms": 14850.508, "sample_time_ms": 2980.201, "learn_time_ms": 11853.74, "learn_throughput": 337.446, "synch_weights_time_ms": 15.267}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "64a97_00000", "date": "2024-07-26_23-26-07", "timestamp": 1722016567, "time_this_iter_s": 15.104801893234253, "time_total_s": 1244.9548017978668, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1244.9548017978668, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.44847195893526, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19427381393373555, "policy_loss": -0.006134543222045371, "vf_loss": 0.18268729091311495, "vf_explained_var": 0.9996232056990266, "kl": 0.0102596903353212, "entropy": -0.21391621833705965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 22.179915711240493, "episode_reward_min": -207.6311451642155, "episode_reward_mean": -57.17182632616625, "episode_len_mean": 60.98, "episode_media": {}, "episodes_timesteps_total": 6098, "policy_reward_min": {"policy_0": -207.6311451642155}, "policy_reward_max": {"policy_0": 22.179915711240493}, "policy_reward_mean": {"policy_0": -57.17182632616625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.14540479778687, -184.09109342756724, -0.7753541322858815, -35.460334663669556, -109.80847104536704, -69.71600759917251, -25.874607666014608, -10.748449021760486, -191.68550099492455, -41.565783750695715, -3.345099817797066, -144.22961840964223, -108.08073642538109, -16.04751566208225, -51.615425688189525, -38.52152436858952, -97.33559131485727, -88.57135811120146, -89.09557130655985, -99.6146578294242, -74.62225793849848, -80.03199947465414, 14.848969174576562, -15.636868566469095, -50.27372265611659, -51.34221282795771, 3.4625020287667403, 17.046693074212733, -107.51006021527331, 16.019406914817818, -127.66298828038782, 22.179915711240493, -90.01843696067527, -38.06231023054241, -101.79727436922342, 18.947381183025396, -49.19219678743013, -44.97278143137726, -145.80952720818692, -43.01501014215458, -78.93617562231132, 5.806380708369135, -87.02634236587994, -74.78010830126456, -20.489549768332775, -25.61414327580345, -206.75209395179004, -15.668053785234132, -45.29547702996768, 9.791901102361718, -75.59686430522927, -16.75555097084251, -11.113586716565756, -16.34137703725156, -78.51381043510897, -107.56394492181444, -55.60885849203195, 3.4505354427454775, -63.68224047418808, -36.21469348012184, -78.65831022498503, -48.62696813852985, -58.24458370812194, -120.45474272167338, -18.267845462150557, -7.529424052456545, -207.6311451642155, 14.720221180085248, -172.31931152684797, -143.50641805910135, -62.16236444225362, -35.52816820132962, -9.523811975175029, -4.481195956044109, -14.402910535892547, -129.40528454514774, -157.8244719015499, -175.94140618790303, -2.1091286253726897, -68.71765240799604, -141.55050191937522, 2.9254957634806678, 20.87602216677242, 0.31853359970465456, -18.29571999899149, -72.91445990292726, 5.211262006431961, -152.22941704492692, -55.11889106740883, -26.3387542279603, -86.66445283920442, 12.084778502877878, -48.912045348502886, -14.822579045563472, -38.10832435748248, -3.6367533047694316, -25.363843167300182, -17.120280681434163, -54.880123063934136, -70.35271731391221], "episode_lengths": [72, 90, 48, 48, 84, 66, 59, 55, 95, 55, 47, 92, 74, 48, 56, 61, 70, 69, 78, 76, 79, 69, 34, 52, 63, 61, 45, 34, 86, 37, 79, 30, 66, 54, 71, 36, 61, 61, 92, 60, 81, 41, 76, 78, 56, 50, 90, 49, 62, 36, 65, 47, 53, 45, 66, 74, 57, 43, 73, 56, 66, 56, 60, 74, 56, 43, 102, 30, 88, 91, 75, 55, 51, 44, 55, 77, 95, 86, 48, 66, 83, 36, 28, 41, 43, 80, 44, 81, 61, 52, 67, 36, 54, 43, 55, 39, 58, 44, 57, 67], "policy_policy_0_reward": [-101.14540479778687, -184.09109342756724, -0.7753541322858815, -35.460334663669556, -109.80847104536704, -69.71600759917251, -25.874607666014608, -10.748449021760486, -191.68550099492455, -41.565783750695715, -3.345099817797066, -144.22961840964223, -108.08073642538109, -16.04751566208225, -51.615425688189525, -38.52152436858952, -97.33559131485727, -88.57135811120146, -89.09557130655985, -99.6146578294242, -74.62225793849848, -80.03199947465414, 14.848969174576562, -15.636868566469095, -50.27372265611659, -51.34221282795771, 3.4625020287667403, 17.046693074212733, -107.51006021527331, 16.019406914817818, -127.66298828038782, 22.179915711240493, -90.01843696067527, -38.06231023054241, -101.79727436922342, 18.947381183025396, -49.19219678743013, -44.97278143137726, -145.80952720818692, -43.01501014215458, -78.93617562231132, 5.806380708369135, -87.02634236587994, -74.78010830126456, -20.489549768332775, -25.61414327580345, -206.75209395179004, -15.668053785234132, -45.29547702996768, 9.791901102361718, -75.59686430522927, -16.75555097084251, -11.113586716565756, -16.34137703725156, -78.51381043510897, -107.56394492181444, -55.60885849203195, 3.4505354427454775, -63.68224047418808, -36.21469348012184, -78.65831022498503, -48.62696813852985, -58.24458370812194, -120.45474272167338, -18.267845462150557, -7.529424052456545, -207.6311451642155, 14.720221180085248, -172.31931152684797, -143.50641805910135, -62.16236444225362, -35.52816820132962, -9.523811975175029, -4.481195956044109, -14.402910535892547, -129.40528454514774, -157.8244719015499, -175.94140618790303, -2.1091286253726897, -68.71765240799604, -141.55050191937522, 2.9254957634806678, 20.87602216677242, 0.31853359970465456, -18.29571999899149, -72.91445990292726, 5.211262006431961, -152.22941704492692, -55.11889106740883, -26.3387542279603, -86.66445283920442, 12.084778502877878, -48.912045348502886, -14.822579045563472, -38.10832435748248, -3.6367533047694316, -25.363843167300182, -17.120280681434163, -54.880123063934136, -70.35271731391221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2944251739085402, "mean_inference_ms": 0.9085696840527452, "mean_action_processing_ms": 0.16342464641188492, "mean_env_wait_ms": 2.1616691672375494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056383609771728516, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.10043954849243164}, "num_episodes": 67, "episode_return_max": 22.179915711240493, "episode_return_min": -207.6311451642155, "episode_return_mean": -57.17182632616625, "episodes_this_iter": 67}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.43134768442957, "num_env_steps_trained_throughput_per_sec": 264.43134768442957, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 14869.081, "restore_workers_time_ms": 0.032, "training_step_time_ms": 14868.992, "sample_time_ms": 2979.171, "learn_time_ms": 11873.047, "learn_throughput": 336.898, "synch_weights_time_ms": 15.513}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "64a97_00000", "date": "2024-07-26_23-26-22", "timestamp": 1722016582, "time_this_iter_s": 15.133967638015747, "time_total_s": 1260.0887694358826, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087bb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1260.0887694358826, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.436363636363636, "ram_util_percent": 28.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.997124356528126, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19919301824702415, "policy_loss": -0.00983473268133821, "vf_loss": 0.18920425650818895, "vf_explained_var": 0.9997168313090999, "kl": 0.01187760152509634, "entropy": -0.17843870616440352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 20.87602216677242, "episode_reward_min": -207.6311451642155, "episode_reward_mean": -64.27901625964869, "episode_len_mean": 61.96, "episode_media": {}, "episodes_timesteps_total": 6196, "policy_reward_min": {"policy_0": -207.6311451642155}, "policy_reward_max": {"policy_0": 20.87602216677242}, "policy_reward_mean": {"policy_0": -64.27901625964869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.24458370812194, -120.45474272167338, -18.267845462150557, -7.529424052456545, -207.6311451642155, 14.720221180085248, -172.31931152684797, -143.50641805910135, -62.16236444225362, -35.52816820132962, -9.523811975175029, -4.481195956044109, -14.402910535892547, -129.40528454514774, -157.8244719015499, -175.94140618790303, -2.1091286253726897, -68.71765240799604, -141.55050191937522, 2.9254957634806678, 20.87602216677242, 0.31853359970465456, -18.29571999899149, -72.91445990292726, 5.211262006431961, -152.22941704492692, -55.11889106740883, -26.3387542279603, -86.66445283920442, 12.084778502877878, -48.912045348502886, -14.822579045563472, -38.10832435748248, -3.6367533047694316, -25.363843167300182, -17.120280681434163, -54.880123063934136, -70.35271731391221, -14.58869784902253, -68.69295412578057, -169.97261418971317, -62.79321950268749, -153.28232543056868, -7.9202891676942375, 0.79338290952502, 18.943973074834748, 7.9003823139248555, -16.455598972548906, -19.46207112109274, -99.27158193437188, -133.11856956672554, -47.79395444425498, -6.403969310232821, -134.35016241759433, 7.959331165573974, -135.677195162937, -98.2054657364013, -50.61416569407495, -109.0985613759604, 18.11106963645886, -2.6888302682562264, 15.029774703491762, -9.347374573584558, 4.4286462367988255, -35.11969966989645, 14.515043747013555, -111.30235029179696, -195.90867829777616, -3.168942508832193, -150.723037960066, -190.8489392652895, 12.378901662910712, -138.37022601693255, -129.02963309978205, -52.41025984761825, -31.379250865698065, -32.312929779075155, -113.02461023323251, -91.53787218675483, -7.012511808400634, -48.842707113457855, -159.10222629900625, -64.86620769189905, -6.218322414432478, -190.23610320907775, -11.440862591296728, -62.410595430336, -72.94399775207349, -185.01347364732254, -22.283519786990396, -20.470764499998513, -174.1274496617683, -20.56662259916131, -143.11355515193108, -172.83045086137625, -93.02122516041595, -162.64169093332922, -50.03250555494924, -22.539738889643438, -65.15115395470896], "episode_lengths": [60, 74, 56, 43, 102, 30, 88, 91, 75, 55, 51, 44, 55, 77, 95, 86, 48, 66, 83, 36, 28, 41, 43, 80, 44, 81, 61, 52, 67, 36, 54, 43, 55, 39, 58, 44, 57, 67, 44, 76, 87, 63, 81, 41, 44, 27, 39, 55, 57, 84, 76, 57, 41, 80, 46, 92, 69, 61, 73, 29, 44, 29, 53, 39, 59, 33, 88, 95, 36, 93, 96, 32, 81, 92, 58, 49, 51, 76, 78, 42, 55, 82, 69, 49, 92, 51, 61, 62, 87, 54, 55, 86, 54, 91, 91, 72, 91, 54, 53, 76], "policy_policy_0_reward": [-58.24458370812194, -120.45474272167338, -18.267845462150557, -7.529424052456545, -207.6311451642155, 14.720221180085248, -172.31931152684797, -143.50641805910135, -62.16236444225362, -35.52816820132962, -9.523811975175029, -4.481195956044109, -14.402910535892547, -129.40528454514774, -157.8244719015499, -175.94140618790303, -2.1091286253726897, -68.71765240799604, -141.55050191937522, 2.9254957634806678, 20.87602216677242, 0.31853359970465456, -18.29571999899149, -72.91445990292726, 5.211262006431961, -152.22941704492692, -55.11889106740883, -26.3387542279603, -86.66445283920442, 12.084778502877878, -48.912045348502886, -14.822579045563472, -38.10832435748248, -3.6367533047694316, -25.363843167300182, -17.120280681434163, -54.880123063934136, -70.35271731391221, -14.58869784902253, -68.69295412578057, -169.97261418971317, -62.79321950268749, -153.28232543056868, -7.9202891676942375, 0.79338290952502, 18.943973074834748, 7.9003823139248555, -16.455598972548906, -19.46207112109274, -99.27158193437188, -133.11856956672554, -47.79395444425498, -6.403969310232821, -134.35016241759433, 7.959331165573974, -135.677195162937, -98.2054657364013, -50.61416569407495, -109.0985613759604, 18.11106963645886, -2.6888302682562264, 15.029774703491762, -9.347374573584558, 4.4286462367988255, -35.11969966989645, 14.515043747013555, -111.30235029179696, -195.90867829777616, -3.168942508832193, -150.723037960066, -190.8489392652895, 12.378901662910712, -138.37022601693255, -129.02963309978205, -52.41025984761825, -31.379250865698065, -32.312929779075155, -113.02461023323251, -91.53787218675483, -7.012511808400634, -48.842707113457855, -159.10222629900625, -64.86620769189905, -6.218322414432478, -190.23610320907775, -11.440862591296728, -62.410595430336, -72.94399775207349, -185.01347364732254, -22.283519786990396, -20.470764499998513, -174.1274496617683, -20.56662259916131, -143.11355515193108, -172.83045086137625, -93.02122516041595, -162.64169093332922, -50.03250555494924, -22.539738889643438, -65.15115395470896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2944893028693239, "mean_inference_ms": 0.907778109222327, "mean_action_processing_ms": 0.16328861946890377, "mean_env_wait_ms": 2.1619777150940758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057985782623291016, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.10039281845092773}, "num_episodes": 62, "episode_return_max": 20.87602216677242, "episode_return_min": -207.6311451642155, "episode_return_mean": -64.27901625964869, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.90610467454496, "num_env_steps_trained_throughput_per_sec": 271.90610467454496, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 14822.206, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14822.12, "sample_time_ms": 2972.259, "learn_time_ms": 11833.068, "learn_throughput": 338.036, "synch_weights_time_ms": 15.549}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "64a97_00000", "date": "2024-07-26_23-26-37", "timestamp": 1722016597, "time_this_iter_s": 14.718805074691772, "time_total_s": 1274.8075745105743, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05f809c4c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1274.8075745105743, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 10.357142857142858, "ram_util_percent": 28.87619047619047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.70903754333655, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1490029028747813, "policy_loss": -0.0062680437918364385, "vf_loss": 0.13287339921031768, "vf_explained_var": 0.9997349966938297, "kl": 0.01268369182441049, "entropy": -0.3134190957605218, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 13.814772598405282, "episode_reward_min": -195.90867829777616, "episode_reward_mean": -68.69710790887808, "episode_len_mean": 63.75, "episode_media": {}, "episodes_timesteps_total": 6375, "policy_reward_min": {"policy_0": -195.90867829777616}, "policy_reward_max": {"policy_0": 13.814772598405282}, "policy_reward_mean": {"policy_0": -68.69710790887808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.30235029179696, -195.90867829777616, -3.168942508832193, -150.723037960066, -190.8489392652895, 12.378901662910712, -138.37022601693255, -129.02963309978205, -52.41025984761825, -31.379250865698065, -32.312929779075155, -113.02461023323251, -91.53787218675483, -7.012511808400634, -48.842707113457855, -159.10222629900625, -64.86620769189905, -6.218322414432478, -190.23610320907775, -11.440862591296728, -62.410595430336, -72.94399775207349, -185.01347364732254, -22.283519786990396, -20.470764499998513, -174.1274496617683, -20.56662259916131, -143.11355515193108, -172.83045086137625, -93.02122516041595, -162.64169093332922, -50.03250555494924, -22.539738889643438, -65.15115395470896, -83.18610546556346, -140.04073875934986, -154.84154373702708, 11.403345529155505, -19.059289832698564, -186.21384585921777, -7.68998311009879, 5.581812814824557, 8.039367786788253, -152.60732810546278, -38.93157547971308, -90.12450855010057, -105.53338980484997, -142.33480064705026, -58.98753854920553, -15.220568857848667, -48.319369633544355, 11.158336891998776, -7.463580787045454, -179.13351120762366, -135.11850549503626, -66.53839610779369, -115.94713259438875, -75.9640746332369, 1.3371638340120666, -43.90466619544758, -19.915061204773032, -182.23740666520794, -4.871452420697238, -57.95173550057514, -112.38179091757578, -141.0115873925074, 13.034599320430853, 9.848862419193916, -24.115306386160317, -67.03511888299047, -7.089999264365916, -136.1660458707679, -39.26775399205068, 13.814772598405282, -70.62440033903317, 13.41334684099299, -35.79202802463776, -34.591883410583904, -0.1724142485842639, -20.124590147646142, 8.727874946558735, -97.95932224294073, -102.74026602945854, 12.870157545341943, 3.537934116608626, -21.32856813433742, -33.12184021168524, -4.18769469809516, -21.439494577663474, -108.29209039491101, 0.09586611974539849, -122.39863780557734, -98.48067866292682, -13.888667232889262, -167.74335817413126, -142.09599712748354, -9.698017196751096, -77.81107964485248, -71.95367798852213, -86.42229974765951], "episode_lengths": [88, 95, 36, 93, 96, 32, 81, 92, 58, 49, 51, 76, 78, 42, 55, 82, 69, 49, 92, 51, 61, 62, 87, 54, 55, 86, 54, 91, 91, 72, 91, 54, 53, 76, 77, 81, 84, 37, 56, 92, 46, 42, 34, 81, 56, 73, 71, 82, 59, 52, 62, 33, 50, 100, 84, 66, 83, 68, 41, 55, 51, 87, 52, 58, 77, 81, 34, 40, 46, 71, 49, 80, 62, 37, 63, 32, 50, 62, 49, 53, 43, 72, 72, 40, 40, 57, 51, 37, 49, 77, 48, 80, 71, 53, 89, 87, 40, 70, 65, 83], "policy_policy_0_reward": [-111.30235029179696, -195.90867829777616, -3.168942508832193, -150.723037960066, -190.8489392652895, 12.378901662910712, -138.37022601693255, -129.02963309978205, -52.41025984761825, -31.379250865698065, -32.312929779075155, -113.02461023323251, -91.53787218675483, -7.012511808400634, -48.842707113457855, -159.10222629900625, -64.86620769189905, -6.218322414432478, -190.23610320907775, -11.440862591296728, -62.410595430336, -72.94399775207349, -185.01347364732254, -22.283519786990396, -20.470764499998513, -174.1274496617683, -20.56662259916131, -143.11355515193108, -172.83045086137625, -93.02122516041595, -162.64169093332922, -50.03250555494924, -22.539738889643438, -65.15115395470896, -83.18610546556346, -140.04073875934986, -154.84154373702708, 11.403345529155505, -19.059289832698564, -186.21384585921777, -7.68998311009879, 5.581812814824557, 8.039367786788253, -152.60732810546278, -38.93157547971308, -90.12450855010057, -105.53338980484997, -142.33480064705026, -58.98753854920553, -15.220568857848667, -48.319369633544355, 11.158336891998776, -7.463580787045454, -179.13351120762366, -135.11850549503626, -66.53839610779369, -115.94713259438875, -75.9640746332369, 1.3371638340120666, -43.90466619544758, -19.915061204773032, -182.23740666520794, -4.871452420697238, -57.95173550057514, -112.38179091757578, -141.0115873925074, 13.034599320430853, 9.848862419193916, -24.115306386160317, -67.03511888299047, -7.089999264365916, -136.1660458707679, -39.26775399205068, 13.814772598405282, -70.62440033903317, 13.41334684099299, -35.79202802463776, -34.591883410583904, -0.1724142485842639, -20.124590147646142, 8.727874946558735, -97.95932224294073, -102.74026602945854, 12.870157545341943, 3.537934116608626, -21.32856813433742, -33.12184021168524, -4.18769469809516, -21.439494577663474, -108.29209039491101, 0.09586611974539849, -122.39863780557734, -98.48067866292682, -13.888667232889262, -167.74335817413126, -142.09599712748354, -9.698017196751096, -77.81107964485248, -71.95367798852213, -86.42229974765951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2944921179504015, "mean_inference_ms": 0.9068696189002075, "mean_action_processing_ms": 0.16316761395104085, "mean_env_wait_ms": 2.1630455270691162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005403995513916016, "StateBufferConnector_ms": 0.004033565521240234, "ViewRequirementAgentConnector_ms": 0.10219192504882812}, "num_episodes": 66, "episode_return_max": 13.814772598405282, "episode_return_min": -195.90867829777616, "episode_return_mean": -68.69710790887808, "episodes_this_iter": 66}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.86667666457976, "num_env_steps_trained_throughput_per_sec": 336.86667666457976, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 14577.319, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14577.232, "sample_time_ms": 2977.633, "learn_time_ms": 11583.209, "learn_throughput": 345.327, "synch_weights_time_ms": 15.171}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "64a97_00000", "date": "2024-07-26_23-26-49", "timestamp": 1722016609, "time_this_iter_s": 11.88221025466919, "time_total_s": 1286.6897847652435, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1286.6897847652435, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 11.625, "ram_util_percent": 28.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.51644610365232, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1697548924353517, "policy_loss": -0.007026523980312049, "vf_loss": 0.15294192937047532, "vf_explained_var": 0.9997325947508215, "kl": 0.013716902296194695, "entropy": -0.3006941866517688, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 20.795905252073275, "episode_reward_min": -187.3438264361516, "episode_reward_mean": -59.98914129418768, "episode_len_mean": 61.82, "episode_media": {}, "episodes_timesteps_total": 6182, "policy_reward_min": {"policy_0": -187.3438264361516}, "policy_reward_max": {"policy_0": 20.795905252073275}, "policy_reward_mean": {"policy_0": -59.98914129418768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.871452420697238, -57.95173550057514, -112.38179091757578, -141.0115873925074, 13.034599320430853, 9.848862419193916, -24.115306386160317, -67.03511888299047, -7.089999264365916, -136.1660458707679, -39.26775399205068, 13.814772598405282, -70.62440033903317, 13.41334684099299, -35.79202802463776, -34.591883410583904, -0.1724142485842639, -20.124590147646142, 8.727874946558735, -97.95932224294073, -102.74026602945854, 12.870157545341943, 3.537934116608626, -21.32856813433742, -33.12184021168524, -4.18769469809516, -21.439494577663474, -108.29209039491101, 0.09586611974539849, -122.39863780557734, -98.48067866292682, -13.888667232889262, -167.74335817413126, -142.09599712748354, -9.698017196751096, -77.81107964485248, -71.95367798852213, -86.42229974765951, -139.96777029356923, 11.916340747730356, -100.52210886587702, -116.26314755186397, -129.614701438936, 12.371013562753475, -126.08208394817528, -16.115047031755665, -81.49742990562139, -52.1429903922073, -48.77385626065976, -33.97820093177748, -77.02125955537973, -40.24956244313601, -67.8580618562818, -72.78034717259307, 7.388091271312539, 5.784005347842361, -86.05039678798431, -94.80565847920153, -33.29712767994578, -2.363156297726707, -7.81981661970082, 18.48318297667397, -20.32207410169736, -148.92315136491618, -136.78796443015307, -29.71341164891462, -101.2355099094244, -105.30361976271479, -113.20489226409948, -137.3157598056708, 20.795905252073275, -3.067701152816496, -14.37901793109204, -122.74391623948708, -16.71540886177904, -187.3438264361516, -23.369345981725992, -62.36726498618565, -88.9446559575143, -13.812707977817423, 9.489136575111601, -142.65321249354366, -25.793628147558117, -110.70528759352943, -54.32118332609233, -129.8824174043816, -41.02926549732028, 16.27879931471592, -40.843950858592045, -38.97742608437652, -117.11086307307333, -129.38306815641718, -95.15985485556212, -41.87078375588035, -145.73428997725856, -61.83313243188023, -173.7743379700971, -80.44424204856942, -90.09868214439305, -73.63764356312028], "episode_lengths": [52, 58, 77, 81, 34, 40, 46, 71, 49, 80, 62, 37, 63, 32, 50, 62, 49, 53, 43, 72, 72, 40, 40, 57, 51, 37, 49, 77, 48, 80, 71, 53, 89, 87, 40, 70, 65, 83, 80, 39, 72, 75, 76, 32, 78, 54, 78, 55, 64, 61, 68, 54, 78, 73, 42, 41, 68, 68, 57, 44, 51, 34, 57, 83, 83, 58, 83, 73, 74, 88, 30, 44, 48, 80, 44, 89, 49, 61, 69, 51, 37, 81, 47, 78, 63, 83, 55, 38, 57, 60, 75, 85, 85, 56, 82, 77, 92, 72, 68, 65], "policy_policy_0_reward": [-4.871452420697238, -57.95173550057514, -112.38179091757578, -141.0115873925074, 13.034599320430853, 9.848862419193916, -24.115306386160317, -67.03511888299047, -7.089999264365916, -136.1660458707679, -39.26775399205068, 13.814772598405282, -70.62440033903317, 13.41334684099299, -35.79202802463776, -34.591883410583904, -0.1724142485842639, -20.124590147646142, 8.727874946558735, -97.95932224294073, -102.74026602945854, 12.870157545341943, 3.537934116608626, -21.32856813433742, -33.12184021168524, -4.18769469809516, -21.439494577663474, -108.29209039491101, 0.09586611974539849, -122.39863780557734, -98.48067866292682, -13.888667232889262, -167.74335817413126, -142.09599712748354, -9.698017196751096, -77.81107964485248, -71.95367798852213, -86.42229974765951, -139.96777029356923, 11.916340747730356, -100.52210886587702, -116.26314755186397, -129.614701438936, 12.371013562753475, -126.08208394817528, -16.115047031755665, -81.49742990562139, -52.1429903922073, -48.77385626065976, -33.97820093177748, -77.02125955537973, -40.24956244313601, -67.8580618562818, -72.78034717259307, 7.388091271312539, 5.784005347842361, -86.05039678798431, -94.80565847920153, -33.29712767994578, -2.363156297726707, -7.81981661970082, 18.48318297667397, -20.32207410169736, -148.92315136491618, -136.78796443015307, -29.71341164891462, -101.2355099094244, -105.30361976271479, -113.20489226409948, -137.3157598056708, 20.795905252073275, -3.067701152816496, -14.37901793109204, -122.74391623948708, -16.71540886177904, -187.3438264361516, -23.369345981725992, -62.36726498618565, -88.9446559575143, -13.812707977817423, 9.489136575111601, -142.65321249354366, -25.793628147558117, -110.70528759352943, -54.32118332609233, -129.8824174043816, -41.02926549732028, 16.27879931471592, -40.843950858592045, -38.97742608437652, -117.11086307307333, -129.38306815641718, -95.15985485556212, -41.87078375588035, -145.73428997725856, -61.83313243188023, -173.7743379700971, -80.44424204856942, -90.09868214439305, -73.63764356312028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945762318487661, "mean_inference_ms": 0.906884324001141, "mean_action_processing_ms": 0.1631215068030486, "mean_env_wait_ms": 2.164042890679375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005708217620849609, "StateBufferConnector_ms": 0.004028797149658203, "ViewRequirementAgentConnector_ms": 0.10143089294433594}, "num_episodes": 62, "episode_return_max": 20.795905252073275, "episode_return_min": -187.3438264361516, "episode_return_mean": -59.98914129418768, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.0754278961704, "num_env_steps_trained_throughput_per_sec": 278.0754278961704, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 14483.484, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14483.401, "sample_time_ms": 2971.283, "learn_time_ms": 11495.861, "learn_throughput": 347.951, "synch_weights_time_ms": 15.02}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "64a97_00000", "date": "2024-07-26_23-27-03", "timestamp": 1722016623, "time_this_iter_s": 14.39160418510437, "time_total_s": 1301.081388950348, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7a9e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1301.081388950348, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 10.40952380952381, "ram_util_percent": 28.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.36285858352979, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1485207085182386, "policy_loss": -0.01030127367315193, "vf_loss": 0.13808814232470468, "vf_explained_var": 0.9997723930204908, "kl": 0.01172284546507101, "entropy": -0.29297689725256837, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 21.556742587078027, "episode_reward_min": -194.56358793450846, "episode_reward_mean": -65.51874411580984, "episode_len_mean": 63.22, "episode_media": {}, "episodes_timesteps_total": 6322, "policy_reward_min": {"policy_0": -194.56358793450846}, "policy_reward_max": {"policy_0": 21.556742587078027}, "policy_reward_mean": {"policy_0": -65.51874411580984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.2355099094244, -105.30361976271479, -113.20489226409948, -137.3157598056708, 20.795905252073275, -3.067701152816496, -14.37901793109204, -122.74391623948708, -16.71540886177904, -187.3438264361516, -23.369345981725992, -62.36726498618565, -88.9446559575143, -13.812707977817423, 9.489136575111601, -142.65321249354366, -25.793628147558117, -110.70528759352943, -54.32118332609233, -129.8824174043816, -41.02926549732028, 16.27879931471592, -40.843950858592045, -38.97742608437652, -117.11086307307333, -129.38306815641718, -95.15985485556212, -41.87078375588035, -145.73428997725856, -61.83313243188023, -173.7743379700971, -80.44424204856942, -90.09868214439305, -73.63764356312028, -69.27718299975871, -22.163789961269472, -63.36388645264126, 0.8787704024222547, 9.415769401199851, -161.30567129784376, -40.74466740699386, -128.89012436781647, -129.1179520652949, 9.042906693961806, -22.79088856954489, -190.67916305589057, -74.23623814736277, -21.615078573942345, -111.44325737143251, -13.011496065627174, -55.39315102609916, -65.46492434189818, 8.659113713794262, -194.56358793450846, 3.6795062862297634, -52.65251108528041, 13.706580510190381, -115.15613910276466, 7.11225138930155, -168.495250218559, -29.017971874708948, -170.08477692459854, -70.22773363354295, 5.911505363886098, 21.556742587078027, -88.12888283737185, -4.563420360889748, 3.102212261940103, -75.7504169313169, -99.13184675074756, -114.02272286765225, -117.20930380013046, -111.43314182986363, -22.415234226549085, -45.48733760997227, -149.62777568075433, -15.880205894580653, -138.48620929180817, -9.2942399604059, 14.319845734925119, -66.30568823047214, -94.13439277183582, -64.65765784340088, -106.33752428124552, -57.39744229395059, -123.64812866941932, -36.521091239881606, -26.716412746117296, -1.6251810862399712, -182.7171023322306, -41.671223106631615, -24.664645967944352, -45.30938305872084, 20.53099308410851, -105.02883481889648, -116.23408419505685, 0.4354466164303541, -8.330308601316833, -31.133764667147343, -40.17395369029851], "episode_lengths": [83, 73, 74, 88, 30, 44, 48, 80, 44, 89, 49, 61, 69, 51, 37, 81, 47, 78, 63, 83, 55, 38, 57, 60, 75, 85, 85, 56, 82, 77, 92, 72, 68, 65, 65, 56, 61, 49, 40, 85, 59, 78, 79, 35, 59, 92, 67, 56, 79, 44, 62, 59, 39, 94, 38, 61, 34, 74, 40, 85, 60, 90, 64, 39, 27, 77, 40, 36, 63, 73, 80, 90, 77, 53, 64, 83, 57, 92, 55, 36, 62, 70, 67, 73, 65, 91, 61, 50, 51, 88, 59, 52, 64, 36, 74, 75, 43, 45, 59, 52], "policy_policy_0_reward": [-101.2355099094244, -105.30361976271479, -113.20489226409948, -137.3157598056708, 20.795905252073275, -3.067701152816496, -14.37901793109204, -122.74391623948708, -16.71540886177904, -187.3438264361516, -23.369345981725992, -62.36726498618565, -88.9446559575143, -13.812707977817423, 9.489136575111601, -142.65321249354366, -25.793628147558117, -110.70528759352943, -54.32118332609233, -129.8824174043816, -41.02926549732028, 16.27879931471592, -40.843950858592045, -38.97742608437652, -117.11086307307333, -129.38306815641718, -95.15985485556212, -41.87078375588035, -145.73428997725856, -61.83313243188023, -173.7743379700971, -80.44424204856942, -90.09868214439305, -73.63764356312028, -69.27718299975871, -22.163789961269472, -63.36388645264126, 0.8787704024222547, 9.415769401199851, -161.30567129784376, -40.74466740699386, -128.89012436781647, -129.1179520652949, 9.042906693961806, -22.79088856954489, -190.67916305589057, -74.23623814736277, -21.615078573942345, -111.44325737143251, -13.011496065627174, -55.39315102609916, -65.46492434189818, 8.659113713794262, -194.56358793450846, 3.6795062862297634, -52.65251108528041, 13.706580510190381, -115.15613910276466, 7.11225138930155, -168.495250218559, -29.017971874708948, -170.08477692459854, -70.22773363354295, 5.911505363886098, 21.556742587078027, -88.12888283737185, -4.563420360889748, 3.102212261940103, -75.7504169313169, -99.13184675074756, -114.02272286765225, -117.20930380013046, -111.43314182986363, -22.415234226549085, -45.48733760997227, -149.62777568075433, -15.880205894580653, -138.48620929180817, -9.2942399604059, 14.319845734925119, -66.30568823047214, -94.13439277183582, -64.65765784340088, -106.33752428124552, -57.39744229395059, -123.64812866941932, -36.521091239881606, -26.716412746117296, -1.6251810862399712, -182.7171023322306, -41.671223106631615, -24.664645967944352, -45.30938305872084, 20.53099308410851, -105.02883481889648, -116.23408419505685, 0.4354466164303541, -8.330308601316833, -31.133764667147343, -40.17395369029851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945565414099892, "mean_inference_ms": 0.9075126483541984, "mean_action_processing_ms": 0.16324601436074054, "mean_env_wait_ms": 2.1644640836588493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005776882171630859, "StateBufferConnector_ms": 0.004021883010864258, "ViewRequirementAgentConnector_ms": 0.10106110572814941}, "num_episodes": 66, "episode_return_max": 21.556742587078027, "episode_return_min": -194.56358793450846, "episode_return_mean": -65.51874411580984, "episodes_this_iter": 66}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.87013275962136, "num_env_steps_trained_throughput_per_sec": 271.87013275962136, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 14463.353, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14463.268, "sample_time_ms": 2961.133, "learn_time_ms": 11485.757, "learn_throughput": 348.257, "synch_weights_time_ms": 15.082}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "64a97_00000", "date": "2024-07-26_23-27-18", "timestamp": 1722016638, "time_this_iter_s": 14.718784093856812, "time_total_s": 1315.8001730442047, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb7067a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1315.8001730442047, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 10.557142857142859, "ram_util_percent": 28.852380952380948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.28130686332782, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.16859761486266506, "policy_loss": -0.008032573043601587, "vf_loss": 0.15303767539250354, "vf_explained_var": 0.9997165920833747, "kl": 0.013686205144525392, "entropy": -0.28065897279108565, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": 21.556742587078027, "episode_reward_min": -213.78765690763538, "episode_reward_mean": -61.04703198566489, "episode_len_mean": 62.38, "episode_media": {}, "episodes_timesteps_total": 6238, "policy_reward_min": {"policy_0": -213.78765690763538}, "policy_reward_max": {"policy_0": 21.556742587078027}, "policy_reward_mean": {"policy_0": -61.04703198566489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.22773363354295, 5.911505363886098, 21.556742587078027, -88.12888283737185, -4.563420360889748, 3.102212261940103, -75.7504169313169, -99.13184675074756, -114.02272286765225, -117.20930380013046, -111.43314182986363, -22.415234226549085, -45.48733760997227, -149.62777568075433, -15.880205894580653, -138.48620929180817, -9.2942399604059, 14.319845734925119, -66.30568823047214, -94.13439277183582, -64.65765784340088, -106.33752428124552, -57.39744229395059, -123.64812866941932, -36.521091239881606, -26.716412746117296, -1.6251810862399712, -182.7171023322306, -41.671223106631615, -24.664645967944352, -45.30938305872084, 20.53099308410851, -105.02883481889648, -116.23408419505685, 0.4354466164303541, -8.330308601316833, -31.133764667147343, -40.17395369029851, -51.66788164838911, -134.80102977157466, -32.938112422910585, 8.731966320005721, -8.00212769254652, -33.96547492547047, -49.01230597448439, -13.19231486775278, -7.700486986430618, -50.27527508277988, -143.83196329655948, -131.38353516609027, -62.10632349137869, -80.53052770635063, -48.694084569853615, 9.973658368116222, -57.27404825641, -94.76543818324544, -29.936585654049328, -133.71508666623424, -124.71392891440983, -18.425080482487306, -90.13772713243513, -28.97202780474585, -14.0064753437076, -213.78765690763538, -45.20623470112064, -22.31525277160921, -37.038647490000706, 19.320002380262054, -62.52765390376531, -13.518910541406068, 5.11236833924499, -174.55865805116866, -33.94254412255985, -19.131047829549143, -160.1051418490458, -53.461128784371596, 12.212534473089121, -59.919464677652556, -101.32191553164674, -39.212851204582556, -27.982071082556544, -106.69651018557812, -139.35289269488217, -116.13212830599014, -178.222316070893, -8.883715656390088, -86.43828122865786, -30.296640597219785, -136.41427771067447, -172.29408491643736, -95.64284494754676, -36.99044335518405, 6.816450246279213, 1.8478642673492747, -64.5663375663875, -47.30457966800553, -111.57914635020374, -70.57658000603105, -95.46616223343277, 0.6244656496695196], "episode_lengths": [64, 39, 27, 77, 40, 36, 63, 73, 80, 90, 77, 53, 64, 83, 57, 92, 55, 36, 62, 70, 67, 73, 65, 91, 61, 50, 51, 88, 59, 52, 64, 36, 74, 75, 43, 45, 59, 52, 56, 87, 54, 36, 44, 59, 60, 48, 41, 56, 93, 82, 76, 73, 64, 33, 64, 76, 53, 79, 76, 53, 69, 50, 53, 100, 54, 47, 51, 27, 67, 45, 46, 88, 60, 47, 87, 58, 31, 60, 69, 52, 60, 88, 79, 87, 90, 49, 82, 49, 92, 93, 69, 58, 39, 39, 64, 58, 81, 66, 86, 42], "policy_policy_0_reward": [-70.22773363354295, 5.911505363886098, 21.556742587078027, -88.12888283737185, -4.563420360889748, 3.102212261940103, -75.7504169313169, -99.13184675074756, -114.02272286765225, -117.20930380013046, -111.43314182986363, -22.415234226549085, -45.48733760997227, -149.62777568075433, -15.880205894580653, -138.48620929180817, -9.2942399604059, 14.319845734925119, -66.30568823047214, -94.13439277183582, -64.65765784340088, -106.33752428124552, -57.39744229395059, -123.64812866941932, -36.521091239881606, -26.716412746117296, -1.6251810862399712, -182.7171023322306, -41.671223106631615, -24.664645967944352, -45.30938305872084, 20.53099308410851, -105.02883481889648, -116.23408419505685, 0.4354466164303541, -8.330308601316833, -31.133764667147343, -40.17395369029851, -51.66788164838911, -134.80102977157466, -32.938112422910585, 8.731966320005721, -8.00212769254652, -33.96547492547047, -49.01230597448439, -13.19231486775278, -7.700486986430618, -50.27527508277988, -143.83196329655948, -131.38353516609027, -62.10632349137869, -80.53052770635063, -48.694084569853615, 9.973658368116222, -57.27404825641, -94.76543818324544, -29.936585654049328, -133.71508666623424, -124.71392891440983, -18.425080482487306, -90.13772713243513, -28.97202780474585, -14.0064753437076, -213.78765690763538, -45.20623470112064, -22.31525277160921, -37.038647490000706, 19.320002380262054, -62.52765390376531, -13.518910541406068, 5.11236833924499, -174.55865805116866, -33.94254412255985, -19.131047829549143, -160.1051418490458, -53.461128784371596, 12.212534473089121, -59.919464677652556, -101.32191553164674, -39.212851204582556, -27.982071082556544, -106.69651018557812, -139.35289269488217, -116.13212830599014, -178.222316070893, -8.883715656390088, -86.43828122865786, -30.296640597219785, -136.41427771067447, -172.29408491643736, -95.64284494754676, -36.99044335518405, 6.816450246279213, 1.8478642673492747, -64.5663375663875, -47.30457966800553, -111.57914635020374, -70.57658000603105, -95.46616223343277, 0.6244656496695196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29446227750364146, "mean_inference_ms": 0.9075300677176645, "mean_action_processing_ms": 0.16326058820108003, "mean_env_wait_ms": 2.1646062207443855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005757808685302734, "StateBufferConnector_ms": 0.004010677337646484, "ViewRequirementAgentConnector_ms": 0.10074305534362793}, "num_episodes": 62, "episode_return_max": 21.556742587078027, "episode_return_min": -213.78765690763538, "episode_return_mean": -61.04703198566489, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.23579415015274, "num_env_steps_trained_throughput_per_sec": 268.23579415015274, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 14469.187, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14469.104, "sample_time_ms": 2947.817, "learn_time_ms": 11504.865, "learn_throughput": 347.679, "synch_weights_time_ms": 15.135}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "64a97_00000", "date": "2024-07-26_23-27-33", "timestamp": 1722016653, "time_this_iter_s": 14.920505046844482, "time_total_s": 1330.7206780910492, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05fb734310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1330.7206780910492, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.29047619047619, "ram_util_percent": 28.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.43923325588306, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.15642613388287524, "policy_loss": -0.0077609210687417845, "vf_loss": 0.14174536355227854, "vf_explained_var": 0.999726091325283, "kl": 0.012634018175837558, "entropy": -0.3253776488049577, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 21.17231494290227, "episode_reward_min": -193.69315823307878, "episode_reward_mean": -60.20014912725515, "episode_len_mean": 62.06, "episode_media": {}, "episodes_timesteps_total": 6206, "policy_reward_min": {"policy_0": -193.69315823307878}, "policy_reward_max": {"policy_0": 21.17231494290227}, "policy_reward_mean": {"policy_0": -60.20014912725515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.52765390376531, -13.518910541406068, 5.11236833924499, -174.55865805116866, -33.94254412255985, -19.131047829549143, -160.1051418490458, -53.461128784371596, 12.212534473089121, -59.919464677652556, -101.32191553164674, -39.212851204582556, -27.982071082556544, -106.69651018557812, -139.35289269488217, -116.13212830599014, -178.222316070893, -8.883715656390088, -86.43828122865786, -30.296640597219785, -136.41427771067447, -172.29408491643736, -95.64284494754676, -36.99044335518405, 6.816450246279213, 1.8478642673492747, -64.5663375663875, -47.30457966800553, -111.57914635020374, -70.57658000603105, -95.46616223343277, 0.6244656496695196, -77.44959535825092, -97.98043551169297, -113.77272619608233, -32.919317468228115, -34.34682947724565, -80.873758626234, -40.38613230192812, -11.297135738234784, 5.57283376233025, -70.05631870797697, -96.22807276708438, -43.672948739096455, -78.07094644717732, -193.69315823307878, -16.416327676947244, 11.918660384091885, -164.55672867356765, -80.89255954097325, -122.37142207623684, -24.410778892212214, -25.25948570153914, -9.091657589299045, 9.19804446417728, 11.641916532340158, -2.839078550343922, -45.689311306136645, -100.55513646167356, -82.1820445493593, -97.53347281899258, 13.220939723182251, -25.54392662417901, -124.36740945666351, -115.69978622945443, -59.45242428048391, -123.41556973283967, -67.12547979240769, -106.27951781605579, -165.06167755635175, -120.73255473970289, -19.710124497607715, -0.8268175008016752, -71.4883478111045, -182.5535117847794, 19.299019240387864, -107.27217862221751, -41.20334538372588, 6.803540893856894, -12.552846198143868, -6.335326970510984, -192.71969198875627, 21.17231494290227, -88.79939924132394, 7.705823791247964, 14.547736670916237, -147.0927354364555, 2.3688532535898945, -72.79936691421429, -17.330627181566616, 18.970909312883144, -35.89136748469424, -12.531947343019198, -18.729773213639316, -69.81535846616615, -0.6613589424181718, -84.71168477679815, 11.712956515868823, -7.108112362353863, -117.8661683590757], "episode_lengths": [67, 45, 46, 88, 60, 47, 87, 58, 31, 60, 69, 52, 60, 88, 79, 87, 90, 49, 82, 49, 92, 93, 69, 58, 39, 39, 64, 58, 81, 66, 86, 42, 68, 76, 73, 60, 50, 68, 58, 54, 47, 65, 79, 54, 68, 94, 53, 42, 86, 80, 77, 50, 51, 51, 38, 43, 38, 61, 73, 69, 84, 34, 59, 80, 88, 60, 83, 67, 73, 96, 77, 52, 44, 68, 95, 34, 83, 55, 42, 44, 39, 93, 30, 69, 35, 31, 85, 41, 78, 57, 29, 58, 47, 58, 63, 39, 67, 34, 42, 86], "policy_policy_0_reward": [-62.52765390376531, -13.518910541406068, 5.11236833924499, -174.55865805116866, -33.94254412255985, -19.131047829549143, -160.1051418490458, -53.461128784371596, 12.212534473089121, -59.919464677652556, -101.32191553164674, -39.212851204582556, -27.982071082556544, -106.69651018557812, -139.35289269488217, -116.13212830599014, -178.222316070893, -8.883715656390088, -86.43828122865786, -30.296640597219785, -136.41427771067447, -172.29408491643736, -95.64284494754676, -36.99044335518405, 6.816450246279213, 1.8478642673492747, -64.5663375663875, -47.30457966800553, -111.57914635020374, -70.57658000603105, -95.46616223343277, 0.6244656496695196, -77.44959535825092, -97.98043551169297, -113.77272619608233, -32.919317468228115, -34.34682947724565, -80.873758626234, -40.38613230192812, -11.297135738234784, 5.57283376233025, -70.05631870797697, -96.22807276708438, -43.672948739096455, -78.07094644717732, -193.69315823307878, -16.416327676947244, 11.918660384091885, -164.55672867356765, -80.89255954097325, -122.37142207623684, -24.410778892212214, -25.25948570153914, -9.091657589299045, 9.19804446417728, 11.641916532340158, -2.839078550343922, -45.689311306136645, -100.55513646167356, -82.1820445493593, -97.53347281899258, 13.220939723182251, -25.54392662417901, -124.36740945666351, -115.69978622945443, -59.45242428048391, -123.41556973283967, -67.12547979240769, -106.27951781605579, -165.06167755635175, -120.73255473970289, -19.710124497607715, -0.8268175008016752, -71.4883478111045, -182.5535117847794, 19.299019240387864, -107.27217862221751, -41.20334538372588, 6.803540893856894, -12.552846198143868, -6.335326970510984, -192.71969198875627, 21.17231494290227, -88.79939924132394, 7.705823791247964, 14.547736670916237, -147.0927354364555, 2.3688532535898945, -72.79936691421429, -17.330627181566616, 18.970909312883144, -35.89136748469424, -12.531947343019198, -18.729773213639316, -69.81535846616615, -0.6613589424181718, -84.71168477679815, 11.712956515868823, -7.108112362353863, -117.8661683590757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29450656962042726, "mean_inference_ms": 0.9078805176586907, "mean_action_processing_ms": 0.1633366325081986, "mean_env_wait_ms": 2.1658767657298825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005808830261230469, "StateBufferConnector_ms": 0.004089832305908203, "ViewRequirementAgentConnector_ms": 0.10319232940673828}, "num_episodes": 68, "episode_return_max": 21.17231494290227, "episode_return_min": -193.69315823307878, "episode_return_mean": -60.20014912725515, "episodes_this_iter": 68}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.38873121175425, "num_env_steps_trained_throughput_per_sec": 341.38873121175425, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 14150.129, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14150.043, "sample_time_ms": 2946.874, "learn_time_ms": 11186.665, "learn_throughput": 357.569, "synch_weights_time_ms": 15.217}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "64a97_00000", "date": "2024-07-26_23-27-45", "timestamp": 1722016665, "time_this_iter_s": 11.725810527801514, "time_total_s": 1342.4464886188507, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05f809cc10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1342.4464886188507, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.270588235294117, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.11506364891927, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.1838832092602388, "policy_loss": -0.008384882591781207, "vf_loss": 0.1720348606662204, "vf_explained_var": 0.9996962089091539, "kl": 0.011486721812434595, "entropy": -0.2787773596743743, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 21.17231494290227, "episode_reward_min": -192.71969198875627, "episode_reward_mean": -54.86436797511712, "episode_len_mean": 59.84, "episode_media": {}, "episodes_timesteps_total": 5984, "policy_reward_min": {"policy_0": -192.71969198875627}, "policy_reward_max": {"policy_0": 21.17231494290227}, "policy_reward_mean": {"policy_0": -54.86436797511712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.69978622945443, -59.45242428048391, -123.41556973283967, -67.12547979240769, -106.27951781605579, -165.06167755635175, -120.73255473970289, -19.710124497607715, -0.8268175008016752, -71.4883478111045, -182.5535117847794, 19.299019240387864, -107.27217862221751, -41.20334538372588, 6.803540893856894, -12.552846198143868, -6.335326970510984, -192.71969198875627, 21.17231494290227, -88.79939924132394, 7.705823791247964, 14.547736670916237, -147.0927354364555, 2.3688532535898945, -72.79936691421429, -17.330627181566616, 18.970909312883144, -35.89136748469424, -12.531947343019198, -18.729773213639316, -69.81535846616615, -0.6613589424181718, -84.71168477679815, 11.712956515868823, -7.108112362353863, -117.8661683590757, -20.518241489787215, -85.99420905621777, -25.876670867188604, 5.694778444851299, -18.73141017520236, -10.521531462810684, -80.26301257302237, -2.288042427892141, 18.957015825439534, -73.99479825810214, -152.114711995896, -32.06921285502569, -33.059622534394336, 17.06488314669937, 5.981353871142995, -125.16760525832157, -58.27328239165126, -56.81774677277225, -26.169028780627297, -112.54558252763177, -34.29567966224071, -82.93103237326433, -8.477173100899456, -131.53834472393828, -101.19132543745167, -90.53272203223855, 14.597848417448677, -54.627119534964365, -81.84045964279909, -81.09904199262316, -151.7905552157002, -131.5235028142552, -67.03861294321048, -28.771504182553805, 13.837177238518057, -90.01040010289775, -191.30911929609331, -187.91284942156219, -36.841028374813476, -57.64240640543528, -19.815887352593876, 20.83605612628744, -0.28169278748717663, -9.735672905368268, -25.554560720957536, -100.06585302852118, -78.60941918377709, -59.5077219910688, -35.28568741481899, -72.64252089793125, -22.542247391032287, 6.283030188399933, -33.44381896386439, -31.049279238702983, -92.48018672182938, -65.26597216693011, -16.9794873602118, -16.209803182840243, -97.0201577223893, -73.06221110147699, -110.3944730311715, 6.943368214914143, -9.185186637749098, -140.53693649618972], "episode_lengths": [88, 60, 83, 67, 73, 96, 77, 52, 44, 68, 95, 34, 83, 55, 42, 44, 39, 93, 30, 69, 35, 31, 85, 41, 78, 57, 29, 58, 47, 58, 63, 39, 67, 34, 42, 86, 53, 78, 47, 42, 56, 50, 66, 45, 29, 68, 90, 52, 54, 29, 41, 77, 61, 61, 47, 73, 50, 82, 50, 85, 72, 69, 28, 65, 67, 69, 83, 80, 67, 56, 33, 70, 97, 94, 60, 57, 56, 29, 37, 45, 57, 70, 73, 67, 60, 68, 45, 36, 51, 58, 69, 62, 44, 54, 85, 66, 75, 47, 41, 94], "policy_policy_0_reward": [-115.69978622945443, -59.45242428048391, -123.41556973283967, -67.12547979240769, -106.27951781605579, -165.06167755635175, -120.73255473970289, -19.710124497607715, -0.8268175008016752, -71.4883478111045, -182.5535117847794, 19.299019240387864, -107.27217862221751, -41.20334538372588, 6.803540893856894, -12.552846198143868, -6.335326970510984, -192.71969198875627, 21.17231494290227, -88.79939924132394, 7.705823791247964, 14.547736670916237, -147.0927354364555, 2.3688532535898945, -72.79936691421429, -17.330627181566616, 18.970909312883144, -35.89136748469424, -12.531947343019198, -18.729773213639316, -69.81535846616615, -0.6613589424181718, -84.71168477679815, 11.712956515868823, -7.108112362353863, -117.8661683590757, -20.518241489787215, -85.99420905621777, -25.876670867188604, 5.694778444851299, -18.73141017520236, -10.521531462810684, -80.26301257302237, -2.288042427892141, 18.957015825439534, -73.99479825810214, -152.114711995896, -32.06921285502569, -33.059622534394336, 17.06488314669937, 5.981353871142995, -125.16760525832157, -58.27328239165126, -56.81774677277225, -26.169028780627297, -112.54558252763177, -34.29567966224071, -82.93103237326433, -8.477173100899456, -131.53834472393828, -101.19132543745167, -90.53272203223855, 14.597848417448677, -54.627119534964365, -81.84045964279909, -81.09904199262316, -151.7905552157002, -131.5235028142552, -67.03861294321048, -28.771504182553805, 13.837177238518057, -90.01040010289775, -191.30911929609331, -187.91284942156219, -36.841028374813476, -57.64240640543528, -19.815887352593876, 20.83605612628744, -0.28169278748717663, -9.735672905368268, -25.554560720957536, -100.06585302852118, -78.60941918377709, -59.5077219910688, -35.28568741481899, -72.64252089793125, -22.542247391032287, 6.283030188399933, -33.44381896386439, -31.049279238702983, -92.48018672182938, -65.26597216693011, -16.9794873602118, -16.209803182840243, -97.0201577223893, -73.06221110147699, -110.3944730311715, 6.943368214914143, -9.185186637749098, -140.53693649618972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2944457492527004, "mean_inference_ms": 0.907938974271843, "mean_action_processing_ms": 0.16347912537924464, "mean_env_wait_ms": 2.167001700876816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005659341812133789, "StateBufferConnector_ms": 0.0040988922119140625, "ViewRequirementAgentConnector_ms": 0.10259461402893066}, "num_episodes": 64, "episode_return_max": 21.17231494290227, "episode_return_min": -192.71969198875627, "episode_return_mean": -54.86436797511712, "episodes_this_iter": 64}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.7692643036489, "num_env_steps_trained_throughput_per_sec": 269.7692643036489, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 14146.89, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14146.806, "sample_time_ms": 2948.041, "learn_time_ms": 11182.166, "learn_throughput": 357.712, "synch_weights_time_ms": 15.318}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "64a97_00000", "date": "2024-07-26_23-28-00", "timestamp": 1722016680, "time_this_iter_s": 14.83630895614624, "time_total_s": 1357.282797574997, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f05f809d870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1357.282797574997, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 10.966666666666667, "ram_util_percent": 28.828571428571422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.729033433894315, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.19675505633931606, "policy_loss": -0.009445663776811367, "vf_loss": 0.18507415511412545, "vf_explained_var": 0.9996706559633215, "kl": 0.012189713616135123, "entropy": -0.2613438320190956, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 20.83605612628744, "episode_reward_min": -191.30911929609331, "episode_reward_mean": -68.25754280388306, "episode_len_mean": 63.73, "episode_media": {}, "episodes_timesteps_total": 6373, "policy_reward_min": {"policy_0": -191.30911929609331}, "policy_reward_max": {"policy_0": 20.83605612628744}, "policy_reward_mean": {"policy_0": -68.25754280388306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.597848417448677, -54.627119534964365, -81.84045964279909, -81.09904199262316, -151.7905552157002, -131.5235028142552, -67.03861294321048, -28.771504182553805, 13.837177238518057, -90.01040010289775, -191.30911929609331, -187.91284942156219, -36.841028374813476, -57.64240640543528, -19.815887352593876, 20.83605612628744, -0.28169278748717663, -9.735672905368268, -25.554560720957536, -100.06585302852118, -78.60941918377709, -59.5077219910688, -35.28568741481899, -72.64252089793125, -22.542247391032287, 6.283030188399933, -33.44381896386439, -31.049279238702983, -92.48018672182938, -65.26597216693011, -16.9794873602118, -16.209803182840243, -97.0201577223893, -73.06221110147699, -110.3944730311715, 6.943368214914143, -9.185186637749098, -140.53693649618972, -112.79536657846295, -72.55316379292407, -42.51938490363126, -50.03015299636058, -96.33767485246223, -97.08184376097446, -97.86598506291527, -128.45801188660877, -6.877226019628811, -18.912441364029362, 12.97652430467512, -88.0164260449336, -104.66091934368161, -63.28702215176795, -160.78236787375357, -66.60051646586858, -138.90973486633573, -95.89421898277052, -63.11333644968872, 2.418486369182282, -189.59170911322664, -126.14355721797021, -34.70358918470754, -87.33397354750633, -190.99890287077835, -71.68990439169346, -96.872894959443, -113.83141236043537, -107.93676279237702, -84.05011306535917, -168.40943732163416, -126.28053367879224, 10.635101882473757, -65.08830921648965, -5.915940127695887, -172.63542348671047, -55.22934848909202, -9.81265990006958, -108.73870589021436, -3.371632651434267, -36.69276091477052, -21.694738589655717, -5.645408160894575, -10.32843438568436, -52.05519663667759, 6.153486771024413, -3.7069029015585606, -130.61886442379176, 5.517352676078815, -32.86059849710066, -126.16173062155384, -123.1731351679106, -19.906919646389916, 11.460511647821164, -128.58096820582696, 15.30213597331316, -164.46537257905842, -135.7225905106144, -94.69301854416499, -86.73379166997333, -75.9119364485634, -110.3570124080053], "episode_lengths": [28, 65, 67, 69, 83, 80, 67, 56, 33, 70, 97, 94, 60, 57, 56, 29, 37, 45, 57, 70, 73, 67, 60, 68, 45, 36, 51, 58, 69, 62, 44, 54, 85, 66, 75, 47, 41, 94, 75, 79, 60, 62, 69, 86, 85, 78, 38, 42, 38, 68, 78, 68, 87, 62, 89, 71, 61, 43, 93, 77, 48, 68, 89, 65, 83, 76, 74, 81, 95, 78, 38, 61, 39, 90, 59, 50, 71, 49, 55, 54, 47, 42, 62, 39, 46, 79, 37, 55, 84, 76, 47, 34, 78, 34, 96, 86, 72, 66, 64, 82], "policy_policy_0_reward": [14.597848417448677, -54.627119534964365, -81.84045964279909, -81.09904199262316, -151.7905552157002, -131.5235028142552, -67.03861294321048, -28.771504182553805, 13.837177238518057, -90.01040010289775, -191.30911929609331, -187.91284942156219, -36.841028374813476, -57.64240640543528, -19.815887352593876, 20.83605612628744, -0.28169278748717663, -9.735672905368268, -25.554560720957536, -100.06585302852118, -78.60941918377709, -59.5077219910688, -35.28568741481899, -72.64252089793125, -22.542247391032287, 6.283030188399933, -33.44381896386439, -31.049279238702983, -92.48018672182938, -65.26597216693011, -16.9794873602118, -16.209803182840243, -97.0201577223893, -73.06221110147699, -110.3944730311715, 6.943368214914143, -9.185186637749098, -140.53693649618972, -112.79536657846295, -72.55316379292407, -42.51938490363126, -50.03015299636058, -96.33767485246223, -97.08184376097446, -97.86598506291527, -128.45801188660877, -6.877226019628811, -18.912441364029362, 12.97652430467512, -88.0164260449336, -104.66091934368161, -63.28702215176795, -160.78236787375357, -66.60051646586858, -138.90973486633573, -95.89421898277052, -63.11333644968872, 2.418486369182282, -189.59170911322664, -126.14355721797021, -34.70358918470754, -87.33397354750633, -190.99890287077835, -71.68990439169346, -96.872894959443, -113.83141236043537, -107.93676279237702, -84.05011306535917, -168.40943732163416, -126.28053367879224, 10.635101882473757, -65.08830921648965, -5.915940127695887, -172.63542348671047, -55.22934848909202, -9.81265990006958, -108.73870589021436, -3.371632651434267, -36.69276091477052, -21.694738589655717, -5.645408160894575, -10.32843438568436, -52.05519663667759, 6.153486771024413, -3.7069029015585606, -130.61886442379176, 5.517352676078815, -32.86059849710066, -126.16173062155384, -123.1731351679106, -19.906919646389916, 11.460511647821164, -128.58096820582696, 15.30213597331316, -164.46537257905842, -135.7225905106144, -94.69301854416499, -86.73379166997333, -75.9119364485634, -110.3570124080053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.294535364286491, "mean_inference_ms": 0.9067284832745416, "mean_action_processing_ms": 0.16313236155289637, "mean_env_wait_ms": 2.1671887790368793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00566864013671875, "StateBufferConnector_ms": 0.003951549530029297, "ViewRequirementAgentConnector_ms": 0.09941244125366211}, "num_episodes": 62, "episode_return_max": 20.83605612628744, "episode_return_min": -191.30911929609331, "episode_return_mean": -68.25754280388306, "episodes_this_iter": 62}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.3845409715706, "num_env_steps_trained_throughput_per_sec": 260.3845409715706, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14272.446, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14272.362, "sample_time_ms": 2937.968, "learn_time_ms": 11317.705, "learn_throughput": 353.429, "synch_weights_time_ms": 15.365}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "64a97_00000", "date": "2024-07-26_23-28-15", "timestamp": 1722016695, "time_this_iter_s": 15.370642900466919, "time_total_s": 1372.6534404754639, "pid": 293607, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f06087b95a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.6108652381980153, 0.6108652381980153, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1372.6534404754639, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 10.10909090909091, "ram_util_percent": 28.79999999999999}}
